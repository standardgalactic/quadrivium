, .
I ••
••
••
f •
.... I
....
01
a
d

Page ii
Adaptive and Learning Systems for Signal Processing, Communications, and Control
Editor: Simon Haykin
Werbos / THE ROOTS OF BACKpROpAGATlON: From Ordered Derivatives to Neural
Networks and political Forecasting
Krstic ~ Kanellakopoulos, and Kokotovic~ / NONLINEAR AND ADApTIVE CONTROL
DESIGN
Nikias and Shao / SIGNAL pROCESSING WITH ALpHA-STABLE DISTRIBUTIONS AND
AppLICATIONS
Diamantaras and Kung / pRINCIpAL COMpONENT NEURAL NETWORKS: THEORY AND
AppLICATIONS
Tao and Kokotovic~ / ADApTIVE CONTROL OF SYSTEMS WITH ACTUATOR AND
SENSOR NONLINEARITIES
Tsoukalas / FUZZY AND NEURAL AppROACHES IN ENGINEERING Hrycej /
NEUROCONTROL: TOWARDS AN INDUSTRIAL CONTROL METHODOLOGY
Beckerman / ADApTIVE COOpERATIVE SYSTEMS
Cherkassky and Mulier / LEARNING FROM DATA: CONCEpTS, THEORY, AND METHODS
passino and Burgess / STABILITY ANALYSIS OF DISCRETE EVENT SYSTEMS
Sanchez-pefia and Sznaier / ROBUST SYSTEMS THEORY AND AppLICATIONS
Vapnik / STATISTICAL LEARNING THEORY

Page 111
Statistical Learning Theory
Vladimir N. Vapnik
AT&T Re~earch Laboratone~
A WILEY-INTERSClENCE PUBLICATION
JOHN WILEY & SONS, INC.
NEW YORK I 01$CHESTER I WEINHEIM I BRISBANE I SINGAPORE I TORONTO

Page iv
Disclaimer:
This book contains characters with diacritics. When the characters can be represented u-',ing the ISO
8859-1 character set (http://W.iV.iV.w3.orgITRlimagesllatinl.gif). netLibrary will represent them as
they appear in the original text, and most computers will be able to show the full characters
correctly. In order to keep the text searchable and readable on most computers, characters with
diacritics that are not part ofthe ISO 8859-1 list will be represented without their diacritical marks.
This book is printed on acid-free paper. ~
Copyright © 1998 by John Wiley & Sons, Inc. All rights reserved.
published simultaneously in Canada.
No part ofthis publication may be reproduced, stored in a retrieval system or transmitted in any
form or by any means, electronic, mechanical, photocopying, recording, scanning or otherwise,
except as permitted under Sections 107 or 108 of the 1976 United States Copyright Act, without
eitller tlle prior written pennission oftlle publisher, or autllorization tllrough payment oftlle
appropriate per-copy fee to the Copyright Clearance Center, 222 Rosewood Drive, Danvers, MA
01923, (978) 750--8400, fax (978) 750-4744. Requests to the publisher for permission should be
addressed to the permissions Department, John Wiley & Sons, Inc., 605 Third Avenue, New York,
NY 10158-0012, (212) 850--6011, fax (212) 850--6008, E-Mail: pERMREQ@WILEY.COM.
Library ofCongress Cataloging-in-Publication Data:
Vapnik, Vladimir Naumovich
Statistical learning theory / Vladimir N. Vapnik
p.
cm.--(Adaptive and learning systems for signal
processing, communications, and control)
Includes bibliographical references and index.
ISBN 0-471-03003-1 (cloth: alk. paper)
1. Computational learning theory. I. Title. II. Series.
Q325.7.V38 1998
008.3l--dc2l
97-37075
Clp
printed in the United States ofAmerica.
10987654321

In memory ofmyfather
Page v


CONTENTS
PREFACE
xxi
Introcluctlon: Ttl. Problem ot Induction and Statistical
Inference
1
0.1
Learning Paradigm in Statistics I I
0.2
TWo Approaches to Stalisticallnfercnce: Panicular
(Parametric Inference) and General (Nonparamclric
Inference) I 2
0.3
The Paradigm Created by the Paramdric Approach I 4
0.4
Shonooming of the Parametric Paradigm / 5
0.5
After the Oassical Paradigm I 6
0.6
The Renaissance I 7
0.7
The GeneraliUllion of the Glivenko-Cantelli-Kolmogoro,'
Theory I 8
0,8
The Structural Risk Minimi7..ation Principle I 10
0.9
The Main Principle of Inference from a Small Sample
Size I 11
0.10
What This Book is About / 13
I THEORY OF LEARNING AND GENERAllZAnON
1
Two Approache. to the learning Problem
19
1.1
General Model of Learning from Examples I 19
J.2
The Problem of Minimizing the Risk Functional from
Empirical Data I 21
J.3
The Problem of Pattern Recognition / 24
1.4
The Problem of Regression Estimation / 26
I.S
Problem of Interpreting Results of Indirect Measuring / 28
1.6
The Problem of Density Estimation (the Fisher-Wald
Sening) / 30
,II

vlll
CONTENTS
1.7
Induction Principles far Minimizing the Risk Fundional on
the Basis of [;.mpirical Dala I 32
\.8
Classical Methods ror Solving lhe Function Estimation
Problems I 33
1.9
Identificatiun of Stochastic Objects: Eslimuian of th<:
Densities and Conditiunal
Dcn~i1ies I 35
1.9.1
Problem af Densily Estimation. Direct S<:lling I 35
1.9.2
Problem of Condilional Probability Eslimation I 36
1.9.3
Problem of Conditional Density F...stimalion I 37
l.lU
The Problem of Solving an Approximalely DClennined
Illtcgral Equation I 38
1.11
Glivenko-Cantelli Theorem I 39
I.l \.1
Convcrgcnce in Prohahitil)' and Almost Sure
Convergence I 40
1.11.2
Glivenko-Canlelli Theorem I 42
1.11.3
Three hnponant Statistical Laws I 42
1.12
Ill-Posed Problems I 44
1.13
The Structure of the Learning Theory I 48
Appendix to Chapter 1: Methods for Solvlnv m-PolHtd
Problems
AU
The Problem of Solving an Operator Equalion I 51
AU
Problems Well-Posed in Tikhonov's Sense I 53
AU
nH: Rcguillrization Method I 54
A1.3.1
Idea of Regularization Method I 54
A1.3.2
Main Theorems Aboulthe Regularization
Method I .55
51
2
EstlmaUon of ttle Probability Measure and Problem
of leeming
59
2.1
Probability Modd of a Random &perimcnt I 59
2.2
The Basic Problem of Statistics I 61
2.2.1
The Basic Problems of Prohability and Statistics / 61
2.2.2
Uniform Conver~cncc of j'robiluility Measure
Estimates / 62
2.3
Conditions for the Unifonn Convergence of Estimates
10 the Unknown Probability Measure / 65
2.3.1
SlruCture of Dislributtoo Fundion I 65
2.32
Estimator lbat I'rovidcs Unifoml Convugencc I 68
2.4
Partial Uniform Convergence and Generalization of
G~vcnko-CantelliTheorem I 6')

C()Nl'l:NTS
Ix
2.4.\
Definition of Partial Uniform Convergence I 69
2.4.2
Generalization of the Glivcnko--Cantclli Problem I 71
2..5
Minimizing the Risk Functional Under the Condition of
Uniform Convergeoce of Probability Measure
Estimates I 72
2.6
Minimizing the Risk Functional Undcr the Condition of Panial
Uniform Convergeoce of Probability Measure E!;timates I 74
2.7
Remarks About Modes of Convergence of the Probability
Measure E:i1imates and Statements of the uaming Problem I 77
3
Condilionsior Consistency ot Empirical Risk
Minimization PrInciple
79
3.1
Classical Definition of Consistency I 79
3.2
Definition of Strict (Nontrivial) Consistency I 82
3.2.1
Definition of Strict Consistency for the Pattern
Recognition and the Regression Estimation
Problems I 82
3.2.2
Definition of Strict Consistency for tbe Density
Estimation Problem I 84
3.3
Empirical Processes I 85
3.3.1
Remark on the Law of Large Numbers and Its
Generalization I 86
3.4
The Key Theorem of Learning Theory (Theorem About
Equivalence) I 88
3.5
Proof of the Key Theorem I 89
3.6
Strict Consistency of the Maximum Likelihood Method I 92
3.7
Necessary and Sufficient Conditions for Uniform Convergence
of Frequencies 10 Their Probabilities I 93
3.7.1
Three Cases of Uniform Convergence I 93
].7.2
Conditions of Uniform Convergence in the Simplest
Model I 94
3.7.3
Entropy of a Set of Functions I 95
3.7.4
Theorem About Uniform Two-Sided Convergence I 97
3.8
Necessary and Sumcient Conditions for Uniform Convergence
of Means to Their Expectations for a Set of Real-Valued
Bounded Functions I 98
3.11.1
Entropy of a Set of Real-Valucd Functions I 98
3.8.2
Theorem About Uniform Two-Sided Convergence I 99
3.9
Necessary and Sumcienl Conditions for Uniform Convergence
of Means to Their Expectations for Sels of Unbounded
FunClions I 100
3.9.1
Proof of Theorem 3.5 I WI

x
CONJENTS
3.10
Kanl's Problem of Demarcation and Popper's Theory of
Nonfalsifiability / 106
3.11
Theorems About Nonfalsifiabilily / 108
3.11.1
Case of Complete Nonfalsifiability / 108
3.11.2
Theorem About Partial Nonfalsiftability /109
3.11.3
Theorem About Potential Nonfalsifiability / 110
3.12
Conditions for One-Sided Unifonn Convergence and
Consistency of the Empirical Risk Minimization
Principle / 1\2
3.13
Three Milestones in Learning Theory / 1\8
• Bounds on the Risk tOJ Indicator loss FuncUons
121
4.1
Bounds for the Simplest Model: Pessimistic Case / 122
4.1.1
The Simplest Model/ 123
4.2
Bounds for the Simplest Model: Optimistic Case I 125
4.3
Bounds for the Simplest Model: General Case / 127
4.4
The Basic Inequalities: Pessimistic Case / 129
4.5
ProofofTheorem4.1/131
4.5.\
The Basic Lemma /
131
4.5.2
Proof of Basic Lemma / 132
4.5.3
The Idea of Proving Theorem 4.1 /
134
4.5.4
Proof of Theorem 4.1 / 135
4.'
Basic Inequalities: General Case / 137
4.7
Proof of Theorem 4.2 / 139
4.8
Main Nonconstructive Bounds / 144
4.'
VC Dime'lsion / 145
4.9.1
The Structure of the Growth Function / 145
4.9.2
Constructive Distribution-Free Bounds on
Generalization Abilily / t48
4.9.3
Soilition of Generalized Glivenko-Cantelli
Problem / 149
4.10
l>roof of Theorem 4.3 / ISO
4.11
E:J:ample of the VC Dimension of the Different Sets of
Functions / 155
4.12
Remarks About the Bounds on the Generalization Ability
of Learning Machines / 160
4.13
Bound on Deviation of Frequencies in Two
Half-Samples / 163
Appendix to Chopt., 4: low., Bounds on th. Risk ot the
ERM Princlpl.
16.
A4.1
Two Strategies in Statistical Inference / 169
A4.2
Minimax Loss Strategy for Learning Problems /
17l

eotmNlS
xl
A4.3
Upper Bounds on the Maximal Loss for the Empirical
Risk Minimization Principle / 173
A43.1
Optimistic Case / 173
A432
Pessimistic Case / 174
A4.4
Lower Bound for the Minimax Loss Strategy in the
Optimistic Case / 177
A4.5
Lower Bound for Minimax Loss Stralegy for the
Pessimistic Case / 179
5
Bounds on 1M Risk tor Real-Volued Lou Functions
1.3
5.1
Bounds for the Simplest Model: Pessimistic Case / 183
5.2
Concepts of Capacity for the Sets of Real·Valued
Functions / 186
5.2.\
Nonconstructive Bounds on Generalization for Sets
of Real·Valued Functions / 186
5.2.2
The Main Idea / 188
5.2.3
Concepts of Capacity for the Set of Real·Valued
Functions / 190
5.3
Bounds for the General Model: Pessimistic Case / 192
5.4
The Basic Inequality /
194
5.4.1
Proof of Theorem 52 / 195
5.5
Bounds for the General Model: Universal Case / 196
5.5.1
Proof of Theorem 53 / 198
5.6
Bounds for Unifonn Relative Convergence / 200
5.6.1
Proof of Theorem 5.4 for the Case p > 2 / 201
5.6.2
Proof of Theorem 5.4 for the Case 1 < p :5 2 / 204
5.7
Prior Infonnation for the Risk Minimization Problem in Sets
of Unbounded Loss Functions / 207
5.8
Bounds on the Risk for Sets of Unbounded Nonnegative
Functions / 210
5.9
Sample Selection and the Problem of Outliers / 214
5.10
The Main Results of the Theory of Bounds / 216
6
The SINelural Risk Mlnlmlzollon Principle
21.
6.1
The Scheme of the Structural Risk Minimization Induction
Principle / 219
6.1.1
Principle of StrUClUral Risk Minimization / 221
6.2
Minimum Description Length and Structural Risk Minimi7.ation
Inductive Principles / 224
6.2.1
The Idea About the Nature of Random
Phenomena / 224

xII
CONTENTS
6.2.2
Minimum Description Length Principle for the
PaUem Recognilion Problem I 224
6.23
Bounds for the Minimum Description Length
Principle I 226
6.2.4
Structural Risk Minimization for the Simplest Moot:!
and Minimum Description Length Principle I 227
6.2.5
The Shortcoming of the Minimum Description Length
Principle I 228
6.3
Consistency of the Structural Risk Minimization Principle and
Asymptotic Bounds on the Rate of Convergence I 229
63.1
Proof of the Theorems I 232
6.3.2
Discussions and Example I 235
6.4
Bounds for the Regression Estimation Problem I 237
6.4.1
The Modd of Regression Estimation by Series
Expansion I 238
6.4.2
Proof of Theorem 6,4 I 241
6.5
The Problem of Approximating Functions I 246
6.5.!
Three Theorems of Oassical Approximation
Theory I 248
6.5.2
Curse of Dimensionality in Approximation
Theory I 251
6.5.3
Problem of Approximation in Learning Theory I 252
6.5.4
The VC Dimcnsion in Approximation Theory I 254
6.6
Problem of Local Risk Minimization I 257
6.6.1
Local Risk Minimization Model I 259
6.6.2
Bounds for the Local Risk Minimi7.ation
Estimator I 262
6.6.3
Proofs of the Theorems I 265
6.6.4
Structural Risk Minimi7.3tion Principle for Local
Function Estimation I 268
Appendix to Chapt.r 6: Estimating functions on the Basis
01 Indirect Measurements
271
A6.!
Problems of Estimating the Results of Indirect
MeasurementS I 271
A6.2
Theorems on Estimating Functions Using Indirect
Measurements I 273
A6.3
Proofs of the Theorems I 276
A6.3.1
Proof of Theorem A6.1 I 276
A6.3.2
Proof of Thcorelli A6.2 I 281
A6.).3
Proor of Theorem A6.3 I 21B

CONTENTS
xlii
7
stochasflc 1I1-PoMd Problem,
293
7.1
Stochastic III-Posed Problems / 29]
7.2
Regulari7.l1tion Method for Solving Stochastic IlI·Posed
Problems / 297
7.3
Proofs of the Theorems / 299
7.3.1
Proof of Theorem 7.1 / 299
7.].2
Proof of Theorem 7.2 / 302
7.].3
Proof of Theorem 73 / 30]
7.4
Conditions for Consistency of the Methods of Density
Estimation / ]05
73
Nonparametric Estimators of Density: Estimators Based
on Approximations of the Distribution Function by an
Empirical Distribution Function / 308
7.5.1
The Parzen Estimators / 308
732
Projection Estimators / ]13
7.5.3
Spline Estimate of the Density. Approximation by
Splines of the Odd Order / 31]
7.5.4
Spline Estimate of the Density. Approximation by
Splines of the Even Order / ]14
7.•
Nonclassical Estimators / ]15
7.6.1
Estimators for the Distribution Function / 315
7.6.1
Polygon Approximation of DistribUlion Function / 316
7.6.3
Kernel Density Estimator / ]16
7.6.4
ProjeClion Method of the Density Estimator / 318
7.7
Asymptotic Rate of Convergence for Smooth Density
FunClions / ]19
7.8
Proof of Theorem 7.4 / 322
7.'
Choosing a Value of Smoothing (Regulari7.3tion) Parameter
for the Problem of Density Estimation / 327
7.tO
Estimation of the Ratio of Two Densities / 330
7.10.1
Estimation of Conditional Densities / ]3]
7.11
Estimation of Ratio of 1\vo Densities on the Line / ]34
7.12
Estimation of a Conditional Probability on a Line / 3]7
• Estimating the Values of function of Given Points
33•
8.1
The Scheme of Minimi7Jng the Ovcrall Risk / 339
8.2
The Method of Structural Minimi7.ation of the Overall
Risk / 343
8.3
Bounds on the Uniform Relative Deviation of Frequencies
in 1\vo Subsamplell / 344
8.4
A Bound on the Uniform Relative Deviation of Means
in Two Subsamplcs / 347

xlv
CONTENTS
85
Estimation of Values of an Indicator Function in a Class
of linear Decision Rules I 350
8.6
Sample Selection for Estimating the Values of an
Indicator Function I 355
8.7
Estimation of Values of a Real Function in the Oass
of Functions linear in Their Parameters I 359
8.8
Sample Selection for ESlimation of Values of
Real·Valued Functions I 362
8.9
Local Algorithms for Estimaling Values of an
Indicator Function I 363
HoIO
Local Algorithms for Estimating Values of II
Real·Valued Function I 365
8.11
The PToblem of Finding the Best Point in a Given Set I 367
8.11.1
Choice of the Most Probable Repr($Cntative of Ihe
Firsl Class I 368
8.11.2
Otoice of the Best Point of II Given Set I 370
II
SUPPORT VECTOR ESTIMATION OF FUNCTIONS
9
Perc.ptrons and Their Gea.ralizaHons
375
9.1
Rosenblatt's Perceptron I 375
9.2
Proofs of the Theorems I 380
9.2.1
Proof of NovikoU 'Ilteorem I 380
92.2
Proof of Theorem 93 I 382
9.3
Method of Stochastic Approximation and Sigmoid
Approximation of Indicator Functions I 383
9.3.1
Method of SlOchastit Approximation I 384
9.3.2
Sigmoid ApproXimations of Indicalor Functions I 385
9.4
Method of Potenlial Functions and Radial Basis
Functions I 387
9.4.1
Melhod of Potential Functions in Asymplotic Learning
Theory I 388
9.42
Radial Basis Function Method I 389
9.5
Three Theorems of Optimi7.3tion Theory I 390
9.5.1
Fermat's Thwrem (1629) I 390
95.2
Lagrange Multipliers Rule (1788) I 391
953
KUhn-ThckerThwrem (1951) I 393
9.6
Neural Networks I 395
9.6.1
The BllCk·Propagation Melhod I 395
9.6.2
The Back·Propagation Algorithm I 398

CONTENTS
xv
9.6.3
Neural Network! for the Regression Estimation
Problem I 399
9.6.4
Remarks on the Back-Propagation Method I 399
10
The SUpport Vector M.thOd lor Estimating Indicator
Functions
401
10.1
The Optimal Hyperplane I 401
10.2
The Optimal Hyperplane for Nonseparable Seu / 408
102.1
The Hard Margin Generalization of the Optimal
Hyperplane I 408
10.2.2
The Basic Solution. Soft Margin Generaliution I 411
10.3
Statistical Properties of the Optimal Hyperplane I 412
10.4
Proofs of the Theorems I 415
10.4.1
Proof of Theorem 10.3 I 415
10.4.2
Proof of Theorem 10.4 I 415
10.4.3
Leave-One-Out Procedure I 416
10.4.4
Proof of Theorem 105 and Theorem 92 I 417
10A.S
The Key Lemma I 418
10.4.6
ProofofTheorems 10.6 and 10.6a 1420
1004.7
ProofofTheorem 10.7 I 421
10.5
The Idea of the Support Vector Machine I 421
10.5.1
Generalization in High-Dimensional Space I 422
10.5.2
Hilbert-5chmidt Theory and Mercer Theorem / 423
10.5.3
Constructing SV Machines I 424
10.6
One More Approal;h to the Support Vector Method I 426
10.6.1
Minimizing the Number of Support Vectors I 426
10.6.2
Generalization for the Nonseparable Case I 427
10.6.]
Linear Optimiution Method for SV Machines I 427
to.7
Selection of SV Machine Using Bounds I 428
10.8
Examples of SV Machines for Pauem Recognition I 430
10.8.1
Polynomial Support Vector Machines I 430
10.8.2
Radial Basis Function SV Machines I 4]1
10.8.3
Two-Layer Neural SV Machines I 432
10.9
Support Vector Method for Transductive Inference I 434
to.IO
Multiclass Oassification I 4]7
10.11
Remarks on Generali7..ation of the SV Method I 440
11
The SUpport V.ctor M.thod lor Estimating R.a~Yalu.d
Functions
443
11.1
e-Insensitive Loss Functions I 44]
11.2
Loss Fuoctions for Robust Estimators I 445

xvi
CONTENTS
11.3
Minimizing the Risk with c-Insensilive Loss Functions I 448
1!J.1
Minimizing Ihe Risk for n Fi~cd Element of lhe
Structure I 449
11.3.2
The Basic Solutions I 452
11.3.3
Solution for the Huber Loss Function I 453
\i A
SV Mnchincs for FunctiOfl Estimation I 454
1\.4.\
Minimizing the Risk for a Fixed Element of the
Structure in Feature Space I 455
11.4.2
The Basic Solulions in Feature Space I 456
11.4.3
Solution for Huber Loss Function ill Feature
Sp.tCC I 458
11.4.4
Linear Optirnizalion Method I 459
11.4.5
Multi-Kernel Demmposition or Functions I 459
11.5
ConsTruCling Kernels for Eslimalion of Real-Valued
FUnClions I 46U
11.5.1
Kernels Generating Expansion on Polynomials I 461
11.5.2
Constructing Multidimensional Kernels I 462
11.6
Kernels Generaling Splines I 464
11.6.1
Spline of Order (/ with a Finile Number of KnOIS I 464
11.6.2
Kernels Generating Splines with an Inflnite Number
of Knots I 465
11.6.3
B,,-Spline Approximations I 466
11.6.4
B" Splines with an Inlinite Number of Knots I 468
11.7
Kernels Generating Fourier Expansions I 468
11.7.1
Kernels for RegUlarized Fourier E~pansions I 469
IJ.li
The Support Vector ANOVA Decomposition (SVAD) for
Function Approximation and RegrcssiOll Eslimalion I 471
11.9
SV Method for Solving Linear Operator Ellualions I 473
11.9.1
The SV Method I 473
11.9.2
RegulariZ<llion by Choosing I'arameten; of
e,-Insensitivity I 478
11.10
SV Method of DensilY Estimation I 479
11.10.1
Spline Approximation of a Density I 480
11.10.2
Appro~imution of a Density with Gaussian Mixture I 481
11.11
Estimation of Condilional Probability and Conditional
Densily Functions I 484
11.11.1
Estimation of Conditional Probabilily Functions I 484
11.11.2
Estimation of Conditional Densily Functions I 488
11.12
Connections Between the SV Melhod and Sparse
Function Approximation I 489
11.12.1
Reproducing Kerncls Hilbert Spaces I 490
11.12.2
Modified Sparse Appro~imation and its Relation
to SV Machines I 491

CONTENTS
xvII
12
SV Machines for Pattern R.cognltlon
493
12.1
The Ouadratic Optimi1.ation Problem I 493
12.1.1
herative Procedurc for Specifying Suppon
Vectors I 494
12.1.2
Methods for Solving the Reduced Optimization
Problem I 496
122
Digit Recognition Problem. The U.S. Postal Service
Database / 496
12.2.1
Perfonnance for the U.S. Postal Servicc
Dalabase I 496
12.22
Some Important Details I soo
12.23
Comparison of Perronnancc of the SV Machine
with Gaussian Kernel to the Gaussian RBF
Network I 503
12.2.4
The Best Results for U.S. Postal Service
Database I 505
123
Tangent Distance I 506
12.4
Digit Recognition Problem. The NIST Database / 511
12.4.1
Perfonnance for NIST Database I 511
12.4.2
Further Improvement I 512
12.4.3
The Bcsi Results for NIST Database I 512
12.5
Future Racing I 514
12.5.1
One More Opportunity. The Transductivc
Inference I 5111
13
SV Machines tor Function Approximations, Regression
Estimalk)n, and Signal Proc.ssJng
521
13.1
The Model Selection Problem I 521
13.1.1
Functional for Model Selection Based on the VC
Bound I 522
13.1.2
Oassical Functionals I 524
13.1.3
Experimental Comparison of Model Selection
Methods I 525
13.1.4
The Problem of Fealure Selection tlas No General
Solution I 526
13.2
Structure on the Set of RegUlarized Linear Functions I 530
132.1
The L-Curve Method I 532
13.2.2
The Method or Effective Number or
Parameters I 534
13.2.3
The Method of Effective VC Dimenston I 536
13.2.4
Experiments on Measuring the EUective VC
Dimension I 540
13.3
Function Approximalioo Using the SV Melhod I 543

Jl:vlll
CONTfNTS
13.3.l
Why Does the Value of 6 Controllhe Number
of Support Vectors'! / 546
13.4
SV Machine for Regression Estimation / 549
13.4.1
Problem of Data Smoothing / 549
13.4.2
Estimation of Linear Regression Functions / 550
13.4.3
Eslimation of Nonlinear Regression FunClions / 556
13.5
SV Method for Solving the Posiuon Emission Tomography
(PET) Problem / 558
13.5.1
De~ription of PET / 558
13.5.2
Problem of Solving the Radon Equation / 560
13.53
Generali1.ation of the Residual Principle of
Solving PET Problems / 56l
13.5.4
The OassicaJ Methods of Solving the PET
Problem / 562
13.5.5
The SV Method for Snlving the PET Problem / 563
13.6
Remark About the SV Method / 567
III
STATISTICAL FOUNDATION OF LEARNING THEORY
14
Nece.sary and SUfficient Candmon. tor Unllorm
Convergence 01 frequencle. to Their Proboblltttes
571
14.1
Uniform Convergence of Frequencies to their
Probabilities / 572
14.2
Basic Lemma / 573
14.3
Entropy of the Sct of Events / 576
14.4
Asymptotic Properties of the Entropy / 578
14.5
Necessary and Sufficient Conditions of Uniform Convergence.
Proof of Sufficiency / 584
14.6
Nccessary and Sufficient Condilions of Uniform Convergence.
Proof of Necessity / 587
14.7
NcceSS3ry and Sufficient Conditions. Continuation of
Proving Necessity / 592
15
Necessary and Suttlelent Cond"lons lor UnHorm
Convergence 01 Means to Their Expectations
597
15.1
t; Entropy / 597
15.1.1
Proof of the Existence of the Limit / 600
15.1.2
Proof of the Convergence of the Sequence / 601
15.2
The Ouasicube / 603
153
&-E1ltension of a Set / 608

CQtill:NTS
xix
15.4
An Auxiliary Lemma I 610
15.5
Necessary and Sufficient Conditions for Unironn Convergence.
The Proof of Necessily I 614
15.6
Necessary and Sufficient Conditions for Unifonn Convergence.
The Proof of Sufficiency I 618
15.7
Corollaries from Theorem 15.! I 624
16
Necessary and Svtficlent Conditions for UnHorm OnWlded
Convergence o' Means to Their Expectations
629
16.1
Introduction I 629
16.2
Maximum Volume Sections I 630
16.3
The Theorem on the Average logarithm I 636
16.4
Theorem on lhe Existence of a Corridor I 642
165
Theorem on the Existence of Functions Oose to the Corridor
Boundaries (Theorem on Potential Nonralsifiability) I 651
16.6
The: Ne:ce:»ary Conditions I 660
16.7
The Necessary and Sufficient Conditions I 666
Comments and Blbllographlcal.emarks
Rererence.
Index
..,
723
733


PREFACE
This book is devoted to statistical learning theory, the theory that explores
ways of estimating functional dependency from a given collection of data.
This problem is very general. It covers important topics of classical statistics-
in particular, discriminant analysis, regression analysis, and the density esti-
mation problem.
In this book we consider a new paradigm for solving these problems: the
so-called learning paradigm that was developed over the last 30 years. In
contrast to the classical statistics developed for large samples and based on
using various types of a priori information, the new theory was developed
for small data samples and does not rely on a priori knowledge about a
problem to be solved. Instead it considers a structure on the set of functions
implemented by the learning machine (a set of nested subsets of functions)
where a specific measure of subset capacity is defined.
To control the generalization in the framework of this paradigm, one has
to take into account two factors, namely, the quality of approximation of
given data by the chosen function and the capacity of the subset of functions
from which the approximating function was chosen.
This book presents a comprehensive study of this type of inference (learn-
ing process). It contains:
• The general qualitative theory that includes the necessary and sufficient
conditions for consistency of learning processes
• The general quantitative theory that includes bounds on the rate of
convergence (the rate of generalization) of these learning processes
• Principles for estimating functions from a small collection of data that
are based on the developed theory
• Methods of function estimation and their application to solving real-life
problems that are based on these principles
The book has three parts: "Theory of Learning and Generalization,"
"Support Vector Estimation of Functions," and "Statistical Foundation of
Learning Theory."
The first part, "Theory of Learning and Generalization," analyzes factors
xxi

xxii
PREFACE
responsible for generalization and shows how to control these factors in order
to generalize well.
This part contains eight chapters. Chapter 1 describes two different
approaches to the learning problem. The first approach considers learning
as a problem of minimizing an expected risk functional in the situation when
the probability measure that defines the risk is unknown but i.i.d. observa-
tions are given. To obtain a solution in the framework of this approach. one
has to suggest some inductive principle. That is. one has to define a con-
structive functional that should be minimized (instead of the expected risk
functional) in order to find a function that guarantees a small expected loss.
The second approach considers learning as a problem of identification of the
desired function: Using observations. one has to find the function that is close
to the desired one. In general. this approach leads to the necessity of solving
the so-called ill-posed problems.
Chapter 2 discusses connections between the main problems of learning
theory and problems of the foundation of statistics. namely the problem of
estimating the probability measure from the data. It describes two ways of
estimating the probability measure. One way is based on the convergence of
an estimate of the probability measure in a weak mode. and another way is
based on convergence in a strong mode. These two ways of estimating the
unknown measure imply two approaches to the learning problem described
in Chapter I.
Chapter 3 is devoted to the qualitative model of learning processes. namely.
to the theory of consistency of the learning processes based on the empirical
risk minimization induction principle. It shows that for consistency of the
learning processes based on this principle the convergence of some empirical
processes (the existence of uniform law of large numbers) is necessary and
sufticient. In Chapter 3 these conditions are discussed. (The corresponding
theorems will be proven in the third part of the book.)
Chapters 4 and 5 estimate the bounds on the rate of convergence of the
empirical processes. Using these bounds we obtain bounds on the risk for the
functions that minimize the empirical risk functional. In Chapter 4 we obtain
bounds for sets of indicator functions (for the patlern recognition problem).
and in Chapter 5 we generalize these bounds for sets of real-valued functions
(for regression estimation problems). The bounds depend on two factors: the
value of empirical risk and the capacity of the set of functions from which
the function minimizing empirical risk was chosen.
In Chapter 6 we introduce a new induction principle, the so-called "struc-
tural risk minimization" principle, which minimizes bounds obtained in Chap-
ters 4 and 5 with respect to two factors, the value of empirical risk and the
capacity. This principle allows us to find the function that achieves the guar-
anteed minimum of the expected risk using a finite number of observations.
Chapter 7 is devoted to solving stochastic ill-posed problems. including
the problems of density estimation, conditional density estimation. and con-
ditional probability estimation. For solving these problems, we utilize the

PREFACE
xxiii
regularization method (which is based on the same ideas as the structural
risk minimization principle). Using this method, we obtain both the classical
methods for the solution of our problems and new ones.
In Chapter 8 we consider a new statement of the learning problem. We
introduce the problem of estimating values of a function at given points of
interest. For a restricted amount of empirical data, the generalization abil-
ity using the direct methods of estimating the values of a function at given
points of interest can be better than using methods of estimating the func-
tion. Therefore, we consider methods of direct estimation of the values of
the function at given points of interest that are not based on the estimation
of the functional dependency.
The second part of this book, "Support Vector Estimation of Functions,"
introduces methods that provide generalization when estimating a multi-
dimensional function from a limited collection of data.
This part contains five chapters. Chapter 9 describes classical algorithms:
Perceptrons, neural networks, and radial basis functions.
Chapters 10, 11, 12, and 13 are devoted to new methods of solving depen-
dency estimation problems, the so-called support vector method. Chapter
10 considers support vector machines for estimating indicator functions (for
pattern recognition problems). Chapter 11 considers support vector machines
for estimating real-valued functions.
Chapters 12 and 13 discuss solutions of real-life problems using support
vector machines. Chapter 12 discusses pattern recognition problems, and
Chapter 13 discusses various real-valued function estimation problems such
as function approximation, regression estimation, and solving inverse prob-
lems.
The third part of this book "Statistical Foundation of Learning Theory,"
studies uniform laws of large numbers that make generalization possible.
This part contains three chapters. Each of these chapters studies a different
empirical process: uniform convergence of frequencies to their probabilities
over a given set of events (Chapter 14), uniform convergence of means to
their expectations over a given set of functions (Chapter 15), and uniform
one-sided convergence of means to their expectations over a given set of
functions (Chapter 16). Convergence of these processes forms the basis for
the theory of learning processes and for theoretical statistics.
Bibliographical, historical, and general comments, reflecting the author's
point of view on the development of statistical learning theory and related
disciplines, are given at the end of the book.
The first two parts of the book are written at a level for use in a graduate
course on learning theory in statistics, mathematics, engineering, physics, and
computer science. It should also appeal to professional engineers wishing
to learn about learning theory or to use new methods for solving real-life
problems. The third part is written at a higher level. It can be used in a
special course on empirical processes for Ph.D. students in mathematics and
statistics.

xxiv
PREFACE
This hook hecame possihle due lo the support of Larry Jackel. lhe head
of the Adaptive System Research Department. AT&T Bell Lahoratories and
Yann LeCun, the head of the Image Processing Research Department. AT&T
Research Lahoratories. It was inspired hy collahoration with my colleagues
Youshua Bengio, Bernhard Boser, Leon Bottou, Chris Burges, Eric Cosatto.
John Denker. Harris Drucker. Alexander Gammerman, Hans Peter Craft.
Isahella Guyon. Patrick Haffner. Martin Hasler. Larry Jackel, Yann LeCun.
Esther Levin. Rohert Lyons. Nada Matic. Craig Noh!. Edwin Pednault. Ed-
ward Sackinger. Bernard Schmkopf. Alex Smola. Patrice Simard. Sara Solla.
Vladimir Vovk, and Chris Watkins.
I discussed the ideas presenled in the hook with Leo Breiman. Jerry
Friedman. Federico Girosi, Tomaso Poggio. Yakov Kogan, and Alexander
Shuslorovich. The feedhack of these discussions had an importanl inlluence
on the content of this hook.
Martin Hasler, Federico Girosi. Edward Rietman. Pavel Laskov. Mark
Slilson. and Jason Weston read lhe manuscript and improved and simplified
the presentation.
When the manuscript was completed I gave some chapters to Chris Burges.
Leon Bottou. Hamid Jafarkhani, Ilia Izmailov, Art Owen, Bernhard Schi51-
kopf. and Michael Turmon. They also improved the quality of the hook.
I would like to express my deep gratitude to all of them.
VLADIMIR N. VAI'NIK
Rl'd HlIllA., ,VI'W Jer.\('l'.
JIIIl.- !<N,Ii

INTRODUCTION:
THE PROBLEM OF
INDUCTION AND
STATISTICAL INFERENCE
0.1
LEARNING PARADIGM IN STATISTICS
The goal of this book is to describe a new approach to dependency estimation
problems which originated within learning theory.
The development of this approach started in the 1960s after the appearance
of the first generation of computers capable of conducting multidimensional
analysis of real-life problems. From the very first results of these analyses it
became clear that existing classical approaches to low-dimensional function
estimation problems do not reflect singularities of high-dimensional cases.
There was something in high-dimensional cases that was not captured by the
classical paradigm. R. Bellman called this something "the curse of dimension-
ality." In attempts to overcome this curse a new paradigm was developed.
When developing the new paradigm it was fortunate that in the late 1950s
F Rosenblatt started analysis of the pattern recognition problem. From the
formal point of view the pattern recognition problem belongs to the gen-
eral statistical problem of function estimation from empirical data. However,
in this problem one has to estimate a function belonging to simple sets of
functions-sets of indicator functions. Analysis of these simple sets was cru-
cial for discovery of the concepts that determine the generalization ability,
the so-called capacity concepts of a set of functions. These concepts would
be hard to extract from analysis of more sophisticated sets of functions-sets
of real-valued functions. Capacity control became one of the main tools in
the new approach.
Later, in the 1980s, when the theory of this approach had been essentially
developed, it was noted that a generalized version of one of the problems
at the cornerstone of statistics (the Glivenko-Cantelli problem) leads to the
same analysis that was developed for the theory of learning and generaliza-
1

2
INTRODUCTION: THE PROBLEM OF INDUCTION AND STATISTICAL INFERENCE
tion in pattern recognition. In the mid-19HOs these results were rewritten in
traditional statistical terms. Nevertheless. the new paradigm in statistics was
developed at the periphery of statistical science as an attempt to analyze the
prohlem of generalization in the simplest model of statistical inference-the
pattern recognition prohlem.
This fact constitutes an important methodological discovery. The pattern
recognition prohlem is one of the simplest models of inductive inference.
Results for this model can he generalized for other (more complex) models
using more or less standard mathematical techniques. Therefore in studies
of statistical inference. the pattern recognition model plays the same role as
the drosophila fly in studies of genetic structures.
[n this hook we try to develop a general approach to statistical inference.
For this purpose we analyze the pattern recognition prohlem in great de-
tail and then generalize the ohtained results for solving main prohlems of
statistical inference.
0.2
TWO APPROACHES TO STATISTICAL INFERENCE: PARTICULAR
(PARAMETRIC INFERENCE) AND GENERAL (NONPARAMETRIC
INFERENCE)
The elements of statistical inference have existed for more than 200 years
(one can lind them in the works of Gauss and Laplace): however. the sys-
tematic analysis of these prohlems started only in the late 1920s.
By that time. descriptive statistics was mostly complete: [t was shown that
there are different statistical laws (distribution functions) that descrihe well
many events of reality. The next question to he investigated was linding a
reliahle method of statistical inference. The prohlem was as follows:
Gin'll a collection of empirical data originating from some fimctionlll de-
pendency. infer this depmdencr
In the 1920s the analysis of methods of statistical infen:nce hegan. Two
hright events signaled this start:
I. Fisher introduced the main models of statistical inference in the uni-
tied framework of parametric statistics. He descrihed different prohlems
or estimating functions rrom given data (the prohlems of discriminant
analysis. regression analysis, and density estimation) as the prohlems of
parameter estimation of specilic (parametric) models and suggested one
method for estimating the unknown parameters in all these models-
the maximum likelihood method.
'1
Glivenko. Cantelli. and Kolmogorov started a general analysis of sta-
tistical infen:nce. Glivcnko and Cantelli proved that the empirical dis-
trihution function always converges to the actual distrihution function.
Kolmogorov found the asymptotically exact rate of this convergence.

0.2 TWO APPROACHES TO STATISTICAL INFERENCE
3
The rate turns out to be fast (exponential) and independent of the
unknown distribution function.
These two events determined two main approaches to statistical inference:
1. The particular (parametric) inference, which aims to create simple
statistical methods of inference that can be used for solving real-life
problems, and
2. The general inference, which aims to find one (induction) method for
any problem of statistical inference.
The philosophy that led to the creation of parametric statistical inference is
based on the following belief:
The investigator knows the problem to be analyzed rather well. He knows
the physical law that generates the stochastic properties of the data and
the function to be found up to a finite number of parameters. Estimat-
ing these parameters using the data is considered to be the essence of
the problem of statistical inference. To find these parameters using in-
formation about the statistical law and the target function, one adopts
the maximum likelihood method.
The goal of the theory is to justify this approach (by discovering and
describing its favorable properties).
The philosophy that led to general statistical inference is different:
One does not have reliable a priori information about the statistical law
underlying the problem or about the function that one would like to
approximate. It is necessary to find a method to infer an approximating
function from the given examples in this situation.
The corresponding theory must:
1. Describe conditions under which one can find in a given set of func-
tions the best approximation to an unknown function with an increasing
number of examples.
2. Find the best method of inference for a given number of examples.
Kolmogorov's discovery that the empirical distribution function has a univer-
sally (i.e., independent of the actual distribution function) asymptotic expo-
nential rate of convergence fostered hope that the general type of inference
is feasible. The results of Glivenko, Cantelli, and Kolmogorov started more
than 40 years of research on general statistical inference before it culmindted
in inductive methods.
The theory of these methods is the subject of this book.

4
INTRODUCTION: THE PROBLEM OF INDUCTION AND STATISTICAL INFERENCE
0.3
THE PARADIGM CREATED BY THE PARAMETRIC APPROACH
In contrast to the slow development of general inductive inference, the para-
metric approach to inductive inference was developed very quickly. In fact.
the main ideas of parametric inference were developed in the 1930s, and dur-
ing the next 10 years the main dements of the theory of parametric inference
were introduced.
The 3D-year period between 1930 and 1960 can be called the '"golden
age" of parametric inference. During this period, one approach to statistical
inference dominated: the approach based on parametric paradigms. Only one
theory of statistical inference was accepted, namely the theory that served
the parametric paradigm.
Of course, the results of Glivenko, Cantelli, and Kolmogorov were known:
however, they were considered as inner technical achievements that are nec-
essary for the foundation of statistical theory rather than an indication that
there could be a different type of inference which is more general and more
powerful than parametric inference.
In any case, almost all standard statistical textbooks considered the prob-
lem of inference from the point of view of the parametric paradigm, and thus
several generations of statisticians were educated in this framework. t
The philosophy of the classical parametric paradigm is based on the fol-
lowing three beliefs:
I.
7() find a fimct;cmal depemlenc}' from the data, the statistician is ahle to
define a set offunctiot1S, linear in their parameter,\', that contain a Rood
approximation to the desired functio/l. The nwnher of free parameters
descrihing this set is small.
This belief was supported by referring to the Weierstrass theorem. according
to which any continuous function can be approximated on a finite inter-
val by polynomials (functions linear in their parameters) with any degree
of accuracy. The idea was that if polynomials can approximate the desired
function well, then a smart statistician can define a set of functions, linear in
their parameters (not necessarily polynomials) with a small number of free
parameters that provides a good approximation to the desired function.
,
Tht' statistical lal1' llIulerl.ving the stochastic component of rnost real-life
prohlems is the normal law.
This belief was supported by referring to the Central Limit Theorem, which
states that under wide conditions the sum of a large number of random
I It
I~ fair to note that in the time before wide availability of computers (before I960s) the g.oal
ot applicd statistics was to crcatc computationally simple methods. and parametric statistics wa...
rcsponsi\ L' to thcsc limitations.

0.4 SHORTCOMING OF THE PARAMETRIC PARADIGM
5
variables is approximated by the normal law. The idea was that if randomness
in the problem is the result of interaction among a large number of random
components, then the stochastic element of the problem is described by the
nonnallaw.
3. The induction engine in this paradigm-the maximum likelihood method
-is a good tool for estimating parameters.
This belief was supported by many theorems about conditional optimality of
the method (optimality in a restricted set of methods and/or in the asymptotic
case). The maximum likelihood method was hoped to be a good tool for
estimating parameters of models even for small sample sizes.
Note that these three beliefs were also supported by the philosophy:
If there exists a mathematical proof that some method provides an asymp-
totically optimal solution, then in real life this method will provide a
reasonable solution for a small number of data samples.
0.4
SHORTCOMING OF THE PARAMETRIC PARADIGM
In the 1960s, the wide application of computers for solving scientific and
applied problems started. Using computers, researchers for the first time tried
to analyze sophisticated models (that had many factors) or tried to obtain
more precise approximations. These efforts immediately revealed shortcom-
ings of the parametric paradigm in all three of the beliefs upon which the
paradigm was based.
1. First, the computer analysis of large multivariate prohlems resulted in
the discovery of the phenomenon that R. Bellman called "the curse of
dimensionality." It was observed that increasing the number of factors
that have to be taken into consideration requires exponentially increas-
ing the amount of computational resources. For example, according to
the Weierstrass theorem, any continuous function (of n variables) de-
fined on the unit cube can be approximated by polynomials with any
degree of accuracy. However, if the desired function has only s deriva-
tives, then using polynomials with N terms one can only guarantee the
accuracy 0 (N-s/n). If the unknown function is not very smooth (i.e.,
it possesses only a small number of derivatives), then to obtain the de-
sired level of accuracy one needs an exponentially increasing number
of tenns with an increasing number, n, of variables.
Therefore, in real-life multidimensional problems in which one may
consider dozens or even hundreds of variables, the belief that one can
define a reasonably small set of functions that contains a good approx-
imation to a desired one looks naive.

6
INTRODUCTION: THE PROBLEM OF INDUCTION AND STATISTICAL INFERENCE
,
Approximately at the same time, hy analyzing rcal-life data. Tukey
demonstrated that the statistical components of real-life prohlems can-
not he described hy only classical statistical distrihution functions. Oflen
real-life distrihutions arc different, and one must take this difference
into account in order to construct effective algorithms.
~. In addition, James and Stein showed that even for simple prohlems of
density estimation, such as the prohlem of estimating the location pa-
rameters of n > 2 dimensional
normal
law
with
unit
covariance
matrix (for estimating means), the maximum likelihood method is not
the hest one. They suggested an estimator that for this specitic prohlem
is uniformly helter than the maximum likelihood estimator.
Thus. all three heliefs on which the classical paradigm relied turned out to
he inappropriate for many real-life prohlems. This had an enormous conse-
LJuence for statistical science: It looked as if the idea of constructing statistical
inductive inference methods for real-life prohlems had failed.
0.5
AFTER THE CLASSICAL PARADIGM
The discovery of difticulties with the classical paradigm was a turning point in
statistics. Many statisticians reconsidered the main goal of the entire statisti-
cal analysis husiness. A new direction in statistics was declared, the so-called
""data analysis." where the goal was to help researchers perform inductive
inferences from data, rather than to do so using purely statistical techniLJues.
Therefore. various techniques were developed for visualizing data. for clus-
tering data, for constructing fe(ltures. and so on. In other words. tools were
developed that would enahle a researcher to make informal inferences.
One can summarize the philosophy of the data analysis approach as the
following declaration:
Inducfirc inference is ([n informal ([cf, ([nd sfafisficians confrihwc fo fhi.\ ([('{
onlr hr fechnical ([ssistance.
One must note, however, that tremendous efforts have heen made to save
the classical paradigm hy generalizing all three of its main presumptions:
I. In the 1lJ60s, P Huher developed the so-called whllsf approach to para-
metric statistics, where one does not need to specify a statistical law in
order to estimate a function from a given parametric set of functions.
,
In the 1970s. in an attempt to usc a wider set of functions. J. Nedler
and R. Wedernhurn suggested the so-called generalized linc([r moder,.
Attempts to usc wide sets of functions created the prohlem of model
selection. Several asymptotic results regarding solutions of this prohlem

0.6 THE RENAISSANCE
7
were obtained. (However, understanding of the model-selection prob-
lem as a small sample size problem came later when a new inductive
paradigm was created. We will discuss the small sample size problem
in this book.)
3. In the 1980s L. Breiman, P. Huber, and J. Friedman started to consider
special types of functions, nonlinear in their parameters, and started to
use the regularized empirical risk minimization method instead of the
maximum likelihood method.
Nevertheless, in spite of these and many other achievements, the limitations
of the classical parametric paradigm remain, and therefore currently not many
researchers consider the classical paradigm as the main approach to statistical
inference.
0.6
THE RENAISSANCE
The return to the general problem of statistical inference occurred so imper-
ceptibly that it was not recognized for more than 20 years.
In 1958, F. Rosenblatt, a physiologist, suggested a learning machine
(computer program) called the Perceptron for solving the simplest learning
problem: namely, the classification (pattern recognition) problem. The con-
struction of this machine reflected some existing neurophysiological models
of learning mechanisms. With the simplest examples, F. Rosenblatt demon-
strated that the Perceptron could generalize. After the Perceptron, many
different types of learning machines were suggested. They didn't generalize
worse than the Perceptron, but they had no neurobiological analogy.
The natural question arose:
Does there exist something common in these machines? Does there exist a
general principle of inductive inference that they implement?
Immediately a candidate was found for such a general induction princi-
ple: the so-called empirical risk minimization (ERM) principle. In order to
achieve good generalization on future (test) examples, the ERM principle
suggests a decision rule (an indicator function) that minimizes the number
of training errors (empirical risk). The problem was to construct a theory for
this principle.
At the end of the 1960s, the theory of ERM for the pattern recognition
problem was constructed.t This theory included both (a) the general qual-
itative theory of generalization that described the necessary and sufficient
t Sec monograph by V. N, Vapnik and A. Ya. Chervonenkis Theory of Pattern Remgllitioll.
Nauka, Moscow, 1974,416 pages. German translation: W. N. Wapnik and A. Ya. Tscherwoncnkis
Theorie der Zeichenerkennung, Akademia, Berlin, 1979,352 pages.

8
INTRODUCTION: THE PROBLEM OF INDUCTION AND STATISTICAL INFERENCE
conditions for consistency of the ERM induction principle (valid for any set
of indicator functions-that is, {O, I} valued functions on which the machine
minimizes the empirical risk) and (b) the general (jlltlfltitmiw theory that
descrihed the hounds on the prohability of the (future) test error for the
function minimizing the empirical risk.
It must he noted that the ERM principle was discussed in the statistical
literature several times hefore. The essential difference, however. was that in
the pattern recognition prohlem ERM inference is applied to sets of simple
lillie/iONs-namely to sets of indica/or functions-while in classical statistics
it was applied to various sets of real-valued functions. Within I() years, the
theory of the ERM principle was generalized for sets of real-valued func-
tions as wdl. T However. it was extremely lucky that at the first and the most
important stage of developing the theory. when the main concepts of the
entire theory had to he defined, simple sets of functions were considered.
Generalizing the results obtained for estimating indicator functions (pattern
recognition) to the problem of estimating real-valued functions (regressions.
density functions. etc.) was a purely technical achievement. To ohtain these
genaalizations. no additional concepts needed to he introducl..:d.
0.7
THE GENERALIZATION OF THE GLiVENKo-CANTELLI-
KOLMOGOROV THEORY
Application of thl..: ERM principle does not necessarily guarantee consistency
(i.I..: .• convergence to thl..: best possible solution with an increasing numbl..:r of
ohservations). Therefore, the main issues that drove the development of the
ERM theory were as follows:
I. To descrihe situations under which the method is consistent-that is. to
Hnd the necessary and sufficient conditions for which the ERM method
defines functions that converge to the best possible solution with an
increasing number of observations. The resulting theorems therehy de-
scrihe the qualitative model of ERM inference.
'1
To estimate the quality of the solution obtained on the basis of the
given sample size-that is, to estimate both the prohability of error
for the function that minimizes the empirical risk on the given set of
training examples and to estimate how close this probability is to the
smallest possible for the given set of functions. The resulting theorems
characterize the generalization ability of the ERM principle.
To address both these issues for the pattern recognition problem. it \vas
I Sec lllonograph hy V. N. Vapnik Elfin/llfioll of D~·PClldcIlCic.1 BlIscd Oil bllpiriclIl Dllfil. Nauka.
I\lll'U1W. 1')7\). 44:! page,. Engli,h lran.,[alion: Springer-Verlag. New York. 191C. 4()() page,.

0.7 THE GENERALIZATION OF THE GliVENK0-CANTElI.I-KOlMOGOROV THEORY
9
necessary to construct a theory that can be considered as a generalization of
the Glivenko-Cantelli-Kolmogorov results.
According to the classical law of large numbers, the frequency of any
event converges to the probability of this event with an increasing number
of observations. However, the classical law of large numbers is not sufficient
to assert that for a given set of events the sequence of probabilities of events
with the smallest frequency converges to the smallest possible value for this
set (i.e., to assert the consistency of the ERM method). Instead, it was proven
that in order to ensure the consistency of the ERM method, it is necessary and
sufficient that the uniform law oflarge numbers holds (uniform over all events
of the set of events defined by the set of indicator functions implemented by
the learning machine).
One can reformulate the Glivenko-Cantelli theorem as an assertion that
for some specific set of events there exists a uniform law of large numbers
and the Kolmogorov's bound as the bound on the asymptotic rate of uniform
convergence of the frequencies to their probabilities over this specific set of
events. Therefore, to construct a general theory of the ERM method for pat-
tern recognition, one has to generalize the Glivenko-Cantelli-Kolmogorov
theory; that is:
1. For any given set of events, to determine whether the uniform law of
large numbers holds (i.e., does uniform convergence take place?).
2. If uniform convergence holds, to find the bounds for the nonasymptotic
rate of uniform convergence.
Note that these bounds are generalizations of Kolmogorov's bound in two
respects: They must be valid for a finite number of observations and they
must be valid for any set of events.
This theory was constructed in the late 1960s (Vapnik and Chervonenkis.
1968,1971). The cornerstone in this theory is a collection of new concepts, the
so-called capacity concepts for a set of events (a set of indicator functions).
Of particular importance is the so-called VC dimension of the set of events
(the VC dimension of the set of indicator functions implemented by the
learning machine) which characterizes the variability of the set of events
(indicator functions). It was found that both the necessary and sufficient
conditions of consistency and the rate of convergence of the ERM principle
depend on the capacity of the set of functions implemented by the learning
machine.
In particular, it was proven that for distribution-independent consistency
of the ERM principle, it is necessary and sufficient that the set of functions
implemented by the learning machine has a finite VC dimension. It was
also found that distribution-free bounds on the rate of uniform convergence
depend on the VC dimension, the number of training errors, and the number
of observations.

10
INTRODUCTION: THE PROBLEM OF INDUCTION AND STATISTICAL INFERENCE
0.8
THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
The hounds for the rate of uniform convergence not only provide the main
theoretical hasis for the ERM inference. hut also motivate a new method of
inductive inference.
For any level of confidence, an equivalent form of the hounds denne
hounds on the prohahility of the test error sim/lltaneo/lsly flJr allfimctions or
the learning machine as a function of the numher of training errors, of the
VC dimension of the set of functions implemented hy the learning machine.
and of the numher of ohservations.
This form of the hounds kd to a new idea for controlling the generalization
ahility of learning machines:
To achin'e the smallest hO/lnd on the test error hy controlling (minimi::ing)
the lIwnher of training errors, the machine ((he set or fimctions) with the
smallest VC dimension ,\'hould he used.
These two rel{uirements-to minimize the numher of training errors and
to use a machine (a set of functions) with a small VC dimension-arc con-
tradictory: To minimi/c the numher of training crrors, one needs to choo,;e
a function from a wide set of functions, rather than from a narrow set,
with small VC dimension. Therefore, to lind the hest guaranteed solution,
one has to make a compromise hetween the accuracy of approximation of
the training data and the capacity (the VC dimension) of the machine that
one uses to minimize the numher of errors. Thc idea of minimi/ing the test
error hy controlling two contradictory factors was formalized hy introducing
a new induction principle. the so-called Structural Risk Minimization (SRM)
principle.!
One has to note that the idea of the existence of a compromise in inductive
inference has heen discussed in philosophy for almost 700 years. since William
of Occam proposed in the fourteenth century the general principle known a!'>
Occam's razor:
E:'ntities should not he multiplied heyond lIecessitv.
The attempt to provide Occam's razor with an exact sense underlies these
Jiscussions. The most common intcrpretat ion of Occam's nl/or is:
The simplest explanation is the hest.
The assertion that comes from the SRM theory is different:
SCT !oolnolc un
ra~l' K.

0.9 THE MAIN PRINCIPLE OF INFERENCE FROM A SMAll SAMPLE SIZE
11
The explanation by the machine with the smallest capacity (Ve dimension)
is the best.
Two important points should be mentioned in connection with introducing
the capacity concept (instead of the simplicity concept).
First, capacity determines both the necessary and sufficient conditions for
consistency of learning processes and the rate of convergence of learning
processes. Therefore, it reflects intrinsic properties of inductive inference.
Second, naive notions of complexity (for example, the number of parame-
ters) do not necessarily reflect capacity properly. In this book, we will describe
an example of a simple set of functions that depends on only one parameter
and that has infinite VC dimension, as well as a set of functions with a billion
parameters that has low VC dimension. We will see that if the VC dimen-
sion of a set of functions is infinite (even if we consider a set of "simple"
functions), then the so-called situation of nonfalsifiability (described by K.
Popper in his analysis of philosophy of science) prevents generalization from
taking place. On the other hand, we will also describe a learning machine,
which uses a high-order of polynomials (say five) in a high-dimensional space
(say 400) which has a good generalization ability due to capacity control.
The discovery that the generalization ability of the learning machine de-
pends on the capacity of the set of functions implemented by the learning
machine which differ from the number of free parameters is one of the most
important achievements of the new theory.
Capacity control in inductive inference makes it possible to take into
account the amount of training data. This was discovered in the mid-1970s
for the pattern recognition problem; and by the beginning of 1980, all of the
results obtained for sets of indicator functions were generalized for sets of
real-valued functions (for the problem of regression estimation).
Capacity control in a structured set of functions became the main tool
of the new paradigm. It is especially important when one tries to make an
inference based on a small sample sizes.t
0.9
THE MAIN PRINCIPLE OF INFERENCE FROM A SMALL
SAMPLE SIZE
The key idea for creating effective methods of inference from small sample
sizes is that one performs inference in situations where one possesses a re-
stricted amount of information. To take this fact into account, we formulate
the following Main Principle:
t We consider the size f of data to be small for estimating functions on the basis of the set of
functions with VC dimension h if the ratio f/h is small (say (/h < 20).

12
INTRODUCnON: THE PROBLEM OF INDUCTION AND STATlSnCALINFERENCE
Iryo// possess (/ restricted amulllIt uf information fur sulving sume l,rohlem,
try to solve the prohlem directly and never so!\'e {/ mure general prohlem
as all intermediate step. It is possihle that the {/l'ailahle illfurmatioll is
slltjicielll.ti)f a direct soilltiull hilt is insllfjiciem.ti)r solving a mure general
illtermediate prohlem,
In spite.: of the obviousness of the Main Principle, it is not easy to follow
it. At kast the classical approach to statistical inference does not follow this
principk, Indeed, in order to estimate decision rules, the classical approach
suggests estimating densities as a fIrst step (recall the classical parametric
paradigm hased on the maximum likelihood method). Note that estimating
probability densities is a universal problem of statistics. Knowing the den-
sity, one can solve many different problems, For example. one can estimate
the conditional density. which can be described as a ratio of two densities.
Therefore, in generaL density estimation is a hard (ill-posed) problem that
re4uires a large number of observations to be solved well.
However. even if one needs to estimate the conditional density. one must
try to lind it directly, and not as a ratio of two estimated densities. Note that
often conditional densities can be approximated by low-dimensional functions
even if the densities are high-dimensional functions.
In an attempt to solve the function estimation problem directly, we derived
bounds on the quality of any possible solution (bounds on the generalization
ability) and introduced a method to control the generalization ability by
minimizing these bounds. This brought us to the SRM inductive principk
which explicitly incorporates capacity control.
Following the logic of the Main Principle a step further brings us to an
idea of inference that goes beyond induction.
In many real-life problems. the goal is to find the values of an unknown
function only at points of interest (i.e.. on the test set). To solve this probkm.
the established paradigm uses a two-stage procedure: At the first (induction)
stage we estimate the function from a given set of functions using an induc-
tion principle. while at the second (deduction) stage we use this function to
evaluate the values of the unknown function at the points of interest. At thL'
lirst stage of this two-stage scheme. we thus solve a problem that is more
general than the one we need to solve. To estimate an unknown function
means to estimate its values at all points in the domain of this function. Why
solve a much more general problem-function estimation-if we only need
to estimate the values of a function at a few (> 1) points of interest'? In sit-
uations where we have a restricted amount of information. it is possible that
we can estimate the values of the unknown function reasonably well at given
points of interest but cannot estimate the values of the function well at all
points of its domain.
The din:ct estimation of values of a function only at points of interest using
a given set of functions forms a new type of inference which can be called
trllnsdllctive inference. In contrast to the inductive solution that derives results

0.10 WHAT THIS BOOK IS ABOUT
13
in two steps, from particular to general (the inductive step) and then from
general to particular (the deductive step), the transductive solution derives
results in one step, directly from particular to particular (the transductive
step).
Therefore the classical paradigm often contradicts the Main Principle. To
avoid these contradictions a new approach was developed.
0.10
WHAT 'rHIS BOOK IS ABOUT
This book is devoted to the theory of inductive inference, a model of which
is statistical inference (inference for the simplest statistical models).
The main problem in inductive inference lies in philosophy, in finding
the principles of inferencef rather than in the mathematical analysis of the
formulated principles. However, to find the principles of inference that reflect
the phenomenon of human inference, one cannot utilize two thousand years
of philosophical heritage. Recall that when in the beginning of the 1960s
the problem of modeling learning processes on computers arose, the only
inspiration for constructing learning machines was a physiological analogy
(the Perceptron), but not general philosophical principles.
For this reason, it is important to analyze in great detail a simple math-
ematical problem of induction and try to discover the general principles of
inference from this analysis. Such a simple mathematical problem is the pat-
tern recognition problem.t
The following three claims constitute the most important results of ana-
lyzing the pattern recognition prohlem and its generalization, the estimation
of real-valued functions:
1. The theory of induction is based on the uniform law of large numbers.
2. Effective methods of inference must include capacity control.
3. Along with inductive inference there exists transductive inference which
in many cases may be preferable.
Not all of these claims are justified equally well.
t From this point of view, the methodology of research of inductive inference is similar to the
methodology of physical science: There exists some phenomenon of nature for which a model
should be found. The mathematical analysis presented here is a tool that helps one to find this
model. The result of any analysis should be confirmed by experiments.
IThe simplest induction problem is estimating the function from a set of constants-that is.
functions that take on only one value. This was the case actually under consideration when
the classical theory was developed. However. the structure of the set of constant functions
is too simple. since any subset of constant functions has the same VC dimension. equal to
one. Therefore. the simplest model of induction that requires capacity control is the pattern
recognition problem.

14
INTRODUCTION: THE PROBLEM OF INDUCTION AND STATISTICAL INFERENCE
I. The analysis of the uniform law of large numbers and its relation to
the problem of induction inference is almost complete. It includes both
the qualitative analysis of the model (the analysis of the necessary and
sufficient conditions for consistency) and the quantitative analysis of the
model (the theory of bounds). The largest part of this book (Chapters
3. -\.. 5. 14. 15. and 16) is devoted to this analysis.
,
In spite of the fact that the capacity control principle (the SRM princi-
ple) was discovered in the middle of the ILJ70s. the development of this
principle-which led to new types of algorithms. the so-called Support
Vector Machines (SVM )-started only in the lLJLJOs. So far. we have
only the lirst results of the theoretical analysis. along with the lirst re-
sults of practical applications. Chapters 6. 10. II. 12. and 13 are devoted
to this subject. Chapter 7 is closely related to capacity control methods.
It descrihes a theory of stochastic ill-posed prohlems and its application
to the prohlem of density and conditional density estimation.
.~. Lastly. the theory of transductive inference is only at a very early stage
of development. We have described only very general comhinatorial
ideas on factorizing a given set of functions based on a given set of
data. However. new methods for capacity control developed in the last
fe\\ years (described in Chapters 10. 11. 12. and 13) appear to be a
good tool for implementing transductive inference. Only one chapter
(Chapter H) is devoted to analysis of this type of inference.
In spite of the fact that this book explicitly deals only with the mathe-
matical problems of inductive inference. it implicitly contains two additional
subjects of dLscussion: (I) a discussion of the general prohlem of induction
and (:2) a discussion of the existence of various methods of inference. namely.
inference through induction (generalization) amI inference through transduc-
tion. the direct (ad hoc) inference. In Chapter 3. there is a direct comparison
of the capacity concepts with some fundamental concepts developed hy K,
Popper in the philosophy of science. The prohlem of transducti\'e inference
has no such remarkahle achievement in philosophy as Popper's theory. The
existence of a direct type of inference is still under discussion in philosophy,
Therefore any e\'idence that an advanced transductive inference for comput-
ers exists is \'ery important for understanding the nature of human reason.
This hook was almost linished when I realized that it would not he easy
for a reader to discern the general philosophy (which is nontrivial) that ties
togdher many technical details (some of which are very sophisticated l. There-
fore. I decided to stop working on this book for a while and to write a short.
simplilied version that would contain neither proofs nor unnecessary teclll1i-
cal uetails. hut would contain informal reasoning and comments, In 1995. I
puhlisheu that hook. 1
\ 1,ldll1lll 'J. Vapni\.. I'ill' ,,,"Ullin' (if SlUIIIlitU! IA'IIUlIIlg r!ll'(i/T.
Spril1~l'r-\'nlag,IlJl)'i, lXlJ page'.

0.10 WHAHHIS BOOK IS ABOUT
15
In contrast to the short one, the present book contains the proofs of all
the main assertions. Nevertheless, it is not merely a collection of proofs of
the statements described in The Nature of Statistical Learning Theory. More
details of the theory made it possible to display more deeply both the details
of the philosophy and the details of the new methods.
The three years between completion of the short book and this one were
very fruitful in developing SRM methodology. During this time, new meth-
ods of function estimation in multidimensional spaces based on the SVM
techniques were developed. These methods go beyond learning theory. They
can be considered as a general approach to function representation in high-
dimensional spaces that in many cases can overcome the "curse of dimen-
sionality." The details of these methods are described in the book.
As with the short one, this book is devoted to an approach that in many
respects differs from classical statistical approaches. One can consider it as an
attempt to create a new paradigm in statistics that depends less on heuristics
and instead is connected to the inductive theory of inference.
It is my hope that the book displays how deeply learning theory is con-
nected to both induction theory and the fundamentals of statistics and how
these connections give rise to effective practical methods of inference.


I
THEORY OF LEARNING
AND GENERALIZATION
Part I analyses factors responsible for generalization and shows how to control
these factors in order to generalize well.


1
TWO APPROACHES TO
THE LEARNING PROBLEM
In this chapter we consider two approaches to the learning problem-the
problem of choosing the desired dependence on the basis of empirical data.
The first approach is based on the idea that the quality of the chosen
function can be evaluated by a risk functional. In this case the choice of the
approximating function from a given set of functions is a problem of min-
imizing the risk functional on the basis of empirical data. This problem is
rather general. It embeds many problems of statistics. In this book we con-
sider three of them: pattern recognition, regression estimation, and density
estimation.
The second approach to the learning problem is based on estimating
desired stochastic dependencies (densities, conditional densities, conditional
probabilities). It requires solution of integral equations (determining these
dependencies) in situations where some elements of the equations are known
only approximately. Using estimated stochastic dependence, the pattern recog-
nition and regression estimation problems can be solved as well. However,
the function obtained by solution of the integral equations provides much
more details than is required for these problems. The price we pay for these
details is the necessity to solve ill-posed problems.
1.1
GENERAL MODEL OF LEARNING FROM EXAMPLES
Consider the following model of searching for functional dependency, which
we call the model of learning from examples.
The model contains three elements (Fig 1.1):
1. The generator of the data (examples), G.
19

20
I TWO APPROACHES TO THE LEARNING PROBLEM
G
FIGURE 1.1. A model of learning from examples. During the learning process, the
learning machine observes the pairs (x, y) (the training set). Atter training, the machine
must on any given x return a value Yo The goal is to return a value y which is close to
the supervisor's response y.
')
The target operator (sometimes called supervisor's operator or. for sim-
plicity. supervisor), S.
J. The learning machine. LM.
The generator G is a source of situations that determines the environment in
which the supervisor and the learning machine act. In this book. we consider
the simplest environment: G generates the vectors x E X independently and
identimlly distribllted (i.i.d.) according to some unknown (but fixed) proba-
bility distribution function F(x).
These vectors arc inputs to the target operator (supervisor); the target
operator returns the output values y. The target operator. which transforms
the vectors x into values y. is unknown. but we know that it exists and docs
not change.
The learning machine observes f pairs
(the training set) which contain input vectors x and the supervisor's response
y. During this period, the learning machine constructs some operator which
will be used for prediction of the supervisor's answer Yi on any specific vector
x/ generated by the generator G. The goal of the learning machine is to
construct an appropriate approximation.
To be a mathematical statement, this general scheme of learning from
examples needs some clarification. First of all, we have to describe what kind
of operators are used by the supervisor. In this book. we suppose that the
supervisor returns the output y on the vector x according to a conditional
distribution function F(ylx) (this includes the case when the supervisor uses
some function y = f(x)).
Thus. the learning machine observes the training set. which is drawn ran-
domly and independently according to a joint distribution function F(x. y) =
F(x)F(Ylx). (Recall that we do not know this function but we do know that
it exists.) Using this training set, the learning machine constructs an approx-
imation to the unknown operator.
To construct an approximation, the learning machine chooses one of the

1.2 THE PROBLEM OF MINIMIZING THE RISK FUNCTIONAL FROM EMPIRICAL DATA
21
two goals to pursue:
• To imitate the supervisor's operator: Try to construct an operator which
provides for a given generator G, the best prediction to the supervisor's
outputs.
• To identify the supervisor's operator: Try to construct an operator which
is close to the supervisor's operator.
There exists an essential difference in these two goals. In the first case. the
goal is to achieve the best results in prediction of the supervisor's outputs for
the environment given by the generator G. In the second case, to get good
results in prediction is not enough; it is required to construct an operator
which is close to the supervisor's one in a given metric. These two goals of
the learning machine imply two different approaches to the learning problem.
In this book we consider both approaches. We show that the problem
of imitation of the target operator is easier to solve. For this problem, a
nonasymptotic theory will be developed. The problem of identification is
more difficult. It refers to the so-called ill-posed problems. For these prob-
lems, only an asymptotic theory can be developed. Nevertheless, we show
that the solutions for both problems are based on the same general prin-
ciples.
Before proceeding with the formal discussion of the learning problem. we
have to make a remark. We have to explain what it means "to construct
an operator" during the learning process. From a formal point of view, this
means that the learning machine can implement some fixed set of functions
given by the construction of the machine. During the learning process, it
chooses from this set an appropriate function. The rule for choosing the
function is one of the most important subjects of the theory and it will be
discussed in this book. But the general assertion is:
The learning process is a process of choosing an appropriate function from
a given set offunctions.
We start our discussion of the learning problem with the problem of im-
itation. It is based on the general statistical problem of minimizing the risk
functional on the basis of empirical data. In the next section we consider a
statement of this problem, and then in the following sections we demonstrate
that different learning problems are particular cases of this general one.
1.2
THE PROBLEM OF MINIMIZING THE RISK FUNCTIONAL
FROM EMPIRICAL DATA
Each time the problem of selecting a function with desired quality arises, the
same model may be considered: Among the totality of possible functions, one

22
1 TWO APPROACHES TO THE LEARNING PROBLEM
looks for the one that satislies the given quality criterion in the best possihle
manner.
Formally this means that on the subset Z of the vector space R". a set set
or admissihk functions {g(;)}, ;: E Z, is given. and a functional
R=~R(g(;:))
( 1.1 )
( [.2)
is dc/ined which is the criterion of quality of the chosen function. 1t is then
required to lind the function g' (::.) from the set {g(::.)} which minimizes the
functional (1.1 ). (We shall assume that the minimum of the functional corre-
sponds to the hest quality and that the minimum of ( 1.1) exists in {g(;)}.)
In the case when the set of functions {g(.::)} and the functional R(g(;:)) arc
explicitly given. the search for the function g' (::.) which minimizes R(g(;:)) is
the subject of the calculus of variations.
In this book, another case is considered. when a prohahility distribution
function F(;,) is delined on Z and the functional is defined as the mathemat~
ieal expectation
R(g(z)) -= /
L(,::.g(z)) liFt;:),
where function L{z.g(z)) is integrable for any g(::.) E {g(;,)}. The problem is
to minimize the functional (1.2) in the case when the probability distrihution
F( z) is unknown but the sample
;'1, .... z!
( 1.~)
of observations drawn randomly and independently according to F(;:) is avail-
able.
Sections 1.3. 1.4. and 1.5 shall verify that the basic statistical problems
related to function estimation problem can be reduced to the minimization
of (1.2) based on empirical data (1.3). Meanwhile. we shall note that there is
a substantial difference between prohlems arising when the functional (1.1)
is minimized directly and those encountered when the functional (1.2) is
minimized on the hasis of empirical data (1.3).
In the case of minimizing (1.1), the problem is to organize the search for
a function g'{z) from the set {g(z)} which minimizes (1.1). When (1.2) is
to he minimized on the basis of empirical data (1.3). the hasic problem is
to formulate a constructive criterion for choosing the function rather than
organizing the search of the functions in {g(.;:)}. (The functional (1.2) by
itself cannot serve as a selection criterion. since the measure F(z) involved
in it is unknown.) Thus. in the lirst case. the question is:
flow Cllll we ohtain the minimllm of the filllctiolla! in the givell set or tilflC-
tiollS:
While in the second case the question is:

1.2 THE PROBLEM OF MINIMIZING THE RISK FUNCTIONAL FROM EMPIRICAL DATA
23
What should be minimized in order to select from the set {g(z)} a function
which will guarantee that the functional (1.2) is small?
Strictly speaking, one cannot minimize (1.2) based on (1.3) using methods
developed in optimization theory. The minimization of the functional (1.2) on
the basis of empirical data (1.3) is one of the main problems of mathematical
statistics.
When formulating the minimization problem for functional (1.2), the set
of functions g(z) will be given in a parametric form {g(z, a),
a E A}.t Here
a is a parameter from the set A such that the value a = a* defines the
specific function g(z, a*) in the set g(z, a). Finding the required function
means determining the corresponding value of the parameter a E A.
The study of only parametric sets of functions is not a restriction on the
problem, since the set A, to which the parameter a belongs, is arbitrary: It
can be a set of scalar quantities, a set of vectors, or a set of abstract elements.
In the new notation the functional (1.2) can be rewritten as
where
R(a) =I Q(z, a) dF(z),
Q(z, a) = L(z,g(z, a)).
a E A,
(1.4)
The function Q(z \a), which depends on two variables z and a, is called the
loss function.
The problem of minimizing functional (1.4) admits a simple interpretation:
It is assumed that each function Q(z, a*),
a* E A (i.e., each function of z
for a fixed a = a*), determines the amount of the loss resulting from the
realization of the vector z. The expected loss (with respect to z) for the
function Q(z, a*) is determined by the integral
R(a*) = I Q(z, a*) dF(z).
This functional is called the risk functional or the risk. The problem is to
choose in the set Q(z, a), a E A, a function Q(z, ao) which minimizes the
risk when the probability distribution function is unknown but random inde-
pendent observations z\, "', Zf are given.
Remark. Let us clarify the phrase "probability distribution function is un-
known." Denote by Po the set of all possible probability distribution func-
tions on Z and by P some subset of probability distribution functions from
Po·
t We shall always omit the braces when writing a set of functions. A single function is distin-
guished from a set of functions by indicating whether the parameter a is fixed or not.

24
1 TWO APPROACHES TO THE LEARNING PROBLEM
We will distinguish between two cases:
I. Case where we have no information about the unknown distribution
function. (We have only lhe lrivial information that F(z.) E Po.)
')
Case where we have nontrivial information about the unknown distri-
bution function. We know that F (::.) belongs to the subset P which does
not coincide wilh Po.
In this book, we consider mostly the first case, where we have no a priori
information about the unknown distribution function. However. we will con-
sider the general method for constructing a theory which is valid for any
given set of probability measures.
The problem of minimizing the risk functional (1.4) on the basis of empir-
ical data ( [.3) is rather general. It includes in particular lhree basic statistical
prohlems:
1. The problem of paltern recognition
')
The problem of regression estimalion
3. The problem of density estimation
In the next seclions we shall verify lhal all these problems can be reduced
to the minimization of the risk functional (1.4) on the basis of the empirical
data (1.3).
1.3
THE PROBLEM OF PAnERN RECOGNITION
The prohlem of pattern recognition was formulated in the late 1950s. In
essence it can be stated as follows: A supervisor observes occurring situa-
lions and determines to which of k classes each one of them belongs. It is
required to construct a machine which. after observing the supervisor's clas-
sification, carries out the classification approximately in the same manner as
the supervisor.
Using formal language, this statement can be expressed as follows: In a cer-
tain environment characterized by a probability distribution function F(x),
situation x appears randomly and independently. The supervisor classifies
each situations into one of k classes. We assume that the supervisor car-
ries out this classification using the conditional probability distribution func-
tion F(wlx), where wE {O, l. ...,k -I} (w = p indicates that the supervisor
assigns situation x to the class number p).t
1This is the most general case which includes a case when a supervisor classifies
~ituati()ns .\
lIsing a function w = l(x).

1.3 THE PROBLEM OF PATrERN RECOGNITION
25
Neither the properties of the environment F(x) nor the decision rule of
the supervisor F(wlx) are known. However, we do know that both functions
exist. Thus, a joint distribution F(w, x) = F(wlx)F(x) exists.
Now, let a set of functions ep (x, a),
a E A, which take only k values
{O, 1, ..., k - I} (a set of decision rules), be given. We shall consider the sim-
plest loss function
{
0
if w = ep
L(w,ep)=
1
ifw=f:ep.
The problem of pattern recognition is to minimize the functional
R(a) =IL(w,ep(x, a)) dF(w,x)
(1.5)
(1.6)
on the set of functions ep (x, a), a E A, where the distribution function F(w, x)
is unknown but a random independent sample of pairs
(1.7)
is given. For the loss function (1.5), the functional (1.6) determines the prob-
ability of a classification error for any given decision rule ep (x, a) .
The problem, therefore, is to minimize the probability of a classification
error when the probability distribution function F(w, x) is unknown but the
data (1.7) are given.
For simplicity consider the two-class classification problem (i.e., w E {O, I})
where we use the simplest loss function (1.5).
Thus, the problem of pattern recognition has been reduced to the problem
of minimizing the risk on the basis of empirical data. The special feature of
this problem is that the set of loss functions Q(z, a), a E A, is not arbitrary
as in the general case described in Section 1.2. The following restrictions are
imposed:
• The vector z consists of n + 1 coordinates: coordinate w, which takes on
only a finite number of values (two values for a two classes problem).
and n coordinates x l , ... , x n which form the vector x .
• The set of functions Q(z, a), a E A. is given by
Q(z, a) = L(w, ep (x, a)),
aEA
and also takes on only a finite number of values (zero and one for the
simplest loss function).
This specific feature of the risk minimization problem characterizes the pat-
tern recognition problem. The problem of pattern recognition forms the sim-
plest learning problem because it deals with the simplest loss function. The
loss function in the pattern recognition problem describes a set of indicator
functions-that is, functions that take only two values, zero and one.

26
1 TWO APPROACHES TO THE LEARNING PROBLEM
1.4
THE PROBLEM OF REGRESSION ESTlMA'rtON
Two sets of elements X and Yare connected by a functional dependence
if to each dement x E X there corresponds a unique element y E Y. This
relationship is called a function if X is a set of vectors and Y is a set of
scalars.
However. there exist relationships (stochastic dependencies) where to each
vector x there corresponds a number y which we obtain as a result of random
trials. For each x.let a distribution F(Ylx) be defined on Y according to which
the selection of the value of y is implemented. The function of the conditional
prohability expresses the stochastic relalionship between y and x.
Now. let the vectors x appear randomly and independently in accordance
with a distribution F(x). Then. in accordance with F(ylx). the values of .'-
are realized in random trials. In this case. there exists a joint distribution
function F(x, r). In accordance with this measure the observed pairs
are formed randomly and independently. Estimating the stochastic depen-
dence based on this empirical data means estimating the conditional distri-
bution function FCr Ix). and this is indeed quite a difticult problem. As we
show. it leads to the need to solve so-called ill-posed problems.
However, the knowledge of the function FCrlx) is often not required: it is
sufficient to determine one of its characleristics. for example the function of
conditional mathematical expectation:
r(x) = !ydF(ylx).
( I.X)
This function is called the regression, and the problem of its estimation in
the set of functions f(x, a), a E .\. is referred to as the problem of regression
estimation. We now show that under conditions
! r 2(x)dF(y,x) < x
the problem of regression estimation is reduced to the model of minimizing
risk based on empirical data.
Indeed. on the set f(x, a), a E ,\
(f(x, a) E L 2(P)). the minimum of the
fund iona I
R(a) = ! (y - f(x o (~))2 dF(y ... )
( t.9)
(provided the minimum exists) is attained at the regression function if the
regression r(x) belongs to f(x, a), a E A. The minimum of this functional is
attained at the function f(x, (y'). which is the closest to regression r(x) in the

1.4 THE PROBLEM OF REGRESSION ESTIMATION
27
e(f" h) ~Jf (f, (x) - f,(X))2 dF(x)
if the regression r(x) does not belong to the set [(x, a), a E A.
To show this, denote
A[(x, a) = [(x, a) - r(x).
Then functional (1.9) can be written in the form
R(a) = I (y - r(x»2 dF(y, x) + I (a[(x, 0'»2 dF(y, x)
- 2 / a[(x, a)(y - r(x» dF(y,x).
In this expression, the third summand is zero, since according to (1.8)
I a[(x, a)(y - r(x») dF(y,x)
= I af(x, a) [I (y - r(x)) dF(Ylx)] dF(x) = o.
Thus we have verified that
R(a) = I(y - r(x»)2dF(y,x) + I (f(x,a) - r(x»)2dF(x).
Since the first summand does not depend on a, the function [(x, an),
which minimizes the risk functional R(a), is the regression if r(x) E
[(x, a), or the function [(x, 0'0) which minimizes the risk functional R(a)
is the closest function to the regression (in the metric L 2(P), if r(x) does
not belong to [(x, a).
This equation also implies that if the regression function r(x) = [(x, an)
belongs to the given set of functions [(x, a), a E A, and if for some func-
tion [(x, a') the risk functional R(a') is &-c1ose to the minimal one
R(a') - inf R(a) < &,
OlEA
then the function [(x, a') is Je-close to the regression in the metric L 2(P):
p(f(x, a'), ,(x)) =Jf (f(x, a') - '(X))2 dF(x) < Vi

28
1 TWO APPROACHES TO THE lEARNING PROBLEM
Thus. the problem of estimating lhe regression may be also reduced to the
scheme of minimizing expected risk. The specific feature of this problem is
that the set of functions Q(::.. a). a E ,\, is subject to the following restrictions:
• The vector::: consists of n + 1 coordinates: the coordinate y and n coordi-
nates x I, .... Xli forming the vector x. However. in contrast to the pattern
recognition problem, the coordinate y as well as the function f(x. a) may
take any value in the interval (-:x:"x)
• The set of loss functions Q(::.. a). a E !\. is of the form
Q(z. a) = (y - f(x, 0'))2.
The important feature of the regression estimation problem is that the loss-
function Q(::., a) can take on arbitrary non-negative values whereas in pattern
recognition problem it can take only two values.
1.5
PROBLEM OF INTERPRETING RESULTS OF INDIRECT MEASURING
Along with the problem of regression estimation we consider the problem of
estimating functional dependencies from indirect measuring.
Suppose one would like to estimate a function f(t) that can be measured
at no point of t. At the same time, another function F(x) which is connected
with f'(t) by operator
Af(t) = F(x)
may admit measurements. It is then required on the basis of mcasuremcnts
(with errors t')
of function F(x) at points Xl, ... , Xi to obtain in a set f(t. a) the solution of
thc cquation. This problem is called the problem of interpreting results of
indirect measurements.
The formation of the problem is as follows: Given a continuous operator
.A which maps in one-to-one manner the elements f(t, a) of a metric space
£1 into the elements F(x. a) of a metric space £2, it is required to obtain a
solution of the operator equation in a set of functions f(l, a), a E .\, provided
that the function F(x) is unknown, but measurements y" .'" YI arc given.
We assume that the measuring F(x) docs not involve systematic error. that
is.
£Yt, = F(x/)

1.5 PROBLEM OF INTERPRETING RESULTS OF INDIRECT MEASURING
29
and the random variables Yx, and Yx, (i =f j) are independent. We also assume
that function is defined on the interval [a, b]. The points x at which measure-
ments of the function F (x) are carried out are randomly and independently
distributed on [a, b] according to uniform distribution.t
The problem of interpreting results of indirect experiments also can be
reduced to the problem of minimizing the expected risk based on empirical
data. Indeed, consider the functional
R(a) = j (y -Af(t,a))2p(ylx)dydx
Using the same decomposition technique as in the previous section we obtain
R(a) = j(Y - F(x,a»2p(Ylx)dydx
= j(Y-Af(t))2p(Ylx)dY dX+ !(F(X,a)-F(x»2 dX
where f(t) and F(x) are the solution of integral equation and its image in £2
space.
We have thus again arrived at setup for minimizing expected risk on the
basis of empirical data. To solve this problem, we have to find function
f(t, ao), the image of which is the regression function in £2 space.
• The vector z consists of 12 + 1 coordinates: the coordinate y and
12 co-
ordinates X l , ... , xn forming the vector x.
• The set of loss-functions Q(z, a), a E A, is of the form
Q(z, a) = (y - Af(t, a»2.
The specific feature of interpreting results of indirect experiments that the
problem of solving operator equation
Af(t) = F(x),
f(t) Ef(t,a)
may be ill-posed (we will discuss this problem below). In this case not all
good approximations to the regression F(x) imply good approximations to
the desired solution f(t). In order to approximate the solution of the operator
equation well, one has to choose the function that not only provides a small
value to the risk functional, but also satisfies some additional constraints that
we will discuss later.
t The points x can be defined by any nonvanishing density on [a. bJ.

30
1 TWO APPROACHES TO THE LEARNING PROBLEM
1.6
THE PROBLEM OF DENSITY ESTIMATION (THE FISHER-WALD
SETTING)
Ld !J(.\, n), n
L
.\. he a set of prohahility densities containing the required
density
dF(x)
p(x, ao)
--'.C - - .
dx
Consider the functional
R(a)
-=.
/lnp(x.a)dF(X).
Below we show that:
( 1. 10)
1. The minimum of the functional (1.10) (if it exists) is attained at the
functions p(x. a') which may differ from p(x, (~o) only on a set of zero
l11easun:.
"")
The /Jretagno/le-Iluher inequality
/lp(x,£Y) - p{x,£Yo) I dx<:;2VI-exp{R(£Yo)--R(£Y)}
is valid.
( 1.11 )
Therefore, the functions p(x, a') which arc t:-c1osc to the minimum
R(a') -
inf R(a) < 6'
"" ,\
will he 2)1 - exp{ -8}-c1ose to the required density in the metric I_I'
The proof of the first assertion is hased on the Jensen inequality, which
states that for a concave function ljJ the inequality
/
~I ((IJ(x)) dF(x) 'S ljJ (/ (IJ(x) dF(X))
is valid.
Consider the functions
( 1.12)
ljJ(u) = Inll.
knsen's inequality implies
,....
p(x,a)
'P(x) =
,
p(x, 0'0).
j'
p(x.a) I'
/
p(x,a)
In
) (f (x) <:; In
)p(x, 0'(1) dx
~= In I = O.
o
p(x,ao
p(x,ao

1.6 THE PROBLEM OF DENSITY ESTIMATION (THE FISHER-WALD SEHlNG)
31
So, the inequality
!
In p«X, a) dF(x) = !lnp(X, a) dF(x) -!lnp(X, an) dF(x) ::; 0
p x,an
is valid. Taking into account the sign in front of the integral (1.10), this
inequality proves our first assertion.
To prove the Bretagnolle-Huber inequality, use the following identity:
!
) p(x, a)
!
[. (P(X, a)
)] d
p(x, an In
(
) dx =
p(x, an) In mIn
)' 1
x
P X, an
p(x, U()
+! p(x, an) In [max (:(~,':n)' 1)] dx.
We apply Jensen's inequality to both terms on the right-hand side of this
equality
! (
p(x, a)
I'
)
p x,an)ln
(
) dx S In
mIn(p(x,a, p(x, an»
dx
p x, an
+ In! max (P(x, a), p(x, U()) dx.
(1.13)
Note that the following identities are true:
min(a,b)
max(a, b)
a + b -Ia - bl
2
a+b+la-bl
2
(1.14)
Substituting (1.14) into (1.13), we obtain
j P(X, an) In P/x, a») dx
p x,an
S In{(1-Jj Ip(x, a)-p(x, an)1 dX) (1+~ j Ip(x, a)-p(x, an) I dX)}
~ In(1 ~G! Ip(x, a) - p(x, aoll dXy) .
(1.15)
This inequality implies Bretagnolle-Huber inequality.
Thus, the problem of estimating the density in L j is reduced to the min-
imization of the functional (1.10) on the basis of empirical data. We call
this setting of the density estimation problem the Fisher-Wald's setting. (In
Section 1.8 we consider another setting of this problem.)
The special feature of the density estimation problem in the Fisher-Wald
setting is that the set of functions Q(z, a) is subject to the following restric-
tions:

32
1 TWO APPROACHES TO THE LEARNING PROBLEM
• The vector ~ coincides with the vector .r.
• The set of functions
Q(~, (¥), a E .\, is of the form
Q(:::, a) = -Iogp(.r. a),
where p(x. a) is a set of density functions. The loss function Q(:::, a) takes
on arbitrary values on the interval (-x. IX), whereas in the regression
estimation problem it takes on only nonnegative values.
We will restrict our analysis to these three prohlems. However, many other
problems of estimating empirical dependencies can he reduced to the modd
of risk minimization based on empirical data.
1.7
INDUCTION PRINCIPLES FOR MINIMIZING THE RISK
FUNC'nONAL ON THE BASIS OF EMPIRICAL DATA
In the pn:vious sections, we considered the problem of minimizing the risk
functional on the hasis of empirical data. It was shown that different prohlems
<;uch as pattern recognition, regression estimation. and density estimation can
be reduced to this scheme by specifying a loss function in the risk functional.
Now a main question arises:
I/oI\' can
11'l' minimi;:e the risk fiillctiof/a!?
We cannot minimize the functional directly since the prohability distri-
bution function F (x) that defines the risk is unknown. What shall we do
instead'! The answer to this question determines an induction principle for
solving learning prohlems.
In this hook. two induction principles will be considered: (I) the classical
one which we introduce in this section and (2) a new one which we consider
in Chapter 6.
Principle of Empirical Risk Minimization. Let us. inslead of minimizing
the risk functional
R(a) = /Q(Z,a)dF(z,),
minimize the functional
I
I
Rcmr(a) = ( L Q(:::,. a).
I
1
a E\.
(¥ E' .\ ,
( 1.16)

1.8 CLASSICAL METHODS FOR SOLVING FUNCTION ESTIMATION PROBLEMS
33
which we call the empirical risk functional. The empirical risk functional is
constructed on the basis of data
Zl, ...Zf
obtained according to distribution function F(z). This functional is defined
in explicit form, and it is subject to minimization.
Let thc minimum of the risk functional be attained at Q(z, ao) and let the
minimum of the empirical risk functional be attained at Q(z, at). We shall
consider the function Q(z, at) as an approximation to the function Q(z, ao).
This principle of solving the risk minimization problem is called the empirical
risk minimization (induction) principle.
The study of this principle is one of the main subjects of this book. The
problem is to establish conditions under which the obtained function Q( Z, a{ )
is close to the desired one, Q(z, ao).
1.8
CLASSICAL METHODS FOR SOLVING FUNCTION
ESTIMATION PROBLEMS
Below we show that classical methods for solving our three statistical prob-
lems (pattern recognition, regression estimation, and density estimation) are
implementations of the principle of empirical risk minimization.
Method 01 MinimiZing Number 01 Training El1or. In Section 1.3 we
showed that the minimization using empirical data (training data)
of the risk functional
R(a) = IL(w, ¢ (x, a)) dF(w, x),
aEA
on a set of functions ¢(x, a), a E A, that take on only a finite number of
values renders the pattern recognition problem.
Consider the empirical risk functional
1
t
Remp(a) = £L L(wj, ¢(Xj, a)),
j=1
a EA.
In the case when L(wj, ¢) E {O, I} (0 if W = ¢ and 1 if W i- ¢). minimization
of the empirical risk functional produced a function which has the smallest
number of errors on the training data.

34
1 TWO APPROACHES TO THE LEARNING PROBLEM
Least Squares Method for the Regression Estimation Problem. In
Section 1.4. we considered the problem of regression estimation as the prob-
km of minimization of the functional
R(a) = ! (y
.. f(x. [t))~ dF(y ..r),
a
C:: .\
on the set of functions f(x. a).
0' E .\, on the basis of empirical data
For this functional, the empirical risk functional is
I
I",
.
,
Rcmp(a) = ( LJ(y, ~ f(x" 0'))-,
I
1
a E .\.
According to the empirical risk minimization principle. to estimate the regres-
sion function we have to minimize this functional. In statistics, the method
of minimizing this functional is known as the "least-squares method."'
Maximum Likelihood Method for Density Estimation. In Section 1j,
we considered the problem of density estimation as the problem of minimiza-
tioll of the functional
R(a) =
!lnp(X, a) dF(x).
a (" \
Oil the set of densities p(x, (t),
(t E .\. using independent identically dis-
tributed data
XI, ...• x l •
For this functional, the empirical risk functional is
I
Rcll1p (a).:: - 2.: In p(x"a).
I
I
According to the principle of empirical risk minimization. the minimum of
this functional provides an approximation of the density. It is the same solu-
tion which comes from the maximum likelihood method. (In the maximum
likelihood method. a plus sign is used in front of the sum instead of a minus.)
Thus, we lind that the classical methods of solving our statistical problems
arc realizations of the general induction principle of minimizing empirical
risk. In subsequent chapters. we will study the general methods of minimizing
the risk functionals and then apply them to our specific problems. But before
thaL we will consider a second approach to the learning prohlems. which is
not based on the scheme of minimizing the risk functional from empirical
data.

(1.17)
1.9 ESTIMATION OF THE DENSITIES AND CONDITIONAL DENSITIES
35
1.9
IDEN'rlFICATION OF STOCHASTIC OBJECTS: ESTIMATION OF
'rHE DENSITIES AND CONDITIONAL DENSITIES
1.9.1
Problem of Density Estimation. Direct Setting
Consider methods for identifying stochastic objects. We start with the prob-
lem of density estimation. Let g be a random variable. The probability of
random event
F(x) = P{g < x}
is called a probability distribution function of the random variable f A ran-
dom vector ~ is a generalization of the notion of a random variable. The
function
F(x) = pa < i},
where the inequality is interpreted coordinatewise, is called a probability
distribution function of the random vector g.
We say that the random variable g(random vector ~) has a density if there
exists a nonnegative function p(u) such that for all x the equality
F(x) = lXxp(U)dll
is valid.
The function p(x) is called a probability density of the random variable
(random vector). So, by definition, to estimate a probability density from the
data we need to obtain a solution of the integral equation
l'~ p(u, a) du = F(x)
on a given set of densities p(x, a), a E A, under conditions that the distribu-
tion function F(x) is unknown and a random independent sample
XI, ... ,Xr,
(1.18)
obtained in accordance with F(x), is given.
One can construct approximations to the distribution function
F (x)
using the data (1.18)-for example, the so-called empirical distribution/unc-
tion (1.18) (see Fig. 1.2):
1
f
Ff(x) =
""i L O(x - XI)'
;=1
where we define for vectort It the step function
(1.19)
O(u) = { 6
all coordinates of the vector u are positive,
otherwise.
t Including scalars as one-dimensional vectors.

36
J TWO APPROACHES TO THE LEARNING PROBLEM
F(x)
FIGURE 1.2. The empirical distribution function
F1 (x), constructed from the data
XI . .
. Xi , approximates the probability distribution function F(x).
In the next section, we will show that empirical distrihution function F) (xl is
a good approximation to the actual distribution function F(x).
Thus. the prohlem of density estimation is to find an approximation to the
solution of the integral equation (1.l7) if the probahility distribution function
is unknown; however. an approximation to this function can he defIned.
We call this setting of the density estimation problem direct setting hecause
it based on the deflnition of density. In the following sections we shall discuss
the prohlem of solving integral equations with an approximate right-hand
side. but now we turn to a direct setting of the prohlem of estimating the
conditional probability. Using the conditional prohability. one can easily solve
the pattern recognition problem.
1.9.2
Problem of Conditional Probability Estimation
Consider pairs (w. x). where x is a vector and w is a scalar which takes on
only k values {O, I.. " k -- I}. According to the definition, the conditional
probahility P (wlx) is a solution of the integral equation
( 1.20)
where F(x) is the distribution function of random vectors x. and F(w, x) is
the joint distrihution function of pairs (w. x).
The prohlem of estimating conditional probability in the set of functions
P,,(wlx).
a E ,\. is to ohtain an approximation to the solution of the inte-
gral equation (1.20) when hoth distrihution functions F(x) and F(w. x) are
unknown hut the data
is given. As in the case of density estimation. we can approximate the un-
known distribution functions F(x) and F(w.x) hy the empirical distrihution

1.9 ESTIMATION OF THE DENSITIES AND CONDITIONAL DENSITIES
37
functions (1.19) and function
1 '
F,(w, x) = £I>;) (x - xi)8(w, Xi),
i=l
where
D(W,X)={~
if the vector x belongs to the class w,
otherwise.
Thus, the problem is to obtain an approximation to the solution of integral
equation (1.20) in the set of functions Pa(wlx),
a E fl, when probability
distribution functions F(x) and F(w,x) are unknown, but approximations
Fl(x) and Fl(w,x) are given.
Note that estimation of the conditional probability function F(wlx) is a
stronger solution to the pattern recognition problem than the one consid-
ered in Section 1.3. In Section 1.3, the goal was to find the best decision
rule from the given set of decision rules; it did not matter whether this set
did or did not contain a good approximation to the supervisor's decision
rule. In this statement of the identification problem, the goal is to find the
best approximation to the supervisor's decision rule (which is the conditional
probability function according to the statement of the problem). Of course, if
the supervisor's operator F(wlx) is known, then one can easily construct the
optimal decision rule. For the case where w E {O, I} and a priori probability
of classes are equal, it has the form
f(x) = e(p(w = 11x) -
~).
This is the so-called Bayes rule; it assigns vector x to class 1 if the probability
that this vector belongs to the first class is larger than 1/2 and assigns 0
otherwise. However, the knowledge of the conditional probability not only
gives the best solution to the pattern recognition problem, but also provides
an estimate of the error probability for any specific vector x.
1.9.3
Problem of Conditional Density Estimation
Finally, consider the problem of conditional density estimation. In the pairs
(y, x), let the variables y be scalars and let x be vectors. Consider the equality
[}~ fXXJ p(tlu) dF(u) dt = F(y, x),
(1.21 )
where F(x) is a probability distribution function which has a density, plv Ix)

38
1 TWO APPROACHES TO THE LEARNING PROBLEM
is the conditional density of y given x, and F(y, x) is the joint probability
dist ribution function t defined on the pairs (y. x l.
As before. we arc looking for an approximation to the conditional density
p(vlx) by solving the integral equation (1.21) on the given set of functions
\vhcn both distribution functions F(x) and F(y, x) are unknown: and the
random, i.Ld. pairs
( 1.22)
arc given. As before. we can appruximak the empirical distribution function
1"1 (.\) and empirical distribution function
I
I
F(\',x) =-"'H("--")fJ(x
r)
!
.
I' ~
.'."
. I'
,
1
Thus, our problem is to get an approximation to the solution of the integral
cquation (1.21) in the set of functions p"L\'lx), a E ,\, when the probability
distribution functions arc unknown hut we can construct the approximations
FJr) and Fdy, x) using data (1.22).
Note that the conditional dcnsity p(ylx) contains much more information
ahout the hehavior of the random value y for lixed x than the regression
function. The regression function can be easily obtained rrum conditional
dcnsity (sec the dclinition of the n:gression runction (l.X)).
1.10
IHE PROBLEM OF SOLVING AN APPROXIMA'rELY DETERMINED
INTEGRAL EQUATION
All three prohlcms or stochastic dependencies estimation can he descrihed
in the following general way. It is necessary to solve a linear continuous
opcrator equation
Al == F,
fE::F
( 1.2.1 )
ir some functions which rorm the equation arc unknmvn, but data are given.
ll"ing these uata the approximations to the unknown functions can be ob-
taineu. Let P, (x) and
l~ (y. x) be appruximations to the dist ribution funet ions
F(xl and F(y,x) ohtained from the data.
A difference exists between the pruhlem of density estimation anu the
problems of conuitional probability and conditional uensity estimation. In the
problem of density estimation, instead of an accurate right-hanu siue of the
, ACluall\. the ,ollltion ot
thi~ ellllation
i~ the Jefinition ot conJitional
Jen'lt~, SllPPlN: tl1,it
1'( \ I
~1IlL! 1'( 1'. \) ,In: the Lkn,itlc, L·(lfTL·"ponding to probability di,tributillll lunetrlln, F( \ I "ilL!
I (\. \ i, I hL'n
C:llllalrt~
(I,~ II I' Cljlll\ alent to the
equalit~ Il( \", \ lfl( \ I
III \' \ I.

1.11 GLiVENK0-CANTELlI THEOREM
39
equation we have its approximation. We would like to get an approximation
to the solution of Eq. (1.23) from the relationship
f E F.
In the problems of conditional probability and conditional density estimation.
not only the right-hand side of Eq. (1.23) is known approximately, but the
operator A is known approximately as well (in the left-hand side of integral
equations (1.20) and (1.21), instead of the distribution functions. we use their
approximations). So our problem is to get an approximation to the solution
of Eq. (1.23) from the relationship
f E F,
where A, is an approximation of the operator A.
The good news about solving these problems is that the empirical dis-
tribution function forms a good approximation to the unknown distribution
function. In the next section we show that as the number of observations
tends to infinity, the empirical distribution function converges to the desired
one. Moreover, we shall give an asymptotically exact rate of the convergence
for different metrics determining different definitions of a distance between
functions.
The bad news is that the problem of solving operator equation (1.23) is
the so-called ill-posed problem. In Section 1.12 we shall define the concept of
"ill-posed" problems and describe the difficulties that arise when one needs
to solve ill-posed problems. In the appendix to this chapter we provide the
classical theory of solving ill-posed problems which is generalized in Chapter
7 to the case of stochastic ill-posed problems. The theory of solving stochastic
ill-posed problems will be used for solving our integral equations.
1.11
GLiVENKo-CANTELLI THEOREM
In the 1930s Glivenko and Cantelli proved one of the most important theo-
rems in statistics. They proved that when the number of observations tends
to infinity, the empirical distribution function F, (x) converges to the actual
distribution function F (x).
This theorem and its generalizations play an important part both in learn-
ing theory and in foundations of theoretical statistics. To discuss this theorem
and results related to it accurately, we need to introduce some general con-
cepts which describe the convergence of a stochastic variable.

40
TWO APPROACHES TO THE LEARNING PROBLEM
1.11.1
Convergence in Probability and Almost Sure
Convergence
Noll: thal an empirical distrihution function is a random function hecause
il is formed on the hasis of a random sample of ohservations. To discuss
the prohlcm of convergence of this function we need to measure distance
hct\veen the empirical distrihution function and the actual one. To measure
the distance hetween two functions. different metrics are used. In this hook
wc usc three of thcm: lht: uniform mctric C
p(gl (x).g~(x)) = sup Igl(x) -
g~(x)l.
\
and L 1(F) metric
In the case when we measurc the distance hetween random functions F! (x)
and some fixed function F(x), random variahles
are considered, Consider a sequence of random variahJcs
We say that a sequence of random variahles al converges to a random vari-
aole 1/11 ill pmhahility if for any D> 0 the relation
P{lal .- aol > 8}
-------t ()
I
.~
(1.24 )
is \'alid.
We say also that a sequence of random variahles all converges to the
random variahle an almost surely (with probahility I) if for any fj > () the
relation
I
'II
p {sup I {II
-
an I > ()} ---; 0
tl
'x.
(l,25)
is valid.
It is easy to see that the convergence (1.25) implies the convergence (1.24)
which is a weaker mode of convergence. Generally, the convergence (\ .24)
does not imply the convergence (1.25),

1.11 GLiVENK0-CANTELLI THEOREM
41
The following classical lemma provides conditions under which conver-
gence in probability implies almost sure convergence (Shiryayev, 1984).
Let A] , ... , An, ... be a sequence of events.t Denote by
A = limAn
n~oo
the event that an infinite number of events from A], ..., An, ... have occurred.
Lemma 1.1 (Borel-Cantelli). (a) If
00
then
(b) If
and All ... , An, '" is sequence of independent events, then
P{ IimA n } = 1.
n-oo
Corollary 1. In order for a sequence of random variables an to converge to a
random variable ao almost surely, it is sufficient that for any 8 > 0 the inequality
00L P { I an - ao I > 8} < 00
n=l
be fulfilled.
This inequality forms necessary conditions if an is a sequence of indepen-
dent random variables.
Corollary 2. Let en, n = 1, ..., be a sequence ofpositive values such that en ---. 0
when n ---. 00. Then if
00L P { I an - ao I > en} < 00,
n=l
the random variables an converge to a random variable ao almost surely.
t See Chapter 2 for definition of events.

42
1 TWO APPROACHES TO THE LEARNING PROBLEM
Convergence in prohahility will he denoted hy
Almo'\t sure convergence will he denoted hy
II \
til
-~ ili).
I
. '-
1.11.2
Glivenko-Cantelli Theorem
Now we can formulate the GJivenko-Cantdli theorem.
Theorem 1.1 (Glivenko-Cantelli). The coJnoergmce
I'
sup!F(r) - FI(r)I--
~
()
I
''-
(likes pllln'.
In this formulation. the Glivenko-Cantelli theorem asserts the conver-
gence in prohahility.T in the uniform metric. of the empirical distrihution
function
F-~ (r) to the actual distrihution function F(x).
We will not prove this theorem here. which was proved originally for
the one-dimensional case. This theorem and its generalization for the multi-
dimensional case will he derived from the more general assertion. which we
"hall prove in Chapter 4.
As soon as this theorem has heen proved. the prohlem of the rate of
convergence F1 (x) to F(x) emerged.
1.11.3
Three Important Statistical Laws
Investigations of the rate of convergence of F 1 (x) to F(x) for one-dimensional
continuous functions F(x) resulted in the estahlishment of several laws of
"tatistics. in particular the following three:
I. Kol"'ugol'()\'-S",imm' ()isrl'ih£lrio!l. The random variahle
~I
- /i sup I F(x) -
I'~ (x) i
has the following limiting prohahility distrihution (Kolmogorov):
lim P{vI( sup I F(x) - F1(x) I < l-:} -= 1 - 2I>
1) ~
I
' ....
~
I
I )
~f' 'f...
1
(
.
{1.2fJ)

1.11 GliVENKO-CANTElLI THEOREM
43
The random variables
{/ = Jf sup(F(x) - Fp(x)),
x
{f- = Jf sup(Fp(x) - F(x»
x
have the following limiting probability distributions (Smirnov):
lim P{Jf sup (F(x) - Fp(x» < e} = 1- e- 2c2 ,
p--->x
x
lim p{Vi sup (Ff(x) - F(x» < 8} = 1 _ e- 2c2 .
(--->x
x
2. The Law of the Iterated Logarithm. The equality
P {lim sup SUP)1 2
lf
Ii I F(x) - Fr(x) I = I} = 1
n--->x
(>n
x
n
n~
holds true.
3. Smirnov Distribution. The statistic
(the so-called omega square statistic) has the limiting distribution
}~~ P{f / (F(x) - Ff (x»2 dF(x) < e}
A28
2 "" 1
2krr
exp{--}
= 1 - -
2
dA.
11' {;
(2k-I)1T J -A sin A
(1.27)
(1.28)
We shall not prove these statistical laws. For our purpose of constructing
the learning theory, we need more general laws which we shall derive in
Chapters 4 and 5. Now our goal is to use the laws above to estimate the
bounds for distribution function F(x) provided the estimate F( (x).
We derive these bounds from the Kolmogorov-Smirnov law (1.27). For
this purpose we consider for some TJ
(0 < TJ < 1) the equality
which we solve with respect to 8
8 = ) _1;£TJ.

44
1 TWO APPROACHES TO THE LEARNING PROBLEM
Now (1.27) can be described as follows: With probability I -
17 simultaneously
for all x the inequalities
( 1.29)
are valid as f
--7 ::x.".
Similarly. the iterated logarithm law (1.2X) implies thai when
simultaneously for all x. the inequalities
lnlnt'
2/
are valid. These inequalities are tight.
To estimaLe the density we have to solve an integral equation where the
right-hand side of the equation is unknown. but approximations which con-
verge to the actual function are given. But even if the approximation FI (x)
tends to F(x) with a high asymptotic rate of convergence, the problem of
solving our integral equations is hard. since (as we will see in the next sec-
tion) it is an ill-posed problem.
1.12
ILL-POSED PROBLEMS
We say that the solution of the operator equation
Af(t) = F(x)
(1.30)
is stahle if a small variation in the right-hand side F(x) E F(x, a) results in a
small change in the solution: that is. if for any 6' there exists 8(.<:) such that
the inequality
{hi (f(t, al). f(t. a2)) <::: e
is valid as long as inequality
holds. Here the indices £1 and £2 denote that the distance is defined in the
mdric spaces £1 and £2. respectively (the operator equation (1.30) maps
functions of space £, into functions of space £;».
We say that the problem of solving the operator equation (1.30) is wel/-
{Josed ill the Hadamard sellse if the solution of the equation

1.12 ILL..pOSED PROBLEMS
45
• exists,
• is unique, and
• is stable.
The problem of solving an operator equation is considered ill-posed if the
solution of this equation violates at least one of the above-mentioned re-
quirements. In this book, we consider ill-posed problems when the solution
of the operator equation exists, is unique, but is not stable.
This book considers ill-posed problems defined by the Fredholm integral
equation of type I:
lh K(t, x)f(t) dt = F(x).
However, all the results obtained will also be valid for equations defined by
any other linear continuous operator.
Thus, consider Fredholm's integral equation of type I:
t K(t, x)f(t) dt = F(x)
10
(1.31)
defined by the kernel K (t, x), which is continuous almost everywhere on
oS t S 1, 0 S x S 1. This kernel maps the set of functions {.f(t)}, continuous
on [0,1], onto the set of functions {F(x)} also continuous on [0,1].
We shall now show that the problem of solving the equation (1.31) is an
ill-posed one. For this purpose we note that the continuous function G,. (x)
which is formed by means of the kernel K (t ,x):
G.,(x) = fat K(t,x)sinvtdt
possesses the property
Gv(x) ~O.
"--'00
Consider the integral equation
fat K(t, x)j(t) dt = F(x) + Gv(x).
Since the Fredholm equation is linear, the solution of this equation has the
form
j(t) = f(t) + sin vt,
where f(t) is the solution of Eq. (1.31). For sufficiently large v, the right-hand
side of this equation differs from the right-hand side of (1.31) only by the
small amount Gv(x), while its solution differs by the amount sin vt.

46
1 TWO APPROACHES TO THE LEARNING PROBLEM
The Fredholm integral equation is the equation we shall consider in this
hook. Here are some exampks of prohkms connectl:d with a solution of this
eq uation:
Example 1 (The Prohlem of Identifying Linear Dynamic Systems). It
IS
kno",m that dynamic properties of linear homogeneous ohjects
y(t) = Ax(t)
with one output are completely descrihed hy the impulse response function
((T). The function f(T) is the response or the system to a unit impulse H(t)
sen'ed at the system at time
T = D.
Knowing this function, one can compute the response of the system to the
disturbance x(t) using the formula
y(t) = t x(t - T)f( T) dT.
Jo
Thus, the determination of the dynamic charactl:ristics of a system i'l reduced
to the determination of the weight function f(x).
It is also knmvn that for a linear homogeneous system, the Wiener-HopI'
equation
(1.32)
j"i \alid.
Equation (1.32) connects the autocorrelation function R" (ll) of a station-
ary random process at the input of the ohject with the weight function f( Tl
and the joint correlation function of the input and output signals R I I (£).
Thus. the prohlem of identifying a linear system involves determining the
\\eight function hased on the known autocorrelation function of the input
signal and the measured (ohserved) joint correlation function of the input
and output signals: that is. it is a prohlem of solving integral equation (1.32)
on the basis of empirical data.
Example 2 (The Prohlem of Estimating Derivatives). Let measurements of a
;,mooth function F(x) at ( points of the interval [0, I] he given. Suppose that
the points at which the measurements ,>vere taken are distributed randomly
and independently according to the uniform distrihution. The prohkm is to
estimatl: the derivative f(x) of the function F(x) on [0, I].
It is easy to see that the problem is reduced to solving the Volterra integral
equation of type L
j
'l f(t) cit
-cc F(x)
. F(O).
I)
undn the condition that the I' measurements

1.12 Ill-POSED PROBLEMS
47
of the function F(x) at the points
XI, ... ,Xf
are known. Equivalently, it is reduced to the solution of the Fredholm equa-
tion of the type I,
faI O(x - t)f(t) dt = F(x) - F(O),
where
O(u)={~
if u > 0,
otherwise.
Note that in the case when F(x) is a monotonically increasing function sat-
isfying the conditions F(O) = 0, F(l) = 1, we have the problem of density
estimation.
In the general case when the kth derivative has to be estimated, the fol-
lowing integral equation has to be solved:
L' (x - t)k-I
k-I FU)(O)
(k _ 1)1 O(x - t)f(t) dt = F(x) - L
'!
'
o
j=O
J
where in place of P(x) the empirical data Yl, ... ,Yr are used. Here pUI(O) is
the value of the jth derivative at zero.
The main difficulty in solving integral equations stems from the fact that
this is an ill-posed problem since the solution of the equation is unstable. In
the mid-1960s. several methods for solving unstable problems of mathemati-
cal physics were proposed. In the appendix to this chapter, we shall present
the so-called "regularization method" proposed by A. N. Tikhonov. This
method is applicable for solving integral equations when instead of knowing
the function on the right-hand side of an equation, one knows the sequence
of approximations which converges to an unknown function with probability
one.
In the 1970s we generalized the theory of the regularization method for
solving the so-called stochastic ill-posed problems. We define stochastic ill-
posed problems as problems of solving operator equations in the case when
approximations of the function on the right-hand side converge in prohahil-
ity to an unknown function and/or when the approximations to the operator
converge in probability to an unknown operator. This generalization will
be presented in Chapter 7. We show that the regularization method solves
stochastic ill-posed problems as well. In particular, it solves our learning prob-
lems: estimating densities, conditional densities, and conditional probabilities.

48
1 TWO APPROACHES TO THE LEARNING PROBLEM
1.13
THE STRUCTURE OF THE LEARNING THEORY
Thus. in this chapter we have considered two approaches to learning prob-
lems. The first approach (imitating the supervisor's operator) brought us to
the problem of minimizing a risk functional on the basis of empirical data.
The secund approach (identifying the supervisor's operator) brought us
to the problem of solving some integral equation when the elements of an
equation arc known only approximately.
It has been shown that the second approach gives more details on the
solution of pattern recognition and regression estimation problems.
Why in this case do we need both approaches? As we mentioned in the
last section. the second approach. which is based on the solution of the
in~
tegral equation. forms an ill-posed problem. For ill-posed problems. the best
that can be done is to obtain a sequence of approximations to the solution
which converges in probability to the desired function when the number of
observations tends to infinity. For this approach, there exists no way to eval-
uate how well the problem can be solved if a finite number of observations is
used. In the framework of this approach to the learning problem. any exact
assertion is asymptotic.
That is why the first approach. based on minimizing the risk functional
from empirical data of the finite size E, may be more apropriate for our
purposes.
In the following chapters. we show that in the framework of the I1rst
approach one can estimate how close the risk functional of the chosen func-
tion is to the smallest possible one (for a given set of functions).
This means that if the function Q(z, al) has been chosen via an appro-
priate induction principle (for example. the principle of empirical risk min-
imization). one can assert that with probability 1 -
1} the value of the risk
R( 0:/) for this function does not exceed the smallest possible value of risk
in!',,, \ R(a) (for a given set of functions) by more than 8. Here
I>' depends
only on 1}. I and one more parameter describing some general properties
(capacity) of a given set of functions.
In other words. it will be shown that for algorithms selecting functional
dependencies based on empirical risk minimization induction principles. one
can guarantee that with probability at least 1 ~ 1} the inequality
R(al) -
inf R(a) ::; e(f.1},·)
"teA
(1.33)
holds true.
Recall that for the pattern recognition problem the goal is to obtain the
solution for which the value of risk is e-close to minimal (see Section 1.3).
For the regression estimation problem, the e-c1oseness of the risk func-
tional to the minimal one guarantees that the chosen function is J£-close to
the regression function in the L 2(F) metric (see Section 1.4).
For the density estimation problem. the e-c1oseness of the risk functionals

1.13 THE STRUCTURE OF THE LEARNING THEORY
49
to the minimal one implies the (2)1 - exp{-6})-closeness of approximation
to the actual density in the L 1(F) metric (see Section 1.5).
Therefore the main problem in this approach (both theoretical and prac-
tical) is to find the method which provides the smallest 6 on the right-hand
side of inequality (1.33) (for a given number of observations).
To do this well, four levels of the theory should be developed. These are:
1. Theory of Consistency of the Learning Processes. The goal of this part
of the learning theory is to give a completc description of the con-
ceptual (asymptotic) models of the learning processes-that is, to find
the necessary and sufficient conditions of consistency of the learning
processes. (Informally, the conditions for convergence to zero of the 6
in (1.33) as the number of observations £ tends to infinity. The exact
definition of consistency is given in Chapter 3.)
Why do we need this asymptotic (conceptual) part of the theory ifour
goal is to obtain the best solution for a finite number of observations?
The conceptual (asymptotic) part of the learning theory is important
since to find the condition for consistency one has to introduce some
concepts in terms of which the theory can be developed. For example,
the concept which characterizes the capacity of a given set of functions
(the dot in arguments of 6 in the inequality (1.33». Generally, it is
possible to use several different constructions. However, it is important
to develop the theory on the basis of such constructions which are not
only sufficient for the consistency of learning process, but are necessary
as well. This gives us a guarantee that the theory which we develop
using these constructions is general and from the conceptual point of
view cannot be improved.
2. Theory ofEstimating the Rate of Convergence ofthe Learning Processes.
This part of the learning theory is devoted to obtaining nonasymptotic
bounds on the generalization ability of the learning machines (6 on
the right-hand side of inequality (1.33»). We obtain these bounds using
the concepts developed in the conceptual part of the theory. In this
book, we consider a theory of distribution-free bounds of the rate of
convergence (the theory that does not use a priori information about
the unknown probability measure). The main requirement of this part
of the theory is to find a way to construct bounds for different sets of
functions.
3. Theory for Controlling the Rate of Convergence of the Learning Pro-
cesses. The bounds on generalization ability will be used for developing
the new induction principles that guarantee the best solution of the
learning problem for a given finite set of observations.
These induction principles are based on the trade-off between com-
plexity of the chosen function (capacity of the set of functions from
which the function is chosen) and the value of empirical risk which can
be achieved using this function. This trade-off led to some functional
different from the empirical risk functional that should be minimized.

50
1 TWO APPROACHES TO THE LEARNING PROBLEM
Table 1.1. Structure of Learning Theory and Its Representation in this Book
--
For indicator functions
For real-valued functions
Review of the theory
Proofs of the theorem~
Proofs of the theorems
Proofs of the theorems
Content of the Chapters
Chapters
Part~ of the Theory
1. Theory of
consistency
of the learning
processes
2. Theory of
hounds
Chapter J
Chapter 14
Chapter 15
Chapter 16
---------+---
Chapter 4
Chapter ,)
I
I
I
I
I
.). Theorv of
contrulhng the
wenerali/ation
-L Theory
01 the learning
algorithms
and its
applications
Chapter 6
Chapter 7
Chapter X
Chapter Y
Chapter 1()
Chapter 11
Chapter 12
Chapter 13
SRM induction principle
Stochastic ill-posed prohlems
New setting of the prohlem
Classical approaches
SYM for pattern recognition
SYM for function estimation
Examples of pattern recognition
Examples of function estimation
Ohtaining these fUl1ctionals in explicit form is the goal of this part of
the theory.
-l. Thmry of the Algorithms. Finally. there is a theory of learning algo-
rithms. The goal of this part of the theory is to develop tools for min-
imil:ing the functionals descrihing the trade-off. In order to minimize
these functionals, it is necessary to develop algorithms which can con-
trol hoth the minimization of empirical risk in a given set of functions
and the choice of a set of functions with appropriate capacity.
In this hook. we consider all parts of the theory of minimization 01 the
risk functional from empirical data.
We consider the theory of solving stochastic ill-posed prohlem as well. and
we apply it to estimate density. conditional density. and conditional prohahil-
ity. This theory descrihes sufficient conditions for consistency of the solution
and. for some cases. the asymptotic rate of convergence of the solution. Of
course, the results of asymptotic theory is not enough to guarantee the suc-
cess if the algorithms use limited samples. In the framework of this theory.
our hope is that asymptotic properties estahlished in the theory arc also valid
for not very large f.
Tahle 1.1 shows the structure of the learning theory and its representation
in this hook.
Chapter:2 is not indicated in this tahle. The content of that chapkr goes
beyond the learning theory. It. however, is very important for the general
understanding 01 the nature of learning problems. We show in this chapter
how deeply these prohkms arc connected with fundamental prohkms of
theoretical statistics.

APPENDIX TO CHAPTER 1:
METHODS FOR SOLVING
ILL-POSED PROBLEMS
Al.l
THE PROBLEM OF SOLVING AN OPERATOR EQUATION
We say that two sets of elements f E M
and FEN are connected by
functional dependency if to each element f EM there corresponds a unique
element FEN.
This functional dependence is called a function if the sets M and N are
sets of numbers; it is called a functional if M is a set of functions and N is a
set of numbers, and it is called an operator if both sets are sets of functions.
Each operator A uniquely maps elements of the set M onto elements of
the set N. This is denoted by the equality
AM=N.
In a collection of operators we shall single out those which realize a one-to-
one mapping of Minto N. For these operators the problem of solving the
operator equation
Af(t) = F(x)
(A 1.1 )
can be considered as the problem of finding an element f(t) in M to which
an element F(x) corresponds in N.
For operators which realize a one-to-one mapping of elements M
onto
N and a function F(x) EN, there exists a unique solution of the operator
equation (A.1). However, finding a method for solving an operator equation
of such generality is a hopeless task. Therefore we shall investigate operator
equations with continuous operators only.
Let the elements f E M belong to a metric space E 1 with metric PI (., .).
and the elements FEN belong to a metric space E2 with metric P2(-, .). An
51

52
A1METHODS FOR SOLVING ILL-POSED PROBLEMS
opLTator A is called contilluous if "c1ose" elements (with respect to metric
PI) in 1:'1 are mapped into "close" elements (with respect to metric {)2) in E 2.
We shall consider an operator equation defined by a continuous one-to-
one operator.\If onto .V. The solution of such an operator equation exists
and is unique. that is. there exists inverse operator A
' from.V onto .VI:
.\If = A I.V.
The basic problem is whether the inverse operator is continuous.
If the operator A
1 is continuous. then close preimages will correspond to
close function in .V. that is. the solution of the operator equation (A 1.1) will
he stahl£'.
If. however. the inverse operator is not continuous. then the solution of
[he operator eLJuation can be Ilonstahle. In this case according to Hadamard's
delinition (Chapter I. Section 1.12). the problem of solving an operator equa-
tion is ill-posed.
It turns out that in many important cases. for example. for a so-called
completely continuous operator A. the inverse operator A 'is not continuous
and hence the problem of solving the corresponding operator eLJuation is ill-
posed.
[)efinition. We say that a linear operator A defined in a linear normed space
1:', with the range of values in a linear normed space £2 is completely COIl-
ti,lllO/{S if it maps any bounded set of the functions in the space £1 into a
compact set of the space E2-that is. if each bounded infinite seLJuencc in 1:'1
11.t~ II ~ c.
(AI.2)
(here
Ilj~11 is the norm in £1) is mapped in £2 into a scqucnce
Ah ..... A};.....
such that a convergent subseLJuence
can be extracted from it.
(AIJ)
(AlA)
We will show that if the space E, contains bounded noncompact sets. then
the inverse operator A
1 for an absolutely continuous operator A need not
be continuous.
Indeed. consider a bounded noncompact set in E 1 • Select in this set an
intinite sequence (A 1.2) such that no subsequence of it is convergent. An
infinite sequence (A 1.3) from which convergent subsequence (A 1.4) may be

A1.2 PROBLEMS WElL-POSED IN T1KHONOV'S SENSE
53
selected (since operator A is absolutely continuous) corresponds in £2 to this
sequence. If the operator A -I were continuous, then a convergent sequence
(A1.5)
would correspond to the sequence (AlA) in £1 which is a subsequence of
(A1.2). This, however, contradicts the choice of (A1.2).
Thus, the problem of solving an operator equation defined by a completely
continuous operator is an ill-posed problem. In the main part of this book
we shall consider linear integral operators
Af= [b K(t,x)f(t)dt
with the kernel K(t, x) continuous in the domain as; t S; b, a S; x S; b. These
operators are completely continuous from C[a, b] into C[a, b]. The proof of
this fact can be found in textbooks on functional analysis (see, for example.
Kolmogorov and Fomin (1970)).
A1.2
PROBLEMS WELL-POSED IN l'IKHONOV'S SENSE
Definition. The problem of solving the operator equation
Af=F
(Al.6)
is called well-posed (correct) in Tikhonov's sense on the set M* eM. and
the set M* is called the set (class) of correctness, provided that:
1. The solution of (A1.6) exists for each F E AM* = N* and belongs to
M*.
2. The solution belonging to M* is unique for any F E N*.
3. The solutions belonging to M* are stable with respect to F E N*.
If M* = M
and N* = N, then correctness in Tikhonov's sense corre-
sponds to correctness in Hadamard's sense. The meaning of Tikhonov's cor-
rectness is that correctness can be achieved by restricting the set of solutions
M to a class of correctness M*.
The following lemma shows that if we narrow the set of solutions to a
compact set M*, then it constitutes a correctness class.
Lemma. If A is a continuous one-to-one operator defined on a compact set
M* eM, then the inverse operator A-I is continuous on the set N* = AM*.

54
A1 METHODS FOR SOLVING ILL-POSED PROBLEMS
Proof: Choose an arhitrary element 1'(1 E:: .V· and an arhitrary sequence con-
verg.ent to it:
I'~,
-" 1'(1.
n ·x
It i'i rL'quirL'd to verify the convergence
t;,= A If:,
---> A
11'(1= t;l.
fJ
.",
Since U;,} C .'vI', and .'vi , is a compact set. the limit points of the sequence
U;,} helong to .'vi'. LL't ,h) he such a limit point. Since /;1 is a limit point.
there exists a sequence U;,,} convergent to it. to which there corresponds
a 'iequence
{f~I,} converg.ent to
~I' Therefore, approaching the limit in the
equality
and utili/ing the continuity of the operator A. we ohtain
Since the operator A
1 is unique. we have
which implies the uniqueness of the limit point of the sequence U;t,}.
It remains to verify that the whole sequence U;/k} converges to til. Indeed.
if the whole sequence is not convergent to til, one could flnd a neighhorhood
of the point .til outside of which there would he infinitely many memhers
of the sequence {f'k}' Since ."vi' is compact. this sequence possesses a limit
point I;; which. hy what has heen proven ahove, coincides with til. This,
however, contradicts the assumption that the selected sequence lies out"ide
a neighhorhood of point /il'
The lemma is thus proved.
Hence correctness in Tikhonov's sense on a compactum ."vi' follows from
the conditions of the existence and uniqueness of a solution of an operator
equation. The third condition (the stahility of the solution) is automatically
satisfied. This fact is essentially the hasis for all constructive ideas for solving
ill-posed prohlems. We shall consider one of them.
A1.3
'rHE REGULARIZA'nON METHOD
A1.3.1
Idea of Regularization Method
The regularization mL'thod was proposed hy A. N. Tikhonov in 1%3.

A1.3 THE REGULARIZATION METHOD
55
Suppose that it is required to solve the operator equation
Af=F
(A1.7)
defined by a continuous one-to-one operator A acting from Minto N. Sup-
pose the solution of (A1.7) exists.
Consider a lower semicontinuous functional W(t). which we shall call the
regulizer and which possesses the following three properties:
1. The solution of the operator equation belongs to the domain of defini-
tion D(W) of the functional Wet).
2. On the domain of the definition, functional W (f) admits real-valued
nonnegative values.
3. The sets
M, = {f: W(f) S; c},
are all compact.
The idea of regularization is to find a solution for (A1.7) as an element
minimizing a certain functional. It is not the functional
P = fJ2(Af,F)
(this problem would be equivalent to the solution of Eq. (A1.7) and therefore
would also be ill-posed) but is an "improved" functional
Ry(j, F) = ~(Aj, F) + /,wci),
j E D(W)
(Al.B)
with regularization parameter /' > O. We will prove that the problem of min-
imizing the functional (AI.8) is stable, that is, to the close functions F and
FfJ (where fJ2(F, FfJ) S; 8) there correspond close elements p and fi which
minimize the functionals Ry(f, F) and Ry(f, FfJ).
A1.3.2
Main Theorems About the Regularization Method
The problem in the theory of regularization is to determine a relationship
between 8 and /' such that the sequence of solutions fI of regularized prob-
lems Ry(f, FfJ) converges as 8 ------> 0 to the solution of the operator equation
(A1.7).
The following theorem establishes these relations.
Theorem 1. Let E 1 and E2 be metric spaces, and suppose for FEN there
exists a solution f E D(W) of Eq. (AJ.7). Let instead of an exact right-hand

56
A1 METHODS FOR SOLVING ILL-POSED PROBLEMS
side F or Eq. (Ai.7), approximationsT F[, E £2 he given sitch that I~(F, Ff,) <
ii, Suppose the mlues of parameter yare chosen in such a mWlIler that
y( ii)
-~ 0
for
8 --. 0,
02
lim -- < r < 'XJ.
[,
.() y( 8) -
Thm the elemelw, .It [,1 minimizing tIll! functionals Ry({,)(f, FIi ) Oil D(W) COIl-
l'erge to the exact solwion f as 8 --} O.
Proof The proof of the theorem utilizes the following fact: For any fixed
y
';> 0 and an arbitrary F E./V an clement fY E D(W) exists which minimizes
the functional RyU, F) on D(W).
Let y and 0 satisfy the relation (A 1.\)). Consider a sequence of clements
tt~1 minimizing Ry(iiIU, F[,), and show that the convergence
is valid.
Indeed, hv definition of r([,1 we have
-
. [,
Ry([,)(f, F[,) = P5(Af. F(.,) + y(8)WCf')
< 82 + y(o)W(f) = y(o) (wen + y~:J.
Taking into account that
R
(/,y(OI
fO.) =
2(AI'Y(OI f'.)
(")W(fY(OI)
y( {,)
. [,
,t>
P2
. [,
.
() + Y (J
,
[,
we conclude
82
wu-: IO )) < W(n +-
.
,
. ii
-
.
y(o)
p;(A.lt[,I, Fo) < y(8) (W(f) +£)
~
-
.
y(8)
Since the conditions (A 1.9) are fulfilled, all the clements of the sequence
Ito' for a 0> 0 sufficiently small belong to a compactum A/t"
where c' =
wcn + r + 6' > 0, B > 0 , and their images Ft O) = Aft[" are convergent:
11'2 (Fto),F) <
11'2(Ft Ii I , Fo)+ 0
< 8+
fi2+Y(0)W(f)-o-~O.
V()
(}
.0
)The eIcments f'R need not Delong to the set !'/,

A1.3 THE REGLILARIZATlON METHOD
57
This implies, in view of the lemma, that their preimages
for 8 -----+°
are also converged.
The theorem is thus proved.
In a Hilbert space the functional W (f) may be chosen to be equal to IIfl1 2
for a linear operator A. Although the sets Me are (only) weakly compact in
this case, the convergence of regularized solutions-in view of the properties
of Hilbert spaces-will be, as shown below, a strong one. Such a choice of
a regularizing functional is convenient also because its domain of definition
D(W) coincides with the whole space £1' However, in this case the conditions
imposed on the parameter ')' are more rigid than in the case of Theorem 1;
namely, ')' should converge to zero slower than 82.
Thus the following theorem is valid.
Theorem 2. Let £1 be a Hilbert space and W(f) = Ilf11 2. Then for ')'(8) sat-
isfying the relations (AJ.9) with r = 0, the regularized elements ft
8
) converge
as 8 -----+°to the exact solution f in the metric of the space £\.
Proof It is known from the geometry of Hilbert spaces that the sphere
Ilfll :::; c is a weak compactum and that from the properties of weak con-
vergence of elements Ii to the element f and convergence of the norms 11[,-11
to Ilfll there follows the strong convergence
IIii - fll -----+ O.
[-0>00
Moreover, it follows from the weak convergence Ii --t f that
Ilfll :::; lim inf IIiiII·
1--------»00
(Al.lO)
Utilizing these properties of Hilbert spaces, we shall now prove the theorem.
It is not difficult to check that for a weak convergence in the space £\ the
preceding theorem is valid: f;(8) converges weakly to f as 8 -----+ 0. Therefore
in view of (A1.lO) the inequality
Ilfll :::; lim inf Ilf;(8)II
8---.0
is valid. On the other hand, taking into account that W (f) = IIfl1 2 and that
r = 0, we obtain
lim sup Ilf;(8)11 2 :::; lim (11fW + 8(:)_) = IlfW.
8---.0
8---.0
')' u

58
A1 METHODS FOR SOLVING ILL-POSED PROBLEMS
Hence the convergence or the norms is valid:
and along with it the validity of weak convergence implies, in view of the
properties of Hilhert spaces, the strong convergence
The theorem is thus proved.
The theorems presented ahove are fundamentals in regularization theory.
Using these theorems the feasihility of solving ill-posed prohlems is estah-
lished.
In <. 'hapter 7 we consider the so-called stochastic ill-posed prohlems and
generalize these theorems for the stochastic case. Using the method of regu-
lari/ation for stochastic ill-posed problems we consider our learning prohlems
or estimating densities, conditional prohahilities, and conditional densities.

2
ESTIMATION OF
THE PROBABILITY
MEASURE AND
PROBLEM OF LEARNING
The two approaches to the learning problem presented in the first chapter
were not chosen accidentally. These approaches correspond to two different
cases for which the estimation of probability measure on the basis of empir-
ical data is possible. Recall that the common part in both approaches is the
fact that the probability measure (distribution function) is unknown and the
information about the measure has to be extracted from the data.
Generally, however, it is impossible to estimate a probability measure using
only empirical data.
One can estimate the probability measure if:
1. The measure belongs to specific sets of measures or
2. The measure is estimated partially.
These two options for estimating probability measures imply two different
approaches to the statement of the learning problem.
2.1
PROBABILITY MODEL OF A RANDOM EXPERIMENT
The goal of this chapter is to demonstrate that the analysis of consistency of
the learning processes is in many ways equivalent to the analysis of the core
problem of statistics-estimation of probability measure.
To start the discussion about different ways of estimating probability mea-
sure based on the results of a random experiment, let us briefly recall the
model of a random experiment used in probability theory. This model is
described in advanced textbooks on probability theory.
59

60
2 ESTIMATION OF THE PROBABILITY MEASURE AND PROBLEM OF LEARNING
According to Kolmogorov's axiomatization, to every random experiment
there corresponds a set n of elementary events w which defines all the pos-
sihle outcomes of an experiment (the elementary events). On the set n of
elementary events, a system {A} of suhsets A E n, which are called (Tents,
is defined. The entire set n considered as an event determines a situation
corresponding to the sure event (an event that always occurs). It is assumed
that the set {A} contains the empty set 0, descrihing the event that never
occurs.
For the set {A} the following operations are defined: union, complement,
and interst'ctio11.
On the set n the (T-algehra F of the events A is defined. The set F of
suhsets of n is called the (T-algehra of t'Vt'llts A E !! if the following hold:
I. n E F.
'")
If A E F, then A E F.
3. If A{ E F, then u,'" I A{ E F.
The pair (n, F) is an idealization of the £/lwlitativt' aspect of a random ex-
periment.
The (jlwntitatil't' aspect of an experiment is determined hy the prohahility
l1lt'llsure P (A) defined on the elements A of the set F.
The function P (A) defined on the dements A E F is called the cOll1ltahly
additi\'e prohahility fIleaSlIrt' on F or, for simplicity, the prohahility fIleasure
provided that
l. P(A) 2: 0;
'")
p(n) = I;
3. P(U," I A,) = 2,'"IP(A,)
if A,. A J E F, and A, n A J = 0, i I- j.
We say that a prohahilistic model of an experiment is specilled if the
prohahility space defined hy the triple (n, F, P) is given,
Now consider the experiment consisting of f' distinct trials in the proha-
hility space (n, F, P) and let
WI .... , Wi
he the outcomes of these trials. We say that sequence
I~'I, ...• Wi is a sequence
of , indept'1ldt'llt trials if for any A 1, ... , AA
1 E F the equality
is valid.
P{WI E A J ; ... : I~'I E A", }
II P{w, E A",}
,
I
The concept of a random variahlc plays an important role in stochastic
analysis. Let the mapping

2.2 THE BASIC PROBLEM OF STATISTICS
61
be given, performed by a real-valued function
~(w) = f
(2.1 )
For this random variable (function) to be measurable, we need that the
relation
{W:~(w)<z}EF
(2.2)
be valid for any z.
Suppose that the iT-algebra F of events A is related to the function ~(w) =
~ in such a way that for any z, relation (2.2) holds true. In this case there
exists the function
F~(z) = P{w: ~(w) < z}
(2.3)
which we call the probability distribution function of the random variable f
A random vector
~(w) = ~
determined by the mapping
is a generalization of the notion of a random variable.
For the vector function g(w) to be measurable, we need that the relation
{w: g(w) < Z} E F
(2.4)
be valid for any vector i. The inequality in the braces should be interpreted
coordinatewise.
Suppose that the iT-algebra F of events A is related to the function ~(w) =
gin such a way that for any i the relation (2.4) holds true. In this case there
exists the function
F~(z) = P{w: ~(w) < z}
(2.5)
which we call the probability distribution function of the random vector g.
2.2
THE BASIC PROBLEM OF STATISTICS
2.2.1
The Basic Problems of Probability and Statistics
In the preceding section we defined a model of a random experiments by the
triple (n, F, P). Now let

62
2 ESTIMATION OF THE PROBABIlITY MEASURE AND PROBLEM OF LEARNING
he the result of { independent trials with the mode! (n, F. P). Consider the
random \'ariahle vIA; 11'1, ... , It'l) defined for a fixed event A c F hy the value
A
(A
)
1/.1
[II (
)
-:e- U
; It'l ' .... WI
= -{-.
where 1/.1 is the numher of elements in the sel IVI' ... , It', helonging to event
A. The random variah!e v, (A) is called the freque1/cy of oCClIrr('l/ce or (/1/
(Tent A in a series of independent, random trials.
In terms of the prohahility distrihution function of the random \'ariahle
[') (/L lVI, .... It',), we can formulate the hasic prohlem of the prohahility theory.
Basic Problem of Probability Theory. Given mode! (n, F. P) and the event
,\
~ F. estimate the distrihution function
1"(.::;A.1) = P{vtlA) < ;}
(or some of its properties).
In this hook we are concerned with the ifll'£'f"se prohlem. Let a qualitative
model of a random experiment (n, F) he given. Our goal is to estimate the
prohahility measure from a given sample
(2.6)
this means that we are auempting to estimate the values P (A) for all events
1\ l F.
This prohlem forms the hasic prohlem of mathematical statistics.
Basic Problem of Mathematical Statistics. Given pair (n. F) and the data
(2.6) ohtained from a series of random and independent trials under proh-
ahility measure P, estimate this probability measure P
= {P (A):
A
~ F}
(defined on the subsets A E F).
To estimak the probahility measure we have to define an estim(/tor 1:'1 (A)
whkh approximates the prohahility measure for all elements A of the
(T-
algehra of events F. We want to find an estimator that delines a sequenee
of approximations converging to the unknown prohability measure-in some
modes-\vhen the numher of ohservations increases. To hegin to analyze the
possibilities of estimating the prohahility measure. we
haH~ to define these
modes.
2.2.2
Uniform Convergence of Probability Measure Estimates
Definition. We say that the estimator
AfF

2.2 THE BASIC PROBLEM OF STATISTICS
63
defines a sequence of measure approximations that converge uniformly to
the probability measure P if the relation
holds true.
p
sup IP(A) - £f(A)1 ----40
AEF
f~x
(2.7)
According to the definition of convergence in probability, this means that
for any given positive B the convergence
P{sup IP(A) - £f(A)1 > B} ----40
AEF
f~,x,
(2.8)
takes place.
When the IT-algebra F of the events A is poor (for example, it contains a
finite number of elements A), the estimator which provides uniform conver-
gence to the probability measure can be found easily. For example, we can
estimate the probability measure with frequencies at all elements A of the
finite IT-algebra F:
n(A)
vf(A) = v(A;wl,···,wr) = -f-'
where n(A) is the number of elements from the set W], ... , W[ belonging to
A E F. The estimator v(A) is called the empirical measure.
Indeed, when the number of elements A k of O'-algebra is finite and is equal
to N, the following inequality is true:
N
P{ sup IP(Ad - vf(Adl > B} S; LP{IP(Ad - v[(Adl > B} ----4 O.
l<k<N
(~x
-
k=]
The convergence to zero here is due to the law of large numbers. According to
this law, any summand tends to zero as the number of observations increases.
Since the number of summands is finite, the whole sum converges to zero as
well.
The problem of whether or not convergence (2.8) takes place arises when
O'-algebra F is rich. For our goal of estimating the function on the basis
of empirical data, we consider Rn as a space of elementary events where
O'-algebra F is defined by Borel's setst; that is, we consider the qualitative
model (R", F).
t The IT-algehra of Borel sets B in R 1 is the smallest IT-algehra that contains all semiclosed
intervals (a. b].
Let K he a set of parallelepipeds:
n;'da,.b,)=U: g=(g" ...,gn): a,<:::I;<b,.i=l ....,n}.
The IT-algehra :F of Borel sets in Rn is the smallest IT-algehra which contains "'.

64
2 ESTIMATION OF THE PROBABILITY MEASURE AND PROBLEM OF LEARNING
For this modeL the knowledge of the distritmtion function
is equivalent to the knowledge of the prohahility measure P. Thus thL: model
in which we are interested may he descrihed hy triple (R", F, P).
Unfortunately, for this model of random evenls, one cannot estimate the
prohahility measure using the empirical measures V, (A).
Example. Let R he the interval (0, 1) and let the unknown measure given hy
the uniform prohahility distrihution function he
F(~) = P{f < .:} = z.
()<~<l.
Let F he the Borcl (T-algehra. It contains all unions of a llnite numher of
suhinlervals of lhL: interval (0. I ). Clearly (see Fig. 2.1 l, for any sample
and for any 8
'> () one can find an event A' E F such that two equalities
P(A')<8
take place.
Thus, in this case, for any f the equality
P{supIP(A) - vdA)1 = I} = I
A, F
holds true.
This example shows lhal in general the empirical estimator of probability
measures docs not provide the uniform convergence to lhe desired prohahil-
ity measure.
o
FIGURE 2.1. For any sample one can find an event A' with small probability measure
t' that contains this sample.

2.3 UNIFORM CONVERGENCE OF PROBABILITY MEASURE
65
2.3
CONDITIONS FOR THE UNIFORM CONVERGENCE OF ESTIMATES
TO THE UNKNOWN PROBABILITY MEASURE
2.3.1
Structure of Distribution Function
Thus, the special estimator (empirical probability measure Vt (A)) does not
provide the uniform convergence to any probability measure. The important
question is:
Does another estimator £{(A) exist that can provide the uniform conver-
gence to any probability measure?
The answer is no. In general, no estimator provides uniform convergence
to any unknown probability measure. To explain why this is true we need to
recall some facts from the theory of probability measures.
We start with Lebesgue's theorem about the structure of probability dis-
tribution functions on the line (Shiryayev, 1984).
Theorem 2.1 (Lebesgue). Any probability distribution function on the line
can uniquely be represented as the sum
of three nonnegative monotone functions where:
1. FD is a discrete component representable in the form
x,<x
2. FAcCx) is an absolutely continuous component representable in the form
FAcCx) = l~ p(x') dx' ,
where p(x) ?: 0;
3. Fc(x) is a singular component-a continuous function whose set of
jumps (points x for which F(x + e) - F(x - e) > 0, e ---t 0) has Lebes-
gue measure equal to zero.t
This theorem actually asserts that any measure on the line is a composition
of three different types of measures:
t The standard example of a singular component is the Cantor function.

66
2 ESTIMATION OF THE PROBABILITY MEASURE AND PROBLEM OF LEARNING
I. A measure of the first type is concentrated on at most countahly many
points each of which has a positive measure.
")
A measure of the second type possesses a density.
3. A measure of the thin.! type is concentrated on a suhset of the line with
measure zero which has no point with positive measure.
Note that according to the Glivenko-Cantclli theorem the empirical distri-
hution function Fi (x) converges to the actual F(x) in C metric as ( increases.
However, to construct an estimator of prohahility measure which provides
uniform convergence. it is necessary to find a way for estimating function
dF(x) rather than F(xl.
The following theorem asserts that in general (if an unknown prohahility
measure contains all three components) no estimator of prohahility measure
provides uniform convergence to the desired one.
Theorem 2.2 (Chentsov). Let Po he the set of all admissihle prohahility Il/m-
.I'lircs 01/ B. ThclI for allY estimator [I (A) of all /lIIklloWII prohahilitv Il/eas/ln:
dc/iI/cd 01/ th(' Bore! sllhsets A C (0. 1) ther(' exists a Il/mSllrc P ( Po for which
t l (/\) docs I/ot prm'ide lIlIiform cOllrergellce.
The proof of this theorem is hased on the fact that there is no method that
allows us to distinguish hetween ahsolutely continuous r,\( (;) and singular
distrihution laws f~dx) using sampks of increasing size.
This theorem implies that an estimator providing uniform convergence to
the unknown prohahility measure can he constructed only for some special
families of prohahility measures that do not include simultaneously hoth an
ahsolutely continuous and a singular components.
Consider a special set of prohahility measures whose distrihution functions
have no singular component.
Lcl P n<\,\( he the collection of prohahility measures on (R 1 • B) that have
only an ahsolutely continuous component F..I ( (z) and a purely discrete com-
ponent Fn (; l.
Theorem 2.3 (Chentsov). Therc exists (/11 estimator [I (It) which prol'ide\ IIl1i-
{()nl/ ('om'ergellce to (/IIV lI/eaSlire ill the set PnA".\( .
The proof of this theorem is hased on the idea that it is possihle to arrange
I ohservations in a ordered array and usc each group of coinciding ohser-
vations to estimate the prohahility of the corresponding atom in a discrete
distrihution function. From the remaining part of the samples we construct
the empirical distrihution function and smooth it as descrihed helow, There-
fore. it is possihle to consider approximations hoth to the discrcle component
of a distrihution function and to the ahsolutely continuous component of the
distrihution function.

2.3 UNIFORM CONVERGENCE OF PROBABILITY MEASURE
67
To estimate the discrete component, one has to note that for any given
E there exist a finite number N (E) of points of discrete components with
probability measure of at least 1 -
E. As was shown above, for a finite number
of events, uniform convergence of the estimates to the probability measure
takes place. For any given E, one estimates the probability measure for these
points and assign zero for the rest.
Therefore, the estimates of the discrete component of probability measure
converge to the actual discrete component in the uniform mode.
According to the Glivenko-Cantelli theorem when the number of obser-
vations increases, the empirical distribution function converges in probability
to the original absolutely continuous component of the probability distribu-
tion function. In Chapter 7 we introduce an estimator of density which in
this case converges in probability to the desired one in the L] metric. As will
be shown in Scheffe's theorem at the end of this section, in this case there
exists an estimator of probability measure which converges uniformly to the
desired measure.
Thus. Chentsov theorem asserts the existence of an estimator of proba-
bility measure that provides uniform convergence to the unknown measure
from the set PD&AC' However, this theorem gives no answer to the question
whether this estimator is stable.
Recall that in the first chapter we called the solution stable if small varia-
tions in the information (given data) caused small variations in the results.
Chentsov theorem asserts that there exists a solution to the problem of
uniform convergence to any probability measure from PD&AC' However, this
solution is unstable. Indeed, for the problem of estimating the measure to
be solved, it is necessary to estimate two components of the distribution
function (the discrete component and the absolutely continuous component)
separately.
To estimate the discrete component, one needs to verify the exact coinci-
dence of two observations. Such a requirement does not provide a stable
method for separation of the two components of distribution functions. Thus,
the methods of estimating the probability measure that contains both discrete
and absolutely continuous components are unstable.
Finally, consider the set of measures PAC which contains only absolutely
continuous functions FAdz). In other words, consider measures that have
densities; that is, consider measures that have the following structure
l~ p(x) dx = F(x).
(2.10)
The problem of density estimation on the basis of empirical data (the solu-
tion of the integral equation (2.10) when instead of the function F(z) the
approximation FdA) is given) was considered in Chapter 1 as one of two
approaches to the statement of the learning problem.

68
2 ESTIMATION OF THE PROBABIlITY MEASURE AND PROBLEM OF LEARNING
In spite of the fact that solving this equation is an ill-posed prohlem, in
Chapter 7 we show that the regularization method descrihed in Appendix to
Chapter I provides a solution to the density estimation prohlem.
2.3.2
Estimator that Provides Uniform Convergence
On the hasis of the estimated density Pi (z). one can construct the following
estimator of the prohability measure:
£1 (A) = rPi (x) de
11l
A E F.
(2.11 )
The next theorem actually shows that if the sequence of densities PI (z)
converges in L 1 metric to the original one, then the estimators (2.11) of
probahility measure provide uniform convergence to the desired prohahility
measure.
Let p(x) and q(x) be densities. let F he Borel sets of events A. and let
PtA) = rp(x) dx.
1A
Q(A) = rq(x) dx
1A
he prohahilities of the set A E F corresponding to these densities. The fol-
lowing theorem is then valid.
Theorem 2.4 (Schefk)
sup jP(A) -- Q(A)I = 1/2! jp(x) - q(.(11 dx.
A.F
t
As a consequence of the Scheffe theorem. the estimator
fdA) = rpr(x) dx
111
provides uniform convergence to the probability measure
P(A) = rp(x) dx,
I\
A E F,
if the density PI (z) converges in probahility to p(z) in the L I metric
J
p
IpCt) - pr(x)1 dx ------t O.
( ·x
(2.12)
Thus, uniform convergence hased on estimator (2.11) to any prohability
measure is possihle for a set of measures that can be descrihed hy the ah-

2.4 GENERALIZATION OF GLiVENKo-GANTELLJ THEOREM
69
solutely continuous distribution function FAdx). To construct this estimator,
one has to estimate a probability density from data.
Note
that
this
is
the
problem
we
face
in
the
second
approach
considered in Chapter 1. In this approach we have to estimate densities (con-
ditional densities) on the basis of data.
Thus, the second approach to the learning problem (identification of the
supervisor's operator) is connected with uniform convergence of an esti-
mate to the unknown probability measure.
In the next section we consider another mode of convergence: the so-called
partial uniform convergence. We show that the first approach to the learning
problem is based on this mode convergence to the probability measure.
2.4
PAR1'IAL UNIFORM CONVERGENCE AND GENERALIZATION OF
GLiVENKO-CANTELLI THEOREM
2.4.1
Definition of Partial Uniform Convergence
Definition. We say that estimator fleA) provides partial uniform conver-
gence to the probability measure P determined by the set of events:F* if the
following convergence in probability
sup IP(A) - £t(A)1
AE.P
p ------+ 0
(-'x
(2.13)
holds true, where :F* c :F is a subset of the set :F.
According to the definition of convergence in probability, this means that
for any given positive 8 the convergence
P {sup IP (A) - £t(A) I > 8} ------+ 0
AE.P
(-'00
(2.14)
takes place.
The difference in the definitions of uniform convergence and partial uni-
form convergence is in the set of events that should be taken into account
when the probability measure is estimated:
1. For the uniform convergence, the supremum is taken over all elements
A of the a algebra of events :F.
2. For the partial uniform convergence, the supremum is taken only over
the subset :F* c :F. (The subset :F* need not be a a algebra.)

70
2 ESTIMATION OF THE PROBABILITY MEASURE AND PROBLEM OF LEARNING
It is possihle that partial uniform convergence takes place when uniform
converge nce fa its.
Now consider random experiments, which are deserihed hy the triple
(R I • F. F). Suppose that on the space of elementary events ddined hy the
Borel set F we would like to estimate the prohahility measurL' on the hasis
of independent identically distrihuted samples:
According to Chentsov theorem it is impossihle to find an estimator that
prm'ides uniform convergence to any given prohahility measure.
Now consider a suhset F' of the set F containing the c1cmL'nts
F' - {A, : ( - x, x),
x E (
"'- , "'- )}.
In other words, F' contains all sets (- x"x).
Con-;ider the e-;timator that we called the empirical measure:
1
I
l' (A, ; ~I ' .... t:,) - ( L H(x
t:/ ).
f
I
where 0(11) is the step function:
(2.15 )
11(1/) _ {
1
(I
if 1/> (j,
otherwise.
This cstimator determines the frequency of any given event A \
(",,-,.\ )
w..ing the examples tl ..... tl' We will usc this empirical mea-;ures tll e<.;timak
the unknown measure partially.
In order to show that for set F' there exists a uniform cOll\ergencc of the
empirical mcasures to dcsirL'd one. we need to show that for any positive f'
the following relation takes place:
P{supiP(A)
l'd/1ll
\
f'
To show this, we note that hy dclinition
l.' }
• O.
I
."
(2.1 h)
1'1 (A,)
C' F1(x).
where F(x) is the distrihution fun<.:tion and F1 (x) is the empirical distribution
function, and (2.16) is the assertion or the Cilivenko-Cantelli theurem (-;ee
Charkr [, Section l.iO).

2.4 GENERALIZATION OF GLiVENKQ-CANTELLITHEOREM
71
2.4.2
Generalization of the Glivenko-Cantelli Problem
Let us reformulate the Glivenko-Cantelli theorem in the following way:
Theorem 2.5 (Glivenko-Cantelli). For any given probability measure P E Po
and any given e > 0 the following relation always hold true:
(2.17 )
Remark. A stronger assertion follows from the Kolmogorov-Smirnov law
(Chapter L Eq. (1.26)): The asymptotic rate of convergence does not depend
on the probability measure and has an exponential form (Fig. 2.2):
sup P{ sup IP(Ax) - vf(Ax)1 > e} < 2 exp{ -2e2f}.
PEPo
A,E.1""
This formulation of the Glivenko-Cantelli theorem is extremely important
because it leads to a statement of the general problem of partial uniform
convergence of the probability measure estimates. Consider once more the
probability
P{ sup JP(A) - vf(A)1 > e}.
AE.T'
(2.1R)
As follows from the Chentsov theorem, if the set of events is rich (F' is
a Borel set), then no estimator can provide uniform convergence to any
probability measure. In particular, this is true for empirical measure estimator
vf(A).
a
~kI
FIGURE 2.2. The uniform convergence of the frequencies to their probabilities over set
of events Ax defined by all rays on the interval x E ( -:xl, :xl) is equivalent to assertion of
the Glivenko-Cantelli theorem.

72
2 ESTIMATION OF THE PROBABILITY MEASURE AND PROBLEM OF LEARNING
But on the other hand, according to the Glivc:nko-Cantelli theorem, if the
sd of events is rather poor (F' = F'), then
(2.1~) converges to zero for <lny
prohahility measure.
The question is, What conditions should hold for the set of events :P
(how rich can the set of events he) to guarantee that the empirical estimator
I', (;\) provides uniform convergence with an asymptotic exponential rate
of eonvergenee which is independent on the prohahility me<lsure,? In other
words. when do there exist for any positive f: positive constants (/ and nsuch
that for sufficiently large f the inequality
sup P{ sup IP(A) -
/1, (A)I > t:} < nexp{ _(/82,}
/'.1'"
..\. F'
holds trw:'?
The prohlem of tlnding these conditions on set F' can he called the Gefl-
l'raliz.ed Glit,t'llko-Cwl!elli prohlenl. As we will show in the next chapter. the
~olution of the Generalized (Jlivenko-CantcllJ prohlc:m forms one of the main
conceptual parts of karning theory. In this hook we shall give the complete
solution to this prohlem (we shall give: necessary and suftlcient conditions for
existence of this inequality).
2.5
MINIMIZING THE RISK FUNC1'IONAL UNDER 'rHE CONDITION OF
UNIFORM CONVERGENCE OF PROBABILITY MEASURE ESTIMATES
In Chapter 1 we considered two approaches to the learning prohlem. The
first approach was hased on the idea of minimizing the risk functional
R(a)
0
./ Q(.:. a)dF(z.)
(2.1 SI)
in the sd of functions Q(.:. a). a f
.\, when the prohahility distrihution func-
tiun n.:) is unknown hut the data
are given. The second approach was hased on the idea of estimating densities
(conditional density, conditional prohahility) hy solving integral equations of
the type
./~P(X)dX == F(:.).
when the right-hand side of this equation is unknown hut the data are
gi\'l~n.
In Section 2.3 we showed that if one knows a priori that the distrihution
function is ahsolutely continuous then the solution of this equation on the
hasis of empirical data implies the solution of the prohkm of estimating the
prohahility measure in the uniform mode. From this point of view, the learn-
ing prohlem hased on the second approach is connected with the prohlem of

2.5 MINIMIZING THE RISK FUNCTIONAL UNDER UNIFORM CONVERGENCE
73
estimating the probability measure in the uniform mode, when the unknown
distribution function is absolutely continuous.
Note that under conditions of uniform convergence of probability measure
estimates, the functional (2.19) can be minimized as well. In this section we
show that when uniform convergence takes place, one can achieve a more
general solution of the learning problem than was considered in Chapter 1.
Consider the problem of minimizing the functional (2.19) on the basis of
data. (The problem of minimizing (2.19) when the distribution function F(z)
is unknown but a random, independent sample obtained in accordance with
F(z) is given.)
For the time being, assume that the absolute values of the loss function
Q(z, a), a E A, are uniformly bounded by a quantity B. (This is always true
for the pattern recognition problem.)
Let F(z) be an absolutely continuous function. Then the risk functional
(2.19) can be rewritten in the form
R(a) = / Q(z, a) dF(z) = / Q(z, a)p(z) dz,
where p(z) is the corresponding probability density.
Let us use the data to estimate the probability density p(x). Assume that an
estimator Pt (z) converges in L 1 to the density p(z). Consider the functional
(2.20)
defined by the means of the estimator Pe(Z).
We state the following inductive principle for minimizing risk (2.19):
As an approximation to the function Q(z, aa) which yields the minimum
(2.19), we shall select the function Q(z, at) which minimizes (2.20).
We will show that if the estimator Pe(Z) converges to p(x) in L t , then
the principle of minimizing the risk (2.20) provides solutions with risks that
converge to the smallest possible risk for any set of bounded functions
Q(z, a), a E A.
Indeed, for the set of bounded functions IQ(z, a)1 :::; B, a E A, it follows
from (2.12) that
~~~IJQ(z,a)dF(x)- /
Q(z,a)pt(z)dZI
:::; sup /
IQ(z, a)llp(z) - PI(z)1 dz
aEA
:::; B /
Ip(z) - Pe(z)1 dz ~ O.
1->00

74
2 ESTIMATION OF THE PROBABILITY MEASURE AND PROBLEM OF LEARNING
From this relationship we derive that for any e and any 1] there exists a value
£(e, TJ) such that for any £ > fee, TJ) with probability 1 -
TJ the following two
inequalities hold true:
/
Q(z, at )p(z) dz - /
Q(z, at )Pf (z) dz < e,
- /
Q(z, ao)p(z) dz + /
Q(z, ao)Pt(z) dz < e.
On the other hand, by definition,
/
Q(z, at )Pt(z) dz ~ /
Q(z, ao)p,(z) dz.
Combining these three inequalities we obtain the result that with a probability
of at least 1 -
TJ the inequality
/
Q(z, at )p(z) dz - /
Q(z, ao)p(z) dz < 2e
holds true.
That means convergence in probability of the functionals
/
Q(z, at) dF(z) (~J Q(z, ao) dF(z);
that is, the functions Q(z, ad minimizing the functional (2.20) form a
sequence of risks that converges in probability to the minimal one as the
number of observations increases.
Thus, under the condition of uniform convergence of estimates Ef (A) to
the probability measure, the induction principle (2.20) guarantees the exis-
tence of a solution which makes the risk e-c1ose to the minimal possible for
any uniformly bounded set of functions Q(z, a), a E A.
In the next section we show that under conditions of partial uniform con-
vergence of probability measure estimates, the principle of empirical risk
minimization provides solutions with risks that converge to the smallest pos-
sible risk (as the number of examples increase) if the set of events :F* that
determines the partial uniform convergence is connected with a set of func-
tions Q(z, a), a E A, in the special way.
2.6
MINIMIZING THE RISK FUNCTIONAL UNDER THE CONDITION OF
PARTIAL UNIFORM CONVERGENCE OF PROBABILITY MEASURE
ESTIMATES
Let us start this section by writing the Lebesgue-Stieltjes integral for the
bounded nonnegative function () ~ Q(z, a*) ~ B (here a* is fixed) in explicit

2.6 MINIMIZING THE RISK FUNCTIONAL UNDER PARTIAL UNIFORM CONVERGENCE
75
form. According to the definition of the Lebesgue-Stieltjes integral, the func-
tional of risk R(a*) is
I
n B {
'B}
R(a*) =
Q(z, a*) dF(z) = lim ~ -p
Q(z, a*) > _1
1
/1---.00 L...J 11
11
i=1
where
is the probability of event
Ai = { z: Q(z, a*) > i:}
(see Fig. 2.3). Consider in a similar form the means of this event estimated
from the data Zl, ... , Zf, f = 1, ...
Remp(a*) = ~ ~ Q(Zi, a*) = lim ~ ~Uf {Q(Z, a*) > iB},
t. L...J
n---.oo L...J 11
11
i=1
i=1
where
Up {Q(z,a*) > i:}
is the frequency of events Ai estimated from this data.
Q
Q(z, a)
I
iB
m
I.
a
FIGURE 2.3. The Lebesgue integral of a nonnegative bounded function 0::: Q(z,a')::: B
is the limit of a sum of products, where factor P{Q(z,£l'*) > iBln} is the (probability)
measure of the set {z:Q(z,a*) > iBln} and the factor Blm is the height of a slice.

76
2 ESTIMATION OF THE PROBABILITY MEASURE AND PROBLEM OF LEARNING
Now let Q(z, a), a E A be a set of bounded functions:
0::; Q(z, a) ~ B,
Consider the following set :F* of events
Aa.,B = {z : Q(z, a) ~ 13},
a EA.
a E A, 13 E [0, B].
Suppose that the empirical estimator Vi (A) defines measures that partially
converge to the unknown probability measure P:
p
sup IP(A) - vt{A)1 ------+ O.
AEF'
£->00
(2.21 )
Then, from the definitions of the J,ehesgue-Stieltjes integral and of the
partial uniform convergence (2.21) we obtain
I
1
I
~~~
Q(z,a)dF(z)-i ~Q(zi,a)
n B
= lim sup L -(P(Aa,iB/n) - V,(Aa,iB/n))
n->x,
E'\
n
a.
i=1
~ B sup IP (Aa.,B) - Vi (Aa,,B) I
a.,B
= B SUp IP(A) - vf(A)1 ------+ O.
AEF'
f->~
(2.22)
It follows from this that the uniform convergence of means to their mathemat-
ical expectations on the set of uniformly bounded functions Q(z, a), a E A is
valid.
Now we prove that under the conditions of the existence of unifonn con-
vergence (2.22), the principle of minimizing the empirical risk provides a
sequence of functions that converges in probability to the best solution.
As above, it follows from the unifonn convergence (2.22) that for any e
and any T} a value £(e, T}) exists such that for any £ > £(e, T}) with probability
1 -
T} the following two inequalities hold true:
/
1
£
Q(z, a£) dF(z) - pL Q(Zi, a,) < e,
1=1
/
1 '
-
Q(z, ao) dF(z) + pL Q(Zi, an) < e.
i=1

2.7 REMARKS ABOUT MODES OF CONVERGENCE OF THE PROBABILITY MEASURES
77
Note that by the definition the inequality
is valid.
Combining these three inequalities, we obtain that with probability of at
least 1 -
'Y1 the inequality
/
Q(z, at) dF(z) - /
Q(z, ao) dF(z) < 2B
holds true.
In other words we get convergence in probability
/
Q(z, ad dF(z) ~ /
Q(z, ao) dF(z);
f~XJ
(2.23)
(2.24)
that is, as the sample size increases, the functions that minimize empirical
functional on Q(z, a), a E A, form a sequence of values R(ap) that converges
in probability to the minimal value of the risk R(ao).
2.7
REMARKS ABOUT MODES OF CONVERGENCE OF THE
PROBABILITY MEASURE ESTIMATES AND STATEMENTS OF THE
LEARNING PROBLEM
Earlier in this chapter we considered the basic problem of mathematical
statistics: the problem of estimating a probability measure from empirical
data. We showed that, in general, it is impossible to construct a universal
estimator of probability measure (applicable to any probability measure).
This fact splits the study of the problem of estimating probability measure
into two parts:
1. The study of conditions on probability measures PEP under which
the uniform convergence
sup IP(A) - [p(A)1 ~ 0
AE.r
(~XJ
holds true for any set :F.
2. The study of the conditions on sets :F* under which the uniform con-
vergence
sup IP(A) - vp(A)1 ~ 0
AE.r"
f~x
holds true for any probability measure.

78
2 ESTIMATION OF THE PROBABILITY MEASURE AND PROBLEM OF LEARNING
The main problem in the study of uniform convergence over the entire set
of if-algebra is to define the estimator ep(A) and the set of measures P for
which such convergence takes place. (In Section 2.3 it was shown that one
can use the estimator (2.11 ).)
The main problem in the study of the partial uniform convergence is to
describe conditions on the set F* under which the estimator of empirical mea-
sure provides the partial uniform convergence for any probability measure
P E Po (the Generalized Glivenko-Cantelli problem).
The analysis of these two ways of estimating probability measure forms
the foundation of theoretical statistics.
In the first chapter we formulated two approaches to the learning problem:
One was based on the idea of imitating the supervisor's operator, while the
other was based on the idea of identifying the supervisor's operator.
From the mathematical point of view the idea of identification of supervi-
sor's operator is based on estimating the probability measure uniformly over
the entire set of if-algebra.
The idea of imitating the supervisor's operator can be described by the
scheme of minimizing the risk functional on the basis of empirical data. The
solution of this problem is based on partial estimating of the probability
measure.
Therefore from the conceptual point of view, analysis of consistency of
the learning processes is in many ways equivalent to analysis of the prob-
lem of estimating the probability measure, which is the central problem of
theoretical statistics.
The next chapter is devoted to the theory of consistency of learning pro-
cesses for the scheme of imitation of the supervisor's operator, while Chapter
7 is devoted to the theory of consistency for the scheme of identification of
the supervisor's operator. The results obtained in these chapters can also be
described in terms of convergence (in two different modes) of estimates of
probability measures.

3
CONDITIONS FOR
CONSISTENCY OF
EMPIRICAL RISK
MINIMIZATION PRINCIPLE
In this chapter we present necessary and sufficient conditions for consistency
of the empirical risk minimization principle. First we formulate and prove
the key theorem of the empirical risk minimization theory-the theorem
about equivalence. According to this theorem, the following two facts are
equivalent:
1. The principle of empirical risk minimization is consistent.
2. The specific empirical process converges.
Then we describe the theorems about the convergence of this empirical pro-
cess (proofs of the theorems are the suhject of the third part of this hook).
We show that proofs of these theorems are based on the idea of the non-
falsifiability of the learning machine, where the concept of nonfalsifiability is
closely related to Popper's nonfalsifiability concept introduced in philosophy
of science. At the end of the chapter we discuss the necessity of the ways in
which learning theory is constructed in this book.
3.1
CLASSICAL DEFINl'rlON OF CONSISTENCY
In Chapter 1 we introduced the problem of minimizing the risk-functional
R(a) = IQ(z, a) dF(z),
aEA
(3.1)
on the set of functions Q(z, a), a E A, where the distribution function F(z)
is unknown; however, independent identically distributed data according to
79

80
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
this function
ZI, .. ·,Z;,
(3.2)
are given.
To solve this problem, the principle of empirical risk minimization was
proposed. According to this principle, instead of minimizing functional (3.1).
one has to minimize the empirical risk functional
Let
a EA.
(3.3)
Q(Z,ad = Q(z,a(Zt, ...,Zf))
be a function that minimizest the functional (3.3). The fundamental problem
of empirical risk minimization theory is to describe the situations where this
principle is consistent. Below we give a classical definition of consistency.
Definition. We say that the principle (method) of empirical risk minimization
is consistent for the set of functions Q(z, a), a E A, and for the probability
distribution function F(z) if the following two sequences converge in proba-
bility to the same limit:
R(af) ~ inf R(a)
f-.x aEA
(3.4)
(3.5)
In other words the empirical risk minimization method is consistent if it
provides the sequence of functions Q(z, af),e= 1,2, ... , for which both the
expected risk and the empirical risk converge in probability to the minimal
possible (for a given set of functions) value of risk (Fig 3.1). Equation (3.4)
asserts that the sequence of values of achieved risks converges to the smallest
possible risk for the given set of functions, and Eq. (3.5) asserts that the limit
of a sequence of empirical risks estimates the minimal possible value of the
risk.
The goal of this chapter is to describe conditions for consistency of the em-
pirical risk minimization method. We would like to obtain these conditions in
terms of general characteristics of a set of functions and probability measure.
Unfortunately, for the classical definition of consistency given above, this is
impossible since the definition includes trivial cases of consistency.
What is a trivial case of consistency?
t For simplicity we assume that the minimum of empirical risk functional does exist; otherwise
we choose a function that provides the value of empirical risk close to infimum.

3.1 CLASSICAL DEFINITION OF CONSISTENCY
81
FIGURE 3.1. The learning process is consistent if both the expected risks R(al) and the
empirical risks Remp(af) converge to the minimal possible value otthe risk, infuE ,\ R(a).
Suppose we have established that for some set of functions Q(z, a), a E A,
the method of empirical risk minimization is not consistent. Consider the
extended set of functions which includes the initial set of functions and one
additional function, q, (z). Suppose that the additional function satisfies the
inequality
inf Q(z, a) > q,(z).
aEA
It is clear (Fig. 3.2) that for the extended set of functions [containing q, (z)] the
method of empirical risk minimization is consistent. Indeed, for any distribu-
tion function and any number of observations the minimum of the empirical
risk is attained at the function q,(z) that gives the minimum of the expected
risk.
This example shows that there exist trivial cases of consistency that depend
on whether a given set of functions contains a minorizing function.
Therefore, any theory of consistency that uses the classical definition needs
a
Q(z, cx), CXEA
z
FIGURE 3.2. A case ot trivial consistency. The ERM method is inconsistent on the set ot
functions Q(z, a), a E A, and is consistent on the set of functions q,(Z)U Q(z. a), a E A.

82
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
to check whether the case of trivial consistency is possible. That means that
the theory should take into account specific functions in a given set. Our goal,
however, is to find conditions for consistency that could be easily checked.
We would like to get the conditions that depend on general properties of a
set of functions and do not depend on specific functions in a set.
3.2
DEFINITION OF STRICT (NONTRIVIAL) CONSISTENCY
In order to develop the theory of consistency of the empirical risk minimiza-
tion method which does not depend on the properties of elements of a set
of functions, but depends only on general properties (capacity) of this set
of functions, we need to adjust the definition of consistency to exclude the
trivial consistency case.
3.2.1
Definition of Strict Consistency for the Pattern Recognition
and the Regression Estimation Problems
Definition. We say that the method of minimizing empirical risk is strictly
(nontrivial/y) consistent for the set of functions Q(z, a),
a E A, and the
probability distribution function F(z) if for any nonempty subset A(c), c E
(-00,00), of Lhis set of functions such that
A(c) = {a: I Q(z, a) dF(z) ~ c}
the convergence
inf Remp(a) ~
inf R(a)
ClEA(e)
f-.oo ClEA(c)
(3.6)
is valid.
[n other words, the method of empirical risk minimization is strictly con-
sistent if it provides convergence (3.6) both for the given set of functions
and for all subsets A(c) of functions that remain after the functions with the
values of the risks smaller than c are excluded from this set.
Note that according to the classical definition of consistency, described
in the previous section, the method is consistent if it satisfies two condi-
tions: (3.4) and (3.5). In the definition of strict consistency we use only one
condition. The following Lemma shows that under the condition of strict
consistency the other condition is satisfied automatically.
Lemma. If the method of empirical risk minimization is strictly consistent, the
following convergence in probability holds
R(ad ~ inf R(a).
f-HXJClEA

3.2 DEFINITION OF STRICT (NONTRIVIAL) CONSISTENCY
83
Proof Denote
inf R(a) = /
Q(z, aD) dF(z) = T.
aEA
For an arbitrary e > 0, consider the subset A( T + e) of the set of functions
Q(z,a), a E A, such that
A(T + e) = {a: /
Q(z, a)dF(z) 2" T +e}.
We choose e such that A(T + e) is not empty. Let (3.6) be satisfied. Then the
equalities
Ji~ P { ~t Q(Zi, a,) ? T + ~ } ~ 0,
lim P {
inf
~ tQ(Zi,a) 2" T+ -2
e
} = 1
f--.oo
aEA(T+e) t'.
.
1=1
are valid.
These equalities imply
lim P{af E A(T +en = 0.
f-.oo
If on the other hand, af ¢. A(T + e), then the inequality
T:sI Q(z,a,)dF(z):s T+ e
holds. This inequality implies (3.4).
Thus, we have proven that strict consistency implies the convergence (3.4),
but not vice versa. The following example demonstrates that in some cases
the convergence (3.4) does exist and the convergence (3.5) does not.
Example. Consider the following set of indicator functions Q(z, a), a E A,
which are defined on the interval [0,1]. Each function of this set is equal to
1 for all z except a finite number of intervals of measure e where it is equal
to°(Fig. 3.3). The parameters a define the intervals at which the function is
equal to zero. The set of functions Q(z, a), a E A, is such that for any finite
number of points ZI, "', Zf, one can find a function that takes the value of
zero on this set of points. Let F(z) be the uniform distribution function on
the interval [0, 1].
For this set of functions, the equalities

84
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZAnON PRINCIPLE
Ie---
Q(z,al
-
0
"-=-
'-"'-
'-"'-
"-=-
zJ
z2
z3
Z{
z
FIGURE 3.3. An example where the convergence (3.4) does exist and the convergence
(3.5) does not.
R(a) = 1Q(z, a) dF(z) = 1 -
G,
hold. So for this set of functions, the relation
inf R(a) - Remp(ad = 1 -
G
aEA
takes place. On the other hand, for any function of this set (including the
function Q(z, af)), the relation
R(af) - inf R(a) = IQ(Z,af)dF(Z) - inf IQ(z,a)dF(Z) =0
aEA
aEA
holds true.
Thus, in this example, convergence (3.4) takes place though convergence
(3.5) does not.
3.2.2
Definition of Strict Consistency for the Density
Estimation Problem
In Chapter 1 we showed that for the density estimation problem (in the
Fisher-Wald setting) the principle of empirical risk minimization implies the
maximum likelihood method. For this problem the loss function associated
with the set of densities p(z, a), a E A (where the optimal p(z, au) is being
searched for), has the form
Q(z,a) = -logp(z,a),
To minimize the functional
a EA.
R(a) = -I p(z,ao)logp(z,a)dz
with unknown density p(z, ao) using the data

3.3 EMPIRICAL PROCESSES
85
we minimize the empirical risk functional
(the maximum likelihood method).
For the case of density estimation by the maximum likelihood method, we
will use another definition of strict consistency which requires consistency for
estimating any density in a given set of densities.
Definition. The maximum likelihood method is strictly consistent with
respect to the set of densities p(z, a), a E A, if for any p(z, ao), ao E A. the
relation
t
inf ~ 2:)-logp(zi, a)) ~ jP(Z, ao)(-logp(z, ao)) dz
aEA
~
( .......00
;=\
holds true where i.i.d. samples Z\, "', Ze are drawn from the density p(z, ao).
Below, we consider necessary and sufficient conditions of strict consistency
both defined for the method of minimizing empirical risk and defined for
the method of maximum likelihood. In this chapter we shall refer to strict
consistency as simply consistency.
3.3
EMPIRICAL PROCESSES
The analysis of consistency of the empirical risk minimization method is
essentially connected with the analysis of the convergence of two empirical
processes.
Let the probability distribution function F(z) be defined on the space
z ERn, and let Q(z, a), a E A, be a set of measurable (with respect to this
distribution) functions. Let
ZI, "', Zf, ....
be a sequence of independent identically distributed vectors.
Consider the sequence of random variables
j
1
I
e = ~~~
Q(z, a) dF(z) - fEQ(z;, a) ,
f = 1,2, ....
(3.7)
We call this sequence of random variables that depends both on the proba-
bility measure F(z) and on the set of functions Q(z, a), a E A, a two-sided

86
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
empirical process. The problem is to describe conditions under which this
empirical process converges in probability to zero.
In other words, the problem is to describe conditions such that for any
positive e the convergence
takes place.
We call this relation uniform convergence of means to their mathematical
expectations over a given set of functions or, for simplicity, uniform conver-
gence.
Along with the empirical process e, we consider a one-sided empirical
process given by the sequence of random values
~~ = sup(I Q(z, a) dF(z) - ~t Q(z;, a)) ,
aE~
;=1
+
where we denote
£ = 1,2, ... ,
(3.9)
{
u
(u)+ =
0
if u > 0,
otherwise.
The problem is to describe conditions such that for any positive e, the fol-
lowing relation
(3.10)
takes place.
We call this relation uniform one-sided convergence ofmeans to their math-
ematical expectations over a given set offunctions or, simply, uniform one-sided
convergence.
In Chapter 2, when we considered the generalization of the Glivenko-
Cantelli theorem, we actually considered special cases of the empirical pro-
cess (3.8): namely, the case where the set Q(z, a), a E A, was a set of indicator
functions. This case will play an important part in our considerations. For a
set of indicator functions, the empirical process (3.8) determines uniform con-
vergence of frequencies to their probabilities, and process (3.10) determines
uniform one-sided convergence of frequencies to their probabilities.
3.3.1
Remark on the Law of Large Numbers and Its Generalization
Note that if the set of functions Q(z, a), a E A contains only one element,
then the sequence of random variables ~f defined in Eq. (3.7) always con-

3.3 EMPIRICAL PROCESSES
87
verges in probability to zero. This fact constitutes the main law of statistics,
the Law of Large Numbers:
The sequence of means converges to expectation of a random variable (if it
exists) as the number £ increases.
It is easy to generalize the Law of Large Numbers for the case where a set
of functions Q(z, a), a E A, has a finite number of elements. In contrast to
the cases with a finite number of elements, the sequence of random variables
e for a set Q(z, a), a E A, with an infinite number of elements
does not
necessarily converge to zero. The problem is:
To describe the properties of the set of functions Q(z, a), a E A, and the
probability measure F(z) under which the sequence of random variables
e converges in probability to zero.
In this case, one says that the Law of Large Numbers in a functional space
(space of functions Q(z, a), a E A) takes place or that there exists uniform
(two-sided) convergence of the means to their expectation over a given set
of functions.
Thus, the problem of the existence of the Law of Large Numbers in a
functional space (uniform two-sided convergence of the means to their ex-
pectations) can be considered as a generalization of the classical Law of Large
Numbers.
Note that in classical statistics the problem of existence of uniform one-
sided convergence has not been considered; it became important due to the
Key Theorem (which we formulate in the next section) pointing the way for
analysis of the problem of consistency of the ERM inductive principle.
The uniform convergence (3.8) means that for sufficiently large f, the
empirical risk functional approximates the risk functional uniformly well over
all functions in a given set of functions. In Chapter 2, Section 2.6 we showed
that when uniform convergence takes place, the function which minimizes
empirical risk provides the value of the risk that is close to the smallest
possible risk.
So the uniform convergence gives sufficient conditions for the consistency
of the empirical risk minimization method. In this situation arises the ques-
tion:
Is it possible that the requirement ofuniform convergence is too strong? Can
there exist a situation such that the empirical risk minimization method
is consistent, but at the same time, the uniform convergence does not take
place?
In the next section we show that such a situation is impossible. We show
that one-sided uniform convergence forms not only the sufficient condi-

88
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
tions for the consistency of the empirical risk minimization method, but the
necessary conditions as well.t
3.4
THE KEY THEOREM OF LEARNING THEORY (THEOREM
ABOUT EQUIVALENCE)
In this section we formulate the key theorem of learning theory which we
prove in the next section. We show that for strict consistency of the empirical
risk minimization method, it is necessary and sufficient that one-sided uniform
convergence over a given set of functions takes place.
Theorem 3.1. Let there exist the constants a and A such that for all func-
tions in the set Q(z, a), a E A, and for a given distribution function F(z), the
inequalities
a ~I Q(z, a) dF(z) ~ A,
aEA
hold true.
Then the following two statements are equivalent:
1. For the given distribution function F(z), the empirical risk minimization
method is strictly consistent on the set of functions Q(Z, a), a E A.
2. For the given distribution function F(z), the uniform one-sided conver-
gence of the means to their mathematical expectation takes place over the
set offunctions Q(z, a), a E A.
This theorem is stated for some fixed probability measure. However, the
main interest of learning theory is to find conditions under which the em-
pirical risk minimization method is consistent for any probability measure in
the set P. (If we have no a priori information about the problem at hand,
and the distribution that performs the generator of random vectors, then
the set P = Po is the set of all possible probability measures.) The follow-
ing corollary describes conditions of consistency for the set of distribution
functions:
Corollary. Let there exist such constants a and A that for all functions in the
set Q(z , a), a E A, and all distribution functions: F = F(z) in the set P, the
inequalities
hold true.
a ~ IQ(z, a) dF(z) 'S A,
a E A, F(z) E P
t Note that necessary and sufficient conditions for consistency of the learning processes is given
by uniform one-sided convergence but not two-sided because we face a nonsymmetric situation:
We are looking for consistency of results in minimizing the empirical risk. but we do not bother
about consistency of results in maximizing the empirical risk.

3.5 PROOF OF THE KEY THEOREM
89
Then the following two statements are equivalent:
1. For any distribution function in the set P, the empirical risk minimiza-
tion method is strictly consistent on the set of functions Q(z, a), a E A.
2. For any distribution function in the set P, the uniform one-sided con-
vergence of the means to their mathematical expectation takes place
on the set of functions Q(z,a), a E A.
3.5
PROOF OF THE KEY THEOREM
Let the empirical risk minimization method be strictly consistent on the set
of functions Q(z, a), a E A. According to the definition of strict consistency
(for a fixed measure) this means that for any c such that the set
A(c) = {a:
/
Q(z, a)dF(z) ~ c}
is nonempty the following convergence in probability is true:
(
inf
~ L Q(z;, a) ~
inf
/
Q(z, a) dF(z).
aEA(c) {.
.
(-'00 aEA(c)
1=1
Consider a finite sequence of numbers aI, ..., an such that
(3.11 )
We denote by Tk the event
f
inf
~ L Q(z;, a) <
inf IQ(z, a) dF(z) - :'2'
aEA(ak) {.
.
aEA(a.l
1=1
Then by virtue of (3.11),
We denote
(3.12)
Since n is finite and for any k the relation (3.11) is true, it follows that
P(T) ~O.
(--->00
(3.13)

90
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
We denote by A the event
Suppose that A takes place. Then there will be a* E A such that
f
I Q(z, a*) dF(z) -
8 > ~ L Q(Zi, at).
i=1
From a* we find k such that a* E A(ak) and
/
Q(z, a*) dF(z) - ak < ~.
For the chosen set A(ak) the inequality
/
Q(z, at) dF(z) -
inf I Q(z, a) dF(z) < -2
8
aEA(lId
holds true.
Therefore for the chosen a* and A(ad, the following inequalities hold:
inf
/
Q(z, a) dF(z) -
~2 >I Q(z, a*) dF(z) -
8
aE,\(II. )
1
f
1
f
> Ii L Q(Zi, a*) ~
inf
Ii L Q(Zi, a),
{.
.
aEA(a.) l:
.
1=1
1=1
that is, the event Tk does occur and, hence, so does T.
Therefore,
P(A) < P(T).
By (3.13),
lim P(T) = 0,
f~oo
which expresses uniform one-sided convergence
The first part of the theorem is proved.

3.5 PROOF OF THE KEY THEOREM
91
Now suppose that uniform one-sided convergence (3.14) takes place. Let
us prove that in this case the strict consistency takes place-that is, that for
any 8 the convergence
limp{
inf !Q(Z,a)dF(Z)-
inf ~tQ(z;,a) >8}=O
f-+x>
aEA(c)
aEA(c)
~
.1=1
holds. Let us denote by A the event
f
inf !Q(z,a)dF(Z) -
inf
_(1 LQ(z;,a) > 8.
aEA(c)
aEA(c)
.
.1=1
Then the event A is the union of the two events
where
AI={Z:
inf !Q(Z,a)dF(Z)+8<
inf ~tQ(z;,a)},
aEA(c)
aE,\(c)
~
.1=1
and
A 2 = {z:
inf! Q(z, a)dF(z) - 8>
inf
~ t
Q(z;, a)}.
aEA(c)
aEA(c)
~
,1=1
The goal is to bound the probability of the event A
Suppose that the event Al occurs. To bound P (AI) we take a function
Q(z, a*) such that
!
Q(z,a*)dF(Z) <
inf !Q(Z,a)dF(Z)+ -28 .
aEA(c)
Then the inequality
f1"" ( *!
*
8
iL....JQz;,a»
Q(z,a)dF(z)+2"
;=1
holds. The probability of this inequality is therefore not less than probability
of the event AI:
P(A,l ~ P {~tQ(Zi,U') - JQ(z,u')dF(z) > i}i::O.
(3.15)

92
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
The probability on the right-hand side tends to zero by the law of large
numbers.
If, on the other hand, the event A z occurs, then there is a function Q(z, a**),
a** E A(c) such that
1
~ L Q(z" a**) + -2
6 <
inf ! Q(z, a) dF(z) <! Q(z, a**) dF(z),
~
.
aE,\(c)
1=1
and, therefore,
PtA,) < P {/ Q(z, aU) dF(z) - ~t Q(z" aU) > ~ }
(3.16)
< P {~~~ (/ Q(z, a)dF(z) - ~t. Q(z" a)) > ~ } ~ 0
by virtue of (3.14).
Because
P(A) ~ P(A1) + P(Az)
from (3.15) and (3.16) we conclude that
P(A) ----4 O.
I~oo
The theorem is proven.
3.6
STRICT CONSISTENCY OF THE MAXIMUM LIKELIHOOD METHOD
As was shown in Chapter 1, the empirical risk minimization method en-
compasses the maximum likelihood method. However, for the maximum
likelihood method, we define another concept of strict consistency. This
definition requires that for any density p(x, ao) from the given set of densities
p(x, a), a E A, the convergence in probability
f
inf ~ L(-logp(x"a)) ~ inf !(-IOgp(X,a))p(X,ao)dX
aEcA
~
1"""'00 aEcA
'=1
has to be valid.
For the consistency of the maximum likelihood method on a set of densities
the following theorem is true:

3.7 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
93
Theorem 3.2. For the maximum likelihood method to be strictly consistent on
the set of densities
0< as p(x, a) SA < 00,
aEA
it is necessary and sufficient that uniform one-sided convergence takes place
for the set offunctions
Q(x, a) = -Iogp(x, a),
with respect to some measure p(x, au), au E A.
aEA
Remark. It will be clear from the proof that this theorem contains in implicit
form the following assertion: If one-sided uniform convergence on the set of
functions
Q(x, a) = -Iogp(x, a),
aEA
takes place with respect to some density p(x, au), then it will take place with
respect to any density of the set p(x, a), a E A.
This theorem will be proved in Chapter 16.
Thus, the theorems about equivalence replaced the problem of the strict
consistency of the empirical risk minimization method with the problem of
existence of uniform one-sided convergence of means to their mathematical
expectations or, in other words, with convergence of some empirical process.
The third part of this book is devoted to studying in detail the convergence of
appropriate empirical processes. However, in the next sections of this chapter
we describe the main results of these studies.
3.7
NECESSARY AND SUFFICIENT CONDITIONS FOR UNIFORM
CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
3.7.1
Three Cases of Uniform Convergence
Up until now in our consideration of the problem of risk minimization from
empirical data, we did not care what specific properties the set of functions
Q(z, a), a E A has. Now, to describe the necessary and sufficient conditions
for uniform convergence (in this section we consider the problem of uniform
two-sided convergence, rather than uniform one-sided convergence), we will
distinguish between three classes of functions:
1. First, we consider sets of indicator functions Q(z, a), a E A. For this set
of functions, we formulate the necessary and sufficient conditions for
uniform convergence of frequencies to their probabilities.

94
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
2. Then, we generalize this result for uniformly bounded sets of func-
tions Q(z,a),a E A. The set of functions Q(Z,a),a E A, is uniformly
bounded if there exists a constant C such that for any function in this
set, the inequality /Q(z, a)/ ~ C is valid. For such sets of functions,
we describe the necessary and sufficient conditions for uniform conver-
gence of means to their mathematical expectations.
3. Lastly, using the results for uniformly bounded set of functions we will
describe the necessary and sufficient conditions for uniform conver-
gence of means to their mathematical expectations for the general case,
namely, when Q(z, a), a E A, is a set of unbounded functions.
Thus, we shall obtain the general result in three steps.
3.7.2
Conditions of Uniform Convergence in the Simplest Model
Now let Q(z, a), a E A, be a set of indicator functions. Our goal is to describe
the necessary and sufficient conditions for uniform two-sided convergence-
that is, the convergence
p b~1JQ(z,a)dF(z) ~}t. Q(z" 12)1> e} ~ 0
(3.17)
for any B > O.
For the set of indicator functions Q(z, a), a E A, we can rewrite (3.17) in
the form
P {suPIP{Q(z,a) > O} - vr{Q(z,a) > O}l > e} ~O,
uEA
f--.x,
(3.1 R)
where P {Q(z, a} > O} are probabilities of the events Au = {z : Q(z, a) > O} ,
a E A, and v,{Q(z, a) > O} are frequencies of these events obtained on the
given data z), "', Zp.
According
to
the
Bernoulli
theorem
for
any
fixed
event
A * =
{z : Q(z, a*) > O}, the frequencies converge to the probability when the num-
ber of observations tends to infinity. The inequality
P {IP{Q(z, a*) > O} - VdQ(Zi, a*) > O}I > e} ~ 2exp{-2e2l'}
(3.19)
(Chernoff inequality) describes the rate of convergence.
Our goal, however, is to describe the conditions for uniform convergence
(3.17) over the set of events au = {z : Q(z, a) > O}, a EA. Let us start with
the simplest model.

3.7 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILIlIES
95
The Simplest Model. Let our set of events contain a finite number N of
events Ak = {z : Q(z, ak) > O}, k = 1,2, .., N. For this set of events, uniform
convergence does hold. Indeed, the following sequence of inequalities is valid:
P{ max IP{Q(z, ak) > O} - vdQ(z;, ad > O}I > e}
IsksN
N
::; LP{IP{Q(z,ad > O} - vt{Q(z;, ak) > O}I > s}
k=!
::; 2N exp{-2s2f}
= 2 exp {CnfN - 2s2) f}.
(3.20)
(3.21 )
(To get (3.20) we use the Chernoff inequality (3.19).) The last expression
suggests that in order to obtain uniform convergence for any s, the expression
(3.22)
has to be true.
Of course, for the case when our set contains a finite number N of events
and the number of observations tends to infinity, this relation is true. This also
proves that for any set with a finite number of events, uniform convergence
takes place. However, relations of type (3.22) will be indicative for uniform
convergence also in the case where the number of events in a set is infinite.
3.7.3
Entropy of a Set of Functions
The main idea of the conditions for uniform convergence that will be de-
scribed below and will be proved in Chapter 14 is as follows. Even if the set
of events contains infinitely many elements, only a finite number of clusters
of events is distinguishable on the given sample Zl, ... , z,. (Two events are
distinguishable on a sample if there exists at least one element in the sample
that belongs to one event and does not belong to the other.)
It is clear that in this case the number of clusters is not fixed and depends
both on a sample and on a given set of functions. Let us denote the number of
clusters by N A(Zl, .. , Zt). Roughly speaking, the idea is to substitute in (3.22)
the value NA(ZI,,,,ZF) that depends on the sample ZI,",Z, and on the set
of events All' = {z : Q(z, a) > O}, a E A. We will show that if N'\(ZI, ...zd
increases slowly as the sample size increases (slower than any exponential
function), then (3.21) converges to zero as f
--t 00, and uniform convergence
takes place.
Now we determine a new concept which we will use for constructing the
necessary and sufficient conditions for uniform convergence. Let a set of

96
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
Q(Zl'U)
FIGURE 3.4. The set of f-dlmenslonal binary vectors q(a), a E A, Is a subset offhe set of
vertices of the f-dimensional unit cube.
indicator functions Q(z, a), a E A be determined on the set Z. Consider an
arbitrary sequence of fJ vectors from the set Z:
Zl, ..., Zf·
(3.23)
Using these data, along with the set of indicator functions, let us determine
the set of e-dimensional binary vectors
q(O') = (Q(ZI, a), ..., Q(Zf, a)),
a E A.
For any fixed a = a* the binary vector q(a*) determines some vertex of the
unit cube (Fig. 3.4). Denote the number of different vertices induced both
by the sample (3.23) and by the set of functions Q(z, a), a E A:
It is clear that
Let for any fJ the function N'\(Z1, ...,zp) be measurable with respect to the
probability measure
f
P(ZI"",Zf)= ITp(z;).
;=1
Definition. We say that the quantity
HA(ZI' ..., Zf) = InNA(Zl, ...,Zr)
is the random entropy of the set of indicator functions Q(z, a), a E A, on the
sample Zl, ... ,Zf.

3.7 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
97
We also say that the quantity
is the entropy of the set of indicator functions Q(z, a), a E A, on samples of
size e.
3.7.4
Theorem About Uniform Two-Sided Convergence
Under the appropriate conditions of measurability of a set of functions the
following theorem is valid.
Theorem 3.3. In order that uniform convergence
over the set of indicator functions Q(z, a), a E A be valid it is necessary and
sufficient that the condition
be satisfied.
HA(€)
--'-'- ----t 0
e
/-+00
(3.24)
In Chapter 14 along with Theorem 3.3 we will prove a stronger assertion:
Theorem 3.3a. If condition (3.24) of Theorem 3.3 is satisfied, then almost sure
uniform convergence takes place
sup I/Q(z,a)dF(Z) - ~ tQ(Zi,a)/ ~O.
aEA
(:
.
f-+oo
1=1
Therefore condition (3.24) is necessary and sufficient for almost sure uniform
two-sided convergence of frequencies to their probabilities.
Thus, the conditions for uniform convergence (3.24) for an infinite number
of functions have the same form as for a finite number (3.22). The difference
is only in characterizing the capacity of a set of functions. In the simplest
case, it was the number of functions in the set; in the general case, it is the
entropy of the set of indicator functions on a sample of size f.

98
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
3.8
NECESSARY AND SUFFICIENT CONDITIONS FOR UNIFORM
CONVERGENCE OF MEANS TO THEIR EXPECTATIONS FOR A SET
OF REAL-VALUED BOUNDED FUNCTIONS
3.8.1
Entropy of a Set of Real-Valued Functions
Below, we generalize the theorem about uniform convergence obtained for
sets of indicator functions to sets of real-valued functions.
We start with uniformly bounded functions Q(z, a), a E A, where
IQ(z, a)1 < C,
a E A.
First we generalize the definition of entropy for sets of indicator functions to
sets of bounded functions. As in the last section, let us consider the sequence
of vectors
Zl, "', Zr
and the set of i-dimensional vectors
q*(a) = (Q(Zl, a), ..., Q(zr, a)),
a E A.
The set of vectors q* (a), a E A, is induced both by the sample Z1, ... , Zr and
by the set of uniformly bounded functions Q(z, a), a E A.
In the last section, we considered the set of binary vectors q(a), a E A,
that was induced by the set of indicator functions Q(z, a), a E A. For the
given definition of entropy, it was important that the set of vectors q(a), a E A
contained a finite number of elements. Now our set of vectors q*(a), a E A,
contains an infinite number of elements, from the i-dimensional cube with
edges of length 2C. Note that the set of vectors q*(a), a E A, belongs to the
cube, but does not necessarily coincide with it (Fig. 3.5).
In mathematics, the necessity often arises to extend results valid for a finite
set of elements to the infinite case. Usually such a generalization is possible
if the infinite set can be covered by a finite €-net.
Q(Z)J a)
FIGURE 3.5. The set of f-dimensional vectors q(a), a E .\. belongs to an f-dimensiondl
cube.

3.8 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTATIONS
99
Definition. The set B of elements b in a metric space M is called an €-nel of
the set G if any point g EGis distant from some point b E B by an amount
not exceeding €, that is,
p(b,g) < €.
We say that the set G admits a covering by a finite €-nel if for each € there
exists an €-net BE consisting of a finite number of elements.
We say that the €-net B; is a minimal €-nel if it is finite and contains a
minimal number of elements.
To consider a minimal €-net of the set of vectors q*(O'), 0' E A, it is nec-
essary to choose a metric in .e-dimensional Euclidean space. In Chapter 15
we show that the necessary and sufficient conditions of uniform convergence
can be constructed using the C metric
Let the number of elements of a minimal €-net of the set of the vectors
q*(O'),
0' E A, be
NA(€;z\"",Zf)'
This number depends on the value of €, on the set of functions Q( Z, 0'),
0' E A, and on the random sample Z\, ..., Zf' Using this number, we introduce
the concept of random entropy, and the entropy for a given set of real-
valued functions. Suppose that for any.e the function InN·\(B;z\, ...,Zr) is
measurable.
Definition. We say that the quantity
is the random €-enlropy of the set of uniformly bounded functions Q(z. 0').
0' E A on the sample Zj, ... , Ze.
We say also that the quantity
is the €-entropy of the set of uniformly bounded functions Q(z, 0'),0' E A, on
samples of size .e.
3.8.2
'rheorem About Uniform Two-Sided Convergence
Under the appropriate conditions of measurability of a set of functions the
following theorem is valid:

100
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
Theorem 3.4. In order that uniform convergence
over a set of uniformly bounded functions Q(z, a), a E A. be valid, it is
necessary and sufficient that for any e > 0 the conditions
(3.25)
be satisfied.
In Chapter 15 along with this theorem we will prove a stronger assertion:
Theorem 3.4a. If condition (3.25) of Theorem 3.4 is satisfied, then almost sure
uniform convergence takes place
supII Q(z, a) dF(z) - ~t Q(Zi, a)I~ o.
aEA
~
.
f-+'XJ
1=1
Therefore condition (3.25) is necessary and sufficient for almost sure uniform
two-sided convergence of means to their expectations.
These theorems are generalizations of the theorems for the sets of indica-
tor functions described in the last section. Indeed, for the C metric if E < 1,
the number of elements of the minimal E-net of the set of indicator functions
coincides with the number of different vertices on the unit cube induced by
the set of indicator functions.
3.9
NECESSARY AND SUFFICIENT CONDITIONS FOR UNIFORM
CONVERGENCE OF MEANS TO THEIR EXPECTATIONS FOR SETS
OF UNBOUNDED FUNCTIONS
In order to complete the description of the theory of uniform two-sided
convergence, it remains to establish the necessary and sufficient conditions of
uniform two-sided convergence for the general case, namely, when Q(z, a),
a E A, is a set of arbitrary real-valued functions with bounded expectations
-00 < a::;IQ(z, a) dF(z) ::; A < 00,
Q(z, a), a E A..
To state the necessary and sufficient conditions for this case we shall con-
sider a new notion: the envelope of a set of functions.

3.9 UNIFORM CONVERGENCE FOR UNBOUNDED SETS OF FUNCTIONS
101
Definition. We say that function K(z) is an envelope of the set of functions
Q(z, a), a E A, under the probability measure F(z) if
sup IQ(z, a)1 ::; K(z)
aEA
and
/ K(z) dF(z) < 00.
Consider along with the set of functions Q(z, a), a E A, the set of C-
bounded functions
Qc(z, a) = { g(Z, a)
-C
for
Q(z, a) > C
for
IQ(x, a)1 ::; C
for
Q(z, a) < -C
for C > O. For any given C, the conditions of uniform convergence fur the set
Qdz, a), a E A, are given in Theorem 3.4. The next theorem asserts that for
uniform convergence on a set of arbitrary real-valued functions it is necessary
and sufficient that the envelope exists and that for any C the entropy of the
set of functions Qdz, a), a E A, satisfies the conditions of Theorem 3.4.
Theorem 3.5 (Gine and Zinn). In order that on the set of functions Q(z, a),
a E A, with bounded expectations almost sure uniform convergence
/
1
f
sup
Q(z,a)dF(z) -
-e LQ(zi,a)
~O,
a~
.
I-~
1=1
takes place, it is necessary and sufficient that the set of functions Q(Z, a),
a E A, has the envelope K(z) and that for any C and any E > 0 on the set of
bounded functions Qdz, a), a E A, conditions (3.25) be satisfied.
3.9.1
Proof of Theorem 3.5
Proof of the Sufficiency. Let there exist an envelope for the set of functions
Q(z, a), a E A:
sup IQ(z, a)1 ::; K(z),
aEA
/
K(z) dF(z) < 00.
and suppose that for any C and for any E the set of functions Qdz, a), a E A,
has an entropy satisfying the condition
HA(E;e)
--- ------+ O.
e
f->~

102
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
To prove that in this case almost sure convergence
1
1'
~~~
Q(z, a) dF(z) -
£" ~ Q(Zi, a)
f a~s~ 0
takes place we choose C such that for a given £ the inequality
I(K(z) - Ct dF(z) ~ £
is valid, where
(u)+ = max(u, 0).
Let Q(z, a*) be a function on which the supremum is achieved. Then the
inequa Iities
hold. Since the first term on the right-hand side of the inequalities converges
almost surely to zero (according to Theorem 3.4a), and the second term con-
verges almost surely to a nonnegative value that is less than £ (according to
the Strong Law of Large Numbers), one can assert that the whole expres-
sion on the right-hand side converges almost surely to zero. Therefore the
nonnegative expression on the left-hand side converges almost surely to zero.
Proof of Necessity. Suppose almost sure uniform convergence takes place.
We have to prove that:
1. There exists an envelope
sup IQ(z, a)1 :::; K(z),
ll't.\
IK(z) dF(z) < 00.

3.9 UNIFORM CONVERGENCE FOR UNBOUNDED SETS OF FUNCTIONS
103
2. For the set of functions QC(z, a), a E A, defined by any C > 0 the
equality
holds true.
Existence of the envelope. We prove existence of the envelope in four
steps.
1. First we prove that almost sure convergence to zero of the sequence of
random variables
as f
-----t 00
implies almost sure convergence to zero of the following sequence of
random variables
I
f Q(z, a) dF(z) - Q(Zf, a) I
0
sup
-----t
aE,\
f
as f
-----t IX.
Let us denote by Q(Z, an the function that maximizes the difference
Q(Zf, an = arg~~~II Q(z, a)dF(z) - Q(z{, a)l·
The following inequalities hold true:
I
1
f
~~~
Q(z, a) dF(z) - £ ~ Q(Zi, a)
f
L JQ(z, a) dF(z) - Q(Zi' a)
= sup
f
aEA
i=1
2:' IJQ(z, an dF~Z) - Q(Zf' an I
_ f - 1 ~ IJQ(z, an dF(z) - Q(Zi, an I
£
~
£-1
.
i=1
Therefore

104
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
o < IJQ(z,andF~z)-Q(zi,anl
/
1
f
< ~~\
Q(z, a) dF(z) - fEQ(Zi, a)
£ -1 ~ /JQ(Z,a£)dF(Z) - Q(Zi,anl
+
£
~
£-1
.
i=l
Since both terms on the right-hand side converge to zero almost surely
(the first term due to the condition of the theorem and the second term
due to strong law of large numbers), the nonnegative random variable
on the left-hand side converges almost surely to zero.
2. Second we prove that existence of the expectation Eg of the non-
negative random variable is equivalent to convergence of the sum
00
LP{g>is}<oo
i=]
(3.26)
for any s > O.
Indeed, using the Lebesgue integral one defines expectation as the
limit (for s ~ 0) of the sums
Therefore existence of the expectation Eg is equivalent to convergence
of the sum (3.26) for any s > o.
3. Third. using this fact we prove that the expectation
E ~~~ 1/ Q(z, a) dF(z) - Q(Zf, 0')1 < 00
exists. Indeed, note that the sequence of random variables
(3.27)
£ = 1,2, ...
is independent. Therefore according to the Borel-Cantelli lemma (see
Chapter 1, Section 11.1), if the sequence of independent random vari-
ables
~f converges almost surely, then the sum
fp {I/ Q(z,af)dF(z) - Q(z(,anl > £s} < 00
f=1
is bounded. Hence Eq. (3.27) holds.

3.9 UNIFORM CONVERGENCE FOR UNBOUNDED SETS OF FUNCTIONS
105
4. Furthermore, we have
Esup IQ(z, 0')1
aEA
.::; E sup1/ Q(z, a) dF(z) - Q(z, 0')1 + E sup1/ Q(z, a) dF(z)1
aEA
aEA
(3.28)
Recall that we consider a set of functions satisfying constraints
-00 < a ~ /
Q(z,O')dF(z) ~ A < 00.
Therefore from (3.27) and (3.28) we conclude that
EsupIQ(z,a)1 < 00
aEA
which imply the existence of an envelope.
Sliblinear growth of the entropy. Now we have to prove that for any C > 0
the entropy of the set of functions Qc(z, a), a E A, satisfies the required
conditions. Note that if condition (3.25) is satisfied for a set of functions with
some C*, then it is satisfied for sets with C < C*. Therefore it is enough to
prove that condition (3.25) is satisfied for a set of functions with sufficiently
large C*.
Let us choose such large C* that for a given small s > 0 the inequality
/ (K(z) - C*)+ dF(z) < ~
holds true. We have
/
1
l
~~~
Q(z, a) dF(z) - f ~ Q(Zi, a)
/
1
l
~ ~~~
Qc'(z, a) dF(z) - f t1 QC·(Zi, a)
/
1
f
-~~r
(K(z) - C*)+ dF(z) - f ~ (K(z) - C*t·
Therefore we have
/
1
l
sup
Qc(z,O')dF(z) - f LQc(Zi'O')
aEh
i=l
/
1
f
1
f
~ ~~~
Q(z, O')dF(z) - f ~ Q(Zi, a) + s + f ~ (K(Zi) - C*)+.

106
3 CONOIrIONS FOR CONSISfENCY OF EMPIRICAL RISK MINIMIZAliON PRINCIPLE
The left-hand side of this expression converges almost surely to zero since the
first tenn on the right-hand side converges almost surely to zero (according
to condition of the theorem), and the last term converges almost surely to
the corresponding expectation that is not larger than 8. Therefore for the
uniformly bounded set of functions Qc'(z, a), a E A, the uniform two-sided
convergence takes place. According to Theorem 3.4, this implies condition
(3.25).
3.10
KANT'S PROBLEM OF DEMARCATION AND POPPER'S THEORY
OF NONFALSIFIABILITY
Thus far we have considered theorems about two-sided uniform convergence.
We have constructed the characteristics of the capacity of sets of functions
(which in some sense generalizes the number of functions in a finite set
of functions) and then have used these characteristics (entropy of sets of
indicator functions or entropy of sets of real-valued functions) to obtain the
necessary and sufficient conditions for (two-sided) uniform convergence.
However, our goal is to obtain the necessary and sufficient conditions
for consistency of the principle of empirical risk minimization. In Section
3.4, we showed that the condition of consistency of this induction principle
coincides with the conditions of uniform one-sided convergence of means to
their mathematical expectations over a given set of functions. As we shall
see, the conditions for uniform one-sided convergence are expressed on the
basis of conditions for uniform two-sided convergence.
However, obtaining uniform one-sided convergence using unifonn two-
sided convergence is not only a technical detail. To find these conditions, it
is necessary to construct a mathematical generalization of one of the most
impressive ideas in the philosophy of science-the idea of nonfalsifiability. In
Section 3.11 we shall consider theorems about nonfalsifiability, but for now
let us remind the reader what the subject of philosophy of science and the
idea of nonfalsifiability are.
Since the era of ancient philosophy, two models of reasoning have been
accepted:
• deductive, which means moving from general to particular, and
• inductive, which means moving from particular to general.
A model in which a system of axioms and inference rules is defined by means
of which various corollaries (consequences) are obtained is ideal for the de-
ductive approach. The deductive approach should guarantee that we obtain
true consequences from true premises.
The inductive approach to reasoning consists of the formation of general
judgments from particular assertions. However, general judgments obtained
from true particular assertions are not always true. Nevertheless, it is assumed

3.10 KANT'S PROBLEM OF DEMARCATION AND POPPER'S THEORY
107
that there exist such cases of inductive inference for which generalization
assertions are justified.
The demarcation problem, originally proposed by 1. Kant, is a central
question of inductive theory:
What is the difference between the cases with a justified inductive step and
those for which the inductive step is not justified?
The demarcation problem is usually discussed in terms of the philosophy of
natural science. All theories in the natural sciences are the result of gen-
eralizations of observed real facts and therefore are built using inductive
inference. In the history of natural science, there have been both true theo-
ries that reflect reality (say chemistry) and false ones (say alchemy) that do
not reflect reality.
The question is the following:
Is there a formal way to distinguish between true and false theories?
Let us assume that meteorology is a true theory and astrology is a false
one.
What is the formal difference between them?
Is it in the complexity of their models?
Is it in the predictive ability of their models?
Is it in their use of mathematics?
Is it in the level of formality of inference?
None of the above gives a clear advantage to either of these two theories.
The complexity of astrological models is no less than the complexity of
the meteorological models.
Both theories fail in some of their predictions.
Astrologers solve differential equations for restoration of the pOSitIOns
of the planets, which are no simpler than the basic equations in the
meteorological theory.
Finally, both theories have the same level of formalization. It contains
two parts: (1) the formal description of reality and (2) the informal
interpretation of it.
In the 1930s, K. Popper suggested his famous criterion for demarcation be-
tween scientific and nonscientific theories.t According to Popper. a necessary
condition for justifiability of a theory is the feasibility of its falsification. By
the falsification of a theory, Popper means the existence of a collection of
t Popper used the terminology of empirical and metaphysical thcorics.

(3.29)
108
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
particular assertions which cannot be explained by the given theory although
they fall into its domain. If the given theory can be falsified, it satisfies the
necessary conditions of a scientific theory.
Let us come back to our example. Both meteorology and astrology make
weather forecasts. Consider the following assertion:
In the New York area, both a tropical storm and snowfall can happen in
one hour.
Suppose that according to the theory of meteorology, this is impossible.
Then this assertion falsifies the theory because if such a situation really will
happen (note that nobody can guarantee with probability one that this is
impossible) the theory will not be able to explain it. In this case the theory
of meteorology satisfies the necessary conditions to be viewed as a scientific
theory.
Suppose that this assertion can be explained by the theory of astrology.
(There are many elements in the starry sky, and they can be used to create an
explanation.) In this case, this assertion does not falsify the theory. If there is
no example that can falsify the theory of astrology, then astrology according
to Popper should be considered a nonscientific theory.
In the next section we describe the theorems of nonfalsifiability. We show
that if for some set of functions, conditions for uniform convergence do not
hold, the situation of nonfalsifiability will arise.
3.11
THEOREMS ABOUT NONFALSIFIABILITY
In this section we show that if uniform two-sided convergence does not take
place, then the method of empirical risk minimization is nonfalsifiable.
3.11.1
Case of Complete Nonfalsifiability
To give a clear explanation of why this happens, let us start with the simplest
case. Suppose for the set of indicator functions Q(z, a), a E A, the following
equality is true:
lim H
A(£) = In 2.
(-00
£
Intuitively, it is clear that the ratio of the entropy to the number of observa-
tions H A(£)/ £ monotonically decreases when the number of observations £
increases. (This is proven formally in Chapter 14.) Thus, if (3.29) happened,
then for any finite number £ the equality
HA(£) = In2
£
holds true.

3.11 THEOREMS ABOUT NONFALSIFIABILITY
109
Q
1 ----------.-------- ~---
Ii V
Q(z, a")
I
I
o
Z3 Z{_
2 Z{ _
1
Z[
z
FIGURE 3.6. A learning machine with the set of functions Q(z. a). a E A,ls nonfalsifiable
if for almost all samples ZI,"
. ,z, given by the generator of examples and for any
possible labels 81,""
8f for these is, the machine contains a function Q(z, a') that
provides equalities 8/ = Q(x/, a), i = 1, ... ,f. .
According to the definition of entropy, this means that for almost all sam-
ples Z], ... , Zf the equality
is valid.
In other words, the set of functions of the learning machine is such that
almost any sample Z], ..., Zp (of arbitrary size e) can be separated in all possi-
ble ways by functions of this set. This implies that the minimum of empirical
risk for this machine equals zero. We call this learning machine nonfalsifiable
because it can give a general explanation (function) for almost any data (see
Fig. 3.6).
3.11.2
Theorem About Partial Nonfalsifiability
In the case when entropy of the set of indicator functions over the number of
observations tends to a nonzero limit, the following theorem shows that there
exists some subspace of the original space Z where the learning machine is
nonfalsifiable.
Theorem 3.6. For the set of indicator functions Q(z, a), a E A, let the conver-
gence
be valid.
Then there exists a subset Z· of the set Z such that
(a)
and (b) for the subset
P(Z·) = c
zj, ..., zZ = (z], ..., zp) n Z·

110
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
t_z_z_z_z_zj
Q
1
-
-
~-
/
Q(z, cx")
,..
T
T
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
I
1
I
0
zl
z2
"
•
•
•
•
Z[ __ 2Z[ _
1 Z[
z
z·
FIGURE 3.1. A learning machine with the set of functions Q(Z, 0'), 0' E A, is partially
nonfalsifiableif there exists a region Z' E Zwlth nonzero measure such that for almost all
samples Zl , ...• Zf given by the generator of examples and for any labels 01 , ...• Of for
these is, the machine contains a function Q(z. 0") that provides equalities 01 = Q(Z;, 0')
for all z/ belonging to the region Z' .
of almost any training set
that belongs to Z' and for any given sequence of binary values
l)i E {O, I}
there exists a fimction Q(z, a") for which the equalities
l)/ = Q(zi, a*),
i = 1,2,,,.,k
hold true.
This theorem shows that if conditions of uniform convergence fail, then
there exists some subspace of the input space where the learning machine is
nonfalsifiable (see Fig. 3.7).
3.11.3
Theorem About Potential Nonfalsifiability
Now let us consider the set of uniformly bounded real-valued functions
a EA.
For this set of functions a more sophisticated model of nonfalsifiability will
be used. So we give the following definition of nonfalsifiability:
Definition. We say that the learning machine that has an admissible set of
real-valued functions Q(z, a), a E A, is potentially nonfalsifiable if there exist

3.11 THEOREMS ABOUT NONFALSIFIABILITY
111
two functions t
such that:
1. There exists some positive constant c for which the equality
1(0/1 (z) - I/Jo(z )) dF (z) = c >°
holds true.
2. For almost any sample
Zt, ... , Zp,
any sequence of binary values,
8i E {0,1},
and any e, one can find a function Q(z, a*) in the set of functions
Q(z, a), a E A, for which the inequalities
8i E {O, 1}
hold true.
In this definition of nonfalsifiability, we use two essentially different func-
tions 0/1 (z) and %(z) to generate the values Yi of the function for the given
vectors Zi. To make these values arbitrary, one can switch between these
two functions using the arbitrary rule 8i . The set of functions Q (z , a), a E A,
forms a potentially nonfalsifiable machine if for almost any sequence of pairs
(o/iJ(i)(zd, zd obtained on the basis of random vectors Zi and this switching
rule 8(i), one can find in this set a function Q(z, a*) that describes these pairs
with high accuracy (Fig. 3.8).
Note that this definition of nonfalsifiability generalizes Popper's notion. In
our simplest example considered in the beginning of Section 3.10, for the set
of indicator functions Q(z, a), a E A, we use this notion of nonfalsifiability
where 0/1 (z) = 1 and I/Jo(z) = 0. In Theorem 3.6 we actually use the functions
0/1 (z) = { ~(Z, a)
if z E Z*,
if z ~ Z*,
I/Jo(z) = { ~(z, a)
ifzEZ*,
if z ~Z*,
where Q(z, a) is some function from the given set of indicator functions.
On the basis of this concept of potential nonfalsifiability, we formulate
the following theorem that holds for an arbitrary set of uniformly bounded
functions (including sets of indicator functions).
t These two functions need not necessarily belong to the set Q(z, a), a E A.

112
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
Q
I
'l'o(Z)
I
I
I
I
0
Zl
Z2
Z{-2
Z(-lZ(
Z
FIGURE 3.8. A learning machine with the set of functions Q(z, a), a E A, is potentially
nonfalsifiable if for any s > Dthere exist two essentially different functions 1/11 (z) and l/1o(z)
such that for almost all samples ZI, ... ,Zf given by the generator of examples. and for
any values UI, ... , Uf constructed on the basis of these curves using the rule u, = I/Jo, (z,),
where 8, C {D, 1} is an arbitrary binary function, the machine contains a function Q(z. a')
that satisfy Inequalities /1/J5, (z,) - Q(Z" a')/ :S s, 1= 1" .. ,f.
Theorem 3.7. Suppose that for the set of uniformly bounded real-valued func-
tions Q(z, a), a E A, there exist Eo such that the convergence
is valid.
Then the learning machine with this set offunctions is potentially nonfalsi-
flab/e.
This theorem will be proved in Chapter 16.
3.12
CONDITIONS FOR ONE-SIDED UNIFORM CONVERGENCE AND
CONSISTENCY OF THE EMPIRICAL RISK MINIMIZATION PRINCIPLE
We start this section with an example of a learning machine that has a
set of functions which make it nonfalsifiable, but, nevertheless, the machine
can generalize using the empirical risk minimization principle. This happens
because learning theory considers the nonsymmetric situation where the
machine must generalize by minimizing risk rather than by maximizing risk.
Example. Let z E (0, 1), and let F (z) be a uniform distribution function.
Consider the following set of two parametric indicator functions Q(z, a, 13),

3.12 CONDITIONS FOR ONE-SIDED UNIFORM CONVERGENCE
113
a E A = (0,1),
(3 E B: Q(z, a, (3) = 1, for z ~ a and Q(z, a, (3) = °for all
z < a except for a finite number of points where it equals 1. This specific
finite number of points is determined by the parameter (3. The set of functions
is such that for any finite set of points in the region (0,1) there exists a
function specified by the parameter {3 E B which takes the value of one at
these points. It is easy to see that the learning machine that contains this set
of functions is nonfalsifiable (see Fig. 3.9). Indeed, for any set of (different)
vectors
Z1, •.. , Ze
and any sequence
l)i E {O, I}
there exist parameters a = a* and {3 = (3* which provide equalities
i=I,2, ...,£.
For this set of functions, the equality
HA.B(f.) = !InNA,B(z), ... ,ze)dzl, ...,dzr =ln2
£
f.
is valid.
Note that the value of the risk functional
R(a, (3) = I Q(z, a, (3) dz
depends on a and does not depend on {3.
Consider another learning machine that contains the following set of func-
tions:
{°
if z < a
Q*(z, a) =
1
if z ~ a
a E [0,1].
Now, suppose that both of our learning machines use the empirical risk min-
imization induction principle and the same training set
ZI,· .. ,Ze·
If-
o
(a)
a
Q(z, a, f3)
z
1
o
a
(b)
Q(z, a)
z
FIGURE 3.9. Two learning machines, one nonfalsifiable (with set of functions in part a)
and another falsifiable (with set of functions in part b), provide the same results.

114
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZAnON PRINCIPLE
It is clear that for any function Q(z, a, f3) of the first machine, there exists a
function Q* (z, a) of the second machine such that
1
f
1
f
f L Q(Zi, a, 13) ~ f L Q*(Zi, a),
i=1
i=\
IQ(z,a,J3)dz =IQ*(z,a)dz.
But, according to the Glivenko-Cantelli theorem for the class of functions
used in the second machine, uniform convergence takes place (see Chapter 2,
Section 2.4). If for the second machine uniform convergence takes place, then
for the first machine one-sided uniform convergence takes place. According
to Theorem 3.1, this implies the consistency of the learning machine using
the empirical risk minimization principle.
This example is important because it describes the general idea when such
a situation is possible. Let us repeat once more the idea of this example. We
considered the set of real-valued functions Q(z, a, f3), a E A,J3 E 5, for which
(two-sided) uniform convergence does not take place. Then we introduced a
new set of functions Q*(z, a), a E A, which had the following property: For
any function Q(z, a, 13) in the first set there was a function Q*(z, a) in the
second set such that
Q(z,a,J3) ~ Q*(z,a)
I (Q(z,a,J3) - Q*(z,a)) dF(z) < e
(3.30)
(in the example F(z) = z), where e is a arbitrary small value. We used the
fact that if for the second set of functions uniform convergence was valid,
then for the first set of functions one-sided uniform convergence takes place
(Fig. 3.10).
Exactly this scheme of reasoning will be repeated in the theorem about
one-sided uniform convergence. Let us consider a set of uniformly hounded
functions Q(z, a), a E A. We assume that all constructions we used to prove
the theorem are measurable with respect to the distribution function F(z).
Theorem 3.8. For uniform one-sided convergence to take place on a set of
uniformly bounded functions Q(z, a), a E A, it is necessary and sufficient that
for any positive f, 5, and e, there exists a set offunctions Q*(z, a), a E d, such
that (see Fig. 3.10):
1. For any jimction Q(z, a) there exists a function Q* (z, a) satisfying the
conditions
Q(z, a) ;::: Q*(z, a)
I(Q(z, a)) - Q*(z, a)) dF(z) < e.

3.12 CONDITIONS FOR ONE-SIDED UNIFORM CONVERGENCE
115
Q(z,cx )
o
Q*(z,a*)
z
FIGURE 3.10. ForanyfunctionQ(z,a), a E A,oneconsidersafunction Q"(z, a'). a' E ,\',
such that Q"(z, a') does not exceed Q(z, a) and is close to it.
2. The €-entropy of the set of functions Q*(z, a), a E ~, satisfies the in-
equality
(3.31)
Remark. This theorem gives necessary and sufficient conditions for one-sided
uniform convergence for some fixed probability measure F(z). In order that
uniform convergence take place for any probability measure F E P it is nec-
essary and sufficient that inequality (3.31) be valid for any F E P.
Chapter 16 is devoted to the proving this theorem. As we shall see, to
prove the sufficient conditions of this theorem, we use the same technique as
we use for proving sufficient conditions for two-sided uniform convergence
in Theorem 3.4. This technique is actually based on the same idea which in
three lines gives the result for the Simplest Model (Section 3.6). The essential
difference, however, is that instead of a number of functions in set N, we use
the entropy H A ( €, f).
The main difficulties in proving this theorem arise in proving the necessity
of the conditions (3.31). The proof of the necessity of these conditions is
based on the theorem about potential nonfalsifiability and will be done in
three steps:
1. First, we shall derive the following necessary (but not sufficient) condi-
tions:
Theorem 3.9. For one-sided uniform convergence to take place, it is
necessary that for any € there should exist a finite €-net ofthe set Q(z, a),
a E A in the metric L l (P):
peal, az) = / IQ(z, al) - Q(z, az)1 dF(z).

116
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
2. Next we shall prove that if the learning machine with a set of func-
tions Q*(z, a), a E A, satisfying (3.30) is potentially nonfalsifiable, then
there exist in the set Q(z, a), a E A, two functions Q(z, a*) and Q(z, a*)
which are e-close to the functions I/II(Z) and I/Io(z) in the metric LI(P).
For these functions, the inequality
/ IQ(z, a*) - Q(z, a*)1 dF(z) > c - 2e,
c>O
holds true.
3. Using these two facts, we prove the necessity of the conditions (3.31)
by the following reasoning.
We assume that one-sided uniform convergence takes place; and at the
same time for the set of functions satisfying (3.30), condition (3.31) fails.
This will bring us to a contradiction. On the one hand since uniform
one-sided convergence holds, there exists a finite e-net (Theorem 3.9)
and therefore the distance in Ll (F) between any functions within one
element of the e-net is less than 2e.
On the other hand since condition (3.31) does not hold, there exists
among the elements of a finite e-net at least one that contains func-
tions for which condition (3.31) does not hold. Since the machine that
contains functions of this element is potentially nonfalsifiable, it has
two functions with distance larger than c - 2e. Appropriate choices of
c and e give the contradiction.
Thus, Theorem 3.8 gives the necessary and sufficient conditions for uni-
form one-sided convergence. According to the corollary to Theorem 3.1,
these conditions are equivalent to the necessary and sufficient conditions for
consistency of the learning machine which uses the empirical risk minimiza-
tion induction principle.t This theorem, therefore, completes the theory of
consistency of the learning processes.
However, to complete the conceptual model of the learning theory we
have to answer two additional questions.
Theorem 3.8 determines the conditions when the learning machine is
consistent. However, it says nothing about the rate of convergence of the
obtained risks R(ar) to the minimal risk R(av). It is possible to construct
examples where the ERM principle is consistent but has an arbitrary slow
rate of convergence.
The fundamental questions are:
1. What are the conditions for the existence of a fast (with exponential
t This theorem also gives the necessary and sufficient conditions for the consistency of the maxi-
mum likelihood method in the case when the set of densities is uniformly bounded and uniformly
separated from zero (see Theorem 3.2 in Section 3.6).

3.13 THREE MILESTONES IN LEARNING THEORY
117
bounds) asymptotic rate of uniform convergence for a given probability
measure?
To answer this question means to describe the conditions under which
there exist two positive constants band c such that for sufficiently large
( > ((e, A, P), the inequality
p {~~~I! Q(z,a) dF(z) - ~ ~ Q(Zi, a)1 > e} < bexp{ce'e}
(3.32)
holds true.
2. What are the conditions for existence ofa fast asymptotic rate of uniform
convergence for any probability measure F(z) E Po?
To answer this question means to describe the necessary and sufficient
conditions under which there exist two positive constants band c such
that for sufficiently large ( > ((e, A) the inequality
sup p{supl/Q(Z,a)dF(Z)-}tQ(zi,a)1 >e} <bexp{-ce
2f}
F(Z)E'Pn
aEA
i=!
(3.33)
holds true. Note that this question for the set of indicator functions
Q(z, a), a E A, forms the general Glivenko-Cantelli problemt (see Chap-
ter 2, Section 2.4).
In the subsequent chapters we shall give in detail the answers to both
questions.
These answers will be based on some fundamental concepts of capacity of
a set of functions implemented by the learning machine. These concepts are
constructed on the basis of the concept entropy of a set of functions for the
sample of size (, considered in this chapter.
3.13
THREE MILESTONES IN LEARNING THEORY
The most important result of the described conceptual part of the learning
theory is the fact that the introduced capacity concept (the entropy) com-
pletely defines the qualitative behavior of the learning processes: the consis-
tency of learning. As we will see, the robust characteristics of this concept
tThe Generalized Glivenko-Cantelli problem introduced in Chapter 2 considers convergence
in probability uniformly for all probability measures. However, if this convergence takes place.
the bound (3.32) is valid as well.

118
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
define quantitative singularity of learning processes as well: the nonasymp-
totic bound on the rate of convergence of the learning processes for both the
distribution-dependent and the distribution-independent cases.
Obtaining these bounds is the subject of Chapter 4 and Chapter 5. The
goal of this last section is to define the structure of capacity concepts that we
use in this book and demonstrate their connections.
For simplicity, we first consider the set of indicator functions Q(z, a), a E A
(i.e., the problem of pattern recognition), and then consider the set of real-
valued functions.
As mentioned above, in the case of indicator functions Q(z, a), a E A,
the minimal e-net of the vectors q(a), a E A (see Section 2.3.3), does not
depend on e if e < 1. The number of elements in the minimal e-net
is equal to the number of different separations of the data ZI, ... , Zt by func-
tions of the set Q(z, a), a E A.
For this set of functions the entropy also does not depend on e:
where expectation is taken over (z 1, .. " Zt),
Consider two new concepts that are constructed on the basis of the values
of N'\(Zl, ... , Zf):
1. The annealed entropy
2. The growth function
These concepts are defined in such a way that for any ethe inequalities
are valid.
Indeed, the first inequality immediately comes from applying the Jensen
inequality to the entropy (for Jensen's inequality see Chapter 1, Eq, 1.12),
the second inequality is obvious. On the basis of these functions the main
milestones of learning theory are constructed.
In Theorem 3.3 we introduce the condition
(3.34)

3.13 THREE MILESTONES IN LEARNING THEORY
119
describing a sufficient condition for consistency of the ERM principle (the
necessary and sufficient conditions are given by a slightly different condition
described in Theorem 3.8). This equation is the first milestone in the pattern
recognition theory: We require that any machine minimizing empirical risk
should satisfy it.
However, this equation says nothing about the rate of convergence of the
obtained risks R(a{) to the minimal one R(ao). It is possible to construct
examples where the ERM principle is consistent, but where the risks have
arbitrarily slow asymptotic rate of convergence.
It turns out that the equation
(3.35)
is a sufficient condition for a fast rate of convergencet defined by condition
(3.32). This equation is the second milestone in the pattern recognition theory:
It guarantees a fast asymptotic rate of convergence.
Thus far, we have considered two equations: One equation describes the
necessary and sufficient condition for the consistency of the ERM method,
and the other describes the sufficient condition for fast rate of convergence of
the ERM method. Both equations are valid for a given probability measure
F(z) on the observations (both the entropy H A (£) and the annealed entropy
H~~n(f.) are constructed using this measure). However, our goal is to construct
a learning machine capable of solving many different problems (for many
different probability measures).
The following equation describes the necessary and sufficient conditions
for consistency of ERM for any probability measure:
(3.36)
It is also the casc that if this condition holds true, then the rate of convergence
is fast.
This equation is the third milestone in the pattern recognition theory. It de-
scribes the necessary and sufficient condition under which a learning machine
that implements the ERM principle has high asymptotic rate of convergence
independent of the prohability measure (i.e., independent of the problem
that has to be solved).
In more general case when we consider bounded real-valued functions the
necessary and sufficient conditions for consistency of empirical risk minimiza-
tion method is dependent on e entropy
t The necessity of this condition for a fast rate of convergence is an open question.

120
3 CONDITIONS FOR CONSISTENCY OF EMPIRICAL RISK MINIMIZATION PRINCIPLE
(for simplicity we consider the minimal £-net in C-metric). According to
Theorem 3.4 the convergence
H A(£;€.)
-----'- ----- 0,
€.
f ~rx,
\1£ > 0
defines the sufficient condition for consistency of learning processes (the
slightly different condition given in Theorem 3.8 defines the necessary and
sufficient conditions).
This equality is the first milestone in the learning theory.
In Chapter 15 we prove Theorem 15.2, which states that the fast rate of
convergence of a learning process is valid if the annealed £-entropy
is such that convergence
H~n(£;€.)
0
----- ,
€.
f-+C>G
\If: > 0
takes place.
This equality is the second milestone in learning theory.
Lastly, consider the growth function
GA(e;€.) = In sup NA(e;Zi, ...Ze).
<[ .....<'
The equation
0\(£; f.)
-----'- ----- 0,
€.
f-HX)
\1£ > 0
describes the condition under which the learning process is consistent and
has a fast rate of convergence for any probability measure. This equation is
the third milestone in the learning theory.
These milestones form the cornerstones for constructing bounds for the
rate of convergence of learning machines which we consider in Chapters 4
and 5.

4
BOUNDS ON THE
RISK FOR INDICATOR
LOSS FUNCTIONS
Beginning with this chapter we start to study the rate of convergence of the
learning processes. We look for the bounds that estimate two quantities:
1. The value of achieved risk for the function minimizing the empirical
risk.
2. The difference between the value of achieved risk and the value of
minimal possible risk for a given set of functions.
These bounds determine generalization ability of the learning machines uti-
lizing the empirical risk minimization induction principle.
In this chapter we consider the special set of loss functions, namely, the
set of indicator functions (that are specific for the pattern recognition prob-
lem). Our goal is to obtain the bounds on the rate of uniform convergence
of frequencies to their probabilities over a given set of events (defined by
indicator functions).
Deriving two types of bounds constitutes the main contents of this chapter:
1. Bounds on the rate of uniform convergence
2. Bounds on the rate of relative uniform convergence
To obtain these bounds we use two capacity concepts introduced in Chap-
ter 3: the annealed entropy and the growth function. Using these concepts
we derive both distribution-dependent bounds and distribution-independent
bounds. These bounds, however, are nonconstructive since the theory does
not provide us with clear methods to evaluate them in specific cases. There-
fore we consider a new capacity concept: the VC dimension of a set of func-
tions that can be evaluated for any given set of functions.
121

122
4 BOUNDS ON THE RISK FOR INDICATOR lOSS FUNCTIONS
In terms of the
VC dimension we obtain constructive distribution-
independent bounds on the rate of uniform convergence.
4.1
BOUNDS FOR THE SIMPLEST MODEL: PESSIMISTIC CASE
Consider the problem of minimizing the risk functional
R(a) = / Q(z, a) dF(z),
on the basis of empirical data
aEA
(4.1 )
(4.2)
where Q(z, a), a E A, is a set of indicator functions.
To minimize risk (4.1) on the basis of data (4.2) we use the principle of
empirical risk minimization. Instead of (4.1) we minimize the empirical risk
functional
1
'
Remp(a) = eL Q(Zj, a),
;=1
aEA
(4.3)
over the set of functions Q(z, a), a E A. For the indicator functions the risk
(4.1) describes the probability of events A., = {z : Q(z, a) = 1}, a E A, and
the empirical risk functional (4.3) describes the frequency of these events.
Suppose the minimum of the risk functional (4.1) is achieved on the
function Q(z, ao) and the minimum of the empirical risk functional (4.3)
is achieved on the function Q(z, a,), a, = a(Zl,""Z,).
To estimate the generalization ability of the principle of empirical risk
minimization we have to answer two questions:
• What value of the risk does the function Q(z, a,) provide?
To answer this question means to estimate the value R(a,) .
• How close is this risk to the smallest possible for a given set offunctions?
To answer this question means to estimate the difference
The answers to both these questions are based on the study of the rate of
uniform convergence
We start our studies with the simplest model which we have already met
in Chapter 3 (Section 3.7.2).

(4.4)
4.1 BOUNDS FOR THE SIMPLEST MODEL: PESSIMISTIC CASE
123
4.1 .1
The Simplest Model
We consider the model where a set of indicator functions contains a finite
number N of elements Q(z, Q'k), k = 1,2, ... ,N.
In this section and in the next two sections we shall estimate the rate
of uniform convergence for the simplest model. We shall obtain the rate of
convergence which depends on the capacity of a set of functions (logarithm
of the number N of functions in a set).
The main goal of this chapter is the generalization of the results obtained
for sets with a finite number of functions to sets of functions that contain
an infinite number of elements. To get this generalization we shall introduce
appropriate concepts of capacity of the set of functions, and then in terms
of these concepts we will obtain expressions for the bounds of the rate of
uniform convergence. These expressions are similar to ones derived for the
Simplest Model.
Below we will use additive Chernoff bounds which are valid for the E
random independent trials in the Bernoulli scheme:
p {p -
Vf > e} < exp { -2e2( }
,
P {Vf - P > e} < exp{ -2e2(}.
(4.5)
To estimate the rate of uniform convergence we consider the sequence of
inequalities
P {.~~~N(J Q(z, a,jdF(z) - } t. Q(Zi,a,j) > 8 }
~ ~p {(f Q(z, a,jdF(z) - }t Q(Zi, a,)) > 8 }
::; N exp{ -2e2(}.
(4.6)
To get (4.6) we use Chernoff inequality (4.4) (recall that for indicator func-
tions the risk functional defines probabilities and the empirical risk functional
defines frequency).
Let us rewrite this inequality in the equivalent form. To do this we intro-
duce a positive value 0 < 1'/ ::; 1 and the equality
N exp{-2e2£} = 1]
which we solve with respect to e. We obtain
_VlnN -ln1'/
e -
2£'
(4.7)

124
4 BOUNDS ON THE RISK FOR INDICATOR LOSS FUNCTIONS
Now the assertion (4.6) has the following equivalent form:
With probability 1 - 1] simultaneouslyfor all N functions in the set Q(z, ll'k),
k = 1,2, ...,N, the inequality
t
J
1
ln N -In 1]
/ Q(z,ll'ddF(z) - ZLQ(Z;,ll'k)::;
2e
i=1
(4.8)
is valid.
Let Q(z, ll'k(O)) be a function from our finite set of functions that minimizes
the risk (4.1) and let Q(z, ll'k(t)) be a function from this set that minimizes
the empirical risk (4.3). Since the inequality (4.8) is true for all functions in
the set, it is true as well for the function Q(z, ll'k(t)).
Thus with probability at least 1 - 1] the following inequality
(4.9)
is valid.
This inequality estimates the value of the risk for the chosen function
Q(z, ll'k(f))' It answers the first question about the generalization ability of
the principle of empirical risk minimization for the simplest model.
To answer the second question (how close is the risk for the chosen func-
tion to the minimal one), note that for the function Q(z, ll'k(O)) which mini-
mizes the expected risk (4.1) the Chernoff inequality
p { it. Q(z;, O"(Oj) - IQ(z, O"(Oj) dF(z) > e} ,; exp{ - 2e'f)
(4.10)
holds true.
This inequality implies that with probability 1 - 1] the inequality
(4.11 )
(4.12)
holds true.
Since Q(z, ll't) minimizes empirical risk the inequality
f
f
L
Q(z;, ll'k(O)) - L
Q(z;, ll'k(f)) ~ a
;=1
;=1
is valid. Taking this inequality into account from (4.9) and (4.11) we conclude
that with probability at least 1 - 21] the inequality
/lnN-In1]
~
A(ll'k(f)) = R(ll'k(f)) - R(ll'k(O)) ::; V
2£
+ V-----u-
holds true.

4.2 BOUNDS FOR THE SIMPLEST MODEL: OPTIMISl"IC CASE
125
Thus the two inequalities, namely (4.9) and (4.12), give complete infor-
mation about the generalization ability of the method of empirical risk min-
imization for the case when a set of functions contains a finite number of
elements: Inequality (4.9) estimates the upper bound of the risk for chosen
function, and inequality (4.12) estimates how close is this bound of the risk
to the minimal possible risk for this set of functions.
Note that these bounds are tight. In general it is impossible to improve the
right-hand side of inequalities (4.9) or (4.12). Indeed, consider the case when
N = 1. Let the function Q(z, al) be such that the risk R(a,) (probability of
the event {z: Q(z, a,) = I}; let us call this event the error) is close to 1/2.
In this case the empirical risk describes the frequencies of error Vf estimated
in the Bernoulli scheme with £ trials. When e is rather large the following
approximation
is quite tight.
Thus the inequalities (4.9), (4.12) cannot be improved if a set of functions
contains only bad functions (that provide probability of error close to 1/2).
4.2
BOUNDS FOR THE SIMPLEST MODEL: OPTIMISTIC CASE
However, the situation changes dramatically if a set of functions contains at
least one good function (which provides probability of error equal to zero).
Suppose that among our N functions there exists at least one with zero
probability of error. Then in accordance with the principle of empirical risk
minimization, one should choose the function which provides zero error on
a given sample. It is possible that there exist several such functions. Let us
choose any of them.
What is the probability that the function that provides zero empirical risk
has the expected risk larger than a given positive constant £? To estimate
this probability, one has to bound the expression
where R(ad is the value of the expected risk (4.1) for the function Q(z, ak)
and Remp(ak) is the value of the empirical risk (4.3) for this function, and
e(Remp (ak)) is the following indicator:
~
{ 1
8(u)=
0
if u = 0,
if u > O.
Let us bound this probability. The following sequence of inequalities is valid
for N > 1:

126
4 BOUNDS ON THE RISK FOR INDICATOR lOSS FUNCTIONS
P {
sup IR(ad - Remp(adIO(Remp(ak)) > e}
l'SksN
N
::; L P {IR(a,,) - Remp(a,,)!O(Remp(ak)) > e}
k=l
'S (N - 1) sup P {IR(ak) - Remp(ak)IO(Remp(ak)) > e} 'S (N - I)Pe ,
ISkSN
(4.13)
where Pe is the probability that a function with probability of error larger
than e has zero empirical risk (zero frequency of error). (Note that in (4.13)
we have coefficient N - 1 rather than N since at least one of the probabilities
in the sum is equal to zero.)
This probability can be easily bounded:
Substituting the bound of Pe into (4.13), we obtain
As was done in the last section we rewrite this inequality in equivalent form.
To do this let us consider the equality for arbitrary 0 ::; 11 ::; 1:
(N - 1)(1 - el = 11,
and solve it with respect to e:
N> 1
1
{
In(N-l)-ln11}
In(N-l)-ln11
e =
- exp
-
< ----------'-
f
-
f
'
N>l.
Now we can rewrite inequality (4.14) in the following equivalent form:
With probability 1 -
11 simultaneously all functions Q(z, a;) from a given
finite set offunctions that have empirical risk equal to zero satisfy the inequality
R(
*)
In(N - 1) - In 11
ak
:S
e
'
N>l.
(4.15)
This bound is tight. It is achieved when the set of functions Q(z, ad,
k = 1,2, ..., N, contains one function with value of risk equal to zero and
the remaining N - 1 functions form statistically independent events A k =
{z : Q(z, ak) > O} (with respect to probability measure F(z)) and have the
same value e of error probability.

4.3 BOUNDS FOR THE SIMPLEST MODEL: GENERAL CASE
127
For this optimistic case the minimal value of the risk equals zero. Therefore
with probability 1 -
1] one can assert that the difference between the value
of the guaranteed risk and the value of the best possible risk has the bound
~(*)
In(N - 1) - In 1]
ak <
£
.
(4.16)
Thus the bounds (4.15) and (4.16) give complete information about the
generalization ability of the principle of empirical risk minimization for the
optimistic case of the simplest model.
Note that in the optimistic case we have obtained significantly better
bounds for the generalization ability than in the pessimistic case (the bounds
are proportional to 1/£ instead of 1/.Ji).
4.3
BOUNDS FOR THE SIMPLEST MODEL: GENERAL CASE
The bounds for the Simplest Model that combine in one formula both the
bound for the pessimistic case and the bound for the optimistic case and (what
is more important) consider the intermediate cases based on the multiplica-
tive Chernoff inequalities: For £ random independent trials in the Bernoulli
scheme the inequalities
{
p -
Vf
}
{
_£2£ }
P
JJi
> £
< exp -2-
,
{
Vp _ p}
{_£2£ }
P
JJi
> £
< exp -3-
(4.17)
(4.18)
are valid.t
Now consider the finite set of indicator functions Q(z, ad, k = 1,2, ..., N.
Using the inequality (4.17) one can derive (as was done in previous sections)
that the following inequality is valid:
(4.19)
Let us rewrite this inequality in the equivalent form.
t These hounds usually are given in the following equivalent form:
{
y2Pf }
P{lIf«l-y)p}<exp
--2-
,
P{Vf > (1 + y)p} < exp {_y2:'}.

128
4 BOUNDS ON THE RISK FOR INDICATOR lOSS FUNCTIONS
With probability 1 -
T1 simultaneouslyfor all N functions in the set Q(z, ad,
k = 1,2, ... , N, the inequality
(
1 + J1 + 2 Remp(adf )
InN -In T1
(4.20)
holds true.
To obtain these bounds, one has to equate the right-hand side of inequality
(4.19) to some positive value 0 < T1 ::; 1
{
e
2f}
Nexp -2-
= T1
and solve this equation with respect to e
Then using this e one can obtain (4.20) as the solution of the inequality
Since with probability at least 1 -
T1 inequality (4.20) is true for all N
functions in a given set, it is true in particular for the fundion Q(Z, ak( f»
which minimizes the empirical risk functional.
For this function with probability 1 -
T1 the bound
1 + 2 _R_em---,-p_(a_k--,--U-,---))_f)
In N - In T1
(4.21 )
holds true.
To estimate how close the risk R(ak(f)) is to the minimal risk for this set of
functions let us define a lower bound on the risk for the function Q(z, ak(O)
which minimizes the expected risk. To do this we rewrite for this function
the additive Chernoff bound (4.11) in the following equivalent form: With
probability at least 1 -
T1 the inequality
holds true.

4.4 THE BASIC INEQUALITIES: PESSIMISTIC CASE
129
Using this bound and the bound (4.21) we obtain that with probability
1 - 2rt the inequality
is valid.
The inequalities (4.21), (4.22) describe the generalization ability of the
method of empirical risk minimization for the Simplest Model.
Note that when the empirical risk equals zero the bound (4.21) differ
from the bound (4.15) (derived for the optimistic case) only by the factor of
2. When the value of the empirical risk is close to 1/2 and f is rather large,
the bound (4.22) is close to the bound (4.9) derived for the pessimistic case.
The next sections of this chapter are devoted to deriving the bounds on the
generalization ability for an infinite set of indicator functions Q(z, a), a E A.
First we derive the bounds for pessimistic case and then, using them we derive
the bounds for the general case. The bounds for infinite sets of functions have
the same form as the bounds for finite sets of functions. However, instead
of a logarithm of the number of functions in the set we shall use another
measure of the capacity of a set of functions.
4.4
THE BASIC INEQUALITIES: PESSIMISTIC CASE
Now let a set of indicator functions Q(z, a), a E A, contain an infinite number
of elements. As before, our goal is to estimate the rate of uniform conver-
gence of the frequencies Remp(a) to their probabilities R(a).
Let
Zt, ... , Zl
be a random independent observation of size f.
Let
(4.23)
NA(z, ..., Ze) :s 2'
be the number of different separations of the sample (4.23) by a given set
of functions. Assume that NA(zt, ..., Ze) is measurable with respect to the
probability measure F(ZI, ..., ze). Therefore the expectation ENA(zt, ..., Zf)
exists.
In the last section of Chapter 3 we introduced the concept of annealed
entropy of a set of indicator functions on a sample of size f:
(4.24)
Using this concept we formulate the basic theorem of the theory of the
rate of uniform convergence, which we will prove in the next section.

130
4 BOUNDS ON THE RISK FOR INDICATOR LOSS FUNCTIONS
Theorem 4.1. The inequality
p {:~P, IR(a) - R,mp(a)1 > e} < 4exp { ( H;~~(2f) - (e -D}}
(4.25)
holds true.
Corollary. For the existence of nontrivial exponential bounds on uniform con-
vergence,
1·
H~~nU!)
0
1m
=
(--->00
£
is sufficient.
In Chapter 3 we called this equation the second milestone in the learning
theory.
In the next section we prove this theorem; however, before that we rewrite
the inequality (4.25) in the equivalent form.
With probability at least 1 -
71 simultaneously for all functions in the set
Q(z, a), a E A, the inequality
R(a) ::; Remp(a) +
holds true.
In particular this inequality holds for the function Q(z, at), which mini-
mizes the empirical risk functional. Thus with probability at least 1 -
71 the
inequality
H~"'nn(£) -In 71/4
1
------+-
£
£
(4.26)
holds true. As was shown in Section 4.1 for the function Q(z, ao) which
minimizes the expected risk, with probability 1 -
71 inequality
is valid. From these two inequalities we obtain that with probability at least
1 - 271 the inequality
(4.27)
holds true.

4.5 PROOF OF THEOREM 4.1
131
The inequalities (4.26) and (4.27) have the same form as inequalities (4.9)
and (4.12) in the simplest model. The only difference is that here we use a
different concept of capacity, namely, annealed entropy
H~~n(£)' These in-
equalities form one (from the two) pair of basic inequalities in the theory
of the generalization ability of learning machines. The second pair of basic
inequalities will be derived in Section 4.6, but first we prove Theorem 4.1.
4.5
PROOF OF 'rHEOREM 4.1
The proof of Theorem 4.1 is based on the following lemma.
4.5.1
The Basic Lemma
Let us consider a space of random independent observations of size 2£:
Z 2f = ZI, ... , Zf, Zf+ll ... , ZZ(·
For any function in the set Q(z, a), a E A, we determine the frequency
1
f
v(a, ZI) = ""i L Q(z;, a)
;=1
on the first part of a sample
ZI = ZI, ... ,Zr
and determine the frequency
1
Zf
v(a, Zz) =""i L
Q(z;, a)
i=f+l
on the second part of a sample
Zz = Zf+l, "'l Z2f.
Let us denote by ZI (£) and Zz(£) two spaces of half-samples of length f.
Consider the random variables
1
f
1
2i
P'\(a, Z2f) =
"""" Q(z)
"""" Q(z
)
""i LJ
;,a -""i LJ
;,a
\
;=1
i=f+l
1
f
1
2f
pA(ZZi) = sup ""i L Q(Zi, a) - ""i L Q(z;, a) ,
aEA
;=1
;=f+1

132
4 BOUNDS ON THE RISK FOR INDICATOR LOSS FUNCTIONS
and consider the random variable
I
Ii
1T'\a, ZI) =
Q(a) dF(z) - EL Q(Zi, a) ,
i=1
I
Ii
1T'\(Zd = sup
Q(a) dF(z) - EL Q(Zi' a) .
aEA
i=1
We assume that functions 1TA(ZI) and pA(ZU) are measurable with respect
to probability measures defined by F(z). So pA(ZU) and 1TA(ZI) are random
variables.
Basic Lemma. The distribution of the random variable 1TA(ZI) is connected
with the distribution of the random variable pA(ZU) by the inequality
(4.28)
Therefore according to the basic lemma to estimate the rate of conver-
gence to zero of the random variable 1TA(ZI) one can estimate the rate of
convergence to zero of the random variable pA(Z2i).
Below we first prove this lemma, then describe the idea of how to estimate
the rate of convergence of the random variable pA (Z2i), and at the end give
the formal proof of the theorem.
4.5.2
Proof of Basic Lemma
By definition,
Taking into account that the space Z(2£) of samples of size 2£ is the direct
product of Zl (£) and Z2(£) of half samples of size £, by Fubini's theorem we
have
(in the inner integral the first half of the sample is fixed). Denote by Q the
following event in the space ZI (£):

4.5 PROOF OF THEOREM 4.1
133
Reducing the domain of integration we obtain
P {pA(Z2f) > e - ~ } ~ ~ dF(Zd L2(f) (J [pA(Z2f) - e + ~] dF(Z2)'
(4.29)
We now bound the inner integral on the right-hand side of the inequality
which we denote by I. Recall that here the sample Zt is fixed and is such
that
1TA(Zt) > e.
Consequently there exists an a" E A such that
IP(a") - v(a",ZI)1 > e,
where we denote
pea") = IQ(z, a") dF(z).
Then
Now let
v(a", Zd < pea") - e
(the case v(a", ZI) ~ pea") + e is dealt with completely analogously). Then
in order for the condition
Iv(a",Zd - v(a",Z2)1 > e -
~
to be satisfied, it is sufficient that the relation
v(a", Z2) 2 pea") -
~
holds, from which we obtain
I
~ L2 (J [v(a*, Z2) 2 Pea") -
~] dF(Z2) = P {v(a", Z2) ~ pea")}
L
c; [P(a"))" [1 - P(a"))f-" .
k/i?P(a')-I/f
The last sum exceeds
~. Therefore rduming to (4.29) we obtain
P {pA(ZU) > e - } } > ~hdF(Zd = ~P { 1T/\(Zt) > e} .
The lemma is proved.

134
4 BOUNDS ON THE RISK FOR INDICATOR LOSS FUNCTIONS
4.5.3
The Idea 01 Proving Theorem 4.1
Below we give an idea of proving Theorem 4.1. The formal proof will be
given in the next section.
Denote
e, = e - 1/£.
Suppose the sample
ZI, ..., Z21
is split randomly into two half-samples
ZI, "', Zf
and
ZI+I, ..., Z2f·
For any fixed sample of size 2£, any function Q(z, a') and any two randomly
chosen half-samples the classical inequality
{
II
121
}
P
£ ~Q(Zi,a') - £ i~1 Q(Zi, a') > e,
< 2exp{-e;£}
holds true.
To estimate the probability that the largest deviation over a given set of
functions exceeds e, we note the following. For any fixed sample Z2f there ex-
ists only a finite set of distinguishable functions Q(z, a*) E A' = A*(z I, ... , zu)
of cardinality N'\' (ZI ... , Z2f). Therefore we can use the same reasoning that
we used for the Simplest Model
{
1
1
I
1
21
I
}
p
sup £L Q(Zi' a) - £ L Q(Zi, a) > e,lz] ..., Zu
aE.\
;0=1
;0=1+]
{
1
1
f
1
2f
I
}
= P
s.uP. £L Q(Zi, a') - £ L
Q(Zi, a') > e,IZI"" Zu
a ;:.\
1=1
i=(+1
{I
I
f
1
2f
I
}
s a~' P
£t1 Q(ZIl a') - £i~1 Q(Zi, a') > e,IZI""zu
S 2N'\(zl' ... , zu) exp{ -e;£}.
To get the bounds for a random sample of size 2£ it is sufficient to take
expectation with respect to probability measure on the sample space
{
If
1
21
}
P
~~~ £~ Q(z;, a) - £;~I Q(z;, a) > e,
{
1
1
I
1
2f
I}
= EP
s~p £L Q(Zi, a) - £ L Q(Zi, a)1 > e* Zt, ... , Z2I'
afo,II,.
;=]
i=(+1
,II,.
)
{
2}
{(H~~n(2£)
2)}
<EN (ZI,,,,,Z2/exp-ee
=exp
f
-e*
e
.

4.5 PROOF OF THEOREM 4.1
135
Combining this bound with the statement (4.28) of basic lemma proves
the theorem.
4.5.4
Proof of Theorem 4.1
Now we proceed with the formal proof of this theorem. Let us denote by
Z(U) the space of samples of size U and by Z2f = (z\, ...zzd the specific
sample. In view of the inequality (4.28) it is sufficient to bound the quantity
Consider the mapping of the space Z(U) into itself obtaining by a permu-
tation Ti of the elements of sequence Z2f. There are (U)! different permu-
tations of the sample of size 2£.
In view of symmetry of the definition of the measure, the equality
i = 1,2, ..., (2£)!
holds for any integrable function [(Zu). Therefore
(4.30)
Observe that
[
If
1
z1
]
=
(j
sup f L
Q(Zi, a) - f L
Q(Zi, a) - s.
aE,\.
i=\
i=(+1
[
If
lZf
]
= supO
£LQ(Zi,a) - f L
Q(Zi,a) -
B•.
aEA
i=l
i=f+!
Clearly if two functions Q(z, ad and Q(z, az) are nondistinguishable on the
sample Z\, ... , ZZf, then
is true for any permutation Ti . In other words, if two functions are equivalent
with respect to the sample Z\, ..., zu, then deviations in frequencies for these
two functions are the same for all permutations Ti . Therefore, for each class
of equivalent functions one can choose only one function Q(z, a*) which
forms a finite set of functions Q(z, a*) E A* c A such that
supp(TiZ 2f,a) = sup p(TiZu,a*),
aE.\
a'EA'
i = I, ..., (U)!

136
4 BOUNDS ON THE RISK FOR INDICATOR LOSS FUNCTIONS
The number of functions in the set A' is finite and does not exceed
N'\ (Z I, ... , Z2f). Replacing the sup operation by summation, we obtain
sup () [p(Ti Z 2f , u) - eo]
aE.\
=
sup () [p(Ti Z 2f , u') - eo]
a'EA'
~ L () [p(TiZ
2f ,u') - e,].
a'EA'
These relations allow us to bound the integrand in (4.30):
2:;~l' {) [pA(TiZ 2f ) - e,]
(2£)!
",,(2/)!
[ (T Z2f
')
]
L--i=l sUPa'EA' {) Pi, U
- e,
(2£)1
",,(2/)! () [ (T Z2f
')
]
< '"""'
L--i=l
Pi, U
-
e,
-
L..J
(2£)!
.
a'EA'
Note that the summand on the right-hand side of the last inequality is the
ratio of the number of orderings in a sample (of fixed composition) such that
1
f
1
2f
£L Q(Zi, u') - £ L Q(Zi, u') > e.
i=1
i=f+1
to the total number of permutations. It is easy to see that this value is equal
to
where m is the number of elements Zj in the sample Zl, ... , Z2f for which
Q(Zj, u') = 1.
In Section 4.13 we shall obtain the following bound for r
Thus
",,(2/)! () [ (T Z2f
')
]
L
L--i=l
Pi, U
- e,
< 2 L exp {-e;£}
o'EA'
(2£)!
a'EA'
= 2NA(Zl' ''', Z2f) exp {-e;£} .

4.6 BASIC INEQUALITIES: GENERAL CASE
137
Substituting this bound into integral (4.30), we obtain
p {pA(Z2f) > 8.} < 2ENi\Zt, ..., Z2f) exp {-8;£}
2exp { (H~n~(2f) __ 8;) £},
from which, in view of the basic lemma, we obtain
Recalling that we denote 8. =
8 - 1/£ we obtain the desired bound. The
theorem is proved.
4.6
BASIC INEQUALITIES: GENERAL CASE
In this section we discuss the theorem about the rate of relative uniform
convergence of frequencies to their probabilities. (Proof of this theorem is
given in the next section.)
Theorem 4.2. For any £ the inequality
P {
R(a) - Remp(a)
}
4
{(H~~n(2£)
8
2
) o}
sup
ICiT:::\
> 8
<
exp
£
- 4
l:
aE!\
V R(a)
holds true.
(4.31)
Corollary. For the existence of nontrivial exponential bounds on uniform rel-
ative convergence it is sufficient that
(4.32)
Let us rewrite inequality (4.31) in the equivalent form. As before we
equate the right-hand side of inequality (4.31) to a positive value.,., (0 <
.,., ::; 1)
4
{ (
H~n(2f)
8
2
) o}
exp
- -
l:
=.,.,
£
4
and solve this equation with respect to 8 2• The solution

138
4 BOUNDS ON IHE RISK FOR INDICATOR LOSS FUNCTIONS
is used to solve inequality
sup R(a) - Remp(a) < E(l).
aE.\
.jR(a)
-
As a result we obtain that with probability at least 1 -
1] simultaneously for
all functions in the set of indicator functions Q(z, a), a E A, the inequality
R()
R
()
E(l) (1 VI
4Remp(a))
a
~
emp a +
2
+
+
E(l)
is valid.
Since with probability 1 -
1] this inequality holds for all functions of the
set Q(z, a), a E A, it holds in particular for the function Q(z, af) which
minimizes the empirical risk functional. For this function with probability
1 -
1] the bound
E(l) ( J
4Remp(af»)
R(ap) :S Remp ( ap) + -2-
1 +
1 +
E(f)
(4.33)
holds true.
Taking into account that for the function Q(z, ao) which minimizes the
expected risk in the set of functions Q(z, a), a E A, the additive Chernoff
inequality (4.4) holds true. one can assert that with probability at least 1 - 1]
the inequality
is valid.
Note that
(4.34)
From (4.33), the lower bound for R(ao), and (4.34) we deduce that with
probability at least 1 - 21] the inequality
d(af)
R(ap) - R(ao)
V-In TJ
E(l) (1
/1
4Remp(Uf))
<
2£
+
2
+ V +
E(l)
(4.35)
is valid.
Thus. the bounds (4.33) and (4.35) describe the generalization ability of
algorithms that minimize empirical risk: Bound (4.33) evaluates the risk for
the chosen function. and bound (4.35) evaluates how close this risk is to the
smallest possible risk for a given set of functions.

4.7 PROOF OF THEOREM 4.2
139
These two bounds are the basic bounds for the generalization ability of
algorithms that minimize empirical risk in the problem of pattern recognition.
They have exactly the same form as the bound for generalization ability in the
simplest model. The only difference is that here we use a more sophisticated
concept of capacity than in the simplest model.
4.7
PROOF OF THEOREM 4.2
In this section we prove a more general version of Theorem 4.2 to be used
in the next chapter.
Theorem 4.2*. For any 1 < p ~ 2 the inequality
P {
R(a) - Remp(a)
}
4
{(H:nn (2£) _ ~) 112-2!P}
sup
pJD1"::\
> e
<
exp
112 "!
21 "!
{:
aEA
yR(a)
{:L P
+L P
(4.35a)
holds true.
Consider two events constructed from a random and independent sample
of size 2£:
where A a is the event
A a = {z: Q(z, a) = I},
P (A a ) is probability of event A a
P(A a ) = /
Q(z, a) dF(z),
VI (A a ) is the frequency of event A a computed from the first half-sample
zI , ... , Zf of the sampIe zI, ... , Zf, Zf +I , ... , Z2f
and v2(A a ) is the frequency of event A a computed from the second half-

140
4 BOUNDS ON THE RISK FOR INDICATOR LOSS FUNCTIONS
sample Zf+l, ... , Zu
1
2f
v2(A a ) = £ L Q(Zi, a).
i=f+1
Denote
v(A
a
) = vt(A a ) + v2(A a )
2
.
Note that in case £ ~ e-p/(P-I) the assertion of the theorem is trivial (the
right-hand side of inequality exceeds one). Accordingly we shall prove the
theorem as follows: First we show that for £ > e-p/(P-I) the inequality
is valid, and then we bound P(Q2)'
Thus we shall prove the lemma.
Lemma 4.1. For £ > e-p/(P-l) the inequality
P(Qd < 4P(Q2)
is valid.
Proof Assume that event QI has occurred. This means that there exists event
A' such that for the first half-sample the equality
peA') - vl(A') > e~P(A')
is fulfilled. Since VI (A') 2: 0, this implies that
peA') > eP/(P-I).
Assume that for the second half-sample the frequency of event A' exceeds
the probability P (A '):
v2(A') > peA').
Recall now that £ > e-p/(P-I). Under these conditions, event Q2 will definitely
occur.
To show this we bound the quantity
under the conditions
v2(A') - vI(A')
J.L = vtv(A') + 1/2£
VI (A') < peA') - e~peA'),
(4.36)

4.7 PROOF OF THEOREM 4.2
141
v2(A *) > P(A '),
P(A') > eP/(P-l).
For this purpose we find the minimum of the function
x-y
T=~~~
{Ix + Y + c
in the domain 0 < a ~ x ::; 1, 0 < Y ~ b, c> O. We have for p > 1
aT =.!. (p - 1)x + (p + l)y + pc > 0
ax
p
(x + y + c)(P+I)/p
,
aT = _.!. (p + l)x + (p - l)y + pc < O.
By
p
(x + y + c)(P+I)/p
Consequently T attains its minimum in the admissible domain at the bound-
ary points x = a and y = b.
Therefore the quantity JJ. is bounded from below, if in (4.36) one replaces
vj(A') by P(A') - e{!P(A') and v2(A') by P(A·). Thus
ey!2P(A')
JJ. >
.
-
J2P (A') - ey!P(A') + l/f
Furthermore, since P(A') > eP/(P-l) and f > e-p/(P-I) we have that
e{!2P(A')
p.>
-e
{!2P(A') - e(P+l)/p + e(P+1)/p -
.
Thus, if Ql occurs and the conditions v2(A') > P (A') is satisfied, then Q2
occurs as well.
Observe that the second half-sample is chosen independently of the first
one and that the frequency v2(A*) exceeds P(A*) with probability at most
1/4 if fP(A*) > 1. Therefore, provided that QI is fulfilled, the event
occurs with probability exceeding 1/4. Since under condition of the lemma
RP(A') > 1 is valid we have
The lemma is proved.

142
4 BOUNDS ON THE RISK FOR INDICATOR lOSS FUNCTIONS
Lemma 4.2. For any 1 < p :s; 2 and any f > e-p/(P-I) the bound
is valid.
Proof Denote by R A (Z2f) the quantity
then the estimated probability equals
Here the integration is carried out over the space of all possible samples of
size 2f.
Consider now all possible permutations Ti , i = 1,2, ... , (2£)! of the se-
quence ZI, ... , ZZf. For each such permutation the equality
is valid. Therefore the equality
(4.37)
is valid.
Now consider the integrand. Since the sample Zl, ... , Z2f is fixed, instead of
the system of events S one can consider a finite system of events S* which
contains one representative for each one of the equivalence classes. Thus the
equality

4.7 PROOF OF THEOREM 4.2
143
is valid. Furthermore,
The expression in the braces is the probability of greater than £ deviation of
the frequencies in two half-samples for a fixed event A and a given compo-
sition of a complete sample. This probability equals
where m is number of occurrences of event A in a complete sample, and k is
number of occurrences of the event in the first half sample; k runs over the
values
max(O, m - £) S; k S; min(m, £)
k
m-k
----
£
£
~
>£.
"m+ 1
2£
Denote by £* the quantity
im+ 1
_
*
2f
£-£.
Using this notation the constraints become
max(O, m - €) S; k S; min(m, €)
k
m-k
7 - -£- > £*.
(4.38)
In Section 4.13 the following bound on the quantity f under constraints (4.38)
is obtained:
{
(£ + 1)(£*)2£2
}
f<exp
-(m+l)(2f-m+l)
.
Expressing (4.39) in terms of £ we obtain
{
((' + 1)£2('2
(m +1) 21P }
f < exp
- (m + 1)(2£ - m + 1) ~
.
(4.39)

144
4 BOUNDS ON THE RISK FOR INDICATOR lOSS FUNCTIONS
The right-hand side of this inequality reaches its maximum at m = O. Thus
{
Z
}
e
Z-Zlp
r < exp
~ 21+zlpl
.
(4.40)
P(QZ)
Substituting (4.40) into the right-hand side of (4.37) and integrating we have
=
(
NS(ZZI)ex p{_ I:;
PZ-ZIP}dF(ZZI)
}Z(2f)
2
Ip
{ ( H;nn(2l) _ ~) liZ-ZIP}
< exp
lz-zip
21+zlp
t:
.
The lemma is thus proved.
The assertion of the Theorem 4.2* follows from the inequalities obtained
in the Lemma 4.1 and Lemma 4.2.
4.8
MAIN NONCONSTRUCTIVE BOUNDS
Thus, in the previous sections we obtained the basic bounds describing the
generalization ability of learning machines that minimize the empirical risk
functional:
1. With probability 1 - 1] any of the bounds
R(ad ~ Remp(ad + JE(l) +~;
E(l) (
I(
4Remp(al)))
R(al) < Remp(al) + -2-
1 + V 1 +
E(l)
hold true.
2. With probability 1 - 21] any of the bounds
hold true.
In these bounds we denote
(4.41)
(4.42)
(4.43)

4.9 VC DIMENSION
145
These bounds, however, are valid for a specific problem that is defined by
probability measure F(z) since the term £(f) that comes in the inequalities
depends on the annealed entropy H:nn(f) constructed on the basis of the
unknown probability measure F(z).
To make the bounds valid for any probability measure it is sufficient to
use instead of the quantity £(f) the quantity
where the annealed entropy
is replaced by the growth function
CA(f) = sup InNA(z\, ... ,z;).
ZI ...·Z'
Since the growth function does not depend on the probability measure and
is not less than the annealed entropy
H A (f) < C A (f)
ann
-
,
the bounds with £o(f) (instead of £(f)) are valid for any probability measure.
These bounds are nontrivial if
I·
GA(f) - 0
1m
n
-.
i->oo
.[.
Note that the bounds with £o(i) are upper bounds of the bounds with £(f).
Thus, we described the main bounds on the generalization ability of learn-
ing machines. These bounds, however, are nonconstructive since the theory
does not suggest how to evaluate the growth function for a given set of
functions.
Obtaining constructive bounds on the generalization ability of learning
machines is based on the following remarkable property of the growth func-
tion.
4.9
VC DIMENSION
4.9.1
The Structure of the Growth Function
Theorem 4.3. The growth function of a set of indicator functions Q(z, a),
a E A either (a) satisfies the equality
(4.44)

146
4 BOUNDS ON THE RISK FOR INDICATOR lOSS FUNCTIONS
o
h
//
----------
.;;..,.......
h (In (tlh) + I)
(
FIGURE 4.1. The growth function is either linear or bounded by a logarithmic function.
It cannot, for example, behave like the dashed line.
or (b) is bounded by the inequality
where h is the largest integer for which
if f < h
if e > h.
(4.45)
In other words the function GA(l) can be either linear or bounded by
a logarithmic function with coefficient h. (It cannot, for example, be of the
form G(l) = Vi (Fig 4.1).)
This theorem can be formulated in the following equivalent form, where
instead of growth function one considers maximal subsets of a set of some
elements.
Theorem 4.30. Let Z be an (infinite) set ofelements z and let S be some set of
subsets A of the set Z. Denote by N S(z I, .. .Zf) the number of different subsets
(Z I , ... , Zp) n A,
of the set Z I, ... , Z/. Then either
AES,
sup NS(z\, ... ,zp) = 2/
<1 ,... ,</

if £ :s: h,
if £ > h,
4.9 VC DIMENSION
147
or
N S(Zl, ... , Zr) { : 2(f"'h_ Ci ) < (ct.)h
-
L...I-O
f
-
h
where h is the last integer £ for which the equality is valid.
We will prove this theorem in the next section.
Theorem 4.3 asserts that sets of indicator functions can be split into two
different categories:
1. Sets of indicator functions with linear growth functions
2. Sets of indicator functions with logarithmic growth functions
Definition. The capacity of a set of functions with logarithmic bounded
growth function can be characterized by the coefficient h. The coefficient
h is called the VC dimension of a set of indicator functions.t It characterizes
the capacity of a set of functions. When the growth function is linear the VC
dimension is defined to be infinite.
Below we give an equivalent definition of the VC dimension of a set of
indicator functions that stress the constructive method of estimating the VC
dimension.
Definition. The VC dimension of a set of indicator functions Q(z, a), a E A,
is equal to the largest number h of vectors z\, ..., Zf that can be separated into
two different classes in all the 2h possible ways using this set of functions (i.e.,
the VC dimension is the maximum number of vectors that can be shattered
by the set offunctions).
If for any n there exists a set of n vectors that can be shattered by the
functions Q(z, a), a E A, then the VC dimension is equal to infinity.
Therefore to estimate VC dimension of the set of functions Q(Z, a), a E A,
it is sufficient to point out the maximal number h of vectors z;, ...,z; that can
be shattered by this set of functions.
According to Theorem 4.3 if a set of functions Q(z, a), a E A, has finite
VC dimension the growth function can be bounded using inequality (4.45).
In Section 4.11 we shall calculate the VC dimension for some sets of func-
tions. In the remaining part of this section we show that VC dimension plays a
fundamental part in obtaining a constructive distribution-free bound for eval-
uating the risk functional from empirical data (bounds which do not depend
on the unknown probability measure F(z» and in solving the generalized
Glivenko-CantelIi problem.
t Abbreviation for the Vapnik-Chervonenkis dimension.

148
4 BOUNDS ON THE RISK FOR INDICATOR LOSS FUNCTIONS
4.9.2
Constructive Distribution-Free Bounds on Generalization
Ability
First we obtain constructive distribution-free conditions for uniform conver-
gence.
Theorem 4.4. For a set of indicator functions Q(z, a), a E A, with finite VC
dimension h the following two inequalities hold true:
1. The inequality estimating the rate of two-sided uniform convergence:
p h~~ IQ(z, a) dF(z) - ~t Q(Zi, a) > e}
4
{(h(l + In (2£lh)) _ 2) £}
<
exp
£
e.,
(4.46)
where e' = (e - 1/£), and
2. The inequality estimating the rate of relative uniform convergence:
1
f
IQ(z,a)dF(z) - f 2:Q(zi,a)
p
sup
i=l
> e
aEA
JI Q(z, a) dF(z)
< 4exp { (h(l +In/2£lh)) _ :2) £}.
(4.47)
To prove this theorem it is sufficient to note that
and then to use this inequality in the bounds obtained in Theorem 4.1 and
Theorem 4.2.
The bounds (4.46), (4.47) provide constructive distribution-free bounds on
the generalization ability of a learning machine that minimizes the empirical
risk functional.
With probability 1 -
TJ the risk for the function Q(z, at) which minimizes
the empirical risk functional satisfies the inequality
(4.48)

4.9 VC DIMENSION
149
where
E(f) = 4h(ln2f/h + 1) -In 71/4 .
f
With probability 1 - 271 the difference between the attained risk and the
minimal one satisfies the inequality
4.9.3
Solution of Generalized Glivenko-Cantelli Problem
The result obtained in Theorem 4.4 (inequality (4.46» can be also formulated
in the terms of the Generalized Glivenko-Cantelli problem: The finiteness
of the VC dimension of a set of functions Q(z, a), a E A (set of events A a =
{z : Q(z, a) = 1}), is sufficient for existence of distribution-free exponential
bounds on the rate of uniform convergence.
The next theorem reinforces this result: It shows that finiteness of the VC
dimension provides not only sufficient conditions for uniform convergence,
but necessary conditions as well. Therefore finiteness of VC dimension of a
set of functions gives the necessary and sufficient conditions for solution of
the Generalized Glivenko-Cantelli problem.
Theorem 4.5. For existence of uniform convergence of frequencies to their
probabilities over a set of events All' = {z : Q(z, a) = 1}, a E A, with respect
to any probability measure F(z) it is necessary and sufficient that the set of
functions Q(z, a), a E A, has a finite VC dimension.
If VC dimension of the set of functions Q(z, a), a E A, is finite, then the
inequality (4.46) holds true.
Proof The proof of sufficiency of the conditions of this theorem follows from
Theorem 4.4.
To prove the necessity of this condition, we show that any single set of
points in a space Z(f) is measurable and a given set of functions has infinite
VC dimension-that is, if for any f the equality
sup NA(Zl' ... , zp) = 2£
z, ,..,z,
(4.49)
holds true-then for any f and for any e a probability measure F(z) can be
chosen such that with probability one the inequality
/
1
f
~~~
Q(z, a) dF(z) - i ~ Q(z;, a) > 1 -
E:
is valid.

150
4 BOUNDS ON THE RISK FOR INDICATOR LOSS FUNCTIONS
Indeed, let us choose an integer n > fl e. Since for any f the equality
(4.49) is valid. it is possible to choose n points
zn = Zj, ... , Zn,
which can be shattered by functions in the set Q(z, a), a E A.
Now let us specify the probability measure: The distribution is concen-
trated on these points, and all points have equal probability P(zd = lin.
Let us consider the random sample Zl = Zj, ... , Zt of size f. Denote by Z"
the subset of zn that contains the points of the set zn not included in the set
Zf. It is clear that the number of these points is not less than n - t. Since
there exists a function Q(z, a") that takes the value one on the vectors from
the subset Z" and the value zero on the vectors from the subset Zf. This
means that
and at the same time
/
n-f
Q(z, a") dF(z) ~ -n- > 1 - e.
Therefore with probability one
~~~II Q(z, u') dF(z) - ~E
Q(Zi, U')I > 1 - e.
The theorem is thus proved.
4.10
PROOF OF THEOREM 4.3
The proof of Theorem 4.3 is based on the following three lemmas.
Lemma 4.3. If for some sequence Zj, .", Zt and some n
n-j
A
~
.
N
(Zl, ... , Zt) > L...J C;,
;=()
then there exists a subsequence zj,. '"
Z~ (of this sequence) of length n such
that

4.10 PROOF OF THEOREM 4.3
151
Proof Denote
n-IL C: = <1>(n, f)
i=O
(here and later we denote q = 0 for i > f). For this functions, as it is easy
to verify, the relations
<1>(1, f) = 1,
if f
~ n + 1,
<1>(n, f) = <1>(n, f - 1) + <1>(n - 1, f - 1),
if n ~ 2
(4.50)
are valid. These relations uniquely determine the function <1>(n, f) for n > 0
and f > O.
We shall prove the lemma by induction on f and n.
1. For n = 1 and any f
~ 1 the assertion of the lemma is obvious. Indeed,
for this case
NA(zl, ... ,ze) > 1
implies that an element z* of the sequence exists such that for some
function Q(z, ad we have
while for some other function Q(z, a2) we have
Consequently,
2. For f < n assertion of this lemma is valid because the premise is false.
Indeed, in this case the premise is
which is impossible because
3. Finally, assume that the lemma is valid for n ~ no for all f. Consider
the case n = no + 1. We show that the lemma is valid in this case also
for all f.
We fix n = no + 1 and carry out the induction on f. As was pointed out,
for f < no + 1 the lemma is valid. We assume that it is valid for f
~ fo and

152
4 BOUNDS ON THE RISK FOR INDICATOR LOSS FUNCTIONS
show that it is valid for £ = £0 + 1. Indeed, let the condition of the lemma
N/\(ZI, ""z(o,zfo+d > <P(no + 1,£0 + 1)
be satisfied for some sequence ZI, ..., Zfo' Zfo+l' The lemma will be proved if
we will find a subsequence of length no+ I, say ZI, ""Zno+I, such that
N /\(
) - 2no+1
Z I , ... , Zno+1
-
•
Consider subsequence ZI, ... , Zfo' Two cases are possible:
Case 1:
Case 2:
N/\(ZI, ..., Zfo) ~ <P(no + 1, (0)'
In case 1, in view of the induction assumption, there exists a subsequence
of length no + 1 such that
N A(
) - 2no+1
Z1, ... , Zno+ I
-
•
This proves the lemma in the case 1.
In case 2 we distinguish two types of subsequences of the sequence ZI, ... , Zfo'
We assign subsequences Zi l , ... , Zir to the first type if in the set of functions
Q(z, a), a E A, there exists both a function Q(z, a*), satisfying the conditions
Q(Zfo+l, a*) = 1,
Q(Zik, a*) = 1,
k = 1,2,
,r,
Q(Zj, a*) = 0,
if zJ ~ {Zit'
,zd,
and a function Q(Z, aU), satisfying the conditions
Q(Zfo+l, aU) = 0,
Q(Zik,a
U )=I,
k=I,2, ...,r,
Q(Zj, aU = 0,
if Zj E,i {Ziw'" zd.
We assign subsequence Zil , ... , Zir to the second type, if either in the set of
functions Q(Z,a),a E A, there exists a function Q(z,a*), satisfying the con-
ditions
Q(Zfo+l' a*) = 1,
Q(Zik,a*) = 1,
k=1,2,
,r
Q(Zj, a*) =°
if Zj E,i{Zi l ,
, zd,
or there exists a function Q(z, aU), satisfying the conditions
Q(Zlo+l, aU) = 0,
Q(Zik, aU) = 1,
k = 1,2, ...,r,
Q(Zj, aU) = 0,
if Zj E!{Zil' "', zd
(but not both).

4.10 PROOF OF THEOREM 4.3
153
Denote the number of subsequences of the first type by K 1 and number
of subsequences of the second type by Kz. It is easy to see that
and hence
(4.51)
Denote by Q(z,a),a E A', the subset of set of functions Q(z,a),a E A, that
on Zl, ... , Zf+l induces the subsequences of the first type. If
then, in view of induction hypothesis, there exists a subsequence Zil , ... , Zino
such that
However, in this case
N A' (
) - 2no+1
Zil, .. ·,Zino,Zio+1
-
for sequence
Zi1 ,.·" Zino ' Zio+ I, since this subsequence belongs to the sub-
sequence of the first type.
If, however,
A'
K 1 = N
(ZI, ... , Zio) :::; <I>(nO, £0)
we obtain in view of (4.51) and (4.52)
NA(ZI, ... , zlo+d :::; <I>(nO + 1, £0) + <I>(nO, £0),
(4.52)
which, by virtue of the properties (4.50) of the function <I>(n, f), implies that
This contradicts the condition of the lemma.
The lemma is proved.
Lemma 4.4. If for some n
sup
NA(Zl, ...zn+d =I- 2
n +l ,
Zl,···,ln+l
then for all £ > n the inequality
sup NA(ZI, ,,,Zi) ~ <I>(n + 1, £)
ll,· .. ,l,
holds true.

154
4 BOUNDS ON THE RISK FOR INDICATOR LOSS FUNCTIONS
Proof Let SUPZI .... ,Z/ NA(Zi, ...Zf) not be identically equal to 2f , and let n + 1
be the first value of esuch that
Then for any sample of size e, larger than n, the equality
is valid. Indeed, otherwise, in view of Lemma 4.3, one could find the subse-
quence Zi l , .•. , Zi"'1 such that
which is impossible because by assumption, SUPZ1,... ,Z".1 NA(ZI' ..., zn+d ¥- 2n +i .
The lemma is proved.
Lemma 4.5. For e> n the following bound is true:
en- 1
<P(n,€) < 1.5 (n -I)! < (~)n-i
n-l
(4.53)
Proof Since the relation (4.50) is fulfilled for <P(n, e), to prove (4.53) it is
sufficient to verify that for e> n the inequality
fn-l
fn
(f+lt
--- + -
< -----'-
(n - I)!
n! -
n!
is valid and to verify (4.54) on the boundary (i.e., n = 1, f = n + 1).
The inequality (4.54) is clearly equivalent to inequality
(4.54)
whose validity follows from Newton's binomial expansion.
It thus remains to verify (4.54) on the boundary. For n = 1 the verification
is direct. Next we shall verify the bound for small values of nand f:
e= n + 1
<Il(n, e)
en-I
1.5 (n - I)!
2
1
1.5
3
4
4.5
4
11
12
5
26
31.25
6
57
81

4.11 EXAMPLE OF THE VC DIMENSION OF THE DIFFERENT SETS OF FUNCTIONS
155
To check (4.54) for n > 6 we utilize Stirling's form ula for an upper bound
on £!
£! < J27T£e exp{£ - (12£)-1},
where for £ = n + 1 we obtain
£n-l
(£_1)£i'-1
£-1
{
1}
""""(n---1"""-)! =
£!
?: J27TU exp
-£ + -12-£
and for £ > 6 we have
£(n-l)
1
>0.8
~e-f.
(n - 1)! -
y27T£
On the other hand, <I>(n, £) S; 2/ always. Therefore it is sufficient to verify
that for £ ?: 6
Actually it is sufficient to verify the inequality for f = 6 (which is carried out
directly) since as £ increases the right-hand side of inequality grows faster
than the left-hand side.
The lemma is proved.
The assertions of Lemmas 4.4 and 4.5 imply the validity of Theorem 4.3.
4.11
EXAMPLE OF THE VC DIMENSION OF 'rHE DIFFERENT SETS OF
FUNCTIONS
In this section we give several examples of estimating the VC dimension of
different sets of functions.
According to Theorem 4.3 if the VC dimension of a set of indicator func-
tions is finite, the inequality
h
A
~
.
maxN (ZI, ...,Z/)S;LJq
Zt ,.•.,z,
i=O
holds true, where h is the maximal number £ = h such that
max N A(ZI, ..., Zh) = 2h.
Zl"",Zh
(4.55)
First of all we give a simple example for which (4.55) turns out an equality.
This implies that the general result (4.55) cannot be improved.

156
4 BOUNDS ON THE RISK FOR INDICATOR lOSS FUNCTIONS
Example 1 (The obtained bound of the growth function is tight). Let Z be an
arbitrary set and let S be a set of subsets of Z, such that every A E S contains
less than h elements. Consider a set of indicator functions Q(z, a), a E A,
determined on S such that for any subset A of Z the function Q(z, a(A)) is
one on the elements of A and is zero on the elements Z - A. For this set of
functions
and
max NA(Zl' ... ,Zf) = 2h
ZI, ..·,Z,
if e ~ h
if e> h.
Example 2 (The VC dimension of a set of functions linear in their parameters
is equal to the number of parameters). Consider a set of indicator functions
linear in their parameters:
a = (a!, ... ,an ), dE (-00,00).
(4.56)
We shall show that the VC dimension of this set of functions equals n, the
number of free parameters (we assume that cPk(Z), k = 1, ..., n, is a set of
linearly independent functions).
To prove this we denote uk = cPk(z), k = 1,2, ...,n, and consider the set
of linear indicator functions leu, a) passing through the origin in the space
V = (u1, ••. , Un)
I(a,a) ~ 0 (~akak) .
(4.57)
It is clear that the maximal number of different separations of evectors from
Z using the set of functions (4.56) is equal to the maximal number of different
separations of evectors from V using the set of functions (4.57).
Thus let us estimate a number of different separations ofevectors from V
using the hyperplanes passing through the origin in the n-dimensional space
U. It is easy to see that the following n vectors from Rn
(1,0, ... ,0), (0, 1,0, ... ,0)..., (0, ...,0,1)
can be shattered by hyperplanes
(here we denote by (u * a) the inner product of two vectors in Rn).
Let us show that there are no n + 1 vectors in Rn that can be shattered by
hyperplanes passing through the origin. Suppose the contary: Let Ul, ... , Un+l

4.11 EXAMPLE OF THE VC DIMENSION OF THE DIFFERENT SETS OF FUNCTIONS
157
be vectors that can be shattered. This implies that there exist 2n+\ vectors
ai E Rn, i = 1, ... ,2n+\ which form a (n xl) x 2n+\ matrix of inner products
Zi.j = (Ui *aj ), i = 1, ... , (n + 1), j = 1, ... , 2n+\
Zl,1
A=
Z(n+l),l
The elements Zi,j of this matrix are such that 2n+\ columns of the matrix have
all 2n+1 possible combination of signs
sign(A) =
+
+
+
+
+
Therefore, row-vectors Zi =
(Zi,\, •.. , Zi,2M+1, i = 1, ... , (n + 1), of A-matrix are
linearly independent since there are no constants C\, ..• , Cn+\ such that
n+l
LCjZj = 0
i=1
because for any constants Cl, ..• , Cn+l there is a column with the same signs.
This implies that n + 1 vectors Ul, ... , Un+1 in Rn are linearly independent and
this contradiction proves that there are no n + 1 vectors in Rn that can be
shattered by hyperplanes passing through the origin. Therefore the maximum
number of vactors that can be shattered by hyperplanes passing through the
origins is n and consequently the VC dimension of this set of functions is n.
Now we show that the bound on the growth function for a set of linear
hyperplanes that follows from Theorem 4.3 is rather accurate. To show this,
let us estimate the value of maxu\,o.o,ul N/\(UI, ... ,ud.
To do this, note that to any vector U = (u;, ...,uZ) of the space V there
corresponds a hyperplane
in the space A = (aI, ... , an). And vice versa to any vector a = (a;, ... ,aZ) of
the space A corresponds hyperplane
in the space U.

158
4 BOUNDS ON THE RISK FOR INDICATOR lOSS FUNCTIONS
Thus to f vectors Ui, i = 1, ..,f in the space U there correspond f hyper-
planes passing through the origin in the space A.
Our assertion is the following: The maximal number of different separa-
tions of f vectors by hyperplanes passing through origin in the space U is
equal to the number of different components into which the f hyperplanes
separate the n-dimensional space A (see Fig. 4.2).
Indeed, let f be a vector in A corresponding to some hyperplane in U.
If one continuously rotates this hyperplane in the space U such that separa-
tion of ZI, ... , Zf remains in fact, the corresponding trajectory of the vector f
belongs to the same component of the space A.
We shall estimate the number of different components into which f hy-
perplanes can divide the n-dimensional space. Let us denote by <1>(n, f) the
maximal number of components into which f hyperplanes can divide the n-
dimensional space. Let us determine a recurrent procedure for estimating the
number of components.
It is clear that in the one-dimensional case for a hyperplane passing through
the origin we have
<1>(1, f) = 2.
One hyperplane divides any space into two components
<1>(n, 1) = 2.
Now, leU - 1 hyperplanes f l , ... , ff-l divide n-dimensional space into <1>(n, R-
1) components. Let us add one new hyperplane ft.
If this hyperplane passes through one of the "old" components, then it
divides this component into two parts. Otherwise, the old component is
preserved.
_~Ir-+--\-f 2
.X2
--~'--------+-f 3
f 4
---+-------+--- X2
f 5
FIGURE 4,2. To any vector uJ, j = 1, ..,£ in the space U there correspond hyperplanes
passing through the origin in the space A.

4.11 EXAMPLE OF THE VC DIMENSION OF THE DIFFERENT SETS OF FUNCTIONS
159
Thus, if one added a new hyperplane f, the number of components can be
increased by the quantity equal to the number of components which are split
by this hyperplane. Conversely, any component Kj makes a trace Kjnf, on
f(. The number of these traces is equal to the number of parts in which f - 1
hyperplanes f 1, ... , ff -1 divide the hyperplane f(.
Since the dimensionality of f, is equal to n - 1 the number of traces does
not exceed <P(n - 1, f - 1). Thus we obtain the following recurrent equation:
<P(n, f) = <P(n, f - 1) + <P(n - 1, f - 1),
<P(n, 1) = 2,
<P(1, f) = 2.
The solution of Eq. (4.58) is
(4.58)
{
2'
<P(n, f) =
2 ,,~-1 Cj
61=0
£-1
if n > f,
if n ~ e.
(4.59)
Note that according to the exact formula (4.59) the growth function for a
set of linear functions in the region e> n is equal to
The bound for the growth function for region e> n obtained in Theorem 4.3
is equal to
OA (e) S In (toc;) < n (In ~ + 1)
One can see how close the bound is to the exact result in this case.
The next two examples show that VC dimension of a set of indicator
functions that have nonlinear dependence on parameters can differ from the
number of parameters.
Example 3: The VC dimension of the set of indicator functions nonlinear in
parameters can be less than the number of parameters. Let us consider the
following set of one-dimensional functions
This set of functions is a set of monotonic nondecreasing indicator functions.
It is clear that using a set of monotonic nondecreasing indicator functions on

160
4 BOUNDS ON THE RISK FOR INDICATOR LOSS FUNCTIONS
the line one can shatter only one point. This means that VC dimension of the
set of functions considered here is independent of the number of parameters
n.
Example 4: The VC dimension of the set nonlinear in parameters indicator
functions can exceed the number of parameters. Lastly consider the following
set of one-dimensional indicator functions
Q(z,a) = () (sinaz),
Z E (0, 21T),
a E (0,00)
defined on the interval (0, 21T).
We show that the VC dimension of this set of functions equals to infinity
if we establish that for any e and any binary sequence
there exist e points Zl, ... , Zf such that the system of equation
() {sin azd = 8i ,
i = 1,2, ...,e
(4.60)
has a solution in a. Let us consider the points Zi = 21T1O-' , i = 1,2, ...,e. It
is easy to check that for these points the value
gives a solution of the system of equations (4.60).
Thus in general the number of parameters does not determine the VC
dimension of a set of functions. But it is the VC dimension rather than the
number of parameters of the set of functions that defines the generalization
ability of a learning machine. This fact will play an extremely important
role in constructing learning algorithms later. Chapter 10 introduces learning
machines that realize functions with low VC dimension and have billions of
parameters.
4.12
REMARKS ABOUT THE BOUNDS ON THE GENERALIZATION
ABILITY OF LEARNING MACHINES
Thus in this chapter we obtained the bounds on the generalization ability of
learning machines that minimize the empirical risk functional. These bounds
can be described as follows:

4.12 BOUNDS ON THE GENERALIZATION ABILITY OF LEARNING MACHINES
161
With probability at least 1 -
'YJ the inequality
£(£) ( J
Remp(af ))
R(af) :s: Remp(ae) + -2-
1 +
1 +
£(£)
holds true.
With probability at least 1 - 2'YJ the inequality
(4.61)
(4.62)
holds true.
Different expressions for £(£) define different types of bounds. The ex-
pressIon
£(£) = 4 H~nn(2£)£-In 'YJ/4,
where H~n(£) is the annealed entropy, defines tight distribution dependent
bounds that are valid for a specific learning machine (a specific set of func-
tions) and a specific problem (a specific probability measure).
One can exclude information about the probability measure by using the
expressIOn
£(£) = 4 G
A(2£) ;
In 'YJ/4 ,
where GA(£) is the growth function of a set of functions Q(z, a), a E A.
Bounds (4.61), (4.62) with this expression for £(£) are valid for a given learn-
ing machine and any problem (any probability measure).
These bounds are to be thought conceptual rather than constructive since
the theory does not give a regular way for estimating the annealed entropy or
growth function. Therefore we use the upper bound of the growth function
that is based on the VC dimension of the set of functions. (Theorem 4.3
points out a constructive way for evaluating the VC dimension of a set of
functions.) The constructive bounds are based on the following expression
for £(£):
£(£) = 4h(ln(2£/h) ~ 1) -In 'YJ/4.
Let us denote
£
r= -'
h'
then the bound for the £ (£) is

162
4 BOUNDS ON THE RISK FOR INDICATOR LOSS FUNCTIONS
This expression shows that the generalization ability of a learning machine
depends on the ratio of the number of observations to the VC dimension of
the set of functions (for reasonable TJ the second term in the expression is
negligibly small compared to the first one).
An important goal of the theory is to find a more accurate constructive
bound than the one described. According to the Key theorem proved in
Chapter 3, the uniform convergence forms the necessary and sufficient condi-
tions for consistency of the ERM method. Therefore to obtain more accurate
bounds on the rate of the learning processes based on the ERM method, one
has to obtain a more accurate bound on the rate of uniform convergence.
To construct any bound, one has to use some capacity concept. From the
conceptual point of view the accuracy of the obtained bound depends on
which type of capacity concept is used. We obtained the best bound using
the annealed entropy concept. However, the construction of this concept uses
the unknown distribution function F(z).
The bounds obtained on the basis of the growth function concept or the
VC dimension concept are another extreme case: They ignore any a priori
information about unknown distribution function F(z).
It is very important to find the way how to obtain constructive bounds
using general information about the unknown distribution function F(z). The
nonconstructive bound can be obtained easily.
Indeed, suppose one has the information about the unknown probability
measure F(z) E P, where P is some set of densities. Then one can immedi-
ately suggest tight nonconstructive distribution-dependent bounds based on
the following generalized growth function concept:
Mt(f) =
sup E InN'''(z\, ..., Zf).
F(z )E"P
Since
H~~n(R) S; Mt(f) S; G'''(f)
the bounds (4.61), (4.62) with
£(f) = 4Mt(2£) - In TJ/4
f
are valid. These bounds are not hased on the knowledge of the specific dis-
tribution function F(z); however, they take into account a priori information
about the set that includes this function. Therefore these nonconstructive
bounds are tighter than nonconstructive bounds based on the growth func-
tion.
To develop constructive bounds, one has to find a constructive bound for
the generalized growth function that is better than the one based on the VC
dimension. The main problem here is to find some set of probability measures
P for which one can obtain a constructive bound on the Generalized Growth

4.13 BOUND ON DEVIATION OF FREQUENCIES IN TWO HALF-SAMPLES
163
function just as constructive distribution-free bounds were obtained using the
VC dimension.
For the theory of distribution free bounds only one question remains:
How tight are the obtained bounds?
The Appendix to this chapter tries to answer this question. We give lower
hounds for the generalization ability of algorithms which minimize empirical
risk. These lower bounds are reasonably close to the upper bounds derived
in this chapter. This will ensure that the theory of bounds constructed in this
chapter is rather tight.
4.13
BOUND ON DEVIATION OF FREQUENCIES IN TWO
HALF-SAMPLES
In proving the basic inequalities (Theorem 4.1, and Theorem 4.2) we use the
bound for the deviation of frequencies in two half-samples. In this section
we show how this bound is obtained.
Our goal is to estimate the value
ck C f - k
r = '"'
m
2f-m
L...J
C f
1
k
2f
where the summation is conducted over k so that
I
k
m - kl
f - -f.- > e,
max(O,m - e) ~ k ~ min(m,e)
max(O, m - e) ~ k ~ min(m, e).
and where f and m < 2f are arbitrary positive integers.
The last inequality is equivalent to inequality
I
k _ m I> ee
2
2 '
We decompose r into two summands,
where we denote
ck C f - k
r = '"'
m
2f -m
1
L...J
cf
'
k
2f
ck Cf - k
r = '"'
m
2f-m
2
L...J
cf
'
k
2f
ee
m
where k> 2 + 2'
ee
m
where
k < -
- -.
2
2

164
4 BOUNDS ON THE RISK FOR INDICATOR LOSS FUNCTIONS
We introduce the following notations
ck C f - k
(k) =
m
2f-m
p
C f
'
2£
k
_ p(k + 1) _
(m - k)(£ - k)
q( ) -
p(k)
-
(k + 1)(1: + k + 1 - m)'
where
max(O, m - £) ~ k ~ min(m, £).
Furthermore, we denote
(4.63)
(4.64)
s = min(m, e),
T = max(O, m - e);
s
d(k) = LP(i).
i=k
Clearly, the relation
s
s-I
s-I
d(k + 1) = L
p(i) = Lp(i + 1) = Lp(i)q(i)
(4.65)
i=k+1
i=k
i=k
is valid. Furthermore, it follows from (4.64) that for i < j we have q(i) > q(j);
that is, q(i) is monotonically decreasing. Therefore the inequality
s-1
s
d(k + 1) = Lp(i)q(i) < q(k) Lp(i)
i~k
i~k
follows from (4.65). By definition of d(k) we have
d(k + 1) < q(k)d(k).
Applying this relation successively, we obtain the following for arbitrary k
and j such that T ~ j < k ~ s - 1:
k-I
d(k) < d(j)II q(i).
i=j

4.13 BOUND ON DEVIATION OF FREQUENCIES IN TWO HALF-5AMPLES
165
Since d(j) ~ 1 we have
k-I
d(k) < II q(i),
i=j
where j is an arbitrary integer smaller than k.
We denote
m-l
t=k--2-·
(4.66)
Then
m+ 1
---t
q(t) = --=::.2--,--_
m+ 1
-2-+ t
(
m -1)
£- -2-
-t
(
m -1)
1--2-
+t
Moreover, as long as T < k < s, the inequality
. (m +1 m-1)
ItI< mm -2-'£ - -2-
is clearly valid.
To approximate q(k) we analyze the function
a-t b-t
F(t)--·-
-
a+t
b+t'
assuming that a and b are both positive.
For ItI < min(a, b) we obtain
In F(t) = In(a -- t) - In(a + t) + In(b - t) - In(b + t).
Furthermore, we have
InF(O) = 0,
d
[2a
2b]
-d (In F(t)) = -
2
2 + b2
2·
t
a -t
-t
This implies that for ItI< min(a, b) the inequality
d
[1
1]
dt (lnF(t)) ~ -2
~ + b

166
4 BOUNDS ON THE RISK FOR INDICATOR lOSS FUNCTIONS
is valid. Consequently, for ItI < min(a, b) and t ~ 0 the inequality
InF(t)) ~ -2 [~+ *J t
is valid.
Returning to q(t) we obtain for t ~ 0
[
2
2
J
f+1
In
t < -2 -- +
t = -8
t.
q()-
m+1
2e-m+1
(m+1)(2f-m+1)
We now bound
In (n7:/q(i))
assuming that (m - 1)/2 ~ j
~ k - 1:
(
k_l
)
k-I
In Qq(i)
= t1 ln q(i)
k-l (
)
-8(f+1)
.
m-1
~ (m + 1)(2f - m + 1)I: 1--2-
.
/=/
Returning to (4.66), we obtain
k-[
(
)
-8(f + 1)
.
m - 1
Ind(k) < (m+ 1)(2f -m+ 1)I: 1--2-
,
1=/
where j is an arbitrary number smaller than k. Therefore for k > (m - 1)12
one can set j = (m - 1)/2 for m odd and j = ml2 for m even, obtaining a
stronger bound. Next, summing the arithmetic progression, we obtain the
inequality
-4(f + 1)
(
m)2
Ind(k) < (m + 1)(2f _ m + 1)
k - 2
for even m and obtain the inequality
Ind(k) <
-4(f + 1)
(k _ m - 1) (k _ m - 1_1)
(m+l)(2P-m+1)
2
2
for odd m.
Finally f[ is d(k) for the first integer k such that
m
e2f
k-->-
2
2'

4.13 BOUND ON DEVIATION OF FREQUENCIES IN TWO HALF-SAMPLES
167
from which we obtain
£ + 1
2 2
In [1 < - (m + 1)(2£ _ m + 1) e £ .
(4.67)
The right-hand side of (4.67) attains its maximum at m = £I, and consequently
(4.68)
In the same manner one can bound [2, since the distribution (4.63)
IS
symmetric with respect to the point k = m12. Since [1 = [2 we obtain
(4.69)


APPENDIX TO CHAPTER 4:
LOWER BOUNDS ON THE
RISK OF THE ERM PRINCIPLE
Until now we have accepted the empirical risk minimization principle without
any discussion. We found the bounds describing the generalization ability of
this principle for sets of indicator functions.
Now we would like to discuss the following two questions:
1. Is the principle of empirical risk minimization a good one? Can it be
considered as optimal in some sense?
2. How tight are the bounds obtained for the class of learning machines
minimizing the empirical risk?
To answer these questions we have to determine:
1. What general strategy of statistical inference reflects the method of
empirical risk minimization?
2. How close are the upper hounds ohtained for the ERM principle to the
lower bounds?
This appendix tries to answer these questions by showing that the ERM prin-
ciple reflects the philosophy of the so-called minimax loss strategy (not to be
confused with minimax strategy). Despite the fact that the ERM method
does not guarantee the minimum of the maximum possible losses, its upper
bounds are relatively close to the lower bound on the minimax loss. That is.
the losses for the ERM methods are close to the minimax losses.
A4.1
TWO STRATEGIES IN STATISTICAL INFERENCE
Consider the situation where we would like to choose an algorithm A E A
for solving a set of problems 1T E n.
169

170
A4 LOWER BOUNDS ON THE RISK OF THE ERM PRINCIPLE
Suppose that for any algorithm A and for any problem 7T we can define the
value T( 7T, A) which characterizes the quality of the solution of the problem
7T by the algorithm A (let smaller values T (7T, A) means better quality).
The question is how to choose one algorithm for solving sets of problems, if
for any problem 7T there exists its own optimal algorithm A 7T which minimizes
T(7T,A).
For this situation the theory of statistical inference suggests two strategies,
namely, the Bayesian strategy and the Minimax loss strategy.
Let the smallest loss for the problem
7T be To(7T). Consider the loss
!llnctionalt
L(7T,A) = T(7T,A) - TO(7T),
which evaluates the loss in solving the problem 17" if instead of the best possi-
ble solution for this problem one obtains the solution provided by algorithm
A.
The Bayesian strategy suggests that we choose the algorithm A B , which
minimizes the expectation of loss over all problems n. This means that one
should be given an a priori distribution P (7T) on a set of problems n, which
allows one to construct the expectation
LB(A) = I L(7T,A)dP(17").
(A4.1)
The minimum of functional (A4.l) determines the Bayesian algorithm A B .
The minimax loss strategy suggests a more cautious approach. According
to the minimax loss strategy, choose the algorithm AM, which minimizes the
losses for the worst (for this algorithm) problem in the set n. In other words,
choose the algorithm AM, which minimizes the functionalt
L M (A) = sup L( 7T, A).
7TEIl
(A4.2)
Denote the algorithm that minimizes (A4.2) by AM' It is easy to verify
that for any distribution function P (17") determining the Bayesian strategy the
j Note that in Chapter I we introduced the concept of loss functions Q( z. a), a E A. which we
used to construct risk functional R(a) = JQ(z,a)dF(z). Here we consider a new concept the
loss functional. which is used to analyze quality of various statistical strategies for solution of a
set of prohlems [defined by various F(z )].
j Note that the minimax loss strategy differs from the minimax strategy, which suggests that we
choose by algorithm A. minimizing the functional
LM= sup T(7T.A).
1TE II

A4.2 MINIMAX LOSS STRATEGY FOR LEARNING PROBLEMS
171
inequality
(A4.3)
holds true.t
Let A B be an algorithm that minimizes (A4.1). Then
=
inf LB(A) = inf !L(1T,A)dP(7T)
AEA
AEA
:::; !L(1T,AM)dP(1T):::; !SUPL(1T,AM)dP(1T)
1TEn
= sup L(1T,AM) = LM(AM).
1TEn
This Appendix shows that the empirical risk minimization principle re-
sults in algorithms A emp , which are close to the optimal ones in the sense of
minimax loss strategy.
To prove this we note that
Below we first find upper bounds of the maximal loss for the empirical risk
minimization method. Then we derive lower bounds for the minimax loss.
These two bounds turn out be reasonably close.
A4.2
MINIMAX LOSS S'fRATEGY FOR LEARNING PROBLEMS
This book considers the learning problem as a problem of minimizing the
risk functional
R(7T,a) =! Q(z,a)dF1T(z)
on the basis of empirical data
In this setting the specific problem 7T is determined by an unknown distribu-
tion function F1T (z) which defines the risk functional.
t It is important to note that inequality (A4.3) does not mean that for solving specific prohlems
the Bayesian strategy is better than the minimax strategy. The quantity on the left-hand side of
inequality (A4.3) gives the best average loss, while the quantity on the right-hand side (A4.J)
gives the hest guaranteed loss.

172
A4 LOWER BOUNDS ON THE RISK OF THE ERM PRINCIPLE
Suppose that we are given an algorithm A that in order to mInImIZe
risk R(1T, a) using the data chooses the function described by the param-
eter aA (z I, ... , z,). This notation indicates that given the data algorithm A
selects function Q(Z,UA(ZI, ...,z,».
The value of risk for the chosen function is
Let the expectation
define the quality of solution of the problem 1T by the algorithm A using data
of size f.
Consider the following loss functional:
L(1T, A) = T( 1T, A) - T( 1T).
Our goal is:
1. First to obtain the upper bound for the functional
L M (Aemp) = sup L( 1T, Aemp )
1TEn
(A4.4)
2. Then to obtain a lower bound on minimax losses for the set of problems
n.
Since
L M(AM) ~ LM(Aemp)
if one finds that the lower bound for LM(AM) is close to the upper bound
for L M (Aemp), then one can conclude that the ERM method provides losses
that are close to the minimax loss for a given set of problems. In any case,
the lower bounds are obtained for the guaranteed generalization ability of
the method of empirical risk minimization.
Below we derive both an upper bound for the loss (A4.3) and a lower
bound for the loss (A4.2) for two cases:
• Optimistic case (for set of problems n for which T( 1T) = 0)
• Pessimistic case (for set of problems n where there are
1T such that
T( 1T) =t- 0))
For the optimistic case we show that if a learning machine minimizes em-

(A4.5)
A4.3 UPPER BOUNDS ON THE MAXIMAL lOSS
173
pirical risk in a set of functions with VC dimension h, then for I! > h the
following inequalities are valid:
1 h + 1
h (In ~I! + 1) + 4
16
2e £+1 ':S LM(AM) ':S LM(Aemp) ':S 4
I!
+ £'
For the pessimistic case we show that if a learning machine minimizes the
empirical risk in a set of functions with VC dimension h, then for I! > 2h the
following inequalities are valid
h (In¥+1) +24
I!
(A4.6)
In the next section we derive the upper bounds in inequalities (A4.5) and
(A4.6), and then in Sections A4.4 and A4.5 we derive the lower bounds.
A4.3
UPPER BOUNDS ON 'rHE MAXIMAL LOSS FOR THE EMPIRICAL
RISK MINIMIZATION PRINCIPLE
A4.3.1
Optimistic Case
Let a set of indicator functions Q(z, a), a E A, have finite VC dimension h.
In Chapter 4 we showed that for any problem 7r the following bound on the
rate of uniform convergence is valid:
When Remp ( 7r, a(Aemp» = 0 the bound (A4.7) implies
P {R( 7r, a(Aemp»> 8*}
~ min (1, 4exp { (h(1
+:n¥)<)l})
where we denote 8* = 8 2.
(A4.7)
(A4.8)

174
A4 LOWER BOUNDS ON THE RISK OF THE ERM PRINCIPLE
Since in the optimistic case T( 7T) = awe have
L M (Aemp ) = sup T( 7T, Aemp).
1TEn
Furthermore, we have
= sup (X! P{R(7T,O'emp) > s*}ds*.
1TEn io
To obtain an upper bound on this quantity we use inequality (A4.8). We
obtain the inequalities
16 (2ef)h
{gf}
= g+T
h
exp -4 '
which are valid for any positive f Let us choose
(A4.9)
(A4.l0)
which provides a small value to the right-hand side of Eq. (A4.9). Substituting
(A4.10) into (A4.9) we obtain the upper bound on the expected loss for the
algorithm minimizing the empirical risk in the optimistic case:
A4.3.2
Pessimistic Case
To obtain an upper bound for the pessimistic case we consider the following
bound on the rate uniform convergence derived in Chapter 4:

A4.3 UPPER BOUNDS ON THE MAXIMAL LOSS
175
P {SUp IR( 1T, a) - Remp (1T, a)1 > 8}
aEA
$ minC
4 exp { (h (
1+;n¥) ~ (8 - 7)') f } )
. (A4.11)
This bound implies the inequality
P {R( 1T, a (Aemp)) - R( 1T, ao) > 28}
$ minC
4exp { (h (1 +;n¥) ~ (8-D}}).(A412)
Indeed, from (A4.11) one obtains that with probability at least 1 -
71 where
simultaneously the following two inequalities are valid:
R( 1T, a(Aemp)) - Remp( 1T, a(Aemp)) ::; 8
Taking into account that
one can conclude that the inequality
holds true.
Now let us estimate the maximal loss of ERM principle in the pessimistic

176
A4 LOWER BOUNDS ON THE RISK OF THE ERM PRINCIPLE
case:
LM(A emp ) = SUpL(7T,Aemp )
1T
= sup /
(R( 7T, a(Aemp) - R(7T, ao» dF1T(ZI, .. " zd
1TEn
= sup roo P{(R(7T,a(A emp ) - R(7T,ao» > B}dB.
1TEn 10
(A4.13)
To get a bound we use inequality (A4.12). We obtain the inequalities
L M (A.~) ~ 2f
min (1, 4exp { (h (I+;n¥) . (e .D}}) de
~ 2 (fa'de + 4f
c~erexp { ~ (e-D
2e}de)
~ 2 (g + 4 c~e) hf
exp { - (e_~)2e}de)
< 2 (g + 4 c~e) hf
exp { - (g ~ ~) (e- ~)e}de)
= 2 (g + 4 c~erge ~ 1 cxp { - (g-D
2e}).
(A4.14)
This inequality is valid for any
~. In particular, it is true for
~=
(A4.15)
Substituting (A4.15) into the right-hand side of Eq. (A4.14), we obtain that
for f > 2h the inequality is valid:
LM(Aemp ) :S 2
h (In ~ + 1)
4
f
+
2f
fh(ln h + 1)
< 4
h (In 2: + 1) + 24
(A4.16)
£.

A4.4 LOWER BOUND FOR THE MINIMAX LOSS STRATEGY IN THE OPTIMISTIC CASE
177
Thus, we obtained upper bounds on the maximal loss for the method of
empirical risk minimization for both the optimistic and the pessimistic cases.
Now we would like to obtain the lower bounds on loss for the minimax
loss strategy.
A4.4
LOWER BOUND FOR THE MINIMAX LOSS STRATEGY IN 'rHE
OPTIMISTIC CASE
To derive the lower bounds we use the fact that for any distribution function
P (7T) the Bayesian loss does not exceed the minimax loss:
To estimate the lower bounds for the minimax loss we estimate the lower
bound on the Bayesian loss for a special distribution function P (7T).
To construct such special distribution functions we need more detail in the
description of the learning problem.
In Chapter 1, which introduced the general learning scheme, we considered
three elements:
1. A generator of random vectors (it is determined by the distribution
function F(x))
2. A supervisor's operator F(ylx) that transforms vectors x into values y
3. A set of functions of the learning machines f(x, a), a E A
In this setting, any specific learning problem 7T is determined by two elements,
namely, the distribution function of the generator F'TI'1 (x) and the supervisor's
operator F'TI'2 (y Ix). Therefore to construct the distribution function on the set
of problems 7T, one needs to consider the joint distribution function P (7Tll 7Tz).
To obtain the Bayesian loss we consider a special distribution on the set
of problems. We keep the distribution function F(x) fixed for all problems
and will use some distribution on the set of admissible supervisor operators.
Let a set of functions f(x, a), a E A implementing a learning machine
have the VC dimension h. This means that there exists h vectors such that
(A4.l7)
can be shattered by this set of functions. Let
(A4.l8)
be the functions that shatter (A4.17).
Suppose that the probability measure F(x) is concentrated on the vectors
(A4.l7) such that the vector XI has probability 1 - p and any other vector
from (A4.17) has probability p/(h -1).

178
A4 LOWER BOUNDS ON THE RISK OF THE ERM PRINCIPLE
Now we define what our problems 7T are. In the optimistic case an admis-
sible set of problems 7T (target functions) belongs to the set of functions of
the learning machine. We consider 2h different problems: Problem number
7Tk means to estimate the function [(x, ak). To do this we are given training
data
(Xii ,f(XiJl ak», ..., (Xi,,f(Xipl ak»
(A4.19)
containing e pairs: input vectors x drawn from (A4.17) randomly and inde-
pendently in accordance with the described probability measure F(z) and its
values [(x, ak)'
Assume that the a priori distribution on the set of above-mentioned prob-
lems is uniform
1
P(7Td = 2h '
It is easy to see that in this situation the optimal Bayesian algorithm is the
following: to classify vector x as [(x 1 ak) if this vector occurs in the training
set (A4.19). Classification of the vectors that do not occur in the training
set (A4.19) does not matter (it can be any); that is, the optimal Bayesian
algorithm for our problems is as follows: Take any function whose empirical
risk is zero. The Bayesian loss for this case can be evaluated as follows:
1- P/
+ ~(h -1) (~) (1- ~)f
2
2
h-1
h-1
> !!.. (1 _ ~)f
(A4.20)
2
h-1
Indeed in (A4.20) the value (1 - p)/2 is the random (over all problems 7T)
loss in classifying vector XI under the condition that it does not occur in the
training set (A4.19); the value pf is the probability that vector XI does not
occur in the training set (A4.19).
Analogously the value 1(p/ (h - 1» is the random loss in classifying any of
the vectors Xj, i =I 1; the value (1 - p/(h - 1)/ is the probability that vector
Xi does not occur in the training set (A4.19).
Now let us find the expression for p that maximizes the right-hand of Eq.
(A4.20)
e(1- ~)f
2
h-1
We find that
(A4.21)
if e '5: h - 2,
if e> h - 2.
P={h-1
e+ 1
Substituting (A4.21) into (A4.20), one obtains the following lower bound for
the generalization ability of the empirical risk minimization principle in the

A4.5 LOWER BOUND FOR MINIMAX LOSS STRATEGY IN THE PESSIMISTIC CASE
179
optimistic case:
LM(Aemp ) 2: inf LH(A)
A
!
!(l __
l )f
>
2
h-1
Ih-1(
l)f
1h-1
2 £ + 1
1 - £ + 1
~ 2e £ + 1
if £ :S h - 2,
if £ > h - 2.
(A4.22)
A4.5
LOWER BOUND FOR MINIMAX LOSS STRATEGY IN THE
PESSIMISTIC CASE
Now we estimate the lower bound on the minimax loss for the pessimistic
case. In this case using the given set of functions [(x, u),
U E A, the learning
machine tries to approximate any supervisor's rule.
As in the optimistic case we will obtain the Bayesian solution for a specific
distribution functions P (1T') and will define a lower bound on the correspond-
ing loss. This bound is a lower bound for the minimax loss.
As in the previous case we consider a learning machine that has a set of
functions with VC dimension h. As before, let
(A4.23)
be a set of vectors which can be shattered by the set of functions of the
learning machine and let
be the functions that shatters the set of vectors (A4.23).
We will consider the following situation:
1. Probability P(x) is concentrated uniformly on the vectors (A4.23)
1
P(Xi) = T,'
2. The machine solves Zh learning problems 1T'k, k = 1, .. ", Zh, which are
determined by the following conditional probabilities
{
0.5 - d
Pk(w = Qlx) =
0.5 + d
{
0.5 + d
Pk(w = 11x) =
0.5 - d
if [(x, Uk) = 0,
if [(x, Uk) = 1,
if [(x, Uk) = 0,
if [(x, Uk) = 1.

180
A4 LOWER BOUNDS ON THE RISK OF THE ERM PRINCIPLE
3. Probability measure on the given set of problems is uniform:
1
P(1Td = 2h '
Under these conditions the learning machine has to select the decision rule
using the training data:
(wI,xd, ,." (Wf,Xf).
For any given problem 1Tb the best solution of the learning machine will be
the function [(x, ad, which provides the smallest risk:
Now our goal is to estimate Bayes' rule, which minimizes the functional
Zh 1(
1)
LB(A) = L 2h
R(1T,A) - 2 + ~
,
1=1
The optimal algorithm for this case will be the following. Suppose that vector
z = (w, x) occurs in the training set. Let it occur 111 (x) times as (0, x) (as a
representative of the first class) and 112(x) times as (1, x) (as representative
of the second class),
• If 11\ (x) > I1z(x), then this vector is classified as a representative of the
first class.
• If on the other hand 111 (x) < I1z(x), then vector x is classified as a rep-
resentative of the second class.
• In the case 111 (x) = I1z (x), the vector is classified as arbitrary.
If vector x does not occur in the training set, its classification does not matter
(e.g., it can be done by flipping a coin).
The loss from solving any problem 1Tk by this algorithm is equal. Therefore
(A4.24)
where:
2~.
h
I fbi'
h
.,
.
h
.
• h
IS t e oss or vector Xi,
e ongIng to t e training set, In t e situa-
tion when according to function [(Xi, ak) it is classified in one way and
according to the described rule (using either inequality 111 (Xi) > I1z(xd
or 111 (xJ < 112(Xi )) it should be classified in the other way.

A4.5 LOWER BOUND FOR MINIMAX LOSS STRATEGY IN THE PESSIMISTIC CASE
181
•
~ is the loss when nl (x;) = n2 (x;).
•
PI is the probability that either nl(x;) < n2(x;) when pew = 0IXi) >
pew = 1lxi) or nl(xi) > n2(xi) when pew = Olx;) < pew = llx;).
•
P2 is the probability of event nl (Xi) = n2 (X;).
The exact values of PI and P2 are defined by the following formulas:
(A4.25)
(A4.26)
where f 2 = {nl,n2,n3:
n, + n2 + n3 = f, nl = n2, nl
~ 0, n2 ~ 0, n3 ~ O,}.
Now we estimate the lower bound for the loss (A4.24) for different cases.
Case 1. Let f -s; h. Consider ~ = 0.5. Then using the trivial lower bounds for
(A4.25) and (A4.26) (namely, PI = °and P2 ~ (1 - 1jh)F and in accordance
with (A4.24) we obtain
mlnLB(A) ~ 0.5 (1 _ *) f ~ 0.5exp { _~}.
Case 2. Let h < f -s; 2h. Consider ~ = 0.25. In this case for the estimation of
PI we take into account only the term with n2 = 1, and for P2 we take into
account only the term with nl = n2 = 0. We obtain
mlnLB(A) ~ (0.25+ 8:) exp { -~}.
Case 3. Let f > 2h. Consider
Let us approximate the distribution of the random variable
by the normal law (for definiteness sake we assume that pew = 0lx;) > 0.5).
This random variable has the expectation
EO = 2~
f

182
A4 LOWER BOUNDS ON THE RISK OF THE ERM PRINCIPLE
and the variance
1 (1
4d
2
)
1
Var(O) = £ Ii - --,;2
~ hf'
Thus we consider the following normal distribution of the random variable
():
p «()) = Vhf exIJ
9
- ~)' ) .
V21i P 2(_1)2
../hi
Therefore
PI = P{9< OJ = 1- erf (2<l.JI) .
Taking into account that d = 0.5j1{ we obtain
PI = 1 - erf(1).
Thus for this case
mlnL8(A) 2 v1 (1 - erf(l)).
Combining all three cases we obtain the low bounds of minimax strategy for
the pessimistic case:
0.5 exp { - ~}
if f ~ h,
mlnL8(A) 2
(0.25+ 8:) exp {-~} if h < f ~ 2h,
j1{ (1 - erf(1))
if f 22h.

5
BOUNDS ON THE RISK
FOR REAL-VALUED
LOSS FUNCTIONS
This chapter obtains bounds on the risk for functions from a given set of
real-valued functions.
We will distinguish between three cases:
1. The given set of functions is a set of totally bounded functions.
2. The given set of functions is a set of totally bounded nonnegative func-
tions.
3. The given set of functions is a set of arbitrary nonnegative functions (it
can contain unbounded functionst).
In the first and the second cases we obtain the bounds as a direct gener-
alization of the bounds derived in Chapter 4 for sets of indicator functions.
In the third case we obtain bounds using some new concept that charac-
terizes the tails of the distributions of a set of random variables ga = Q(z, a),
a E A, induced by the unknown distribution function F(z) and the functions
in the set Q(z,a),a EA.
On the basis of these bounds, we will describe the generalization ability
of minimizing the empirical risk in the set of real-valued functions.
5.1
BOUNDS FOR THE SIMPLEST MODEL: PESSIMISTIC CASE
Consider again the problem of minimizing the risk
R(a) = /
Q(z, a) dF(z)
t This case is important for regression estimation problems.
(5.1)
183

184
5 BOUNDS ON THE RISK FOR REAL-VALUED LOSS FUNCTIONS
on the basis of empirical data
Zl, ... , Zf,
where now Q(z, a), a E A, is a set of real-valued functions.
As before, to minimize risk (5.1) we minimize the empirical risk functional
1
f
Remp(a) = £L Q(Zi, a)
i=!
(5.2)
over the set of functions Q(z, a), a E A.
Let the minimum of the risk (5.1) be achieved on the function Q(z, an)
and the minimum of the empirical functional (5.2) on the function Q(z, af).
We are looking for the answers to two questions:
1. What value of risk is provided by the function Q(z , af )? To answer this
question we have to estimate the value R(af)'
2. How close is the obtained risk to smallest possible for a given set of
functions? To answer this question means to estimate the difference
In Chapter 4 we answered these questions when Q(z, a), a E A, was a set
of indicator functions. The goal of this chapter is to get the answers to the
same questions for a set of real-valued functions.
As before, we start our study with the simplest model-that is, the case
where a set of real-valued functions contains a finite number N of elements
Q(z, ad, k = 1,2, ...,N.
Let us estimate the rate of uniform convergence of means to their expec-
tations over this set of functions
p L~~rN (J Q(z,a,)dF(z) -} tQ(Zi,a,)) > E}
~ ~P{(J Q(z,a,)dF(z) -} tQ(Zi,a,)) > E}
~ N 1~~rN p {(J Q(z, a,) dF(z) - }t Q(Zi,ad) > E}
(53)
In Chapter 4, we estimated the probability of large deviations using additive
Chernoff inequalities. (See Chapter 4, Eqs. (4.4) and (4.5).)

5.1 BOUNDS FOR THE SIMPLEST MODEl: PESSIMISnC CASE
185
Here for the real-valued bounded function
A ~ Q(z, a) ~ B,
we use Hoeffding's inequalities:
p {(J Q(z, a,) dF(z) - ~E
Q(Zi,a,)) > E} < exp hB2:2~)2},
(5.4)
p { (~E
Q(Zi, ",,) -[ Q(z, ad dF(Z)) > E} < exp { - (B2:2~)2 },
(5.5)
which are generalizations of the additive Chernoff inequalities. Using Hoeff-
ding's inequality (5.4), we obtain from (5.3)
As in Chapter 4, one can rewrite this inequality in the equivalent form:
With probability 1 -
T/ simultaneously for all N functions in the set Q(z, ak),
k = 1,2, ''', N, the inequality
f
J
1
InN -In T/
/
Q(z, ak) dF(z) - f L Q(z;, ak) ~ (B - A)
2£
;=1
is valid.
Let Q(z, ak(O)) be a function from our finite set of function that minimizes
the risk (5.1), and let Q(z, ak(f)) be a function from this set that minimizes
the empirical risk (5.2). Since the obtained bound is valid simultaneously for
all functions in the set, it is true as well for the function Q(z, ak(f))'
Thus with probability at least 1 -
T/ the following inequality
l
J
1
InN -In T/
/ Q(z, ak(f)) dF(z) ~ f L Q(z;, ak(f)) + (B - A)
2£
;=1
(5.6)
is valid.
This inequality estimates the value of the risk for the chosen function
Q(z, ak(f))' It answers the first question about estimating the risk for the
function which minimizes the empirical risk in the simplest model.
To answer the second question (how close is the risk for the chosen func-
tion to the minimal one), note that for the function Q(z, ak(O)) which mini-

186
5 BOUNDS ON THE RISK FOR REAL-VALUED LOSS FUNCTIONS
mizes the expected risk (5.1), Hoeffding's inequality
p { ~ ~ Q(z;, a"Oj)-I Q(z, a"oj)dF(z) > e} <; exp {-2(8 :~)2}
(5.7)
holds true.
From this inequality we find that with probability 1 -
71 the inequality
f
g;
1
-In 71
I Q(z, ak(O)) dF(z) 2: eL Q(Zi, ak(O)) - (B - A) ---u-
i=1
(5.8)
holds true.
Taking into account that Q(z, ak(f)) minimizes the empirical risk functional
and therefore
from (5.6) and (5.8), we conclude that with probability at least 1 - 271 the
inequality
holds true.
Thus the inequalities (5.6) and (5.9) give complete information about the
generalization ability of the method of empirical risk minimization for the
case when the set of totally bounded functions contains a finite number of
elements: Inequality (5.6) estimates the upper bound on the risk for the
chosen function, and inequality (5.9) estimates how close this bound is to the
minimal possible risk for this set of functions.
These inequalities are generalizations of the analogue inequalities obtained
in Chapter 4 (inequalities (4.9) and (4.12)) for a set of indicator functions.
5.2
CONCEPTS OF CAPACITY FOR THE SETS OF REAL-VALUED
FUNC'I'IONS
5.2.1
Nonconstructive Bounds on Generalization lor Sets 01
Real-Valued Functions
Now our goal is to generalize the results obtained for the simplest model
to the general model, where the set of real-valued bounded functions A :=;
Q(z, a) :=; B, a E A, contains an infinite number of elements.

5.2 CONCEPTS OF CAPACITY FOR THE SETS OF REAL-VALUED FUNCTIONS
18'
In Chapter 15 we prove Theorem 15.2, which, for a given probability
measure, estimates the rate of uniform convergence on the set of functions
-00 < A ::; Q(z, a) ::; B < 00,
Theorem 15.2. The inequality
a EA.
'Ie> 0
p h~~ IQ(z, a) dF(z) - }t. Q(Zi, a) > e}
<
{(H~nn(eI6(B -A),f) _
e2
C+lnf) f}
- exp
f
36(B -A)2 +
f
is valid.
In this bound we use the concept of annealed entropy defined in Section
3.8
H~nn(e,f) = InElnNA(e;Zl, ...,z,),
where NA(e; Zl, .,., z,) is cardinality defined in Section 3.8.
This exponential bound is nontrivial if the equality
I'
H~~n(e,f)
0
1m
=
,~oo
R
'
is valid. In Chapter 3 we called this equality the second milestone in learning
theory.
The inequality defined by Theorem 15.2 can be rewritten in the equivalent
form: With probability 1 -
1J simultaneously for all functions the inequality
R(a)::; Remp(a) + JE(R)
holds true, where
E(l) = 36(B _ A)2 H~nn(eI6(B - :), R) + InR + c.
Now one can derive the bounds on generalization ability of the machine that
minimizes empirical risk in a set of real-valued functions: With probability
1 -
1J the inequality
holds true.
Using Hoeffding's inequality, one can obtain (exact as it was done in the
last section) that with probability 1 - 21J the inequality
a = R(ad - ~~~ R(a) ::; JE(R) + (B - A)J - ~~ 1J

188
5 BOUNDS ON THE RISK FOR REAL-VALUED lOSS FUNCTIONS
holds true. Therefore, using the concept of annealed entropy of sets of real-
valued functions, we can construct the theory of bounds.
We, however, choose another way for developing the theory of bounds of
machines minimizing the empirical risk in sets of real-valued functions. This
way allows us to obtain bounds for sets of unbounded functions. The last
case is important for regression estimation problem.
5.2.2
'rhe Main Idea
In the previous chapter, construction of distribution independent bounds used
a special concept of capacity of the sets of indicator functions: annealed
entropy, growth function, VC dimension. Here to obtain bounds for sets of
real-valued functions we generalize the capacity concept described in Chapter
4.
The idea of these generalizations is inspired by the definition of Lebesgue-
Stieltjes integral. We have already used this idea, when in Chapter 2, Section
2.6 we showed that the problem of risk minimization on the basis of empirical
data can be considered from the point of weak convergence of probability
measures. Now we will repeat this reasoning and go a little further.
According to the definition, the Lebesgue-Stieltjes integral of a measur-
able nonnegative function 0 ::; <I>(z) ::; B is
1
8
n-I B
{
kB}
<I>(z) dF(z) = lim L -P
<I>(z) > -
,
()
n~XJ
n
n
k=O
where
is the probability of event
We can describe the empirical risk in a similar form:
1
f
n-l B
{
kB}
Ii ""' <I>(zd = lim""' -v
<I>(z) > -
,
f. L
n~XJL n
n
i=]
k=()
where
v { z: <I>(z) > k:}
is the frequency of the event A(kBIn) evaluated from the data Zl, ... , Zf.

5.2 CONCEPTS OF CAPACITY FOR THE SETS OF REAL-VALUED FUNCTIONS
189
Let us consider the difference
1
8
1
f
<I>(z) dF(z) - eL <I>(z;)
°
;==1
II
B
{
kB }
II
B
{
kB}
= lim'""' -P
<I>(z) > -
- lim '""' -v
<I>(z) > -
11-+00 L- n
n
n-+oo L- n
n
k==1
k==l
II
B ({
kB }
{
kB })
= }~~Ln P
<I>(z) > n
- v
<I>(z) > n
k==1
II
B
~ lim L -
sup
(P {<I>(z) > f3} - v {<I>(z) > f3})
11-+ X
n QE(O B)
k==1
I-'
,
= B sup (P {<I>(z) > f3} - v {<I>(z) > f3})
f3E(O,B)
= B sup (/ o{<I>(z) - f3}dF(z) - }t o{<I>(z) - f3}) ,
f3E(O,B)
;==1
where we consider f3 as a parameter from the interval (0, B). Let us denote
this interval by B.
Thus we derived
/
1
f
<I>(z) dF(z) - eL <I>(z;)
;==1
~ B ~~~(J 9{"'(z) -llldF(z) - ~ ~ O{"'(z) - 13)).
(5.10)
Below, to estimate the rate of uniform convergence for the set of bounded
functions A :S Q(z, a) :S B, a E A, we use the following inequality
p b~ (J Q(z,a)dF(z) - ~ ~ Q(z;, a)) > e}
~ p LSA~f,"(J 9{Q(z, a)-Ill dF(z) - ~ ~ 9{Q(z;, a)-Ill)
> B~ A}.
(5.11)
This inequality following from (5.10) is the basis for our generalizations. It
shows that for any E: > 0 the probability that the largest deviation of averages
from their expectations over a set of real-valued bounded functions A ~
Q(Z, a) :S B, a E A, exceeds
E: is less than the probability that for the set

190
5 BOUNDS ON THE RISK FOR REAL-VALUED lOSS FUNCTIONS
of indicator functions 8{Q(z;, u) - ,8}, u E A,,8 E B, the largest deviation of
frequencies from their probabilities exceeds 8/(8 - A).
In previous chapter we obtained for a set of indicator functions the bounds
on the probability of the last event (bounds on the rate of uniform conver-
gence). Using these bounds we can obtain the bounds on the rate of conver-
gence for a set of real-valued bounded functions.
The following shows how to obtain these bounds but not before we intro-
duce some definitions.
5.2.3
Concepts of Capacity for the Set of Real-Valued Functions
Definition of the Set of Indicators
l. Let Q(z, u*) be a real-valued function. We call the set of indicator
functions
8(Q(z, u*) - (3),
the set of indicators for function Q(z, u*) (see Fig. 5.1).
2. Let Q(z, u), u E A, be a set of real-valued functions. We call the set of
indicator functions
O(Q(z, u) - ,8),
the complete set of indicators for a set of real-valued functions Q(z, u),
u E A.
Below we assume that complete set of indicators satisfies conditions of
measurability for indicator functions used in Chapter 4.
Note that the set of indicators for an indicator function contains one ele-
ment, namely, the indicator function. The complete set of indicators for any
set of indicator functions coincides with this set of indicator functions.
According to inequality (5.11), one can obtain the bounds for the rate
of uniform convergence of averages to expectations over a given set of real-
valued functions by bounding the rate of uniform convergence of frequencies
to probabilities over the corresponding set of indicators. We develop this idea
in the following text.
We start with generalizations of the three main capacity concepts in-
troduced in previous chapters for sets of indicator functions: the annealed
entropy, the growth function, and the VC dimension.
Annealed Entropy of a Set of Indicators of Real-Valued Functions.
Let Q(z, u), Z E Z, u E A, be a set of real-valued (not necessary bounded)

5.2 CONCEPTS OF CAPACITY FOR THE SETS OF REAL-VALUED FUNCTIONS
191
[(Q (z. a) - (3)
Q(z, ex), exeA
o
z
FIGURE 5.1. The indicator of level (3 for the function Q(z, a) shows for which z the
function Q(z, a) exceeds (3 and for which z It does not. The function Q(z. a) can be
described by the set of all its indicators.
functions. Let N A,{3(Zl, .. " Zt) be the number of different separations of £
vectors Zl, ..., Zr by a complete set of indicators:
O{Q(z, a) - f3},
Let the function
a E A, f3 E B= (infQ(Z,a) ~ f3 ~ SUPQ(z,a)).
OIl
OIZ
H A.{3 (Zl, ..., Zr) = In N A.{3 (Zl, ... , z,)
be measurable with respect to measure on Zl, ...Zf.
We call the quantity
the annealed entropy of the set indicators of real-valued functions.
Growth Function of a Set of Indicators of Real-Valued Function.
We call the quantity
0\,8(£) = In max N A,{3 (Zl, ..., Zr)
Zl,···,l,
the growth function of a set of real-valued functions Q(z, a), Z E Z, a E A.
VC Dimension ofa Set ofReal-Valued Functions. We call the maximal
number h of vectors Zl, ... , Zh that can he shattered hy the complete set of
indicators () {Q(z,a) - /3}, a E A,f3 E B, the VC dimension of the set of
real-valued functions Q(z, a), a EA.

192
5 BOUNDS ON THE RISK FOR REAL-VALUED lOSS FUNCTIONS
Example. The VC dimension of a set of functions that are linear in their
parameters
n-l
fez, a) = L a;<Pi(Z) + aO
;=1
equals n, the numbers of parameters of a set of functions.
Indeed, as was shown in Chapter 4, Section 4.11 the VC dimension of a
set of linear indicator functions
is equal to n. The VC dimension of a set of linear functions is equal to n as
well because the complete set of indicators for this set coincides with the set
of linear indicator functions.
Note that all definitions are given for arbitrary sets of functions (they do
not require that infz,a Q(z, a) > -00 or sUPz.a Q(z, a) < 00). Note also that
these definitions of the different concepts of capacity for sets of real-valued
functions are generalizations of definitions of analogous concepts given in
Chapters 3 and 4 for sets of indicator functions: For sets of indicator functions
they coincide with the old definitions, and for sets of real-valued functions
they define a new concept.
As in the case of indicator functions, these concepts are connected by the
inequalities
H~~~(f) ::; GA,B(f) ::; h (Inf+ 1) ,
(5.12)
where h is the VC dimension of a set of real-valued functions Q(z, a), a E
A. Using these capacity concepts, one can obtain the bounds on uniform
convergence.
5.3
BOUNDS FOR THE GENERAL MODEL: PESSIMISTIC CASE
Theorem 5.1. Let A ::; Q(z, a) ::; B, a E A, be a measurable set of bounded
real-valued functions, which set ofindicators satisfy conditions ofmeasurability
for Theorem 4.1. Let H::~~(f) be the annealed entropy of the set of indicators.
Then the following inequality is valid:
(5.13)

5.3 BOUNDS FOR THE GENERAL MODEl: PESSIMISTIC CASE
193
where
1
e. = e - f'
The bound obtained in this theorem to within a constant (8 - A) coincides
with the bound obtained in Theorem 4.1, this bound is nontrivial if
I·
H~n~(f) - 0
1m
IJ
-.
f ---+00
.e-
The proof of this theorem is obvious: It follows from inequality (5.11) and
Theorem 4.1.
Inequality (5.13) can be rewritten in the equivalent form (in the same way
done several times before):
With probability 1 -
71 simultaneously for all functions in a set ofreal-valued
bounded functions Q(z, a), a E A, the inequality
is valid, where
R(a) :s Remp(a) + (8 - A)JE(£)
(5.14)
(5.15)
This inequalities imply that with probability at least 1 -
71 the inequality
(5.16)
is valid. As before, at defines the function which yields the minimal empirical
risk.
Thus we have obtained the first inequality describing the generalization
ability of the learning machine minimizing the empirical risk. To derive the
second inequality we use Hoeffding's inequality (5.5):
(5.17)
Taking into account that for the function minimizing empirical risk with prob-
ability 1 -
71 inequality (5.16) holds, we conclude that with probability at least
1 - 271 the inequality
Il(a,) = R(a,) - R(",) :> (8 - A) ( JE(E) +J-~~ 71 )
(5.1R)
is valid.

194
5 BOUNDS ON THE RISK FOR REAL-VALUED lOSS FUNCnONS
The inequalities (5.16) and (5.18) describe the generalization ability of the
learning machine minimizing the empirical risk in a set of totally bounded
functions for a given probability measure F(z).
As in the case of indicator functions, from these inequalities and inequal-
ity (5.12) one can derive both distribution-free nonconstructive bounds and
distribution-free constructive bounds. To obtain these bounds, it is sufficient
in the inequalities (5.16) and (5.18) to use the expression
G'\,B(2f) - In TJ/4
1
£(£) =
£
+e
(this expression provides distribution-free nonconstructive bounds), or to use
the expression
£ (£) = h(In 2f/ h + 1) - In TJ/ 4
£
(this expression provides distribution-free constructive bounds).
The derived bounds describe the pessimistic scenario.
5.4
THE BASIC INEQUALITY
The next sections continue to generalize the results obtained for the set of
indicator functions to the set of real-valued functions.
Our goals are:
I. To obtain the bounds on the generalization ability of the empirical risk
minimization induction principle for the set of real-valued bounded
functions which are better than the bounds obtained in the last section.
2. To obtain the bounds on the generalization ability of the principle of
empirical risk minimization for the set of real-valued unbounded func-
tions.
We will obtain these bounds using the basic inequality to be derived in this
section, which uses the auxiliary function Dp (ex) defined as follows:
Dp(ex) = {X :)P{Q(z, ex) > c} dc,
in
(5.19)
where 1 < P ~ 2 is some fixed parameter and Q(z, ex), ex E A, is a set of non-
negative functions.
Theorem 5.2. Let Q(z, ex),
ex E A be a set of the real-valued (not necessary
hounded) nonnegative functions. Let H~~~(€) be the annealed entropy of in-

5.4 THE BASIC INEQUAlITY
195
dicators for this set offunctions. Then for any 1 < P ~ 2 the inequality
1
f
JQ(z, a) dF(z) - f L Q(Zj, a)
p
sup
j=]
> e
aEA
Dp(a)
< 4ex
{(H:~~(l:) _~) fl2 - 2/P }
P
fl2-2/p
21+2/p
is valid.
The inequality (5.20) is nontrivial if
(5.20)
Note that this theorem defines bounds for any sets of functions (not nec-
essarily bounded).
5.4.1
Proof of Theorem 5.2
Consider the expression
1
f
JQ(z, a) dF(z) - f L Q(Zj, a)
j=]
sup ----------,------
aEA
Dp(a)
Ji.~[t, ~p { Q(z, a) > ~} ~t. ~v { Q(z, a) > ~}]
= sup --------------------
aEA
Dp(a)
(5.21 )
We show that if inequality
P { Q(z, a) > ~} - v { Q(z, a) > ~}
sup
< e
(5.22)
aE,\
pi {
i }
yP
Q(z,a»n

196
5 BOUNDS ON THE RISK FOR REAL-VALUED LOSS FUNCl'lONS
is fulfilled, then the inequality
1
f
J Q(z, a)dF(z) - £ L
Q(z;, a)
;=1
sup ----------- <_ e
uEA
Dp(a)
is fulfilled as well.
Indeed, (5.21) and (5.22) imply that
(5.23)
1
l
JQ(z,a)dF(z) - eLQ(z;,a)
;=1
sup -------:::--::--:---'---'-----
uE,\
Dp(a)
elillln->oo L~1 ~ (p {Q(Z, a) > ~}) lip
eD (a)
< sup
= sup
p
= e.
-
uEA
Dp(a)
uEA Dp(a)
Therefore probability of event (5.22) does not exceed the probability of event
(5.23). This means that the probability of the complementary events are con-
nected by the inequality
1
f
J Q(z, a) dF(z) - £ L
Q(z;, a)
;=1
P
sup ------------ > e
uEA
Dp(a)
< P {
sup
P {Q(z, a) > f3} -
l) {Q(z, a) > f3} > e}.
-
uEA,{3EB
yiP {Q(z, a) > f3}
In Theorem 4.2* we bounded the right-hand side of this inequality (see Chap-
ter 4, Eq. (4.35a)). Using this bound we prove the theorem.
5.5
BOUNDS FOR THE GENERAL MODEL: UNIVERSAL CASE
Using the results of Theorem 5.2, this section derives the rate of unifonn rel-
ative convergence for a bounded set of nonnegative functions 0 S; Q(Z, a) S;
B, a E A; that is, we prove the following theorem.

5.5 BOUNDS FOR THE GENERAL MODEL: UNIVERSAL CASE
197
Theorem 5.3. The inequality
is valid.
p
1
f
I Q(z, a) dF(z) - £L Q(z;, a)
;=1
---r======,----- > t:
JI Q(z, a) dF(z)
4
{( H~~~(2f) _ ~) f}
<
exp
f
4B
(5.24)
The bound (5.24) is nontrivial if
lim
H~n~(£) = o.
f-->'CQ
£
Note also that on the right-hand side the constant B comes in first degree
(rather than in squared as in Hoeffding's inequality).
Theorem 5.3 is a generalization of Theorem 4.3 obtained for a set of
indicator functions.
Inequality (5.24) can be rewritten in the equivalent form:
With probability at least 1 -
TJ simultaneously for all functions in a set of
real-valued bounded functions the following inequality is fulfilled:
R( ) < R
()
B£(£) (111
4Remp(a))
a
-
emp a +
2
+ V +
B£(f)
,
where
£(f) = 4 H~n~(2£) - In TJ/4
(5.25)
f
.
From this inequality we find the bounds describing the generalization abil-
ity of the learning machine which minimizes the empirical risk functional:
With probability at least 1 -
TJ the inequality
( J
4Remp(a())
R(ad < Remp(a) + B£(£)
1 +
1 +
£(£)
is valid, where £(£) is given by (5.25).
With probability at least 1 - 2TJ the inequality
[~
(J
4Remp(a())]
~(af) = R(af) - R(ao) < B V---u + £(£)
1 +
1 +
B£(£)
is valid, where £(£) is given in (5.25).

198
5 BOUNDS ON THE RISK FOR REAl·VALUED lOSS FUNCTIONS
These bounds are dependent on the unknown probability measure F(z). As
before, one obtains distribution-free nonconstructive and distribution-free
constructive bounds by using the following expressions for £(f):
G A•B(2f) - In 71/4
£(f) = 4
f
'
h (In ~ + 1) - In 71/4
£(f) = 4
P
,
where G'\,B(f) is the growth function and h is the VC dimension of a set of
real-valued functions Q(z, a), a E A.
Theorem 5.3 completes the generalization of the theory obtained for sets
of indicator functions to sets of real-valued bounded functions.
Note that when A = 0 and B = 1 the bounds on the risk for sets of
bounded real-valued functions coincide with the bounds on risk for sets of
indicator functions. From the conceptual point of view, the problem of min-
imizing the risk in sets of indicator functions (the pattern recognition prob-
lem) is equivalent to the problem of minimizing a risk in sets of real-valued
bounded functions.
A new development of the problem of minimizing the risk from the data
starts when one minimizes the risk in sets of nonbounded functions.
The next section analyzes this case. However, to complete this section,
Theorem 5.3 must be proved.
5.5.1
Proof of Theorem 5.3
This subsection proves a more general version of Theorem 5.3.
Theorem 5.3*. For any 1 < P ::; 2 the inequality
is valid.
p
1 (
f Q(z, a) dF(z) - "i L Q(z;, a)
;=1
sup
> 8
aEA
<./f Q(z, a) dF(z)
{ (
H~~(2f)
8
2
)
2(1-1/P)}
< 4exp
£2(1- lip}
-
21+2IPB2- 21p
£
(5.26)
The proof of inequality (5.26) is based on Holder's inequality for two

5.5 BOUNDS FOR THE GENERAL MODEl: UNIVERSAL CASE
199
functions: functiont fez) E Lp(a, b) and function g(z) E Lq(a, b), where
l/p+l/q=l,
P > O,q > 0:
b
(
b
) lip (
b
)
l/q
llf(z)g(z)1 dz ~
llf(Z)IPdZ
llg(zW dz
Consider the function
Dp(a) = LX! ~P{Q(z,a) > e}dc.
For a bounded set of functions we can rewrite this expression in the form
Dp(a) = L
B
{jP{Q(Z, a) > c} de.
Nowletusdenotef(z) = <!P{Q(z,a) > e} anddenoteg(z) = 1. Using these
notations we utilize the Holder's inequality. We obtain
B
(
B
)
lip
Dp(a) =L ~P{Q(z,a»t}dt< LP{Q(z,a»t}dt
n(l-I/p).
Taking into account this inequality, we obtain
1 r
fQ(z,a)dF(z) - f LQ(Zi,a)
P
sup
i=l
> eB(I--I/p)
aE,\
~J Q(z, a) dF(z)
'5::.P
1
r
JQ(z, a) dF(z) - eL
Q(z;, a)
sup
i=l
> e
aEA
J<!P{Q(z,a»t}dt
Using the bound on the right-hand side of this inequality given by Theorem
5.2, we obtain inequality (5.26).
(Function f(z) belongs to space Lq(a,b) if
[n If(zW dz ::; OC'.
The values a and b are not necessarily finite.

200
5 BOUNDS ON THE RISK FOR REAL-VALUED LOSS FUNCTIONS
5.6
BOUNDS FOR UNIFORM RELA'nVE CONVERGENCE
This section starts the analysis of the convergence rate for sets of unbounded
nonnegative functions and proves the following theorem.
Theorem 5.4. Let the nonnegative functions (not necessary bounded) of the
set Q(z, a), a E A be such that the random variables
~a = Q(z, a) possess a
finite moment of order p > 1. Then:
1. If p > 2, the inequality
1
!
J Q(z, a) dF(z) - £L Q(z;, a)
p
sup
;=1
> ea(p)
aE,\
~J QP(z, a) dF(z)
{ (
H.\,B(2f)
e 2 )}
< 4exp
- -
£
£
4
is valid, where
<j1(P-l)P-1
a(p)=
-
-
2
p-2
2. If 1 < p S 2, the inequality
1
f
JQ(z,a)dF(z) - £ LQ(z;,a)
p
sup
;=1
> eVp(e)
aE.\
{jJ Qp(z, a) dF(z)
is valid, where
Vp(e) = r/(l _
lne
)P-l
V
r-.fP(p - 1)
(5.27)
(5.28)
In contrast to the denominator in bound (5.26) from Theorem 5.3*, here
the denominator has clear statistical meaning: It is the norm of the function
Q(z, a) in the metric Lp(F) [normalized moment of the order p of the random
variable ~a = Q(z, a)].

5.6 BOUNDS FOR UNIFORM RELATIVE CONVERGENCE
201
Note that according to this theorem, using the normalized moment with
different p > 2 on the left-hand side of the inequality affects only the con-
stant in the exponent of the right-hand side of the inequality. However, the
right-hand side of the inequality significantly depends on the order of the
normalized moment p if 1 < p ~ 2. This fact indicates the importance of
existence of the second moment of the random variables
~a = Q(z, a) for
the rate of uniform convergence.
5.6.1
Proof of Theorem 5.4 for the Case p > 2
We prove this theorem first for p > 2 and then for 1 < p ::; 2.
To prove the first part of the theorem we show that if p > 2 (p is not
necessarily an integer), then the following inequality holds true:
D2(a)~ /.00 JP{Q(z,a»C)dC~a(P)1/I QP(z,a)dF(z),
where
V1 (p -l)P-I
a(p)=
-
-
2
p-2
From this inequality we find that
(5.29)
P
1
f
JQ(z, a) dF(z) - 7L Q(Zh a)
sup
;=1
> e
aEA
a(p){jJQp(z, a) dF(z)
<P
1
f
JQ(z, a) dF(z) - 7L Q(Zi, a)
sup
;=1
> e
aEA
D2(a)
The right-hand side of this inequality is bounded by Theorem 5.3. The first
part of this theorem is the equivalent form of the inequality above. Therefore
to prove the theorem it is sufficient to derive the bound (5.29).
To obtain this bound we express the functional R(a) in terms of the
Lebesgue integral:
R(a) = /
Q(z, a) dF(z) =L
oo
P{Q(z, a) > t} dt.

202
5 BOUNDS ON THE RISK FOR REAL-VALUED LOSS FUNCTIONS
Observe that for any fixed a and arbitrary t the probability of the event
{Q(z, a) > t} can be rewritten in terms of the distribution function of the
nonnegative random variable ga = Q(z, a). Namely,
is related to the probability of the event {z: Q(z, a) > t} as follows:
P{Q(z, a) > t} = 1 - Fa(t).
Thus the functional R(a) can be rewritten in the form
R(a) = / t dFa(t) = LX (1 - Fa(t)) dt.
Moreover, the pth moment of the random variable ga and the function D A(a)
can be written as follows:
D2(a) = LXJp{Q(z,a»t}dt=1
00
J(l-Fa(t))dt.
Now let the mp(a) be a moment of order p > 2
(5.30)
We obtain a distribution function Fa(t) such that D2(a) is maximized for the
fixed mp(a).
For this purpose we construct the Lagrange function:t
L(a)
(5.31 )
We determine a probability distribution function for which the maximum of
L(a) is obtained. Denote
b = p,p
and rewrite (5.31) using these notations:
t For a review of optimization techniques using Lagrange functions see Section 9.5

5.6 BOUNDS FOR UNIFORM RELATIVE CONVERGENCE
203
The function <t> at which the maximum of the functional (5.31) is attained is
defined by
1 - 2bptp- 1<t> = 0,
which implies that
where to = (1 /2pb)p-l .
Since <t> varies between 1 and 0 as t varies between 0 and 00, the optimal
function <I> = <1>(t) is
if t < to,
if t ~ to.
We now compute max D2(a) (recalling that p > 2):
l
OC
[00 (t )P-l
P
1
max D2(a) =
<I>(t) dt = to +
J:l
dt = to =2'
o
10
t
P
On the other hand, expressing mp (a) in the terms of to we have
mp(a) = pL
oo
tp- 1<l>2(t) dt
L
IO
[00
(
1)
=p
tp - 1dt+
tP-l<I>P-I(t)dt=2t~ p=
.
o
~
P
2
(5.32)
(5.33)
Substituting the value of to obtained from (5.32) into (5.33). we arrive at
which implies that for any a E A and p > 2 the inequality
holds true, where
VI (p -1 )P-I
a(p)=
-
-
2
p-2
Therefore the probability of event
{
R(a) - Remp(a)
(p)}
sup
> a
e
aEA
{!mp(a)

204
5 BOUNDS ON THE RISK FOR REAL-VALUED LOSS FUNCTIONS
does not exceed the probability of event
{
R(a)-Remp(a)
}
sup
D ( )
> E:
.
(lEA
2 a
According to Theorem 5.3, this fact implies the inequality
The equivalent form of this bound is the assertion of the first part of the
theorem.
5.6.2
Proof of 'rheorem 5.4 for 'the Case 1 < p < 2
To prove the second part of the theorem, consider the difference
R(a) - Remp(a) = }i.~f ~ (p { Q(Z, a) > ~} - v { Q(z, a) > ~})
1=1
= L':JO(p{Q(z,a»t}-v{Q(z,a»t})dt.
(5.34)
Assume that for all a E A the condition
R(a)-Remp(a)~E:Dp(a)=E:L
oo
{jP{Q(z,a»t}dt
(5.35)
is fulfilled. Moreover, the inequality
R(a) - Remp(a) ~ R(a) =
(Xl P {Q(z, a) > t} dt
(5.36)
Jo
is always valid. To compute the integral (5.34) do the following: For such t
that
P {Q(z, a) > t} > E:p/(P-l)
apply the bound (5.35); otherwise, if
P {Q(z, a) > t} ~ E:p/(P-l),
apply the bound (5.36).

5.6 BOUNDS FOR UNIFORM RELATIVE CONVERGENCE
205
We thus obtain
R(a) - Remp(a)
::; e l-Fa(t»8pe,P-1i :j1-Fa(t)dt+ l-Fa(l)sep,P ,l(l-Fa(t))dt.
(5.37)
We now find the maximal value (with respect to the distribution Fa (t)) of the
right-hand side of inequality (5.37) under the condition that the pth moment
takes on some fixed value mp(a); that is,
1~ tP dFa(t) = p 1~ tp - I (1 - Fa(t)) dt = mp(a).
For this purpose we again use the method of Lagrange multipliers, denoting
cf>P = ~(t) = 1 - Fa(t).
Thus we seek the maximum of the expression
L
L
L
x
L(a)=
eet>dt+
ecf>Pdt-p.
tp-1cf>Pdt,
<t»elIIP-11
<t>Se1/lp-1)
()
Represent L(a) in the form
L(a) = r
(ecf>P - p.tp- Icf>P) dt + r
(eet> - p.tp- I cf>P) dt,
J<t»e1etp-ll
J<t>se1,IP
I)
where the maximum of the first summand defines the function
et> in the
domain et> > e I/(P-I) and the maximum of the second summand in the domain
et> ::; el/(P-I). The first summand attains its absolute maximum at
f£
1
et>(t) =
p-l --.
pp. t
However, taking into account that et> is a monotonically decreasing function
from 1 to el/(P-I) we obtain
,
et>(t) =I:-JI!
Vpp. t
if 0::; t < P-l~,
Vpp.
)'f fE
p-{f1
p-l
-
::; t <
-.
Pp.
Pp.
The second summand attains its maximum in the domain et> ::; e I/(P-I) at the
function
P~
if p{f;
"If
-
<t<
et>(t) =
pp. -
0
if
Pif
t>
-.
P.

206
5 BOUNDS ON THE RISK FOR REAL-VALUED LOSS FUNCTIONS
We thus finally obtain
<P(t) =
/'.;(8
a
if 0 ~ t <
P I~,
VpJ.L
'If
I~
Plfl
PypJ.L ~ t < VJii;'
'If p_{f1
pif!
-
~ t <
-,
PJ.L
J.L
)'f
p-lfl
t > V-;;.
J.L
We now express the pth moment mp(a) in terms of the Lagrange multiplier
J.L. For this purpose we compute the pth moment:
mp(a) =p
f()::K, tp-1<pp(t)dt =
(~)P/(P-I) (1-
In6
)
(5.38)
In
,....
PW(p - 1)
.
Analogously we compute the quality
R(a) - Remp(a) <
pv;,F
6 f
/'1' <P(t)dt
In
j
'x!
(
) l/(p-I) (
+
<PP(t) dt =
~
1 -
pilI
J.L
V~
In 6
)
P\!p(p - 1)
.
(5.39)
It follows from (5.38) and (5.39) that
R(a) - Remp(a) < 6V (6)
{/mp(a)
-
p
,
where we denote
i(
In 6
)P-I
Vp (6) =
1 -
/' W(p - 1)
(5.40)
Thus we have shown that the condition (5.40) implies the condition (5.35).
Therefore the probability of the event
{
R(a) - Remp(a)
V ( )}
sup
> 6
P 6
"(,\
{/mp(a)

5.7 PRIOR INFORMATION FOR THE RISK MINIMIZATION PROBLEM
207
does not exceed the probability of event
{
R(a) - Remp(a)
}
sup
> 6
.
aEA
Dp(a)
Therefore Theorem 5.2 (Eq. (5.20)) implies the inequality
P {sup R(a~ - Remp(a) > 6VP(6)}
aEA
{!mp(a)
{(
H
A'B(2£)
6 2
)
2(1~ljP)}
< 4exp
£2(1-ljp)
-
21+2jp
£
,
The equivalent form of this bound is the assertion of the second part of our
theorem,
5.7
PRIOR INFORMATION FOR THE RISK MINIMIZATION PROBLEM
IN SETS OF UNBOUNDED LOSS FUNCTIONS
According to the law of large numbers, if a random variable g has an expec-
tation E~, then the mean
1
f
{f=ZLgi
i=l
of £. independent identically distributed examples gl, .." gf converges in prob-
ability to this expectation when £ increases.
However, the rate of convergence can be arbitrarily slow. In this case one
cannot estimate the expectation using the mean gf even if £ is sufficiently
large,
Example. Let the random variable g take on the two values: 0 and K. Sup-
pose that P{g = O} = 1 -
6 and P{~ = K} = 6 and suppose that 6 is so small
that with high probability 1 - 0 the random independent sample ~[, ,.., ~f con-
sists solely of zeros and hence the mean of this sample is zero. Probability of
this event is (1 - 6)' = 1 - o.
On the other hand the expectation of the random variable ~ equals Eg =
6K and, depending on value K, admits arbitrary values including the large
ones (for example, when K = 1/62),
Thus in our example, despite the fact that almost any training set contains
only zeros, one can come to no reliable conclusions concerning the value of
expectation. This happened because the distribution of the random variable
was such that the "very large values" of this random variable have "suf-
ficiently large probability," or, as some statisticians say, the distribution of
random the variable g has a "heavy tail."

208
5 BOUNDS ON THE RISK FOR REAL-VALUED LOSS FUNCTIONS
To get a bound we have to possess some prior information about the
"tails" of the distribution of our random variable.
From the classical statistics it is known that in order to get a bound on
the means it is sufficient to know the absolute moment of any order p > 1 of
the random variable f In particular, jf one knows the moment Eg2 of order
p = 2 of the random variable g, then using the Chebyshev inequality one can
estimate the deviation of the sum of i.i.d. values as follows:
In the case when one knows moment of order 1 :::; p :::; 2, the (Barh-Essen)
inequality
{
It
}
ElglP
P
Eg - e~ gi > e
< Cp eP€p-1
holds true, where 0 < Cp < 2.
In the last section we showed that the existence of a moment of order p > 1
for all functions of the set Q(z, a), a E A, with finite VC dimension implies
uniform relative convergence of means to their expectations. Theorem 5.4
estimates the rate of this convergence.
However, to obtain from this rate of convergence a bound on the risk and a
bound for the rate of generalization ability, it is necessary to take into account
some general quantitative characteristics of admissible "tails" of distributions.
In the case of a set of bounded nonnegative functions, this characteristic was
B, the bound on the values of functions (the tails of the distributions of a set
of random variables ga = Q(z, a), a E A, is such that p{ga > B} = 0). The
bound B is the parameter in the corresponding inequality.
In this section we consider the characteristic of the tails of a set of distri-
butions of nonnegative random variables Tp that depends on the parameter
p, namely,
~
sup
Ec
= Tp .
aEA
~a
(5.41)
To show that the characteristic (5.41) describes properties of tails of distri-
bution, let us consider a couple of examples.
Chapter 1 considers the problem of regression estimation as a problem of
minimizing of the risk functional with the loss function
Q(z, a) = (y - [(x, 0'))2.
Suppose that the distribution on the space z = y, x is such that for any fixed
a E A the quantity ta = y - [(x, a) has normal distribution N(p..a, a~) (for
parameters of distribution depend on a).

5.7 PRIOR INFORMATION FOR THE RISK MINIMIZATION PROBLEM
209
Let us estimate (5.41) for p = 2. The quantity TZ is bounded by J3 (inde-
pendent of parameters of distribution)
TZ
Indeed since
the following assertion is true:
TZ
where we have denoted m4 = E(ta - lJ-a)4 and mz = E(ta - IJ-a)z.
If the variable ta is uniformly distributed on (b - aa, b + aa), then taking
into account that
one can analogously show that TZ has a bound:
/ 1 lb+a
V-2
t~dta Is
a b-a
9
TZ = ------ <
-
1 lb+a
Z
-
S·
-2
ta dta
a b-a
Finally, if the distribution of ta is Laplacian (double-exponential), then

(5.42)
210
5 BOUNDS ON THE RISK FOR REAL-VALUED LOSS FUNCTIONS
Therefore Tp describes general properties of distributions as a whole. So
a priori information that T2 < 3 means that any normal distributions, any uni-
form distributions, any Laplacian distribution, and many others (with "well
behaved tails") are admissible.
Definition. We say that a set of nonnegative random variables ~a E A has:
• Distributions with light tails if there exists a pair (p > 2,
Tp < 00) such
that the inequality (5.41) holds true.
• Distributions with heavy tails if there exists a pair (p > 1,
Tp < 00) and
there is no pair (p > 2,
Tp < 00) such that the inequality (5.41) holds
true.
Observe that if p < q, then
(Liapunov inequality) is valid and consequently
Tp < Tq .
5.8
BOUNDS ON THE RISK FOR SETS OF UNBOUNDED NONNEGATIVE
FUNC1'IONS
Consider the set of nonnegative functions Q(z, a), a E A. Suppose that the
set of functions and the unknown distribution function F(z) arc such that
corresponding distributions of the random variables ~a = Q(z, a) have light
tails. This means that we are given p > 2 and T' such that
tjJQP(z, a) dF(z)
,
~~~ JQ(z, a) dF(z)
= Tp < T
.
[n this case from Eq. (5.42) and the results of Theorem 5.4 for p > 2 one can
immediately conclude that
where
P {
.f Q(z, a) dF(z) - 2:;=1 Q(Zi, a),
'(p)}
~~~
.f Q(z, a)dF(z)
./ T a
8
4
{ [H~n~(2£) _ 8
2
] £}
<
exp
e
4
'
~l (p _l)P-l
a(p)=
-
-
2
p-2
(5.43)

5.8 BOUNDS ON THE RISK FOR SETS OF UNBOUNDED NONNEGATIVE FUNCTIONS
211
Indeed, from the (5.42) we conclude that
1
R
fQ(z,a)dF(z) - eLQ(zj,a)
p
j=1
> T*S
s~p
fQ(z,a)dF(z)
<p
1
f
f Q(z, a)dF(z) - eL
Q(z;, a)
;=1
mp
>S
o
{j f Qp(z, a) dF(z)
The right-hand side of this inequality can be bounded using the results of the
Theorem 5.4.
Suppose now we face the case with heavy tails. This means that we are
given 1 < P ~ 2 and T* such that
if Qp(z, a)
*
sup f Q(
)
= Tp < T .
010.\
Z, a
(5.44)
In this case from Eq. (5.44) and the results of the Theorem 5.4 for the case
1 < P ~ 2, one can analogously derive that
P
sup
oE:A
<P
f
f Q(z, a)dF(z) - L
Q(Zj, a)
f Q(z, a)d);(~)
> T* eVp(e)
1 e
fQ(z,a)dF(z) - eLQ(z;,a)
;-1
sup
-
> eVp(e)
o
if Qp(z, a) dF(z)
< 4 ex
{[H~n~(2g) _ ~] g2(1-ljP)}
P
g2(1-ljp)
21+2jp
,
where
Ins
)P-I
P-vP(P - 1)
Inequalities (5.43) and (5.45) can be rewritten in equivalent form:
(5.45)

212
5 BOUNDS ON THE RISK FOR REAL-VALUED LOSS FUNCTIONS
1. For any p > 2 with probability 1 -
11 simultaneously for all Q(z, a),
a E A, the inequality
I Q(z,a)dF(z) <
1 - r*a(p)J£2(f)
(5.46)
holds, where
if b > 0,
if b SO.
2. For any 1 < p S 2 with probability 1 -
11 simultaneously for all Q(z, a),
a E A, the inequality
/
Q(z, a) dF(z) <
1
l
'- LQ(z;,a)
;=1
(5.47)
hold, where
£ (f) = 21+2jpH~~(U) -In 11
P
f2-2jp
From these inequalities we find that in the case of light tails (p > 2) with
probability 1 -
11 the risk for the function Q(z, a,), which minimizes the
empirical risk, is bounded as follows:
I Q(z, a,) dF(z) <
1 - r*a(p)J£2(f)
(5.48)
(5.49)
I Q(Z,a,)dF(z) <
However, if the tails of distributions are heavy (1 < p ::; 2), then with prob-
ability 1 -
11 the risk is bounded by inequality
1
l
f LQ(zi,al)
;=1
00

5.8 BOUNDS ON THE RISK FOR SETS OF UNBOUNDED NONNEGATIVE FUNCTIONS
213
To get a bound on deviation .1(al), note that for 1 < q :::; 2 the Bahr-Essen
inequality
holds true (see Section 5.7). Taking into account (5.44) and Liapunov in-
equality
{,!EQq(z, a)
{/EQP(z, a)
-------~----'-----'-<
,
EQ(z, a)
-
EQ(z, a)
one obtains for 1 < q :::; 2 and q :::; p
q :::;p,
The equivalent form of this inequality is as follows: With probability at least
1 -
TJ the inequality
is valid.
For the case p > 2 we have that with probability at least 1 -
TJ the
inequality
.1(af) = R(af) _ R(ao) < (Remp(ad - R(ao) + R(ao)Ta(P)~)
1 - ra(p)}c2(f)
DC
is valid. Taking into account (5.50) for q = 2 and inequality
we obtain that with probability at least 1 - 2TJ the inequality
is valid. For the case 1 < p :::; 2, choosing q = p one analogously obtains
.1(a ) < TR(a ) (....!.J_C-,--P-'--(f-,--)V----,p---,(----,cp---,(-=f)=)=+=-2_I/_p
TJ-'---_I/_P_f-_(_I-_I/_p) )
f
-
0
1 - T}cp(f) Vp(cp(f))
00
(5.52)

214
5 BOUNDS ON THE RISK FOR REAL-VALUED lOSS FUNCTIONS
Therefore inequalities (5.48), (5.49), (5.51), and (5.52) describe the gener-
alization ability of the learning machine minimizing empirical risk in a set of
real-valued unbounded functions.
These inequalities contain expression [(f) that depends on the unknown
distribution function.
To obtain distribution-free bounds on the generalization ability, one has
to use instead of the annealed entropy H~~~(i) its upper bound obtained on
the basis of the growth function G~~~(e) or the VC dimension h of a set of
real-valued functions Q(z, a), a E A; that is, in bounds (5.48). (5.49), (5.51),
and (5.52) one has to use instead of [2(i) the expressions
[(f) = 4 a\,B(2i) - In 11/4
2
i'
[
(e) = 4 GA,B(2e) - In 11/4
p
i 2- 2/p
or the expressions
[ (i) = 4h(ln2f/h + 1) -In 11/4
2
f '
[ (e) = 4h(ln2i/h + 1) -In 11/4 .
p
i 2- 2/p
5.9
SAMPLE SELECTION AND THE PROBLEM OF OUTLIERS
This section discusses the idea of sample selection, which is exclusion of
several elements from a given sample to determine using the remaining set.
the function that yields the smallest guaranteed risk.
Note that for the pattern recognition problem the selection of a training
set does not make a big difference: Minimization of the empirical risk over
the entire sample, as well as doing so over a subsample of it obtained by
excluding a minimal number of elements in order that the subsample could
be divided without error, leads to the very same decision rule. This is a
corollary of the fact that the loss function for pattern recognition takes on
only two values 0 and 1. In regression problems, however, the loss function
Q(z, a) takes an arbitrary positive values, and therefore an exclusion of some
element z may substantially change the solution as well as the estimate of
the quality of the obtained solution.
Let a sample
Zj, ... , Zf
(5.53)

5.9 SAMPLE SElECTION AND THE PROBLEM OF OUTLIERS
215
be given. Consider the following
I
H(t, l) = 2: C;'
m=O
different problems of estimating the functional dependences based on empir-
ical data
A
A
Zl, ... , Zj, ... , Zh ... , Zf·
The notation Zj indicates that the element Zj has been excluded from (5.53).
The problems differ from each other only in that for each of them the func-
tional dependence is estimated from its own sample obtained from (5.53) by
excluding at most t elements. (One can construct from (5.53) C;71 different
subsamples consisting of l - m examples. Thus altogether there are H(t, f)
different problems.)
According to the bound (5.46) for each of the H(t, l) problems with prob-
ability 1 -
11 simultaneously for all a E A the inequality
R(a) <
1
f -Ik
-0-
~ Q(Zj, a)
(; -
tk L.J
j=l
holds, where tk is the number of vectors excluded from the training data for
the kth problem. Consequently, the inequalities
are valid with probability 1 -
11 simultaneously for all functions Q(z, a),
a E A, in all H(t,l) problems. Using this bound one can search for the min-
imum of the right-hand side over all H (t, l) problems.
In the last formula one can use the bound on H (t, l) derived in Chapter
4, Section 4.11:
InH(t,l) ~ t (Inf+1).
Thus, in searching for the best guaranteed solutions using empirical risk min-
imization method, one can try to exclude some subset of training data to
obtain the best bound.
The excluded data (which cause a decrease in the guaranteed minimum
of risk) can be called outliers.

216
5 BOUNDS ON THE RISK FOR REAL-VALUED LOSS FUNCriONS
5.10
THE MAIN RESULTS OF THE THEORY OF BOUNDS
In this chapter we obtained the main bounds describing the generalization
ability of the learning machines.
To obtain these bounds we introduced several general (which are valid for
any set of functions) concepts of capacity.
We showed that one has to distinguish between two different cases of the
problem of risk minimization from empirical data: the case where the admis-
sible set of functions is a set of totally bounded functions (we considered the
case O:=:; Q(z, a) :=:; B, a E A) and the case where the admissible set contains
unbounded functions.
In the first case one obtains the same type of bounds as in pattern recog-
nition: namely, with probability at least 1 -
71 the bound
BE(l) ( J
4Remp(ad)
R(aR) < Remp(aR) + -2-
1 +
1 +
BE(f)
is valid and with probability at least 1 - 271 the bound
BE(l) ( J
4Remp(aR»)
pn;J
d(aR) :=:; Remp(a) + -2-
1+
1 +
BE(l)
+ Y~-l-
is valid, where E(l) to within a small value is ratio of capacity function over
number of observations
E(l):::::::
capacity characteristic.
l
(5.54)
In (5.54) one can use any capacity function determined in this chapter.
In the second case we obtained bounds for nonnegative loss functions
using a priori information about the tails of distributions that concentrate in
the pairt (p > 1, and Tp ):
{jEQP(z, a)
sup
:=:; Tp .
a,Z
EQ(z, a)
Knowing the value Tp , we derived that with probability at least 1 -
71 the
inequality
R
< (
Remp(al)
)
(aR) -
1 - m(p)JE2(l)
00'
</1 (p -1)P-1
a(p)=
-
-
2
p-2
t Here we consider the case p > 2 only to simplify formulas.

5.10 THE MAIN RESULTS OF THE THEORY OF BOUNDS
217
is valid and with probability at least 1 - 2Tl the inequality
is valid, where £(f) is determined by expression of type (5.54).
Expression (5.54) is one of the most important points of the theory. In the
extreme case when one knows the probability measure F(z) and can evaluate
the annealed entropy, one obtains the distribution-specific bounds using
£(e) = 4 H~~~(2f) -In Tl/4
f
.
In another extreme case when no a priori information is found about the
probability measure, the distribution-free bounds are determined on the basis
of the growth function GA,B(f) of a set of real-valued functions Q(Z,a),
a E A:
GA,B(2£) - In Tl/4
£(£) = 4
£
.
To obtain constructive distribution-free bounds we found the upper bound
for the growth function using the VC dimension conceptt:
£( 0) < 41n 2£/h + 1
-In Tl/4
(;
-
f/h
+
£
.
Moreover, the theory shows a clear way how to construct rigorous distribu-
tion-dependent bounds. To get nonconstructive rigorous bounds, one has to
use the expression
with the generalized growth function
MA,B(£) = sup In EpNA,B(Zl' ..., zp).
PEP
To make the bounds constructive, one has to find a way to obtain the bound
for the generalized growth function that is better than one based on the VC
dimension.
t It is remarkable that to within a small value this functional form depends on the ratio f /h of
the number of observations over the VC dimension of the set of functions.


6
THE STRUCTURAL RISK
MINIMIZATION PRINCIPLE
This chapter addresses methods for controlling the generalization ability of
learning machines that use small size samples of training instances.
We consider the sample of size e to be small if the ratio e/h (ratio of the
number of the training patterns to the VC dimension of the set of functions
of the learning machines) is small, say ejh < 20.
The induction principle for learning from samples of small size, the so-
called Structural Risk Minimization (SRM) principle is introduced first. In
contrast to the Empirical Risk Minimization principle, which suggests that
we should minimize the empirical risk at any cost, this principle looks for
the optimal relationship between the amount of empirical data, the quality
of approximation of the data by the function chosen from a given set of
functions, and the value that characterizes capacity of a set of functions. The
SRM principle finds the function that for the fixed amount of data achieves
the minimum of the guaranteed risk.
In the case of the pattern recognition problem, we compare the SRM
principle to another small sample size induction principle, namely, the so-
called Minimum Description Length (MDL) principle.
Then we show that the SRM method is always consistent and we derive a
bound on the asymptotic rate of convergence.
At the end of the chapter we consider the problem of minimizing the
Local Risk Functional, whose solution is based on the SRM principle.
6.1
THE SCHEME OF THE STRUCTURAL RISK MINIMIZATION
INDUCTION PRINCIPLE
In the last two chapters we obtained the bounds on the risk which are valid
simultaneously for all functions in a given set of functions.
219

220
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
We proved that with probability at least 1 -
71 simultaneously for all func-
tions from the set of totally bounded functions 0 :s; Q(z, a) :s; B, a E A, with
finite VC dimension h the (additive) inequality
R()
R
()
Bt:(f) (1 }1
4Remp(a))
a
:s;
emp a +
2
+
+
Bt:(f)
(6.1 )
holds true,t where
(6.2)
(6.3)
p>2
We proved also that if a pair (P, r) exists such that for all functions from
the set of nonnegative (not necessarily bounded) functions Q(z, a), a E A,
with the VC dimension h the inequality
ijEQP(x, a)
---'------'----'- < r,
EQ(z, a)
-
holds true (the corresponding set of random variables contains only light
tails), then with probability at least 1 -
71 simultaneously for all functions
Q(z, a), a E A, the (multiplicative) inequality
R(a) :s;
a(p)
(
Remp(a)
)
1 - a(p)rJl(l)
00'
</! (~)P-l,
2
p-2
(6.4)
holds.t
Now using these inequalities we would like to control the process of min-
imizing the risk functional on the basis of fixed amount of empirical data.
The simplest way to control this process is to minimize the value of em-
pirical risk. According to inequalities (6.1) and (6.4) the upper bound on the
risk decreases with decreasing the value of empirical risk. This is the reason
why the principle of empirical risk minimization often gives good results for
large sample size. If it happens that f / h is large, then the value of actual risk
is determined by the value of empirical risk. Therefore to minimize actual
risk one minimizes the empirical risk.
However, if f/h is small, a small value of empirical risk Remp(at) does not
guarantee a small value of the acLual risk. In this case, Lo minimize Lhe acLual
risk R(a) one has to minimize the right-hand side of inequality (6.1) (or (6.4))
tTo control the generalization ability of learning machines we need constructive bounds on the
risk. Therefore in this chapter we will use distribution free constructive bounds.
I Here only for simplicity of notation we consider the case p > 2. The case 1 < p ::; 2 can be
considered as well.

6.1 THE SCHEME OF THE STRUCTURAL RISK MINIMIZATION INDUCTION PRINCIPLE
221
simultaneously over both terms. Note that the first term in inequality (6.1)
depends on a specific function of the set of functions, while for a fixed number
of observations the second term depends mainly on the VC dimension of the
whole set of functions.
Therefore to minimize the right-hand side of the bound of risk, (6.1) (or
(6.4)), simultaneously over both terms, one has to make the VC dimension
a controlling variable.
To do this we consider the following scheme.
6.1 .1
Principle of Structural Risk Minimization
Let us impose the structure S on the set S of functions Q(z, a), a E A, with
a structure S. Consider the set of nested subsets of functions (Fig. 6.1)
(6.5)
where Sk = {Q(z, a): a E Ad, and
Consider admissible structures-the structures that satisfy the following
properties:
1. Any element Sk of structure S has a finite VC dimension hk.
2. Any element Sk of the structure (6.5) contains either
(i) a set of totally bounded functions
(ii) or a set of nonnegative functions Q(z, a), a E Ak , satisfying the
inequality
vEQP(z, a)
sup
EQ(
)
~ Tk < 00.
aEAk
Z,a
(6.6)
-------
/~--~
/
I,
\
""- ..... ------
"-
\
Sn
I
I
/
'"
FIGURE 6.1. A structure on the set of functions is determined by the nested subsets of
functions.

222
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
3. The set S' is everywhere dense in the set S in the L 1(F) metrict where
F = F(z) is the distribution function from which examples are drawn.
Note that in view of (6.5) the following assertions are true:
1.
The sequence of values of VC dimensions hk for the elements Sk of
the structure S is nondecreasing with increasing k
hi :S h2 :S ... < hn :S ....
2a. The sequence of values of the bounds Bk for the elements Sk of the
structure S is nondecreasing with increasing k:
(6.7)
2b. The sequence of values of the bounds Tk for the elements Sk of the
structure S is nondecreasing with increasing k
Denote by Q(z, a;) the function that minimizes the empirical risk in the
set of functions Sk' Then with probability 1 -
1] one can assert that the actual
risk for this function is bounded as
(6.8)
or as
(6.9)
where
(6.10)
t We will need this property for asymptotic analysis of SRM principle. when structure contains
an infinite number of elements.
The set S* is everywhere dense in the set S in L( (F) metric if for any 8 > 0 and any function
Q(z. (1) E S there exists a function Q(z. (1*) E S* such that
p(Q(z.a).Q(z.a*»
= jIQ(z,a) - Q(z,a*)ldF(z) < 8.

6.1 THE SCHEME OF THE STRUCTURAL RISK MINIMIZATION INDUCTION PRINCIPLE
223
Bound on the risk
Confidence interval
Empirical risk
h
FIGURE 6.2. The bound on the risk is the sum of the empirical risk and of the confidence
interval. The empirical risk is decreased with the index of element of the structure, while
the confidence interval is increased. The smallest bound of the risk is achieved on some
appropriate element of the structure.
For a given set of observations Zl, ... , Zf the SRM method chooses the element
Sk of the structure for which the smallest bound on the risk (the smallest
guaranteed risk) is achieved.
Therefore the idea of the structural risk minimization induction principle
is the following:
To provide the given set of functions with an admissible structure and then
to find the function that minimizes guaranteed risk (6.8) (or (6.9)) over
given elements of the structure.
To stress the importance of choosing the element of the structure that pos-
sesses an appropriate capacity, we call this principle the principle of structural
risk minimization. It describes a general model of capacity control. To find
the guaranteed risk, one has to use bounds on the actual risk. As shown in
previous chapters, all of them have to contain information about the capacity
of the element of the structure to which the chosen function belongs. [n this
chapter, we will use the bounds (6.8) or (6.9).
Section 6.3 shows that the SRM principle is always consistent and defines
a bound on the rate of convergence. However, we must first descrihe the
Minimum Description Length principle and point out its connection to the
SRM principle for pattern recognition problem.

224
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
6.2
MINIMUM DESCRIPTION LENGTH AND STRUCTURAL RISK
MINIMIZA1'ION INDUCTIVE PRINCIPLES
6.2.1
The Idea About the Nature of Random Phenomena
In the 1930s Kolmogorov introduced the axioms of probability theory. Sub-
sequently, probability theory became a purely mathematical (i.e., deductive)
science. This means that developing the theory became the result of formal
inference, based on some rules of inference. Axiomatization of the theory,
however, removed from consideration a very important question, namely, one
about the nature of randomness. The theory of probability does not answer
the question, What is randomness? It simply ignores it by using the axioms
about given probability measures (see Chapter 2). Nevertheless, the question
remains and needs to be answered.
Thirty years after axiomatization of the probability theory Solomonoff
(1960), Kolmogorov (1965) and Chaitin (1966) suggested the model of ran-
domness. This model was constructed on the basis of a new concept, the
so-called algorithmic (descriptive) complexity.
The algorithmic complexity on the object is defined to be the length of the
shortest binary computer program that describes this object. It was proved
that the value of algorithmic complexity up to an additive constant does not
depend on the type of computer. Therefore it is a universal characteristic of
the object.
Now one can compare the given length of object description with its algo-
rithmic complexity. The main idea is as follows:
To consider a relatively large string describing an object to be random if
algorithmic complexity of an object is high-that is, if the given descrip-
tion of an object cannot be compressed significantly.
Shortly after the concept of algorithmic complexity was introduced, first
Wallace and Boulton (1968) and then Rissanen (1978) suggested that we use
the concept of algorithmic complexity as a main tool of induction inference
of learning machines; they suggest an induction principle that was called the
Minimum Message Length (MML) principle by Wallace and Boulton, and
the Minimum Description Length (MOL) principle by Rissanen.
6.2.2
Minimum Description Length Principle for the Pattern
Recognition Problem
Suppose we are given training data. That is, we are given f pairs containing
the vector x and the binary value w
(6.11)

6.2 MINIMUM DESCRIPTION LENGTH INDUCTIVE PRINCIPLE
225
(pairs drawn randomly and independently according to some probability mea-
sure). Consider two strings: the binary string
and the string of vectors
WI, ...,w,
XI, ...,x,.
(6.12)
(6.13)
The question is, Given (6.13), is the string (6.12) a random object? To answer
this question let us analyze the complexity of the string (6.12) in the spirit of
Solomonoff-Kolmogorov-Chaitin ideas. Since Wi i = 1, ..., f are binary val-
ues, the string (6.12) is described by f bits.
To determine the complexity of this string, let us try to compress its de-
scription. Since training pairs were drawn randomly and independently, the
value Wi may depend only on the vector Xi but not on the vector Xj, i i= j
(of course, only if the dependency exists).
Consider the following model: We are given a fixed code book Ch with
N << 2' different tables Ti , i = 1, ...,N. Any table Ti describes some func-
tiont from X to w.
Try to find in the code book Cb the table T that describes the string (6.12)
in the best possible way; namely, the table on which the given string (6.13)
returns the binary string
(6.14)
such that the Hamming distance between strings (6.12) and (6.14) is minimal
(the number of errors in decoding (6.12) by this table T is minimal).
Suppose we have found a perfect table To for which the Hamming distance
between (6.14) and (6.12) is zero.
This table decodes the string (6.12).
Since the code book Cb is fixed, to describe the string (6.12) it is enough
to specify the number 0 of table To in the code book. If there is no a priori
information about the desired table, then the minimal number of bits needed
to decode the number of one of the N tables is 1I0gz Nl, where IAl is the
minimal integer no less than A. Therefore in this case to describe (6.12) we
need 1I0gz Nl bits, rather than f. Thus, using a code book with a perfect
decoding table, we compress the description length of string (6.12)
(6.15)
times. Let us call K(T) the coefficient of compression in the description of
the string (6.12).
t Formally speaking, to have the finite tables in the code book, the input vector x has to be
discrete. However, as we will see, the number of levels of quantization will not affect the bounds
on risk. Therefore one can consider any degree of quantization, even the tables with infinite
number of entries.

226
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
Now consider the general case: Code book eb does not contain the per-
fect table. Let the smallest Hamming distance between strings (obtained and
desired) be d ~ O. Without loss of generality one can assume d < e/2. Other-
wise, instead of the smallest distance, one will look for the largest Hamming
distance and during decoding change 1 to 0 and vice versa. This will cost one
extra bit in the coding scheme.
For fixed d there are e1 different possible corrections to the string of
Icngth f. To spccify onc of thcm (i.e., to specify a number of one of the e1
variants) one needs rlog2 efl bits.
Therefore to describe string (6.12) we need rlog2 Nl bits to describe the
number of the table and we need rlog2 e;'l bits to describe the number of
correction variant. All together we need rlog2 Nl + pog2 en bits for describ-
ing (6.12). If d is unknown, we need additional A bits to define it. In this case
our description contains
bits information. This number should be compared to f, the number of bits in
the description of the string (6.11). Therefore the coefficient of compression
is
(
rlog2 Nl + pog2 ell + d
K T) =
f
.
(6.16)
If the coefficient of compression K(T) (or Ko(T)) is small, then according
to the Solomonoff-Kolmogorov-Chaitin idea the string is not random and
somehow depends on the input vectors x. The decoding table T somehow
approximates the unknown functional relation between x and w.
6.2.3
Bounds for the Minimum Description Length Principle
The question is, Does the compression coefficient K(T) determine the prob-
ability of the test error in classification (decoding) vectors x by the table T?
The answer is yes.
To prove this, compare the result obtained for the MOL principle to the
result obtained for ERM principle in the simplest model.
In Chapter 4 Section 4.3 we obtained the bound that if a set of functions
contains N elements then with probahility at least 1 -
Tl the inequality
(6.17)
holds true simultaneously for all N functions in the given set of functions
(for all N tables in the given code book). Let us transform the right-hand
side of this inequality using concept of compression coefficient and the fact

6.2 MINIMUM DESCRIPTION LENGTH INDUCTIVE PRINCIPLE
227
that
d
Remp(T;) = (.
Note that for d ~ R/2, R > 6, and A ~ 0 the inequality
~ + InN -In 1] (1 + /1 + __2_d__ )
R
f
V
In N - In 1]
< 2( rln Nl + r;nen +A_l~~)
(6.18)
is valid (one can easily check it). Now rewrite the right-hand side of (6.17)
in terms of the compression coefficient (6.16)
21n2 ClOg, Nl + ~Og2en + A _ IO~2 ~) ~ 2 (In2K(T) _ l~~) .
Since inequality (6.17) holds true with probability at least 1 -
1] and inequal-
ity (6.18) holds with probability 1, then the inequality
(
In 1])
R(T;) < 2
In2K(Ti ) - -£-
holds with probability at least 1 -
1].
(6.19)
6.2.4
Structural Risk Minimization for the Simplest Model and
Minimum Description Length Principle
Now suppose that we arc given M << 2£ code books that make up a struc-
ture: code book 1 contains a small number of tables, code book 2 contains
these tables and some additional tables, and so on.
Now describe the string (6.12) using a more sophisticated decoding scheme:
First describe the number m of the code book and then using this code book
describe the string (as we showed above it takes rlog2 Nm1+ pog2 Cfl bits,
where N m is the number of tables in the mth code book).
The total length of description in this case is no less than rlog} N m1+
rlog2 en and the compression coefficient is not less than
For this case the inequality (6.18) holds. Therefore the probability of error
for the table which was used for compressing the description of string (6.12)
is bounded by (6.19).

228
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
Thus we have proven the following theorem.
Theorem 6.1. If on the given structure of code books one compresses K(T)
times the description ofstring (6.12) using a table T, then for £ > 6 and d < £/2
with probability at least 1 -
11 one can assert that the probability of committing
an error by the table T is bounded as follows:
R(T) < 2 (IOg2K(T) _ In ~/m) .
(6.20)
Note how powerful the concept of compression coefficient is: To obtain
bound for the probability of error we actually need only information about
this coefficient.t We are not interested in such details as:
How many examples we used.
How the structure of code books was organized.
Which code book was used and how many tables were in this code book.
How many errors were made by the table from the code book we used.
Nevertheless, the value of bound (6.20) does not exceed very much the value
of the bound of the risk (6.17) obtained on the basis of the theory of uniform
convergence, which has a more sophisticated structure and which uses infor-
mation about the number of functions (tables) in the sets, number of errors
in the training set, and number of elements of the training set.
Note also that within a factor of 2 the bound (6.20) cannot be improved:
In the case when a perfect table exists in the code book, equality can be
achieved with the factor of 1.
This theorem justifies the MDL principle: To minimize the probability of
error one has to minimize the coefficient of compression.
6.2.5
The Shortcoming of the Minimum Description Length
Principle
There exists, however, a shortcoming of the MDL principle. Recall that the
MDL method uses code books with a finite number of tables. Therefore, in
order to deal with a set of functions that continuously depends on parameters,
one has to first quantize that set to make the tables.
Quantization can be done in many ways. The problem is, How do we make
the "smart" quantization for a given number of observations? For a given set
of functions, how can we construct a code book with a small number of tables
but with good approximation ability?
'For not very large M (say M < lk, k«
log2Nm) the second term (InM -lnl1)/l on the
right-hand side is actually foolproof; For reasonable 11 and e, it is small compared to the first
term, but it prevents us from considering too small 11 or/and too small e.

6.3 CONSISTENCY OF THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
229
A good quantization essentially can reduce the number of tables in the
code book, effecting the compression coefficient. Unfortunately, finding a
good quantization is extremely difficult and determines the main shortcoming
of MDL principle.
Chapter 10 constructs a set of linear functions in very high-dimensional
space (experiments described in Chapter 12, use linear functions in N '" 1013_
dimensional space) that has low VC dimension (in these experiments, h '"
102 - 103). One can guarantee that if a function from this set separates a
training set of size f without error, then the probability of test error is pro-
portional to h In f / f.
The problem for the MDL approach to this set of indicator functions is,
How do we construct code books with,....., fh tables (but not with", fN tables)
that approximate this set of linear functions well?
The MDL principle works well when the problem of constructing reason-
able code books has a good solution.
6.3
CONSISTENCY OF THE STRUCTURAL RISK MINIMIZATION
PRINCIPLE AND ASYMPTOTIC BOUNDS ON THE RATE OF
CONVERGENCE
Let us continue the study of the SRM principle. In this section we analyze
asymptotic properties of the SRM principle. Here we answer two questions:
1. Is the Structural Risk Minimization principle consistent? (Do the risks
for the functions chosen according to this principle converge to the
smallest possible risk for the set 5 with increasing amount of observa-
tions?)
2. What is the bound on the (asymptotic) rate of convergence?
Let 5 be a set of functions and let S be an admissible structure. Consider
now the case where the structure contains an infinite number of elements.
Note that in this case in spite of the fact that any element 5k of the structure
is characterized by a finite VC dimension hk and a finite value Bk (finite
value rd, the set of functions
can possess infinite VC dimension and/or infinite Bk (infinite 7"k)'
We denote by Q(z, a;), k = 1, ...., the function which minimizes the empir-
ical risk over the functions in the set 5k and denote by Q(z, a(~) the function
which minimizes the expected risk over the functions in the set 5k : we denote

230
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
also by Q(z, crv) the function which minimizes the expected risk over the set
of functions S.
In the following text, we prove the consistency of the SRM principle.
However, first we show that there are rules for choosing the appropriate
element S" of the structure depending on the number of observations f
n = n(f)
that provide risk convergence for chosen decision rules to the smallest pos-
sible risk.
For asymptotic results the refined bounds (6.8) are not very important.
Therefore to simplify the exposition, consider instead of bound (6.8) the
bound
Vhdlnf+l)-lnTl/4
R(a) ~ Remp(a) + Bk
f
that was obtained in Chapter 5, Section 5.3 for the pessimistic case.
Consider the a priori rule
n = n(f)
(6.21 )
for choosing the number of element of the structure depending on the number
of given examples.
Theorem 6.2. The rule n = n(f) provides approximations Q(z, a7([)
for
which the sequence of risks R(a;(f)
converges, as f tends to infinity, to the
smallest risk:
R(ao) = inf /
Q(z, a) dP(z)
aEA
with asymptotic rate of convergence
V(f) = rn([) +
where
(6.22)
rfl(t) = f Q(z,a;;(f)dP(z) - f Q(z,ao)dP(z),
(that is, the equality
(6.23)

6.3 CONSISTENCY OF THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
231
holds true), if
where
D~(f)hn(f) In £
---'--'---- -----t 0,
£
£->00
neE) -----t 00,
f ->x
(6.24)
• D n = Bn ifone considers a structure with totally bounded functions Q(z, a) S
Bn in Sn and
• Dn = Tn if one considers a structure with elements satisfying inequality
(6.6).
The quantities
rn(f) = /Q(z,a(~(f))dP(Z) - inf /Q(Z,a)dP(Z)
aEA
describe the difference in risks between the smallest risk for a function from
the element Sn(1') of the structure S and the smallest risk over the entire set
of functions.
The next theorem is devoted to asymptotic properties of the structural risk
minimization principle. It shows that if the SRM method uses a structure of
elements that contains a totally bounded set of functions (see Section 1.1)
then it is strongly universally consistent (that is, for any distribution function
it provides convergence to the best possible solution with probability one).
To avoid choosing the minimum of functional (6.21) over the infinite num-
ber of elements of the structure, we introduce one additional constraint on
the SRM method: We will choose the minimum from the first £ elements.
of the structure where £ is equal to the number of observations. Therefore
we approximate the solution by function Q(z, an, which among £ functions
Q(z,af),k = 1, ...,£, minimizing empirical risk on corresponding elements
Sk, k = 1, ..., €, of the structure provide the smallest guaranteed (with proha-
bi lity 1 - 1/€) risk:
R;mp(an = min [~t Q(z;, an + Bk
l<k<f
(.
-
-
;=1
hkCln2f /k + 1) + In4£ ]
f
.
The following theorem is an adaptation of the Lugosi-Zeger theorem for the
set of not necessary indicator functions.
Theorem 6.3 (Lugosi, Zeger). If the structure is such that B~ ~ n l - 8, then for
any distribution function the SRM method provides convergence to the best
possible solution with probability one (i.e., the SRM method is universally
strongly consistent).

232
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
Moreover, ifthe optimal solution Q(z, ao) belongs to some element S., ofthe
structure (Q(z, ao) = Q(z, a~)) and B~(f) S j.L(£) S £1-0, then using the SRM
method one achieves the following asymptotic rate of convergence:
V(l) = 0 (JJL(£~ln£) .
Remark. For the sets of indicator functions one chooses Bn = 1 for all n. In
this case
j.L(£) = 1.
6.3.1
Proof of the Theorems
Proof of Theorem 6.2. We prove the theorem for the case Dn = Bn . The
proof for the case D n = Tn is analogous.
Consider a structure with elements Sk containing totally bounded functions
with the finite VC dimension. As shown in Section 5.3, for any element Sk
with probability at least 1 - 2/£2 the additive bound
hk (In~+l) +2In2£
£
(6.25)
is valid. Then with probability 1 - 2/£2 the inequality
hn(f) (In h2£
+ 1) + 21n 2£
n(f)
(6.26)
holds, where
Since S' = Uk Sk everywhere dense in S, we have
lim rl/(!) = O.
f ->'Xj

6.3 CONSISTENCY OF THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
233
Therefore the condition
determines convergence to zero. Denote
hn(€) (In h2£ +1) + 21n4£
n(E)
Let us rewrite the assertion (6.26) in the form
Since
:>0
ex
2
LP{V-I(£)(R(a;(f)) - R(ao)) > 1} < £0 + L
£2 < 00
(=1
(=(0+1
according to the corollary from the Borel-Cantelli lemma (see Chapter 1,
Section 1.11), one can assert that the inequality
lim V-I (£)(R(a;(()
- R(ao)) :::; 1
( -+CX)
is valid with probability one.
Proof of Theorem 6.3. Denote by a; the parameter that minimizes guaran-
teed resk R;mp(a) using £ observations. Consider the decomposition
For the first term of this decomposition we have

234
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
where we take into account that B; ~ £1-0. Using the Borel-Cantelli lemma
we obtain that first summand of the decomposition converges almost surely
to the nonpositive value,
Now consider the second term of the decomposition. Since S' is dense
everywhere in S, for every ethere exists an element Sf of the structure such
that
R(a~) - R(ao) < e.
Therefore we will prove that the second term in the decomposition does not
exceed zero if we show that with probability one
lim min R;mp(an - R(ao) ~ 0
f-J<.!I<:k,£f
Note that for any e there exists £0 such that for all £ > £0
B~
h~ (In 2£1h s + 1) + 4 In £ < ~
e
- 2'
(6.27)
For e> £0 we have
P { min R;mp(a;) - R(a~) > e} ~ P {R;mp(a;) - R(a~) > e}
I,£k,££
_ P {R
(') - R(
S)
_ B
h,(In2P/h, + 1) + In4f}
-
emp at
a o > e
s
£
~ P {Remp(atJ) - R(an > ~} ~ P {sup IR(a) - Remp(a)1 > ~}
aE.\,
< (2e£)h'exp{_e2~}~ (2e£)h'eXp{_e2£8}.
hs
4B,
hs
4
Again applying the Borel-Cantelli lemma one concludes that second term of
the decomposition converges almost surely to a nonpositive value. Since the
sum of two terms is nonnegative, we obtain almost sure convergence R(a+)
to R(ao). This proves the first part of the theorem.
To prove the second part, note that when the optimal solution belongs to
one of lhe elements of the structure Ss the equality
holds true. Combining bounds for both terms, one obtains that for £ satisfying
(6.27) the following inequalities are valid:

6.3 CONSISTENCY OF THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
235
From this inequality we obtain the rate of convergence:
6.3.2
Discussions and Example
Thus, generally to estimate the asymptotic rate of convergence (6.22), one
has to estimate two summands. The first summand
rn(f) =
inf
!Q(Z,a)dP(z) - inf !Q(z,a)dP(Z)
aElI.n1f)
aEA
determines the rate of approximation-that is, the value of the deviation of
the risk for the best approximation in 5n from the smallest possible risk (the
larger n = n(f) the smaller is the deviation). The second summand
determines the stochastic deviation of the risk obtained from the smallest
risk in 5n :
~n(l») = !Q(z,a;(f))dP(Z) --
inf. !Q(Z,a)dP(Z)
aEAnffi
(the larger n = n(£), the larger deviation d n(£)). Therefore the rate of conver-
gence is determined by two contradictory requirements on the rule n = n(£).
For structures with a known bound on the rate of approximation, select the
rule that assures the largest rate of convergence.
Section 6.5 discusses classical problems of function approximation. And
shows that a good rate of approximation is possible only for special sets of
functions (say for smooth functions). This fact is the main reason why in the
general case the asymptotic rate of convergence for SRM can be slow.
However, in the particular case where the desired solution belongs to
the element of the structure, the asymptotic rate of approximation is almost
optimal
for the pattern recognition case, and it is arbitrarily close to this rate for
estimating real-valued functions if one uses a structure with slowly increasing

236
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
bounds B~(f) = /L(£) (see Theorems 6.2 and 6.3):
The following is an example of density estimation where the maximum
likelihood method is not consistent but at the same time the method based
on the SRM principle is consistent and has a high asymptotic rate of conver-
gence.
Example. Let us consider a mixture of two normal laws
p(z;a, u) = 1N(a, u) + 1N(0, 1),
a E (-00,00), u E (0,00),
(6.28)
where parameters a and u of the first term of the law are unknown.
First we show that the maximum likelihood is not consistent for estimating
these parameters from the sample
Zl, ... , Ze,· .. ·
Indeed for any A and any £, one can choose parameters a" and u" such
that
(
Llnp(z;;a",u") > A.
i=l
This can be done, for example, by choosing a = Zl and u sufficiently small.
For these parameters we have
f
L
Inp(Zi;a", u)
;=1
e
(
{
2}
{
)2})
1
z·
1
Zi-ZI
= £ In 2v121i + ~ In
exp -2
+ u exp
- ( 2u2
1
(1)
e
Z2
> £ In-- + In
1+ -
- L
-!.. --t 00.
2v121i
u.
2
a-+O
1=2
Thus the maximum likelihood does not yield the estimate of the desired
parameters in the space (a, u).
Now let us use the structural risk minimization principle to modify the
maximum likelihood method. We introduce the structure on the set of func-
tions (6.28) and then minimize the guarantee risk over the elements of this
structure.

6.4 BOUNDS FOR THE REGRESSION ESTIMATION PROBLEM
237
To construct a structure, consider the sequence of positive values
bl > b2 > ... > bn > ... ,
where
bn = e-VIJ-(n).
We define the following element Sk of the structure:
Sk={lnp(z,a,rr): aE(-oo,oo),
rr~bd.
(6.29)
These elements form sets of nested subsets. They satisfy all conditions to be
an admissible structure: The VC dimension of any element of the structure
does not exceed the finite VC dimension h of the set (6.28); all functions
from the element Sn are bounded by the constant
the solution belongs to one of the elements of the structure.
Therefore for n(1!) = £ we have the following rate:
.
(J.L(£)lnt')-1/2 j
p(z,a!)
hm
()
p(z,ao)ln
(
) dz < 00,
f
->:>0
{.
p z, ao
which is the convergence (in the Kulbak-Leibler metric) of the SRM esti-
mates to the desired function with the asymptotic rate close to Jln£/e for
slowly increasing function /-L(e).
6.4
BOUNDS FOR THE REGRESSION ESTIMATION PROBLEM
In the previous section, we obtained bounds on the rate of convergence for
the SRM principle. They have the order of magnitude
(
~)
V(I!) = 0
rn(f) + Dn(f)V~
,
(6.30)
where D n = Bn if the elements of the structure contain totally bounded func-
tions and D n =
7"11 if the elements of structure contain unbounded functions.
This section considers an important special case; that is, we consider a
model of regression estimation by series expansion using observations with
additive noise. For this model we will obtain significantly better bounds.
Under certain conditions it has the order of magnitude
(
hn(f) In£)
VCR) = 0
rn(e) +
£
.

238
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
6.4.1
The Model of Regression Estimation by Series Expansion
Let us specify the model. We consider a problem of estimating a regression
function f(x, ao) E L 2(F), x E Rd , where for any random vector x/ one has
the measurement of the regression function f(x, ao) with additive noise f
Eg = 0,
(6.31)
The problem is to estimate the regression function, using i.i.d. observations
(here the Xi are random vectors, drawn according to the distribution function
F(x)).
We define the structure 5 using a set of complete orthonormal (with re-
spect to probability measure F(x)) functions t/Jdx), k = 1,2, .... The element
Sk of this structure contains the functions of the form
k
fi.:(x, a) = L a,t/J,(x).
r=)
Let the regression be described by the expansion in the series
~
f(x. ao) = L a2t/Jdx ),
k~1
with an infinite number of terms.
We assume that the regression function has no singularities on this struc-
ture. This means that for all p the inequalities
hold true.
Let us denote
s~p If
a:1t/Ji(X)I ~ c
l~p+1
(6..32 )
(6.33)
As in Chapter
functional
we determine the quality of approximation by the
R(a) = ! (y - f(x, a))2 dF(x,y).

6.4 BOUNDS FOR THE REGRESSION ESTIMATION PROBLEM
239
Let f(x, an be the function that minimizes the empirical risk
1
f
2
Remp(a) = pL (Yi - [(Xi, a))
i=\
on the set of functions 5" and let
n = n(£)
be a rule for choosing the element of the structure 5/l depending on the
number of examples. In this section we estimate the rate of convergence to
zero of the quantities R(an - R(ao). Taking (6.31) into account we ohtain
R(a;) - R(ao) = I (f(x, aF) - f(x , ao))2 dF(x).
The following theorem holds true.
Theorem 6.4. Let the model ofregression estimation with additive noise satisfy
the conditions (6.32) and (6.33). Then for any £ and for any rule n = n(£) the
5RM principle provides the bound
P { Y-\(£)(R(an - R(ao)) :::; I} 2': 1 -
I~£'
(6.34)
where
nln£
2
2
Y(£)=r,,+
2(lT +c),
£ (1- JD/lC/l(£))+
and
r" = R(a3) - R(ao) =I([(x, a[;) - f(x, ao))2 dF(x).
Corollary. If the rule n = n(£) satisfies the condition
_D_".o....Cf,-)n---,-(£--'.)_I_n_£ ~ C < 1
f
f-.CXJ
then the asymptotic rate of convergence has the order of magnitude
Y (Ii) _ 0 (
n(£) In £)
(.
-
rnCf) +
£
.
(6.35)
(6.36)
(6.37)
(6.38)

240
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
Note that the asymptotic bound (6.38) for this model is much better than
the bound (6.30) for the general case.
Example. Let us estimate the regression function f(x, ao) which is a periodic
function and has p > 0 bounded derivatives, defined on the interval (0,1T).
Let F(x) be the uniform distribution on the interval (0, 1T).
Consider the structure defined by the orthonormal series cos kx, k = 1, ...,
where element SI! contains the functions
(
fl!(x, a) = L ak cos kx.
k=J
Since for a function that has p > 0 bounded derivatives the inequality
supL a2 cos kx 'S L la21 < 00
x
k=\
k=l
holds, the nonsingularity condition (6.32) is satisfied.
For a given structure, one can easily find the bound
(
I!
)2
Dn =
sup sup L ak cos kx
<
x
Illt=l k=\
Therefore according to Theorem 6.4 if a rule n = n(£) for choosing the ele-
ments of the structure satisfies the condition
n2(f) In f
---+ 0
£
(---+X
(condition (A)),
then the following asymptotic rate of convergence for the obtained risk to
the best possible holds true:
V(f) = rn + n(£~ln£.
In the next section we describe the classical function approximation
theorems according to which the rate of approximation by trigonometric
series of risk functions that possess p derivatives has a risk
Therefore

6.4 BOUNDS FOR THE REGRESSION ESTIMATION PROBLEM
241
One can easily verify that the rule
= (~) 1/(2p+l)
n
lnf
provides the best rate of convergence (this rule satisfies the condition (A) if
P ~ 1). Using this rule, one obtains the asymptotic rate
(
In f) 2P!(2p+l)
V(f) =
T
;
that is,
(
1 f)-2P!(2P+l) /
~
(f(x, a;(f)) - [(x, ll'{)))2 dx < 00.
In the case where the regression function belongs to an element of the struc-
ture (in this case the regression function has an arbitrary number of bounded
derivatives), by using a slowly increasing function n = n(f) one achieves a
rate of convergence that is close in order of magnitude to
V(f) = C~f) .
6.4.2
Proof of Theorem 6.4
Denote by
n(f)
[n(x, af) = L apo/p(x)
p=l
the function from the set of functions Sn that minimizes the empirical risk
functional
Let
00
[(x, UO) = L
a~o/p(x)
p=l
be the regression function. We estimate the rate of convergence in L 2(F) of
[(x, an(f)) to the desired regression function

242
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
Since the set of functions rjJp(x), p = 1,2, ..., is orthonormal with respect to
the distribution F(x), we obtain the following rate of approximation:
n(f)
V(f) = Lt3; + rn(f),
p
where we denote
and
00
rn(f)= L
(a~)2.
p=n(f)+l
To bound the sum (6.39) we have to bound the first term:
n(l)
T 1(f) = L 13;·
p
(6.39)
To do so we define a vector 13 = (131, ...,t3n) corresponding to ap which min-
imizes the empirical risk
where we denote
Yl
~l + L ag.rjJp (Xl)'
p==n+ I
Denote by K the covariance matrix with elements
(6.40)

6.4 BOUNDS FOR THE REGRESSION ESTIMATION PROBLEM
243
and denote by G = (G1, .•. , Gn) T the n-dimensional vector of coordinates
(6.40). In these notations the vector f3(n(f)) minimizing the empirical risk is
f3n(f) = K-1G.
Therefore the bound
(6.41)
holds true. Let us bound the norm of the matrix K- 1 and the norm of vector
G from above. The norm of matrix K equals JL~ax' the largest eigenvalue of
K, and the norm of the matrix K- 1:
where
JL~ir is the smallest eigenvalue of the n x n matrix K. Therefore to
bound K-
we have to bound JL~in from below.
Consider the function
(6.42)
which we shall examine in the domain
(6.43)
Recall that we have defined the bound Dn such that
in the domain (6.43). Now consider the expression
Observe that
n
E<I>n(x, a) = La;,
p=l
1
f
n
eL <l>n(Xi, a) = L apaqKp,q,
i=1
p,q
(6.44)
(6.45)

244
6 THE STRUCTURAL RISK MINIMIZAflON PRINCIPLE
where Kp •q , p, q = 1, ... ,n, are the elements of covariance matrix K described
above. Using a rotation transformation, we arrive at a new orthogonal system
of functions r/Jt(x), ... ,r/J;(x) such that
n
E<I>n(x, a*) = I)a;)2,
p=1
(6.46)
(6.47)
f
n
~ L<I>n(Xi,a*) = LlLp(a;)2,
i=1
p,q
where ILl, ... , ILn are eigenvalues of the matrix K.
To bound the eigenvalues use the results of the Theorem 5.3 according
to which with probability at least 1 - 4/£ simultaneously for all functions
<l>n(x, a) in the domain (6.43) the following inequality holds true:
E ..h
(
*) < ~ ~..h (.
*)
Dn£n (1 VI 4E;=I <l>n(Xi' a*) )
'¥n X, a
- £ f;t '¥n XI' a
+
2
+
+
£Dn£n(£)
,
(6.48)
where for our structure with hn = n we have
n (In ~ +1) +In £
£n(£) = 4
£
Taking into account (6.46) and (6.47) we can rewrite this inequality for
domain (6.43):
This inequality is true with probability 1 - 4/£ simultaneously for all a; in
domain (6.43). Therefore with probability 1 - 4/£ the bound is valid for the
specific vector a = (0,0, ... , 1,0, ... 1 0) where the one corresponds to the
smallest eigenvalue. For this vector we obtain the following inequality:
where
n
.
n
ILmin =
mm ILp '
I~p~n

6.4 BOUNDS FOR THE REGRESSION ESTIMAIION PROBLEM
245
Solving this inequality with respect to lL~in' one obtains that with probability
at least 1 - 1/£ the inequality
(6.49)
holds true, where we define (u)+ = max(u, 0).
Therefore with probability 1 - 1/£ the bounds
(6.50)
hold true.
To bound IGI 2 note that
Let us compute the expectation
n
(6.51)
To derive the inequality (6.51) we use the condition (6.32) that the regres-
sion function has no singular structure.
To bound the random value IGI we utilize Chebyshev inequality for the
first moments
where we use
We obtain
P{IGI 2
n(u
2 +c2)ln£}
_1_
>
.e
< In.e·

246
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
Thus with probability at least 1 - 1/ In €
(6.52)
holds true. Substituting (6.50) and (6.52) in (6.41) we obtain that with proba-
bility at least 1 - 2/ In £ the first term in the sum (6.31) is bounded as follows:
n In €
2'
T(n) <
(u + c~)
- f(l - JDn£n(€))i
.
Therefore we proved that
P {V-1(f) (R(a?) - R(ao)) ~ I} :2: 1-
l~f'
where
The theorem has been proved.
6.5
THE PROBLEM OF APPROXIMATING FUNCTIONS
In the previous sections, we obtained the asymptotic rate of convergence for
the SRM principle. We showed that in the general case the asymptotic rate
of convergence has order of magnitude
Jhn(f) Inf
V(f)=rn(f)+Dn(f)
f'
(6.53)
where D n = Bn if the elements of the structure contain totally bounded func-
tions and D n = Tn if elements of the structure contain an unbounded set of
functions.
For the problem of regression estimation, with quadratic loss function we
obtained the bound which (under some conditions) has a better order of
magnitude:
hn(R) In f
V(f) = rn(R) +
f
.
(6.54)
To use these results, however, one needs to estimate the first term in (6.53)

6.5 THE PROBLEM OF APPROXIMATING FUNCTIONS
247
and (6.54) that describes the rate of convergence of the risks rn attained at
the best function of the elements of the structure to the smallest possible risk
for entire set of function. This section is devoted to estimating this rate of
convergence (rate of approximation).
Note that in the general case we have
rn
/
Q(z, a3) dF(z) - /
Q(z, an) dF(z)
<
inf /IQ(z,ao)-Q(z,a)ldF(Z).
aEAn
Let us denote the right-hand side of this inequality by r~:
r~ = inf /
IQ(z, ao) - Q(z, a)1 dF(z).
aEAn
The quantities r~ describe a rate of approximation in the (weak) metric L, (F)
of the desired function Q(z, ao) by the best functions of the elements of the
structure S.
For the case of measurements with additive noise (6.31) and quadratic loss
functions
Q(z, a) = (y - f(x, a))2,
the rate of convergence of the risks
aEA
rn = / Q(z,a3)dF(z) - /
Q(z,ao)dF(z)
/
(f(x, ao) - f(x, afj))2 dF(x) = r~
coincides with the square of the rate of function approximation in L2(F)
metric.
Therefore to estimate the rate of risk convergence in L 2(F) metric it is suf-
ficient to estimate the rate of function approximation for the corresponding
structure.
Estimating the rate of function approximation (in different metrics, not
necessarily in weak onest) constitutes the problem of approximation theory.
This theory was started more than 100 years ago when Weierstrass had dis-
covered that on the finite interval every continuous function admits approx-
imation to any accuracy by algebraic polynomials. This posed the question:
How fast do polynomial approximations converge to the desired function with
increasing degree of polynomials?
t Note that the rate of function approximation in weak metrics is not worse than the rate of
approximation in the strong metric C.

248
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
The approximation theory addresses the following problem. Let <I> be a set
of functions belonging to a normed space of functions. Consider the structure
Ml C M 2 C .,. c M n , ...
(6.55)
imposed on this set with the following property: The elements of the structure
{M}k=1 are such that U~ M k is dense in <1>.
The problem is for a given set of functions <I> and for a given structure to
find a bound
which is valid for any function f of the set <1>.
This, however, is a very general setting of the problem. Approximation
theory considers some special sets of functions <I> and some special structures
{M}~l for which it estimates the approximation rate.
In the following sections, we will state (without proofs) some classical
theorems of approximation theory, then we will formulate the theorems esti-
mating the rate of convergence for the structures used in the learning models,
and lastly we will demonstrate some connections between the rate of approx-
imation and the VC dimension of the set of approximated functions.
6.5.1
Three Theorems of Classical Approximation Theory
This section describes three theorems of constructive approximation theory-
that is, the theory that not only gives a bound of the approximation rate, but
also provides the methods that for any given function f how to find in the
subset M k the best approximation f;.
Let us consider the classical problem of approximation of the periodic
functions f(x), x E R 1, by the Fourier series. We will approximate the func-
tion f(x) by the trigonometric series
where
k
<l>k (x) = a; +L (aj cos jx + bjsinjx) ,
j=l
1 j7l"
ao
1T'
-71" f(x) dx,
(6.56)
b·J
1 j7l"
1T'
_7I"f(x)cos jxdx,
~ j7l" f(x) sin jx dx.
1T'
-71"
(6.57)
(6.58)

6.5 THE PROBLEM OF APPROXIMATING FUNCTIONS
249
An important role in Fourier analysis is played by the Dirichlet formula
. ((N+1)X)
1
N
sm
2
DN(x) = 2+ Lcos jx =
. (X)
'-1
sm
-
J-
2
(6.59)
The right-hand side of the expression (6.59) is called the Dirichlet kernel.
Using kernel D k (x) one can rewrite the approximation (6.56) in the form
(6.60)
However, the approximation (6.60) does not guarantee convergence to any
point of continuous target function.
Therefore along with the Dirichlet kernel Ddx) one considers the so-
called Fejer kernel
.
2 Nx
1 N-l
sm -
:FN(x) = N L Dk(x) =
. ; x·
k=O
2N sm 2
This kernel defines Fejer approximations
(6.61)
(6.62)
in the Fourier expansion. Note that the Fejer approximation gives the ex-
pression
*
N
N
F ()
ao
"""
*
.
""" b*'
.
N X
= 2 + La1' cosJx+ L
1'smJx,
1'=1
1'=1
where coefficients a; and bi are regularized Fourier coefficients ((6.57) and
(6.58))
In 1904, Fejer proved that any continuous function, periodic on finite interval,
can be approximated by the Fejer approximation (6.62) with any degree of
accuracy as N increases. However, on the basis of Fejer approximation one
cannot determine the rate of approximation.
In 1911, Jackson gave a construction that guarantees the best asymptotic
rate of approximation (in the metric C) of r ~ 0 times continuously differen-
tiable periodic functions.
To formulate Jackson's theorem we need to define the following concept.

250
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
Definition. We call the quantity
w(5,f(x)) = sup sup{lf(x + h) - f(h)l}
Ihl9
x
the modulus of continuity of the function f(x).
Now let us define the Jackson kernel
, x
sm-2
Zr
r = 2,3, ...,
(6.63)
where coefficient AN,r is chosen to normalize the kernel
It follows from (6.63) that the kernel 1N ,r(x) is an even. nonnegative trigono-
metric polynomial of degree :S N.
Now let us describe an approximating function fN(x) from M N. We will
distinguish between two cases.
In the first case, we have no information about the smoothness properties
of the desired function. In this case, we construct the approximation
using the Jackson kernel IN.z(x) with r = 2.
In the second case we have information that the desired function has no
less than r > 1 derivatives. In this case we will construct the approximation
using the Jackson kernel 1N ,r(x) with parameter r.
Theorem 6.5 (Jackson). Let f(x) be an r times continuously differentiable
periodic function. Then the inequality
(6.64)
holds true, where A < 1TV3/2 is a universal constant.

6.5 THE PROBLEM OF APPROXIMATING FUNCTIONS
251
The converse theorem is valid as well.
Theorem 6.6 (Bernstein (1912) and Vallee-Poussin (1919)). Let a continuous
function f(x) satisfy the inequality
(6.65)
where r is some integer, 0 < S < 1 and pdf, M N ) is distance between the
function f and the closest function from the set of trigonometric polynomials
of degree N in C metric,
pc(f(x), MN) =
inf
sup If(x) - r(x)l·
f'EM/>,"
x
Then f(x) is r times differentiable and its rth derivative satisfies a Lipschitz
condition of order S:
These two theorems show that the rate of approximation by Fourier sums
depends solely on smoothness properties of the target function; the smoother
the target function, the higher the rate of approximation by trigonometric
sums.
The same result remains true if one considers a structure with elements
MN containing algebraic polynomials of degree N.
Theorem 6.7. Let f(x) be an r ~ 0 times continuously differentiable function
on [a, b] and let function f(r) (x) satisfy the Lipschitz condition of order S:
for x, x' E [a, bl.
Then the inequality
(6.66)
holds true, where the constant C(f) depends on the function f(x).
6.5.2
Curse of Dimensionality in Approximation Theory
Now we have to generalize the results obtained for the one-dimensional case
to the multidimensional case.
Let <1>* be a set of functions defined on the d-dimensional cube [0, l]d
and let functions from this set have bounded (in the uniform norm) partial
derivatives of order s and satisfy the (d-dimensional) Lipschitz condition of
order 0 < S < 1. Consider the following structure: Element M n is the set of

252
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
polynomials of degree n in each of the d variables that is linear in parameter
space of dimension Nn = dn (here Nn is the number of parameters).
Theorem 6.8. For any function f(x) of the set <1>* the following inequality
holds:
,if M ) < C(f)N-(S+i))/d
Pc
,
n
_
n
where constant C(f) depends on function f.
(6.67)
From (6.67) we find that the asymptotic rate of convergence drastically
decreases with increasing number of parameters when the characteristic of
smoothness (number of bounded derivatives) remains fixed.
Therefore according to approximation theory one can guarantee good
approximation of a high-dimensional function only if the desired function
is extremely smooth.
6.5.3
Problem of Approximation in Learning Theory
In the learning theory we have to estimate the rate of approximation even
for more difficult cases.
We have to estimate the rate of approximation for the cases when:
1. <I> is a set of high-dimensional functions.
2. The elements M n of the structure are not necessarily linear manifolds.
They can be any sets of functions with finite VC dimension.
Furthermore, we are interested in the cases where the rate of approxima-
tion is rather high (otherwise one cannot hope to find a good approximation
of the desired function using a restricted number of observations). We will
call the rate of approximation high if it has a bound 0 (1/ViZ), where n is
an index of an element of the structure.
Therefore in the learning theory we face a problem: to describe cases for
which the high rate of approximation is possible. This means to describe
different sets of smooth functions and structures for these sets that provide
the bound 0 (1/ViZ).
Below we consider a new concept of smoothness. Let {f(x)} be a set of
functions and let {f(w)} be a set of their Fourier transforms.
We will characterize the smoothness of the function f(x) by the value b
such that
b ~O.
(6.68)
In terms of this concept the following theorems hold true

6.5 THE PROBLEM OF APPROXIMATING FUNCTIONS
253
Theorem 6.9 (Jones, 1992). Let the set of functions f(x) satisfy (6.68) with
b = O. Consider the structure with elements M n containing the functions
n
f(x) = L Ci sin ((x, Wi) + Vi),
i=l
(6.69)
where Ci and Vi are arbitrary values and Wi are arbitrary vectors. Then the rate
of approximation of the desired function by the best function of the elements
(6.69) in Lz metric is bounded by 0 (1/Vii).
Theorem 6.10 (Barron, 1993). Let the set offunctions f(x) satisfy (6.68) with
b = 1. Consider the structure with elements M n containing the functions
n
f(x) = L CiO ((x, Wi) + Vi),
i=l
(6.70)
where Ci and Vi are arbitrary values and Wi is an arbitrary vector, 0 = o(u) is
a sigmoid function: (a monotonic increasing function such that
lim o(u) = -1,
u--+-oo
lim o(u) = 1).
u-+oo
Then the rate of approximation of the desired function by the best functions
of the elements (6.70) in Lz metric is bounded by 0 (1/Vii).
Theorem 6.11 (Breiman, 1993). Let the set offunctions f(x) satisfy (6.68) with
b = 2. Consider the structure with elements M n containing the functions
n
f(x) = L Ci sin Ix, Wi + vd+ + x . a + b,
i=l
lul+ = max(O, u),
(6.71)
where Ci and Vi and b are arbitrary values and Wi and a are arbitrary vectors.
Then the rate of approximation of the desired function by the best function of
the elements (6.71) in L 2 metric is bounded by 0 (1/Vii).
In spite of the fact that in these theorems the concept of smoothness
differs from the number of bounded derivatives, one can observe the similar
phenomenon as in the classical case: To keep a high rate of convergence in
a space with increasing dimensionality, one has to increase the smoothness
property of the function. Using concept (6.68), one attains it automatically.
Girosi and Anzellotti (1993) showed that a set of functions satisfying (6.68)
with b = 1 and b = 2 can be rewritten, respectively, as
1
f(x) = IxIn-l * A(x),
1
f(x) = Ixln - 2 * A(x),

(6.72)
254
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
where A is any function whose Fourier transform is integrable, and * stands
for the convolution operator. In this form it becomes more apparent that
functions satisfying (6.68) become more and more constrained as the di-
mensionality increases due to more rapid fall-off of the terms 1/IxIfI-I and
1/lxln- 2.
Therefore if the desired function is not very smooth, one cannot guarantee
high asymptotic rate of convergence of the constructed approximations to the
desired function.
6.5.4
The VC Dimension In Approximation Theory
In this section we will describe a special class of sets of functions for which the
rate of approximation is high and the bounds depend on the VC dimension
of some set of functions.
Consider set of functions which is defined by the functions A(t) belonging
to L 1 and some fixed kernel K (x, t):
I(x) = ! K(x, t)A(t) dt,
where x, t E RfI , and the kernel K(x, t) satisfies the condition
IK(x, t)1 :S T.
In this representation by using different kernel functions one transforms func-
tions from L I into different sets of (smooth) functions.
Let us rewrite (6.72) in the form
I(x) =! K*(x,t)p(t)dt,
where
K*(x,t) = IAlsign(A(t))K(x,t),
IAI = !IA(t)1 dt
and
( ) _ IA(t)1
p r -
IAI
is some density function. Therefore (using the results obtained in Chapter 5,
Section 5.5) one can assert that if we sample £ points tI, .", tf from pet), then
with probability 1 -
71 we have
1
f
sup I(x) - £ LK*(x,t;)
~ 2IAITJ£(£),
x
;=1

6.5 THE PROBLEM OF APPROXIMATING FUNCTIONS
255
where
h (In ~e +1) - In 11/4 1
[; =
+-,
e
I!
and h is VC dimension of the set of functions K*(x, t) (here t describes the
vector of variables and x describes the vector of parameters).
Since for any positive
11 there exist e points t;, ...,t; that satisfy this
inequality, the inequality
1 (
sup f(x) - f LK*(x,tt) :S 2I AlrJ[;*(£)
x
i=1
where
holds true with probability one.
Thus we have proved the following theorem.
Theorem 6.12 (Girosi). Let f(x) be a set of functions. defined by representa-
tion (6. 72). Let the kernel K(x, t) be considered as a parametric set offunctions
(with respect to the variables t) that has the VC dimension h.
Consider the structure S with elements SNcontaininR the functions
N
f(x) = IAIL
~K(X,ti)'
i=1
defined by the parameters
Ci E {-I, I}
i = ], ..., N.
Then the rate of approximation in metric C of any function from this set by
the elements of the structure is
h (In ~ +1) +In4
N
This theorem describes the way of constructing the sets of functions and
appropriate structures for which the rate of approximation in C metric is
high.

256
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
As an example of application of this idea, let us make the following choice
of the kernel function:
K(x, t) = Gm(x - t),
where Gm(u) is the Bessel potential function of the order m which has the
following integral representation (Stein, 1970, p. 132):
To be bounded at the origin, this kernel must satisfy the condition
m >d.
It is known that the space of functions
f = Gm * A
(6.73)
with A E L 1 forms the so-called Sobolev-Liouville space Lf (space of func-
tions with absolutely integrable mth derivative).
Let us rewrite the representation (6.73) in the explicit form
f(x) =
(217') -m /
e-( 1T/u)lx-tl~A(t fr) dt dfr
f(mI2)
"
where we denote
To apply the results of Theorem 6.12 to this specific kernel, estimate the VC
dimension of the set of functions
4> (x, t, fr) = e-(1T/u)lx-t I2 ,
Note that the VC dimension of this set of real functions is equivalent to the
VC dimension of the set of indicator functions
ljJ(x, t, fr) = 6{lx - tl 2 - {3fr},
which is equal to d + 1.
Thus, we have proved the following theorem.
Theorem 6.13 (Girosi). Let f be an element of space Cr, with m > d.
Consider the structure S with elements SN containing the functions
f. (x) = IAI (217')
m ~ Ci e-(1T/u/l!x-t,tZ
N
f(mI2) L..J N
'
1=1

6.6 PROBLEM OF LOCAL RISK MINIMIZAflON
257
defined by parameters
Ci E {-I, I}.
Then the rate offunction approximation in the metric C of any function from
this set by the elements of the structure is
rlY = 21Alr
(d + 1) (In ~ + 1) + In4
N
Note how clearly this theorem confirms the statement that a high asymp-
totic rate of approximation can be achieved only for smooth functions (the
functions considered in Theorem 6.13 belong to Sobolev space with m > d).
Note also that according to Theorem 6.12 one can construct smooth func-
tions by using convolution with kernel of very general type. To get high
asymptotic rate of approximation the only constraint is that the kernel should
be a bounded function which can be described as a family of functions pos-
sessing finite VC dimension.
6.6
PROBLEM OF LOCAL RISK MINIMIZATION
In the last section, we made a rather pessimistic conclusion: The high asymp-
totic rate of approximation can be achieved only for very smooth functions.
Note, however, that this assertion was made for the asymptotic rate of
approximation. It does not exclude that nonasymptotic behavior of approxi-
mation can be much better.
Recall that we have already seen this situation. The main bound for the
method of minimizing empirical risk over a set of totally bounded functions
with finite VC dimension is the following: With probability 1 -
11 the inequal-
ity
BE(f) ( J
4Remp(af) )
R(aR) ~ Remp(af) + -2-
1 +
1 +
BE(f)
holds true, where
(6.74)
h (In ~ + 1) - In 1114
E(f.) = 4
f
In the most typical real-life cases when both f Ih > 1 and the amount
Remp(ad/BE(f) are small, the rate of convergence behaves as E(f). How-
ever, if R(ao) f- 0, then asymptotically for large flh the rate of convergence
behaves as JE(f). (When R(ao) = Remp(at) = 0 we have a special case where
the rate equals E(f).)

258
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
Thus, for estimating the function from a restricted amount of observations,
one has to find a structure that provides small values Remp(a;) when €/h is
small. It is clear, however, that in order to find this structure, one has to
possess some prior information about the problem at hand.
To decrease the influence of choosing a poor structure, we wiJI consider a
new statement of the problem: the problem of local estimation of a function,
that is the estimation of function in a vicinity of the point of interest.
However, before moving into the theory of local function estimation, let
us clarify why local function estimation can be better than global.
Suppose we would like to estimate the function plotted on Fig 6.3a. Sup-
pose we are given the structure where element Sk is a set of polynomials
of order k. As shown in Fig 6.3a, to approximate this function well on the
interval [0,1] we have to use a polynomial of high degree (to describe well a
flat part of the curve). Therefore we need a polynomial of high degree m to
obtain an appropriate level of approximation.
Now let us consider two problems: estimating the desired function on the
interval [0, 1/2] and estimating this function on the interval [1/2, 1].
For this example a reasonable level of accuracy of approximation of the
desired function can be achieved by approximating the function on the inter-
val [0, 1/2] by polynomial of degree°and approximating the desired function
on the interval [1/2, 1] by a polynomial of degree 1 (see Fig 6.3b). In other
words, better accuracy can be achieved by approximating the function locally.
In general, it is possible to obtain an additional gain if one can make a
"smart" partition of the interval [0, 1] into (two or more) subintervals.
The problem arises: How do we partition a (multidimensional) input space
into subspaces to obtain a good solution for problem of local function estima-
tion?
a
{(x)
a
x
(a)
(b)
FIGURE 6.3. (a) To approximate function well on interval (0.1). one needs a polynomial
of high degree. (b) To approximate the same function well on the two semi-intervals,
one needs a low degree polynomials.

6.6 PROBLEM OF LOCAL RISK MINIMIZATION
259
To consider such a problem we introduce the model of the local risk min-
imization.
6.6.1
Local Risk Minimization Model
In all our previous considerations we used a loss function defined by some
variable z = (y,x). Now to introduce the specific structure of loss func-
tions we consider two variables y and x. Consider a nonnegative function
K (x, Xo; (3) that embodies the concept of vicinity. This function depends on a
point Xo and on a "locality" parameter f3 E (0,00) and satisfies two conditions:
o~ K(x,xo;f3) ~ 1,
K(xo, Xo; (3) = 1.
For example, both the "hard threshold" vicinity function (Fig. 6.4a)
(6.75)
if /Ix - xo/l < ~ ,
otherwise
(6.76)
and the "soft threshold" vicinity function (Fig 6.4b)
meet these conditions. Let us define the value
K(xo,f3) = I K(x,xo;f3)dF(x).
(6.77)
(6.78)
1 -----------,---........-...,
a
f3
x
1 -----
-
a
x
(a)
(b)
FIGURE 6.4. Examples of vicinity functions. (0) Hard-threshold Vicinity function. (b)
Soft-threshold vicinity function.

260
6 fHE SfRUCfURAL RISK MINIMIZATION PRINCIPLE
For the set of functions f(x, 0'), 0' E A, let us consider the loss functions
Q(z, a) = Q(y,f(x, a», a E A. Our goal is to minimize the local risk func-
tional
/
K(x, Xo; (3)
R(a, f3;xo) =
Q(y,f(x, a)) K(xo; (3)
dF(x, y)
(6.79)
over both the set of functions f(x, a), a E A, and different vicinity functions
at the point Xo (defined by parameter (3) in a situation where the probability
measure F(x, y) is unknown, but we are given examples
Note that the problem of local risk minimization on the basis of empirical
data is a generalization of the problem of global risk minimization. (In the last
problem we have to minimize the functional (6.79), where K(x, Xo; (3) = 1.)
Let us apply the statement of local risk minimization problem to our spe-
cific problems: the pattern recognition problem and the problem of regression
estimation.
In the simplest setting of the problem of pattern recognition both the set
of functions f(x, a), a E A, and the set of loss functions Q(y,f(x, a» are sets
of indicator functions
Q(y,f(x, a»
= { ~
if y = f(x, a),
if y i= f(x, a).
(6.80)
Minimizing the local risk functional (6.79) with a hard threshold vicinity func-
tion for this problem means to find both the vicinity of point Xo (parameter
(3* for inequality Ilx - xoll So ~* ) and the function f(x, a*) which minimize
the probability of error in the region Ilx - xoll S ~*.
For the problem of regression estimation we consider the following loss
functions:
Q(y,f(x, a»
= (y - f(x, a»2,
(6.81 )
where now f(x, a), a E A, is a set of real-valued functions and y is a real
value.
Remark. It looks reasonable to choose the point Xo of interest as a center
of admissible vicinities and then use the obtained function for estimating the
value of the desired function at the point xo.
Note that in this statement for different points of interest Xo one has to
estimate both the approximating function and the value of vicinity.
We will distinguish between two different models of estimating the func-
tion in the vicinity of a given point:

6.6 PROBLEM OF LOCAL RISK MINIMIZATION
261
1. The case where for any given point of interest Xu we choose both the
value of the vicinity K (x, {3fJ and the approximating function f(x, ad·
We call this case a local approximation of the desired function.
2. The case where for different points of interest we use the same value
of the vicinity but different approximating functions. We call this case
a semi/ocal approximation of the desired function.
In the following examples we show that well-known classical methods such
as the method of K -nearest neighbors in pattern recognition and the Watson-
Nadaraya method (method of moving average) in the regression estimation
problem are the simplest semilocal methods for solving the problem of min-
imizing the local risk functional (6.79), which uses the empirical risk mini-
mization principle.
Example 1. Consider the pattern recognition problem. Our goal is using the
empirical data to minimize the functional (6.79) with loss function (6.RO),
where:
1. K(x, xu, (3) is the hard threshold vicinity function (6.76) and
2. f(x, a), a E A, is the simplest set of indicator functions, namely the set
of constant functions.
Suppose we are given the value of the vicinity parameter {3 = {3*, which
we will use for every possible point of interest (we have a fixed parameter
of vicinity).
To minimize this functional, let us minimize the empirical risk functional
over the set of constant functions f(x, a) = c. Note that in the set of indi-
cator functions there exist only two constant functions, namely the function
f(x, al) == 1 and the function f(x, a2) == O.
To minimize the empirical risk for this case means to check how many
errors these two functions make on the part of the training set that falls into
the vicinity of the point of interest and then assign the point of interest to
those constant functions that make less errors.
Thus we obtained the method of type K-nearest neighbors.t This method
is semilocal because the value of the vicinity is fixed a priori.
t The difference is only that here the vicinity of the point of interest Xo is determined by the radius
of the sphere with center in this point, and therefore the number of elements of the training set
in the vicinity of the point of interest is not fixed. In the classical K -nearest neighbor method
the vicinity of the point of interest
X(J is measured by the radius such that the corresponding
sphere includes a given numbers of elements of the training set and therefore the radius is not
fixed (but the number of points in the sphere is fixed).

(6.82)
262
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
Example 2. Now let us consider the problem of regression estimation. Our
goal is to minimize the functional (6.79), with loss function (6.81) where:
1. K(x, Xo, (3) is a soft-threshold vicinity function and
2. f(x, a), a E A, is the simplest set of real-valued functions, namely the
set of constant functions.
As in Example 1 we are given a priori the value of the vicinity parameter
f3 = f3*.
The subset of constant functions of the set of real-valued function contains
an infinite number of elements j(x, a) = a, a E (-00, (0).
To minimize this functional, let us minimize the empirical risk functional
over parameters a. The minimum of this functional is achieved for the con-
stant function
*
~
K(Xi, Xo, (3*)
a = L
f
Yi'
kl LI=I K(Xi, XO, f3*)
Using this constant function we evaluate the value of the desired function at
the point Xo. Therefore Eq. (6.82) gives a function ¢ (x) for estimating the
value of the desired function in any given point of interest x:
f'
A-.( )_"
K(x l ,x,{3*)
'f' X
-
L
f
y,.
i=1 LI=1 K(Xi, X, f3*)
(6.83)
Expression (6.83) is called the Watson-Nadaraya estimator or the moving
average estimator. The same as the K-nearest neighbor estimator, this esti-
mator is semilocal.
6.6.2
Bounds for the Local Risk Minimization Estimator
This section presents three theorems concerning the bounds for the local
risk functional. Using these bounds, one can utilize the structural risk min-
imization principle for minimizing the local risk functional on the basis of
empirical data. Note that the principle of minimizing the empirical risk
(6.84)
over two parameters a and f3* gives a bad solution.

6.6 PROBLEM OF lOCAL RISK MINIMIZATION
263
Indeed, for a hard-threshold vicinity function and for the set of constant
functions the minimum of empirical risk is equal to zero if (3 is such that
the vicinity of the point of interest includes only one element of training set.
However, this solution does not guarantee generalization.
We derive bounds on risk that are valid simultaneously for all sets of
functions and all values of the vicinity parameter.
We start with the case where Q(y, f(x, a)), a E A, is a set of indicator
functions which has VC dimension hI.
Theorem 6.14. Let the set of indicator functions Q(Y,f(x, a)), a E A, have
the VC dimension hI and let the set of nonnegative real-valued functions
K(x, Xo, (3), (3 E (0,00), have the VC dimension h2. Then with probability
1 - 2'T1 simultaneously for all a E A and all {3 E (0, 00) the inequality
R(a, (3, xo)
< 2Remp(a, (3, xo) + fhl (£) + f h2 (£) (1 + VI + 4Remp(a, (3, xo) )
(6.85)
-
2 (Kemp(xo,{3) - y'fh2 (e)L
fhl(e) +fh2 (£)
holds true, where
1
f
Remp(a,{3,xo) = f LQ(Yi,f(xi,a))K(xi,xo,{3),
i=1
(6.86)
i = 1,2,
(6.87)
1
f
Kemp(xo, (3) = f L K(Xi, XO, (3).
i=1
(6.88)
Remark. The bound (6.85) uses the VC dimension of two sets of functions:
VC dimension hI of the set of indicator functions Q(x,f(x), a), a E A, and
VC dimension h2 of the set of real-valued functions K(x,xo,{3), {3 E (0, (0).
The numerator of the bound of the risk depends on the sum fhl (£) + f h2 (f)
(the smaller the sum, the smaller the numerator), and the denominator of the
bound depends only on one parameter f h2 (£) (the smaller f I12 (£), the larger
the denominator). Therefore, it seems advisable to define a set of vicinity
functions K(x,xo, (3), (3 E (0,00), with small VC dimension-for example,
monotonic radial functions. The VC dimension of the set of radial functions
K(x,xo, (3) = Kf3(llx - xoll),
{3 E (0,00),

264
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
where K{3(r) are monotonically nonincreasing functions of r, is equal to 1.
For this set of functions we have a bound
(6.89)
where Remp(a, (3), £h(f), and Kemp(xo, (3) are determined by Eqs. (6.86),
(6.87), and (6.88).
The next theorem is a generalization of Theorem 6.14 for the case where
Q(y,f(x, a)), a E A, is a set ofreal-valued totally bounded nonnegative func-
tions 0 ~ Q(y,f(x, a)) ~ B.
Theorem 6.15. Let a 0 ~ Q(y, f(x, a)) ~ B, a E A, be a set of totally bounded
nonnegative functions, let the set of functions Q(y,f(x, a)) xK(x,xo,{3),
a E A, {3 E (0, (0), have the VC dimension h*, and let the set of functions
K(x, xo, (3), (3 E (0,00), have the VC dimension h2. Then with probability
1 - 211 simultaneously for all a E A and all (3 E (0,00) the inequality
R(a, (3, xo)
<
2Remp(a,{3,xo) + B£h·(l) (1 +VI + 4Remp(a,{3,Xo)) (6.90)
- 2 (Kemp(xo,{3) -
JB£h~(f)L
B£h'(£)
is valid where Remp(a, (3), £h(f) and Kemp(xo, (3) are determined by Eqs. (6.86)
(6.87), and (6.88).
Remark. In contrast to the set of real-valued functions
Q(y,f(xa)) x
K(x, xo, (3), a E A, (3 E (0,00), considered in Theorem 6.14 where any func-
tion was a product of an indicator function and a real-valued function, here
we consider a set of real-valued functions which are products of two real-
valued functions.
For the specific set of real-valued functions considered in Theorem 6.14,
we obtained a bound which depends on the VC dimensions of the two set of
each factors separately.
For the functions considered in Theorem 6.15, this assertion is not true.
For example, let {<fJ* (z)} be the set of all monotonically increasing functions
in z E R I and <fJ*(z) be a set of all monotonically decreasing functions in
z E R I . Although the VC dimension of both sets is 1, the VC dimension of
the product of these sets <fJ*(z)<fJ.(z) is infinite. Therefore in the bound of
Theorem 6.15 we have to use the VC dimension of the product of the two
sets.

6.6 PROBLEM OF LOCAL RISK MINIMIZATION
265
Lastly, consider the bounds on the local risk functional for the case of the
set of unbounded loss functions Q(y,f(x, a), a E A.
In Chapter 5 we considered the bound on the risk for an unbounded set
of nonnegative functions, satisfying the condition
\If QP(Z, a) dF(z)
sup
< 7',
aEA
fQ(z,a)dF(z)
-
p>1.
{3 E (0,00)
(6.91)
Here we consider a stronger restriction. To describe it we note that the ex-
pressIOn
dF ( ) = K(x, xo,(3) dF( )
{3 z
K(xo, {3)
z ,
defines a family of measures that depends on parameter {3. Below we assume
that inequality
Jf Q2(Z, a) dF{3(z)
sup sup
< 7',
(3
aEA
fQ(z,a)dF{3(Z)
-
holds tme,t where the supremum is taken both over set of functions Q(z, a),
a E A, and the family of measures F{3(z).
Theorem 6.16. Let the set of nonnegative functions Q(y,f(x, a)) x K(x,xo, {3),
a E A, {3 E (0,00), have VC dimension h* and satisfy inequality (6.91). Let the
family of vicinity functions K(x, Xo, {3), {3 E (0,00), have VC dimension hz·
Then with probability 1 - 2T1 simultaneously for all a E A and all {3 E (0, 00)
the inequality
R(
{3
) <
Remp(a,{3,xo)
a,
, Xo _
(
K
E
R
1
Eh• (£) (1 - InEh•(l))
(
emp(XO, {3) - vl;;:-mL
-7'
(Kemp(xo, {3) - V~(l)t
+
(6.92)
holds true, where Eh(R) is determined by the expression (6.87).
6.6.3
Proofs of the Theorems
To prove Theorem 6.14 note that:
1. The set of real-valued functions Q(y,f(x, a)) x K(x, Xo, {3), a E A. is
totally bounded by the constant 1.
t We consider case p = 2 only to simplify notations in the formulas for the bounds of the local
risk. One can easily obtain the bounds for any p > 1.

266
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
2. The VC dimension of the set of real-valued functions Q(y, f(x, a)) x
K(x, xo, (3) is equal to the VC dimension of the following set of indicator
functions
<I>(x,y, a, (3) =
(J (Q(y,f(x, a)) x K(x, xo, (3) -
)I),
(6.93)
where 0::::: )I ::::: 1. Recall that we consider the case where Q(y,f(x, a)),
a E A, is a set of indicator functions. It is easy to check that for this set
of functions the equality
(J (Q(y,f(x, a)) X K(x,xo, (3) -)I) = Q(y,f(x, a))(J (K(x,x(), (3) -)I)
(6.94)
holds true. Let the VC dimension of the set of indicator functions
Q(y,f(x, a)), a E A, be hI and let VC dimension of the set of indi-
cator functions (J [K(x,x(), (3) - )I], (3 E (0,00), )I E [0,1], be hz·
Note that the growth function for the set of indicator functions which are
the products of indicator functions from two different sets does not exceed
the product of the two growth functions:
where O"',R' (£) is the growth function of the set (6.94), O'(£) is the growth
function of the set Q(z, a), a E A, and C
R1 (£) is growth function for the set
(J [K(x,xu,{3) -)I], (3 E (0,00), )I E [0,1].
Let us denote
R*(a,{3,xo) = /
Q(y,f(x,a))K(x,xo,{3)dF(x,y).
(6.96)
Using results obtained in Chapter 4, Section 4.6 we derive that with proba-
bility at least 1 -
11 the inequality
holds true simultaneously for all a E A and all {3 E (0, 00), where f h, (£) is
given by (6.87).
Dividing both sides of the inequality by K(xo, (3) we obtain
1 + 4Remp(a,{3,xo)).
f hl (£) +fh~(£)
(6.97)

6.6 PROBLEM OF LOCAL RISK MINIMIZATION
267
To prove the theorem, it is sufficient to obtain a lower bound on the quantity
K(xo, (3). Since the value of the functions K(x, xo, (3) does not exceed 1 and
this set of functions has VC dimension h2, we obtain
From this inequality we derive that with probability 1 -
TJ simultaneously for
all {3 the inequality
(6.98)
holds true.
Using this inequality and inequality (6.97), we obtain the assertion of the
theorem.
The proof of Theorem 6.15 is analogous.
To prove Theorem 6.16 note that according to Theorem 5.4 (for p = 2)
the following inequality is valid:
P {
R(a, (3, xo) - Remp(xo, a, (3)
~1
Ine}
sup
>eyl-T-
a.{j JJQ2(y,f(X, a))K2(x, Xo, (3) dF(x, y)
2
{ (
h* (In ~: +1)
e 2 )}
< exp
- -
f
f
4'
Since 0 ~ K(x,xo,{3) ~ 1 and inequality (6.91) is valid, we have
(6.99)
/ Q2(y,f(X, a))K2(x, Xo, (3) dF(x,y)
~J/ Q2(y,f(X, a))K(x, xo,f3) dF(x,y)
<: JlC(xn, /3) f Q2(y,f(x, a)) dF~(x,y)
~ TJK(xo, (3) / Q(y,f(x, a)) dF{j(x,y)
JQ(y, [(x, a ))K(x, Xo, (3) dF(x,y)
= T ~--=-~--'r======-'-'----'--:-:'"
JK(xo, (3)
.
(6.100)

268
6 THE STRUCTURAL RISK MINIMIZATION PRINCIPLE
Using (6.99) and (6.100), we reinforce inequality
p{
R(a,f3,xo)-Remp(xo,a,f3)JV-(
a)
J1- ln£}
sup
R(
a)
~ xu, fJ > T £
2
01,/3
a, fJ, Xo
{ (
h*(ln ~: + 1)
£2) }
< 4exp
l
- 4
f
.
Rewriting this in the equivalent form with probability 1 -
71 simultaneously
for all a and f3 we obtain the inequality
(6.101)
To prove the theorem it remains to substitute the lower bound (6.98) for
K(xo, (3) in (6.102).
6.6.4
Structural Risk Minimization Principle for Local Function
Estimation
Using the obtained bound, one can apply the SRM principle to the local
function estimation problem using the bounds provided by Theorems 6.14,
6.15, and 6.16. Let us start with the pattern recognition problem.
Consider a nested structure on the set of indicator functions Q(y, f(x, a)).
a EA.
Sl C S2 C, ... , C SN'
Let the VC dimension of each subset Sk of functions be hi (k), such that
According to Theorem 6.14 with probability 1 - 271 simultaneously for all
functions Q(y,f(x, a), a E Ab from Sk and all vicinity functions the bound
(6.85) is valid.
Since this bound is valid for all functions of the set Sb it is valid for the
function Q(y,f(x, at))K(x,xo, f3;), which minimizes the right-hand side of
inequality simultaneously over both parameters a E Ak and f3 E (0, 1) as well.
The choice of the function Q(y,f(x, at)) and the vicinity function K (x, Xo, f3f)
guarantees with probability 1 - 271 the smallest local risk for the function of
element Sk'
Therefore consider each element Sb and then choose a pair composed
of the best function Q(y,f(x, at)) and the best vicinity function K (x, Xo, f3;).

6.6 PROBLEM OF LOCAL RISK MINIMIZATION
269
Now it remains to choose the element and the corresponding vicinity function
which provide the smallest bound.
The scheme of structural risk minimization for regression is identical. As in
the pattern recognition case, we consider the structure S with nested elements
Sk that contain sets of totally bounded functions Q(y,f(x,a)) x K(x,xo,/3)
with the common constant Bk (or the sets of unbounded functions satisfying
(6.91) with the common constant rd.
To choose the best pair we minimize the right-hand side of the bound
(6.90) given by Theorem 6.15 (or the right-hand side of the bound (6.92)
given by Theorem 6.16 if the elements of the structure contains unbounded
functions).
Note that using local risk minimization methods, one probably does not
need rich sets of approximating functions (recall that the classical semi-local
methods are based on using a set of constant functions). For local estima-
tion functions in the one-dimensional case, it is probably enough to consider
elements Sk, k = 0,1,2,3, containing the polynomials of degree 0, 1,2,3.


APPENDIX TO CHAPTER 6:
ESTIMATING FUNCTIONS
ON THE BASIS OF
INDIRECT MEASUREMENTS
This appendix applies the SRM principle to the problem of estimating the
function on the basis of results of indirect measurements. Although this prob-
lem belongs to the so-called stochastic ill-posed problems whose theory we
consider in the next chapter, the particular setting of this problem considered
here has some singularities. These singularities allow us to solve the problem
of indirect measurements using the structural risk minimization principle.
A6.1
PROBLEMS OF ESTIMA1'ING THE RESULTS OF INDIRECT
MEASUREMENTS
Let it be required to estimate the function f(t, ao) = f(t) in the set of func-
tions f(t, a), a E A (here f(t) belongs to f(t, a)), in a situation where it is
impossible to measure directly the values of the function f(t), but one can
measure the values of an another function F(x), a S x S b, related to the
desired one by means of the operator equation
Af(t) = F(x).
(A6.1)
In a one-to-one manner the operator A maps elements f(t, a) of the space
M into elements F(x, a) of the space N.
Let the following measurements of the function F(x) be taken:
(A6.2)
The pair (Xi,Yi) denotes that the measured value of the function F(Xi) at
point Xi is Yi. We consider the following model of measuring:
271

272
A6 ESTIMATING FUNCTIONS ON THE BASIS OF INDIRECT MEASUREMENTS
1. The values of function F(x) are measured with an additive error which
does not depend on x:
Yi = F(Xi) + ~.,
E~ = 0,
E~2 = (1"2 < 00.
2. The points Xi at which the measurements are taken are chosen randomly
and independently according to some known nonvanishing probability
measure P(x). Below without loss in generality we consider the uniform
distribution on [a, b].
Given the operator A and the measurements (A6.2), it is required to
estimate the function f(t) = f(t, ao) in the set f(t, a). Here it is assumed
that the problem of solving the operator equation (A6.1) may be ill-posed.
We call the problem of solving the operator equation (A6.1) on the basis
of data obtained in accordance with the described model the problem of
estimating functions on the basis of indirect measurements.
Note that the operator A maps a set of functions f(t, a), a E A into a set
of functions
F(x, a) = Af(t, a).
Therefore any function f(t 1 a) has the image in the space N. The solution
f(t, ao) of Eq. (A6.1) is the preimage in M of the regression F(x, ao) in the
space N.
Since f(t, ao) = f(t) belongs to the set f(t, a), a E A, the preimage of the
point that minimizes the functional
R(a) = I (y - F(x,a»2dP(x,y) =I(y - Af(t, a»2dP(x,y)
=
(1"2+ lb(Af(t,a)-Af(t,ao»2 dX
(A6.3)
is the solution of Eq. (A6.1).
However, it is impossible to obtain the exact minima (A6.3) using a finite
number of measurements. One can only hope to obtain a function F(x, a*)
which is close (in the metric of space N) to the regression, and then to choose
as a solution of Eq. (A6.1) the preimage f(t, a*) of this function in the space
M.
Such an approach is not always successful: It is inconsistent if Eq. (A6.1)
defines an ill-posed problem. In this case, widely different preimages in M
may (though not necessarily) correspond to close images in N.
In our case it implies that not all methods of risk minimization in the space
of images may be utilized for solving the problem of estimating the results
of indirect experiments, and there may exist a method for risk minimization
which produces only those elements F(x, a*) in the space N whose preimages
are close to the desired solution. These methods for risk minimization (if

A6.2 THEOREMS ON ESTIMATING FUNCTIONS USING INDIRECT MEASUREMENTS
273
they exist) should be utilized for solving ill-posed problems of estimating the
results of indirect measurements.
The following text shows that under certain conditions the method of struc-
tural risk minimization may be utilized for solving ill-posed measurement
problems. We shall prove that as the number of measurements increases, a
sequence of solutions obtained by using the method of structural risk mini-
mization converges to the desired function f(t).
A6.2
THEOREMS ON ESTIMATING FUNCTIONS USING INDIRECT
MEASUREMENTS
Consider a linear, completely continuous operator A acting from the space
L 2 into the space C, and let A * be the conjugate operator of A. Then the
operator A *A is also completely continuous. Let
be a complete system of its eigenvalues and let
cPl (t), ..., cPm(t), '..
be a complete orthonormal system of its eigenfunctions.
Consider also operator AA*. It has the same set of eigenvalues, to which
a complete orthonormal system of eigenfunctions
t/Jl (x), ..., t/Jm(x), '..
corresponds. Elements of cPk and t/Jk satisfy the relations
AcPp(t) = Apt/Jp(x),
A*t/Jp(x) = ApcP(t),
p = 1,2,
,
p = 1,2,
.
(A6.4)
A solution of the operator equation (A6.1) can be expanded in a series in
the system of functions cPp(t), p = 1, ... :
00
f(t, a{J) = L a~cPp(t).
p=l
We shall consider the function
n(i')
f(t, at) = L afcPp(t)
p=1
(A6.5)
(A6.6)

274
A6 ESTIMATING FUNCTIONS ON THE BASIS OF INDIRECT MEASUREMENTS
to be an approximation to the solution (A6.5). Here n(f) is the number of
terms in the expansion (to be determined below) and ap = (aJ, ..., a;(P)
is
the vector of parameters which yields the minimum for the functional:
(A6.7)
It turns out that under certain assumptions concerning the solution (A6.5) a
function n = n(f) exists such that as the sample size increases, the obtained
approximations approach in probability the solution (A6.5) of the operator
equation (A6.1).
The following three theorems are valid.
Theorem A6.1. As f increases, the sequence of approximations f(t, ap) con-
verges in probability to f(t) in the metric L 2, if the rule n = n(f) for choosing
the number of terms in expansion (A6.6) satisfies the conditions
n(f) ~ 00,
p-""(X)
(A6.8)
(A6.9)
To guarantee convergence in metric C, we make additional requirements.
Theorem A6.2. Let the conjugate operator A * be a bounded operator from
space C into L 2 and the solution of operator equation (A6.1) be such that the
condition
00
sup L at: cf>p(t)
= T(m),
I
p=m
T(m) ~ 0
m-+oo
(A6.10)
is fulfilled. Then the conditions (A6.8) and (A6.9) are sufficient to ensure
convergence in probability of the functions f(t, ap) to f(t) in C metric.
Theorems A6.1 and A6.2 thus assert that if one approximates the solution
of (A6.1) by means of an expansion in a finite number of eigenfunctions
of the self-adjoint operator A *A, then under appropriate choice of a num-
ber of terms in the expansion (satisfying the conditions (A6.8) and (A6.9))
the method of minimizing empirical risk (A6.7) ensures the convergence in
probability of the obtained solutions to the desired one.
Now consider a structure in which element Sn is a set of functions that are
expanded on the first n eigenfunctions. Let us denote by IAI the norm of the

A6.2 THEOREMS ON ESTIMATING FUNCTIONS USING INDIRECT MEASUREMENTS
275
operator A acting from Lz into C-that is, the smallest value IAI for which
the following inequality holds:
where IF(x)/c is the norm of function F(x) in the space Nand /f(t)IL> is the
norm of function f(t) in the space M. In the next theorem we show that if
noise is such that
p> 2,
(A6.11)
then with probability 1 -
11 for sufficiently large n the inequality
Remp(a;)
R(a;) S ----;-----r===¢===O'=:::=====<====\-
(
I n (In ~ + 1) - In 11 )
1-2Tna(p)~
f
+
holds, where
(A6.12)
The goal is to prove that by choosing the number n of an element Sn which
contains the function that minimizes the right-hand side of inequality (A6.12)
under constraint
f
n = n(f) S Inz f'
one satisfies conditions (A6.8) and (A6.9).
In other words, we will show that the standard procedure of the method
of structural risk minimization leads to the construction of a sequence of
functions that converges to the solution of the operator equation (A6.1).
Theorem A6.3. Let a solution of the operator equation (A6.l) belong to the
space Lz and let the condition (A6.11) be satisfied. Then with probability 1 -
11
the bound (A6.12) is valid and the SRM principle based on this bound specifies
a (random) sequence
n = n(f)
such that for
n*(f) = min (n(£), _f_)
Inzf

276
A6 ESTIMATING FUNCTIONS ON THE BASIS OF INDIRECT MEASUREMENTS
the following conditions are satisfied
n*(£) ~ 00,
f--->oo
n*(£) In£ ~O.
£
f--->oo
(A6.13)
Thus Theorems A6.1 and A6.2 point to a class of methods that ensures
convergence of the sequence of obtained functions to the solution of the op-
erator equation, while Theorem A6.3 asserts that the SRM methods belongs
to this class.
A6.3
PROOFS OF THE THEOREMS
A6.3.1
Proof of Theorem A6.1
The proof of this theorem is based on the technique that was developed for
proving Theorem A6.2.
Let the conditions of Theorem A6.1 be satisfied. Denote by
n(f)
f(t,af) = La;4>k(t)
k=1
the preimage of the function
n(f)
F(x,af) = LAka~lfIp(x),
k=)
which minimizes the value of the empirical risk
1
f
(n(f)
)
2
Remp(a) = e~
Yj - f; Akaklflk(Xj)
Our goal is to prove that f(t, af) converges in probability to
00
f(t) = L
a~4>dt)
k=l
(A6.14)
in the metric L2 , or equivalently that the sequence of random variables
(A6.15)
converges in probability to zero as £ increases.

(A6.16)
A6.3 PROOFS OF THE THEOREMS
277
Note that since the basis functions are orthonormal the following equality
holds:
n(f)
00
V(e) = 2: 131 + 2:
(ag)z = T1(n(£)) + Tz(n(£)),
k=1
k=n(f)+1
where 13k = a; - ag.
Since the solution belongs to L z, the sequence Tz(n(£)) tends to zero as
n(e) increases. Therefore to prove the theorem it is sufficient to show that
We bound the quantity
n(f)
T1(n(f)) = 2:f3f.
k=1
Let a, = (a), ''', a;(f)) be a vector which minimizes the empirical risk (A6.14).
We then rewrite (A6.14) for
(
I
n(f))
(}
1
n(f)
n(f))
f3f = f3f' ..., f3,
=
af -
£¥O, ... , af
- ao
in the form
(A6.17)
where
00
Yj
~j + 2: AkagifidXj)'
k=n+}
Denote by K the covariance matrix with elements Kkq given by
and by G the n-dimensional vector with coordinates G = (G}, ... ,Gn)T. Then
the vector 'Y = (f3] A}, ..., f3;A n )T which yields the minimum for (A6.17) is
given by

278
A6 ESTIMATING FUNCTIONS ON THE BASIS OF INDIRECT MEASUREMENTS
Therefore the bound
is valid.
On the other hand the inequality
n(f)
n(f)
11'1 2 = I)I3;Ak )2 > A~(f) '2:,(13;)2 = A~(f)Tl(n(f))
k=1
k=J
holds true. From the inequalities (A6.18) and (A6.19) we obtain
(A6.18)
(A6.19)
Thus to prove the theorem it is sufficient to bound from above the norm of
the matrix K- J and the norm of the vector G.
Note that the norm of K does not exceed JLmax, the largest eigenvalue of
the matrix; also note that the norm of the matrix K- 1 is bounded as follows:
where JLmin is the smallest eigenvalue of the matrix K.
Therefore we obtained the following bound:
(A6.20)
To bound JLmin from below we consider the positive definite quadratic form
which we shall examine in the domain
n
(A6.21)
Since any completely continuous operator A acting from Lz into C is bounded,
the inequality

A6.3 PROOFS OF THE THEOREMS
279
holds, which implies that in the domain (A6.21) the inequality
is valid.
Now consider the expression
Observe that
(A6.22)
Using a rotation transformation, we arrive at a new, twice orthogonal system
of functions "'*(X)I, ..., ",;(x) such that
n
n
(A6.23)
where ILl, ... , ILn are eigenvalues of the matrix K.
To bound the eigenvalues we utilize Theorem 5.1 on the uniform conver-
gence of the means to their mathematical expectations for a class of bounded
functions. Since the functions F(x, yO) for IY*I :::; 1 are bounded by the quan-
tity IA 12/ A~, the inequality
{(
n(ln~+l)
(
1)2)}
< 4exp
-
e - -
e
e
e

280
A6 ESTIMATING FUNCTIONS ON THE BASIS OF INDIRECT MEASUREMENTS
is valid. Taking (A6.23) into account, we obtain
{ (
n(ln~ +1) ( 1)2)}
< 4 exp
£
-
8
- f.
£.
We shall require that
{
I
n(f)
}
4
P
S~.P f;(y.)2(l -I'dl > e'
oS lot·
This is satisfied for
(A6.24)
8* < £(n £) = IAI
2
-
,
A2
n
n (¥ +1) + In In £
1
£
+ f.
(A6.25)
It follows from (A6.24) that with probability 1 - 4/ln£ all eigenvalues
JL I, ... , JLn are located in the interval
1 - £(n, £) S JLk S 1+ £(n, f).
This implies that with probability 1 - 4/ln£ the inequality
min JLk > max (1 - £(n, f), 0)
k
(A6.26)
(A6.27)
is fulfilled. Substituting (A6.27) into (A6.20), we obtain that the inequality
(A6.28)
n (¥ + 1) + In In f
f
+
is valid with probability 1 - 4/1n£.
It remains to bound the quantity IGI 2:

A6.3 PROOFS OF THE THEOREMS
281
For this purpose we compute the expectation
EIGI2 = E ~ G2 < (J"2 + T2(O) n = C~
6
k-
£
£'
k=1
where C is a constant that does not depend on £ and n. To bound IGI we
utilize Chebyshev's inequality for the first moment of a positive random
variable g
P{g> e} < Eg,
e
where e = (Cnln£)/£. Since EIGI 2 < Cnl£, we obtain
P{IGI 2
CnlnE}
_1_
>
£
< In£'
Thus with probability 1 - 1I In £,
(A6.29)
When we substitute (A6.29) into (A6.28), we obtain that for £ sufficiently
large the inequality
T ( )
Cn In£
1 n <
2
£A~ (1 - 'Al"T Jnln£ )
A'l
£
+
is fulfilled with probability 1 - 51 In£, where C is constant. Inequality (A6.29)
implies that T1(n(f)) tends to zero in probability as
-i-Jn(£) In£ -+ O.
An(l)
£
(->00
The theorem is proved.
A6.3.2
Proof of 'rheorem A6.2
Now let additionally the operator A * be bounded from space L2 into space
C:
I/(t, u)lc::; IA*IIF(x, U)IL2
and let the solution of the operator equation (A6.1) obey the additional
restriction
00
sup L
~4>k(t) -+ O.
I
£->00
k=n+l
(A6.30)

282
A6 ESTIMATING FUNCTIONS ON THE BASIS OF INDIRECT MEASUREMENTS
We show that in this case the conditions
n(t) ----> 00,
P--'DO
(A6.31 )
_1_Jnet) In t
----> 0
(A6.32)
A~(p)
t
P--.oo
are sufficient so that the sequence of solutions r(t, ap) can converge in prob-
ability to the solution of the operator equation (A6.1) in the metric C.
We use the notation
DO
n(f)
v(t) = sup L
a(~cPk(t) - L
a;cPk(t) ,
I
k=l
k=l
where af = (al, ..., a;U)f is the vector that yields the minimal value for
(A6.14). Our purpose is to prove that
Observe that
n(f)
v(t) ~ sup Lf3kcPk(t) +sup
L
a~cPp(t),
I
k=!
I
k=n(p)+!
(A6.33)
where 13k = a; - a~.
In view of the condition (A6.30) of the theorem, the second summand in
(A6.33) tends to zero with increasing t. It is therefore sufficient to verify that
(A6.34)
To prove this we shall use the bound
(A6.35)
which is valid because the operator A * is bounded.
In the course of the proof of Theorem A6.1 it was shown that the bound
n
n InR
T!(n(t)) = Lf3; < c------------____::_
pol
iA: (1_21~t
0(ln2i/0 ~ 1) + Inlni ):

A6.3 PROOFS OF THE THEOREMS
283
holds with probability 1 - 4/1n£. Substituting this bound into (A6.35), we
obtain that with probability 1 - 4/ In£ the inequality
is satisfied. This bound implies that T3(£) approaches zero in probability
provided that
-i-Jn(£) In £ ------- O.
An(f)
f
(---+:JQ
Theorem A6.2 is thus proved.
A6.3.3
Proof of Theorem A6.3
Let the number n(e) of terms in the expansion of the solution of an operator
equation satisfy the condition
£
nee) ~ -2-
In f
and be determined by the minimum value on the bounds of the risk (A6.12)
over the elements of the structure. We show that if the solution of the oper-
ator equation (A6.1) satisfies
L
a~eJ>p(t)
= L(a~)2 < 00
k=1
Lz
k=1
(A6.36)
and the errors of measurements are such that (A6.11) is valid, then the
algorithm that chooses the element of the structure by minimizing (A6.12)
satisfies the conditions
n(£) ------- 00,
f---+oo
-i-Jn(£)ln£
0.
An(f)
f
f---+oo
To prove the theorem we need the following lemma.
(A6.37)
(A6.38)
Lemma. Let the noise of the measurements be such that the inequality
p>2
(A6.39)

284
A6 ESTIMATING FUNCTIONS ON THE BASIS OF INDIRECT MEASUREMENTS
holds true. Then for a set offunctions satisfying the conditions
00
Lz
(A6.40)
and for a sufficiently large n the inequality
P E (y - A {2:~~l a k4>k(t)}r
p
21AI2T
Tn = SUp
2
<
2'
P > 2
(A6.41 )
a
E (y - A {2::~l ak4>k(t) })
An
holds, where IAI is the norm of the operator A from L 2 to C.
Proof Recall that
00
y = F(x, ao) + t" = L
Aka~l/Jk(x) + f
k=!
Therefore
where
P E (~+ <5(n,x) -
2:~~~ Ak{3kl/Jk (x)) 2p
Tn = SUp --'------------------c-,
a
E (t" + <5(n, X) - 2::~~ Ak{3kl/Jk(X)r
00
(A6.42)
(A6.43)
<5(n,x) = L
Aka~l/Jk(X).
k=n(f)+!
We shall bound separately the denominator and numerator of the right-hand
side of (A6.42):
(
n(f)
)
2
E
~+<5(n,x)- f;A k{3kl/Jk(X)
=o.2+B2+<5~,
where
(1"2
Et"2
n(f)
8 2
LA~{3l,
k=!
00
<52 =
n

A6.3 PROOFS OF THE THEOREMS
285
To bound the numerator we use the Minkowski inequality
We obtain
(A6.44)
Since the desired function belongs to Lz and an operator A acting from Lz
into C is bounded, we have
sup 18(n,x)1 ::; IAI
x
n(f)
sup L Akf3k rfik (x)
::; IAI~ .
x
k=l
(A6.45)
Substituting (A6.45) into (A6.44) we obtain for sufficiently large n the fol-
lowing bound for the numerator:
(
)
Zp
n(f)
BZ
'E
y - t;Akllk<h(X}
S3(y'Ee'p + IAI' A;)'
Substituting in (A6.42) bounds for the numerator and the denominator and
taking into account that r 2: 1 and for large n we have IA1/An > 1, one obtains
<3IAlzr.
-
AZn
The lemma has been proved.

286
A6 ESTIMATING FUNCTIONS ON THE BASIS OF INDIRECT MEASUREMENTS
Based on the result of this lemma one can assert that for the function
F(x, an which minimizes the empirical risk (A6.7) in the set
n
F(x, a) = L AkakljJ(x)
k=d
with probability 1 -
1] for sufficiently large £ the inequality
(A6.46)
+
holds.
Now for a given set of R observations we choose n = n(R) that defines
the function minimizing the right-hand side of this bound. We prove that the
chosen n = n(R) is such that expression (A6.37) and (A6.38) of convergence
in probability are valid.
First we verify that (A6.37) is valid. Assume the contrary. Let ag i- 0,
m < n, but at the same time let the inequality
m (In ~ +1) - In 1]
R
+
+

A6.3 PROOFS OF THE THEOREMS
287
be fulfilled for any £ > £0. Represent the quantity R(a7') in the fonn
R(a;") = E (Y - ~ A,a;'t-.(x)r
= E ({ + Sex, m) _ ~ AplJp""p (x)) 2.
where
00
B(x,m)= L
Ak~l/Jk(X),
k=m+!
and bound this quantity from below:
00
R(ar) > R(ao) = u 2 + L
(Aka~t
k=m+!
Thus, the bound
+
(A6.47)
is valid with probability at least 1 - 71. Now we transfonn and bound the
expression appearing in the numerator on the right-hand side of (A6.47):

288
A6 ESTIMATING FUNCTIONS ON THE BASIS OF INDIRECT MEASUREMENTS
We obtained this inequality because minimum of empirical risk is achieved
when 13k = a; - a~. Note that in view of the law of large numbers we obtain
Therefore the inequality
x
00
a.2 + L
(Aka~)2 < cr2 + L
(Apa~)2
k==m+!
p==n+!
(A6.48)
is satisfied with probability 1 -
71 for all sufficiently large f.
However, for m < n the inequality (A6.48) is obviously invalid with prob-
ability 1. The construction proves the validity of (A6.37).
Now we show that (A6.38) is also valid. For this purpose note that the
inequalities
> ~i~ ~t (g ~ y8(Xi' n) - t, Ap/lp.pP(Xi)) ,
(A6.49)
always hold. Compute the expectation of the left-hand side of inequality
(A6.49):
Observe that for a fixed n the relation

A6.3 PROOFS OF THE THEOREMS
289
is valid. Therefore for fixed n the inequality
R ernp (0';)
Z
lim -----;-----------.==================___ < if + Tz(n )
f~CXJ
n (In¥+ 1) -In 11/4
1 _ 41AI
2r a(p)
A~
R
+
(A6.50)
is fulfilled.
Since the inequality (A6.50) is valid for any fixed n and the conditions
n(R) ~ 00
l~oo
are fulfilled, it follows that the inequality
lim
min
t ~CXJ n(f)<f/ In2 f
R
(
n(f)
ernp 0'[
n(R) (In¥+ 1) -In 11/4
R
+
(A6.51)
holds true.
On the other hand we utilize the following bounds which will be derived
as follows:
(A6.52)
(A6.53)
Here
0'[
and
Yf
are
the
values of the
parameters which
minImIZe
Rernp(O', Yf, n(R), and ~ is a constant that does not depend on f. (We shall
verify these bounds below.)

290
A6 ESTIMATING FUNCTIONS ON THE BASIS OF INDIRECT MEASUREMENTS
Now using Chebyshev inequality we obtain
{I
2 (
n(f) + 1) I
}
An(£)
P l Remp(af, Yf,n(£)) -
[T
1 -
£
> 6
<
6 2£2
.
Recall that we chose such n(£) that n(£) :::; £/ In2 f. Therefore
and consequently the convergence
(A6.54)
is valid with probability one according to Borel-Cantelli lemma.
Therefore with probability one, the inequalities (A6.51) and (A6.54) hold.
This implies that with probability one we obtain
This expression constitutes the statement of Theorem A6.3.
In the proof of Theorem A6.3 we have used the equality (A6.52) and the
inequality (A6.53). We shall now derive them. Consider the expression
U sing a rotation transformation we arrive at a coordinate system l/Jt (x), ...,
l/J;+I such that
fL l/J; (Xi )l/J; (Xi) = {bP
i=1
In this coordinate system we obtain
for k = q,
for k i- q.

where
We have thus obtained
A6.3 PROOFS OF THE THEOREMS
291
(
Gk = L ~i rfi;(Xi)'
;=1
The theorem is proved.


7
STOCHASTIC
ILL-POSED PROBLEMS
In the Appendix to Chapter 6 we showed that the SRM principle can be used
for solving special stochastic ill-posed problems, namely, for problems of in-
terpreting the indirect measurements. In this chapter we consider stochastic
ill-posed problems as a generalization of the classical ill-posed problems pre-
sented in Chapter 1 and in the Appendix to Chapter 1. To solve stochastic
ill-posed problems, we utilize the same regularization method that we used
in the Appendix to Chapter 1 for solving classical (deterministic) ill-posed
problems.
Using the theory of stochastic ill-posed problems, we then consider the
problem of density (conditional density) estimation. We construct different
estimators of the density (conditional density) which include both classical
nonparametric estimators and new ones.
7.1
STOCHASTIC ILL-POSED PROBLEMS
Consider the operator equation
Af=F
(7.1 )
defined by the continuous operator A which maps in a one-to-one manner
the elements f of a metric space £] into the elements F of a metric space
£2.
Suppose that a solution f E :F c £] of Eq. (7.1) exists and is unique, but
unstable; that is, the problem of solving (7.1) is ill-posed (see Chapter 1 for
the definition of ill-posed problems).
293

294
7 STOCHASTIC ILL-POSED PROBLEMS
We would like to find the solution to this equation when instead of Eq.
(7.1) we are given its approximations.
We will distinguish between two cases:
Case 1. The Equation with Approximately Defined Right-Hand Side. We
consider the situation where instead of the right-hand side F of Eq. (7.1)
we are given a sequence of random (determined by probability spaces
(fif,fr,PP),f = 1,2, ...) functions
FI , ... , Ff , .. ·
which converge in probability to the unknown function F.
(7.2)
Case 2. The Equation with Both the Operator and the Right-Hand Side
Approximately Defined. We consider the situation where instead of Eq. (7.1)
we are given both a random sequence of approximations (7.2) to the function
F on the right-hand side of equality (7.1) and a random sequence of operators
in (7.1)
(7.3)
(determined by probability spaces (Of, Ff , Pf ), f = 1,2, ...), which converges
in probability to the unknown operator A (the distance between two opera-
tors will be defined later).
In other words, the following schemes are considered: For any given f
there exists a set fif of random events w E fir such that any w· E fif specifies
a (random) function Ff = F(x, w·) (in the space £2) and there exists a set Of
of random events such that any W· E Or specifies an operator A r = A(w·).
In the first case on the basis of the sequence of (random) functions (7.2)
converging in probability (in metric PE~ (F, F;) of the space £2) to the un-
known function F
lim P{p(F,Fr) > e} = 0,
f ->')0
one has to find a sequence of functions
Ve > 0,
(7.4)
converging in probability (in the metric PEl ([, iF) of the space £1) to the
solution of Eq. (7.1).
In the second case, on the basis of the both sequence of functions (7.2)
converging in probability to F and the sequence of operators (7.3) converging
in probability (for a given distance IIAf - All) to operator A of Eq. (7.1)
lim P{IIA; - All> 5} = 0,
r-rx.
V8 > 0,
(7.5)

7.1 STOCHASTIC ILL-POSED PROBLEMS
295
one has to find a sequence of functions
converging in probability (in the metric PEl (f, Ir) of the space £)) to the
solution of Eq. (7.1).
We call the problem of solving Eq. (7.1) on the basis of random sequence
(7.2) a stochastic ill-posed problem with approximations on the right-hand
side.
We call the problem of solving Eq. (7.1) on the basis of both random
sequence (7.2) and random sequence (7.3) a stochastic ill-posed problem with
approximations on the right-hand side and approximations on the operator.
Example 1: Problem of Density Estimation. In Chapter 1 we considered the
problem of density estimation as a problem of solving the equation
l~ pet) dt = F(x),
(7.6)
where the distribution function F(x) is unknown, but we are given the data
x), ...,xr, ....
In this example the space Or of random events is determined by the space
of samples w = X), ... ,Xr of size e. The random functions can be determined
by w as follows:
1
f
Fp(x, w) = f L O(x - Xi)'
i ==)
(7.7)
It is known (Glivenko-Cantelli theorem) that for these functions convergence
(7.4) takes place, where
p(F(x), Fr(x)) = sup IF(x) - Fr(x)l·
x
Therefore the problem of density estimation is the following: On the basis
of the (random) approximations Ff , e= 1,2, ... (on the basis of observations
x), ..,xr, ...), find a sequence of functions Ir, e= 1,2, ..., that converges in
probability to the solution of Eq. (7.1).
Example 2: Problem of Ratio of Densities Estimation. The optimal (Baye-
sian) decision rule in the pattern recognition problem has the form
rex) = 0 {P)(X) _~},
P2(X)
1 ~ p)

296
7 STOCHASTIC ILL-POSED PROBLEMS
where PI (x) and P2(X) are the probability densities of vectors of the two
classes in the X space, and PI is probability of occurrence of the vectors
of the first class. Therefore to estimate from the training data the optimal
decision rule, one has to estimate from the data the value PI (which is easy)
and the function
T(x) = PI (x)
P2(X)
determining the ratio of the densities.
From the formal point of view to estimate the function T(x) from the
training set means to solve the integral equation
(7.8)
in the situation where the distribution functions F(2)(x) and F(I)(X) of the
vectors belonging to the different classes are unknown, but we are given
examples
XI, ''',Xf
containing a examples
XI, ... ,Xa
belonging to the first class and containing b examples
belonging to the second class.
In this example the space Of of random events is determined by the space
of samples w = XI, ..., Xa,XI, ..., Xb of size f = a + b.
The random functions Fjl)(x) and F?)(x) are determined by the event w
(sample XI, ... ,Xf) as follows:
(1)
1 ~
Ff
(x,w) = - L...J O(x - Xi)'
a i=l
b
F;2)(x,w) = ~ L O(x -Xi)'
i=l
(7.9)
Thus the problem of estimating the ratio of densities is the problem of solv-
ing the integral equation (7.8) where instead of the right-hand side F(I)(x)
of the approximation (7.9) is given and instead of exact operator which
is determined by the function F(2) (x) the approximation to operator which
is determined by the function (7.9) is given.

7.2 REGULARIZATION METHOD FOR SOLVING STOCHASTIC ILL-POSED PROBLEMS
297
7.2
REGULARlZA1'ION METHOD FOR SOLVING STOCHASTIC
ILL-POSED PROBLEMS
For solving stochastic ill-posed problems we use the same regularization
method considered in the Appendix to Chapter 1 for solving deterministic
ill-posed problems.
Below we, once more, describe this method. Consider a lower semi-
continuous functional W(n satisfying the following properties:
1. The solution of Eg. (7.1) belongs to D, the domain of definition of the
functional W(f).
2. The functional W(f) takes on real nonnegative values in D.
3. The sets Me = {f: W (f) ~ c} are compact in E 1.
Let us construct the functional
where PE2 (., .) is a metric in the space £2, F, = F, (x) is a random function,
and 'YI > 0 is a parameter of regularization. Let the function fl provide the
minimum to this functional.
Below we consider the case where
'Yf
------t 0,
as P ---> 00.
Under these conditions the following theorems describing the relationship
between the distributions of two random variables-namely, random variable
PE2 (F, Fe) and random variable PEl (f,ff)-hold true.
Theorem 7.1. For any positive e and ft there exists a positive number nee, ft)
such that for all P> nee, JL) the inequality
(7.10)
is fulfilled.

298
7 STOCHASTIC ILL-POSED PROBLEMS
for the case where E1 is a Hilbert space the following theorem holds true.
Theorem 7.2. Let £1 be a Hilbert space, A in (7.1) be a linear operator and
W(f) = IlfW = / f2(t)dt.
Then for any positive B there exists a number n(B) such that for all e > n(B)
the inequality
is fulfilled.
These theorems are a generalization of Theorems Al.1 and Al.2 for the
stochastic case (see Appendix to Chapter 1).
Corollary. From Theorems 7.1 and 7.2 it follows that if approximations Fr on
the right-hand side of the operator equation (7.1) converge to the true function
F(x) in the metric of space £2 with the rate r(e), then the sequence of the
solutions to the equation converges in probability to the desired one if
and 'Yf converges to zero with e -... 00.
This chapter also considesr a problem of solving the operator equation
Af=F
under the condition where (random) approximations are given not only for
the function on the right-hand side of the equation, but for the operator
as well. We will assume that instead of the exact operator A we are given a
sequence of approximations At, e= 1,2, ...,defined by a sequence of random
continuous operators which converge in probability (below we will specify the
definition of closeness of two operators) to operator A.
As before, we consider the problem of solving the operator equation by a
regularization method-that is, by minimizing the functional
(7.11 )
(Under the considered requirements to operator A r and function F1 E £'2
there exists the minimum of this functional. The uniqueness of minima is not
necessary.)

7.3 PROOFS OF THE THEOREMS
299
We will measure the closeness of operator A and operator A r by the
distance
IIAd -
AfIIE~
IIA f - All = sup
W 1/2(f)
.
fED
(7.12)
Theorem 7.3. For any e > 0 and any constant C1, C2 > 0 there exists a value
Yo > 0 such that for any
Yf -s: Yo the inequality
P {PEt (ft,!) > e} :s; P {PEz(Ff, F) > C1VYf"} + P {liAr - All> C2JY(}
(7.13)
holds true.
Corollary. From this theorem it follows that if the approximations F( on the
right-hand side of the operator equation converge to the true function F(x) in
the metric of the space £2 with the rate of convergence r(f), and the approxi-
mations At converge to the true operator A in the metric defined in Eq. (7.12)
with the rate of convergence rA (1'), then there exists a function
ro(l~) = max {r(f), rA (f)} ~ 0
t~x
such that the sequence of solutions to the equation converges in probability to
the desired one if
ro(f) ----+ 0
VYi t~oo
and Yr converges to zero with e -> 00.
7.3
PROOFS OF THE THEOREMS
7.3.1
Proof of 'rheorem 7.1
By definition, for any e the chain of inequalitiest
Yf W(ff)
:s; R(ft, Fp) :s; R(f, Fp)
= Pi(Af, Fi ) + Yf W(f) = p~(F, Fd + Yf W(f)
(7.14)
is valid, where ff is the function that minimizes R(f, Fr ). Therefore the in-
equality
2(F
F)
W (ft) :s; W (f) + P2
f ,
Yf
is valid. Moreover, clearly
t Here and below we set Pf:, = Pi for notational simplicity.
(7.15)
(7.16)

300
7 STOCHASTIC ILL-POSED PROBLEMS
Utilizing the triangle inequality and the bounds (7.14) and (7.16), we obtain
the inequalities
pz(Aff ,F) 'S pz(Aff ,Ft} + pz(Ff , F)
'S pz(Fe, F) + J'-pi-(-Ff-,-F-)-+-Y-eW-(f-).
(7.17)
Furthermore, for any e > 0 and C > W(f) the equality
P{Pt(ff,f) 'S e}
~ P {PI (f"f) <: eIW(f) + Pi(J:;,F) <: c} P { W(f) + pi(~,F) <: c}
+ P {PI (f"f) <: e IW(f) + Pi(;,' F) > c} P { W(f) + Pi(;,' F) > c}
(7.18)
is valid. Now let the condition
be fulfilled. Then it follows from (7.15) that the inequality
is valid; that is, f, belongs to a compactum. In view of the lemma on the
continuity of the inverse operator A -1 to the operator A on a compactum (see
Appendix to Chapter 1), we obtain that there exists a 5 such that inequality
is fulfilled as long as inequality
fJ2(Aff , F) 'S 5
is fulfilled. Hence we have for sufficiently large £, that
P {PI (f"f) <: eI W (f) + pi(~, F) <: c}
2: P {",(Afl, F) <: 81W(f) + pi(~,F) <: c} .
(7.19)

7.3 PROOFS OF THE THEOREMS
301
Observe now that in view of (7.17) the inequality
pz(Aff , F) ~ J'Yf(C - W(f)) +J'Yf(C - W(f)) + "If W(f)
= JYf(JC- W(f) + JC)
is fulfilled in the domain
Z(F F)
W(f)+Pz
f,
~c.
"If
Since "If -
0 as e-
00 for any 8 starting with e> n, the inequality
is fulfilled. And since (7.19) is valid for all I; > n, the inequality
is fulfilled. Thus it follows from (7.18) that for any 8 > 0 there exists n such
that for all e> n the inequality
is fulfilled, and hence also the inequality
Taking into account that
C> W(f)
and introducing notation
It = C - W(f),
we obtain from (7.20) the assertion of the theorem:

302
7 STOCHASTIC ILL-POSED PROBLEMS
7.3.2
Proof of Theorem 7.2
1. An arbitrary closed sphere in Hilbert space (i.e., a set of vectors of the
form {f: Ilf - fo II :::; d}) is weakly compact. Therefore, as far as weak
compactness in the space £) is concerned, we are under the conditions
of Theorem 7.1. Consequently, for any positive e and It there exists a
number n = n(e, It) such that for f > n(e, It) we obtain
P{I(fr,g) - (f,g)1 > e}:::; P{pz(Ff,F) > VWyd,
(7.21)
where the expression
(q,f) =Iq(t)f(t) dt
defines the general form of linear functional in Hilbert space.
2. According to the definition of a norm in a Hilbert space we have
IIff - fW = (ff - f, fr - f)
= IlfrI1
2 -llfI1
2 + 2(f, f-h)·
Utilizing the inequality
P{a +b> e} :::; P {a > ~} + P {b > ~},
we obtain
P{llh - fl1 2 > e} :::; P {llffl1
2 -llfl1
2 > ~} + P {2(f, f - fr) > ~} .
(7.22)
In order to bound the first summand on the right-hand side we shall
utilize the inequality (7.15), taking into account that
W(f) = Ilf11
2
.
We thus obtain
Therefore

7.3 PROOFS OF THE THEOREMS
303
We bound the second summand (7.22) by means of (7.21), setting 11- =
e12:
P {(f, f - It) > ~} " P { pW.;,' F) > ~ } .
Combining the last bound with (7.22), we arrive at the assertion of the
theorem:
P{IIft - fll2 > e} 5c 2P {pi(Ff, F) > ~}.
"'If
2
The theorem thus has been proved.
7.3.3
Proof of Theorem 7.3
Since fr minimizes the functional
we have
"'If W (ff) 5c R;, (ff' Fe, A e) 5c R;, (f, Ff , Ad
= fJi(Ad, Ff ) + "'If W(f),
(7.23)
where f is the desired solution of the equation. From (7.23) we find
Since according to the triangle inequality we have
P2(Ad, Fe) 5c P2(Ad, F) + P2(F, Ff )
5c IIAt -AIIW1j2(f)+P2(F,Ff ),
(7.24)
we obtain
Taking into account that
Pi(Aeft , Fe) 5c R;, (fe, Ff , Af )
from (7.25) and (7.23), we obtain
(7.26)

304
7 STOCHASTIC ILL-POSED PROBLEMS
From this inequality using (7.24) and (7.12), we derive
P2(AIt, F) < P2(Aff ,AfIt) + P2(Adf, Ff ) + P2(Ff ,F)
< WI/2(ff)IIAf -All
+ (")If W(f) + (11Af - AIIWI/2(f) + P2(F, Ff)f) 1/2
+ P2(Ff ,F) = ..;y; (P2~F) + WI/2(ff) IIA~All)
+ ..;y; (W(f) + (P2(Ff ,F) + WI/2(f) IIAf - All) 2) 1/2
fif
fif
(7.27)
Let us choose arbitrary constants CI, C2 > O. Consider two events:
A -
{
. P2(F, Ff ) < C }
-
w .
..;y;
_
I
,
B = {
. IIAf - A II < c }
w.
fif
-
2
.
Suppose that event A and event B occur simultaneously. Then from (7.25)
we obtain
From (7.28) and inequality (7.27) we obtain
P2(Aff ,Af) Sc 2d.;:y;.
(7.29)
Note that according to the properties of the functional W (f), inequality (7.28)
means that the solution It belongs to some compactum. According to the
lemma about the inverse operator, considered in the Appendix to Chapter
1, the inverse operator A -I is continuous on this compactum; that is, for any
£ > 0 there exists 8 > 0 such that
(7.30)
as soon as inequality
is satisfied. According to (7.29) this inequality holds if

7.4 CONDITIONS FOR CONSISTENCY OF THE METHODS OF DENSITY ESTIMATION
305
Therefore for any e > 0 there exists 'Yo > 0 such that for all 'Yr S 'Yo events
A and 13 imply the inequality (7.30). In other words, for all 'Yf :s; 'Yo the
inequality
P{Pl(ftJ) > e} S P{AUB} S P{A}+P{B}
= p{P2(Ff1 F) >c1}+p{IIA p -AII >C2}'
VYi
VYi
Here
'Yo = 'Y(C1,C2, W(f),A-l,e);
C1,C2,e are arbitrary fixed constants.
Theorem 7.3 has been proved.
7.4
CONDITIONS FOR CONSISTENCY OF 'rHE METHODS OF DENSITY
ESTIMATION
Consider the specific stochastic ill-posed problems: the problem of density
estimation and the problem of the ratio of two densities estimation.
Consider the problem of density estimation from one of the following
normed spaces:
• Hilbert space H with the norm
WH(fJ = Vl f'(x)dx.
• Sobolev space Sm with the norm
where fCk) (x) is the kth derivative of the function f(x), and ak > 0 are
some constants.
• Space of smooth continuous on functions on [0,1] with bounded variation
V (f),
possessing
an
mth
derivative
(m ~ 0)
that
satisfies
the
Lipschitz condition of order S (S > 0):
IfCm)(x) - j<m)(y'11
sup
s
) < 00
x,yEla,bj
Ix - yl
(if m > 0, then function f has bounded variation V (f); the requirement
of bounded variation is essential when m = 0). For this space we consider
the norm
wck(f) = V(f) +t
sup Itk)(x)1 +
sup
Ij<m) (x) - f~m)(Y)I.
k=O xE[O,I]
x,yE[a,b]
Ix - yl

306
7 STOCHASTIC ILL-POSED PROBLEMS
In all these cases we consider the regularization functional W (f) of the
form
It is easy to check that functional W (f) possesses all properties that are
required for regularization terms.
Now let us consider the problem of estimating a density belonging to one
of the sets of functions described above.
That is, we have to solve the integral equation
LX pet) dt = F(x),
(7.31)
where instead of the right-hand side of Eq. (7.31) only the sequence of
approximations
constructed on the basis of observations
XI, ""Xf,'"
is available.
For solving this equation we will use the regularization method; that is,
we will minimize functional
where
P£2 (., .) is the metric in space of (absolutely continuous) functions
F(x), and A is the operator
Af = LX f(t) dt.
In the space £2 we will use one of the metrics:
1. Metric of the L I (0, 1) space:

7.4 CONDITIONS FOR CONSISTENCY OF THE MHHODS OF DENSITY ESTIMATION
307
2. Metric of the L 2(0, 1) space:
3. Metric of the C(O, 1) space:
PE2(FI , F2) = sup IFI (x) - F2(x)l·
x
Since the distance in metric C is not less than in metrics L I (0,1) or Lz(O, 1),
the bound obtained with this metric will be also valid for the other two
metrics.
Suppose that
II, ···,ff, '"
is a sequence of the solutions obtained by means of the regularization method.
Then according to Theorem 7.1 for any e and any I-t the inequality
P{PEl(ff,f) > e}:S P{supIFf(x) - F(x)1 > JT'fl-t}
x
holds true for sufficiently large f. According to the Kolmogorov inequality
(see Chapter 1, Section 11.3) for sufficiently large £, one has
P{supIFf(x) - F(x)1 > €} :S 2exp{-2€2£}.
x
Therefore there exists a e(e, I-t) such that for e > £(e, I-t) the inequality
(7.32)
is fulfilled.
If I(x) E L2(0, 1), it then follows from Theorem 7.2 and the Kolmogorov
inequality that for £ > f(e), the inequality
P{!(ff(X) - I(X))2 dx > e} :S 2exp{ -2T'(1-t£}
(7.33)
holds. Inequalities (7.32) and (7.33) imply that the solution If converges in
probability to the desired one (in the metric PEl (ff,!)) if
T'f ----t 0,
f --+00
eT'f ----t 00.
f--+oo
(7.34)
(In this case the right-hand sides of Eqs. (7.32) and (7.33) converge to zero.)

(7.35)
308
7 STOCHASTIC ILL-POSED PROBLEMS
Inequalities (7.32) and (7.33) also imply that the solution ff converges
almost surely to the desired one (in the metric PEl (ff' f)) if
£
"Yf- --- 00.
In £ f-..x
(In this case for all E: > 0 and IL > 0 the conditions of Borel-Cantelli lemma
L P{PE1(ff,f) > e}
f=1
< LP{sup IFR(X) - F(x)1 > J"YflL} < 2Le-2Y/ld < 00
f=1
x
f=1
hold true.)
7.5
NONPARAMETRIC ESTIMATORS OF DENSITY: ESTIMATORS BASED
ON APPROXIMATIONS OF THE DISTRIBUTION FUNCTION BY AN
EMPIRICAL DISTRIBUTION FUNCTION
This section shows that by using the regularization method with empirical
distribution functions Fp(x) instead of the unknown function F(x), one can
obtain the classical nonparametric density estimators: Parzen's windows, pro-
jective estimators, spline estimators, and so on.
Note, however, that approximations Fp(x) do not reflect an important
property of the distribution functions for which there exist densities. These
distribution functions F(x) belong to the set of absolutely continuous func-
tions, while the approximations Fp(x) are discontinuous functions. As we will
see in the next section, the continuous (spline) approximations to an unknown
distribution function implies new nonparametric estimators that differ from
the classical ones.
7.5.1
The Parzen Estimators
Estimators tor Unbounded Support. Let us specify the functional
R(f, Ff ) = Pi(Af, Fp) + "Yf W(f).
(7.36)
Below we use:
1. Distance in the L 2 metric:
PE,(F, F,) ~JI:(F(x) - F,(x))' dx.

7.5 ESTIMATORS CONSTRUCTED FROM EMPIRICAL DISTRIBUTION FUNCTION
309
2. Regularization functional of the form:
W(f) = I:(I: K(z - x)f(x) dX) 2 dz.
Here K(z - x) is the kernel of the linear operator
Bf =I: K(z - x)f(x) dx.
In particular if K(z - x) = t5P(z - x) the operator B defines the pth derivative
of the function f(x).
For these elements we have the functional
R Y1 (f,Ff )
=I: (l~ f(t) dt - Ff (X») 2 dx + YeI:(I: K(z - x)f(x) dX) 2 dz.
(7.37)
We show that estimators fy that minimize this functional are Parzen's win-
dows. Indeed, let us denote by !(w) the Fourier transform of the function
f(t) and by K(w) the Fourier transform of the function K(x). Then one can
evaluate the Fourier transform for the functions
F(w)
=
1 /00
.
-
F(x)e-1WX dx
27T' -00
_1 [00 e- iwx r f(t) dt = j~w)
27T' 1-00
1-00
IW
1 /00
.
1 /00 1
f
.
-
Fe (x)e- 1WX dx = -
- L O(x - xj)e-1WX dx
27T'
-00
27T'
-00 £ .]=1
Note that the Fourier transform for convolution of two functions is equal to
the product of the Fourier transforms of these two functions. For our case
this means that
1
[00
.
1
[00 ( [00
)
.
27T' 1-00 (K(x)*f(x))e-1WXdx = 27T'1-00
1-00 K(z -x)f(x)dx
e-1WZdz
= K(w)f(w).
Lastly, recall that according to Parseval's equality the L 2 norm of any function
f(x) within the constant 1/27T' is equal to the L2 norm of its Fourier transform

310
7 STOCHASTIC ILL-POSED PROBLEMS
-
-
f(w) (here f(w) is the Fourier transform of the function f(x)). Therefore one
can rewrite (7.37) in the form
This functional is quadratic with respect to f(w).
Therefore the condition for its minimum is
-
f
f,(w)
1 L .
-
-
-
-- -
-
e'wx; + yfK(w)K(-w)f(w) = O.
w2
Pw2
/=1
Solving this equation with respect to ft (w), one obtains
_
(
1
) 1
f
ft(w) =
-Le-
iWX
,
1 + Yfw 2K(w)K(-w)
f
)=1
Let us introduce the notations
1
gYf (w) =
2
(
1 + YfW K(w)K -w)
and
G",(x) =1:gy,(w)e
iWX dw.
(7.38)
To obtain an approximation to the density, one has to evaluate the inverse
Fourier transform
The last expression is the Parzen estimator with kernel G"f (x). Using differ-
ent regularizer functions (different functions K(u) in (7.37)), one can obtain
different Parzen's kernels.
Let us consider the important case
K(x) = 8(P+t)(x),

7.5 ESnMATORSCONSTRUCTED FROM EMPIRICAL DISTRIBUnON FUNCTION
311
where «5(x) is the Dirac «5 function, P 2: 0 (that is, we consider the case where
the desired function possesses p derivatives).
For this case the kernel is
/
00
eixw
Gy,p(x) =
1
2(p I) dw.
-00
+ YfW
+
After integration, one obtains
1
p
(
x
)
.
G
(x) =
'" sin
a + -- cos a
e-Ixlsma,/A(p)
y,p
2(p + 1)A(P) L.
'
A(P)'
,
,=0
where we denote
(7.39)
r = 0, ... ,p.
W(f)
7T(1+2r)
a, =
2(P + 1) ,
For the case p = °(the desired density belongs to L 2), Parzen's kernel is
Gy,o(x) = 2~ exp { - jt}.
For the case p = 1 (the derivative of the desired density belongs to L 2),
Parzen's kernel is
1
{ixi } (
x
.
IX I )
Gy,1 (x) =
41'A:: exp
-
4FA::.
cos 41'A:: + sm 41'A::
.
2y 4y
y 4y
y4y
y4y
Estimators for Bounded Support. The estimators considered above were
derived under the condition that the support of the density is infinite (to
derive Parzen's estimator we used Fourier transform). If the density con-
centrates on the finite support a S; x S; b, then Parzen's window gives a bias
estimate of the density. Indeed, for this case the integral is less than one:
rb
1
f rb
10 j(x)dx = f t1 10 Gy(X) dx < 1
(it equals one on the infinite support). Below, for this case we will derive
another estimator. Using the same method for deriving an estimator, one can
obtain corrections to Parzen's window, which make it suitable for a case with
finite support.
For simplicity we shall stipulate in relation to (7.37)
Jl'(F(x) - Fr(X))2 dx,
[b l(t)dt.

312
7 STOCHASTIC ILL-POSED PROBLEMS
We then obtain the functional
which we rewrite in the fonn
b
R(f, Fe) =l
[(F(x) - Fl (x))2 + '}'lF 2(x)] dx,
where we denote by F(x) the first derivative of the function F(x). The mini-
mum of this functional (in the set of functions F(x) for which the first deriva-
tive has a finite norm in L 2(a, b)) satisfies the Euler equation
'}'fF(x) - (F(x) - Fl(x)) = 0
F(a) = 0,
F(b) = 1.
(7.40)
Let F"f (x) be the solution of Eq. (7.40). Then the estimale of the density
is
flex) = F(x).
The solution of the linear equation (which is a sum of the particular solution
and the general solution) is
f
1
{
Ix - Xii}
f,,(t) = 2£v'Yf ~ exp
-
v'Yf
{
Ix - al }
{
Ix - bl }
+C1 exp
-
v'Yf
+ C2 exP
-
~
,
(7.41 )
where constants C1 and C2 are determined by conditions F(a) = 0 and F(b) =
1 are given by
{b- x·}
{x- - b}
C _
1
f
exp --:;yf
+ exp ~
1 -
2£v'Yf~
{b-a}
{a-b}'
/=1 exp --
- exp --
.JYi
.JYi
{a-x-}
{x--a}
C
2
_
1
l
exp ~
+ exp ~
-2fv'Yf~
{b-a}
{a-b}'
1=1 exp --
- exp --
.JYi
JYi
Therefore the estimate for density in the Parzen fonn has a regular Parzen
estimate and corrections for the ending points of the finite support. It is easy
to see that for infinite support the constants C1 and C2 are equal to zero.

7.5 ESTIMATORS CONSTRUCTED FROM EMPIRICAL DISTRIBUTION FUNCTION
313
7.5.2
Projection Estimators
Let the desired density f(x) belong to the set of functions whose pth deriva-
tive (p ~ 0) belongs to L 2(0, 77'). We looking for an estimator of the density,
fe(x), that minimizes the functional
Consider the approximation to the unknown density given by an expansion
in the orthonormal functions cPl(t), ..., cPk(t), .... We consider the expansion
in cos rt, n = 0, 1, ...,k, ..., which gives the simplest estimator.
Let us consider the approximation to the desired function in the form
12
00
f..At) = - + - '"" ar cos rt,
77'
77' L.J
r=l
(7.43)
where aI, ... , ar, ... are coefficients. Putting this approximation into (7.42), one
obtains that the minimum of this functional is reached when
1 e
- '"" cos rt·
f L.J
I
i=l
ar =
,
1+ 'Yer2(P+l)
r=1,2, ....
Note that two estimators-estimator (7.39) with a =°and b = 77' and esti-
mator (7.43) with p = D-describe on (0,77') the same function since both
estimators are the functions that minimize the same functional.
7.5.3
Spline Estimate of the Density. Approximation by Splines of
the Odd Order
Let the pth derivative of the density be a square integrable in (a, b). Let us
consider the functional which is constructed by the metric L 1(a, b)
and regularizer
W(f) = [b (f(P) (t)r dt.
Therefore we have to minimize the functional
(7.44)

314
7 STOCHASTIC ILL-POSED PROBLEMS
Consider the functional which slightly differs from (7.44):
Let us rewrite this functional in the form that is used in optimal control
theory:
Zo(t) = F(t),
Zi(t) = t(i-I)(t),
i = 1,2, ..., (p - 1),
t(P)(t) = u(t).
In this notation the problem of control theory is to minimize the functional
under restrictions
i;(x) = Z;+I(X),
i =1,2, ...,(p-1),
ip(x) = u(x).
The solution of this optimal control problem is the spline of odd order 2p + 1
t(2p+I)(X) = (-l)P sign(F(x) -FI(x»
fLf
satisfying thc conditions
r = p + 1, ...,2p + 1.
For p 2: 1 the approximations converge to the desired solution in the
Cp - 1(a, b) metric, and for p = 0 the approximations converge to the desired
solution in the L 2(a, b) metric.
7.5.4
Spline Estimate of the Density. Approximation by Splines of
the Even Order
As in the previous case, let the pth derivative of the desired density be a
function that has a finite L 2(a, b) norm. Consider the regularizing functional

7.6 NONCLASSICAlESnMATORS
315
and the C(a, b) metric
PE2(F, Ff ) =
sup IF(x) - Ff (x)l·
a~x~b
Therefore we are looking for an estimator that minimizes the functional
R(f,Ff ) = (max IF(X)-Ff(X)I)2 +Yf r
b
(f(P)(x»)2 dx.
a~x~b
Ja
One can prove (Aidu and Vapnik, 1989) that the solution to this optimization
problem is a spline of order 2p (for p = 0 it is the histogram) that possesses
the following property: The interval [a, b] is divided into subintervals such
that the maximal difference Ff (x) and F(x) in each subinterval takes the
same absolute values and alternates in sign from interval to interval.
7.6
NONCLASSICAL ESTIMATORS
7.6.1
Estimators for the Distribution Function
In the last section we derived the main classical nonparametric estimators
using the regularization method for solving ill-posed problems. Along with
this general principle for constructing the estimators, common to all these ex-
amples was the use of the empirical distribution function as an approximation
to the unknown distribution function
(7.45)
As mentioned previously, the approximation (7.45) does not include the
whole a priori information about the unknown distribution function. It is
known that any distribution function that has a density is absolutely con-
tinuous; however, our approximations are discontinuous functions. Note also
that we use the approximation for solving ill-posed problems, where small
changes on the right-hand side can cause large changes in the solution. In
Section 7.4 we proved that the densities obtained on the basis of the ap-
proximations Ff (x) converge to the desired one as well as densities obtained
on the basis of any other approximation, satisfying Kolmogorov's inequality.
However, for a finite number of observations the obtained solutions can be
very different.
Therefore the following problem arises: How do we construct approxi-
mations to the unknown distribution function which converge as fast as the
empirical distribution function Fl(x) and satisfy the additional property to
be a continuous monotonic function?
Below we will construct these approximations and show that they imply
new estimators for density.

316
7 STOCHASTIC ILL-POSED PROBLEMS
7.6.2
Polygon Approximation of Distribution Function
Let us consider the polygonal approximation to a one-dimensional distribu-
tion function. Let
be an ordered array of the sample Xl, ""xi' Consider the following approxi-
mation to the distribution function, called the polygon approximation:
Fjl(X)
o
1
f
k
1 2x - Xk + Xk+l
- + - -----'-----'--
£
f
Xk+l - Xk-l
1
1--f
1
if X < Xl,
'f -
Xl + Xz
1 Xl S; X <
2
'
'f Xk-l + Xk
Xk + Xk+l
1
2
S;x<
2
'f Xi-l +Xi
-
1 --- <X <X,
2
-
"
if X 2:: Xf.
k < £ - 1,
(7.46)
In Fig. 7.1 the approximations to the distribution functions are presented:
Figure 7.1 a shows the empirical distribution function and Fig 7.1 b shows the
polygonal approximation to the distribution function.t
7.6.3
Kernel Density Estimator
Consider the functional (7.37) whose point of minimum forms the Parzen's
estimator under the condition that one uses the empirical distribution func-
tion F,(x).
o
(a)
1
o
(b)
FIGURE 7.1. Empirical dis1Tlbution function (0) and polygon distribution function (b).
Note that approximation (b) has two discontinuous points.
t More generally, one can use a spline approximation of order d 2 O.

7.6 NONCLASSICAL ESTIMATORS
317
Now in this functional we use the polygonal approximation (7.45) instead
of the empirical distribution function Fe:
RY,(f,Fr
l
)
= i: (iXoo f(t) dt - Fr'(X)) 2 dx + YeI: (i: K(z - x)f(x) dX) 2 dz.
To obtain the estimator we use the Fourier transform representation that
is valid for an arbitrary approximation to a desired density function
where
is the Fourier transform of the kernel in the Parzen's estimator, and ff (w) is
the Fourier transform of the empirical density estimator F((x) = fe(x).
Note that for the Fourier transform the equality
(7.47)
holds true, where g(u) is the kernel in a Parzen estimator.
In our case for the polygon approximation of the distribution function we
have
Putting it (x) in (7.47) we obtain the estimator
In contrast to Parzen's kernel estimator, this type of kernel estimator depends
on the distance between two neighboring points of the ordered array row of

318
7 STOCHASTIC ILL-POSED PROBLEMS
sample. Both types of kernel estimators (Parzen's and the new one) depend
on the value of the regularization parameter "If. However, the new estimator
has two characteristics of width: local, which depends on the distance be-
tween two elements of the ordered array; and global, which depends on the
regularization parameter "If (see Fig. 7.2).
7.6.4
Projection Method of the Density Estimation
Consider the functional (7.42), the minimum of which defines the projec-
tion methods for density estimation under the condition that one uses the
empirical distribution function. Now in this functional we use polygonal
approximation (7.46) (instead of empirical distribution function Ff(x»:
As before, one considers the approximation to the unknown density as an
expansion on the orthogonal on (0, 71") functions cos nt I n = 1, .... We obtain
y == 1
y == 0.5
(a)
x,
Xi + 1
y == 0.25
x,
y == 1
X, + 1
y == 0.5
(b)
y == 0.25
FIGURE 7.2. Kernels for different values of 'Y constructed using Gaussians. Parzen kernels
(a) and new kernels (b).

7.7 ASYMPTOTIC RATE OF CONVERGENCE FOR SMOOTH DENSITY FUNCTIONS
319
the solution
12
00
f(t) = -
+ - l:ancosnt,
11'
11' n=1
where
(
.
ii+l +ii
.
ii +Xi-I)
1
(-I smn
- smn----,---
---2-k--
cos nil + cos nit + 2l:
2( _
_)
2
.
(1 + 'Yfn ( +1))£
.
n Xi+l
-
Xi-l
1=2
We restrict our discussion to these two examples of nonclassical density esti-
mators. However, using continuous approximations of distribution functions
in appropriate functionals, one can obtain new nonclassical estimators.
7.7
ASYMPTOTIC RATE OF CONVERGENCE FOR SMOOTH DENSITY
FUNC1'IONS
Section 7.4 proved the consistency of the regularization method under very
weak conditions with regard to the rules for choosing the regularization
parameter "If (see (7.34) and (7.35)). In this section we consider a specific
law for choosing 'Yf:
Inln£
1'f = -£-.
For this law we evaluate the asymptotic rate of convergence of the estimators
to the unknown smooth density.
We shall apply the regularization method to estimate smooth densities
defined on the interval [a, b].
Suppose that it is known that the probability density f(t) possesses m
derivatives (m may be equal to zero), and let the function pmJ(t) satisfy the
Lipschitz conditions of order J1, (0 s: J1, s: 1):
If(m)(t) - f m)(7")1 < K(f)lt -
7"IJl ,
If(m)(t) - f(m J ( 7")1
K(j) =
sup
.
I,TEla.b]
It -
7"IJl
Consider the following regularizer:
W(f) = (max sup IfkJ(t)1 + sup
IpmJ(r) - f(m)(7")I) 2
0Sksm IEla,b]
I,TEla,b]
It -
7"11'
(7.49)

320
7 STOCHASTIC ILL-POSED PROBLEMS
This functional is lower semicontinuous, and the set of functions
Me = {f: W (f) ::s; c}
is compact in C. Therefore this functional can be used as a regularizer.
We consider C[a, b] distance between the distribution function and its
approximation
pdF, Ff ) =
sup IF(x) - Ff(x)l·
xE[a.b]
Therefore we consider the sequence of functions minimizing the functional
Rp(f,Ff ) = (sup r
b
O(X-t)f(t)dt-FP(X))2
xE[a,b] Ja
(
)
2
In In t'
(m) t -
(m)
T
+-_
max sup If(k)(I)1 + sup
If
()
f
()I
t'
OS;ks;mtEla.bj
t,TEla.bl
It - TIJL
(7.50)
In this section we shall estimate the asymptotic rate of convergence in the
metric C of the sequence of solutions h(t) to the required density. As will be
shown helow, the rate of convergence depends on the degree of smoothness
of the estimated density, characterized by the quantity
{3=m+/-L
(the larger (3, the larger the rate).
Theorem 7.4. An asymptotic rate of convergence of the approximations !E(t)
to the required density f(t) is determined by the expression
{
(
t'
) /3/(213+2)
}
P
limsup lTf
sup If(t) - h(t)1 ::; g
= 1,
f-4X;
n n
a9S;b
where g is any constant.
In other words, the sequence of functions minimizing the risk functional
(7.50) converges to the desired density function with the rate
Observe that the value of regularization parameter
In In t'
yp=--
t'

7.7 ASYMPTOTIC RATE OF CONVERGENCE FOR SMOOTH DENSITY FUNCTIONS
321
does not satisfy conditions (7.35). Nevertheless, it implies uniform conver-
gence approximations ff(t) to the unknown density with probability one.
The conditions (7.35) are only sufficient conditions.
Finally, the following should be mentioned before proceeding to the proof
of the theorem. In 1978 Hasminskii obtained an estimate for the best possible
rate of convergence of an approximation to a unknown density. He discovered
that there is no algorithm which would ensure convergence in era, b] to a
f3-smooth density at a rate whose order of magnitude is larger than
re = C~f) (3/(2~+1) .
It was shown that using Parzen's window, one can achieve this rate of con-
vergence.
This result is slightly better than the result obtained in Theorem 7.4. How-
ever, one has to note that the maximal rate of convergence was achieved for
a special kernel (K(u) = sinu/u) rather than for kernels that are easy to
handle and usually used.
For the regularization method the same best rate of convergence can be
obtained if one uses the special metric p(F, Ff ) in the functional (7.50).
To construct this metric, divide the interval [a, b] into
= (~) 1/(2~+1)
n
Inf
equal parts
b-a
[Xi,Xi+I)' Xi = a +i--,
n
and define the quantities
i = 1, ...,n,
Using these quantities, one can construct the functional
(
)
2
b
~f
R;(f,Fe) =
sup II r (J(x - t)f(t)dt - Fdx)lli
+ -f-W(f),
l~l~n
Ja
where W (f) is given in (7.49).
The theorem is valid (its proof is analogous to that of Theorem 7.4),
which asserts that the sequence of functions minimizing R;(f, Fe) converges
as f increases in qa, b] to a f3-smooth density f(t) at a rate whose order of
magnitude is the best obtainable:
{
(f) (3/(2~+1)
}
P
limsup 1"£
sup If(t) - fp(t)1 So g
= 1.
f-+oo
n
a~l<:,b

322
7 STOCHASTIC ILL-POSED PROBLEMS
7.8
PROOF OF THEOREM 7.4
To prove the theorem. the following lemma will be required.
Lemma 7.1. Consider a function y(t) that is m + 1 times continuously differ-
entiable on the interval [a, bj. Denote by x(t) the derivative of this function.
Let the mth (m :2: 0) derivative of x(t) satisfy the Lipschitz condition of the
order J.t on [a, bj:
sup
Ixm(t) - xm(T)I ~ Kit -
TI~·
I,TEla,bl
Then the inequality
is valid, where
Proof
1. Consider first the case of m = O. Choose on [a, b] an arbitrary point t*
such that Ix(c*)1 -# O. Define an e-neighborhood of this point with
(7.51 )
Assume that at least one of the endpoints of this neighborhood-say the
right one-is located within the interval [a, b]; that is, t* + e ~ b. Along with
the function x(t) consider the function
¢(T) = Ix(t*)I- K(T -
t*)~.
Since for any T E [t*, t* + ej we have
Ix(t*)I-lx(T)1 ~ K(T - tOt,
it follows that
IX(T)I :2: Ix(t*)I- K(T -
t*)~ = ¢(T).
(7.52)

7.8 PROOF OF THEOREM 7.4
323
Noting that e is defined by (7.51), we conclude from (7.52) that on the interval
[t*, t* + e] the function x(r) remains of the same sign. Therefore the relation
I
rl'+6
I
r l'+6
r l'+6
Iy(t* + e) - y(t*)1 =
11'
x(r)dr
= 11'
Ix(r)1 dr 2: 11'
<p(r)dr
=
Ix(t*)le - Ke
1
+IJ. = K-I/IJ. (~) Ix(t*)I(1+fLJ/fL
1+1L
1+1L
is valid. Since, however, the inequality
Iy(t* + e) - y(t*)1 ~ 211ylle
is always fulfilled, it follows from the bound obtained that
[(1)
]fL/(I+fL)
Ix(t*)1 ~ 2
:1L
KI/fLllylle
(7.53)
Now let both endpoints of the above-mentioned e-neighborhood of the point
t* be located outside the interval [a, b]. Consider also the function
{
(
t*
r)fL
Ix(t*)1 - Ix(t*)1
t* _ a
<PI (r) =
t*
fL
Ix(t*)I- Ix(t*)I (~=t* )
for a ~ r ~ t*.
for t* < r ~ b.
It is easy to verify that for any r E [a, b] the inequality
is fulfilled. Therefore as above we have
/y(b)-y(a)1 = r x(t) dt = r Ix(t)1 dt 2: r<p (r) dr = ~(b-a)lx(t*)/.
1a
1a
1a
+ 1L
Hence
Ix(t*)1 ~ b~a (1: 1L) Ilylle·
(7.54)
Thus if at least one of the endpoints of the e-neighborhood is located within
the interval [a, b], the bound (7.53) is valid; otherwise. (7.54) is valid. While
the inequalities were obtained for any t* such that Ix(t*)/ -10. the bound
Ilxllc ~ max {{Collyllc;
Co*IIYII~/(1+fLJ}
(7.55)

324
7 STOCHASnC ILL-POSED PROBLEMS
holds true, where
C*=_2 (~)
()
b-a
JL
'
For case m = 0 the lemma is thus proved.
2. Now consider the bound
where x(s) is the sth derivative of function x(t). This bound was obtained
above for the case i = O. For the case i = m it constitutes the assertion of the
lemma (here we use the notation X-I (t) = y(t)). We shall prove the validity
(7.56) for i = 1, ...,m by induction.
Let the bound (7.56) be valid for i = k - 1. We show that it remains valid
for i = k as well. Indeed, since x(m-k)(t) is differentiable on [a, b], we have
sup
Ix(m-k)(t) - x(m-k)(r)1 ::; Ilx(m-k+l)llclt - rl;
t, TEla,b]
hence the function x(m-k) satisfies the Lipschitz condition of order JL = 1.
Therefore utilizing (7.55) we obtain
By the induction assumption we have
Combining these two inequalities, we have
Ilx(m~k)llc::; max{b ~allx(m-k-I)IIc;
2 [Ck_lllx(m-k)llcr/21Ix(m-k-I)II~2,
(7.57)
2 [Ck~Illx(m-k)11cf
k
+
IL -
1
)/2(IL+k) Ilx(m-k-l)II~2}.
It follows from (7.57) that

7.8 PROOF OF THEOREM 7.4
325
Finally, taking the values C; and Ct into account, we arrive at the inequality
For k = m the inequality obtained is assertion of the lemma.
Proof of the Theorem. According to the iterated logarithm law the devia-
tion between the empirical distribution function Ft (x) and actual distribution
function F(x) satisfies with probability one the relation
(
2f
) 1/2
lim sup -1
1
IJ
sup IFf(x) - F(x)/ = 1.
f-too
n n{.
x
Therefore for any e there exists fa = fee) such that simultaneously for all
f > fo the inequality
(7.58)
is fulfilled with probability 1 - e.
Let ff(t) be the function that minimizes the functional (7.50), and let f(t)
be the desired density. Then
In ~n f W ( 1-".) < R
(I-" F)
R (f F )
{.
Vi
evt,
e ::;
p
,
p
2
lnlnf
I!Ft (x) - F(x)/Ic + -f-W(f),
from which we obtain
2
f
W(fR) ::; W(f) + IIFp(x) - F(x)llc Inlnf'
(7.59)
Observe that starting with f = fa, the inequality (7.58) is fulfilled with prob-
ability 1 - 1'/; hence starting with fa, the inequality
W(.fl) .:; W(f) + 1
(7.60)
is satisfied with probability 1 - 1'/. If the mth derivative of the desired density
f(t) satisfies the Lipschitz condition of order J.L and the functional W(n is
(7.49), then it follows from (7.60) that

(7.62)
326
7 STOCHASTIC ILL~OSED PROBLEMS
that is, the mth derivative of the function ft (t) satisfies with probability 1 -
1}
the Lipschitz condition of order p, with the constant
K = (W(f) + 1)1/2.
Therefore in view of the lemma, the inequality
Ilf - ff lie:" max{c,;, J.b 8(x ~ f)ff(t) dt - F(x)
e
h
13/(I+I3)}
C;,* r 0(x - t)ft (t) dt - F(x)
({3 = m + p,)
(7.61)
Ja
c
is valid with probability 1 -
1}. Multiplying both sides of inequality by
(
_P_) {3/2(1+{3)
InlnP
,
we obtain
(
P
) {3/2(1+{3)
-
lift-file
In In P
{
(
~)1/(1+{3)[/p
b
]
S max
C;, VT
VIIliIi£ 1O(x - t)fr(t)dt - F(x)
c
;
[ /P
b
] {3/(I+{3) }
C,:,* V~ 1O(x - t)ff(t)dt - F(x) e
.
Observe now that starting with Po the inequality
JIn ~n f l' 8(x -- t )ft(t) dt
F(x) e:" 1+lW(f) + 1
(7.63)
is fulfilled for all P with probability 1 -
1}. The inequality (7.63) follows from
the triangle inequality
h1O(x - t)fr(t) dt - F(x)
c
:" l' 8(x ~ t)ff(t)dt - Fl(x) ,+ IIF(x) - F((x)11c.

::; Rt (ff , FE) ::; Rt (f, Fr),
e
7.9 CHOOSING A VALUE OF SMOOTHING (REGULARIZATION) PARAMETER
327
the self-evident system of inequalities
2
lh O(X - t)ft(t) dt - Ft(x)
and the bound (7.58).
Taking (7.62) and (7.63) into account, we may assert that with probability
1 -
71 for all £ > £0 the inequality
(_£_) J3/2(J +13)
_
<'
{
.." (In In£) 1/2(1+13) .
}
Inln£
IIff
file --=: max
Cm
£
' g
is fulfilled, where
C:n"" = c:n(1 + VI + W(f),
(
)
13/(1+13)
g = C:r,"
1 + VI + W(f)
Evidently, starting with some number £0, the inequality
(
In In £) 1/2(1+13)
C""" --
< g
m
£
(7.64)
is satisfied. Thus starting with some £0 with probability 1 -
71 the inequality
(
£
) 13/2(1 +13)
In In £
Ilff - file < g
(7.65)
will be fulfilled. Since for any 0 ::; 71 < 1 there exists £0 = £(71) such that for all
£ > £0 simultaneously the inequality (7.61) is fulfilled with probability 1 -
71,
we have with probability 1
(
£
) 1312(1+13)
li~~p
lnln£
11ft - file < g.
The theorem is proved.
7.9
CHOOSING A VALUE OF SMOOTHING (REGULARIZA1'ION)
PARAMETER FOR THE PROBLEM OF DENSITY ESTIMATION
The last section showed that if in the functional (7.50) one uses the value
of regularization parameter "If which is proportional to In In £/ £. then one

328
7 STOCHASTIC ILL-POSED PROBLEMS
obtains the almost optimal asymptotic rate of convergence in order of mag-
nitude. However, for practical goals the asymptotic optimality is not enough.
To get a good result, it is necessary to find a way to evaluate the best value
of the regularization parameter for a given fixed amount of observations.
In this section we will consider some general way for finding a value of
the regularization parameter Yf, which looks reasonable for a fixed amount
of observations and provides the almost optimal rate of convergence when
the number of observations tends to infinity.
In Chapter 1, Section 1.11, describing relations between the empirical
distribution function and the actual distribution function we introduced
Kolmogorov law, Smirnov law, and the law of iterated logarithm.
According to these laws, the specific measure r(Ff , F) between the em-
pirical distribution function Ff (x) and the actual one F (x) (different laws
correspond to different measures) have distributions that are independent of
both the actual distribution function F(x) and the number P (for sufficiently
large P).
Thus, according to the Kolmogorov law for sufficiently large Pthe random
variables
g= Jfsup IF(x) - Ff (x)1
x
have some fixed distribution function.
According to the Smirnov law for sufficiently large Pthe random variables
w2 = PJ(F(x) - Ff (x))2 dF(x)
also have some fixed distribution function. Both of these distributions are
unimodal functions. t
Let aK be the median of the random variable g (one can find that for
the one-dimensional case, UK ~ 0.6) and let as be the median of the random
variable w2 (for the one-dimensional case, as ~ 0.05).
Now let P)'/ (t) be an approximation to desired density which depends on
the smoothing parameter Yf. The idea is to choose the value of the smoothing
parameter Yf for which the corresponding distribution function
satisfies a (chosen specific) statistical law in the best manner.
That means that if one uses Kolmogorov's law, then one has to choose a
value Y; such that
(7.66)
t There are other laws for checking goodness of fit that are based on these two.

7.9 CHOOSING A VALUE OF SMOOTHING (REGULARIZATION) PARAMETER
329
If one uses Smirnov's law, then one has to choose a value of the parameter
y; such that
/
2
as
(
(F1'f(x) - Fl(x)) f1'f(X)dx = 7'
7.67)
The value Yr" satisfying (7.66) is the best fit of the regularization parameter
for Kolmogorov's law.
The value Y; satisfying (7.67) is the best fit of the regularization parameter
for Smirnov's law.
For the one-dimensional case, Eqs. (7.66) and (7.67) have simple expres-
sions. Let
-
-
Xl, ••• ,Xr
be an ordered array of observations Xl, "', Xf. Then Eq. (7.66) can be rewritten
in the form
max max (IF .(i) - ~IIF .(i) _ ~I) =
aK _!.
1<i<f
1'(
1
£'
1'(
1
£
.,fi
£
Equation (7.67) can be rewritten in the form
f
(
_
i _ 0.5) 2
1
L
F1';(xd -
£
= as - 12£'
1=]
(7.68)
(7.69)
One can show that using Eq. (7.69) for choosing the parameter of reg-
ularization, it is possible to achieve an almost optimal rate of convergence.
Namely, let the density pet) satisfy the following conditions:
1. The unknown density is concentrated on [0,1T].
2. There exists the kth derivative (k ~ 1) of this density which has bounded
variation on [0,1T].
3. The function p(t) can be extended in the even manner to [-1T, 1T] and
then periodically to the entire real axis so that the kth derivative of it
will be continuous.
Any density of this type can be represented in the form of series with
respect to orthogonal basis
cos t, ...,cos mt , '"
1
2
00
pet) = -
+ -
La~cosrt,
1T
1T r=l
where
a~ = (r pet) cos rt dt,
Jo
r = 1, ....

330
7 STOCHASTIC ILL-POSED PROBLEMS
Let us consider the projection estimator Pt(t) of the density obtained by the
regularization methods-that is, the functions minimizing the functional
for a fixed YF > O.
In the Section 7.5.2 we showed that Pt(t) has the form
12
00
p(t) = - + - I:: Arar cos rt,
1T
1T r=!
where
1 r
Cr = f L cos rti,
i == I
r = 1, ...,
1
Ar = 1+ YtrZ(k+ll'
The last equation defines regularization of the coefficients of expansion.
which depend on the parameter Yt. The following theorem is true (Vapnik,
Markovich, and Stefanyuk. 1991).
Theorem 7.5. If the regularization parameter is chosen to satisfy Smirnov
goodness-of-fit equation, then for k 2 1 there exists a constant c such that the
inequality
P {lim sup£(k+O.51/(2k+3)IIPr(t) - p(t)IIL, < c} = 1
f
'x!
holds true.
The asymptotic bounds obtained in this theorem are slightly worse than
the best possible £k/(Zk+l): The largest difference is achieved for k = 1 where
£03 instead of f ~. However, this rule for choosing the regularization constant
Yf has no free parameters and it performs well in practice (Markovich, 1989).
7.10
ESTIMATION OF THE RATIO OF TWO DENSITIES
In this section we consider the problem of estimation of the ratio of two
densities
f(x) = PI (x)
pz(x)

7.10 ESTIMATION OF THE RATIO OF TWO DENSITIES
331
using two sets of data Xl, ... , Xn and Xl, ... , Xi drawn randomly and indepen-
dently in accordance with PI (X) and pz(x). We consider the case where f
belongs to the set of functions with bounded variation.
In Example 2 of Section 7.1 we have considered the problem of estimating
the ratio of two densities as a problem of solving the equation
(7.70)
where F(1)(x) and F(Z)(x) are distribution functions corresponding to the
densities PI (x) and pz(x). We have to solve this equation in the situation
where F(1)(x) and F(2l(x) are unknown but we are given the data
Here we require that
-
-
XI, ...,Xi·
(7.71)
1·
£
1m -
= C,
P-too n
0< C < 00.
Let us use these data to estimate the unknown distribution functions
(2)
_
1 '"
_
_
Fi
(x) - RLJ O(x - Xi)'
These approximations of the unknown distribution functions determine an
approximation to the right-hand side of operator equation (7.70) and an
approximation to the operator
(7.72)
To estimate the densities ratio we will minimize the functional
(7.73)
where Fn and A p are the approximations described above.
For simplicity consider the case where densities have a bounded support
[a, b] and where the ratio of two densities is a continuous function with
bounded variation that possesses m 2: 0 derivatives, satisfying the Lipschitz
condition order 'Y
sup
If(m)(x) - f(m)(Y)1 < 00.
x,YEla,b]
Ix - yl'Y

332
7 STOCHASTIC IlL-POSED PROBLEMS
(If m ~ 1, then the function on [a, b] possesses bounded variation. The
bounded variation requirement is essential for case m = 0.) Consider the
C(a, b) norm
Ilfll =
sup If(x)l·
xE[a.b]
Let D be a set of functions with bounded variation vg(f), possessing m
derivatives, satisfying the Lipschitz condition of order y.
Consider also the functional
W(f) = (vg(f) + max
sup If(m)(x)1 +
sup
If(m)(x) - f~m)(Y)I) 2
O~m~ku~x~b
x,YE[u.b]
Ix - yl
Let ff,n be a sequence of minima of functional (7.73). Below we show
that the conditions (7.34) and (7.35) on the regularization parameter Yr
which guarantee convergence (in probability and almost surely) of density
will guarantee convergence in probability and convergence almost surely of
the estimate of the ratio of the densities as well.
Indeed consider the difference
(Ad)(x) - (Af)(x) = rf(t)d(Ff(t) - F(t))
10
= f(x)(Ff(x) - F(x))-l
x
(Ff (X) - F(x))df(x).
Therefore,
From this inequality and the definition of the norm of the operator we have
(7.74)
According to Theorem 7.3 the solution fy of the operator equation ob-
tained on the basis of the reqularization method possesses the following prop-
erties: For any 8 > 0, C\ > 0, and C2 > 0, there exists Yo such that for any
Yf < Yo the inequality
holds true. Therefore for our special case taking into account the Kolmogorov
inequality we have
P {PEJff,n,f) > 8}
Cz
~ P{ sup IFn(X) - F(x)l) > C1JY(} + P{ sup !Ff(X) - F(x)1) > TJY(}
O~x~1
09S1
~ 2 (exp{-2Yf£Cn +2exp{-Yf£Ci}).

7.10 ESTIMATION OF THE RATIO OF TWO DENSITIES
333
From this inequality we find (as in the density estimation case) that conditions
(7.34) and (7.35) imply convergence in probability and convergence almost
surely for convergence of our solution to the desired one.
7.10.1
Estimation of Conditional Densities
Now we derive an estimator P (y Ix) of conditional densities and solve the
equation
LX L
Y
p(yjx)dF(x)dy = F(x,y)
using the data
(xI,yd, ... , (Xf,Yf)
by minimizing the functional
R(P) = j [[[
p(y'lx')dUt 9(x' - Xi)) dy'
-}t 9(x - xi)9(y - Yi)rdxdy + y, jlgrad p(Ylxll' dx dy
(7.75)
Consider the case where x E (0, 7T) and y E (0, 7T). We are looking for the
minimum of functional (7.75) in the form
1
CXJ
CXJ
p(Ylx) =
7T + L
aO,k cos ky + L
am.k cos mx cos kyo
k
m,k
(7.76)
We shall search for an approximation to the minimum of the functional in
the form of a finite sum:
1
M
N
M
p(Ylx) =
7T + LaO,kcosky + L
Lam.k cosmxcosky.
k
m=l k=l
(7.77)
The minimum of (7.75) in the set (7.77) is obtained for a function whose
expansion coefficients am.k, m = 0,1, ...N, k = 1, ... ,N, satisfy the following
system of algebraic equations:
NL B(m, r)am,k + Yt h,k2(r2+ k2)a,.k = D(r, k),
m=O
(7.78)
r = 0, ... ,N,
for r = 0,
for r f- 0,
k = 1, ... , M,
(7.79)

334
7 STOCHASTIC ILL-POSED PROBLEMS
where
f
1 ~ (Tr-maX(XjXj))
D(r,k) =
£2,~
Tr
cosrxjcoskYj·
1,)=\
B(m, r)
f
1
(Tr - maX(XjXj))
£2 :L
Tr
cosmXj cos rXj ,
1,)=1
(7.80)
In accordance with (7.78) and (7.79) to estimate the (N + 1)M coefficients
am.k of the series (7.77), it is sufficient to solve M times the system of linear
algebraic equations (7.78).
Using the estimator of the conditional probability density (7.77), it is easy
to calculate the regression
rf (x) = I yp(Ylx) dy
[,\.121]
N
[,\.12 1 ]
Tr
2 ~
aO,(2p+l)
2 ~ ~
a r,(2p+l)
(7.81)
"2 -
~ (2p + 1)2 -
~ ~ (2p + 1)2 cosrx.
p=o
r=]
p=o
7.11
ESTIMATION OF THE RATIO OF TWO DENSITIES ON THE LINE
Now let x be a random vector of dimension n. We shall estimate the condi-
tional probability density on the line
x - Xo = et
(7.82)
passing through point Xo, where e is the unit vector defining the line.
For this purpose, along with line (7.82) we shall consider its orthogonal
complement with respect to space X. We define every point in X by both
the number t (the location of its projection on the line (7.82) relative to the
point xo) and the (n - 1)-dimensional vector u. Thus any point in X space is
defined by the pair Xj = (tj, Uj), and any point on the line is defined by the
pair x = (t, uo). We introduce two conditional distribution functions F(tluo)
and F(y, tluo). The equation determining the conditional density p(Ylt. uo)
on the line is Uo
11'1/ p(yli, Uo) dF(iluo) dy = F(y, tluo).
a
0
(7.83)
We shall solve this equation when the conditional distribution functions are
unknown but a sample of pairs

7.11 ES'I'IMATION OF THE RAno OF TWO DENSITIES ON fHE LINE
335
is given. We rewrite these pairs in the equivalent form
Consider the following approximations to the conditional distribution func-
tions
t
Ft(tlu) = LTi(U)8(t - tj),
i=1
t
Ff(y,tlu) = L
Ti(U)8(t - ti)8(y - Yi),
i=1
where coeefficients Tj(U) are defined using the kernel estimator
(7.84)
(af depends on number of observations f).
It is known (Stute, 1986) that if the kernel gu/(Iu - uil), u E Rll- 1, is such
that
where
g(a) =g(a1, ...,an- 1) = 1,
'f
1
i
1 f
.
1
1
1
-
2' ::; a ::; 2' or l = ,...,n -
and zero elsewhere and at satisfies the property that at ---t 0 in such a way
that
Lexp{-p£a;-I} < 00
t21
then almost for all u we have
Vp > 0,
D 1(u) = sup IF(tlu) - Ft(tlu)1 ~ 0,
I
f-.oo
D 2(u) = sup IF(y, tlu) - Ff(y, tlu)1 ~ 0
y,t
t-.oo
with probability one.
The problem is thus to estimate the solution of Eq. (7.83) based on the
approximations (7.84). We assume that the conditional density has a bounded

336
7 STOCHASTIC ILL-POSED PROBLEMS
support°~ t ~ Tr, °~ Y ~ Tr. To obtain the solution we shall minimize the
functional
Rip) = f f[l !o'P(YII,UO)d(t. Ti (UO)9(i-ti»)dYdi
-t. Ti (uo)9 (I - 'i)9 (y - Yi)rdl dy + y,f Igrad p(Y1 I, uo)I' dt dy
(7.85)
in the set of functions
1
M
N
M
p(Ylt, lt~) =
Tr +L aO,k cos ky +L L am,k cos mt cos kyo
(7.86)
k
m=1 k=1
The minimum of (7.85) in the set (7.86) is obtained for a function whose
expansion coefficients am,k, m = 0, 1, ...N, k = 1, ..., M, satisfy the following
system of algebraic equations:
NL B(m, r)am,k + Yih,k2(r2 + k2)a',k = D(r, k),
(7.87)
m=O
where
r=O, ...,N,
for r = 0,
for r i- 0,
k = 1, ...,M,
(7.88)
B(m, r)
i
(Tr - max(t- t.))
D(r,k) = ~
Tr
I' J
Tj(Uo)Tj(uo)cosrtjcoskYi'
I,J=I
(7.89)
In accordance with (7.87) to estimate the (N + l)M coefficients am.k of the
series (7.86) it is sufficient to solve M times the system of linear algebraic
equations (7.87).
Using the estimator of the conditional probability density (7.86) it is easy
to calculate the regression estimator
rp(tluo) = Iyp(Ylt, u)dy
[Mil]
N [Mill
Tr
2 L
aO,(2p+1)
2L L
a,,(2p+l)
t
-
-
-
cosr
2
(2p + 1)2
(2p + 1)2
.
p=o
,=1
p=O
(7.90)

7.12 ESTIMATION OF A CONOIlIONAL PROBABILITY ON A LINE
337
7.12
ESTIMATION OF A CONDITIONAL PROBABILITY ON A LINE
To estimate a conditional probability Pzo(w = lit) (the probability of the first
class given position on the line (7.82)) we use the following equation
it pew = Iii, uo) dF(iluo) = F(w = 1, tluo),
(7.91)
where F(iluo) = P{t ~ iluo} and F(w = l,iluo) = P{w = l,t ~ iluo}.
We shall solve this equation when the functions F(tluo) and F(w = 1, tluo)
are unknown and a sample of pairs
(WI, XI), ... , (Wt,Xt)
is given. Rewrite these data in the form
(WI,tl,ud,· .. ,(Wt,tt,ur)·
Consider the estimators
p
Ff (tIuo) = L
T; (uo) 0(t - ti)
;=1
f
Fp(w = 1, tluo) = L
5(W;)Ti(UO)O(t - ti),
;=1
(7.92)
where 5(Wi) is the indicator of class: B(W;) = 1 if vector X; belongs to the first
class and equal to zero otherwise. Let t E [0, 7T]. We determine the solution
(7.91) by minimizing the functional
on the set
N
pew = Ilt,uo) = ao + La; cos it.
;=1
The minimum of the functional (7.93) is attained when the coefficients an
satisfy the system of algebraic equations
NL B(m, r)am + yr2a, = D(r),
r = 0, ... , N,
(7.94)
m=O

338
7 STOCHASTIC ILL-POSED PROBLEMS
where
B(m, r)
(7.95)
The last two sections described methods for estimating conditional densi-
ties (conditional probabilities) on the line. However, they did not discuss the
problem of how to choose the line in order to achieve the best performance.
In Chapter 11, we will come back to this problem and show that in a suf-
ficiently general situation one can define the trajectory passing through the
point of interest along which the conditional density (conditional probability)
changes rapidly. We will estimate our functions along this trajectory.

8
ESTIMATING THE
VALUES OF FUNCTION
AT GIVEN POINTS
This chapter considers a new setting of the learning problem; the problem
of estimating the values of a function at given points of interest. This setting
of the problem leads to a new type of inference, the so-called transductive
inference which is different from inductive inference. In contrast to the induc-
tive inference where one uses given empirical data to find the approximation
of a functional dependency (the inductive step) and then uses the obtained
approximation to evaluate the values of a function at the points of interest
(the deductive step), we will try to estimate the values of a function at the
points of interest in one step.
8.1
THE SCHEME OF MINIMIZING OVERALL RISK
In the case of small sample sizet
(8.1 )
we distinquish between two estimation problems:
1. Estimation of the functional dependence y =
c/> (x) in the class f(x, a),
a E A.
2. Estimation of values of the function y =
c/> (x) at the given points
Xf+l, .•• , Xf+k
(8.2)
t For the problem of estimating the function on the basis of the set of functions I(x. a). a E A.
the sample size f is considered to be "small" if the ratio f/h is small. say f/h < 20. where h is
the VC dimension of the set.
339

340
6 ESTIMATING THE VAlLlES OF FUNCTION AT GIVEN POINTS
using a function from the class f(x, a), a E A. The data (8.2) are gener-
ated by the same generator that generates vectors X; from the training
data (8.1).
It may seem that the problem of estimating the values of a function at
given points (8.2) is not a very profound one. There exists a "natural" way
to solve it: Based on the available empirical data (8.1), one can find the
approximation Y = f(x, a*) to the desired function Y = cP(x), and then one
can use this approximation to evaluate the values of the unknown function
at the points (8.2):
Yi = f(x;, a*),
i=R+1, ...,R+k;
that is, one can obtain a solution of the second problem by using a solution
of the first one.
However, this way for estimating values of a function is often not the best,
since here a solution of a relatively simple problem (namely, estimating k
numbers (the values of the function)) becomes dependent on the solution of
a substantially more complex problem (namely, estimating a function (which
is estimating the values in the continuum of points containing these k points)).
The problem is how to utilize the information about the data (8.2) for
estimating its values using the set of functions f(x, a), a E A.
It should be noted that in practice usually it is necessary to determine the
values of the function at given points rather than to determine the functional
dependence itself. As a rule (which is always valid for the problem of pat-
tern recognition), the functional dependence is utilized only to determine the
value of a function at certain desired points.
Thus we distinguish between two kinds of estimation problem: estimation
of a function and estimation of the values of a function at given points.
In Chapter 1 we formalized the statement of the problem of estimation of
functional dependence by means of a scheme of minimizing the expected risk.
In this section we shall formalize the statement of the problem of estimating
the functional values at given points using a scheme that will be called the
scheme of minimizing the overall risk functional.
It is assumed that a set
(8.3)
containing R+ k vectors (a complete sample of vectors) is given. These vectors
are i.i.d. according to some distribution function. There exists a function
Y = cP(x) that assigns a number Y to each vector X in the set (8.3). Thus for
l + k vectors (8.3), l + k values
YI, ...,Yt, Yf+l, ...,Yf+k
(8.4)

8.1 THE SCHEME OF MINIMIZING OVERALL RISK
341
are defined; £ vectors Xi are randomly selected from the set (8.3) for which
the corresponding realizations of Yi are indicated. The set of pairs
thus formed is called the training sample. The remaining set of vectors
Xf+1, ... , Xp+k
(8.5)
(8.6)
is called the working sample.
Below we consider two settings of the problem of estimating the values of
the function 4> (x) at the points of interest (8.6) using the training data (8.5).
Setting 1. Based on the elements of the training and the working samples
and on the given set of functions [(x, a), a E A (4)(x) does not necessarily
belong to this set), it is required to find a function [(x, a') that minimizes
with a preassigned probability 1 -
11 the overall risk of forecasting the values
of the function Yi = 4> (Xi) on the elements of the working sample-that is,
which yields with probability 1 -
11 a value of the functional
1
k
R:s(a) = kL P(yf+i,f(Xp+i, a»
;=1
(8.7)
close to the minimal one. In (8.7), p(y, [(x, a)) is some measure of discrep-
ancy between Y and [(x, a), say
Consider another formulation of this problem, to be referred to as Setting
2.
Setting 2. Let the probability distribution function P (x, y) be given on the set
of pairs (X, Y) (it can be an infinite set). We select from this set, randomly
and independently, R pairs
(8.8)
which form the training sequence. Next, in the same manner we choose k
additional pairs
(8.9)
It is required to obtain an algorithm A which, based on the training sequence
(8.5) and the working sequence (8.6), will choose a function

342
6 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
that yields the value of the functional
close to the minimal one.
The following theorem that connects these two settings is valid.
Theorem 8.1. If for some algorithm A it is proved that for Setting I with
probability 1 -
11 the deviation between the risk on the training data and the
working sample does not depend on the composition of the complete sample
and does not exceed 8, then with the same probabilityfor Setting 2 the deviation
between the analogous values of the risks does not exceed 8.
Proof Denote
1
f
1 f+k
CA(XI,YI; ",;XF+bYf+d = 7LP(Y;,f(x;, O'A)) - k L
p(y;,f(Xj, O'A))
;=1
i=f+l
Consider Setting 2 of the problem, and compute the probability of deviation
from zero by an amount greater than 8 of the quantity CA(XI, YI,; ",;Xf+kYf+k):
Let Tp , p = 1, ..., (f + k)! be the permutation operator for the sample (xI,yd:
...; (Xf+k, Yf+k)' Then the equality
is valid. The expression in braces is the quantity estimated in Setting 1. It
does not exceed 1 - 11. We thus obtain
The theorem is proved.

8.2 THE METHOD OF STRUCTURAL MINIMIZATION OF OVERAll RISK
343
Below we shall consider the problem of estimating the values of a function
at given points in Setting 1. However, by means of Theorem 8.1 all the results
obtained are valid for the case of Setting 2.
The terminology used in this chapter pertains to estimating values of a
function. However, all the results obtained were valid in the more general
case when a realization of the sample (8.4) is determined by the conditional
probability (rather than by the function Y = cP(x)); and it is required on
the basis of random realizations at points (8.5) to forecast, by means of the
functions [(x, a), a E A, realizations at some other points (8.6).
8.2
THE METHOD OF STRUCTURAL MINIMlZA1'ION OF
OVERALL RISK
We solve the problem of estimating the values of a function at given points
by using the method of structural risk minimization. In the following two
sections we obtain bounds on the rate of uniform relative deviation of the
mean values in two subsamples. Using these bounds, we construct bounds on
the overall risk, uniform over the class [(x, a), a C A, based on the values of
the empirical risks. These bounds are analogous to those which were utilized
in Chapter 6 when constructing a structural minimization of the expected
risk.
We shall demonstrate that for a set of indicator functions of VC dimension
h (for the problem of pattern recognition) the additive bound
(8.10)
is valid with probability 1 -
1], while for the set of arbitrary functions of
VC-dimension h with probability 1 -
1] the multiplicative bound
R~(a) ~ Remp(a)O*(f, k, h, 1])
is valid.
Now if one defines the structure
Sl C ... C Sq
(8.11 )
on the set of functions [(x, a), a E A, then it is possible by minimizing the
right-hand side of the equality (8.10) (or (8.11)) to find an element S. and
a function [(x, a*) for which the guaranteed minimum for the bound of
the overall risk is attained. Using the functions [(x, a:mp), the values Yi =
[(Xi, a:mp) are computed at the points of the working sample. Outwardly this
scheme does not differ at all from the one considered in Chapter 6.
However, in the scheme of structural minimization of the overall risk, a
special feature determines the difference between solutions of problems of

344
8 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
estimating a function and those of estimating values of a function at given
points. This has to do with the need to construct the structure a priori. This
requirement has different meanings in the case of estimating functions and
of estimating values of functions.
For the problem of estimating functions, it means that knowing the class
of functions f(x, a), a E A, and the domain of definition of a function, it is
necessary to define a structure on f(x, a), a E A. For the problem of estimat-
ing functional values, it amounts to determining a structure on f(x, a), a E A,
knowing the set of functions and the complete sample
XI, ... , Xf, Xf+l, •.. , Xp+k'
(8.12)
The difference stems from the fact that for a complete sample (8.12) the set of
functions f(x, a), a E A, is decomposed into sets of equivalence classes. This
set can be investigated, and the structure on f(x, a), a E A, can be defined
on equivalence classes, producing a more meaningful ordering principle than
the one in the case of estimating functions.
For example, the set of indicator functions on the complete sample (8.12)
is decomposed into a finite number of equivalence classes. Two indicator
functions are equivalent on a complete sample if they subdivide this sample
into subsamples in the same manner (i.e., take the same values on (8.12)). In
this case, one can define a structure on a finite number of equivalence classes
rather than on the initial (possibly infinite) set of functions.
8.3
BOUNDS ON THE UNIFORM RELATIVE DEVIATION OF
FREQUENCIES IN TWO SUBSAMPLES
This section finds for a bound on the uniform relative deviation of frequencies
in two subsamples. For the problem of minimizing the overall risk in the
class of indicator functions, this bound plays the same role as the bound on
uniform relative deviation of frequencies from their probabilities played in
the problem of minimizing the expected risk. To state the theorem we shall
introduce for a given set of indicator functions f(x, a), a E A, and any given
set
the finite number of equivalence classes
Observe that the number of equivalence classes on the complete sample is
bounded using the growth function as follows:

8.3 BOUNDS ON THE UNIFORM RELATIVE DEVIATION OF FREQUENCIES
345
Let our set of £ + k vectors x consist of elements of two types: m elements
of type a and £ + k - m elements of type b. We select randomly £ elements
from this set. The probability that among the selected elements there are r
elements of type a equals
(8.13)
Thus with probability (8.13) the frequency of elements of type a in the
selected group is r j £, and hence the corresponding frequency in the remain-
ing group is (m - r)jk.
The probability that the frequency of elements a in the first group devi-
ates from the frequency of elements a in the second group by the amount
exceeding e is equal to
{I
r
m-r/
}
"C:nC;'::_m
P
"i - -k- > e
= ~
C;+k
= ff,de,m),
where the summation is taken over the values of r such that
Ir
m-rl
"i--k- > e,
max(O,m - k) ~ r ~ min(£,m).
We define the function
r l,k (e) = m~x r f ,k (J£: k e, m) .
This function can be tabulated with a computer.
Denote now by vo(a) the frequency of classification error on the set
XI, ... , Xf+k when using the decision rule f(x, a). Denote also by v(a) the
frequency of errors on the set XI, ""Xi and by vl(a) the frequency of errors
on the set Xi+l, ... , Xf+k' Clearly,
k
£
vo(a) = £ + k vl(a) + £ + k v(a).
The following theorem on uniform relative deviation of frequencies in the
two subsemples is valid.
Theorem 8.2. Let the set of decision rules f(x, a), a E A on the complete set
of vectors have N i +k equivalence classes. Then the probability that the relative
size of deviation for at least one rule in f(x, a), a E A exceeds e is bounded
by
{
Iv(a) - "l(a)1
}
P
sup
~
> e
< Nf+kff,k(e).
aEA
Vvo(a)
(8.14)

346
8 ESTIMArlNG THE VALUES OF FUNCTION AT GIVEN POINTS
Here we use the convention
Iv(a) - vI(a)1 = 0
Jvo(a)
for v(a) = vI(a) = v()(a) = O.
Proof Since number of equivalence classes is finite, the inequality
P {
Iv(a) - vI(a)1
}
N
P {Iv(a) - vI(a)1
}
sup
> e
<
sup
> e
aEA
Jvo(a)
aEA
Jvo(ao)
is valid. The second term on the right-hand side of this inequality is bounded
using the function f(,de) (in Chapter 4, Section 4.13, we obtained the bound
of this function for k = f). Indeed,
and by definition,
The theorem is proved.
Below, a uniform in f(x, a), a E A, bound on the frequency of errors in
the working sample will be required. We shall derive it using Theorem 8.2.
We bound the right-hand side of (8.14) by the quantity 7]. We thus arrive at
the inequality
the smallest solution of which (with respect to e) we denote by f.
Using this solution we can rewrite (8.14) in the equivalent form: With
probability 1 -
7] the inequality
£2k
J.
(k£)2
vI(a) S v(a) + 2(f + k) + f
v(a) +
2(e + k)
(S.l5)
is valid simultaneousely for all a. We shall utilize this inequality when con-
structing algorithms for structural minimization of the risk in the class of
indicator functions.

8.4 A BOUND ON THE UNIFORM RELATIVE DEVIATION OF MEANS
347
8.4
A BOUND ON THE UNIFORM RELATIVE DEVIATION OF MEANS IN
TWO SUBSAMPLES
When deriving a bound on the uniform relative deviation of the means in
two subsamples we shall assume that on the complete sample
the condition
p>2
(8.16)
is fulfilled for a set of real functions f(x, a), a E A, where Yi is a value of the
realization of (8.4).
The condition (8.16) conveys some prior information concerning possible
large deviations on the complete sample Xl, ""xf+k' This condition is analo-
gous to the condition considered in Chapter 5, Section 5.8.
In the same manner as in Chapter 5, we introduce the function
Rt(a) = / Jv{(y - f(x, a))2 > t}dt,
p > 2,
where v{p(y,f(x, a) > t} is the ratio of the number of points in the com-
plete sample Xt, ... , Xf+k for which the condition p(y,f(x, a)) > t is fulfilled
on realizations of (8.4) to the total number of points f + k. For the function
Rt(a) similary to the function R(a) (cf. Chapter 5) the relation
1
f+k
RI(a) :s a(p) P f + k L(Yi - f(Xi, a))2P
i=l
holds true, where
~l (p _l)P-I
a(p)=
-
-
2
p-2
Denote
The fOllowing theorem is valid.
(8.17)
(8.18)

348
8 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
Theorem 8.3. Let the condition (8.16) be satisfied and let the set of indicators
8(f(x, a) + (3) of real-valued functions f(x, a), a E A, have Nf +k equivalence
classes on a complete set of x. Then the bound
(8.19)
is valid.
Proof Let the number of different separations of the set of pairs
using indicator functions
I(a, (3) = 8{(y - f(x, a))2 - f3}
not exceed
and therefore according to Theorem 8.2 the bound
P {
Iv(a, (3) - v};(a, (3)1
}
N0r ()
sup
> B
<
f k
B
aEA
Jvo(a, (3)
,
(8.20)
is valid. (Here v(a, (3) is the frequency of the event {p(y,I(x , a)) > f3}
computed for the training sequence, vl(A a ,/3) is the frequency of the event
{p(y,f(x, a)) > f3} computed for the working sample
Xe+), ... ,Xf+k> and
vo(Aa .f3 ) is the frequency of event (A a ,f3) computed for the complete sample
XI, ... , xp+k via the realization of (8.4).)
We show that the validity of (8.20) implies the validity of the inequality
For this purpose we write the expression
in the form of a Lebesgue integral
1 ~I {
2
i}
{
2 i}I
n~
Vl
(y-f(x,a)) > n -vemp
(y-f(x,a)) > n
1=1
I = s~p }~~
R) (a)

8.4 A BOUND ON THE UNIFORM RELATIVE DEVIATION OF MEANS
349
Now let the inequality
Iv~ {(y - f(x,a)? >~}- Vemp {(y - f(x,a))2 >~}I
Jv ( (y - f(x, ex))2 > ~)
be valid. In that case
The validity of (8.20) implies that (8.21) holds.
To complete the proof it remains only to utilize the inequalities (8.16) and
(8.17). Indeed
p {
IR1(a) - Remp(a)1
(p)}
s~p
R(a)
> Ta
S
The theorem is proved.
{
Iv(a, (3) - vI(a, (3)1
}
< P
sup
> S
-
aEA
Jvo(a, (3)
< NTp,k(S),
We shall now obtain a uniform bound for the risk on the working sample.
For this purpose we bound the right-hand side of (8.19) by the quantity 7].
We thus arrive at the inequality
(8.22)
Denote by £ the smallest solution with regard to S for this inequality.
Taking the representation (8.18) into account, we obtain from (8.19) that
the inequality
(1 + Ta(P)~£)
(
f)
Remp(a),
1 - Ta(p)--£
£ + k
+
(8.23)
where
(u)+ = max(u, 0),
is valid with probability 1 -
7].

350
8 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
This inequality will be utilized in the course of constructing algorithms
for a structural minimization of the overall risk. Below we shall confine our
discussion to a class of functions linear in parameters
n-l
[(x, a) = L ar<Pr(x) + ao·
r=1
The capacity of this class of functions is equal to n.
8.5
ESTIMATION OF VALUES OF AN INDICATOR FUNCTION IN A
CLASS OF LINEAR DECISION RULES
Let the complete sample
(8.24)
be given. On this sample the set of decision rules is decomposed into a finite
number N of equivalence classes F1, ... , FN' Two decision rules F(x, a*) and
F(x, a**) fall into the same equivalence class if they subdivide the sample
(8.24) into two subsamples in the same manner. Altogether, Ni\(Xl' ... , Xf+k)
subdivisions of the sample (8.24) into two classes by means of the rules
[(x, a), a E A, are possible, and thus there exist N'\(XI, ... , Xp+k) equivalence
classes.
Recall that by the definition of the entropy and the growth function (d.
Chapter 4, Section 4.9) the inequality
is valid. For linear decision rules in a space of dimension n the following
bound is valid (Chapter 4, Section 4.9):
N* ~ exp {n (In £ : k +1)}.
Thus on the complete sample (8.24) the set of linear decision rules [(x, a).
a E A, is decomposed on N* equivalence classes Fl , ...,FN .
Observe that the equivalence classes are not of equal size. Some of them
contain more decision rules than others. We assign to each equivalence class
a quantity that characterizes the fraction of linear decision rules they encom-
pass. Such a quantity can be constructed. Indeed, assign to each function

8.5 ESTIMATION OF VALUES OF AN INDICATOR FUNCTION
351
a directional vector (Fig. 8.1)
( \
n)T
a = a , ...,a
,
lal = 1.
Then in the space of parameters a a unit sphere corresponds to the set
of all hyperplanes; and to each equivalence class F; there corresponds a
distinct region on the surface of the sphere. (The set of N equivalence classes
subdivides the sphere into N regions.) The ratio of the area corresponding
to the region Li to the area of the sphere L characterizes the fraction of
functions belonging to an equivalence class relative to all possible linear
decision rules.
Now order the equivalence classes in decreasing order of 7ri = L r / Land
introduce the following structure:
(8.25)
C\ > C2 > ... > cq = o.
where the element Sr contains only those equivalence classes that satisfy
Li£
~cr,
We have thus constructed a structure in which each element Sp possesses an
extremal property: For a given number of equivalence classes it contains the
maximal share of all decision rules. However, it is difficult to compute the
value LdL and thus to form the structure (8.25). Therefore we shall consider
another characteristic of the size of equivalence classes which is similar to
LdL in its meaning and can be obtained in practice.
Denote by Pr the value of the distance between the convex hulls of the
two classes into which are placed vectors of the complete sample allocated
to different classes by the decision rules belonging to Fr , and assign to the
equivalence class Fr the number
(8.26)
FIGURE 8.1. To each equivalence class F, there corresponds a distinct region on the
surface of the sphere.

352
8 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
where D /2 is the radius of the smallest sphere containing the set (8.24); that
IS,
D2 = m!n max Ilxi - x·ll.
x
XI, ... ,Xt.k
Now we define a structure
SI C S2 C ... C Sn
(8.27)
on the equivalence classes; here Sr contains only those equivalence classes Fj
such that
1
7T(Fi ) >
r::-1
for r < n,
yr-l
7T(Fi ) ~ 0
for r ~ n, r ~ 2.
(8.28)
The set SI in (8.27) is empty.
To construct a method of structural risk minimization for the overall risk
on the structure (8.27) we shall bound the number Nr of equivalence classes
belunging tu the element of the structure Sr.
The following theorem is valid.
Theorem 8.4. The number of equivalence classses in Sr is bounded by
N r < exp {r (In e; k + 1) } ,
where
(8.29)
(8.30)
n is the dimensionality of the space, and [a] is the integer part of number u.
Proof Observe that the number Nr equals the maximal number of subdivi-
sions of the sample
into two classes such that the distance between their convex hulls exceeds
D / vr=t; that is,
D
P> vr=t = pro
(8.31)
r - 1
According to Theorem 4.3 (Chapter 4, Section 4.9) the number of such
decision rules does not exceed

8.5 ESTIMATION OF VALUES OF AN INDICATOR FUNCTION
353
where r is the maximal number of points in the sample for which an arbitrary
subdivision into two classes satisfies (8.31). Observe that if the condition
(8.31) is fulfilled, then the subdivision is evidently carried out by means of a
hyperplane; therefore obviously
r ~ n,
where n is the dimension of the space.
Now consider r points
Xl, ... , X r
and 2r possible subdivisions of these points into two subsets
Denote by Pr(Ti ) the distance between the convex hulls of vectors belonging
to distinct subsets under subdivision Ti •
The fact that (8.31) is fulfilled for any Ti can be written as
minp(T;) > Pro
j
Then the number r does not exceed the maximal number of vectors such that
the inequality
(8.32)
is still fulfilled. It follows from symmetry considerations that the maximal r
is attained where the vectors Xl, ... , Xr are located at the vertices of a regular
(r - 1)-dimensional simplex inscribed in a sphere of radius D/2, and T; is
a subdivision into (a) two subsimplices of dimension (r/2 -1) for even r
and (b) two subsimplices of dimensions (r - 1)/2 and (r - 3)/2 for odd r.
Therefore elementary calculations show that
H(r) =I
For r > 10 the quantities
D
vr=t
D1;2
vr=tV~
for even r,
for odd r.
1
and
11;2
vr=tV~

354
8 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
are close to each other (they differ by the amount less than 0.01). Thus we
take
D
H(r) = vr=t
(8.33)
r - 1
(A bound from the above on H (r) would have been the expression
D
H(r) < vi
'
r - 1.01
r> 10-)
It follows from the inequalities (8.32) and (8.33) that for integer r we obtain
r < [~22] + 1.
Finally, taking into account that the subdivision is done by means of a
hyperplane (i.e., r ::; n), we ohtain
(8.34)
Consequently in view of Theorem 4.3 we have
The theorem is thus proved.
It follows from Theorem 8.2 and Theorem 8.4 that with probability 1 -
71
simultaneously for all decision rules in Sr the inequality
kf
2
J
(k£)2
vl(a) ::; v(a) + 2(£ + k) + £
v(a) +
2(£ + k)
= R(a, r)
is satisfied, where £ is the smallest solution of the inequality
(
f + k
)
r
In -r- + 1
+ In ff,k (B) ::; In 71·
(8.35)
The method of structural minimization of the overall risk consists of indexing
the working sample by means of the rule I(x, a:mp ) which minimizes the
functional (8.35) with respect to r and a E A. Let the minimum be equal to
R(a;mp' r.). For such an indexing procedure the assertion
is valid.

8.6 SAMPLE SElECTION FOR ESTIMATINGTHE VAWES OF AN INDICATORFUNCTION
355
FIGURE 8.2. Two approaches to the problem of estimating values of the function at
the given points. Using inductive inference we construct the separating hyperplane f o.
and using transductive inference we construct the separating hyperplane fl'
Consider an example that illustrates the difference between solving the
problem of classifying vectors in the working sample using the method of
minimizing the overall risk and using a decision rule that minimizes the em-
pirical risk for a training sequence.
In Fig. 8.2, vectors of the first class of the training sequence are denoted
by crosses, and vectors of the second class are denoted by small circles. Dots
represent vectors of the working sample.
A solution of this problem within the framework of minimizing the ex-
pected risk consists in constructing a subdividing hyperplane that will ensure
the minimal probability of error. Let the solution be chosen among hyper-
planes that subdivide the vectors of the training sequence without error. In
this case the minimal guaranteed probability of error is ensured by the opti-
mal subdividing hyperplane (the one that is the farthest from the elements of
the training sequence). The vectors that are located on different sides of the
hyperplane f o are assigned to different classes. This determines the solution
of the problem using the method of minimizing the empirical risk. A solution
of the problem using the method of minimizing the overall risk is determined
by the hyperplane f\, which maximizes the distance between the convex hulls
of the subdivided sets. Vectors located on one side of the hyperplane belong
to the first class, and those on the other side of the hyperplane belong to the
second class.
The points of the working sample that are classified by the hyperplanes
f o and f j in a different manner are shaded in Fig. 8.1.
8.6
SAMPLE SELECTION FOR ESTIMA'rING THE VALUES OF AN
INDICATOR FUNCTION
We have seen that the solution of the problem of estimating the values of an
indicator function at given points using the method of structural minimization

356
8 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
of the overall risk leads to results that are different from those obtained from
the classification of vectors of the working sample
Xi+l, ... , Xi+k
(8.36)
by means of a decision rule [(x, £lemp) that minimizes the empirical risk on
the elements of the training sequence
(8.37)
This result was obtained because the complete sample
(8.38)
consisted of a small number of elements whose special location could be
studied; it is related to a specific method of ordering the class of decision
rules [(x, a), a E A.
The method of ordering actually determined the difference in classifica-
tion. Thus the geometry of vectors in the complete sample (8.38) predeter-
mined the posibility of a more accurate solution of the problem of estimating
the values of a function at given points.
If this is indeed the case, then the question arises: Is it possible, by ex-
cluding a few elements from the complete sample (8.38) (i.e., by changing
the geometry of the vectors of the complete sample in space), to affect the
construction of the structure on the class of decision rules in order to in-
crease the guaranteed number of correct classifications of the elements in
the working sample? It turns out that this is possible.t
We now present the idea of selection o[a complete sample. Consider, along
with the set X of vectors in the complete sample (8.38),
t
H~+k = L Cf+k
p=o
distinct subsets
obtained from (8.38) by excluding at most t vectors. Now let the training
sequence (8.37) and the working sample (8.36) be defined on the initial set
of vectors (8.38). The training and working samples induce on each one of
the sets Xl, ..., XH,
its own training and working subsamples.
/.k
Consider H;+k problems of estimating values of a function at given points.
Each one of these problems is determined by a training sequence
----..
~
XI, WI; ,,,;Xi, Wi; ... ;Xj, Wj; ",;Xi, Wi
t We note that in the case of estimating an indicator function the selection of the training sample
does not lead to a decrease in the estimation of the minimal guaranteed risk.

8.6 SAMPLESELECTION FOR ESTIMATINGTHE VALUES OF AN INDICATOR FUNCTION
357
and a working sample
...............
Xl+l, ... , Xl+(, ""Xf+k
(~denotesthat the element X, w is excluded from the sequence).
For each problem, in accordance with its complete sample
.....--..
.....--..
.....--..
Xl,· .. ,
Xi ,''',
Xj "",xl+(,,,,,Xf+k
we shall determine the equivalence classes of linear decision rules. We de-
fine a structure on the equivalence classes, utilizing the principle of ordering
according to relative distance considered in the preceding section.
It follows from Theorem 8.2 and Theorem 8.4 that with probability 1 -
11
in each problem (separately) the inequality
(8.39)
is valid for the rule [(x, a;mp) minimizing the empirical risk in Sr, where [ is
the smallest solution of the equation
(
f + k - kexc - f exc
)
r
In
r
+ 1
+ In ff-fexc,k-kexc (t:) S; In 11·
(8.40)
In (8.39) and (8.40) the following notation is used: f exc is the number of
elements excluded from the training sequence, and kexc is the number of
elements excluded from the working sample.
Simultaneously for the rth elements of the structure for all H;:ffexc prob-
lems the inequality
(
(k
k(i) ) C'(i)
) 2
(i)
r
)
-
exc '"
v
(aemp +
2(f + k _ k~ilc -
f~~c)
(8.41)
is fulfilled with probability 1 - 11, where [(i) are the smallest solutions of the
equations
(8.42)

358
8 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
where the total number of excluded elements varies from 1 to t. In (8.41) and
(8.42) the following notation is used: k~jJe and f~~e are the numbers of elements
in the training and the working samples omitted from (8.37) and (8.36) when
forming the ith problem, and Vii\ a~mp) and v U)(a~mp) are the frequencies of
erroneous classification of the working and the training samples in the ith
problem. Multiply each of the inequalities (8.41) by k -
k~jJe. This will yield
for each problem a bound on the number of errors mj in k -
ki~c elements
of the working sample:
(
( k
_ k(i) )[(i)
) 2
(I')
U) (
r
) +
exe
(k
k
)
v
a emp
-
exe'
2(f + k
-
k(i)
-
f U) )
exe
exe
(8.43)
If the number of vectors excluded from the working sequences were the same
for all problems and equal to kexe, then the best guaranteed solution of the
problem of classifying k - kexc vectors in the working sample would be deter-
mined by the inequality (the problem) for which the bound on the number of
errors in the k - kexc elements of the working sample is the smallest. How-
ever, the number of vectors excluded from the working sample is not the
same for different problems. Therefore we shall consider as the best solution
the one that maximizes the number of correct classifications of the elements
of the working sample-that is, the one that minimizes the quantityt
R(r,i)
(k
k(i))
k(l)
-
exe +
exe
(8.44)
(the number of errors plus the number of vectors excluded from the working
sample).
Now by enumeration over rand kexc we shall determine vectors that should
be excluded to guarantee the largest number of correctly classified vectors in
the working sample. The problem of minimizing the functional (8.44) with
t Here one can introduce different costs for error and refusal to classify elements in the working
set.

8.7 ESTIMATION OF VALUES OF A REAL FUNCTION
359
respect to rand kexc is quite difficult computationally. Its exact solution re-
quires a large number of enumerations. However, by using certain heuristic
methods, one can achieve a satisfactory solution in a reasonable amount of
time.
Observe that in the course of selection of a complete sample, the elements
are picked for both the training sample and for those of the working sample.
A selection of elements of the working sample allows us to increase the
total number of correctly classified vectors at the expense of declining to
classify certain elements.
Up until now we have assumed that the space on which the structure
is constructed is fixed. However, the procedure of ordering with respect to
relative distances may be carried out in any subspace Em of the initial space
En. Moreover, the minimal values of the corresponding bounds need not be
obtained on the initial space En. This fact yields the possibility of achieving
a more refined minimum for the bound on the risk by means of additional
minimization over subspace.
8.7
ESTIMATION OF VALUES OF A REAL FUNCTION IN THE CLASS OF
FUNCTIONS UNEAR IN THEIR PARAMETERS
Now we extend the methods of estimating values of indicator functions con-
sidered in the preceding sections to the estimating of values of a real function
in a class of functions linear in their parameters.t For this purpose we shall
determine equivalence classes of linear (in parameters) functions on a com-
plete sample, define a structure on these classes, and implement the method
of structural risk minimization.
Let a complete sample
(8.45)
and a set of linear (in parameters) functions I(x, a), a E A, be given. We
shall assign to each function I(x, a*) in this set a one-parameter family (in
the parameter (3) of decision rules
la·({3) =
(J (f(x, a*) + (3),
(3 E (-00,00).
(8.46)
As the parameter {3 varies from -00 to 00, the family (8.46) forms a sequence
of dichotomies (subdivisions into two classes) of the set of vectors (8.45): It
starts with the dichotomy for which the first class is empty and the second
class consists of the entire set of vectors
t Note that this does not mean that an unknown relationship is described by the function linear in
its parameters. This means that we will approximate an unknown relationship by these functions.

360
8 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
(for (3 = -00), and it ends with the dichotomy for which the first cJass con-
tains the entire set (8.45) and the second class is empty:
(for (3 = 00). Thus for each function [(x l a) a sequence of dichotomies
(8.47)
can be constructed. In accordance with this sequence of dichotomies we shall
subdivide the set of functions [(x, a), a E A into a finite number of equiva-
lence classes. Two functions [(x, ad and [(x, a2) fall into the same equiva-
lence class Fi if they form the same sequence of dichotomies (8.47).
Now assign to each equivalence class a number 1T(Fi ) that is equal to the
fraction of all functions belonging to it, and then arrange the equivalence
classes in the order of decreasing values of 1T(Fi ):
(8.48)
Utilizing this ordering (8.48), one can construct a structure on the set of the
equivalence classes
SI C S2 C ... C Sf!'
The element Sr contains those equivalence classes Fi for which
1T(F,) > Cr'
One can define the fraction of functions belonging to an equivalence class
in the case of sets of linear functions in the same manner as the fraction of
linear decision rules was determined. Now assign to each linear function a
vector of direction cosines. Then the surface of the input sphere in the space
of dimension n will correspond to the set of all functions, and a particular
region on this sphere will correspond to each equivalence class (Fig. 8.1).
The ratio of the area of a single-out region to the area of the surface of the
sphere will determine the fraction of functions belonging to an equivalence
class among the entire set of functions.
In practice, however, it is difficult to compute the characteristic 1T(Fi )
directly. Therefore, in the same manner as in Section 8.5, we shall consider
another characteristic of the size of an equivalence class. For each function
n
[(x, a) = L aicPi(Z)
i=1
we define a directional vector a/llall. Each equivalence class, Fm is charac-
terized by the number
Pm = I?~nsup I(Zi - Zj)T -llalll '
i =1= j,
.... ,.'"--/
a
a

8.7 ESTIMATION OF VALUES OF A REAL FUNCTION
361
where the minimum is taken over all the vectors of the complete sample, and
the supremum is taken over all directional vectors of a given equivalence
class.
We now form the following structure:
The functions for which
1T
2(F) = [~] > ~
1T2(F)
= [~] ~ a
for d < n,
for d ~ n,
where D is the minimal diameter of the sphere containing the set (Zl, ... , Zf+k),
are assigned to the dth element of the structure Sd' Utilizing the results of
Theorem 8.4, one can show, as in Section 8.5, that the capacity of functions
belonging to the Sdth element of the structure equals d, where
The method of structural risk minimization for this structure involves finding
an element So and a function f(x, a;mp) in it such that the minimum on the
right-hand side of the inequality
(8.49)
is obtained. Here [ is the smallest solution of the inequality
(
f+k
)
d
In -d- + 1
+ In rf,de) ::; In 71·
The first factor on the right-hand side of (8.49) depends only on the order
in which the vectors of the complete sample are projected on the vector of
directions on the selected linear function, while the second factor depends
on the value of the empirical risk.
Let the minimum on the right-hand side of (8.49) equal R(a;mp,d*). Then
the assertion
P{R!(a:mp) < R(a:mp ,dO)} > 1 - n71.
is valid.

362
8 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
8.8
SAMPLE SELEC1'ION FOR ESTIMATION OF VALUES OF
REAL-VALUED FUNCTIONS
Let a complete sample
Xl"",Xf"k,
(8.50)
be given. Consider Htt k different subsets Xl, ..., XH, ,each of which is ob-
+
I.k
tained by omitting at most i elements from (8.50). Below we shall assume
that for all subsets the condition (8.16) is fulfilled.
Now let a training sequence
(8.51 )
and a working sequence
Xf+l, ... , Xf+k
(8.52)
be defined on the initial set (8.50). The samples (8.51) and (8.52) induce on
each of the subsets its own training and working samples, respectively.
Consider H;+k problems of estimating values of a function at given points.
For each problem r (r = 1, ... , H:+k ) we shall define-using the method de-
scribed above-its own structure on the class of the class of linear functions
SI C '"
C
S~.
We then obtain with probability 1 - 11, for each of the problems (separately).
the bound
(R.53)
is valid, where f(x, ll'emp) C Sd is a function that minimizes the empirical risk
on the training sequence for this problem (index r indicates that the overall
and empirical risks are computed over the elements belonging to the subset
X') and £' is the smallest solution of the inequality
Here we use the following notation: i -
f~xc is the lenth of the trammg
sequence in the problem r, and k -
k~xc is the l~ngth of the working sample
in the problem i~xc + k~xc = I,. With probability 1 -
11 simultaneousely for Sci
elements of all H;+k problems. the inequalities
[
f - f'
]
1+ m(p)
exc
£'
R' ()
£ + k -
i~xc -
k~xc
R'
(
)
~ ll'emp
~
k _ k'
emp ll'emp
1 - m(p)
exc
£'
f + k -
f~xc -
k~xc
'X
(8.54)

8.9 LOCAL ALGORITHMS FOR ESTIMATING VALUES OF AN INDICATOR FUNCTION
363
hold true, where (unlike the preceding case) £, are the smallest solutions of
the inequalities
(
e+ k- e;"c - k;"c
)
I
f
()
I HI
I
d
In
d
+ 1
+ n
R-R~xc,k-k~xc e + n
P+k S n 1].
We now choose a problem for which the bound of the value of the overall
risk is minimal.
Finally, enumerating over d and t, we obtain the best solution.
8.9
LOCAL ALGORITHMS FOR ESTIMATING VALUES OF AN
INDICATOR FUNCTION
Finally consider the local algorithms for estimating functional values. We
define for each vector Xi of the complete sample a system of neighborhoods:
(1)
(Xl)l E (xj,xi,h E··· E (Xj, ...,xp+dq;
(2)
(X2)] E (X2,Xi2h E ... E (x], ""X(+k)q
Now let a subdivision of the set X into the training and the working sample
be carried out.
Consider an arbitrary neighborhood X[ of the point Xi containing elements
of both the training and the working samples. In view of Theorem 8.2, one
can assert with probability 1 - 1] that simultaneously for all decision rules
the inequality
k'(E')Z
J
[ k'(£')
] 2
v'(a) < v'(a) +
+ e'
v'(a) +
~
2(e' + k')
*
2(e' + k'}
is fulfilled, where
v~ (a) is the value of the overall risk of classification of
elements belonging to the neighborhood X[ by means of a decision rule
f(x, a), v'(a) is the value of the empirical risk computed for the rule f(x, a)
based on the elements of the training sequence belonging to neighborhood
X;, E' is the smallest solution of the inequality
(
£' + k'
)
n
In
n
+1
+lnffr,kr(e)Sln1],
and n is the dimension of the space X. In this inequality, e' and k' are the
numbers of elements belonging to the neighborhood X; in the training and
the working samples. Let f(x, a emp ) be a decision rule that minimizes the
value of the empirical risk on the training sequence belonging to X;.

364
8 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
For the elements belonging to X; the bound
k'(E'?
J
[ k'£')
]2
v:i.(aemp ) < v'(aemp ) + 2((' + k') + £'
v'(aemp ) +
2(f' + k')
= RJr)
is valid with probability 1 - 'rI. We shall now obtain a neighborhood of the
point Xi for which the minimum (with respect to r) of the value Ri(r) is
attained. Let the minimum be attained in a neighborhood X/ and let Wi l , ••• , Wi,
be the classification of vectors obtained in the working sample belonging to
this neighborhood. Clearly, with probability 1 - T/q this classification contains
less than Ri (T)kr = Ri errors.
Analogously, solutions can be obtained for neighborhoods of all vectors
belonging to the population. The results are presented in Table 8.1.
In the first column of the table, the vectors are given which define the
system of neighborhoods, followed by the best classification of vectors for the
given system and finally the guaranteed bound on the number of classification
errors. Observe that the same vectors of the working sample belong to the
neighborhoods of different vectors and that the classifications of some vectors
from the working sample presented in different rows of the second column
may not be the same.
Denote by w;+l' ... , w;+k the correct classification of vectors from the work-
ing sample Xf+1, ""Xf+k' Then the content of the table may be written in the
form
(1)
Llwi-Wil <R j
(8.56)
(f+k)L Iwi - wil < R f +b
Table 8.1. Results for neighborhoods of all vectors belonging to the population
Neighborhood
Classification of Vectors
Bound on
of Point
XI-\-I
...
Xf-\-)
...
Xf+k
Overal Risk
Xl
wI
...
-
...
WI
R I
1
hk
X s
-
s
-
R,
...
WI-\-}
...
Xf-\-k
-
...
-
...
wi-\-k
Rf+k
i-\-k

8.10 LOCAL ALGORITHMS FOR ESTIMATING VALUES OF A REAL-VALUED FUNCTION
365
where L:(X,) indicates that the summation is carried out only over those clas-
sifications of vectors of the working sample that belong to the selected neigh-
borhood of the point Xi.
Each one of the inequalities (8.56) is fulfilled with probability 1 - q 71·
Consequently the system is consistent (all inequalities are satisfied simulta-
neously) with probability exceeding 1 - q(P+ k) 71.
Consider the set n of vectors w = (w€+!, ..., WC+k) of solution of the system
(8.56). Actually the final vector of the classification may be chosen arbitrarily
from this set. However, it is more expedient in such a case to choose a solution
that possesses some additional extremal properties. Among all the vectors in
n we shall find the minimax w:-that is, the one whose distance from the
farthest vector belonging to the admissible set n is the smallest:
w: = argminmax Iw - wi·
wEn wEn
The vector w; will be chosen as the final solution of the problem of classifying
vectors in the working sample.
In this algorithm, by defining a system of neighborhoods of vectors in the
complete sample, we were able to determine for each vector Xi an optimal
neighborhood for constructing a linear decision rule. The rule thus obtained
was used only for classification of the vectors to an optimal neighborhood.
Such algorithms are sometimes referred to as local ones.
]n practice, different ideas for defining neighborhood are utilized. In par-
ticular, a neighborhood X; of the vector Xi can be defined by means of metric
closeness. (The set X; contains vectors belonging to the complete sample
such that Ilx - Xj 1/ < c, where C is a constant. The collection of constants
C! < ... ~ c, determines the system of neighborhoods.)
8.10
LOCAL ALGORITHMS FOR ESTIMATING VALUES OF A
REAL-VALUED FUNCTION
Using the scheme described in the preceding section, one can construct local
algorithms for estimating values of a real-valued function. Form a system of
neighborhoods for vectors belonging to a complete sample:
(1)
(Xl)! E (Xl,XjJ2 E ... E (Xl, ""xf+d q
(P + k)
(XC+dl E (Xf+k'Xhh E ... E (Xii' ...,x{+dq
Let a subdivision of the set of vectors from the complete samples into ele-
ments belonging to training and working samples be carried out. Consider a
system of neighborhood for the point Xi:
xl
C xl··· C xjq,
X~
(
)
I
=
Xj, Xj2, .. ·,Xjp r'

366
8 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
For each set X; one can determine-using algorithms for estimating a
linear function-the values of the function as well as a guaranteed bound on
the value of the overall risk:
€,
1+ ra(p) n
k £
R ()
f-, +,
R(,j
(
)
~Id
O'emp < -(.,---------'--"k-,--'-~):--
emp O'emp ,
1 - ra(p) n
k £
f-, +,
+
where £ is the smallest solution of the equation
(
€, + k,
)
n
In
n
+1
+lnrr"k,(e):s;lnT/'
(8.57)
(8.58)
Here €, and k, are the numbers of elements in the training sample and in
the working sample belonging to X;.
Choose the neighborhood of the point Xi and a function F (x, 0';) for which
the bound (8.57) is minimal. Let k; be the number of elements of the working
sample belonging to this neighborhood. The inequality
(8.59)
is valid with probability I - qT/ for the value y; belonging to this neigh-
borhood obtained using the function F(x, O';mp)' In (8.59) the summation is
carried out over the vectors x from the working sample that helongs to the
optimal neighborhood; yare the actual (unknown to us) values of the func-
tional dependence at the points of the working sample, and F(x;, O':mp) are
the computed values. Thus for each point Xi (there are € + k such points in
toto, which is the number of vectors in the complete sample) the inequality
(8.59) is valid with probability 1 -
T/. Therefore with probability 1 - q(f + k)T/
all e+ k inequalities
~. L(Y; - F(x;, 0':mp(1»)2 < £1
I
k;
u(60)
are fulfilled simultaneously.
Consider an admissible set {Y} of solutions (yf+l, ...,Yf+k) of the system
(8.60). This set is nonempty with probability 1 - q(f + k)T/. Choose as the
response a solution Y' such that its distance from the farthest point in {Y}

8.11 THE PROBLEM OF FINDING THE BEST POINT IN A GIVEN SET
367
is the smallest (the minimax solution)-that is, a k-dimensional vector y* for
which the equality
Y· = arg min !Jlax p(Y, Y)
YE{Y} YE{Y}
is valid.
8.11
THE PROBLEM OF FINDING THE BEST POINT IN A GIVEN SET
Consider the following problem. Given a training sample
(8.61)
find among the working sample
(8.62)
the best point-that is, the point on which the unknown function takes the
largest (or the smallest) value with the highest probability. Solving this prob-
lem we will try to avoid estimating the function at the points (8.62) (our goal
is to find the best point o[ the set (8.62), not to estimate the values of the
function). As before in similar situations it is possible that the available data
(8.61) and (8.62) are insufficient for a reasonable solution of the intermedi-
ate problem (estimating the values of a function of the set (8.62)), but are
sufficient for solving the desired problem (to find the best point of the set
(8.62)).
Below we consider a particular solution to this problem, but first we would
like to note that the statement of this problem is a response to the limited
amount of available empirical data in some important settings of real-life
problems.
Example. Only a few dozen antitumor drugs have been clinically tested on
human beings to date. Meanwhile, hundreds of new antitumor drugs are syn-
thesized annually. These drugs are tested using different models of human
tumors (including animal tumors). Effectiveness of the drugs on the various
models (on animals) does not, however, ensure its clinical effectiveness on
humans. The problem is to identify in the given set of drugs (8.62) the clini-
cally most active one, x•. To identify such a drug, one can use the information
x about the results of the models testing (8.62); and for the previous testing
set of drugs, one can use both the information y about the clinical activity of
the drug and the information x about activity on the models (pairs (8.61)).
Thus let the training sample (8.61) and the working sample (8.62) be
given. Let the class of functions [(x, a), a E A, contain a function [(x, 00) that
orders the vectors x from both the training and the working samples in the
same way as an unknown function that determines the values of y. (For the

368
8 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
set of indicator functions, this condition degenerates into the requirement
that an E A.) Among the vectors of the working set, it is required to find
the one x. which with the highest probability possesses the maximal value
y. = [(x., an).
As before, first consider the case of indicator functions [(x, a), a E A,
where we denote y = W E {O, I}, and then we will consider the case where
[(x, a), a E A, is a set of real functions.
8.11.1
Choice of the Most Probable Representative of the
First Class
Let [(x, a), a E A, be a set of indicator functions. We denote
(8.63)
(The sequence Xi (the sequence 0) is obtained from the sequence of all
vectors (values) by omitting the element Xi (element Wi ).) Generally speaking,
the sequence Xi can be divided into two classes in Zk-l possible ways. Let
us denote by Oi, r = l, ... ,Zk~l, one of these ways. Assume that for each r
the probability P (OD is defined that 0i will coincide with the classification
of the sequence Xi performed using the function [(x) that has been defined.
Then for each fixed vector Xi of the working sample, one obtains
2k - 1
P{Wi = lIR,X} = Z=P{Wi = lIR,X,O~}P(O~).
r=1
(8.64)
Moreover, since the class [(x, a), a E A, contains the function [(x), one of
the N equivalence classes FI , ... , FN can separate data without an error. Let
a priori probabilities for any equivalence class to perform without error be
equal. The probabilities P(O~) and P {Wi = llR, X, O~} on the right-hand side
(8.64) can be calculated. Namely, the probability that the classification O~ of
the vectors Xi coincides with that specified by the function [(x) is equal to
p(Oi) =
n(Xi,!!~)
r
N'
(8.65)
where n(Xi , O~) is the number of equivalence classes that classify the se-
quence in compliance with
O~. The conditional probability that vector Xi

8.11 THE PROBLEM OF FINDING THE BEST POINf IN A GIVEN SET
369
belongs to the class Wi = 1 is equal to
P{wi=lIR,X, n~} =~=
a
if there is no equivalence class that permits
the separation R UXin~;
1 if there is an equivalence class that permits
the separation R UXin~ UXi, 1 and
there is an equivalence class that permits
the separation R UXin~ UXi, 0;
1
if there is an equivalence class that permits
the separation R UXin~ UXi, 1 and
there is no equivalence class that permits
the separation R UXin~ UXi, O.
(8.66)
Substituting the expression (8.65) and (8.66) into (8.64) we can estimate the
probability
2k - 1
.
{
IR X}
,,{
I
Oi}n(Xi,n~)
P
Wi = 1,
= L
P
Wi = 1 R,X,Hr
N
.
r=1
(8.67)
It remains to choose from the k vectors the one for which this probability is
maximal.
Note that the larger the class f(x, a), a E A, the smaller in general is
maxP{Wi = 1IR,X}.
i
In the extreme case where the class of functions f(x, a), a E A, is so wide that
it permits the maximal possible number of equivalence classes, the equality
P{Wi = 1IR,X} =
~
holds no matter what the number i is.
Another natural assumption is that the a priori probability on the equiv-
alence classes is given by binomial law with a parameter p (p is probability
of occurrence of an element with W = 1). The a priori probability of correct
separation is
Pj ="'\;""'N
em, pm, (1 _ p)f+k-m, '
WJ=!
l+k
where mj is the number of elements which are classified by the rules from
Fj with W = 1. Under this assumption we have

370
8 ESTIMATING THE VALUES OF FUNCTION AT GIVEN POINTS
where
p
m~(l - p)
P+ e+ k + 1 - m~
o
1
x~ =
if there is no equivalence class that permits
the separation R U Xif1~;
if there is an equivalence class that permits
the separation R UXjf1~ UXj, 1 and there is an
equivalence class that permits the separation
R U Xjf1~ UXj, 0;
if there is an equivalent class that permits
the separation R U Xjf1~ UXj, 1 and there is no
equivalence class that permits the separation
RUXjf1~UXj,O
and m~ is the number of pairs in the set R U Xif1~ UXj 1 with w = 1.
8.11.2
Choice of the Best Point of a Given Set
Consider the case where in a given training set
y takes an arbitrary values. Note that the elements of the sequence
x = X f +I , •.. , Xf +k
can be ordered in all possible ways by using permutation operators Tr (r =
1,2, ...,k!).
Let ToXo denote the sequence of the vectors x from the training set
ordered according to the decreasing corresponding values y (for simplicity
let us assume that the ordering is strict).
We write
z ,?-f X
if f(z) > f(x) for all x EX.
Assume now that the vector Xj is fixed in the working sample. There are
(k - I)! different ways to order the set Xj. Assume that for each of these one
knows the probability P (TrXj ) that the order of the sequence TrXi coincides
with order of the sequence on X j obtained by the decreasing corresponding
elements f(x). Then for each fixed vector Xi of the working sample we obtain
(k-I)!
P{Xi ,?-f Xii ToXo,X} = 2:= P{Xi ,?-f Xii ToXo, TrXdP{TrXd·
r=1
(8.68)
From the viewpoint of ordering the vector x of the complete sample, the class
of functions f(x, a), a E A, is decomposed into a finite number of equiva-
lence classes F1, ... , FN. Among these equivalence classes there is the one that

8.11 THE PROBLEM OF FINDING THE BEST POINT IN A GIVEN SET
371
orders the complete sample set of x according to the decreasing values [(x).
Let there exist a priori probability defined on equivalence classes. Then the
probabilities P{T,X;} and P{x; >-1 X;! ToXo, T,X;} can be computed. The
probability that the ordering T,X; coincides with the one given by the func-
tion [(x) is
P{TX} = n(T,Xj)
, IN'
(8.69)
where n(T,X;) is the number of equivalence classes with the ordering T,X,.
The conditional probability that x; is the best point is
o
1
p+1
1
(8.70)
where x:. is equal to zero if there is no equivalence class that permits simulta-
neously the ordering ToXo and x;, T,X; (x;, T,X; is a sequence whose leftmost
element is Xj and the remaining ones coincide with T,X;) and g: is equal to
1j(P + 1), p = 0, ... , k - 1, if there are (p + 1) equivalence classes that permit
simultaneously the ordering of ToXo and x; T,Xj. Substituting (8.69), (8.70),
in (8.68), we obtain
(k-l)'
.
P{ .
1 X.
'T' X
X} =
'"' ,¥,..n(T,X;)
XI >-
I' lO
0,
L.J
N
.
,=1
(8.71)
Consequently, the probability that among the vectors of the working sample
the vector x; will have the maximum value of [(x) is determined by (8.71). It
remains to choose the vector with the maximum probability. As before, the
wider the class of the functions [(x, a), a E A, the smaller in general is
m~xP{xj >-1 Xjl ToXo,X}.
I
In the extreme case where the class of [(x, a), a E A, is so wide that all
N = (f + k)! of equivalence classes are possible, the equality
holds independent of the number of i.


II
SUPPORT VECTOR
ESTIMATION OF FUNCTIONS
Part II introduces methods that provide generalization when estimating multi-
dimensional functions from a limited collection of data.


9
PERCEPTRONS AND
THEIR GENERALIZATIONS
The next chapters of the book are devoted to constructing algorithms for
pattern recognition, regression estimation, signal processing problems, and
solving linear operator equations. Methods for constructing hyperplanes with
good statistical properties are the key to these algorithms.
In this chapter we consider the simplest methods. These methods bring
us to the classical learning algorithms: perceptrons and their generalizations.
potential functions (radial basis functions), and neural networks.
The basis for these methods were developed in the 1960s. In the late
1980s and early 1990s they became the major tools for constructing learning
machines.
9.1
ROSENBLATT'S PERCEPTRON
At the end of the 1950s, F. Rosenblatt proposed a machine (Perceptron) for
learning from examples. He considered a set of indicator functionst linear in
their parameters
f(x, w) = sign {~wP'MX)}
(9.1)
and suggested a procedure for choosing from this set an approximating func-
tion using a sequence of examples
t To simplify the notations we consider indicator functions of the form sign(u) E {-I, I} instead
of the form 8(u) E {D, I}.
375

376
9 PERCEPTRONS AND THEIR GENERALIZATIONS
where Yi = 1 if vector Xi belong to the first class and Yi = -1 if vector Xi does
not belong to the first class.
The Perceptron utilitizes the following recurrent procedure for choosing
the function (the coefficients w = (wi, ..., wn) in Eq. (9.1)):
1. At step zero choose the function f(x,O)
(with coefficients w(O) =
(0, ... ,0)).
2. At step t using the element (Yt, Xt) of the training sequence, change the
vector of coefficients w(t - 1) in accordance with the rule
{
w(t - 1)
w(t) =
w(t - 1) + yt'l't
if Yt(w(t-1)*'I't) >0,
if Yt(w(t - 1) *'I'd :s 0,
where we denoted by 'l't = (1/11 (Xt), ... , I/1n(Xt)) an n-dimensional vector
and by (w (t - 1) *'l't) the inner product of two vectors.
Note that the coefficients w(t - 1) change only if the example (Yt,Xt) is mis-
classified by the constructing hyperplane.
In Rosenblatt's Perceptron the functions 1/11 (X), ... , I/1n(x) are superpositions
of fixed linear indicator functions. However, for the theory of Perceptrons
this fact is not important. Without restriction of generality we will assume
below that there exists a nonlinear operator, A, mapping vectors X E X into
vector U E U. Therefore the Perceptron constructs a separating hyperplane
f(u, w) = sign{ (u * w)}
passing through the origin in U space. The space U was called feature space.
The problem of constructing the nonlinear decision rule in the space X re-
duces to constructing a separating hyperplane in the space U. In this space
the rule for estimating unknown parameters has the form
{
w(t - 1),
w(t) =
w(t - 1) + YtUt
if Yt(w(t - 1) *ud > 0,
if Yt(w(t - 1) * u) :s o.
(9.2)
In the early 1960s the first theorems concerning the Perceptron's algorithm
were proved and these theorems actually started learning theory. In this sec-
tion we discuss two of these theorems (the proofs of the theorems are given
in the next section).
Consider an infinite sequence of examples (in feature space)
(9.3)
(9.4)
Suppose that there exists such a vector, wo, that for some Po > 0 the inequality
.
y(wo * u)
mm
~Po
(Y,U)E{Y,U}
Iwol

9.1 ROSENBLATT'S PERCEPTRON
377
holds true. (The given examples are separable with margin Po.) Then the
following theorem is true.
Theorem 9.1 (Novikoff). Let the infinite sequence of training examples (9.3)
with elements satisfying the inequality
Iud < D
(9.5)
(9.6)
be given. Suppose that there exists a hyperplane with coefficients Wo that sep-
arates correctly elements of this sequence and satisfies the condition (9.4).
Then using the iterative procedure (9.2), the Perceptron constructs a
hyperplane that correctly separates all examples of this infinite sequence. To
construct such a hyperplane the Perceptron makes at most
M = [~;]
corrections, where [aj is the integer part of the value a.
Note that this theorem does not take into account how the sequence was
chosen. To make some statistical inference from the Novikoff theorem we
consider two cases:
Case 1. An infinite sequence of examples (9.3) is a training sequencet of
size .e repeated an infinite number of times.
Case 2. An infinite sequence (9.3) containing pairs which are chosen ran-
domly and independently in accordance with some fixed distribution.
Case 1: An infinite sequence is a training sequence of size l repeated an
infinite number of times. In this case the theorem asserts that under condi-
tions (9.4) the proposed procedure minimizes up to zero the functional of
empirical risk and that it will be done after a finite number M of corrections.
In this case, using the bound obtained for the empirical risk minimization
principle, one can get a bound on the risk for a decision rule constructed by
the Perceptron: With probability at least 1 -
71 the inequality
n (In ~ +1) -In 71/4
R(we)~
.e
holds true. (Recall that the VC dimension of the Perceptron with n weights
is equal to n and the empirical risk after M corrections equal to zero.)
Also the following theorem is true.
t Recall that a training sequence is a sequence of pairs drawn randomly and independently in
accordance with a fixed but unknown distribution.

378
9 PERCEPTRONS AND THEIR GENERALIZATIONS
Theorem 9.2. For the Perceptron algorithm ofconstructing hyperplanes in the
regime that separates the training data without error, the following bound on
error rate is valid
[ D
p;1]
where the expectation is taken over the random value
values D f and Pf calculated from the training data).
The proof of this theorm is given in Section 10.4.4.
(defined by the
Case 2: An infinite sequence of examples chosen randomly and indepen-
dently. In this case under conditions of Theorem 9.1 after M corrections
there is an infinite tail of the sequence that will be separated without error.
However, Theorem 9.1 does not tell us how many examples should be
considered to make all necessary corrections. On the other hand we are
looking for a solution with a small value of risk, e > 0 (probability of errors
on the tail of the sequence), which is not necessarily equal to zero. In this
situation (as we will show below) using information about the value of the
margin Po in (9.4) and value of the bound D in (9.5), one can estimate the size
of the training subsequence that one needs to guarantee the construction of
a hyperplane that with given probability 1 - 1/ possesses probability of error
at most e.
To define the size of such a subsequence let us introduce the idea of
stopping rules for the learning processes. Let us simultaneously do two things:
Construct a hyperplane and evaluate its quality. If this quality is not high, we
will continue the learning process; otherwise we will stop it.
We use the following rule: Stop the learning process if after k corrections
the next m(k) elements of the training sequence do not change the obtained
hyperplane (next m(k) examples are recognized correctly).
The theory of stopping rules should answer two questions:
1. What the values m(k) should be to guarantee that if the algorithm will
stop, then the constructed decision rule with high probability 1 - 1/ has
the risk at most e.
2. On what size of training sequence the learning process will be stopped.
The following theorem and its corollary provide the answers to these ques-
tions.
Theorem 9.3. Let the learning process be stopped in accordance with the stop-
ping rule. Then with probability 1 - 1/, one can assert that the constructed de-

9.1 ROSENBLATT'SPERCEPTRON
379
cision rule has a risk at most e if the values m(k) are defined by the following
equalities:
[
2 In k - In 11 + In :2]
m(k) =
-In(1-e)
+ 1,
k = 1,2, ....
(9.7)
Corollary. Let, during the learning process, the Perceptron count how many
examples of the training sequence do not affect the decision rule after k cor-
rections and stop the learning process
~f for some k this number is equal to
m(k), as given by Eq. (9.7).
Then under the condition of Theorem 9.1, one can assert that with prob-
ability 1 the Perceptron will stop the learning process at most at the (£ + 1)st
example, where
£=
[
D 2 ]
7(2
21n
-
- In 11 + In -
~2
6
1 +
0-In(1-e)
[~]
(9.8)
To prove the corollary, note that according to Theorem 9.1 the number of
correctioos does oot exceed [~] aod according to Theorem 9.2 the largeS!
interval hetween corrections is m ([~;]). So the learning process will stop
on the part of the sequence of size less than
Equation (9.8) is explicit form of this equation.
Remark. Note that the corollary does not assert that after £ steps the risk
for the constructed hyperplane will not exceed e. This theorem guarantees
that during the first £ steps the learning process will stop and that in this
moment the constructed hyperplane will possess the required quality. If at
this moment the algorithm does not stop, then the next iterations can worsen
the quality of the hyperplane and after £ steps this quality can be worse than
the required one.
Thus we considered two different regimes of learning for the Perceptron.
In the first regime the Perceptron used the same training sequence several

380
9 PERCEPTRONS AND THEIR GENERALIZATIONS
times to separate training examples. For this regime we can assert that with
probability 1 -
11 the obtained risk is bounded by inequality (9.6).
In the second regime the Perceptron uses any element of the training
sequence only one time and stops the learning process in accordance with
the stopping rule (which depends on t:). For this regime, one can assert that
if t: in Eq. (9.8) is such that
t: 2: 1 - exp
2ln [_D_
2
]
_ In 11 + In _'TT
2
--=---P5~1!_6 [~;]
(9.9)
then with probability 1 the learning process will be stopped on the sequence
of size e, bounded by equality (9.8) and with probability 1 -
11 that the risk
for the chosen function will be less than t:. (This assertion is a consequence
of Theorem 9.3 and Eq. (9.9).)
9.2
PROOFS OF THE THEOREMS
9.2.1
Proof of Novikoff Theorem
Consider a training sequence
where Yt is equal to 1 if vector Ui belongs to the first class and equal to -1
if this vector belongs to the second class. Then according to the Perceptron's
algorithm:
1. If on iteration t the vector Ut is recognized correctly that is,
Yr(Ur * w(t - 1» > 0,
then vector w(t) is not changed, that is,
w(t) = w(t - 1).
2. If this vector misclassified, that is,
Yt(Ut * w(t - 1»
::; 0,
then vector w(t) is changed according to
w(t) = w(t - 1) + YtUt.
We say that in this case the vector of coefficients was corrected.
3. The initial vector w(O) = o.
(9.10)

9.2 PROOFS OF THE THEOREMS
381
Let us bound the norm of vector w(k) after k corrections. Note that if on
step t the correction was done, then
Iw(k)I Z = Iw(k - 1)IZ + 2Yt(Ut * w(k - 1)) + lurl2.
Taking into account that in this case the inequality (9.10) is valid and
IUrl ~ D,
one obtains
Therefore if at step t the number of corrections is equal to k, then
Iw(k)I Z ~ kD2
(9.11)
since w(O) = O.
Now in accordance with the condition of the theorem there exists a vector
Wo such that the inequality
Yi(Uj * wo)
Iwol
2: Po
holds true. Let us bound the inner product in (w(k) * wo)/Iwol. If at the step
t the kth correction occurs, then the inequality
(w(k) * wo)
Iwol
is valid.
Therefore, the inequality
(w(k - 1) * wo)
Yr(Ur * wo)
--C-~-,--~~_ + '----'--;---,---_
Iwol
IWol
> (w(t - 1) * wo)
Iwol
+ Po
(w(k) * wo)
k
Iwol
2:
Po
is valid. Using the Cauchy-Schwartz inequality
(w(k) * wo) ~ Iw(k)llwol
we have
Iw(k)1 2: kPo·
Combining inequalities (9.11) and (9.13), we obtain
D2
k~ -z.
Po
Therefore the number of corrections does not exceed [DZ/ pJJ.
The theorem has been proved.
(9.12)
(9.13)

382
9 PERCEPTRONS AND THEIR GENERALIZATIONS
9.2.2
Proof of Theorem 9.3
During the learning process, let the decision rules
F(x, WI), ..., F(x, wd, '"
be chosen. Now estimate the probability that the learning process will be
stopped in the moment when the chosen rule F(x, Wk) has a probability of
error P(Wk) > e. The probability Pk that the learning process will be stopped
after k corrections, but before the (k + 1)th correction, is equal to the prob-
ability of the event that after k corrections occur, m(k) correct classifications
are made by decision rule F (x, Wk) which is given by
Therefore the probability that the learning process will be stopped when
P (Wk) > e can be bounded as
00
00
P< LPk < L(1- e)m(k).
k=1
k=1
Let us choose the integer-valued function m(k) such that
(1 -
e)m(k) < .!!-
-
k n '
From this equality, one can find that
n>1.
(9.14)
(k) < [Ina -nlnk]
1
m
-
In(1 _ £)
+.
It remains to determine the constant a in such a way that inequality
DO
P < L(1 - e)m(k) S 11
k=1
is valid. To do this we use the inequality (9.14). We obtain
00L ;n = a~(n) = 11,
k=!
(9.15)
where
00
1
~(n) = L k n '
k=1
n>1.

9.3 METHOD OF STOCHASTIC APPROXIMATION AND SIGMOID APPROXIMATION
383
From this equality, one can find
Ina = In 7] -In((n).
(9.16)
Therefore from (9.15) and (9.16) one can find that under conditions
m(k) = [In 7] -In((n) -nlnk] + 1
In(1 - e)
(9.17)
the probability P does not exceed the required value 7]. The bound (9.17) is
valid for any n > 1. In particular for n = 2 we have ((2) =
7T2/6. Therefore
_ [- In 7] + 2ln k + In ~ ]
m(k) -
-In(1 _ e)
+ 1.
The theorem has been proved.
9.3
METHOD OF STOCHASTIC APPROXIMATION AND SIGMOID
APPROXIMATION OF INDICATOR FUNC'nONS
Previous sections considered the problem of minimizing the risk in the set of
linear indicator functions
f(u, w) = sign {(u * w)}
(9.18)
under conditions that a given training sequence can be separated by a linear
hyperplane-that is, when there exists Po > 0 such that the inequality
.
y(wo * u)
mm
~Po
(y,U)E{Y.U}
Iwol
(9.19)
holds true. In particular we considered the case of minimizing the empirical
risk functional (see Section 9.1, Case 1). Now, we would like to construct a
hyperplane that minimizes the risk when the training set
cannot be separated by a hyperplane without error. That is, there is no Wo
that satisfy the inequality (9.19) for a given small Po.
lt is known that the problem of minimizing the number of training errors
is NP complete. Therefore one tries to find the vector Wo that provides the
local minimum to the risk functional
R(w) = I (y - sign{(u * w)})2 dP(u,y)
(9.20)

384
9 PERCEPTRONS AND l"HEIR GENERALIZATIONS
or the local minimum to the empirical risk functional
i
Remp(w) = ~ L(Yj - sign{(uj * w)})2.
j=l
(9.21 )
9.3.1
Method of Stochastic Approximation
In the 1960s a general method for minimizing risk functionals, the so-called
stochastic approximation method, was discovered. According to this method
in order to minimize the risk functional
using the Li.d. data
R(a) = / Q(Z,a)dP(z)
Z(, ",Zf, ... ,
(9.22)
(9.23)
one has to define the gradient gradaQ(zj, a) (with respect to a for given z)
of the function Q(z, a).
Suppose that at any point z, one can estimate the gradient with some
independent random noise
To find a local minimum of the functional (9.22) using data (9.23), the stochas-
tic approximation method suggests the following recurrent procedure:
(9.24)
where sequence of values l'r ~ 0 satisfies the conditions
lim 'Y =0
1--00
00
Ll'1 = 00,
(9.25)
r=(
00
Ll'? < 00,
1=1
and
E({la) = O.
(9.26)
It was proven that this method is consistent under very general conditions.
Below we describe one version of conditions of these type.

9.3 METHOD OF STOCHASTIC APPROXIMATION AND SIGMOID APPROXIMATION
385
Theorem 9.4 (Litvakov). Let the following conditions hold:
1. The functional R(a), a E A, is bounded from below and there exists a
nonempty set of local minima
T = {a: R(a) = inf R(an.
2. The norm of gradients is bounded as follows:
3. The random noise satisfies the following conditions:
E({la) = 0,
E({210') < D(1 + 10'12).
Then for any initial point 0'* with probability 1 the convergence
R(ai) -----'> inf R(a)
i~oo
is valid.
(9.27)
(9.28)
It was also proved that under conditions of Theorem 9.4 the stochastic
approximation procedure (9.24) converges to a (local) minimum of the em-
pirical risk functional
(9.29)
where sequence (9.23) is a sequence Zl, ... , Z, repeated an infinite number of
times.
9.3.2
Sigmoid Approximations of Indicator Functions
One cannot apply stochastic approximation procedures for reaching a local
minimum of functional (9.20), since for this functional the gradient of the
loss function
Q(z, w) = (y - sign{(y - (u * w»})2
does not satisfy the conditions for consistency of the stochastic approximation
procedure (the gradient of function sign{(y - (u * w»} is defined by the delta
function).
Therefore, the idea was proposed to approximate the indicator functions
sign{(y - (w * u»} by the so-called sigmoid functions (Fig. 9.1)
f(u, w) = S {(w *un,
(9.30)

386
9 PERCEPTRONS AND THEIR GENERALIZATIONS
u
FIGURE 9.1. The sigmoid approximation of the sign function.
where S(u) is a smooth monotonic function such that
for example,
S(-CXJ) = -1,
S(+CXJ) = 1,
Sea) = tanha = exp(a) - exp(-a) .
exp(a) + exp(-a)
For sigmoid functions, the gradient
grad [y - S((w * u))]2 = -2 [y - S((w * u))] S~{(w * u)}u
satisfies the conditions described in Theorem 9.3 and therefore for sigmoid
approximation of indicator functions one can use a stochastic approximation
procedure (9.24). One can also use a gradient descent procedure for minimiz-
ing the empirical risk functional with sigmoid approximation of the indicator
function
1
f
Remp(w) = f l:)Yj - S{(w * Uj)} )2.
j=l
Using the gradient of the empirical risk functional
f
gradwRemp(w) = - ~ L [Yj - S((w * Uj ))] S'{(w * Uj )}Uj,
j=l
one defines the procedure
where Yt > 0 are values that satisfy the conditions (9.25).

9.4 METHOD OF POTENTIAL FUNCTIONS AND RADIAL BASIS FUNCTIONS
387
For convergence of the gradient descent method to a local minimum, it is
sufficient that the conditions of Theorem 9.3 be satisfied. Thus, the idea is to
use the sigmoid approximation at the stage of estimating the coefficients and
to use the indicator functions (with the obtained coefficients) at the stage of
recognition.
The idea of sigmoid approximation of indicator functions was proposed
in the mid-1960s. However, it became popular in the mid-1980s when the
method of evaluating the gradient for an entire set of neurons forming the
Multilayer Perceptron (the so-called back-propagation method) was used. We
will discuss this method in Section 9.6; however, first we consider another idea
of the 1960s, which in the middle of the 1980s was used for creating another
approach to the problems of function estimation, the so-called Radial Basis
Function approach.
9.4
METHOD OF POTENTIAL FUNCTIONS AND RADIAL BASIS
FUNCTIONS
In the mid-1960s Aizerman, Braverman, and Rozonoer (1964a,b) suggested
the so-called method ofpotential functions, where they proposed to estimate
the functional dependency from the data
using the following set of functions:
(9.31)
where l/J(O) = 1 and Iimu->oo cP(lul) = O. Function cP(lul), called a potential
function (by analogy with physical potentials), is a monotonic function that
converges to zero with increasing lui. For example,
cP(Iul) = exp{-ylul}·
Using function f(x, a), vector x* is classified by the following rule: Vector x'
belongs to the first class if f(x*, a) > 0; otherwise, it belongs to the second
class.
The algorithms proposed for the method of potential functions were
essentially on-line algorithms-that is, algorithms that in order to construct an
approximation use at any moment only one element of the training data (like
the Perceptron algorithm; see Section 9.1). By 1970 the theory of consistency
of the method of potential functions was constructed.
After 20 years the interest in this type of functions appeared again. In the
mid-1980s, functions of this type were called radial basis functions (RBFs).

388
9 PERCEPTRONS AND THEIR GENERALIZATIONS
However, this time, to construct radial basis function approximations to the
desired function, the off-line methods, namely the methods that minimize the
empirical risk, were used.
9.4.1
Method of Potential Functions in Asymptotic Learning
Theory
When solving the pattern recognition problem on the basis of the potential
functions method, one distinguishes between two cases: the case where repre-
sentatives of two different classes can be separated by the potential function
(9.31) (the so-called deterministic setting of the pattern recognition problem)
and the case where representatives of two different classes cannot be sepa-
rated by the potential function (9.31) (the so-called stochastic setting of the
pattern recognition problem),
For the deterministic case the Perceptron algorithm is used, Let the
approximation
fr-I(x) = I:ai<p(lx - xii)
i=l
to the desired function be constructed by the step number t. Then on the tth
step the algorithm makes the following correction based on a new element
of the training set (Xt, Yt):
{
ft-I(x)
fr(x) =
fr-I(x) + Yt<p(lx - xrlH
if yr!r-l(Xt) > 0,
if Yr!r-I (xr) :S O.
The key idea for proving the convergence of the method of potential
functions is that for any chosen potential function
<P (x) satisfying some
constraintst there exists a feature space Z (not necessarily finite)
Zl = ~(x), .." ZN = ~N(X), ...,
where the potential function (9.31) has an equivalent representation as a
separating hyperplane. Therefore, the theorems described in Section 9.1 for
the Perceptron can be applied for the case of potential functions. Using the
stopping rule described in Section 9.1, one can prove that for the deterministic
case the algorithm constructs the desired approximation in a finite number
of steps.
For the stochastic setting of the learning problems the method of poten-
tial functions relies on the stochastic approximation method of constructing
approximations described in Section 9.3:
fr(x) = !r-l(X) +2Yr[yt - !r-l(xr)]<P(lx - xtl),
t We discuss these constraints in Chapter 10, Section 10.8.4.
(9.32)

(9.34)
9.4 METHOD OF POTENTIAL FUNCTIONS AND RADIAL BASIS FUNCTIONS
389
where
'Y/ > 0 are values that satisfy the general rule for the stochastic
approximation processes
lim 'Y/ =0
/-'00
00
L'Y/ =
00,
(9.33)
/=1
00
L'Y/
2 < 00.
/=1
The procedure (9.32) was also used to solve the regression problem. It
was also shown that if y takes two values, namely zero and one, then for the
pattern recognition case the procedure (9.32) led to estimating the conditional
probability function-that is, estimating the probability that vector x belongs
to the first class.
9.4.2
Radial Basis Function Method
In the middle of the 1980s the interest in approximations using a set of poten-
tial functions (radial basis functions) reappeared. However, this time instead
of the stochastic approximation inference the ERM method for constructing
the approximation was used. In other words, to construct the approximation
in the set of radial basis functions (RBF) one minimizes the empirical risk
functional
R,mp(a) =t ~;-t aj<f>(Ix; - Xjl)) 2
The conditions were found (see Section 10.8.4) under which the matrix A =
Ilaijll with the elements aij = 4> (Ixi - Xj I) is positive definite and therefore the
problem of minimizing (9.34) has a unique solution.
Later the RBF method was modernized where kernels were defined not
at every point of the training data but at some specific points Cj, j = 1, ..., N
(called centers):
(9.35)
Several heuristics (mostly based on nonsupervised learning procedures) for
specifying both the number N of centers and the positions Cj, j = 1, ..., N,
of the centers were suggested. In Chapter 10 we will define these elements
automatically using new learning techiques based on the idea of constructing
a specific (optimal) separating hyperplane in the feature space.

390
9 PERCEPTRONS AND THEIR GENERALIZATIONS
9.5
THREE THEOREMS OF OPTIMIZATION THEORY
Before we continue description of the learning algorithms, let us describe
the main tools of optimization that we will use for constructing learning
algorithms in this and the next chapters.
9.5.1
Fermat's Theorem (1629)
The first general analytical method for solving optimization problems was dis-
covered by Fermat in 1629. He described a method for finding the minimum
or maximum of functions defined in entire space (without constraints):
f(x) ~ extr.
Let us start with the one-dimensional case.
A function f(x) defined on R 1 is called differential at the point x' if there
exists a such that
f(x' + A) = f(x') + aA + r(A),
where r(A) = a ( 1AI); that is, for any small e > 0 there exists 0 > 0 such that
the condition
IAI < {)
implies the inequality
Ir(A)1 < elAI·
The value a is called the differential of f at point x· and is denoted f'(x·).
Therefore
f'(x') = lim f(x' + A) - f(x') = a.
A--.(j
A
Theorem (Fermat). Let f(x) be a function of one variable, dIfferentiable at
point x'. If x* is a point of local extremum, then
f(x*) = o.
The point x* for which (9.36) holds is called the stationary point.
A function f(x)
defined on R fl
is called dIfferentiable at point
(xi, ..., x~) if there exist values a = (aI, ..., an) such that
n
f(x* + h) = f(x*) +L a;h; + r(h),
;=1
where r(h) = o(lhl); that is, for any e > 0 there exists {j > 0 such that
1h I = Jhi + ... + hn < {j,
(9.36)
v* -
-,
-

9.5 THREE THEOREMS OF OPTIMIZATION THEORY
391
which implies
Ir(h)1 ~ eh.
The collection a = (a" ..., an) is called the derivative of the function f(x) at
the point x* and is denoted f'(x*). Note that f'(x*) is a collection of n values.
The value ai
_ I'
f(x* + Ae) - f(x*)
ai -
1m :........:...-----'--------'----'------'-
.\---.0
A
where ei = (0, ...., 1, ....0) is called the ith partial derivative and it is denoted
by /;, (x*) or 8f(x*)/8xi' Therefore f'(x*) =
(f~1 (x*), ... ,f~Jx*)).
Corollary (Fermat's theorem for function of n variables). Let f be a function
of n variables differentiable at point x*. If x* is a point of local extremum of
the function f(x), then
j'(x*) = 0;
that is,
1>:1 (x*) = ... = fxn(x*) = o.
(9.37)
Fermat's theorem shows a way to find the stationary points of functions
(that satisfy the necessary conditions to be a minimum or a maximum point).
To find these points it is necessary to solve a system (9.37) of n equations
with n unknown values x* = (xi, ..., x~).
9.5.2
Lagrange Multipliers Rule (1788)
The next important step in optimization theory was done more than 150 years
later when Lagrange suggested his rule for solving the following so-called
conditional optimization problem: Minimize (or maximize) the function (of
n variables)
fo(x) ---+ min
under constraints of equality type
f,(x) = ... = fm(x) = 0.
(9.38)
(9.39)
Here we consider functions fr(x) , r = 0, 1, ... ,m, that possess some smooth-
ness (differentiability) properties. We assume that in subset X of the space R/l
all functions fr(x), r = 0, 1, '''' m, and their partial derivatives are continuous.
We say that x* E X is a point of local minimum (maximum) in the problem
of minimizing (9.38) under constraint (9.39) if there exists e >°such that
for any x that satisfy conditions (9.39) and constraint
Ix - x*1 < e
the inequality
fo(x) ~ fo(x*)

392
9 PERCEPTRONS AND THEIR GENERALIZATIONS
(or the inequality
fo(x) :::; fo(x*))
holds true.
Consider the function
m
L(x, A, AD) = l.: Akfk(x)
k=O
(9.40)
called the Lagrange function or Lagrangian and also consider the values
Ao, AI, ... , Am called Lagrange multipliers.
Theorem (Lagrange). Let the functions fk(x), k = 0,1, ...,m, be continuous
and differentiable in a vicinity ofpoint x*. Ifx* is the point ofa local extremum,
then one can find Lagrange multipliers A* = (Ar, ...,A:n) and Ao which are not
equal to zero simultaneousely such that the following conditions (the so-called
stationarity conditions)
L' (x* A* A*) = 0
x
,
,
0
hold true. That is,
(9.41)
i = 1,2, ...,n.
(9.42)
To guarantee that Ao 1= 0 it is sufficient that the vectors
f;(x*),
f~(x*), ... ,f:n(x*)
are linearly independent.
(9.43)
(9.44)
Therefore to find the stationary point, one has to solve n + m equations
a~ (t Ak!k(X)) = 0
(n equations, i = 1, ..., n)
I
k=O
fl (x) = ... = fm(x) = 0
(m equations)
with n + m + 1 unknown values. One must take into account, however, that
Lagrange multipliers are defined with accuracy up to a common multiplier.
If Ao 1= 0 (this is the most important case since Ao = 0 means that the goal
functions are not connected with constraints), then one can multiply all co-
efficients of the Lagrange multipliers by a constant to obtain AD = 1. In this
case the number of equations becomes equal to the number of unknowns.
One can rewrite Eqs. (9.44) with Ao = 1 in symmetric form:
L:r(x*, A, 1) = 0,
L~(x*, A, 1) = O.

9.5 THREE THEOREMS OF OPTIMIZATION THEORY
393
The solution to these equations defines the stationary points that contain the
desired point.
9.5.3
Kuhn-Tucker Theorem (1951)
More than 150 years after Lagrange introduced the multipliers method for
solving optimization problems with constraints of equality type, Kuhn and
Tucker suggested a solution to the so-called convex optimization problem,
where one minimizes a certain type of (convex) objective function under
certain (convex) constraints of inequality type.
Let us remind the reader of the concept of convexness.
Definition. The set A belonging to the linear space is called convex if along
with two points x and y from this set it contains the interval
[x,y]={z: z=ax+(l-a)y,
O:Sa:Sl}
that connects these points.
Function f is called convex if for any two points x and y the Jensen in-
equality
f(ax + (1 - a)y) :S af(x) + (1 - a)f(y),
holds true.
Let X be a linear space, let A be a convex subset of this space, and let
fk(X), k = 0, ...,m, be convex functions.
Now consider the following, the so-called convex optimization problem:
Minimize the functional
subject to constraints
fo(x) ~ inf
(9.45)
x E A,
(9.46)
fk(x) :S 0,
k = 1, ..., m.
(9.47)
To solve this problem we consider the Lagrange function (Lagrangian)
m
L = L(x, Ao, A) = L Akfk(x),
k=O
where A = (AI, ..., Am). Note that the Lagrangian does not take into account
the constraint (9.46).
Theorem (Kuhn-Tucker). If x* minimizes function (9.45) under constraints
(9.46) and (9.47), then there exist Lagrange multipliers A(j and A* =
(A~, ..., A:n)
that are simultaneously not equal to zero and such that the following three
conditions hold true:

394
9 PERCEPTRONS AND THEIR GENERALIZATIONS
(a) The minimum principle:
minL(x,A~,A') =
L(x',A~,A').
xEA
(b) The nonnegativeness conditions:
A~ 2: 0,
k = 0, 1, ...,m.
(c) The Kuhn-Tucker conditions:
(9.48)
(9.49)
k = 1, ...,m.
(9.50)
If Au i- 0, then conditions (a), (b), and (c) are sufficient conditions for x'
to be the solution of the optimization problem.
In order for Au i- 0 it is sufficient that there exists i such that the so-called
Slater conditions
hold true.
f(i) < 0,
i = 1, ...,m.
Corollary. If the Slater condition is satisfied, then one can choose Ao = 1 and
rewrite the Lagrangian in the form
m
L(x, 1, A) = fo(x) +L Adk(X).
k=1
Now the Lagrangian defined on m + n variables and conditions of the Kuhn-
Tucker theorem are equivalent to the existence ofa saddle point (x', A') of the
Lagrangian, that is,
minL(x, 1,A') = L(x, I,A') = maxL(x', 1,A)
xEA
A>U
(minimum taken over x E A and maximum taken over A > 0).
Indeed the left equality follows from condition (a) of the Kuhn-Tucker
theorem, and the right equality follows from conditions (c) and (b).
Note that in the Kuhn-Tucker theorem, condition (a) describes the
Lagrange idea: If x' is the solution of the minimization problem under con-
straints (9.46) and (9.47), then it provides the minimum of the Lagrange
function. Conditions (b) and (c) are specific for constraints of the inequality
type.
In the next section we will use Fermat's theorem and the Lagrange mul-
tipliers method to derive the so-called back-propagation method for con-
structing neural nets while in Chapters 10 and 11 we use the Kuhn-Tucker
theorem to derive the so-called support vector method for solving a wide
range of approximation and estimation problems.

9.6 NEURAL NETWORKS
395
9.6
NEURAL NETWORKS
Up to now, to construct a learning machine we used the following general
idea: We (nonlinearly) mapped input vector x in feature space U and then
constructed a linear function into this space. In the next chapters we will
consider a new idea that will make this approach especially attractive.
However, in the remaining part of this chapter we will come back to
the very first idea of the learning machine that was inspired by the neuro-
physiological analogy. We consider the machine defined by a superposition of
several neurons. This structure has n input and one output and is defined by
connections of several neurons each with their own weights. This construc-
tion is called a Multilayer Perceptron or Neural Network. Learning in neural
networks is the same as estimating the coefficients of all neurons. To estimate
these coefficients, one considers the model of neurons where instead of the
threshold function one uses a sigmoid function.
As we demonstrate in Section 9.3 to define the procedure for estimating
the unknown coefficients (weights) for all neurons, it is sufficient to calculate
the gradient of the loss function for the neural networks.
The method for calculating the gradient of loss function for the sigmoid
approximation of neural networks, called the back-propagation method, was
proposed in 1986 (Rumelhart, Hinton, and Williams, 1986; LeCun, 1986).
Using gradients, one can iteratively modify the coefficients (weights) of a
neural net on the basis of standard gradient-based procedures.
9.6.1
The Back-Propagation Method
To describe the back-propagation method we use the following notations
(Fig. 9.2):
1. The neural net contains m + 1 layers connected each to other: The first
layer x(O) describes the input vector x = (Xl, ...,xN ). We denote the
input vector by
Xi = (xl (0), ...xi(O»,
i=I, ...,£,
and we denote the image of the input vector Xi(O) on the kth layer by
xi(k) = (x}(k), ...,x7k (k»,
i=l, ... ,£,
where we denote by nk the dimensionality of the vectors xi(k),
I =
1, ...,f (nk! k = 1, ... ,m -1, can be any number, but nm = 1).
2. The layer k - 1 is connected with the layer k through the (11k x l1k-l )
matrix w(k) as follows:
xi(k) = S{W(k)Xi(k -I)},
k=1,2, ... ,m, i=I, ...,£.
(9.51)

396
9 PERCEPTRONS AND THEIR GENERALIZATIONS
In Eq. (9.51) we use the following notations: Vector S{w(k)x;(k - I)}
is defined by the sigmoid S(u) and the vector
where the sigmoid function transforms the coordinates of the vector:
S(u;(k)) = (S(ul(k)), ...,S(u7k (k))).
The goal is to minimize the functional
l
R(w(1), ... , w(m)) = L)Y; - x;(m))2
;=1
(9.52)
under conditions (9.51).
This optimization problem is solved by using the standard technique of
Lagrange multipliers for equality type constraints. We will minimize the
Lagrange function
L(W,X, B)
f
f
m
=L(y; - x;(m))2 +L L (h;(k) * [x;(k) - S{w(k)x;(k - 1)}]),
;=1
;=1 k=1
w~(2)
FIGURE 9.2. A neural network is a combination of several levels of sigmoid elements.
The outputs of one layer form the input for the next layer.

9.6 NEURAL NETWORKS
397
where bi(k) are Lagrange multipliers corresponding to the constraints (9.51)
that describe the connections between vectors xi(k - 1) and vectors xi(k).
The equality
\7L(W,X,B) = 0
is a necessary condition for a local minimum of the performance function
(9.52) under the constraints (9.51) (the gradient with respect to all parameters
from bi(k), xi(k), w(k), i = 1, ...,f, k = 1, ..., m, is equal to zero).
This condition can be split into three subconditions:
1.
8L(W,X,B) =0,
Vi, k.
8bi (k)
2.
8L(W,X,B) =0,
Vi, k.
8Xi(k)
3.
8L(W,X,B) =0
V w(k).
8w(k)
The solution of these equations determines a stationary point (Wo, Xo,Bo)
that includes the desired matrices of weights Wo = (wO(I), ..., wO(m)). Let us
rewrite these three subconditions in explicit form:
1. The First Subcondition. The first subcondition gives a set of equations
i=I, ... ,£, k=I, ... ,m
with initial conditions
Xi(O) = Xi,
the equation of the so-called forward dynamics. It iteratively defines
images of the input vectors Xi(O) for all levels k = 1, ...,m of the neural
net.
2. The Second Subcondition. We consider the second subconditions for two
cases: for the case k = m (for the last layer) and for the case k =I- m (for
hidden layers).
For the last layer we obtain
bi(m) = 2(yi - xi(m»,
i=I, ... ,£.
For the general case (hidden layers) we obtain
bi(k) = wT(k + 1)\75 {w(k + l)xi(k)} bi(k + 1),
i=I, ... ,£,
k=I, ... ,m-l,
where \75 {w(k + l)xi(k)} is a diagonal nk+l x nk+l matrix with diagonal
elements 5'(ur ), where ur is the rth coordinate of the (nk+l-dimensional)
vector u = w(k + 1)xi(k). This equation describes the backward dynam-
ics. It iteratively defines Lagrange multipliers bi(k) for all k = m, ... , 1
and all i = 1, ... ,£.

398
9 PERCEPTRONS AND THEIR GENERALIZATIONS
3. The Third Subcondition. Unfortunately the third subcondition does not
give a direct method for computing the matrices of weights w(k), k =
1, ...,m. Therefore to estimate the weights, one uses steepest gradient
descent:
(k)~
(k)-
8L(W,X,B)
w
w
'Yt
8w(k)
,
k = 1, ... ,m,
where 'YI is a value of step for iteration t. In explicit form, this equation
IS
f
w(k) ~ w(k) + 'YI LV'S {W(k)Xi(k - I)} bi(k)xr (k - 1),
i=!
k=I,2, ... ,m.
This equation describes the rule for iterative weight updating.
9.6.2
The Back-Propagation Algorithm
Therefore the back-propagation algorithm contains three elements:
1. Forward Pass:
i=I, ... ,£, k=I, ... ,m
with the boundary conditions
2. Backward Pass:
i=I, ... £.
i=l, ... ,£,
with the boundary conditions
k=l, ... ,m-l
i=1, ... ,£.
3. Weight Update for Weight Matrices w(k), k = 1,2, ... ,m :
f
w(k) ~ w(k) + 'YI LV'S {W(k)Xi(k - I)} bi(k)xr (k - 1),
Using the back-propagation technique one can achieve a local minimum for
the empirical risk functional.

9.6 NEURAL NETWORKS
399
9.6.3
Neural Networks for the Regression Estimation Problem
To adapt neural networks for solving the regression estimation problem, it is
sufficient to use in the last layer a linear function instead of a sigmoid one.
This implies only the following changes in the above equations:
x;(m) = w(m)Xj(m - 1),
i = 1, ... , £,
\7S{w(m)Xj(m -I)} = 1.
9.6.4
Remarks on the Back-Propagation Method
The main problems with the neural net approach are as follows:
1. The empirical risk functional has many local minima. Standard opti-
mization procedures guarantee convergence to one of them. The qual-
ity of the obtained solution depends on many factors, in particular on
the initialization of weight matrices w(k), k = 1, ..., m. The choice of
initialization parameters to achieve a "small" local minimum is based
on heuristics.
2. The convergence of the gradient based method is rather slow. There
are several heuristics to speed up the rate of convergence.
3. The sigmoid function has a scaling factor that affects the quality of the
approximation. The choice of the scaling factor is a trade-off between
the quality of approximation and the rate of convergence. There are
empirical recommendations for choosing the scaling factor.
Therefore neural networks are not well-controlled learning machines. Never-
theless, in many practical applications, neural networks demonstrate good
results.


10
THE SUPPORT VECTOR
METHOD FOR ESTIMATING
INDICATOR FUNCTIONS
Chapter 9 showed that methods of separating hyperplanes play an important
role in constructing learning algorithms. These methods were the foundation
of classical learning algorithms.
This chapter considers a special type of separating hyperplanes, the so-
called optimal hyperplanes, that possess some remarkable statistical proper-
ties. Using the method of the optimal separating hyperplane we construct
a new class of learning machines for estimating indicator functions, the so-
called support vector machines, which we will generalize in the next chap-
ter for estimating real-valued functions, signal processing, and solving linear
operator equations.
10.1
THE OPTIMAL HYPERPLANE
We say that two finite subsets of vectors x from the training set
x E Rn ,
y E {-1, 1},
one subset I for which y = 1, and another subset II for which y = -1 are
separable by the hyperplane
if there exist both a unit vector cP (I cPI = 1) and a constant c such that the
inequalities
(Xi * cP) > c,
(Xj * cP) < c,
if Xi E I,
if Xj Ell
(10.1 )
401

402
10 THE SUPPORT VECTOR METHOD
hold true where we denoted by (a * b) the inner product between vectors a
and b.
Let us determine for any unit vector 4> two values
= min(xi * 4> ),
.t,El
= max(xj * 4».
xIEf(
Consider the unit vector 4>0 which maximizes the function
/4>/ = 1
(10.2)
under the condition that inequalities (10.1) are satisfied. The vector 4>0 and
the constant
CI (4)0) + Cz (4)0)
Co = -'--'--2-'---
determine the hyperplane that separates vectors XI, ..• , Xa of the subset I from
vectors XI, ... , Xb of the subset II, (a + b = £) and has the maximal margin
(10.2). We call this hyperplane the maximal margin hyperplane or the optimal
hyperplane (Fig. 10.1).
Theorem 10.1. The optimal hyperplane is unique.
Proof We need to show that the maximum point 4>0 of the continuous func-
tion p(4»
defined in the area /4> I :s: 1 exists and is achieved on the boundary
\4> \ = 1. Existence of the maximum follows from the continuity of p( 4»
in
the bounded region /4>Is: 1.
FIGURE 10.1. The optimal separatlng hyperplane is the one that separates the data
with the maximal margin.

10.1 THE OPTIMAL HYPERPLANE
403
Suppose that the maximum is achieved at some interior point eP *. Then
the vector
would define a larger margin
(A.*) = p(cPo)
P 'I-'
IcPoI .
The maximum of the function p(eP) cannot be achieved on two (boundary)
points. Otherwise, since function p(eP) is convex, it is achieved on the line
that connects these two points-that is, at an inner point which is impossible
by preceding arguments. This proves the theorem.
Our goal is to find effective methods for constructing the optimal hyper-
plane. To do so we consider an equivalent statement of the problem: Find
a pair consisting of a vector r/Jo and a constant (threshold) bo such that they
satisfy the constraints
(Xi * r/Jo) + bo ~ 1,
(x j * t/Jo) + bo :s: -1,
and the vector r/Jo has the smallest norm
if Yi = 1,
if Yj = -1,
(10.3)
(l0.4)
Theorem 10.2. Vector r/Jo that minimizes (10.4) under constraints (10.3) is re-
lated to the vector that forms the optimal hyperplane by the equality
r/Jo
cPo =~.
(10.5)
The margin Po between the optimal hyperplane and separated vectors is equal
to
1 (
.
)
1
p(cPo) = sup -2
mm(xi * cPo) - ~ax(xi * cPo)
= -I-I'
<fill
!EI
JEll
r/Jo
(10.6)
Proof Indeed, the vector r/Jo that provides the minimum of the quadratic
function (10.4) under the linear constraints (10.3) is unique, Let us define the
unit vector
r/Jo
cPo =~.
Since constraints (10.3) are valid, we find

404
10 THE SUPPORT VECTOR METHOD
To prove the theorem it is sufficient to show that the inequality
is impossible. Suppose it holds true. Then there exists a unit vector 4> * such
that the inequality
p(4)*) > I~I
holds true. Let us construct the new vector
*
4>*
l/J
= p(4)*) ,
which has norm smaller than Il/Jol. One can check that this vector satisfies the
constraints (10.3) with
b = _ C1 ( 4>) + Cz ( 4> ).
2
This contradicts the assertion that l/Jo is the smallest vector satisfying the
constraints (10.3). This proves the theorem.
Thus the vector l/Jo with the smallest norm satisfying constraints (10.3) de-
fines the optimal hyperplane. The vector l/Jo with the smallest norm satisfying
constraints (10.3) with b = 0 defines the optimal hyperplane passing through
the origin.
To simplify our notation let us rewrite the constraint (10.3) in the equiva-
lent form
Yi «Xi * l/Jo) + b) ~ 1,
i = 1, ... , £.
(10.7)
Therefore in order to find the optimal hyperplane one has to solve the follow-
ing quadratic optimization problem: to minimize the quadratic form (10.4)
subject to the linear constraints (10.7).
One can solve this problem in the primal space~the space of parameters l/J
and b. However, the deeper results can be obtained by solving this quadratic
optimization problem in the dual space-the space of Lagrange multilpiers.
Below we consider this type of solution.
As it was shown in Section 9.5, in order to solve this quadratic optimization
problem one has to find the saddle point of the Lagrange function
1
{
L (l/J ,b, a) = 2. (l/J * l/J) - LadYd(xi * l/J) + bJ - 1) ,
;=1
(10.8)
where ai ~ 0 are the Lagrange multipliers. To find the saddle point one has to
minimize this function over l/J and b and to maximize it over the nonnegative
Lagrange multipliers aj ~ O.

10.1 THE OPl"IMAL HYPERPLANE
405
According to the Fermat theorem, the minimum points of this functional
have to satisfy the conditions
p
8L(t/J,b,a) _
'"
-0
a
-
t/J - L..J Yiaix; -
,
t/J
i=1
f
8L(t/J,b,a) = "'Yiai =0.
ab
L..J
;=1
From these conditions it follows that for the vector t/J that defines the optimal
hyperplane, the equalities
f
t/J = LYia;X;,
i=1
f
LYia; =0
i=1
(10.9)
(10.10)
hold true. Substituting (10.9) into (10.8) and taking into account (10.10), one
obtains
f
1
f
W(a) = '" a· - - "'y·y·a·a·(x *x·)
L..JI
2L..J')1)
I
).
i=1
i,j=1
(10.11)
Note that we have changed the notation from L(t/J, b, a) to W(a) to reflect
the last transformation. Now to construct the optimal hyperplane one has to
find the coefficients a? that maximize the function (10.11) in the nonnegative
quadrant
ai ~ 0,
i = 1...,f,
(10.12)
under the constraint (10.10). Using these coefficients ap, i = 1, ..., f, in Eq.
(10.9), one obtains the solution
f
t/Jo = LYiapxi.
i=1
The value of bo is chosen to maximize margin 10.2. Note that the optimal
solution t/Jo and bo must satisfy the Kuhn-Tucker conditions (see Chapter 9,
Section 9.5)
ap (Yi((Xi * t/Jo) + bo) - 1) = 0,
i = 1, ..., f.
(10.13)

406
10 THE SUPPORT VECTOR METHOD
From conditions (10.13) one concludes that nonzero values a? correspond
only to the vectors Xi that satisfy the equality
(10.14)
Geometrically, these vectors are the closest to the optimal hyperplane (see
Fig 10.1). We will call them support vectors. The support vectors playa crucial
role in constructing a new type of learning algorithm since the vector I./J<) that
defines the optimal hyperplane is expanded with nonzero weights on support
vectors:
f
I/Jo = LYja?xj.
j=!
Therefore the optimal hyperplane has the form
f
f(x, au) = LYja~)(xs * x) + bo,
;=1
(10.15)
where (xs *x) is the inner product of the two vectors.
Note that both the separation hyperplane (10.15) and the objective func-
tion of our optimization problem
(10.16)
do not depend explicitly on the dimensionality of the vector x but depend
only on the inner product of two vectors. This fact will allow us later to
construct separating hyperplanes in high-dimensional spaces even (in infinite-
dimensional Hilbert spaces).
We now formulate some properties of the optimal hyperplane that are
used later.
1. The optimal hyperplane is unique; that is, the pair of vector I/Jo and
threshold bu that define the optimal hyperplane is unique. However,
the expansion of the vector I/Jo on the support vectors is not unique.
2. Let the vector I/Jo define the optimal hyperplane. Then the maximum
of the functional W (a) is equal to

10.1 THE OP1'IMAl HYPERPLANE
407
To show this, it is sufficient to transform functional (10.11), taking into
account that for optimal pairs I/Jo and bo the equality (10.10) and equal-
ities (10.13) hold true. This implies
3. The norm of the vector I/Jo defines the margin of the optimal separating
hyperplane
1
p(l/Jo) = ~.
4. From properties 2 and 3 it follows that
1 (
1 )2
W(a) < W(ao) = 2
p(l/Jo)
,
This expression can be chosen as a criterion of linear nonseparability
of two sets of data.
Definition. We call two sets of data linearly 8-nonseparable if the mar-
gin between the hyperplane and the closest vector is less than 8.
Therefore, if during the maximization procedure the value W (a)
exceeds the value 1/282, one can assert that the two sets of separating
data are 8-nonseparable.
Thus, in order to construct the optimal hyperplane, one has either
to find the maximum of the nonnegative quadratic form W(a) in the
nonnegative quadrant under the constraint (10.10) or to establish that
the maximum exceeds the value
1
Wmax = 282 '
In the latter case, separation with the margin 8 is impossible.
5. In order to maximize the functional W(a) under the constraints (10.10)
and (10.12), one needs to specify the support vectors and to determine
the corresponding coefficients. This can be done sequentially, using a
small amount of training data every time. One can start the optimization
process using only n examples (maximizing W(a) under the condition
that only n parameters differ from zero). As the conditional maximum
W (a) is achieved, one can keep the parameters that differ from zero
and add new parameters (corresponding to the vectors that were not
separated correctly by the first iteration of constructing the optimal
hyperplane). One continues this process until either:

408
10 THE SUPPORT VECTOR METHOD
(a) all the vectors of the training set are separated, or
(b) at some step W(a) > Wmax (the separation is impossible).
The methods described above work in some sense like a sieve: At any
step it maximizes the functional W (a) using only the elements of the
training set which are the candidates for support vectors.
10.2
THE OPTIMAL HYPERPLANE FOR NONSEPARABLE SETS
10.2.1
The Hard Margin Generalization of the Optimal
Hyperplane
In this section we generalize the concept of the optimal hyperplane for the
nonseparable case.
Let the set of training set
x E X, Y E {-1,1},
be such that it cannot be separated without error by a hyperplane. According
to our definition of nonseparability (see Section 10.1), this means that there
is no pair t/J, b such that
and the inequalities
Yi((Xi * t/J) + b) ~ 1,
i = 1,2, ...£
(10.17)
hold true.
Our goal is to construct the hyperplane that makes the smallest number of
errors. To get a formal setting of this problem we introduce the nonnegative
variables
gl, ...,gi'
In terms of these variables the problem of finding the hyperplane that
provides the minimal number of training errors has the following formal
expression: Minimize the functional
f
<I>(g) = L 8 (g;)
i=1
subject to the constraints
Yi((Xi * t/J) +b) ~ 1- gi,
i = 1,2, ...£,
gi ~ 0
(10.18)

10.2 THE OPTIMAL HYPERPLANE FOR NONSEPARABLE SETS
409
and the constraint
(10.19)
where () (~) = 0 if ~ = 0 and () (~) = 1 if ~ > O. It is known that for the nonsep-
arable case this optimization problem is NP-complete. Therefore we consider
the following approximation to this problem: We would like to minimize the
functional
l
<I>(~) = L ~r
i=l
under the constraints (10.18) and (10.19), where (j ~ 0 is a small value. We
will, however, choose (j = 1, the smallest (j that leads to a simple optimization
problem.t
Thus, we will minimize the functional
f
<1>( t/J , b) =z= ~i
i=1
subject to the constraints (10.18) and (10.19). We call the hyperplane
(t/Jo*x)+b=O
(10.20)
constructed on the basis of the solution of this optimization problem the
generalized optimal hyperplane or, for simplicity, the optimal hyperplane.
To solve this optimization problem we find the saddle point of the
Lagrangian
L(t/J, b, a, f3, Y)
l
l
- L ai(Yi((t/J *Xi) + b) - 1 + ~d - L
f3i~i
(10.21)
i=l
i=1
(the minimum with respect to t/J, b,
~i and the maximum with respect to non-
negative multipliers ai, f3i, y). The parameters that minimize the Lagrangian
t The choice (T = 2 also leads to a simple optimization problem. However, for the pattern recog-
nition problem this choice does not look attractive. It will be more attractive when we will
generalize results obtained for the pattern recognition problem to estimation of real-valued
functions (Chapter 11, Section 11.3).

410
10 THE SUPPORT VECTOR METHOD
must satisfy the conditions
8L(tfJ, b,~, a, {3, y)
8tfJ
8L(tfJ,b,~a,{3, y)
8b
8L(tfJ, b, ~a, {3, y)
8~j
From these conditions one derives
f
ytfJ - L
ajYiXj = 0,
j=!
f
- LYjaj =0,
i=!
1 -
aj -
{3i = O.
1
f
tfJ = - L
ajYjXj,
y
j=!
f
LaiYi = 0,
j=!
(10.22)
(10.23)
Substituting (10.22) into the Lagrangian and taking into account (10.23), we
obtain the functional
which one has to maximize under the constraints
f
LYjaj =0,
j=!
0:::; ai :::; 1,
y ~ O.
(10.24)
One can maximize (10.24) under these constraints by solving a quadratic op-
timization problem several times for fixed values of y and conducting maxi-
mization with respect to y by a line search. One can also find the parameter y
that maximizes (10.24) and substitute it back into (10.24). It is easy to check
that the maximum of (10.24) is achieved when

10.2 THE OPTIMAL HYPERPLANE FOR NONSEPARABLE SETS
411
Putting this expression back into (10.24), one obtains that to find the desired
hyperplane one has to maximize the functional
f
W(a) = La,-A
/=1
subject to constraints
fL
a/ajY/YJ(X/ * Xj)
i,j=1
(10.25)
f
Ly,a, = 0,
i=1
o ~ ai ~ 1.
(10.26)
The vector of parameters ao = (ar, ..., af) defines the generalized optimal
hyperplane
The value of the threshold b is chosen to satisfy the Kuhn-Tucker condition
1=1, ...,£.
10.2.2
The Basic Solution. Soft Margin Generalization
To simplify computations, one can introduce the following (slightly modi-
fied) concept of the generalized optimal hyperplane. The generalized optimal
hyperplane is determined by the vector ljJ that minimizes the functional
(10.27)
subject to the constraints (lU.17) (here C is a given value).
Using the same technique with the Lagrangian, one obtains the method
for solution of this optimization problem that is almost equivalent to the
method of solution of the optimization problem for the separable case: To
find the vector ljJ of the generalized optimal hyperplane
f
ljJ = L aiY/x/,
i=1

412
10 THE SUPPORT VECTOR METHOD
one has to maximize the same quadratic form as in the separable case
f
1
f
W(a) = L
ai - 2 LYiYjaiaj(xi * Xj)
i=1
i,j=1
under slightly different constraints:
(10.28)
f
LaiYi =0.
i=1
o ~ ai ~ C,
i = 1, ...,f,
(10.29)
As in the separable case, only some of the coefficients a?, i = 1, ..., f, dif-
fer from zero. They and the corresponding support vectors determine the
generalized optimal separating hyperplane
f
L
a?Yi(Xj *x) + bo = O.
i=1
(10.30)
Note that if the coefficient C in the functional (10.27) is equal to the
optimal value of parameter 'Yo for maximization of the functional (10.24)
C =
')'0,
then the solutions of both optimization problems coincide.
10.3
STATISTICAL PROPERTIES OF THE OPTIMAL HYPERPLANE
This section discusses some statistical properties of the optimal hyperplane.
In particular, we discuss theorems showing that the bounds on generalization
ability of the optimal hyperplane are better than the general bounds obtained
for method minimizing the empirical risk.
Let X* = (Xl, ...,Xf) be a set of f vectors in Rn. For any hyperplane
in Rn consider the corresponding canonical hyperplane defined by the set X*
as follows:
in! I(x * 1/1) +bl = 1,
xEX'
where 1/1 = c*l/I* and b = c*b*. Note that the set of canonical hyperplanes
coincides with the set of separating hyperplanes. It only specifies the normal-
ization with respect to given set of data X*.
First let us establish the following important fact.

10.3 STATISTICALPROPERTIES OF THE OPTIMAL HYPERPLANE
413
Theorem 10.3. A subset of canonical hyperplane defined on X* c Rn
satisfying the constraint
'xl S; D,
x E X*
'l/J' S; A
has the VC dimension h bounded as follows:
h::; min ([D 2A2],n) + 1,
where [a] denotes the integer part of a.
Note that the norm of the vector coefficients of the canonical hyperplane
l/J defines the margin
1
1
=
'l/J'
A
(see Section 10.1).
Therefore when [D2A2] < n the VC dimension is bounded by the same
construction D2/ p2 that in Theorem 9.1 defines the number of corrections
made by the Perceptron. This time the construction D 2/ p2 is used to bound
the VC dimension of the set of hyperplanes with margin not less than p
defined on the set of vectors X*.
To formulate the next theorems we introduce one more concept. The last
section mentioned that the minimal norm vector l/J satisfying the conditions
(10.7) is unique, though it can have different expansions on the support vec-
tors.
Definition 2. We define the support vectors Xi that appear in all possible
expansions of the vector l/Jo the essential support vectors. In other words,
the essential support vectors comprise the intersection of all possible sets of
support vectors. Let
(Xl,yJ), ''', (xt,yd
be the training set. We denote the number of essential support vectors of this
training set by
Kt = K((Xl,Yt), ..., (Xt,yt}).
We also denote the maximum norm of the vector x from a set of essential
support vectors of this training set by
Let n be the dimensionality of the vectors x.
The following four theorems describe the main statistical properties of the
optimal hyperplanes.

414
10 THE SUPPORT VECTOR METHOD
Theorem 10.4. The inequality
(10.31)
holds true.
Theorem 10.5. Let
be the expectation of the probability of error for optimal hyperplanes con-
structed on the basis of training samples of size £ (the expectation taken over
hoth training and test data). Then the following inequality
ER(a ) < EICf+1
f
-
£ + 1
(10.32)
holds true.
Corollary. From Theorems 10.4 and 10.5 it follows that
n
E R(af) ~ £ + 1.
Theorem 10.6. For optimal hyperplanes passing through the origin the fol-
lowing inequality
E(Vf +J )2
ER(a ) <
Pf+l
(10.33)
f
-
£ + 1
holds true, where V f+1 and Pf+l are (random) values that for a given training
set of size £ + 1 define the maximal norm of support vectors x and the margin.
Remark. In Section 9.1, while analyzing the Perceptron's algorithm, we dis-
cussed the Novikoff theorem which bounds the number M of error correc-
tions that the Perceptron makes in order to construct a separating hyperplane.
The bound is
(10.34)
Emin{[Dl+1 ] ,K}
ER(Wf) ~
Pf+1
£+1
where D f is the bound on the norm of vectors on which the correction was
made and Pf is the maximal possible margin between the separating hyper-
plane and the closest vector to the hyperplane.
In Section 10.4.4 along with Theorem 10.5, we prove Theorem 9.3 which
states that after separating training data (may be using them several times)
the Perceptron constructs a separate hyperplane whose error has the follow-
ing bound

10.4 PROOFS OF THE THEOREMS
415
where K is the number of correction made by the Perceptron. Compare this
bound with the bound obtained in Theorem 10.6 for the optimal separating
hyperplane. The bounds have the same structure and the same value P1 of
the margin. The only difference is that the V; (the bound on the norm for
support vectors) in Theorem 10.6 for optimal separating hyperplanes is used
instead of D p (the bound on the norm for correcting vectors) in (10.34) for
the Perceptron's hyperplanes.
In these bounds the advantage of comparing optimal hyperplanes to Per-
ceptron's hyperplanes is expressed through the geometry of support vectors.
Theorem 10.7. For the optimal hyperplane passing through the origin the
inequality
Emin
is valid.
10.4
PROOFS OF THE THEOREMS
10.4.1
Proof of Theorem 10.3
To estimate the VC dimension of the canonical hyperplane, one has to esti-
mate the maximal number r of vectors that can be separated in all 2' possible
ways by hyperplanes with the margin p. This bound was obtained in Theorem
8.4. Therefore the proof of this theorem coincides with the proof of Theorem
8.4 given in Chapter 8, Section 8.5.
10.4.2
Proof of Theorem 10.4
Let us show that the number of essential support vectors does not exceed the
dimensionality n of the space X. To prove this we show that if an expansion of
the optimal hyperplane has a > n support vectors (with nonzero coefficients),
then there exists another expansion that contains less support vectors.
Indeed, suppose that the optimal hyperplane is expanded as follows:
a
l/J = L UjXiYi,
i=1
(10.35)
where a > n. Since any system of vectors that contains a > n different ele-
ments is linearly dependent, there exist parameters 'Yi such that
aL
'YiXiYi = 0,
i=1
where at least one 'Yi is positive.

416
laTHE SUPPORT VECTOR METHOD
Therefore the expression
a
I/J = 2:)ai - t'}'i)XiYi
i=1
(10.36)
determines a family of expansions of the optimal hyperplanes depending on
t. Since all ai are positive, all the coefficients remain positive for sufficiently
small t. On the other hand, since among the coefficients '}'i some are positive,
for sufficiently large t > 0, some coefficients become negative. Therefore one
can find such minimal t = to for which one or several coefficients become zero
for the first time while the rest of the coefficients remain positive. Taking the
value of t = to, one can find an expansion with a reduced number of support
vectors.
Utilizing this construction several times, one can obtain an expansion of
the optimal hyperplane which is based on at most n vectors.
10.4.3
Leave-One-Out Procedure
The proofs of the next two theorems are based on the so-called leave-one-out
estimation procedure. Below we use this procedure as a tool for proving our
theorems, although this procedure is usually used for evaluating the proba-
bility of test error of the function obtained by the empirical risk minimization
method.
Let Q(z, at) be the function that minimizes the empirical risk
on a given sequence
1
f
Remp(a) = i L Q(Zi, a)
i=l
ZI, .. " Zp.
(10.37)
(10.38)
Let us estimate the risk for the function Q(z, al) using the following statis-
tics, Exclude the first vector z1 from the sequence and obtain the function
that minimizes the empirical risk for the remaining £ - 1 elements of the
sequence.
Let this function be Q(z, af-llzd. In this notation we indicate that the
vector Zl was excluded from the sequence (10.38). We use this excluded
vector for computing the value
Next we exclude the second vector Zz from the sequence (the first vector is
retained) and eompute the value
Q(Zz, at-Ilzz).

10.4 PROOFS OF THE THEOREMS
417
In this manner, we compute the values for all vectors and calculate the num-
ber of errors in the leave-one-out procedure:
£
L:(Zl, "', z£) = L
Q(Zi, af-llzi).
i=l
We use L:(ZI' ... , Zf) as an estimate for the expectation of the function Q(z, af)
that minimizes the empirical risk (10.37):
R(af) = /
Q(z, ad dP(z).
The estimator C(Zl, ..., Zf) of the expectation is called the leave-one-out esti-
mator.
The following theorem is valid.
Tbeorem 10.8 (Luntz and Brailovsky). The leave-one-out estimator is almost
unbiased; that is,
E C(Zl, ''', zf+d = ER(
)
£ + 1
af .
Proof. The proof consists of the following chain of transformations:
EL:(Zl' .,', zf+d
£+1
The theorem is proved.
I
1
l+l
£ + 1 L
Q(Zi, allzi) dP(Zl) ... dP(Zf+d
i=l
/
£ ~ 1 ~ (/ Q(Zi, af IZi) dP(Z;))
1=1
dP(zd··· dP(Zi-l)dP(Zi+d··· dP(Zf)
1
£+1
E f + 1 LR(a£lzi) = ER(cxf)'
i=l
10.4.4
Proof of Theorem 10.5 and Theorem 9.2
Proofof Theorem JO.5. To prove this theorem we show that the number of
errors by the leave-one-out method does not exceed the number of essential
support vectors.
Indeed if the vector Xi is not an essential support vector, then there exists
an expansion of the vector r/Jo that defines the optimal hyperplane that does
not contain the vector Xi.

418
10 THE SUPPORT VECTOR METHOD
Since the optimal hyperplane is unique, removing this vector from the
training set does not change it. Therefore in the leave-one-out method it will
be recognized correctly.
Thus the leave-one-out method recognizes correctly all the vectors that
do not belong to the set of essential support vectors. Therefore the number
L:(ZI, ..., zf+d of errors in the leave-one-out method does not exceed Kf + 1 the
number of essential support vectors; that is,
(to.39)
To prove the theorem we use the result of Theorem 10.8, where we take into
account the inequality (10.39):
The theorem has been proved.
Proof of Theorem 9.2. To prove Theorem 9.2, note that since the number
of errors in the leave-one-out procedure does not exceed the number of
corrections M that makes a perceptron, the bound in Theorem 9.2 follows
from the bound for M (given by Novikoff theorem) and Theorem to.8.
10.4.5
Proof of Theorem 10.6
To prove this theorem we use another way to bound the number of errors
of the leave-one-out estimator for the optimal hyperplanes.
Suppose we are given the training set
and the maximum of W(a) in the area a 2': 0 is achieved at the vector aD =
(a:), ..., (7). Let the vector
II
I/Jo = L a?x;y;
;=1
define the optimal hyperplane passing through the origin, where we enumer-
ate the support vectors with i = 1, ...,a.
Let us denote by a P the vector providing the maximum for the functional
W(a) under constraints
ap =0,
ai 2': 0
U#p)·
(10.40)

10.4 PROOFS OF THE THEOREMS
419
Let the vector
a
l{1p = L afXiYi
i ==1
define the coefficients of the corresponding separating hyperplane passing
through the origin.
Now denote by wg the value of functional W(a) for
ai = a?
(i -=/: p),
ap =0.
(10.41)
Consider the vector aP that maximizes the function W (a) under the con-
straints (10.39). The following obvious inequality is valid:
On the other hand the following inequality is true:
Therefore the inequality
(10.42)
is valid.
Now let us rewrite the right-hand side of the inequality (10.42) in the
explicit form
a
1
L a? - 2: (r/Jo * r/Jo)
i=!
- (~a? - a~ - ~ ((</10 - a~ypxp) * (</10 - a~ypxp»))
a~ - a~yp(xp * 1/10) + ~(a~)2IxpI2.
Taking into account that xp is a support vector, we have
(10.43)
Suppose the optimal hyperplane passing through the origin recognizes the
vector xp incorrectly. This means that the inequality
(10.44)

420
10 THE SUPPORT VECTOR METHOD
is valid. Note that as was shown in the proof of Theorem 10.5, this is possible
only if the vector x p is an essential support vector. Now let us investigate the
left-hand side of the inequality (10.42). Let us fix all parameters except one;
we fix ai, i =F p, and let us make one step in maximization of the function
W (a) by changing only one parameter ap > O. We obtain
From this equality we obtain the best value of ap :
Increment of the function W(a) at this step equals
Since dWp does not exceed the increment of the function W(a) for complete
maximization, we obtain
(10.45)
Combining (10.45), (10.43), and (10.27), we obtain
From this inequality, taking into account (10.44), we obtain
Taking into account that IXpl ~ Vi+l, we obtain
(10.46)
Thus if lhe optimal hyperplane makes an error classifying vector xp in the
leave-one-out procedure, then the inequality (10.45) holds. Therefore
~a9 > £'/+1
~
1- V2
'
i=l
/+1
(10.47)

10.5 THE IDEA OF THE SUPPORT VECTOR MACHINE
421
where L£+1 = L((Xt,Y1), ..., (Xt+hYf+d) is the number of errors in the leave-
one-out procedure on the sample (x1,yd, ..., (Xt+1,Yt+d.
Now let us recall the properties of the optimal hyperplane (see Section
10.1)
a
and
(r/Jo * r/Jo) = La?
i=1
1
(1/10 * 1/10) = -2-'
Pt+1
(10.48)
Combining (10.46) and (10.47) with the last equation we conclude that the
inequality
(10.49)
is true with probability 1.
To prove the theorem, it remains to utilize the results of Theorem 10.8:
The theorem has been proved.
10.4.6
Proof of Theorem 10.7
To prove the theorem it is sufficient to note that since inequalities (10.39)
and (10.49) are valid, the inequality
holds true with probability 1. Taking the expectation of both sides of the
inequality, we prove the theorem.
10.5
THE IDEA OF THE SUPPORT VECTOR MACHINE
Now let us define the support vector machine. The support vector (SV)
machine implements the following idea: It maps the input vectors x into
the high-dimensional feature space Z through some nonlinear mapping, cho-
sen a priori. In this space, an optimal separating hyperplane is constructed
(Fig. 10.2).

422
10 THE SUPPORT VECTOR METHOD
Optimal hyperplane in the feature space
Feature space
a
a
a
a
a
a
a
a
a
0
a
0
1---:
0
0
a
a =;; IInput space
FIGURE 10.2. The SV machine maps the input space into a high-dimensional feature
space and then constructs an optimal hyperplane in the feature space.
Example. To construct a decision surface corresponding to a polynomial of
n(n + 3)
degree two, one can create a feature space Z that has N =
2
coordi-
nates of the form
I
I
II
II
Z = X , ...,z = X
ZIl+1 = (x l )2, ... , Z2fl = (xfl )2
(n coordinates),
(n coordinates),
( n(n 2- 1) coordinates) ,
where x = (x I, ... , XII). The separating hyperplane constructed in this space is
a second-degree polynomial in the input space.
Two problems arise in the above approach: a conceptual and a technical
one.
1. How to find a separating hyperplane that generalizes well (the concep-
tual problem). The dimensionality of the feature space is huge. and a
hyperplane that separates the training data does not necessarily gener-
alize well.
2. How to treat such high-dimensional spaces computationally (the tech-
nical problem). To construct a polynomial of degree 4 or 5 in a 200-
dimensional space it is necessary to construct hyperplanes in a billion-
dimensional feature space. How can this "curse of dimensionality" be
overcome?
10.5.1
Generalization In High-Dimensional Space
The conceptual part of this problem can be solved by constructing the optimal
hyperplane.

10.5 THE IDEA OF THE SUPPORT VECTOR MACHINE
423
According to the theorems described in Section 10.3, if one can construct
separating hyperplanes with a small expectation of (DI+1/ pp+ll or with a
small expectation of the number of support vectors, the generalization ability
of the constructed hyperplanes is high, even if the feature space has a high
dimensionality.
10.5.2
Mercer Theorem
However, even if the optimal hyperplane generalizes well and can theoreti-
cally be found, the technical problem of how to treat the high-dimensional
feature space remains.
Note, however, that for constructing the optimal separating hyperplane
in the feature space Z, one does not need to consider the feature space in
explicit form. One only has to calculate the inner products between support
vectors and the vectors of the feature space (see, for example, (10.28) and
(10.30)).
Consider a general property of the inner product in a Hilbert space. Sup-
pose one maps the vector x E Rn into a Hilbert space with coordinates
ZI(X), ..., Zn(x), ....
According to the Hilbert-Schmidt theory the inner product in a Hilbert space
has an equivalent representation:
x
(ZI * zz) = 2..:: a,z,(xt}z(xz) -¢=:? K(xl,xz),
'=01
a, 2:: 0,
(10.50)
where K(XI, xz) is a symmetric function satisfying the following conditions.
Theorem (Mercer). To guarantee that a continuous symmetric function
K(u, u) in L 2(C) has an expansiont
00
K(u,u) = LakZk(U)Zk(U)
k=1
(10.51 )
with positive coefficients ak > 0 (i.e., K(u, u) describes an inner product in
some feature space), it is necessary and sufficient that the condition
ii K(u,u)g(u)g(u)dudu ~ 0
be valid for all g E L 2(C) (C being a compact subset of R").
t This means that the right-hand side of Eq. (10.50) converges to function K(u. v) absolutely and
uniformly.

(10.52)
424
10 THE SUPPORT VECTOR METHOD
The remarkable property of the structure of the inner product in Hilbert
space that leads to construction of the SV machine is that for any kernel
function K(ll, v) satisfying Mercer's condition there exists a feature space
(ZI (ll), ... , Zk(ll), . ..) where this function generates the inner product (to.51).
10.5.3
Constructing SV Machines
Generating the inner product in a (high-dimensional) feature space allows
the construction of decision functions that are nonlinear in the input space
f(x, a) = sign (
L
yjapK(x,xj) +b)
support vectors
and are equivalent to linear decision functions in the feature space ZI (x), "',
Zk(X)""
f(x,a) = sign (
L
y;apfZr(Xj)Zr(X) + b)
support vectors
r= 1
(K(x,Xj) is the kernel that generates the inner product for this feature space).
Therefore to construct function (10.52) one can use methods developed in
Sections to.2 and 10.3 for constructing linear separating hyperplanes where
instead of the inner products defined as (x,Xj), one uses the inner product
defined by kernel K(x ,Xj).
1. To find the coefficients aj in the separable case
y;f(x;,a) = 1
it is sufficient to find the maximum of the functional
f
1
f
W(a) = L
ai -
2" L
ajajYiyjK(xj,xj)
;=1
;,j
subject to the constraints
(to.53)
f
LajYj =0,
j=1
aj 2': 0,
i=1,2, ... ,£.
(to.54)
2. To find the optimal soft margin solution for the nonseparable case, it is
sufficient to maximize (10.53) under cunstraints
f
La;y; = 0,
;=1
0:::; aj:::; C.

10.5 THE IDEA OF THE SUPPORT VECTOR MACHINE
425
3. Finally to find the optimal solution for a given margin p = 1/A
one has to maximize the functional
l
W(a) = La;-A
i=1
subject to constraints
lL aiajYiyjK(x;, Xj)
i,j=1
l
LaiYi =0,
i=1
o:S ai :S ].
The learning machines that construct decision functions of these type are
called support vector (SY) machines.t The scheme of SV machines is shown
in Fig. 10.3.
y
Decision ru Ie
y = sign (ry;aiK(xi,a) + b)
i = I
Weights Ylal •... , yrvaN
Nonlinear transformation
based on support vectors,
xl, ... , XN
Input vector X =(xl, ..., xn )
FIGURE 10.3. The support vector machine has two layers. During the learning process
the first layer selects the basis K(x,Xj), ; = 1, ...,N (as well as the number N), from the
given set of bases defined by the kernel; the second layer constructs a linear function
in this space. This is completely equivalent to constructing the optimal hyperplane in
the corresponding feature space.
t With this name we stress the idea of expanding the solution on support vectors. In SV machines
the complexity of the construction depends on the number of support vectors rather than on
the dimensionality of the feature space.

426
10 THE SUPPORT VECTOR METHOD
10.6
ONE MORE APPROACH TO THE SUPPORT VECTOR METHOD
10.6.1
Minimizing the Number of Support Vectors
The foJlowing two results of analysis of the optimal hyperplane inspire one
more approach to the support vector method that is based on a linear opti-
mization technique rather than the quadratic optimization described abovet:
1. The optimal hyperplane has an expansion on the support vectors.
2. If a method of constructing the hyperplane has a unique solution, then
the generalization ability of the constructed hyperplane depends on the
number of support vectors (Theorem to.5).
Consider the following optimization problem. Given the training data
one has to find the parameters ai, i = 1, ... ,f, and b of the hyperplane
f
LYiai(Xi * x) + b = 0,
i=1
a >0
1_
that separates the data-that is, satisfies the inequalities
and has the smallest number of nonzero coefficients ai.
Let us call the vector Xi that corresponds to the nonzero coefficient a, a
support vector.
Let us rewrite our optimization problem in the following form: Minimize
the functional
f
R= Lar,
i=1
ai ~ 0
in the space of nonnegative a subject to constraints
(10.55)
where (T > 0 is a sufficiently small value.
t Note that for Ihis approach only. Theorem 10.5 is valid. while for the optimal hyperplane a
more strong bound given in Theorem 10.7 holds true.

10.6 ONE MORE APPROACH TO THE SUPPORT VECTOR METHOD
427
We will choose, however, (T = 1 (the smallest value for which the solution
of the optimization problem is simple). Therefore we would like to minimize
the functional
subject to constraints (10.55).
a· >0
1_
(10.56)
10.6.2
Generalization lor the Nonseparable Case
To construct the separating hyperplane for the nonseparable case using the
linear optimization procedure we utilize the same idea of generalization that
we used in Section lOA. We minimize functional
l
l
L= La;+CL~;'
;=1
;=1
(10.57)
over the nonnegative variables a;,
~; and parameter b subject to the con-
straints
i = 1, ..., t.
10.6.3
Linear Optimization Method lor SV Machines
To construct the support vector approximation from the set of decision rules
one can solve the linear optimization problem defined by the objective func-
tion
l
l
L= La;+CL~;
;=1
;=1
subject to the constraints
i = 1, ...,R,
Y; [tYiaiK(X;,Xi) + b] ~ 1 -
~i·
1=1
[n this case the kernel K(x;, Xj) does not need to satisfy Mercer's condi-
tions.

428
10 THE SUPPORT VECTOR METHOD
However, this construction of the SV machine does not possess all the nice
statistical properties of machines constructed on the basis of the idea of the
optimal hyperplane.
Therefore in the following we will consider only the SV machines con-
structed on the basis of the optimal hyperplane technique.
10.7
SELECTION OF SV MACHINE USING BOUNDS
The bounds on generalization ability obtained in Sections 10.2 and 10.3 allow
us to choose a specific model of SV machine from a given set of models.
Note that the support vector machines implement the SRM principle.
Indeed, let
Z(X) = (ZI (x), ..., ZN(X)" ..)
be the feature space and let W = (WI, ..., WN,' .. ) be a vector of weights de-
termining a hyperplane in this space. Consider a structure on the set of hy-
perplanes with elements Sk containing the functions satisfying the conditions
where D is the radius of the smallest sphere that contains the vectors 'I'(x),
and Iwi is the norm of the weights (we use canonical hyperplanes in the
feature space with respect to the vectors Zi = Z(Xi), where Xi are the elements
of the training data). According to Theorem 10.3 (now applied in the feature
space), k gives an estimate of the VC dimension of the set of functions Sk
defined on the training data.
The SV machine separates the training data
Yi [(z(x;) * w) + b] 2: 1,
Yi = {+1, -I},
i=I,2, ...,£
without errors and has the minimal norm Iwi. In other words, the SV machine
separates the training data using functions from element Sk with the smallest
estimate of the VC dimension.
Therefore one can use the following criteria for choosing the best model:
(10.58)
where both the value of lWei and D( can be calculated from the training
vectors.

10.7 SELECTION OF SV MACHINE USING BOUNDS
429
Recall that in feature space the equality
R
f
~ = IWI 12 = L a?a7YiYj(Z (Xi ) * Z(Xj)) = L afa7YiyjK(Xi' Xj)
PI
i,a
i,a
(10.59)
holds true.
To define the radius of the smallest sphere Dr that includes training vec-
tors, one has to solve the following simple optimization problem: Minimize
functional (DE * Dr) subject to constraints
i = 1, ..., £,
where Xi, i = 1, ...,n, are support vectors, and a is the center of the sphere.
Using technique of Lagrange multipliers, one can find that
f
D; = L f3d3j(z(Xi) * z(Xj)),
i,;=1
where coefficients f3i, i = 1, ...,e, are a solution to the following quadratic
optimization problem: Maximize the functional
r
I
W*(f3) = L f3i(Z(Xi) * Z(Xi)) - L f3if3j(Z(X;) * z(x/))
(10.60)
i=\
subject to constraints
i,j=\
R
Lf3; = 1,
f3i ~ O.
i=1
(10.61)
Using kernel representation, we can rewrite the radius of the smallest sphere
in the form
f
D; = L f3;f3jK(x;,Xj)
;';=1
and functional (10.59) in the form
R
f
W*(f3) = 'Lf3;K(x;, x;) - 'Lf3if3jK(x;,xj)'
;=\
;,;=\
(10.62)
(10.63)
Therefore, to control the generalization ability of the machine (to minimize
the expectation of test error), one has to construct the separating hyperplane

430
10 THE SUPPORT VECTOR METHOD
that minimizes the functional
(to.64)
where Iwrl2 and Di are defined by (10.59) and (10.62).
Choosing among different models (different kernels) the model that min-
imizes the estimate (10.58), one selects the best SV machine.
Thus the model selection is based on the following idea: Among different
SV machines that separate the training data, the one with the smallest VC
dimension is the best. In this section in order to estimate the VC dimension
we use the upper bound (to.58). In Chapter 13, which is devoted to experi-
ments with SV machines in order to obtain a more accurate evaluation. we
introduce a method of direct measuring of the VC dimension from experi-
ments with the SV machine. As we will see, both methods of evaluating the
VC dimension (based on bound (10.58) or based on the experiments with
the SV machine) show that the machine with the smallest estimate of VC
dimension is not necessarily the one that has the smallest dimensionality of
feature space.
10.8
EXAMPLES OF SV MACHINES FOR PAnERN RECOGNITION
This section uses different kernels for generating the inner products K (x, Xi)
in order to construct learning machines with different types of nonlinear
decision surfaces in the input space. We consider three types of learning
machines:
1. Polynomial SV machines,
2. Radial basis function SV machines,
3. Two-layer neural network SV machines.
For simplicity we discuss here the case with the separable data.
10.8.1
Polynomial Support Vector Machines
To construct polynomial of degree d decision rules, one can use the following
generating kernel:
(10.65)
This symmetric function, rewritten in coordinates space, describes the
inner product in the feature space that contains all the products Xii' ... , X,,,
up to the degree d. Using this generating kernel, one constructs a decision

(10.67)
10.8 EXAMPLES OF SV MACHINES FOR PATTERN RECOGNmON
431
function of the form
f(x, a) = sign (
L
Yiad(Xi * x) + l]d +b) ,
support vectors
which is a factorization of d-dimensional polynomials in the n-dimensional
input space.
In spite of the high dimension of the feature space (polynomials of degree
d in n-dimensional input space have O(nd ) free parameters), the estimate of
the VC dimension of the subset of polynomials that solve real-world problems
on the given training data can be low (see Theorem 10.3). If the expectation
of this estimate is low, then the expectation of the probability of error is small
(Theorem 10.6).
Note that both the value De and the norm of weights Iwrl in the feature
space depend on the degree of the polynomial. This gives an opportunity to
choose the best degree of polynomial for the given data by minimizing the
functional (10.58).
10.8.2
Radial Basis Function SV Machines
Classical radial basis function (RBF) machines use the following set of deci-
sion rules:
[(x) = sign (~aiKy(ix - xd) - b),
(10.66)
where Ky(lx - xii) depends on the distance Ix - x,I between two vectors. For
the theory of RBF machines see Powell (1992).
The function Ky(lzl) is a positive definite monotonic function for any fixed
1; it tends to zero as IzI goes to infinity. The most popular function of this
type is
To construct the decision rule from the set (10.66), one has to estimate
(1) The number N of the centers Xi,
(2) The vectors Xi, describing the centers.
(3) The values of the parameters ai'
(4) The value of the parameter 1.
In the classical RBF method the first three steps (determining the parame-
ters 1 and N and vectors (centers) Xi, i = 1, ...,N) are based on heuristics
and only the fourth step (after finding these parameters) is determined by
minimizing the empirical risk functional.
It is known (see Section 8.4) that the radial basis function of type (10.66)
satisfies the condition of Mercers theorem.

432
10 THE SUPPORT VECTOR METHOD
Therefore one can choose the function Ky(lx - XiI) as a kernel generating
the inner product in some feature space. Using this kernel, one can construct
a SV radial basis function machine.
In contrast to classical RBF methods, in the SV technique all four types
of parameters are chosen automatically:
(1) The number N of support vectors.
(2) The support vectors Xi, (i = 1, ''', N).
(3) The coefficients of expansion ai = aiYi.
(4) The width parameter )' of the kernel function chosen to minimize
functional (10.58).
10.8.3
Two-Layer Neural SV Machines
One can define two-layer neural networks by choosing kernels:
where S(u) is a sigmoid function. In contrast to kernels for polynomial
machines or for radial basis function machines that always satisfy Mercer's
condition, the sigmoid kernel
1
S[(x * Xi)] = 1 + exp{v(x * xd - c}'
satisfies the Mercer condition only for some values of parameters c and v.
For example if IxI = 1, IXiI = 1 the parameters c and v of the sigmoid function
has to satisfy the inequaiityt c 2': v. For these values of parameters one can
construct SV machines implementing the rules
f(x, a) = sign {E
a,S(u(x *Xi) - c) + b } .
Using the technique described above, the following parameters are found
t In this case one can introduce two (n + 1)-dimensional vectors: vector x· which first n coordi-
nates coincide with vector x and the last coordinate is equal to zero and vector xt which first n
coordinate coincide with
vector x,
and
the last coordinate
is equal to a = J2(c - u).
If c 2: u then a is real and one can rewrite sigmoid function in n-dimensional input space as a
radial basis function in n + 1 dimensional space S[(x * Xi)] = (I + exp{ -O.5ullx· - x,·11 2})-I.

10.8 EXAMPLES OF SV MACHINES FOR PATIERN RECOGNITION
433
automatically:
(1) The architecture of the two layer machine, determining the number N
of hidden units (the number of support vectors),
(2) the vectors of the weights Wi = Xi in the neurons of the first (hidden)
layer (the support vectors), and
(3) the vector of weights for the second layer (values of a).
Structure of Positive Definite Functions. The important question IS:
How rich is the set of functions satisfying the Mercer condition?
Below we formulate four classical theorems describing the structure of the
kernel functions K(x - Xi) which satisy the Mercer conditions. This type of
kernels is called a positive definite function.
For positive definite functions, the following elementary properties are
valid:
1. Any positive function is bounded
2. If F], "', Fn are positive definite and ai 2: 0 then
n
f(x - Xi) = LakFk(X - Xi)
k=]
is positive definite.
3. If each Fn is positive definite then so is
F(x - Xi) = lim Fn(x - Xi)'
n--->oo
4. The product of positive definite functions is positive definite function.
In 1932, Bochner described the general structure of positive definite func-
tions.
Theorem (Bochner). If K(x - Xi) is a continuous positive definite function,
then there exists a bounded nondecreasing function V(u) such that K(x - Xi)
is a Fourier-Stieltjes transform of V(u), that is
K(x - Xi) =I: ei(x-x,ju dV(u).
If function K (x - Xi) satisfies this condition, then it is positive definite.

434
10 THE SUPPORT VECTOR METHOD
The proof of the sufficient conditions in this theorem is obvious. Indeed
f:f: K (x - Xi )g(X)g(Xi) dx dx,
=I:f:{I: ei(X-X.)U dV(U)} g(X)X(Xi) dx dXi
=f: II: g(x)e
iXU
I
2
dV(u) 20.
A particular class of positive definite functions, namely functions of the type
F(u), where u = IXi - xjl plays an important role in applications (e.g., in the
RBF method). Note, that F(u) is a one-dimensional function but x E Rn . The
problem is to describe functions F(u) that provide positive definite functions
F(Ix - Xi I) independent on dimensionality n of vectors x. Schoenberg (1938)
described the structure of such functions.
Definition 3. Let us call function F(u) completely monotonic on (0,00), pro-
vided that it is in CXl(O, (0) and satisfies the conditions
(_1)kF(k l (U) 20,
UE(O,oo),
k=O,l, ....
Theorem (Schoenberg). Function F(lx - xii) is a positive definite if and only
if F( Jlx - xii) continuous and completely monotonic.
The theorem implies that function
f(x - Xi) = exp{ -alx - x;jP},
a>°
is positive definite if and only if°~ p ~ 2.
Lastly, a useful criterion belongs to Polya (1949).
Theorem (Polya). Any real, even, continuous function F(u) which is convex
on (0, (0) (that is satisfies inequality F(1/2(Ul + U2)) ~ 1/2[F(Ul) + F(U2)]) is
a positive definite.
On the basis of these theorems, one can construct different positive definite
functions of type K(x - Xi)' For more detail about positive definite functions
and their generalizations, see Stewart (1976), Micchelli (1986), and Wahba
(1990).
10.9
SUPPORT VECTOR METHOD FOR TRANSDUCTIVE INFERENCE
Chapter 8 introduced a new type of inference, the transductive inference, in
order to improve performance on the given test set. For a class of linear indi-
cator functions we obtained bounds on the test error that generally speaking
are better than bounds on error rate for inductive inference.

10.9 SUPPORT VECTOR METHOD FOR TRANSDUCTIVE INFERENCE
435
This section shows that by using the standard SV technique, one can gen-
eralize the results obtained for indicator functions which are linear in input
space to nonlinear indicator functions which are linear in a feature space.
We considered the following problem: given training data
(10.68)
and test data
(10.69)
find in the set of linear functions
Y = (l/J *x)+b
a function that minimizes the number of errors on the test set. Chapter 8
showed that in the separable case, a good solution to this problem provides
a classification of the test error.
such that the joint sequence
*
*
Yj""'Yk
(10.70)
(10.71)
is separated with the maximal margin.
Therefore we would like to find such classifications (10.70) of the test
vectors (10.69) for which the optimal hyperplane
Y = (l/Jo *x)+bo
maximizes the margin when it separates the data (10.71), where l/Jodenoted
the optimal hyperplane under condition that test data (10.69) are classified
according to (10.70):
l/Jo=
l/Jo(y~, ...,YZ)·
Let us write this formally; our goal is to find such classifications y~, ... ,YZ
for which the inequalities
Y;[(Xi * l/J*) + b] ~ 1,
yj[(xj * l/J*) + b] ~ 1,
are valid and the functional
i = 1, ... ,E
i = 1, ...,k
(10.72)
(10.73)
<1>( l/Jo (y~ , ...,YZ» = min -2111 l/J *11 2
1/1;
attains it minima (over classifications y~, "', YZ).
(10.74)

436
10 THE SUPPORT VECTOR METHOD
In a more general setting (for a nonseparable case) find such classifications
y;, ...,YZ for which the inequalities
yd(Xi * IjJ*) + b] ~ 1 -
~i,
yj[(xj * IjJ*) + b] ~ 1 -
~j*'
are valid and the functional
~i ~ 0,
i = 1, ...,.e
~j* ~ 0,
j = 1, ..., k
(10.75)
(10.76)
<1>(t/to(y~ , "', yk)) =
I?lin. [~II IjJ; 11
2 + Ct
~i + C*t ~/]
!/I,U
.1.1
1=
J=
(10.77)
(where C and C* are given non-negative values) attains its minima (over
*
*)
YI' ""Yk .
Note that to solve this problem, find the optimal hyperplanes for all fixed
y~, "', yZ and choose the best one. As it was shown in Section 10.2, to find
the dual representation the optimal hyperplane for the fixed y~ ,...,yZ
one has to maximize the functional
subject to constraints
°~ ai ~ C,
°~ a/ ~ C*,
f
K
LYiai + Lyjaj = 0.
i=1
j=1
Since
max W(a, a*) =
<I>(y~, ...,YZ)
O,Of

lD.lD MULTICLASS CLASSIFICATION
437
to find hyperplane for transductive inference, one has to find the minimax
solution where the maximum is computed by solving quadratic optimization
problems and the minimum is taken over all admissible classifications of the
test set.
Repeating these arguments in feature space one can formulate a trans-
ductive solution which is nonlinear in input space but linear in some feature
space. Find such classification y;,...,YZ for which the functional
W(y;, ... ,yk)
subject to constraints
o ~ Ui ~ C,
0< u* < C*
-
J -
,
f
k
LYiUi + Lyjuj* = O.
i=l
j=!
attains its minima.
Generally speaking the exact solution of this minimax problem requires
searching over all possible 2k classifications of the test set. This can be done
for small number of test instances (say 3-7). For a large number of test
examples, one can use various heuristic procedures (e.g., by clastering of the
test data and providing the same classification for the entire claster).
Note that the same solution can be suggested to the problem of construct-
ing a decision rule using both labeled (10.68) and unlabeled (10.69) data.
Using parameters u, u* and b obtained in transductive solution, construct
the decision rule
that includes information about both data sets.
10.10
MULl'ICLASS CLASSIFICATION
Until now we have considered only the two-class classification problem. How-
ever real world problems often require discriminating between n > 2 classes.

438
10 THE SUPPORT VECTOR METHOD
Using a two-class classification, one can construct the n-class classifier using
the following procedure:
1. Construct n two-class classification rules where rule fk(X), k = 1, ... ,n
separates training vectors of the class k from the other training vectors
(signlfk(xi)] = 1, if vector Xi belongs to the class k, sign[fk(xi)] = -1
otherwise).
2. Construct the n-dass classifier by choosing the class corresponding to
the maximal value of functions fk (xd, k = 1, ... ,n:
m = argmax{fl(Xj), ... ,In(x;)}.
This procedure usually gives good results.
For the SV machines however one can solve the multidass classification
problem directlyt. Suppose we are given the training data
I
Inn
XI' ... , XII' ... ,XI' ... ,XI,,'
where the superscript k in x7 denotes that the vector belongs to class k.
Consider the set of linear functions
Our goal is to construct n functions (n pairs (wk , bk )) such that the rule
m = argmax{[(x * wI) + bIl, .. _, [(x * wn ) + b,,]}
separates the training data without error. That is, the inequalities
( X k * wk ) + b - (x k * wm ) - b
> 1
I
k,m --
hold true for all k = 1, ... ,n, m -I k and i = 1, ... ,'k'
If such a solution is possible we would like to choose the pairs (wk , bk ),
k = 1, ... ,n for which the functional
is minimal.
t This generalization was considered by V. Blanz and V. Vapnik. Later. similar methods were
proposed independently by M. Jaakkola and by C. Watkins and J. Weston.

10.10 MULTICLASS CLASSIFICATION
439
If the training data cannot be separated without error, we minimize the
functional
n
n
f k
L
(wk * wk) + eLL ~f
k=!
k=! j=!
subject to constraints
(xt * wk ) + bk - (xt * wm ) - bm 2: 1 -
~jk,
where
k = 1, .. .,n,m 1: k,i = 1, . .. ,Rk.
To solve this optimization problem we use the same optimization technique
with Lagrange multipliers. We obtain:
1. Function fk (x) has the following expansion on support vectors
ek
1m
fk(X) = L
L
aj(k, m)(x * xt) - L
L
aj(m, k)(x *xr) + bk·
m#k j=!
m#k j=!
2. Coefficients aj(k,m), k=I, ... ,n,m1:k,i= 1, ... ,Rk,j=I, ... ,Rm of
this expansion have to maximize the quadratic form
W(a)
ek
LLaj(k,m)
m#k j=!
1m
e:"
+ L
L
aj(m, k)aj(m*, k)(xr *xl')
i=! j=!
subject to constraints
o ~ L
aj(k,m) ~ C,
m#
em
LLaj(m,k),
m# j=!
k = 1,.",n.

440
10 THE SUPPORT VECTOR METHOD
For n = 2, this solution coincides with the two-class classification solu-
tion.
For n > 2 one has to estimate simultaneously len - 1) parameters a;(k, m),
i = 1, .. ..fb m =I k, k = 1, ... , n, where
To construct the n-class classifier using two-class classification rules, one needs
to estimate n times .f parameters.
As before, to construct the SV machine we only need to replace the inner
product
(x~ * xI) with kernel K(x~ *xj) in the corresponding equations.
10.11
REMARKS ON GENERALIZATION OF THE SV METHOD
The SV method describes a general concept of learning machine. It considers
a kernel-type function approximation that has to satisfy two conditions:
1. The kernel that defines the SV machine has to satisfy Mercer's condi-
tion.
2. The hyperplane constructed in feature space has to be optimal; that is,
it possesses the smallest norm of coefficients (the largest margin).
The question arises: How crucial are these conditions? Is it possible to remove
them in order to construct the general kernel method of function estimation?
That is, consider functions of the form
l
Y = L aiK(x, x;) + b
i=l
(where K(x, Xi) does not necessarily satisfy Mercer's condition) that approx-
imates data using other optimality functional.
1. To answer the question about kernel, note that the generalization prop-
erties of the SV machine described in theorems presented in Section
10.3, is defined by existence of the feature space where a small norm of
coefficients of the canonical hyperplane is the guarantee for good gen-
eralization. Removing Mercer's condition one removes this guarantee.
2. However, it is not necessary to use the vector-coefficient norm of the
canonical hyperplane as the functional for minimization. One can mini-
mize any positive definite quadratic form. However, to minimize
arbitrary quadratic forms one has to use general quadratic optimiza-
tion tools.

10.11 REMARKS ON GENERALIZATION OF THE SV METHOD
441
The following shows that for any positive definite quadratic form there
exists another feature space connected to the first one by linear transforma-
tion where one achieves an equivalent solution by minimizing the norm of the
coefficient vector. Solving problems in this space, one enjoys the advantage
of the support vector technique.
Indeed, consider the hyperplane
(x * ljJ) + b = 0,
which satisfies the inequalities
yd(Xi * r/J) + b] 2: 1 -
~i,
;=1, ...,£
(10.78)
(separates the training data) and maximizes the quadratic form
f
W(r/J) = (r/J *Ar/J) + CL
~i'
i=1
(10.79)
Since A is a positive definite symmetric matrix there exists the matrix
B=vA.
Therefore one can rewrite the objective function as follows:
f
W(ljJ) = (Br/J * BljJ) + CL
~i'
i=1
(10.80)
Let us denote
c/J = Br/J and Zi = B-1Xi. Then the problem of minimizing
functional (10.79) subject to constraint (10.77) is equivalent to the problem
of minimizing the functional
subject to constraint
f
W(c/J) = (c/J * c/J) + CL~i
i=1
(10.81)
;=1, ...,1'.
(10.82)
That means that there exists some linear transformation of the vectors x
into vectors Z for which the problem of minimizing the functional (10.80)
under constraint (10.78) is equivalent to minimizing functional (10.81) under
constraint (10.82).
The solution of the optimization problem with objective function (10.81)
leads to the support vector technique that has important computational ad-
vantages.


11
THE SUPPORT VECTOR
METHOD FOR ESTIMATING
REAL-VALUED FUNCTIONS
In this chapter the SV method introduced in Chapter 10 for estimating indi-
cator functions is generalized to estimate real-valued functions. The key idea
in this generalization is a new type of loss function, the so-called e-insensitive
loss function. Using this type of loss function, one can control a parameter
that is equivalent to the margin parameter for separating hyperplanes.
This chapter first discusses some properties of the e-insensitive loss func-
tion and its relation to the Huber robust loss-function, then shows that the
same quadratic optimization technique that was used in Chapter 10 for con-
structing approximations to indicator functions provides an approximation to
real-valued functions, and finally introduces some kernels that are useful for
the approximation of real-valued functions.
At the end of this chapter we show how the SV technique can be used
for solving linear operator equations with approximately defined right-hand
sides. In particular, we use the SV technique for solving integral equations
that form ill-posed problems.
11.1
e-INSENSITIVE LOSS FUNCTIONS
In Chapter 1, Section 1.4, to describe the problem of estimation of the
supervisor rule F(Ylx) in the class of real-valued functions {f(x,a),a E A}
we considered a quadratic loss function
M(y,f(x,a)) = (y - f(x,a))2.
(11.1)
Under conditions where y is the result of measuring a regression function with
443

444
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
normal additive noise
~, the ERM principle provides (for this loss function)
an efficient (best unbiased) estimator of the regression f(x, Q{).
It is known, however, that if additive noise is generated by other laws, bet-
ter approximations to the regression (for the ERM principle) give estimators
based on other loss functions (associated with these laws)
M(y,f(x, a» = L(ly - f(x, a)l)
(L(O = -lnp(~) for the symmetric density function p(~».
Huber (1964) developed a theory that allows finding the best strategy for
choosing the loss function using only general information about the model
of the noise. In particular, he showed that if one only knows that the density
describing the noise is a symmetric smooth function, then the best minimax
strategy for regression approximation (the best approximation for the worst
possible model of noise p(x»
provides the loss function
M(y,f(x, a» = Iy - f(x, a)l·
(11.2)
Minimizing the empirical risk with respect to this loss function is called
the least modulus method. It belongs to the so-called robust regression family.
This, however, is an extreme case where one has minimal information about
the unknown density. In Section 11.3 we will discuss the key theorem of
robust theory that introduces a family of robust loss functions depending on
how much information about the noise is available.
To construct an SV machine for real-valued functions we use a new type
of loss functions, the so-called e-insensitive loss functions:
M(y,f(x,a» = L(ly - f(x,a)le),
where we denote
Iy - f(x, a)le = { f;-f(x, a)l- e
if Iy - f(x, a)1 ~ e,
otherwise.
(11.3)
These loss functions describe the e-insensitive model: The loss is equal to
o if the discrepancy between the predicted and the observed values is less
than e.
Below we consider three loss functions
1. Linear e-insensitive loss function:
L(y - f(x, a»
= Iy - f(x, a)lr.
(it coincides with the robust loss function (11.2) if e = 0).
(11.4)

11.2 LOSS FUNCTIONS FOR ROBUST ESTIMATORS
445
2. Quadratic e-insensitive loss function:
L(y - [(x, a)) = Iy - [(x, a)l;
(it coincides with quadratic loss function (11.1) if e = 0).
3. Huber loss function:
(11.5)
L(ly - [(x, a)l) = { ely - [(x, a)1 - ~
~Iy - [(x, aW
that we will discuss in Section 11.4.
for Iy - [(x, a)/ > e
for /Iy - [(x, a)1 ~ c.
(11.6)
Using the same technique, one can consider any convex loss function L(u).
However, the above three are special: They lead to the same simple optimiza-
tion task that we used for the pattern recognition problem.
In Section 11.3 we consider methods of estimating real-valued functions
that minimize the empirical risk functional with the e-insensitive loss func-
tions. However, in the next section we discuss the robust estimation of func-
tions and show that the linear e-insensitive loss function also reflects the
philosophy of robust estimation.
11.2
LOSS FUNCTIONS FOR ROBUST ES1'IMATORS
Consider the foLLowing situation. Suppose our goal is to estimate the expec-
tation m of the random variable ~ using i.i.d. data
~1, ... , ~l'
Suppose also that the corresponding unknown density Po(~ - mo) is a smooth
function, symmetric with respect to the position mo, and has finite second
moment.
It is known that in this situation the maximum likelihood estimator
m =
M(~l, ..., ~llpo),
which maximizes
l
L(m) = L
lnpO(~i - m),
i=I
is an effective estimator. This means that among all possible unbiased
estimatorst this estimator achieves the smallest variance; or in other words,
t Estimator M(~J, ..., ~l) is called unbiased if
EM(~I, ..., ~l) = m.

446
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
estimator M( ~l , ... , ~flpo) minimizes the functional
(11.7)
Suppose now that although the density Po(~ - m) is unknown, it is known
that it belongs to some admissible set of densities Po(~ - m) E P. How do
we choose an estimator in this situation? Suppose, the unknown density
Po(~ - m). However, we construct our estimator that is optimal for density is
PI (~ - m) E P; that is, we define the estimator M(~l, ..., ~flpl) that maximizes
the functional
l
L 1(m) = L lnpl (~; - m).
;=1
(11.8)
The quality of this estimator now depends on two densities: the actual one
poa - m) and the one used for constructing estimator (11.8):
Huber proved that for a wide set of admissible densities P there exists
a saddle point of the functional V (Po, PI). That is, for any admissible set of
densities there exists a density p,(~ - m) such that the inequalities
V(P,p,) ~ V(P"p,) ~ V(P"p)
(11.9)
hold true for any function p(~ - m) E P.
Inequalities (11.9) assert that for any admissible set of densities there exists
the minimax density, the so-called robust density, that in the worst scenario
guarantees the smallest loss.
Using the robust density, one constructs the so-called robust regression
estimator. The robust regression estimator is the one that minimizes the func-
tional
f
Rh(w) = - L Inp,(y; - f(x;, a)).
;=1
Below we formulate the Huber theorem, which is a foundation of the
theory of robust estimation.
Consider the class H of densities formed by mixtures
p(~) = (1 -
€)g(~) + €h(~)
of a certain fixed density g(~) and an arbitrary density h(~) where both den-
sities are symmetric with respect to the origin. The weights in the mixture
are 1 -
€ and €, respectively. For the class of these densities the following
theorem is valid.

11.2 lOSS FUNCTIONS FOR ROBUST ESTIMATORS
447
Theorem (Huber). Let -Ing(~") be a twice continuously differentiable func-
tion. Then the class H possesses the following robust density
for g < go
for go ::; g < gl
for g ~ gl,
(11.10)
where go and g\ are endpoints of the interval [go, gl] on which the monotonic
(due to convexity of -Ing(g)) function
g'(g)
---
g(g)
is bounded in absolute value by a constant c determined by the normalization
condition
This theorem allows us to construct various robust densities. In particular,
if we choose for g(g) the normal density
1
{g2 }
g(g) = vlhu exp
- 2u2
and consider the class H of densities
then according to the theorem the density
(11.11)
will be robust in the class, where c is determined from the normalization
condition
1 _ € (/ca
{e}
2 exp { - ~ }
1 =
exp --
dg + ----'---"--
J2ii-u
-err
2
c

448
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
~/~
o
0
FIGURE 11.1.
~nsensltlve linear loss function and Huber's loss function.
The loss function derived from this robust density is
{
Cl
clgl- -
L(~) = -lnp(~) =
;'
2
for Igi > c,
for Igi :::; c.
(11.12)
It smoothly combines two functions: quadratic and linear. In one extreme
case (when c tends to infinity) it defines the least-squares method, and in the
other extreme case (when c tends to zero) it defines the least modulo method.
In the general case, the loss functions for robust regression are combinations
of two functions, one of which is f(u) = lui.
Linear e-insensitive loss functions, introduced in the previous section, have
the same structure as robust loss functions.t They combine two functions; one
is f(u) = lui and the other is f(x) = 0, which is insensitive to deviations.
It is possible to construct an SV machine for the robust loss function
(11.12). However, the support vector machine defined on the basis of the
linear e-insensitive loss function (which has the same structure as the loss
function (11.12); see Fig. 11.1) has an important advantage: In Chapter 13
we will demonstrate that by choosing the value of e, one can control the
number of support vectors.
11.3
MINIMIZING THE RISK WITH e-INSENSITIVE LOSS FUNCTIONS
This section considers methods for constructing linear SV approximations
using a given collection of data. We will obtain a solution in the form
f
f(x) = L f3i(X *Xi) + b,
i=]
(11.13)
where the coefficients f3i are nonzero only for a (small) subset of the training
data (the support vectors).
t Formally it does not belong to the family of Huber's robust estimators since uniform distribution
function does not possess a smooth derivative.

11.3 MINIMIZING THE RISK wrrH 8-1 NSENSITIVE LOSS FUNCnONS
449
To obtain an approximation of the form (11.13) we use different loss func-
tions that lead to different estimates of the coefficients f3i'
11.3.1
Minimizing 'the Risk for a Fixed Element of the Structure
Consider the structure on the set of linear functions
n
f(x, w) = LWiXi + b
i=1
(11.14)
defined in x = (xl, ... ,xn) E X, where X is a bounded set in Rn. Let an
element So of the structure S contain functions defined by the vector of
parameters W = (wi, ..., wn) such that
(11.15)
Suppose we are given data
Our goal is to find the parameters wand b that minimize the empirical risk
1
f
Remp(w, b) = f L /Yi - (w * Xi) -
bl~,
i=1
(11.16)
(where k is equal 1 or 2) under constraint (11.15).
This optimization problem is equivalent to the problem of finding the pair
w, b that minimizes the quantity defined by slack variables gi, g;*, ; = 1, ... ,f
under constraints
(11.17)
;=l,
,f,
;=I,
,f
Y· - (w *x·) - b < e + c."
I
1
_
C;, '
(w *x·) + b - y. < e + c.
I
I
_
~l'
; = 1,
,f,
;=l,
,f,
(11.18)
and constraint (11.15).

450
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
As before, to solve the optimization problem with constraints of inequality
type one has to find the saddle point of the Lagrange functional
L(w, g*, g; a*, a" y, f3, f3*)
f
f
= 2:((gnk + (gi)k) - 2:ai [Yi - (w * Xi) - b + Si + gil
i=1
i=1
f
f
- 2: at [(w *xi)+b-Yi +Si +gn - f(A 2 -(w *w))- 2:(f3t gt +f3;gi)
i=1
i=1
(11.19)
(the minimum is taken with respect to elements w, b, g;, and gt and the
maximum with respect to Lagrange multipliers y ~ 0,
a j* ~ 0, aj ~ 0, f3;* ~
0, and f3i ~ 0, i = 1, ... ,p).
Minimization with respect to w, b, gt, and g; implies the following condi-
tions:
f
f
2: at = 2: a;,
i=1
i=1
(11.20)
(11.21)
f3i + at ::; k(gnk- I ,
f3. + a·
< kl:k- 1
1
1
_
~I
,
i=I, ... ,£,
i=l, ... ,f..
(11.22)
Condition (11.20) means that the desired vector w has an expansion on
some elements of the training data. To find the saddle point parameters at, al
of functional (11.19) we put (11.20) into the Lagrangian (11.19). Then taking
into account (11.21) and (11.22) we determine that to find parameters at, ai
of the saddle point we have to solve the following optimization problems.
Case k = 1. If we consider the linear s-insensitive loss functions, then we
have to maximize the functional
W(a,a*,y)
f
f
- 2: Si(at + a;) + 2:Yi (at - a;)
;=1
i=1

11.3 MINIMIZING THE RISK WITH 8-INSENSITIVE LOSS FUNCTIONS
451
subject to constraints (11.21) and (11.22) and the constraintst
Maximizing (11.23) with respect to y, one obtains
y=-----------
A
(11.24)
(11.25)
Putting this expression back in functional (11.23), we determine that to find
the solution one has to maximize the functional:
f
f
W(a, a*, y) =
- L
8;(at + a;) + Ly;(at - a;)
;=1
;=1
f
-A
L
(at -
ai)(aJ~ - aj)(xi * Xj)
i,j=1
subject to constraints (11.21) and (11.24).
As in the pattern recognition problem, here only some of the parameters
i = 1,,,.,£
y
differ from zero. They define the support vectors of the problem. To find
parameter b, it remains to minimize the empirical risk functional (11.16)
with respect to b.
Case k = 2. If we consider the quadratic 8-insensitive loss function, then to
find the parameters of the expansion we have to maximize the functional
f
f
W(a, a*, y) = - L
8;(at+ a;)+LYi(at- a;)
;=1
;=1
f
f
~
- 21y L(a;"-a;)(aj-aj)(xi *Xj)-~ L
((an 2+a?) _A~y
i,j=l
i=1
(11.26)
subject to constraints (11.21), (11.24), and y > O.
t One can solve this optimization problem using a quadratic optimization technique and line
search with respect to parameter y.

452
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
Maximizing (11.26) with respect to y, we obtain that the optimal y has to
satisfy the expression (11.25). Putting the expression for the optimal y back
into (11.26), we obtain the functional
W(a, a", y)
e
e
- L
e;(a;" + a;) + Ly;(a;" - ai)
i=!
i=!
-A
which one has to maximize under constraints (11.21) and (11.24). The
obtained parameters define the vector coefficients (11.20) of the desired
hyperplane.
11.3.2
The Basic Solutions
One can reduce the optimization problem of finding the vector w to a quad-
ratic optimization problem if, instead of minimizing the functional (11.17),
subject to constraints (11.15) and (11.18), one minimizes the functional
(with a given value C) subject to constraints (11.18), where k = 1 for the
linear e-insensitive loss function and k = 2 for the quadratic e-insensitive
loss function.
Repeating the same arguments as in the previous section (constructing
a Lagrange functional, minimizing it with respect to variables w, g;, g;", i =
1, ... , f, and excluding these variables from the Lagrangian), one obtains that
the desired vector has the following expansion:
e
w = L(a;" - ai)xi.
i=!
(11.27)
Case k = 1. To find coefficients a;", ai, i = 1, ...,i, for case k = 1, one has
to maximize the quadratic form
W(a, a")
e
e
- Le;(at + a;) + Ly;(at - a;)
;=!
i=!
e
-~ L(a;" - a;)(aj - aj)(x; *Xj)
;,j=!
(11.28)

11.3 MINIMIZING THE RISK WITH 8-INSENSITIVE LOSS FUNCTIONS
453
subject to constraints
l
l
LO't = La;,
i=\
i=\
Os at s C,
i = 1,
, £,
oS 0'; S C,
i = 1,
, £.
From (11.28) it is easy to see that for any i = 1, ... , £ the equality
at x 0'; = 0
holds true. Therefore, for the particular case where 8 = 0 and y; E {-1, 1},
the considered optimization problems coincide with those described for pat-
tern recognition in Chapter 10, Section 10.4. We use this solution in Chapter
13 for solving real-life problems.
Case k = 2. To find the solution (coefficients of expansion at, O'i in (11.27))
for the case k = 2, one has to maximize the quadratic form
l
l
W(O',O'*) = - L
8i(O'i + an + Ly;(O't - ad
i=\
i=\
subject to constraints
;=\
at ~ 0,
0" > 0
1_
,
;=1
i=I,
,£,
i=1,
,£.
11 .3.3
Solution for the Huber Loss Function
Lastly, consider the SV machine for the Huber loss function
for Igi s c,
for Igi > c.
Let us minimize the functional

454
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
subject to constraints
Yi - (w *Xi) - b::; gt,
i = 1, ... ,£,
(w*xi)+b-y;-::;g;,
i=I,,,.,£,
g;*2:0,
i=I, ... ,£,
gi2:0,
i=I,,,.,£.
For this loss function, to find the desired linear function
f
(wo *x) + b = l)at - a;)(x; *x) + b,
;=1
one has to find the coefficients at and aj that maximize the quadratic form
W(a, a*)
f
LYi(at - ai)
i=1
subject to constraints
f
f
Lat = La;,
i=1
;=1
o::; at -::; C,
i = 1, .", £. .
When c = e < 1 the solution obtained for the Huber loss function is close
to the solution obtained for the e-insensitive loss function. However, the
expansion of the solution for the ,e;-insensitive loss function uses fewer support
vectors.
11.4
SV MACHINES FOR FUNCTION ESTIMATION
Now we are ready to construct the support vector machine for real-valued
function estimation problems. As in the pattern recognition case, we map
the input vectors x into high-dimensional feature space Z where we consider
linear functions
f
f(x, (3) = (z * w) + b = Lf3;(z * Zj) + b.
;=1
(11.29)

11.4 SV MACHINES FOR FUNCflON ESTlMAflON
455
As in the pattern recognition case we will not perform the mapping ex-
plicitly. We will perform it implicitly by using kernels for estimating the inner
product in feature space. To construct the linear function (11.29) in feature
space Z we use results obtained in the previous section with only one cor-
rection: In all formulas obtained in Section 11.3 we replace the inner product
in input space (Xi * Xj) with the inner product in feature space described by
the corresponding kernel K(xj,xj) satisfying Mercer's condition. (For kernel
representation of inner products in feature space see Chapter 10, Section
10.5.)
Therefore our linear function in feature space (11.29) has the following
equivalent representation in input space:
p
f(x,{3) = L{3iK(x,Xi)+b,
;=1
(11.30)
where {3i, i = 1, '" e, are scalars; Xi, i = 1, ".,e, are vectors; and K (x, x;) is a
given function satisfying Mercer's conditions.
To find functions of form (11.30) that are equivalent (in feature space) to
the function (11.29) we use the same optimization methods that were used
in Section 11.3.
11.4.1
Minimizing the Risk for a Fixed Element of the Structure in
Feature Space
As in Section 11.3.1, consider the structure on the set of linear functions
defined by the norm of coefficients of linear functions in a feature space:
(11.31 )
Suppose that we are given the observations
(YI,XI), .", (Yp,xr),
which in the feature space are
(YI, zd, "', (yp, Zr).
To find an approximation of the form (11.30) that is equivalent to a linear
function minimizing the empirical risk functional in feature space
1
p
Remp(w, b) = £L IYi - (w * Zi) -
bl~l'
i=1
subject to constraint (11.31), one has to find coefficients
i = 1, ..., f

456
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
of expansion
f
(3 = L{3;z;,
;=1
where at, a;, and yare the parameters that maximize the following func-
tionals:
Case k = 1. For the linear e-insensitive loss function one has to maximize
the functional
W(a, a*, y)
subject to the constraint
and to the constraints
f
f
- L
e;(a;* + ai) + LYi(a;' - ai)
i=1
i=1
f
-A
L
(at - ai)(a; - aj)K(x;, Xj)
i,j=l
f
f
Lat = La;
i=1
i=1
(11.32)
(11.33)
o ~ at ~ 1,
0 ~ a; ~ 1,
i=I, ...,f..
(11.34)
Case k = 2. For the quadratic e-insensitive loss function, one has to maxi-
mize the functional
f
f
W(a, a*, y) =
- L
ei(at + a;) + LYi(at - ai)
i=1
;=1
f
f
-A
L(at - ai)(a; - aj)K(x;,xj) -
~ L[(a;*)2 + all
;.j=1
;=]
(11.35)
subject to constraints (11.33) and (11.34). (Compare to results of Section 4.1.)
11.4.2
The Basic Solutions in Feature Space
To find function (11.30) that is equivalent to one that minimizes the functional
k = 1, 2
(11.36)

11.4 SV MACHINES FOR FUNCTION ESTIMATION
457
subject to constraints
IYi - (w *zdl :s 8i + ~i,
one has to find
(3i = at - ai,
where the parameters are such that:
i = 1, ... ,f.,
i=l, ...,f.,
(11.37)
Case k = 1. Parameters at and ai maximize the function
f
f
W(a, a*) = - L
8i(a;" + a;) + LYi(at - a;)
i=1
i=1
f
-
~ ~(a* - a·)(a* - a·)K(x· x·)
2 L
I
I}
}
Il}
i,j=1
subject to the constraint
i=1
i=1
and to the constraints
0::; at ::; C,
o::; ai
::; C,
i = 1,
,f.,
i=l,
,f..
Case k = 2. Parameters at and ai maximize the quadratic fonn
f
f
W(a,a*) = -8 L(ai+at)+LYi(at-ai)
i=1
i=1
subject to constraints
f
f
Lat = Lai,
i=1
i=1
at 2':0,
i=l,
,f.,
ai 2': 0,
i = 1,
,f..
When 8 = 0 and

458
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
is a covariance function of a stochastic process with
Ef(x) = 0,
the obtained solution coincides with the so-called krieging method developed
in geostatistics (see Matheron, 1973).
11 .4.3
Solution for Huber Loss Function in Feature Space
To minimize functional
subject to constraints
Yi-(W*Zi)-b::;~t,
i=1,
,£,
(w*zi)+b-Yi::;~i,
i=1,
,£,
~t~o,
i=1,
,£,
~i
~ 0,
i = 1,
, £
with the Huber loss function
for
I~I ::; e,
for
I~I > e,
one has to find the parameters f3 = at - ai, i = 1, ..., £, that maximize the
functional
W(a, a*)
f
LYi(at-ai)
i=]
subject to constraints
P
f
Lat = Lai
i=1
i=l
o::; a, at ::; C,
i = 1, ...,£.

11.4 SV MACHINES FOR FUNCTION ESTIMATION
459
11.4.4
Linear Optimization Method
As in the pattern recognition case, one can simplify the optimization problem
even more by reducing it to a linear optimization task. Suppose we are given
data
(yt, Xl), ..., (Xf, Xf)·
Let us approximate functions using functions from the set
I
y(x) = L f3i K(Xi, x) + b,
i=l
where f3i is some real value, Xi is a vector from a training set, and K (Xi, X) is
a kernel function. We call the vectors from the training set that correspond
to nonzero f3i the support vectors. Let us rewrite f3i in the form
where at > 0, ai > O.
One can use as an approximation the function that minimizes the func-
tional
f
f
f
(
W (a, ~i) = L ai +L at + CL
~i + CL
~/
i=l
i=l
i=l
i=l
subject to constraints
i = 1, ..., £,
g/ ~ 0,
f
Y· - "'(a* - a·)K(x· x·) - b < e -
t:*
1
L.J
J
J
1 ,
J
-
~I
j=l
f
"'(a~ - a·)K(x x·) + b - y. < e -
t:.
L.J
J
J
I'
J
1
-
~/'
j=l
The solution to this problem requires only linear optimization techniques.
11.4.5
Multi-Kernel Decomposition of Functions
Using the linear optimization technique, one can construct a method of multi-
kernel function approximation that using data
constructs the SV approximation with a small number of support vectors.

460
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
Consider p kernel-functions
We seek a solution that has the following form
f
P
f(x) = L
L
Km(x,xi)(a/(m) - aj(m)) + b,
i=1 m=1
where coefficients aj (m), aj(m) and slack variables ~i, ~t minimize the func-
tional
f
P
f
f
R = L
L(ai(m) + a*(m)) + CL~i + CL ~t
i=1 m=1
i=1
i=1
subject to constraints
f
P
Yi - L
L
Km(Xj,xi)(aj(m) - aj(m)) - b ~ 8i + ~i,
j=1 m=1
f
p
L
L
Km(xj, xi)(aj(m) - aj(m)) + b - Yi :s 8i + ~t,
;=1 m=1
i = 1, ... ,£
i = 1, ... , £
aj(m) ?O, aj ? 0, j = 1, ... ,£,
m= 1, ... ,p
The idea of a multi-kernel decomposition was suggested to solve the density
estimation problem (see Weston et aI., 1998).
11.5
CONSTRUCTING KERNELS FOR ESTIMATION OF REAL-VALUED
FUNCTIONS
To construct different types of SV machines, one has to choose different
kernels K(x, Xi) satisfying Mercer's condition.
In particular, one can use the same kernels that were used for approxima-
tion of indicator functions:
1. Kernels generating polynomials:
K(x, Xi) = [(X *Xi) + l]d.
2. Kernels generating radial basis functions:
for example,

11.5 CONSTRUCl'ING KERNELS FOR ESl'IMATION OF REAL-VALUED FUNCl'IONS
461
3. Kernels generating two-layer neural networks:
K(x, Xi) = S(V(X *Xi) + c),
C ~ v, Ilxll = 1.
On the basis of these kernels, one can obtain the approximation
l
f(X, av) = LJ3;K(x, X;) + b
i=1
(11.38)
II
using the optimization techniques described above.
In the pattern recognition problem we used function (11.38) under the
discrimination sign; that is, we considered functions signlf(x, a)].
However, the problem of approximation of real-valued functions is more
delicate than the approximation of indicator functions (the absence of sign{·}
in front of function f(x, a) significantly changes the problem of approxima-
tion).
Various real-valued function estimation problems need various sets of
approximating functions. Therefore it is important to construct special ker-
nels that reflect special properties of approximating functions.
To construct such kernels we will use two main techniques:
1. Constructing kernels for approximating one-dimensional functions and
2. Composition of multidimensional kernels using one-dimensional ker-
nels.
11.5.1
Kernels Generating Expansion on Polynomials
To construct kernels that generate expansion of one-dimensional functions
in the first N terms of orthonormal polynomials Pi(x),i = 1, ...,N, one can
use the following Christoffel-Darboux formula
K (
) - L
n
P ( )P (y) _
PII+1(x)PII(y) - PIl(x)PIl+1(y)
II X, Y
-
k X
k
-
all
,
x-y
k=1
(11.39)
Kn(x, x) = L pl(x) = an[p~+1 (x)Pn(x) -
P~(X)Pn+1 (x)],
k=1
where an is a constant that depends on the type of polynomial and the number
n of elements in the orthonormal basis.
One can show that by increasing n, the kernels K(x, y) approach the 5-
function. Consider the kernel
K(x, y) = L r; t/Ji (X)t/Ji (y),
i=1
(11.40)

462
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
where 'i > 0 converges to zero as i increases. This kernel defines regularized
expansion on polynomials.
We can choose values'i such that they improve the convergence properties
of series (11.40). For example, we can choose 'i = qi, O:S q :S 1.
Example. Consider the (one-dimensional) Hermite polynomials
(11.41)
where
and Ji-k are normalization constants.
For these polynomials, one can obtain the kernels
K(x,y) = LqiHi(x)Hi(y)
i=()
1
{2xyq
(x _ y)2q2}
= vi1T(1 - q2) exp
1 + q -
1 - q2
(Titchmarsh, 1948; Mikhlin, 1964).
(11.42)
To construct our kernels we do not even need to use orthonormal bases. In
the next section, we use linearly independent bases that are not orthogonal
to construct kernels for spline approximations.
Such generality (any linearly independent system with any smoothing
parameters) opens wide opportunities to construct one-dimensional kernels
for SV machines.
11.5.2
Constructing Multidimensional Kernels
Our goal is to construct kernels for approximating multidimensional functions
defined on the vector space X C RN where all coordinates of vector x =
(x I, "', x
N
) are defined on the same finite or infinite interval [.
Suppose now that for any coordinate x k the complete orthonormal basis
h" (x k ), i = 1,2, "', is given. Consider the following set of hasis functions:
(11.43)
in the n-dimensional space. These functions are constructed from the coordi-
natewise basis functions by direct multiplication (tensor product) of the basis
functions, where all indexes ik take all possible integer values from 1 to 00.

11.5 CONSTRUCTING KERNELS FOR ESTIMAl'ION OF REAL-VALUED FUNCTIONS
463
It is known that the set of functions (11.43) is a complete orthonormal basis
in Xc R".
Now let us consider the more general situation where a (finite or infinite)
set of coordinatewise basis functions is not necessarily orthonormal. Consider
as a basis of n-dimensional space the tensor product of coordinatewise basis.
For this structure of multidimensional spaces the following theorem is true.
Theorem 11.1. Let a multidimensional set offunctions be defined by the basis
functions that are tensor products of coordinatewise basis functions. Then the
kernel that defines the inner product in the n-dimensional basis is the product
of n one-dimensional kernels.
Proof Consider two vectors x = (Xl, ...,x") and y = (yl, ...,y") in n-dimen-
sional space. According to the definition the kernel describing the inner
product for these two vectors in the feature space is
= '" b·
.
(xl
x"-I)b·
.
(yl
II-I)b· (x")b (y")
L.J
l}, ... ,ln-t
, ••• ,
11,... ,111 -1
, ••• ,y
In
III
= '" b
.
(Xl
x"-I)b·
.
(yl
II-I) '" b· (x")b· (yll)
L.J
11 .....1"-1
, ••• ,
11,,,.,111-1' ••• ,y
L.J
I"
In
KI(X", y") L
bil,...,in_JXI, ...,x"-I)bil,...,in_l (yl, ...,y"-I).
it .... ,in - I
Reiterating this convolution, we obtain
II
K(x,y) =II Kk(Xk,yk).
k=1
The theorem has been proved.
(11.44)
Continuation of Example. Now let us construct a kernel for the regular-
ized expansion on n-dimensional Hermite polynomials. In the example dis-
cussed above we constructed a kernel for one dimensional Hermite polyno-
mials. According to Theorem 11.1 if we consider as a basis of n-dimensional
space the tensor product of one dimensional basis-functions then the kernel
for generating n-dimensional expansion is the product of none-dimensional
kernels
K(x,y)
(11.45)

464
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
Thus, we obtained a kernel for constructing semilocal approximations:
8, fT > 0,
(11.46)
where the multiplier with the inner product of two vectors defines "global"
approximation since the Gaussian defines the vicinity of approximation (com-
pare to the result of Chapter 6, Section 6.6 for local function approximation).
11.6
KERNELS GENERATING SPUNES
Below we introduce the kernels that can be used to construct a spline approx-
imation of high-dimensional functions. We will construct splines with both a
fixed number of knots and an infinite number of knots. In all cases the compu-
tational complexity of the solution depends on the number of support vectors
that one needs to approximate the desired function with t:-accuracy, rather
than on the dimensionality of the space or on the number of knots.
11.6.1
Spline of Order d with a Finite Number of Knots
Let us start by describing the kernel for approximation of one-dimensional
functions on the interval [0, a] by splines of order d 2°with m knots:
ia
(. -
-
,- m'
i=1, ... ,m.
According to the definition, spline approximations have the form (Fig 11.2)
d
m
f(x) = I~>;xr +L a; (x -
t;)~.
r=O
;=1
(11.47)
Consider the following mapping of the one-dimensional variable x into an
(m + d + 1)-dimensional vector u:
X ----7 U = (1,x, ...,xd, (x -
tl)~' ... , (x -
tm)~),
where we denote
if x :::; tk-
if x > tk'
Since spline function (11.47) can be considered as the inner product of two
vectors
f(x) = (a * u)

11.6 KERNElS GENERATING SPLINES
465
y
/
I
/
I
I
/
/
I
/
I
/
/
/
I
/
I
/
I
/
I
I
/
I
I
/
/
I
I
I
I
/
I
I
,I
I
I
/
t3 •••.....••.... tm
x
I
/
/
FIGURE 11.2. Using an expansion on the functions 1,x, (x - td+, ... , (x - tm)+, one can
construct a piecewise linear approximation of a function. Analogously, an expan-
sion on the functions 1, x, ...,xd, (x -
11 )~, ... , (x -
tm)~) provides piecewise polynomial
approximation.
(where a = (ao, ...,am+d)), one can define the kernel that generates the inner
product in feature space as follows:
d
m
K(x, x,) = (u * u,) = Lxrxj + L(x -
ti)~(Xt -
td~·
r=O
i=l
(11.48)
Using the generating kernel (11.48), the SV machine constructs the function
f
[(x, f3) = L f3i K (x, Xi) + b,
i=1
that is, a spline of order d defined on m knots.
To construct kernels generating splines in n-dimensional spaces, note that
n-dimensional splines are defined as an expansion on the basis functions that
are tensor products of one dimensional basis functions. Therefore according
to the Theorem 11.1, kernels generating n-dimensional splines are the product
of n one-dimensional kernels:
n
K(X,Xi) =II K(xk ,x7),
k=l
where we denoted x = (xl, ...,xk ).
11.6.2
Kernels Generating Splines with an Infinite Number of
Knots
In applications of SV machines the number of knots does not play an im-
portant role (the values of Ci are more important). Therefore to simplify the

466
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
calculation, we use splines with an infinite number of knots defined on the
interval (0, (I), 0< a < 00, as the expansion
d
r
I(x) = ~aixi + 10 a(t)(x -
t)~ dt,
where ai, i = 0, .. ,d, are unknown values and aCt) is an unknown function that
defines the expansion. One can consider this expansion as an inner product.
Therefore one can construct the following kernel for generating splines of
order d with an infinite number of knots:
(11.49)
where we denote min(x, Xi) = (X 1\ Xi). In particular for the linear spline
(d = 1) we have
Again the kernel for n-dimensional splines with an infinite number of knots
is the product of the n kernels for one-dimensional splines.
On the basis of this kernel, one can construct a spline approximation (using
the techniques described in previous section) that has the form
f
I(x, f3) = L f3i K (X, Xi).
i=1
11.6.3
Bd-Spline Approximations
In computational mathematics an important role belongs to the so-called Bd-
spline approximations. There are two ways to define Bn splines: By iterative
procedure or as a linear combination of regular splines.

11.6 KERNELS GENERATING SPLINES
467
Definition 1. Let us call the following function Bo spline (B spline of order
0):
{
I
if lui ~ 0.5,
Bo(u) =
0
if lui> 0.5.
The Bd spline of order d we define as a convolution of two functions: Bd - I
spline and Bo spline:
(11.50)
Definition 2. The Bd(u) spline has the following construction:
d+1 (-1)'
r
(
d + 1
) d
Bd(u) = L
~Cd+1
U + -2- - r
.
r=O
+
One can show that both definitions describe the same object.
Using Bd splines, one can approximate functions by expansion:
N
f(x,{3) = L{3iBd(X - ti),
i=1
where ti, i = 1, .., N, defines knots of expansion. Since this expansion has the
form of an inner product, the kernel that generates B-spline expansion is
N
K(X,Xi) = L
Bd(x - tk)Bd(Xi - tk)'
k=1
There is a good approximation for a Bd spline:
(11.51)
The approximation becomes better with increasing d, but is surprisingly good
even for d = 1. See Fig. 11.3.
1
-0.25
-2
o
2
4
6
0.75
-0.25
-4
-2
0
2
4
6
8
FIGURE 11.3. Basplines and their approximations by the Gaussians.

468
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
11 .6.4
Bd Splines with an Infinite Number of Knots
Consider now an expansion of the form
f(X) --:::I: </J(t)Bd(x - t) dt,
(11.52)
where Bd(x - t) is a Bd spline and </J(t) is a function that defines the
approximation f(x). For any fixed value x the expression (11.52) describes the
inner product between two functions. Therefore the inner product between
two Bd splines that defines the desired kernel has the form
K(x;,Xj) = I: BAx; - t)Bd(Xj - t) dt
I: Bd(x; - t)Bd(t - x) dt
B2d+\ (x; - Xj)
(the second equality is due to the fact that Bd splines are symmetric functions,
and the third equality is due to definition 1 of the Bd(x) splines). Thus the
kernels for constructing one-dimensional Bd splines are defined by a B2d+\
spline.
Again, the kernel for n-dimensional Bd splines is the product of n one-
dimensional kernels:
n
K(xj,xj) = II B2d+1(X[ - xj).
r=!
Taking into account approximation (11.51), we obtain that
Thus, the kernel for constructing Bd splines can be approximated by Gaussian
function.
11.7
KERNELS GENERATING FOURIER EXPANSIONS
An important role in signal processing belongs to Fourier expansions. In this
section we construct kernels for SV Fourier expansions in multidimensional
spaces. As before we start with the one-dimensional case.

11.7 KERNELS GENERATING FOURIER EXPANSIONS
469
Suppose we would like to analyze a one-dimensional signal in terms of
Fourier series expansion.
Let us map the input variable x into the (2N + 1)-dimensional vector
u = (I/Vl, sinx, "', sinNx, cosx, "', cosNx).
Then for any fixed x the Fourier expansion can be considered as the inner
product in this (2N + 1)-dimensional feature space:
N
f(x) = (a * u) = a;;. + L
(ak sin kx + bkcos kx).
v2
k=l
(11.53)
Therefore the inner product of two vectors in this space has the form
N
KN (x, x;) = ~ + L(sinkxsinkx; + coskxcoskx;).
k=1
After obvious transformations and taking into account Dirichlet function (see
Chapter 6, Section 6,5), we obtain
,
(2N + 1)
1
N
sm
2
(x - x;)
KN(X,X;)=2+Lcosk(x-x;)=
. (x-x;)
k=1
sm --'-------2-----'--
To define the signal in terms of the Fourier expansion, the SV machine uses
the representation
l
f(x,{3) = L{3;KN (x,x;).
;=1
Again, to construct the SV machine for the d-dimensional vector space
x = (xl, ...,x"), it is sufficient to use the generating kernel that is a product
of one-dimensional kernels:
"
K(x,x;) = II K(xk ,xf)·
k=1
11.7.1
Kernels for Regularized Fourier Expansions
In Section 6.5, when we considered approximation of the functions by Fourier
expansions, we pointed out that the Dirichlet kernel does not have good ap-
proximation properties. Therefore we considered two other (regularized) ker-

470
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
nels: the Fejer kernel and the Jackson kernel. The following introduces two
new kernels that we use for approximation of the multidimensional functions
with SV machines.
Consider the following regularized Fourier expansion:
oC!
f(x) =
a~ + Lqk(akcoskx + bksinkx).
v2
k=1
0< q < 1,
where ak and bk are coefficients of the Fourier expansion. This expansion
differs from expansion (11.53) by multipliers qk that provide a mode of reg-
ularization (see Fig. 11.4). The corresponding kernel for this regularized ex-
pansion IS
K(x;, Xj)
lOG
2" + L
qk (cos kXr cos kXj + sin kx; sin kXj)
k=!
1
00
1
2
2+Lqkcosk(x;-Xj)=2(12
(q
)
2)'
k=!
-
qcos X; -Xj +q
(For the last equality see Gradshteyn and Ryzhik (1980).)
Consider also the following regularization of the Fourier expansion:
f( ) ::-:: ~
~ Uk cos kx + bk sin kx
X
M + L....J
1+
2k2
'
v2
k=!
'Y
where ak and bk are coefficients of the Fourier expansion (see Fig. 11.5). This
regularizer provides another mode of regularization than the first one. For
3
2
1
oL-_.l...--_--L-_---'--_--'
-1
3
2
-1
-1
q=1/2
q=2/3
q=3/4
FIGURE 11.4. Kernels for various values of q.

11.8 THE SUPPORT VECTOR ANOVA DECOMPOSITION
471
8
8
8
7
I
I
7
7
6
I
6
6
5
5
5
4
I
4
4
3
3
3
2
)\\.
2
2
1
I
I
1
1
0
0
0
-1
1
-1
-1
r = 1/5
r = 1/2
r =3/4
FIGURE 11.5. Kernels for various values of y.
this type of regularized Fourier expansion we have the following kernel:
= 2y
0< Ix·-xl <21T'.
-
I
J_
(For last equality sec Gradshteyn and Ryzhik (1980).)
Again the kernels for multidimensional Fourier expansion is the product
of the kernels for one-dimensional Fourier expansions.
11.8
THE SUPPORT VECTOR ANOVA DECOMPOSITION (SYAD) FOR
FUNCTION APPROXIMATION AND REGRESSION ESTIMATION
The kernels defined in previous sections can be used both for approximating
multidimensional functions and for estimating multidimensional regressions.
However, they can define a too rich set of functions. Therefore to control
generalization, one needs to make a structure on this set of functions in
order to choose the function from an appropriate element of the structure.
Note also that when the dimensionality of the input space is large (say 100),
the values of an n-dimensional kernel (which is the product of an n one-
dimensional kernels) can have an order of magnitude qn. These values are
inappropriate for both cases when q > 1 and q < 1.
Classical statistics considered the following structure on the set of multi-
dimensional functions from L 2, the so-called ANOVA (acronym for analysis
of variances) decomposition.
Suppose that an n-dimensional function [(x) = [(x I, ... , x n) is defined on
the set I x I x ... xl, where I is a finite or infinite interval.
The ANOVA decomposition of function [(x) is an expansion
[(Xl, ...,xn) = Fo + F] (Xl, ... ,xn) + F2(X1, ...,xn) + ... + Fn(x l, ...,xn),

472
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
where
Fa = c,
"
F[(x l , ••• ,x") = L
r/lk(Xk),
I~k~"
6(x l , ... ,x") =
Fr(x l, ...,x") =
L
4>kl,....k,(Xkl,Xk2, ...,Xk,),
l:Skl<k2< .. ·k,~"
F"(x l , ..• , x") = 4>kl,....kll (Xl, ...,x").
The classical approach to ANOVA decompositions has a problem with the
exponential explosion of the number of summands with increasing order of
approximation. In Support Vector techniques, we do not have this problem.
To construct the kernel for the ANOVA decomposition of order p using a
sum of products of one-dimensional kernels K(xi, x~), i = 1, ... ,n
one can introduce a recurrent procedure for computing K p (x, xr ), p = 1, ...,n.
Let us denote
"
KS(x,xr) = LKS(Xi,X~).
i=1
One can easily check that the following recurrent procedure define the ker-
nels Kp(x,xr), p = 1, ... ,n:
Ka(x, xr) = 1,
K1(x,xr) =
L
K(Xi,X~) = KI(x,xr),
I~i~"
K2(x,xr) =
L
K(Xil,X~I)K(Xi2,X~2)
I:Sil<i2:S"

11.9 SV METHOD FOR SOLVING UNEAR OPERATOR EQUATIONS
473
In general case we havet
To construct SV ANaVA decomposition with orthogonal expansion, one
has to use one-dimensional generating kernels constructed from an orthogo-
nal basis (e.g., the kernel defined by Eq. (11.42) if one considers an infinite
interval I or corresponding kernels for regularized Fourier expansion if one
considers a finite interval I).
Using such kernels, and the SV method with L 2 loss function, one can
obtain an approximation of any order.
However, it is important to perform ANaVA decomposition for approx-
imations that is based on RBF or splines with infinite number of knots. For
such approximations the ANaVA decomposition is not orthogonal and one
can approximate the target function well using only one term Fp(x I, ''', x n) (of
appropriate order). Using the SV method with L I e-insensitive loss-function
and the corresponding generating kernel Kp(x, Xi) one obtains such approx-
imations.
11.9
SV METHOD FOR SOLVING LINEAR OPERATOR EQUATIONS
This section uses the SV method for solving linear operator equations
At(l) = F(x),
(11.54)
where operator A realizes a one-to-one mapping from a Hilbert space £1
into a Hilbert space £2.
We will solve equations in the situation where instead of function F(x)
on the right-hand side of (11.54) we are given measurements of this fuction
(generally with errors)
(XI, FI ), ... , (Xl, Fl ).
(11.55)
It is necessary to estimate the solution of Eq. (11.54) from the data (11.55).
The following shows that the SV technique realizes the classical ideas of
solving ill-posed problems where the choice of the kernel is equivalent to the
choice of the regularization functional. Using this technique, one can solve
operator equations in high-dimensional spaces.
11.9.1
'rhe SV Method
In Appendix to Chapter 1, we formulated the regularization method of solv-
ing operator equations, where in order to solve operator Eq. (11.54) one
t "A New Method for Constructing Artificial Neural Networks" Technical Report ONR Contract
NOOO14-94-C-0l86 Data Item AOO2. May 1, 1995. Prepared by C. Burges and V. Vapnik.

474
"
THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
minimizes the functional
Ry(f, F) = p2(Af, F) + yW(f),
where solution belongs to some compact W(f) ::; C (C is unknown constant).
When one solves operator Eq. (11.54) using data (11.55) one considers the
functional
1
f
Ry(f, F) = £L L(Af(t) lx, - Fi ) + yep f * Pf)
;=1
with some loss function L(Af - F) and regularizer of the form
W (f) = (Pf *Pf)
defined by some nongenerating operator P, Let
(f>} (t), .." C/'n(t), ...
be eigenfunctions and eigenvalues of the selfconjugate operator P * P
P *P 'Pi = Ai 'Pi .
Consider the solution of Eq. (11.54) as the expansion
Putting this expansion into functional Ry(f, F) we obtain
Denoting
we can rewrite our problem in the familiar form: minimize the functional
1
f
Ry(w, F) = f L L(IA(w * <I>(t»lx=x, - Fd) + yew * w)
i=1
in the set of functions
f(t, w) = L wrcPr(t) = (w * <I>(t»,
r=1
(11.56)

11.9 SV METHOD FOR SOLVING LINEAR OPERATOR EQUATIONS
475
where we denote
w
<1>(t)
(11.57)
The operator A maps this set of functions into the set of functions
00
00
F(x, w) = Af(t, w) = L
w,Aq,,(t) = L
w,I/I,(x) = (w * 'I'(x)),
(11.58)
,=1
,=1
which is linear in the feature space
'I'(X) = (1/11 (x), ..., I/IN(X), ...),
where
I/I,(X) = Aq,,(t).
To find the solution of Eq. (11.54) in a set of functions f(t, w) (to find the
vector coefficients w), one can minimize the functional
p
D(F) = C L
(IF(Xi, w) - Fi le)k + (w * w),
i=l
k = 1,2
in the image space that is in the space of functions F(x, w).
Let us define the generating kernel in the image space
00
K(Xi,Xj) = L
I/I,(Xi) 1/1,(Xj)
,=0
and the so-called cross-kernel function
00
IC(Xi, t) = L
l/J,(Xi)q,,(t)
,=0
(11.59)
(11.60)
(here we suppose that the operator A is such that the right-hand side con-
verges uniformly for x and t).
Note that in this case the problem of finding the solution to the operator
equation (finding the corresponding vector of coefficients w) is equivalent to
the problem of finding vector w for the linear regression function (11.58) in
the image space using measurements (11.55).
Let us solve this regression problem using the quadratic optimization SV
technique. That is, using kernel (11.59), one can find both the support vectors
Xi, i = 1, ...,N, and the corresponding coefficients at - ai that define the
vector w for the SV regression approximation:
N
W = L(at - ai)'I'(xJ.
i=l

476
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
Note that the same coefficients w along with regression in image space
define the approximation to the desired solution in preimage space. There-
fore putting these coefficients in the expression (11.56), one obtains
N
f(t, a, a*) = L(at - a;)K(x;, t).
;=1
That is, we find the solution to our problem of solving the operator equation
using the cross-kernel function as an expansion on support vectors.
Therefore in the SV technique for solving operator equations the choice of
the kernel function is equivalent to the choice of the regularization functional.
The cross-kernel function is constructed taking into account the regulariza-
tion functional and the operator.
Therefore in order to solve the linear operator equation using the SV
method:
1. Define the corresponding regression problem in image space.
2. Construct the kernel function K (x;, Xj) for solving the regression prob-
lem using the SV method.
3. Construct the cross-kernel function K(x;, t).
4. Using the kernel function K(x;, Xj), solve the regression problem by
the SV methodt (i.e., find the support vectors x;, i = 1, ...,N, and the
corresponding coefficients f3; = (at - a;), i = 1, "', N .
5. Using these support vectors and the corresponding coefficients, define
the solution
N
f(t) = L f3rK(xr , t).
r=l
(11.61 )
Steps 1-3 (constructing regression problem, constructing kernel in image
space, and constructing corresponding cross-kernel function) reflect the spe-
cific problem at hand (they depend on operator A). Steps 4 and 5 (solving
the regression problem by SV machine and constructing the solution to the
desired problem) are routine.
The main problem with solving operator equations using the SV tech-
nique is for a given operator equation to obtain both the explicit expression
for the kernel function in image space and the explicit expression for the
corresponding cross-kernel function. In the next section, which is devoted to
solving special integral equations that fonn the (multidimensional) density
estimation problem, we construct such pairs.
In Chapter 13, which is devoted to the application of the SV method
to real-function estimation problems, we construct such a pair for another
t Note that since in (11.58) coefficient b = 0, the constraint L: at =L: a; in the optimization
problem should be removed.

11.9 SV METHOD FOR SOLVING LINEAR OPERATOR EQUATIONS
477
problem of solving operator equations-for solving the Radon equation for
positron emission tomography (PET).
For solving these operator equations, we will use functions of Hilbert
spaces that are defined in a form slightly different from the form considered
above; that is, we will look for the solution of the operator equation
Af(t) = F(x)
in the set of functions
f(t) = / g(r)l/J(t, r)dr,
where l/J(t, r) is a given function and g(r) can be any function from some
Hilbert space. To find the solution means to estimate the function g(r) (in-
stead of infinite dimensional vector as above). Let us denote
Al/J(t,r) = </>(x,r)
and rewrite our equation as follows:
/ g(r)</>(x,r)dr = Fg(x).
(assume that </> (x, r) is such that for any fixed x function,
</> (x, r) belongs
to L 2). Since for any fixed x the left-hand side of the equation is the inner
product between two functions of the Hilbert space, one can construct the
kernel function
K(xj,xj) = /
</>(Xj, r)</>(xj, r) dr
and cross-kernel function
K(x,t) = / l/J(t,r)</>(x,r)dr.
These functions are used to obtain the solution:
f(t) = L {3jK(xj, t),
j
where coefficients {3j =
a j* -
aj are found using standard SV techniques with
the kernel K(Xi' Xj)'
This solution of the operator equation reflects the following regularization
idea: It minimizes the functional
f
R(g) = CL IFg(x;) - Fi I~ + (g *g),
i=1
k = 1,2.
In the remaining part of this section we discuss some additional oppor-
tunities of the SV technique that come from the ability to control the
e-insensitivity.

478
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
11.9.2
Regularization by Choosing Parameters of Ei-Insensitivity
Until now, when we considered the problem of solving operator equations,
we ignored the fact that it can be ilI-posed-for example, if our equation is
a Fredholm integral equation of the first kind (see Chapter 1, Section 1.11).
Now this feature is the subject of our interest.
Chapter 7 considered methods of solving stochastic ill-posed problems by
using the regularization method (see also Appendix to Chapter 1). According
to the regularization method, in order to find a solution of the operator
equation
Af=F
(11.62)
(that forms an ill-posed problem) in a situation where instead of the right-
hand side of the equation the approximation Ff is given, one has to minimize
the functional
in a set of function {f}. In this functional the term W (f) is the regularization
functional and the parameter 'Yf is the regularization constant. One of the
most important questions in solving an ill-posed problem is how to choose
the value 'Yf'
To choose this constant Morozov (1984) suggested the so-called residual
principle: Suppose that one knows that the accuracy of the approximating
function Ff obtained from the data does not exceed e; then one has to min-
imize the regularization functional W (f) subject to constraint
IIAf - Fill ~ e.
(11.63)
By using the e-insensitive loss function the SV method of solving operator
equation realizes this idea in the stronger form: For sufficiently large C it
minimizes the regularization functional (norm of the vector of coefficients of
linear function in feature space) subject to constraint
IF(x) - FI < e-
I
I
~
"
i = 1, ...,t.
Such a mode of regularization is used when one has information on the
accuracy ej of the measurements in any point of approximation. As we will
see in the next section, in the problem of density estimation as well as in the
PET problem discussed in Chapter 13 simultaneously with data describing the
right-hand side of the equation, one can estimate the accuracy of obtained
data in any specific point. In other words, one has to solve the operator
equation given the triples
Using various values for e-insensitivity for various points (vectors) x, one
can control the regularization processes better.

11.10 SV METHOD OF DENSITY ESTIMATION
479
11.10
SV METHOD OF DENSITY ESTIMATION
Let us apply the SV method for solving linear operator equations to the
problem of density estimation. First we obtain a method for estimating one-
dimensional densities, and then using the standard approach we generalize
this method for estimating multidimensional densities. In this subsection, in
order to simplify the notations we consider the problem of density estimation
on the interval [0,1J.
As was shown in Chapter 1, Section 1.8, the problem of density estimation
is a problem of solving the integral equation
l) 8(x - t)p(t)dt = F(x),
where instead of distribution function F(x) the i.i.d. data are given:
Using these data, one constructs the empirical distribution functiont
1
l
Fr(x) = f. L 8(x - x;)
;=1
(11.64)
and instead of the right-hand side of (11.64) considers the measurements
(11.65)
One also adds the boundary conditions
(0,0),(1,1).
It is easy to check that for any point x* the random value FI (x*) is unbiased
and has the standard deviation
u*=
1
1
f.F(x*)(l - F(x*)) ~ 2v'i'
Let us characterize the accuracy of approximation of the value F(x;) by the
value Fl(x;) with
*
£; = CUi = C
where C is some constant.
t Empirical distribution function
1f.F(x;)(l - F(x; )),
(
Ff(x) = ~L O(x l - xi )...O(x" - x;')
;=1
in multidimensional case x = (xl, ...,x").

480
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
Since the distribution function F(x) is unknown, let us approximate e;* by
the value
where ~ > 0 is some small parameter. Therefore one constructs triplets:
(11.66)
11.10.1
Spline Approximation 0' a Density
We are looking for the solution of Eq. (11.64) as an expansion in a spline
function with an infinite number of nodes.
That is we approximate the unknown density by the function
where g(T) is a function to be estimated and ak, k = 0,1, ..,d, are the param-
eters to be estimated. To simplify formulas below we consider linear splines
(d = 1). The case of d i- 1 is completely analogous.
According to the SV method described in the previous section, to solve
linear operator equations we have to perform five steps, among which the
first three steps
1. Define the corresponding regression problem in image space
2. Construct the kernel function K (x, Xi)
3. Construct the cross-kernel function K(x, t)
are specific for the problem, while the last two steps are routine.
Below we consider the first three steps of solving the density estimation
problem.
Step 1. We define the regression problem as a problem of approximation of
the following function F(x) in image space:
F(x) = 1Ig (T) [Lx(t-T)+dt]dT+ LX(a1t+ao)dt
1
1
geT) [(X ~ T):] dT+ al;2 +a(}X
using the data (11.66).
Step 2. Since the last formula can be considered as an inner product, we

11.10 SV METHOD OF DENSITY ESTIMATION
481
construct the following kernel in image space:
1 rl
x?x?
K(Xi, Xj) = 4' 10 (Xi -
T)~ (Xj -
T)~ dT + ~ + XiXj
1 L(XlAx})
x 2x 2
-
(x· - T)2(x· - T)2 dT + _'_1 + X·X·
4
0
'
I
4'1
I
1
2 (Xi 1\ Xj)3
I
I(Xi 1\ Xj)4
(Xi 1\ Xj)5
xfx;
Xi -Xj
12
+ Xi -Xj
8
+
20
+ -4- +xiXj,
(11.67)
(Xi 1\ t)4
8
(11.68)
K(Xi, t) =
where we denoted by (Xi 1\ Xj) the minimum of two values Xi and Xj'
Step 3. We evaluate the cross-kernel function
1L
I
2
x
2t
-
(X' - T) (t - T) dT + -'- + x·
2
0
'
+
+
2
'
1 L(XI M )
2
x?t
x2t
-
(X, - T) (t - T)dT+ _1_ +X· = _1- +x·
2 0'
2
'
2
'
xTt(Xi 1\ t)
(2
2) (Xi 1\ t)2
(2
) (Xi 1\ t)3
+
2
-
xit + xi
4
+
Xi + t
6
Using kernel (11.67) and the triplets (11.66), we obtain the support vec-
tors Xk, k = 1, ..., N, and the corresponding coefficients f32 = a:' -
ak, k =
1, ...,N, that define the SV regression approximation:
N
F(x) = L f32K(Xi' x).
k=1
These parameters and cross-kernel function (11.68) define the desired SV
approximation of the density
N
p(t) = L f32K(Xk, t).
k=l
To solve the multidimensional problem of density estimation, one has to
construct a multidimensional kernel function and a multidimensional cross-
kernel function, which are products of one-dimensional kernel functions and
one-dimensional cross-kernel functions.
11 .10.2
Approximation of a Density with Gaussian Mixture
Consider the same method of density estimation in a set of functions defined
in [0, (0) as Gaussian mixtures:
1 /00
{ (t - T)2 }
p(t) = ~
g(T)exp
-
2
2
dT,
2~~
-00
~
(11.69)

482
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
where the functions g(r) defining the approximations belong to L 2, (J' is a
fixed parameter, and values (vectors) t are nonnegative.
Let us start with the one-dimensional case. Consider the regression space
for our density estimation problem
r
x
(1
r
{(t
r)2}
)
Fg(x) = J-X! g(r)
~(J' Jo exp
-
2(J'2
dt
dr.
Since for any fixed x this function has a structure of the inner product between
two functions in Hilbert space, one can define the kernel function
and the cross-kernel function
1
roo (
{(X - r)2} r'
{(t - r)2 }
)
K(xj, t) = 27r(J'2 J-00
exp
-
2(J'2
Jo
exp
-
2(J'2
dt
dr.
(11.71)
The important feature of the Gaussian mixture solution is that both the
kernel function and the cross-kernel function have a simple expression in
terms of erf functions
2 LX
erf(x) =;;;;.
e-t1dt
V 7r
0
and the integral from erf functions
interf(x) = lX erf(x') dx'.
The erf function is a smooth function that tabulated on computers. One can
also easily tabulate the integral of the erf function (let us call this function
the interf function).
Let us compute the kernel function (11.70). By changing the order of
integration, one obtains

11.10 SV METHOD OF DENSITY ESTIMATION
483
Vzu (1;; erf(u) du +1t" erf(u) du - 1\-':" erf(u) dU)
V2u [interf (;~) + interf (;~) - interf ('Xj2~xjl)] .
Analogously, one computes the cross-kernel function (11.71):
K(Xj, t)
1
LX' I
CJO I(x - t)2
(x; t - T) 2 )
--2
dx
exp
-
4
2
-
2
2
d T
27TU
0
-CJO
U
U
1
LX'
{(X - t)2 }
~
exp
-
4
2
dx
V 27TU
0
U
~ [erf ( x~~t) + erf (2~)].
Using these kernel and cross-kernel functions in the general scheme for
solving integral equations, one can estimate the density:
f(t) = L ~jK(xj, t),
(11.72)
where coefficients f3j = at - aj are obtained by solving the corresponding
regression problem on the basis of the obtained kernel function.
The interesting feature of this solution (10.72) is that in spite of the fact
that approximating functions are a mixture of Gaussians defined by (10.69),
the basis functions K(xj, t) in expansion (10.72) are not Gaussians. Figure
11.6 shows basis functions K(xj, t) for U= 1 and Xj = 0.2, 0.4, 0.6, 0.8, 1.
0.8
0.6
0.4
0.2
0.5
1
1.5
2
FIGURE 11.6. Cross-kernel function for a one-dimensional density estimation in a mix-
ture of Gaussians. For a = 1, curves correspond to parameters Xk = O.2k, k = 1..... S.

484
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
To estimate the multidimensional densities, one has to construct the multi-
dimensional kernel function and the multidimensional cross-kernel function.
As before, both multidimensional kernel function and multidimensional cross-
kernel functions are products of corresponding one-dimensional functions.
It should be noted that this structure of multidimensional kernels is not
necessarily valid for any operator equation. As we will see in Chapter 13,
in particular, it is not valid in the case of the Radon tomography equation.
To obtain the SV solution for the two-dimensional Radon equation, we will
construct a two-dimensional kernel and a two-dimensional cross-kernel func-
tion.
11.11
ESTIMA1'ION OF CONDITIONAL PROBABILITY AND
CONDITIONAL DENSITY FUNC1'IONS
11.11 .1
Estimation 0' Conditional Probability Functions
In Chapter 7, Section 7.12 we considered the problem of estimating the con-
ditional probability function using data
YE{-I,l}
(11.73)
as a problem of solving the equation
i
Z
p(y = liz) dF(z) = F(y = 1, z)
(11.74)
in the situation where the distribution functions F(z),
F(y = 1, z) are
unknown. To avoid the necessity of solving the high-dimensional integral
equation (11.74) on the basis of data (11.73), we considered the method of
estimating the conditional probability function along the line
z = Zo +e(t - to)
passing through a point of interest Zo, where the vector e defines the direc-
tion of the line. To estimate the conditional probability along this line, we
split vectors Zi from (11.73) into two elements (ti, Ui), where ti = (Zi *e) is a
projection of the vector Zi on the given direction e and Ui is an orthogonal
complement of the vector eti to the vector Zi. Let Zo = (to, uo)·
Therefore for the given direction e we constructed data
yE{-I,I},
(11.75)
which we used to solve the equation
it p(y = Ilt,uo)dF(tluo) = F(y = l,tluo).
(11.76)

11.11 ESTIMATION OF CONDITIONAL PROBABILITY AND CONDITIONAL DENSITY
485
To solve this equation we introduced the approximations (Section 7.12)
p
Fp(tluo) = LTi(UO)O(t - ti),
i=1
p
F,(Y = 1,tluo) LTi(Uo)O(t - ti)S(Yi),
i=1
(11.77)
(11.78)
(11.79)
(
) _
gy(lIui - uoll)
T; Uo -
P
,
~ gy(llui - uoll)
;=1
where gy(u) is a Parzen kernel (with parameters of width y) and S(y;) = 1 if
Yi = 1 and zero otherwise. In Chapter 7, Section 7.12 we described a method
for solving this equation on the basis of approximations (11.77) and (11.78).
However, we left undiscussed the problem of how to choose a good direction
e.
Now let us discuss this problem. Our goal is to split the space into two
subspaces: (1) a one-dimensional subspace that defines the most important
direction for changing the conditional probability and (2) an orthogonal com-
plement to this subspace. In our approximation we would like to take into
account more accurately the important one-dimensional subspace.
To implement this idea we use the results of a solution to the pattern
recognition problem to specify an important direction.t
First consider the case where a good decision rule is defined by a linear
function. In this case it is reasonable to choose as an important direction
one that is orthogonal to a separating hyperplane and as less important the
directions that are parallel to a separating hyperplane. (See Fig. 11.7)
In general, the SV method solves a pattern recognition problem using a
hyperplane in feature space, and therefore it is reasonable to choose the
direction e defined by the vector that specifies the optimal hyperplane.
It is easy to check that if the inner product of two vectors in feature space
Z is defined by the kernel K(Xi,Xj) and ai, i = 1, ... ,e, are coefficients that
define the decision rule for a pattern recognition problem
[(x) = 0{t.y,aiK(Xi.X) +b},
then the quantities t; - to and Ilu; - uoll can be defined using corresponding
training data in input space
t Note that the problem of pattern regression (regression estimation) is simpler than the problem
of conditional probability (conditional density) estimation. Therefore, here we use the results of
a solution to a simpler problem to solve a more difficult one.

486
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
"\
v'
~"
~
v~X:t"
/
.
x
o
x
o
o
FIGURE 11.7. The line passing through the point of interest Zo = (to, uo) in direction e
defined by the optimal separating hyperplane.
as followst:
(l1.RO)
Figure 11.8 demonstrates the result of estimating probability that the digit
at the top of the figure is 3. In this picture the approximations FE (t Iuo), F,(y =
3, tluo) and the obtained solution p(y = 31t, uo) are shown. The probability
that the displayed digit is 3 is defined by the value of function p(y = 31t. uo)
at the point t = O. This probability is equal to 0.34 for example (a) and equal
zero for example (b).
t Note that to estimate the conditional distribution functions (11.77), (11.78) one needs i.i.d. data
(pairs I" II,). If there are no additional training data such data can be obtained on the basis of
the leave one out procedure. For the SV method it is sufficient to conduct this procedure only
for support vectors.

11.11 ESTIMATION OF CONDITIONAL PROBABILITY AND CONDITIONAL DENSITY
487
.8
.6
.4
.2
2
3
4
5
O~~~......4=-'-'f--'II'+------+--+---+--+---+----t
-6
-5
-4
-3
-2
-1
0
(a)
2
3
4
5
.4
.6
.2
o ~Fl!l==<F"""""'--""""''----'''''''''__=B=l~:'''''-_>-=~'
-6
-5
-4
-3
-2
-1
0
(b)
FIGURE 11.8. Approximations FtUluo), Ft(y= 3,fluo) and the conditional probability
along the line passing through point corresponding to the picture on the top of figure.
The estimated probability that the corresponding digit is 3 equal to 0.34 for example
(0) and zero for example (b).

488
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
11.11.2
Estimation of Conditional Density Functions
Section 7.11 considered the problem of estimating a conditional density func-
tion as a problem of solving the integral equation
r r p(Ylx) dF(x) dy = F(y,x),
10 10
(11.81 )
where y is real values. To solve this equation in a situation where the distri-
bution functions F(x) and F(y,x) are unknown but the data
(11.82)
are given, we used the same idea of estimating the desired function along the
predefined line passing through a point of interest. Now we discuss how to
define this line.
Suppose we have solved regression estimation problems using the SV tech-
nique. This means that we have mapped vectors X; of our data (11.73) into a
feature space
where we construct the linear function
fez) = (w * z).
In input space to this function there corresponds nonlinear regression
f
f(x) = I)at - adK(x;,x).
;=1
Consider as the important direction one that is orthogonal to linear regression
function in feature space (i.e., one that is defined by vector of coefficients w
of the estimated hyperplane). As above, vectors Zi = z(x;) are split into two
elements, t; which defines the position of the data on the important direction
and U; which is the orthogonal compliment to vector z(x;). Therefore we
describe data (Yl, zd,··. (Yr, zp) as follows:
Let the vector Zo = (to, Lto) correspond to the point of our interest xo. Our
goal is to use this data to obtain the solution of the equation
r t p(Ylt, Lto) dF(tluo) dy = F(y, tluo).
10 10
(11.83)

11.12 THE SV METHOD AND SPARSE FUNCTION APPROXIMATION
489
Using expression (11.80) we construct the approximations
t
Ft(tluo) = 2..= Tj(Uo)O(t - tj),
;=1
f
Ff(y, tluo) = 2..= T;(UO)O(t - tj)O(y - Y;),
;=1
(11.84)
where Tj(UO) is defined by (11.79).
In Section 7.11 we described a method for solving the Eq. (11.83) using
approximations (11.84) that defines the conditional density along the line
passing through a point of interest in a given direction.
We reduce the problem of solving our integral equation to the problem
of solving a system of linear algebraic equations (7.87-7.89). Using this tech-
nique we obtain the desired approximation.t
11.12
CONNECTIONS BETWEEN THE SV METHOD AND SPARSE
FUNCTION APPROXIMATION
In approximation theory (for example in wavelet approximation) the impor-
tant problem is to approximate a given function f(x) with a required accu-
racy using the smallest amount n of basis functions from a given collection
of functions. In other words, it is required to construct the approximation of
function
n
satisfying the constraint
f(x) = 2..=c; 'P; (x)
;=1
n
Ilf(x) - 2..=c;'Pj(x)11 2 ~ e
;=1
(11.85)
using the smallest number of nonzero coefficients c;.
Chen, Donoho and Saunders (1995) proposed to choose as the solution
to this problem the expansion (11.85) that is defined by the coefficients that
minimize the following functional
1
n
n
E(c) = Zllf(x) - L C;'P;(x)11 2 + y 2..= Ic;1
j=1
;=1
where y is some positive constant.
(11.86)
t As in the conditioning probability case to construct approximation (11.84) from the same data
that was used for estimating the regression function, one can apply the leave-one-out technique.

490
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
In 1997 F. Girosi noted that in the case where there is no noise in the de-
scription of the function f(x) the solution of a modified version of functional
(11.86) is equivalent to the SV solution.
To describe this modification we have to remind the reader of some facts
from the Theory of Reproducing Kernels Hilbert Spaces (RKHS).
11.12.1
Reproducing Kernels Hilbert Spaces
According to definition, a Hilbert space ft is a linear space where for any
two elements fl (x) and h(x) the value of the inner product (fl (x) *h (x)hi
is defined.
A reproducing kernels Hilbert space ft is a set of functions defined by
the inner product and the kernel function K (Y, x) such that the following
reproducing property
f(x) = (f(y) * K(y,x))'H
v feY) Eft,
holds true. According to the Mercer's theorem any positive definite function
K(y, x) defines the inner product in some Hilbert space and therefore, as we
will see, defines some RKHS.
Indeed let
cPJx) , "', cPn(X), ...
be the sequence of eigenfunctions for the kernel function K(y, x) and
be the currespunding positive (since the kernel satisfies the Mercer condition)
eigenvalues
The kernel K (y, x) has the expansion
DC
K(y,x) = LAkcPk(Y)cPk(X).
k=]
It is easy to see that for Hilbert space ft
00
f(x) = LCkcPk(X)
k=1
(11.87)

11.12 THE SV METHOD AND SPARSE FUNCTION APPROXIMAnON
491
with the inner product
(11.88)
the kernel (11.87) defines RKHS.
Indeed the following equalities are true
(f(x) *K(y,x)) = (t.c,<!>,(X) *t. A'</>'(Y)<!>'(X))
= f
AkCkA~k(Y) = tCkcPk(y) = f(Y)·
k=l
k=1
11.12.2
Modified Sparse Approximation and its Relation to
SV Machines
Let K (x l y) be a reproducing kernel of a reproducing kernel Hilbert space
H and let x" ..., Xf be a set of points at which we know the values Yi = f(Xi)
of the target function f(x) E H. We make the following choice for the basis
functions
qli(X) = K(Xi, x).
Our approximation function, therefore, is
i
f(x, c) = L CiK(Xi, x).
i=l
Instead of minimizing functional (11.86), Chen et al. (1995) minimized the
functional
Girosi (1998) proposed to minimize the functional
1
i
f
G(c) = Zllf(x) -
LCiK(Xi,X)II~ + e L ICil·
i=1
i=1
We can expand this functional as follows:
1
f
G(c) =
Zllfll~ - L
cJf(x) * K(Xi, x))'H
i=1
1
f
f
+ Z L
cicj(K(Xil x) * K(xj, x))'H + e 2.:= IcJ
i,j=l
i=1
(11.89)
(11.90)

492
11 THE SUPPORT VECTOR METHOD FOR REAL-VALUED FUNCTIONS
Using reproducing properties of kernel K (Xi, X) we have
(f(X) * K(Xi,X»)ri = f(Xi) = Yi
(K(Xi'X) * K(Xj,x))rt = K(Xi,XJ
and therefore
Introducing variables
i=1, ... ,f
and disregarding the contant term
~llfll~ we obtain the following method of
solving of the sparse approximation problem: maximize the functional
f
l
P
W(a, a*) = -8 ~)at + ad + ~)at - ai)Yi - ~ L:(at - ai)(aj - aj)K(xj,Xj)
i=l
i=1
i,j=]
subject to constraints
(11.91)
This solution of the problem of sparse function approximation coincides with
the support vector solution if:
1. The function f(x) is sufficiently smooth and there is no noise in its
measurements. In this case the value C in the SV method can be chosen
sufficiently large and constraints for SV method
coincide with constraints (11.91).
2. One of the basis functions c/>o(x) is constant. In this case one does not
need the additional constraint
i
f
L:at = L:ai
i=l
i=]
that the SV method uses for choosing constant b.
Thus the SV method for function approximation that uses the linear 8-
insensitive loss function provides sparse approximation of functions.

12
SV MACHINES FOR
PATTERN RECOGNITION
This chapter considers the problem of digit recognition as an example of
solving real-life pattern recognition problem using the SV machines. We show
how to use SV machines to achieve high performance and discuss some ideas
that can lead to performance increase.
12.1
THE QUADRATIC OPTIMIZATION PROBLEM
All experiments described in this chapter were conducted using SV machines
constructed on the basis of quadratic optimization techniques for the soft
margin objective function. The main element of the corresponding algorithms
is constructing the optimal separating hyperplane. To construct the optimal
hyperplane for the pattern recognition problem, we maximize the quadratic
form
f
1
f
W(a) = "'" a· - - "'" a·a· K(x· x .)y.y.
LJ
1
2 LJ
I
J
I'
J
I
J
i=l
i,j=l
subject to constraints
(12.1 )
f
LYiai =0,
i=l
0:::; ai:::; C,
i=1,2, ... ,f..
(12.2)
To estimate a functional dependency in the sets of real-valued functions,
493

494
12 SV MACHINES FOR PATfERN RECOGNITION
we maximize the slightly different functional
I'
f
f
W(a) =-L8j(at+ad + L(at-adYj-~ L(at-ad(aj-aj)K(xj,Xj)
i=1
i=1
i,j,=1
(12.3)
subject to constraint
I'
f
La;= Lat,
;=1
;=1
0:::.: ai
:::.: C,
0:::.: at :::.: C*,
;=1,2, ...,£,
; = 1,2,.,.,£,
(12.4)
where the kernel K(Xi, Xj) satisfies Mercer's condition (see Chapter 10, Sec-
tion 10).
The methods for solving these two optimization problems are identical.
Therefore we consider only methods for the pattern recognition problem.
12.1.1
Iterative Procedure for Specifying Support Vectors
The goal is to construct optimization algorithms that are capable of using
hundreds of thousands of observations and construct decision rules based on
tens of thousands of support vectors.
To find the maximum of the functional W (a) in a such high-dimensional
space, one has to take into account that the solution aO to our optimization
problem is an £-dimensional vector where only a small number of coordinates
(the ones that correspond to support vectors) are not equal to zero.
Therefore one iteratively maximizes the objective function in the different
subspaces where coordinates are nonzero using the following algorithm:
1. At the first iteration (arbitrarily) assign most of the coordinates to
zero (let us call them the nonactive variables) and look for conditional
maximum with respect to the remaining coordinates (active variables).
Therefore one considers a reduced optimization problem where the
functional (12.1) has a reasonably small number of active variables (say,
several hundreds).
2. Let vector a (1) be the solution to this reduced optimization problem
and let W(a(I)) be a corresponding value of the functional. Check
whether the vector a(1) defines the solution to the desired optimization
prohlem. To be a solution to the desired optimization problem the f-
dimensional vector a*(l) = (ar(1), ... a/~(1)) (most coordinates of which
are equal to zero) must satisfy the conditions

12.1 THE QUADRATIC OPrlMIZArION PROBLEM
495
Yk(2:;=l a:lYiK(Xi,Xk) + b) = 1
if 0 < a:)(1) < C,
Yk(2:;=l apYi K (Xi ,Xk) + b) 2: 1
if a?(l) = 0,
Yk(2:;=l afYi K (Xi , Xk) + b) ::; 1
if aN1) = C,
i = 1, ..., f.
(12.5)
If conditions (12.5) are satisfied, then one has constructed the desired
approximation.
3. Suppose that for some i the conditions (12.5) fail. Then construct the
next approximation a(2). For this purpose make nonactive (by assign-
ing to zero) those variables for which ai (1) = 0 and make active some
number of variables ai corresponding to Xi for which the inequality
constraints (12.5) do not hold.
In this new space maximize the reduced quadratic form. Start maxi-
mization with the initial conditions
Since
if ai(l) i- 0,
otherwise.
(12.6)
W(a in (2)) = W(a(l)),
the maximum for the optimal solution in the second iteration exceeds
the maximum of the optimal solution for the first iteration.
4. Continue these iterations until the maximum is approached (satisfy the
condition (12.5)).
The described procedure works well until the number of support vectors
is less than several thousand.
To obtain the solution with a large number of support vectors (up to
hundreds of thousands), Osuna, Freund, and Girosi (1997a,b) suggested the
following procedure:
1. Arbitrarily choose IBI points from the data set.
2. Solve the optimization problem defined by variables in B.
3. While there exist some points in the training set for which the conditions
(12.5) are not valid, replace any points and corresponding weights a
from the set B with these points and corresponding weights a and
solve the new optimization problem with respect to variables in a new
set B, keeping fixed coefficients a corresponding to points that do not
belong to set B.
Since the algorithm strictly improves the objective function at any iteration,
it will not cycle. Since the objective function is bounded (W (a) is convex
quadratic and the feasible region is bounded), the algorithm must converge
to global optimal solution in a finite number of iterations. Platt (1998) and

496
12 SV MACHINES FOR PATTERN RECOGNITION
Joachims (1988) suggested modifications of this procedure that speed up the
learning process for large databases.
12.1.2
Methods tor Solving the Reduced Optimization Problem
There are a number of methods for solving quadratic optimization problems.
However, we need to solve a special (simple) quadratic optimization problem
that is described by one constraint of equality type and coordinate constraints
(12.2) (box constraints). For this specific constraint, one can construct special
optimization methods that are more efficient than general quadratic opti-
mization methods. For example, one can construct methods based on the
conjugate gradient procedure, the interior point method, and the projection
procedure. There exist standard packages implementing these methods. Any
of these can be used for constructing an SV machine. Below we describe ex-
periments with SV machines that were conducted using MINOS 5.4, LOGO,
and IQP.
12.2
DIGIT RECOGNITION PROBLEM. THE U.S. POSTAL SERVICE
DATABASE
Since the first experiments of Rosenblatt, the interest in the problem of learn-
ing to recognize handwritten digits has remained strong. In the following we
describe the results of experiments on learning the recognition of handwrit-
ten digits using different SV machines. We also compare the SV machine
results to results obtained by other classifiers. The experiments were con-
ducted using two different databases: the US Postal Service database and the
National Institute of Standard and Technology (NIST) database.
In this section we describe experiments with the U.S. Postal Service data-
base, and in the next section we describe experiments with the NIST database.
12.2.1
Performance tor the U.S. Postal Service Database
The U.S. Postal Service database contains 7291 training patterns and 2007
test patterns collected from real-life zip codes. The resolution of the database
is 16 x 16 pixel, and therefore the dimensionality of the input space is 256.
Figure 12.1 gives examples from this database.
Table 12.1 describes the performance of various classifiers, solving this
problem.t
For constructing the decision rules, three types of SV machines were usedt:
t The results of human performance were reported by J. Bromley and E. Sackinger; the results
of C4.5 were obtained by C. Cortes; the results for the two layer neural net were obtained by
B. SchOlkopf; the results for the special-purpose neural network architecture with five layers
(LeNet I) were obtained by Y. LeCun et al.
t The results were obtained by C. Burges, C. Cortes, and B. Scholkopf.

12.2 DIGIT RECOGNITION PROBLEM. THE U.S. POSTAL SERVICE DATABASE
497
FIGURE 12.1. Examples of panerns (with labels) from the U.S. Postal Service database.

498
12 SV MACHINES FOR PATTERN RECOGNITION
Table 12.1. Human performance and performance of the
various leamlng machines, solving the problem of
dig" recogn"lon on u.s. Postal Service data
Classifier
Rawerror%
Human performance
2.5
Decision tree, C4.5
16.2
Best two-layer neural network
5.9
Five-layer network (LeNet 1)
5.1
1. A polynomial machine with kernel function:
d=1, ...,7.
2. A radial basis function machine with kernel function:
{
IX - X;j2}
K(X,Xi) = exp
-
2'
256u
3. A two-layer neural network machine with kernel function:
(
b(X * Xi)
)
K(x, Xi) = tanh
256
- c
,
where
All machines constructed 10 classifiers, each one separating one class from
the rest. The lO-class classification was done by choosing the class with the
largest output value.
The results of these experiments are given in Tables 12.2, 12.3, and 12.4.
For different types of SV machines, the tables show the parameters for the
machines, the corresponding performance, and the average (over one classi-
fier) number of support vectors.
Note that for this problem, all types of SV machines demonstrate approx-
imately the same performance. This performance is better than the perfor-
Table 12.2. Resu"s of dig" recogn"lon experiments w"h polynomial SV machines
(w"h the Inner products «x* y)/256)degree)
Degree
1
2
3
4
5
6
Raw error:
8.9
4.7
4.0
4.2
4.5
4.5
Average number of SV:
282
237
274
321
374
422

12.2 DIGIT RECOGNITION PROBLEM. fHE U.S. POSTAL SERVICE DATABASE
499
Table 12.3. Resuns of dlgn recognnlon experiments wnh RBF SV machines (wnh
Inner products exp{-llx - YlI2/25OO})
IT:
4.0
1.5
0.30
0.25
0.2
0.1
Raw error:
5.3
4.9
4.2
4.3
4.5
4.6
Average number of SV:
266
237
274
321
374
422
Table 12.4. Resuns of dlgn recognition experiments with NN SV machines (with
Inner products 1.04 tanh{2(x * y)/2S6 - II})
():
0.8
0.9
1.0
1.2
1.3
1.4
Raw error:
6.3
4.9
4.2
4.3
4.5
4.6
Average number of SV:
206
237
274
321
374
422
Table 12.5. The tofal number (In 10 classifiers) of support vectors for various SV
machines and percentage of common support vectors
Poly
RBF
NN
Common
Total number of support vectors:
1677
1727
1611
1377
Percentage of common support vectors:
82
80
85
100
mance of any other type of learning machine solving the digit recognition
problem by constructing the decision rules on the basis of the entire U.S.
Postal Service database.t
In these experiments, one important feature was observed: Different types
of SV machine use approximately the same set of support vectors. The per-
centage of common support vectors for three different classifiers exceeded
80%.
Table 12.5 describes the total number of different support vectors for 10
classifiers of different machines: polynomial machine (Poly), radial basis func-
tion machine (RBF), and neural network machine (NN). It shows also the
number of common support vectors for all machines.
Table 12.6 describes the percentage of support vectors of the classifier
given in the columns contained in the support vectors of the classifier given
in the rows.
t Note that by using a local approximation approach described in Section 5.7 (that does not
construct entire decision rule hut approximates the decision rule at any point of interest). one
can obtain a better result: 3.3% error rate (Bottou and Vapnik, 1992). The best result for this
database, 2.7%, was obtained by Simard, LeCun, and Denker (1993) without using any learning
methods. They suggested a special method of elastic matching with 7200 templates using a smart
concept of distance (so-called tangent distance) that takes into account invariance with respect
to small translations, rotations, distortions, and so on (Simard. LeCun, and Denker, 1993). We
will discuss this method in Section 12.4.

500
12 SV MACHINES FOR PATIERN RECOGNmON
Table 12.6. Percentage of common (total) support
vectors for two SV machines
Poly
RBF
NN
Poly
100
84
94
RBF
87
tOO
88
NN
91
82
100
12.2.2
Some Important Details
In this subsection we give some important details on solving the digit recog-
nition problem using a polynomial SV machine.
The training data are not linearly separable. The total number of mis-
classifications on the training set for linear rules is equal to 340 (~5% errors).
For second-degree polynomial classifiers the total number of mis-classifica-
tions on the training set is down to four. These four misclassified examples
(with desired labels) are shown in Fig. 12.2. Starting with polynomials of
degree three, the training data are separable.
Table 12.7 describes the results of experiments using decision polynomials
(10 polynomials, one per classifier in one experiment) of various degrees. The
number of support vectors shown in the table is a mean value per classifier.
Note that the number of support vectors increases slowly with the
degree of the polynomial. The seventh-degree polynomial has only 50% more
support vectors than the third-degree polynomial.t
The dimensionality of the feature space for a seventh-degree polynomial
is, however, 1010 times larger than the dimensionality of the feature space
for a third-degree polynomial classifier. Note that the performance does not
change significantly with increasing dimensionality of the space-indicating
no overfitting problems.
To choose the degree of the best polynomial for one specific classifier
we estimate the VC dimension (using the estimate D;lwfI2, see Chapter
10, Section 10.7) for all constructed polynomials (from degree two up to
degree seven) and choose the one with the smallest estimate of the VC
dimension. In this way we found the 10 best classifiers (with different degrees
of polynomials) for the 10 two-class problems. These estimates are shown
[lJ[I][I]E]
4
4
8
5
FIGURE 12.2. labeled examples of training errors for the seconck:fegree polynomials.
t The relatively high number of support vectors for the linear function is due to nonseparability:
The number 282 includes both support vectors and misclassified data.

12.2 DIGIT RECOGNITION PROBLEM. THE U.S. POSTAL SERVICE DATABASE
501
Table 12.7. Resu"s of experiments wtth polynomials of the different degrees
Degree of
Dimensionality of
Support
Raw
Polynomial
Feature space
Vectors
Error
1
256
282
8.9
2
'" 33,000
227
4.7
3
'" 1 X 106
274
4.0
4
'" 1 x 109
321
4.2
5
'" 1 x 1012
374
4.3
6
'" 1 X 1014
377
4.5
7
'" 1 X 1016
422
4.5
on Fig. 12.3, where for all 10 two-class decision rules, the estimated VC
dimension is plotted versus the degree of the polynomials.
The question is, Do the polynomials with the smallest estimate of the VC
dimension provide the best classifier? To answer this question we constructed
Table 12.8, which describes the performance of the classifiers for each degree
of polynomial.
Each row describes one two-class classifier separating one digit (stated in
the first column) from the all other digits.
The remaining columns contain:
deg.: the degree of the polynomial as chosen (from two up to seven) by
the described procedure,
dim.: the dimensionality of the corresponding feature space, which is also
the maximum possible VC dimension for linear classifiers in that space,
hesl.: the VC dimension estimate for the chosen polynomial (which is much
smaller than the number of free parameters),
Number of test errors: the number of test errors, using the constructed
polynomial of corresponding degree; the boxes show the number of
errors for the chosen polynomial.
Thus, Table 12.7 shows that for the SV polynomial machine there are
no overfitting problems with increasing degree of polynomials, while Table
12.8 shows that even in situations where the difference between the best and
the worst solutions is small (for polynomials starting from degree two up to
degree seven), the theory gives a method for approximating the best solutions
(finding the best degree of the polynomial).
Note also that Table 12.8 demonstrates that the problem is essentially non-
linear. The difference in the number of errors between the best polynomial
classifier and the linear classifier can be as much as a factor of four (for
digit 9).

502
12 SV MACHINES FOR PAITERN RECOGNITION
J
J
Digits 0 -+ 4
~ "3"
IJ ~ "2"
//1P"0"
(
~II
\
l~
/ ~V P"4"
./
I~i'....
/.rJkV
-'!'
~
["-. .,..---'V
...,
[i'--..
"1"
3200
3000
2400
2000
c
0
"<Iic
OJ
1600
E
~
u>
1200
800
400
o
1
2
3
4
6
7
8
Degree of polynomial
I
I
Digits 5 -+ 9
0"5"
/, ~ "8"
~
If
\
kf
",I~~
~
D"9"
V
~
1~
V
b"6"
I~
~
.--IV
--'h"7"
--..a
3200
3000
2400
c
2000
.~
</>
C
<Ii
E
1600
:.0
u>
1200
800
400
0
1
2
3
5
6
7
8
Degree of polynomial
FIGURE 12.3. The estimate of the VC dimension of the best element of the structure
defined by the value 0; 1Wf 12 versus the degree of polynomial for various twe>class digit
recognition problems.

12.2 DIGIT RECOGNITION PROBLEM. THE U.S. POSTAL SERViCE DATABASE
503
Table 12.8. Experiments on choosing the best degree of polynomial"
Chosen Classifier
Number of Test Errors
Digit
deg.
dim.
hes!.
1
2
3
4
5
6
7
0
3
'" 10
6
530
36
14
ITiJ
11
11
12
17
1
7
'" 1016
101
17
15
14
11
10
10
[!Q]
2
3
'" 106
842
53
32
[ill
26
28
27
32
3
3
'" 106
1157
57
25
[E]
22
22
22
23
4
4
,.." 109
962
50
32
32
~
30
29
33
5
3
....., 106
1090
37
20
[ill
24
24
26
28
6
4
....., 109
626
23
12
12
@]
17
17
19
7
5
'" 10
12
530
25
15
12
10
ITU
13
14
8
4
....., 109
1445
71
33
28
[8
28
32
34
9
5
'" 1012
1226
51
18
15
11
IT!]
12
15
°The boxes indicate the chosen order of a polynomial.
12.2.3
Comparison of Performance of the SV Machine with
Gaussian Kernel to the Gaussian RBF Network
Since the RBF network with a Gaussian kernel produces the same type of
decision rules
fRBF(X) ~ sign(E ak exp{-llx - c, II'/u') +b)
that is produced by the SV machine
but uses completely different ideas for choosing the parameters of decision
rules (the centers Ck instead of support vectors Xk and coefficients of expan-
sion Uk that minimize mean square deviation instead of coefficients ak that
make an optimal separating hyperplane), it is important to compare their
performance.

504
12 SV MACHINES FOR PAHERN RECOGNITION
The result of this comparison should answer the following questions:
Is it true that support vectors are the best choice for placing the
centers?
Is it true that the SV estimate of expansion coefficients is the best?
To answer these questions the RBF networks were compared with SV
machines on the problem of U.S. Postal Service digit recognition.t
The classical RBF method does not specify how to choose the number
of centers and the parameter u. Therefore in these experiments the same
parameter u was used. Also for RBF networks the number of centers was
chosen equal to the number of support vectors that were used by the SV
machine (the variation in the number of centers did not improve the per-
formance of the RBF network).
In the first experiment a classical RBF network was used, which de-
fined centers by k-means clustering and constructed weights by error back-
propagation. The obtained the performance was a 6.7% error rate.
In the second experiment the support vectors were used as centers and
weights were chosen by error back-propagation. In this experiment we
obtained 4.9% error rate. The performance of the SV machine is a 4.2%
error rate.
The result of this experiment are summarized in Table 12.9.
To understand the geometry of this experiment better, let us compare the
RBF solution to the SV solution of the simple two-dimensional classification
problem given in Fig. 12.4: Find a decision function separating balls from
circles. Solving this problem the SV machine chooses five support vectors,
two for balls and three for circles (they are indicated by extra circles). The
five centers that were chosen in the RBF network using the k-means method
o
@
o
o@
o X
o
0
0
o
• •
• x·
•
•
•
••
•
•
•
•
•
•
..x•
•
•
@
o
@
0
0
oo X 0
0
o
o
••••x
•• @
FIGURE 12.4. The support vectors (indicated by extra circles) and RBF centers (Indi-
cated by crosses) for simple classification problem.
t The experiments were conducted in the AI laboratory at MIT. See B. Sch61kopf et al. (1997).

12.2 DIGIT RECOGNITION PROBLEM. THE U.S. POSTAL SERVICE DATABASE
505
Table 12.9. Resu"s of dig" recogn"lon experiments w"h three networks: 1)
classical RIF networks, 2) hybrid networks ~h SV centers and the classical
method for choosing weights, and 3) the SV machine
RBF Networks
SV Centers
SV Machine
Training error
1.7%
0.0%
0.0%
Test error
6.7%
4.9%
4.2%
are indicated by crosses (three for balls and two for circles). Note that in
contrast to the RBF centers the support vectors are chosen with respect to
the classification task to be solved.
12.2.4
The Best Results lor U.S. Postal Service Database
In the previous section, in describing the best results for solving the digit
recognition problem using the U.S. Postal Service database by constructing
an entire (not local) decision rule we gave two figures:
5.1% error rate for the neural network LeNet 1
4.0% error rate for a polynomial SV machine
However, the best results achieved for this database are:
3.3% error rate for the local learning approach, described in Chapter 6,
Section 6.6
2.9% error rate for a sparse polynomial of degree 4 (d1 = 2, d2 = 2) SV
machine (which will be describedt in Section 12.5) and the record
2.7% error rate for tangent distance matching to templates given by the
training set
Therefore the best results for the U.S. postal service database (2.7% of
error rate) was achieved without any learning procedure, using one nearest-
neighbor algorithm but using important a priori information about invariants
of handwritten digits incorporated into special measure of distance between
two vectors, the so-called tangent distance.
The main lesson that one has to learn from this fact is that when one has
a relatively small amount of training examples, the effect of using a priori
information can be even more significant than the effect of using a learning
machine with a good generalization ability.
In the next section we present an example that shows that this is not true
when the number of training data is large. However, in all cases to achieve
the best performances, one must take into account the available a priori in-
formation.
t This result was obtained by B. Scholkopf.

506
12 SV MACHINES FOR PAITERN RECOGNITION
12.3
TANGENT DISTANCE
In 1993 Simard et al. suggested that we use the following a priori information
about handwritten digitst:
A reasonably small continuous transformation of a digit does not change
its class.
This observation has the following mathematical expression. Consider the
plane defined by the pair (t, s). The following equation describes the general
form of linear transformation of a point in the plane:
This transformation is defined by six independent parameters. Consider the
following expansion of this transformation into six basic transformations, each
of which is defined by one parameter:
1. Horizontal Translation. The case where
a = b = c = d = f = o.
Horizontal translation is described by equations
t* = t+e,
s* = s.
2. Vertical Translation. The case where
a = b = c = d = e = O.
Vertical translation is described by equations
(12.7)
t*
t,
3. Rotation. The case where
s*
s +f.
(12.8)
a = d = e = f = 0,
Rotation is described by equations
b = -c.
t*
s*
t + bs,
s - bt.
(12.9)
t This observation is correct for many different type of images, not only for digits.

12.3 TANGENT DISTANCE
507
4. Scaling. The case where
c = b = e =f = 0,
Scaling is described by equations
a =d.
t*
s*
5. Axis Deformation. The case where
t + at,
s + as.
(12.10)
a = d = e = f = 0,
Axis deformation is described by equations
b = c.
t*
s*
t + cs,
ct + s.
(12.11 )
6. Diagonal Deformation. The case where
b = c = e = f = 0,
a= -d.
Diagonal deformation is described by equations
t*
s*
t + dt,
S - ds.
(12.12)
It is easy to check that any linear transformation can be obtained combining
these six basic transformations.
Now let a continuous function x(t,s) be defined on the plane (t,s). Using
basic transformations we now define the following six functions in the plane.
which are called Lie derivatives of the function x(t, s):
1. Function x(l)(t, s), which for any point of the plane defines the rate of
change x(t, s) in the horizontal translation direction:
(1)(
)
l'
x(t+e,s)-x(t,s)
x
t,s
= 1m
.
e--->O
e
(12.13)
2. Function x(2)(t,s), which for any point of the plane defines the rate of
change x(t, s) in the vertical translation direction:
(2)(
)
l'
x(t,s+f)-x(t,s)
x
t,s
= 1m
f
.
[--->0
(12.14)

508
12 SV MACHINES FOR PAHERN RECOGNITION
3. Function x(3)(t, s), which for any point of the plane defines the rate of
change x(t, s) in the rotation direction:
(3)(
)
I'
x(t+bs,s-bt)-x(t,s)
x
t, S
=
1m ----'---'------=-----'-------'--'---
b->O
b
I,
x(t+bs,s-bt)-x(t,s-bt)
I'
x(t,s-bt)-x(t,s)
1m
+ 1m --'-'----'-------'------'-
b->O
b
h->O
b
= sx(l)(t, s) - tx(2)(t, s),
(12.15)
4, Function X(4)(t,S), which for any point of the plane defines the rate of
change x(t, s) in the scaling direction:
(4)(
)
I'
x(t+at,s+as)-x(t,s)
(I)()
(2)()
X
t,s = 1m
=tx
t,s +sx
t,S.
0->0
a
(12.16)
5, Function X(5)(t,S), which for any point of the plane defines the rate of
change x(t, s) in the axis deformation direction:
(5)(
)
I'
x(t+cs,s+ct)-x(t,s)
(I)()
(2)()
X
t,s = 1m
,--::sx
t,s +tx
t,s.
c->O
c
(12.17)
6. Function X(6)(t,S), which for any point of the plane defines the rate of
change x(t, s) in diagonal deformation direction:
(6)(
) -I'
x(t + dt,s - ds) - x(t,s) _
(I)()
(2)()
X
t,s
-
1m
d
-tx
t,s -sx
t,s
d->O
(12.18)
Along with six classical functions that define small linear transformation
of the function, P Simard suggested that we use the following function, which
is responsible for thickness deformation:
7. This function is defined in any point of the plane as follows:
(12.19)
All seven functions can be easily calculated for any smooth continuous func-
tion x(t, s). To define them it is sufficient to define the first two functions
x(l)(t,s) and x(2)(s,t); the rest of the five functions can be calculated using
these two,

12.3 TANGENT DISTANCE
509
(12.20)
7
x*(t, s) = x(t, s) + Laix(i)(t, s),
i=l
These functions are used to describe small transformation of the function
x(t,s):
where parameters that specify the transformation are small lal ~ C.
Note that Lie derivatives are defined for continuous functions x(t, s). In the
problem of digit recognition, however, functions are described by their values
in the pixels f(t', s'), t', s' = 1,2, ..., 2k • They are discrete. To be able to use
methods based on the theory of small transformations for smooth functions,
one has to first approximate the discrete functions by smooth functions. This
can be done in many ways, for example, by convolving a discontinuous func-
tion with a Gaussian-in other words, by smoothing discontinuous functions
as follows:
/
00 /00
{
(s _ s')2 + (t _ t')2}
x(s,t)=
i(t',s')exp
-
2
dt'ds'.
-00 -00
2u
Examples of the smoothed function x(t, s), its six Lie derivatives, and
Simard's thickness deformation function are shown in Fig. 12.5.
Figure 12.6 shows the original image and the new images obtained using
linear transformation (12.20) with various coefficients ai, i = 1, ...,7.
[J]
Original
Vertical
translation
Horizontal
translation
Rotation
Scaling
Hyperbolic
axis
deformation
Hyperbolic
diagonal
deformation
Thickness
FIGURE 12.5. Smoothed image and calculated functions X<iJ(t, 5), i = 1, ...,7.

(12.21)
510
12 SV MACHINES FOR PATrERN RECOGNITION
Original
Images created using Lie derivatives
FIGURE 12.6. Digits obtained from one given example using linear transformation
(12.20) with various coefficients.
Now we are ready to define the following measure of difference between
two images Xl (t, s) and X2 (t, s):
p2(X1(t,S), X2(t,S»
= min (Xl(t,S) + tajx~i)(t,s) - X2(t,S) - tbiX~j)(t'S»)2
a,b
i=l
i=l
This measure defines distortion after invariant matching of two images. It
was called the tangent distance.t
Using tangent distance in the one nearest-neighbor algorithm and 7300
training examples as templates, the record for the U.S. Postal Service database
was achieved.
t From a formal point of view, expression (12.21) does not define distance, since it does not
satisfy the triangle inequality.

12.4 DIGIT RECOGNITION PROBLEM: THE NIST DATABASE
511
12.4
DIGIT RECOGNITION PROBLEM: THE NIST DATABASE
12.4.1
Performance for NIST Database
In 1993, responding to the community's need for benchmarking, the U.S.
National Institute of Standard and Technology (NIST) provided a database of
handwritten characters containing 60,000 training images and 10,000 test data,
in which characters are described as vectors in 20 x 20 = 400 pixel space.
For this database a special neural network (LeNet 4) was designed. The
following is how the article reporting the benchmark studies (Bottou et aI.,
1994) describes the construction of LeNet 4:
For quite a long time, LeNet 1 was considered state of the art. The lo-
cal learning classifier, the SV classifier, and tangent distance classifier
were developed to improve upon LeNet I-and they succeeded in that.
However, they in turn motivated a search for an improved neural net-
work architecture. This search was guided in part by estimates of the
capacity of various learning machines, derived from measurements of
the training and test error (on the large NIST database) as a function
of the number of training examples. We discovered that more capacity
was needed. Through a series of experiments in architecture, combined
with an analysis of the characteristics of recognition errors, the five-layer
network LeNet 4 was crafted.
In these benchmarks, two learning machines that construct entire decision
rules-(l) LeNet 4 and (2) Polynomial SV machine (polynomial of degree
four)-provided the same performance: 1.1 % test error.t
The local learning approach and tangent distance matching to 60,000 tem-
plates also yield the same performance: 1.1% test error.
Recall that for a small (U.S. Postal Service) database the best result
(by far) was obtained by the tangent distance matching method that uses
a priori information about the problem (incorporated in the concept of tan-
gent distance). As the number of examples increases to 60,000, the advan-
tage of a priori knowledge decreased. The advantage of the local learning
approach also decreased with the increasing number of observations.
LeNet 4, crafted for the NIST database, demonstrated remarkable im-
provement in performance when compared to LeNet 1 (which has 1.7% test
errors for the NIST databaset).
The standard polynomial SV machine also performed well. We continue
the quotation (Bottou et aI., 1994):
t Unfortunately, one cannot compare these results to the results described in Section 12.2. The
digits from the NIST database are different from the U.S. Postal Service database.
t Note that LeNet 4 has an advantage for the large (60,000 training examples) NIST database.
For a small (U.S. Postal Service) database containing 7000 training examples. the network with
smaller capacity, LeNet I, is better.

512
12 SV MACHINES FOR PATrERN RECOGNITION
The SV machine has excellent accuracy, which is most remarkable, because
unlike the other high-performance classifiers it does not include knowl-
edge about the geometry of the problem. In fact this classifier would do
just as well if the image pixel were encrypted, for example, by a fixed
random permutation.
12.4.2
Further Improvement
Further improvement of results for the NIST database was obtained both for
neural networks and for SV machines.
A new neural network was created-the so-called LeNet 5-that has a
five-layer architecture similar to LeNet 4, but more feature maps, and a
larger fully connected layer. LeNet 5 has 60,000 free parameters (LeNet 4
has 17,000), most of them in the last two layers.
It is important to notice that LeNet 5 implicitly uses a priori information
about invariants: LeNet 5 includes the module that, along with given exam-
ples, considers also examples obtained from the training examples by small
randomly picked affine transformations described in a previous section. Using
this module, LeNet 5 constructs from one training example 10 new examples
belonging to the same class. Therefore it actually uses 600,000 examples.
This network outperformed the tangent distance method: It achieved 0.9%
error.
The same idea was used in the SV machine. It also used a priori infor-
mation by constructing virtual examples. The experiment was conducted as
follows:
1. Train a SV machine to extract the SV set.
2. Generate artificial examples by translating the support vectors in four
main directions (see Fig. 12.7).
3. Train the SV machine again on old SV and generated vectors.
Using this technique, 0.8% performance was obtained. This result was ob-
tained using polynomials of degree 9. Thus in both cases the improvement
was obtained due to usage of some a priori information.
12.4.3
The Best Results for NIST Database
The record for NIST database was obtained using the so-called boosting
scheme of recognition that combines three LeNet 4 learning machines
(Drucker et aI., 1993).
The idea of the boosting scheme is as follows. One trains the first learn-
ing machine to solve the pattern recognition problem. After completion of
training the first machine, one trains the second machine. For this purpose,
one uses a new training set from which a subset of training data is extracted,

12.4 DIGIT RECOGNITION PROBLEM: THE NIST DATABASE
513
FIGURE 12.7. Image and new examples obtained by translation at two pixels in four
main directions (left, right, up, and down).
containing 50% of the examples (chosen randomly) that are correctly classi-
fied by the first learning machine and 50% of examples that are incorrectly
classified by the first learning machine. After the second machine constructs
a decision rule using this subset of training data, a third learning machine is
constructed. To do this, a new training set is used from which one chooses
examples that the first two machines classify differently. Using this subset of
training data, one trains the third machine. Therefore one constructs three
different decision rules. The idea of boosting scheme is to use a combination
of these three rules for classification (for example, using the majority vote).
It is clear that to use this scheme, one needs a huge amount of training
data. Recall that LeNet 4 makes only 1.1% of training error. To construct a
second machine, one needs a subset that contains 10,000 errors of the first
classifier. This means that one needs a huge amount of new examples to
create the second training set. Even more examples are needed to create a
training set for the third machine. Therefore in a pure way this scheme looks
unrealistic.
Drucker et al. (1993) suggested using a boosting scheme to incorporate
a priori knowledge about invariants of handwritten digits with respect to
small transformations defined by (12.20). They suggested first to train the
learning machine using 60,000 training examples from the NIST database.
Then, to get a "new" set of examples they suggested the following "random"

514
12 SV MACHINES FOR PATTERN RECOGNITION
generator of handwritten digits. From any pair (Xj, Yj) of initial training data,
they construct new data that contain the same Yi and the new vector
7
Xj(new) = Xj +L ajxjr) ,
r=1
where x(r), r = 1, ...,7 are Lie derivatives described in Section 4.3, lad::; C
is a random vector, and C is reasonably small. In other words, from any
given example of initial training data they create new transformed random
examples (depending on random vector aj) that have the same label.
Using three learning machines, LeNet 4 and several million generated
examples (obtained on the basis of 60,000 elements of training data), they
achieved the performance of 0.7% error rate. Up to now this is the best
performance for this database.t
12.5
FUTURE RACING
Now the SV machines have a challenge-to cover this gap (between 0.8% to
0.7%). To cover the gap, one has to incorporate more a priori information
about the problem at hand.
In our experiments we used only part of available a priori information
when we constructed virtual examples by translating support vectors in the
four main directions. Now the problem is to find efficient ways of using all
available information. Of course using the support vectors, one can construct
more virtual examples on the basis of other invariants or one can incorporate
this information using a boosting scheme for SV machines.
However, it would be much more interesting to find a way how to incor-
porate a priori information by choosing appropriate kernels.
The following observations can be used for this purpose.
Observation 1. The best result for the SV machine described in the pre-
vious section was obtained using polynomials of degree nine. Recall that
these polynomials were constructed in 400-dimensional pixel space that is in
~ 10B ·dimensional feature space. Of course most of these coordinates are
not useful for constructing the decision rule. Therefore if one could detect
these useless terms a priori (before the training data are used), one could
reduce the dimensionality of feature space and construct the optimal sepa-
rating hyperplane in reduced feature space. This will allow us to construct
more accurate decision rules.
t Note that the best performance 0.8% for the SV machine was obtained using full-size polyno-
mials of degree 9. However. for postal service database using sparse polynomials (to be described
in the next section) we significantly improved performance. We hope that the sparse polynomial
of degree 9 (lh = 3.d2 = 3) will also improve this record.

12.5 FUTURE RACING
515
Let us make the conjecture that high accuracy decision rules are described
by the following three-level structures:
1. On the first level a set of local features is constructed. The local features
are defined as a product of values of d l pixels (say d l = 3) that arc close
to each other.
2. On the second level a set of global features is constructed. The global
features are defined as a product of values of dz local features (say
dz = 3).
3. On the third level the optimal hyperplane in the space of global features
is constructed.
These decision rules are polynomials of order d 1dz (nine in our case) with a
reduced number of terms (they are sparse polynomials of degree nine).
The idea of constructing such sparse polynomials can be implemented by
constructing a special form of inner product (see Fig. 12.8). Consider patches
of pixels, say 4 x 4, that overlap over two pixels. Altogether there are 100
such patches. Now let us define the inner product in the form
(
d) d,
K(u, u) =
L (.L
UiVi +1)
I
• ,
patches
IEpatch
where d l = 3 and dz = 3. It is easy to see that using this inner product we
construct polynomials of degree nine that reflect our conjecture but contain
much less terms. The number of terms generated by this inner product is
~ 1014 (instead of lOz3),
FIGURE 12.8. By constructing special type of inner product, one constructs a set of
sparse polynomials

516
12 SV MACHINES FOR PATTERN RECOGNITION
The idea of constructing local features can be used not only for construct-
ing polynomials, but for other kernels as well. Using analogous types of con-
struction of the inner product, one can suggest various structures that reflect
a priori knowledge about the problem to be solved.t
Observation 2. To construct separating decision rules (say polynomials) that
have some invariant properties with respect to transformations described in
Section 12.2 (suppose we consider smoothed images), we calculate for any
vector Xj of the training data
(Yl,XI), ... , (Yt,Xt)
the functions x(i), i = 1, ...,7. Consider a high-dimensional feature space Z
where the pro61em of constructing polynomials is reduced to constructing
hyperplanes with the inner product defined by the kernel
The images of training data in Z space are
(YI, ZI), ..., (Yt, z£).
Let Z (Xj) be an image in Z space of the vector Xj' Let us define the images
of the functions xji), i = 1, ..., 7, as follows:
(i)
(i)
.
z(Xj + YXj
) -
z(Xj)
z.
= 11m ----'------
J
)'->0
Y
To construct decision rules that are invariant, say, with respect to small
horizontal translations (with respect to xiI)) means to construct the hyper-
plane
(z*l/J)+b=O
such that l/J and b minimize the functional
(12.22)
and satisfy the constraints
Yd(Zj * l/J) + b) ~ 1 -
~j,
~j ~ O.
t Aftcr this chapter was written, B. Scholkopf reported that by using kernels for sparse polyno-
mials of degree four (d1 = 2, d2 = 2) he obtained 2.9% of the error rate performance on the
postal service database.

12.5 FUTURE RACING
517
To obtain the solution, one takes into account that the following equalities
are valid:
l
(Zj * t/J) = LYkakK(Xj, Xk),
k=l
(1)
_.
K(xj + yxj1),x;) - K(xj,x;) _
(1)
(Z.
* Zi) - hm
- K
(Xj,Xi)'
(12.23)
}
y-o
y
Here we denote by K(1)(x;,Xj) the derivative of function K(Xj,Xi) in
direction xj1). For the polynomial kernel
we have
K (l)(
) -
d(
)d-1 ((1)
)
Xj,Xi -
Xj*Xi
Xj
*X;.
Now, to find the desired decision rule
l
LYiaiK(x, Xi) + b = 0,
;=1
one has to solve the following quadratic optimization problem: Minimize the
functional
<I> ~t (t y,u,K(1)(Xi' X,»)' +ct ti
suhject to constraints
Yi(t y,u,K(xi' x,) +b) 2': 1 - tj,
l
LYiai =0,
i=l
(12.24)
(12.25)
j=1, ...,.e.
To construct a polynomial that is invariant with respect to several small
transformations defined by xji), we construct the decision rule
r
LYiai(X *x;)d + b = 0
i=]

518
12 SV MACHINES FOR PATIERN RECOGNITION
such that Uj and b minimize the functional
<I> ~tt (EMd(Xi * Xi)dl(xj'l *Xi)) + Ct ti
subject to constraints
Yj (tY;U;(Xj * x;)d + b) ~ 1 -
~j,
1=]
f
LY;u; = 0,
;=1
(12.26)
j = 1, ...,t.
12.5.1
One More Opportunity. The Transductive Inlerence
There is one more opportunity to improve performance in the digit recog-
nition problem-that is, use transductive inference. Note that the goal of
handwritten digit recognition is to read documents that usually contain not
one but several digits. For example, read zip codes that contain five digits,
or read the courtesy account on bank checks, and so on. The technology of
recognition that suggests the framework of the inductive approach is the fol-
lowing: First construct decision rules and then use these rules for recognition
of new data. t
This idea implies the following sequence of actions: Recognize the first
digit (say of a zip code), then the second digit, and so on. Unlike the character
recognition in the words you read here, there are no correlations between
digits and therefore one recognizes digits independently.
Consider now the same problem in the framework of transductive in-
ference. According to this approach, our goal is to estimate values of the
function at the given five points, describing zip codes. We are given training
data
(Yt,Xt), ..., (Yf,Xr)
(containing thousands of observations) and five new vectors
the classification of which
Y~'''''Y5
is unknown. The goal is to make the classification.
(12.27)
(12.28)
t We do not discuss the very difficult problem of digit segmentation (separating one digit from
the other for cursive writing digits). In both approaches-the classical one and the new one-we
assume that this problem is solved and the main problem is to recognize digits.

12.5 FUTURE RACING
519
Let us assume for a moment that we are faced with a two-class classification
problem. Then there exist 32 different ways to classify these five vectors into
two classes that contain the desired one. Consider all possible classifications
( )
1)
(y32
32)
Y), ..·,Ys , ...,
1 ""'Ys
.
Suppose for simplicity that the collection of the training data and the correctly
labeled fives vectors can be separated without error.
Then, according to the theory of estima.ting values of functions at given
points, described in Chapter 8 and Chapter 10 in order to bound the proba-
bility of correct classification y~ , ... ,yf of five vectors by a linear classifier, one
has to estimate the value D2(k)/p2(k) using the joint set of data containing
the training data (12.26) and the data
(y~,xn, ..., (y~,x;)
(recall that if classification y~, ...,y} without error is impossible, then p(k) =
0). It was shown that the probability of correct classification can be estimated
by the value
where <I>(u) is monotonic. Therefore, to get the best guarantee of classification
of data (12.27), one has to choose such a separation (from 32 possible) for
which the value
is the smallest.
Let us now come back to the lO-class classification problem. Up to this
point, to conduct a to-class classification we used 10 two-class classifiers and
chose a classification that corresponds to the largest output of the classifier.
For estimating the values of a function at given points we also will combine
Table 12.10. Quality of 32 various separations In 10 two-class classification
problems
1
2
...
. ..
32
0
do(l)
do(2)
...
. ..
do(32)
1
dl (1)
d l (2)
...
...
til (32)
" .
., .
" .
., .
.. .
"
.
9
d9(1 )
d9(2)
.. .
., .
d9(32)

520
12 SV MACHINES FOR PATTERN RECOGNITION
10 two-class classifiers to construct a
1O~class classifier. However, the rules
for combining these 10 classifiers are more complex.
Consider the following 10 one-class classification problems: digit zero ver-
sus the rest, digit one versus the rest, and so on. For any of these 10 problems,
one has 32 different possible classifications of our data (12.27). Therefore one
can define the table that contains 10 lines, each of which defines the qual-
ity of all 32 possible solutions of each two-class classification problem (each
column defines the quality of the corresponding solution).
To find the best 1O-class classifications, one has to find such 10 two-class
solutions that:
1. They are admissible (each element belongs to one class, and there are
no contradictions among 10 two-class solutions). There are 100,000 such
admissible solutions.
2. Among admissible solutions (sets of 10 two-class solutions), find such
for which the score
9
D = Ldi(ki)
i=O
is minimal, where ki is the number of chosen solutions in the two-class
classification problem for digit i versus the rest.

13
SV MACHINES FOR
FUNCTION APPROXIMATIONS,
REGRESSION ESTIMATION,
AND SIGNAL PROCESSING
This chapter describes examples of solving various real-valued function esti-
mation problems using SV machines. We start with a discussion of the model
selection problem and then consider examples of solving the following real-
valued function estimation problems:
1. Approximation of real-valued functions defined by collections of data.
2. Estimation of regression functions.
3. Solving the Radon integral equation for positron emission tomography.
13.1
'rHE MODEL SELEC'nON PROBLEM
In Chapter 12 when we constructed decision rules for real-life pattern recog-
nition problems we saw the importance of choosing a set of indicator func-
tions with appropriate value of capacity.
For estimating real-valued function the problem of choosing appropriate
capacity of an admissible set of functions is even more important.
In Chapter 6 we suggested the principle for choosing such a set of functions
-the Structural Risk Minimization (SRM) principle. We suggested that one
uses the functional that bounds the risk using information about the empirical
risk and the VC dimension of the set of functions of the learning machine.
The main question in the practical application of the SRM principle is the
following:
Are the bounds developed in the theory (Chapter 5) accurate enough to
be used in practical algorithms for model selection?
521

522
13 SV MACHINES FOR FUNCTION ESTIMATION
In the next two sections we try to answer this question. We describe exper-
iments with model selections which show that for small sample sizes (note
that real-life problems are always small sample-size problems) the models
selected on the basis on the VC bounds are more accurate than the models
selected on the basis of classical statistical recommendations.
13.1.1
Functional for Model Selection Based on the VC Bound
We start with a simple particular problem of model selection. Given a collec-
tion of data, estimate a regression function in the set of polynomials, where
the order of the best approximating polynomial is unknown and has to be
estimated from the data.
Let in the interval [a, b] the probability density p(x) be defined and let
there exist a conditional density p(y Ix) that defines values of y for a given
vector x. Therefore the joint probability distribution function
p(x, y) = p(x)p(Ylx)
is defined. Let
(Yl,Xl), ... , (Ye,xp)
be i.i.d. data governed by this distribution function. Our goal is to use the
data to approximate the regression function
r(x) =Iyp(Ylx) dy
by some polynomial. Note that the regression function is not necessarily a
polynomial.
To find the best approximating polynomial one has to answer two ques-
tions:
l. What is the best order of approximating polynomial?
2. What are the parameters of this polynomial?
The second question has a simple answer. One chooses the parameter 0'
that minimizes the empirical risk functional (say with quadratic loss function)
One cannot, however, use this functional to choose the appropriate order d
of the approximating polynomial, since the value of this functional decreases
with increasing order of polynomial and becomes equal to zero when d =

13.1 THE MODEl SElECTION PROBLEM
523
£. - 1. Therefore to choose the appropriate order of polynomial, one has to
minimize another functional.
Classical statistics suggest several solutions to this problem. Each of these
suggests some functional to be minimized instead of the empirical risk func-
tional. In the next section we will describe these functionals. Below we
consider the problem of choosing the order of polynomial as a problem of
choosing the appropriate element of the structure in the scheme of structural
risk minimization.
Note that the setting of this problem actually describes the structure on
the set of polynomials. Indeed, in the problem of finding the best order
of polynomial, the first element Sl of the structure is the set of constant
functions, the second element Sz is the set of linear functions, and so on. For
any element of this structure we have a good estimate of the VC dimension.
Since the set of polynomials of order k - 1 is a set of functions linear in k
parameters, the VC dimension of element Sk is equal to k (the number of free
parameters). As we saw in Chapters 4 and 5, the number of free parameters is
a good estimate of the VC dimension for a linear set of functions. According
to the bounds obtained in Chapter 5, if the distribution function is such that
the inequality
is valid, where Pdx, 0') denotes the polynomial of degree k - I, then with
probability 1 -
71 simultaneously for all 0' the inequality
1
f
")
f L(Y; - Pk(Xi, O'))~
E (y - Pk (x, a)? ::; -;-
i_=-=1======="..----
~ k (In ~ +~---;n ;)
1 - c( T, p)
£.
+
(13.1 )
holds, where c( T, p) is a constant depending only on T and p. According to the
SRM principle to find the best solution one has to minimize the right-hand
side of (13.1) with respect to the parameter k (the order of the polyno-
mial) and parameters 0' (coefficients of polynomials). To solve the problem
of choosing the appropriate order of polynomial, we use the functional that
differs from (13.1) only by constants. We also will specify the choice of 71
depending on £. as follows:
4
71 = yfi'
Thus to choose the order of polynomial we minimize the functional (Vapnik,

524
13 SV MACHINES FOR FUNCTION ESTIMATION
1979)
(13.2)
13.1.2
Classical Functionals
In the previous section we defined the functional that has to be minimized
instead of empirical risk functional. This functional has the form
1
l
R(k, a) = g(k, i)i L(yj - PdXj, a))2.
j=]
(13.3)
(13.4)
The recommendations that come from classical analysis also suggest min-
imization of the functional of type (13.3) with different correcting functions
g(k, i). The following describes the four most popular of these recommen-
dations.
Finite prediction error (FPE) (Akaike, 1970) uses the following correcting
function
k
1+-
g(k, f) = ----to
1- £
Generalized cross-validation (GCV) (Craven and Wahba, 1979) uses the
following correcting function
(13.5)
Shibata's model selector (SMS) (Shibata, 1981) uses the following correct-
ing function:
k
g(k, i) = 1 + 2£.
(13.6)
Schwartz criteria (MDL criteria) (Schwartz, 1978) uses the following cor-
recting function:
k-lni
g(k,f)=1+ (i
k)'
2 1--i
(13.7)

13.1 THE MODEL SELECTION PROBLEM
525
Note that first three correcting functions have the same asymptotic form
k
(k
2
)
g(k, Ji) = 1 + 2£ + 0
£2
.
In the next section we compare the performance obtained using these
classical correcting functions with the functional (13.2) obtained on the basis
of the VC bound.
13.1.3
Experimental Comparison of Model Selection Methods
The following experiments were conducted for each model selection func-
tional (Cherkassky et aI., 1996). Using a set of polynomials we tried to
approximate the nonpolynomial regression function sin2 27Tx corrupted by
nOIse:
y = sin2 27TX + e.
We considered the training data
obtained on the basis of a uniform distribution x on the interval [0,1] and
normally distributed noise with zero mean and different values of variance.
The model selection criteria were used to determine the best approximation
for a given size of training data. The mean-squared deviation of the chosen
approximation function from the true function was used to evaluate perfor-
mance.
Four different sizes of training data (10, 20, 30, 100 samples) with 10
different levels of noise were tried. The noise is defined in terms of signal-
to-noise ratio (SNR) given by the mean-squared deviation of the signal from
its mean value to the variance of the noise.
All experiments were repeated 1000 times for a given training set size
and noise level. Therefore for any experiment we could construct a distribu-
tion function on performances. Schematically we describe these distribution
functions using standard box notation (see Fig. 13.1).
Standard box notation specifies marks at 95, 75, 50, 25, and 5 percentile
of an empirical distribution. The results of these experiments are presented
in Figs. 13.2, 13.3, and 13.4. These figures show the distribution of mean-
squared deviation of the approximating function from regression obtained
for five functionals (FPE, GCv, SMS, MOL, VC) of the model selection,
different signal/noise ratio (SNR) and different number n of observations.
Along with these experiments, similar experiments for other target func-
tions were conducted. They showed similar results in performance of various
methods.
From these experiments, one can conclude the following:

526
13 SV MACHINES FOR FUNCTION ESTIMATION
95%
75%
50%
25%
5%
FIGURE 13.1. Standard box notation for description of results of statistical experiments.
It specifies marks at 95, 75, 50. 25, and 5 percent of an empirical distribution.
1. For small sample size, classical methods did not perform particularly
well.
2. For small sample size the functional (13.2) gives consistently reasonable
results over the range tested (small error as well as small spread).
3. Performance for large samples (more than 100; they are not presented
on the figures) is approximately the same for all methods for the amount
of noise used in this study.
13.1.4
The Problem of Feature Selection Has No General Solution
The generalization of the problem of choosing an order of the approximating
polynomial is the following: Given an ordered sequence of features and the
structure where the element Sk contains the functions constructed as a linear
combination of the first k features. It is required to choose the best element
of the structure to estimate the desired function using the data. This problem
can be solved using functional (13.2)
In practice, however, it is not easy to order a collection of admissible
features a priori. Therefore one tries to determine the order on the set of
features, the appropriate number of ordered features, and the decision rule
using training data. In other words, using the data one would like to choose
among a given set of features {l}1 (x)} a small number of appropriate features,
say l}1j (x), ..., l}1,z(.r), and then using the same data construct a model
n
y = L akl}1k(X).
k=l
(13.8)
However, to select an appropriate number n in this case, one cannot use func-
tional (13.2) for the following reason: In contrast to the problem of choosing

13.1 THE MODEL SELECTION PROBLEM
527
{= 10, SNR = 10
[= 10, SNR = 5
1013
10 13
g10 10
g10 10
Ql
Ql
"t:l
107
"t:l
107
~
~
ro
ro
::J
104
:::l
104
0-
0-
'?
'?
c
c
ro
10 1
ro
101
Ql
Ql
:!:
:!:
10-2
10-2
FPE
GCV
SMS
SC
VC
FPE
GCV
SMS
SC
VC
Method
Method
{= 20, SNR = 10
{=20,SNR=5
1017
10 18
e 10 14 -
e 10 15
Qi 1011
Qi
1012
"t:l
"t:l
109
~
108
~
ro
ro
:::l
105
:::l
106 -
0-
cr-
</l
</l
I
102
I
103
c
c
ro
ro
~ 10-1
Ql
10°
:!:
10-4
10-3
FPE
GCV
SMS
SC
VC
FPE
GCV
SMS
SC
VC
Method
Method
{= 30, SNR = 10
(= 30, SNR = 5
1014
1014
~
lOll
g lOll
g
Ql
108
Ql
108
"t:l
"t:l
~
105
~
105
ro
ro
::J
::J
0-
0-
'?
102
'?
102
c
c
ro 10-1
ro 10-1 -
Ql
Ql
:!:
:!:
10-4
10-4
FPE
GCV
SMS
SC
VC
FPE
GCV
SMS
SC
VC
Method
Method
FIGURE 13.2. Results of experiments for different methods, different number of obser-
vations, and different values of SNR.
the order of approximating polynomial in this scheme of structural risk min-
imization, one cannot specify a priori which features will be chosen first and
which will be chosen next. A priori all combinations are possible. Therefore
the nth element of structure contains functions that are linear combination
of any n features.
It turns out that the characteristics of the capacity for elements of such
a structure depend not only on the number of tenus n in the linear model
(13.8), but also on the set {l/1(x)} from which the features were chosen.

528
13 SV MACHINES FOR FUNCTION ESTIMATION
[= 10, SNR = 3.3
1016 .-----_,--__-,---,----.-----,
FPE
GCV
SMS
SC
VC
Method
[= 10. SNR = 2.5
10-2 '--_L--_L--_"----_-'--_.l.------J
FPE
GCV
SMS
SC
VC
Method
[= 20, SNR = 3.3
[= 20. SNR = 2.5
1018 .------,---,---,---,---,------,
g 1015
Q) 1012
"0
~
109
-
(\l
&-
106
~
c:
103
(\l
~
100
10-3 '--_'--_"'--_'--_"-------==-------J
FPE
GCV
SMS
SC
VC
Method
1018.------,---,---,---,----,-----,
g 1015
Q)
1012
"0
~
109
(\l
&-
106
(/)
~
103
(\l
~
100
10-3 '--_L-----=c-_-'--_-'--_.l.------J
FPE
GCV
SMS
SC
VC
Method
[= 30, SNR = 2.5
10-3 L-_L--_-'--_-'--_-'--_.L------J
FPE
GCV
SMS
SC
VC
Method
1015.-----_,---_,---_,-_,-_-,----,
e 1012 --
W
"0
109 -
~
(\l
::3cr
(/)
oc:
(\l
Q)
:E
VC
FPE
GCV
SMS
SC
Method
[= 30, SNR = 3.3
10-3 '----_L--_'--_-'---_-'---_-'----------'
1012 .------,---,---,---,----,------,
g 109
Q)
"0
106
~
(\l
&-
103
~c:
~
10°
:E
FIGURE 13.3. Results of experiments for different methods, different number of obser-
vations, and different values of SNR.
Consider the following situation. Let our set of one-dimensional functions
be polynomials. That is,
Suppose now that we would like to select the best n features to construct the

13.1 THE MODEL SELECTION PROBLEM
529
[= 100, SNR = 2
~g
Ql 10-1
"0
~
Cl:J
::3:r 10-2
c
Cl:J
Ql
:::E 10-3 '-----=r::::....----=r::::....----=r::::....----=I::....-_.l....-----l
FPE
GCV
SMS
SC
VC
Method
[= 100, SNR = 1
101.----,--,--,--,--,-__
g 100
Ql
"0
Ql
~ 10-1
::3u
~ 10-2
Cl:J
Ql
:::E 10-3 '-------J__'--_L-_L-_~_____'
FPE
GCV
SMS
SC
VC
Method
[= 100, SNR :;:: 0.5
[:;:: 100, SNR = 0.25
102,....-----,I---rl-----rl---.,------,I---,
FPE
GCV
SMS
SC
VC
Method
Cl:J
Ql
:::E 10-2 '----_.l....-I_.l....-I_.l....-I_.l....-I_.l....-I----J
FPE
GCV
SMS
SC
VC
Method
l = 100, SNR = 0.13
102.----r--.----,-----,-----,---------,
FPE
GCV
SMS
SC
VC
Method
o
'-
Ql
10 1
"0
~
Cl:J
::3:r
10°
c
Cl:J
Ql
:::E 10-1 '--_'--_'--_.l....-_.l....-_-'------J
102.----,-----,-----,-----,---,-------,
[= 100, SNR = 0.18
FPE
GCV
SMS
SC
VC
Method
FIGURE 13.4. Results of experiments for different methods. different number of obser-
vations. and different values of SNR.
model
O~x~l.
n
Y = L akl/Jnk (x),
k=l
This function can be a polynomial of any order, but it contains only n terms-
the so-called sparse polynomials with n terms (compare with the problem of
choosing an order of approximating polynomial where element Sn of the
structure contained all polynomials of degree n - 1).

530
13 SV MACHINES FOR FUNCTION ESTIMATION
It is known (Karpinski and Werther, 1989) that the VC dimension for a
set of sparse polynomials with n terms has the following bounds:
3n - 1 ~ hn ~ 4n.
(13.9)
Therefore to choose the best sparse polynomial, one can use the functionals
defined (13.2), where instead of hn = n one has to use hn = 4n.
Now let us consider another set of features
l/Jo(X) = 1,
rPl(X) = sin 7TX, ...,
rPn(X) = sinn7Tx, ...,
from which one has to select the best n features in order to approximate a
desired function. For this set of features the problem has no solution, since as
we showed in Chapter 4, Section 4.11 (Example 4) the VC dimension of the
set of functions sin ax is infinite, and therefore it can happen that by using
one feature from this set (with sufficiently large a), one can approximate the
data but not the desired function.
Thus, the problem of feature selection has no general solution. The solu-
tion depends on the set of admissible features from which one chooses the
appropriate nones.
One can consider a particular case where the number of features from
which one chooses an appropriate feature is finite, say equal to N. In this
case the bound on capacity of element Sn of the structure is hn ~ n In N. This
bound, however, can be both relatively accurate for one set of functions (say,
for trigonometric polynomials) and pessimistic for another set of functions
(say, for sparse algebraic polynomials, where hn ~ 4n). Therefore using only
information about the number of features used to obtain a specific value of
empirical risk and the number of admissible features one cannot control the
generalization well.
13.2
STRUCTURE ON THE SET OF REGULARIZED LINEAR FUNCTIONS
Consider another idea of constructing a structure on the set of functions
linear in their parameters that was suggested in the early 1960s for solving
ill-posed problems.
Consider a set of functions linear in their parameters
y = (a *x)
and the positive functional
O(a) = (a *Aa).
Suppose our goal is given the data

13.2 STRUCTURE ON THE SET OF REGULARIZED LINEAR FUNCTIONS
531
to estimate the regression function. Consider the following a priori structure
on the set of linear functions
(13.10)
where A is a positive definite matrix and Ck, k = 1, ..., is a sequence of mono-
tonic increasing constants.
To find the regression function we minimize the functional
1
f
R(a) = f L(y; - (a *x;))2
;""1
(13.11 )
on the element Sk of the structure (13.10). This problem is equivalent to
minimizing the functional
1
p
R(a) = "'i L(y; - (a *Xi))2 + l'k(a * Aa),
;",,1
(13.12)
where the choice of the nonnegative constant l'k is equivalent to the choice
of elements of the structure (13.10) (choice of constant Ck in Eq. (13.10)).
For SV machines (wilhout loss of generality (see Section 10.9)) we consider
a particular case of this structure-namely, the case where A in (13.10) is the
identity matrix A = I. In this case the functional (13.12) has a form
1
l
R(a) = "'i L(Yi - (a *Xi))2 + l'k(a *a).
;=1
(13.13)
Below we discuss three heuristic methods for choosing the regularization
parameter l'k which came from different theories that consider (from a dif-
ferent point of view) the regularization problem:
1. The L-curve method, which was suggested for solving ill-posed problem.
(Hansen, 1992; Engl et aI., 1996).
2. The effective number of parameters method, which was suggested in
statistics for estimating parameters of ridge regression (in statistical
literature the minimum of functional (13.13) is called ridge-regression)
(Hesti and Tibshirani, 1990; Wahba, 1990; Moody, 1992).
3. The effective VC dimension, which was developed in the framework of
statistical learning theory (Vapnik, Levin, and LeCun, 1994).

532
13 SV MACHINES FOR FUNCTION ESTIMATION
13.2.1
The L-Curve Method
Suppose that for a fixed y the vector a y provides the minimum to the func-
tional (13.13). Consider two functions:
and
t(y) = In [(ay *ay)].
One can consider these two functions as a parameterized form (with respect
to parameter y) of the function
t=L(s).
This curve looks like a character "L" (that is why this method was called
the L-curve method): For large y the value of t is small but the value of s
is large, and with decreasing y the value of t increases but the value of s
decreases. It was observed that a good value of the regularization parameter
y corresponds to the corner point of the curve.
Let us call point I:- = (t( y*), s(y*)) the comer point of curve t = L(s) if it
satisfies two properties:
1. The tangent of t = L(s) at s* = s(y*) has a slope equal to -1:
dL(s*) = -1
ds
t(y),.----------------------,
________ L-
I
I
'--
..L-
---' S (y)
FIGURE 13.5. The form of Lcurve. The parameter y that corresponds to the corner point
on the curve defines the value of regularization.

13.2 STRUCTURE ON THE SET OF REGULARIZED LINEAR FUNCTIONS
533
2. The function L(s) is concave in the neighborhood of s(y*).
The value y that defines this point has to be chosen for regularization.
It is easy to show that under the condition that t (y) and s(y) are differ-
entiable functions, the point (t(y*),s(y*»
is the corner point if and only if
the function
1
p
'H(y) = £L(Y; - (a y *x;»2(a y * Aa y )
;=1
has a local minima at y = y*.
Indeed, since the function 'H(y) can be written as
'H(y) = exp{t(y) + s(y)}
the necessary condition for its local minimum is
d'H(y*)
(dt(y*)
dS(y*»)
{ ()
()}
0
=
d
+
d
exp t y + s y
= .
dy
y
y
This implies
dt(y*)
ds( y*) _ O.
dy
+
dy
-,
that is, the tangent of the L curve is -1. Since y* is also the local minimum
of In 'H(y) we have
t(y) +s(y) > t(y*) +s(y*).
Thus, the point of local minima 'H is the corner point. Analogously, one can
check that y* that defines the corner point provides the local minimum for
function 'H( y).
The L-curve method can be applied to the SV machine for choosing the
regularization constant:
1
c= -.
y
The objective function in the feature space for the support vector method
with quadratic loss function has form (13.13), and therefore all the above
reasoning is valid for SV machines. To find the best parameter C = 1/y for
SV machines using the L-curve approach, one has to find a local minimum
of the functional

534
13 SV MACHINES FOR FUNCTION ESTIMATION
13.2.2
The Method 0' Effective Number0' Parameters
The statistical approach to the problem of choosing the best regulariza-
tion parameter is based on the idea to characterize the capacity of the set
of regularization functions using the generalized concept of the number of
free parameters-the so-called effective number of parameters. The effec-
tive number of parameters is used instead of the number of parameters in
functionals that estimate the accuracy of prediction.
Let us define the concept of the effective number of parameters. Suppose
we are given the training data
Consider the matrix
where X is f x n matrix of vectors Xi.
Let
be (nonnegative) eigenvalues of the matrix B ordered according to decreasing
value and let
rfil ,..., rfin
be the corresponding eigenvectors of this matrix. The value
n
A;
heff=L~'
;=1
I
'Y
which is the trace of the matrix
heff = trace (X(B + yl)
1X T )
(13.14)
is called the effective number of parameters.
The idea of using the effective number of parameters in functionals (13.4),
(13.5), (13.6), (13.7), and (13.2) instead of the number of parameters is jus-
tified by the following observation. Suppose the vector coefficient ao that
minimizes functional (13.11) has the following expansion on the eigenvectors
n
ao = L a?rfi;
i=1
and therefore the function that is defined by this vector is
n
Y = L a?(rfi; * x).
;=1

13.2 STRUCTURE ON THE SET OF REGULARIZED LINEAR FUNCTIONS
535
It is easy to check that the function that is defined by the vector that mini-
mizes the functional (13.13) is
n~
Ai
0
Y = LJ ~ai (ljJi *x).
i=1
I
Y
(13.15)
Suppose that the (nonnegative) eigenvalues Ai rapidly decrease with increas-
ing i. Then the values
8.-~
I
-
Ai + Y
are either close to zero (if Ai «
y) or close to one (if Ai »
y). In this situa-
tion by choosing different values of y one can control the number hef( = h(y)
of terms in expansion (13.15) that are essentially different from zero. In other
words, if the eigenvalues decrease rapidly, the regularization method realizes
the structural risk minimization principle where the structure is defined by ex-
pansion on first k eigenvectors. The number k of the element of the structure
Sk is defined by the constant y.
The method of effective number of parameters can be implemented for
support vector machines that use a reasonable number of training data (say,
up to several thousand). Let K(Xi,Xj) be the kernel that defines the inner
product in the feature space Z and let
be training data in the feature space. Let
B* = ZTZ
(13.16)
be an N x N covariance matrix of the training vectors in the feature space.
It is easy to show that the nonzero eigenvalues of B* matrix coincide with
eigenvalues of the f. x f. matrix K defined by the elements ki.j = K(Xi,Xj),
i,j = 1, ... ,f.:
Indeed consider the eigenvector corresponding to the largest eigenvalue A as
the expansion
l
V = LbiZi'
i=1
(13.17)
where bl , ... , bf. are coefficients that define the expansion.
According to the definition of eigenvectors and eigenvalues the equality
B*V = AV
(13.18)

536
13 SV MACHINES FOR FUNCTION ESTIMATION
holds true. Putting (13.16) and (13.17) into (13.18), one obtains the equality
f
f
L Zikijbj = AL bizi
i,j=l
i=l
from which, multiplying both sides by Zr, one obtains the equality
f
f
L ktikijbj = AL ktjbj .
iJ=l
j=l
The last equality can be rewritten in the short form
KKb = AKb,
where we denote by b the vector of expansion coefficients bl , ... , bf . Denoting
W=Kb
we obtain our assertion
KW =AW.
Therefore for a reasonable number of observations, one can estimate nonzero
eigenvalues in the feature space using the standard technique.
Knowing the eigenvalues Ai, i = 1, ...,f, one can calculate the effective
number of parameters herr for the SV machine with a quadratic loss function
where 'Y = lie. The effective number of parameters is used in the objective
functionals described in Sections 13.1.1 and 13.1.2.
13.2.3
The Method of Effective VC Dimension
Consider a method for estimating the VC dimension of learning machines by
measuring it in experiments with the machine itself. The estimated value (let
us call it effective VC dimension) can be used in functional (13.2) instead
of the actual value of the VC dimension in order to select the appropriate
model in the problem of function estimation.t
Since the VC dimension of the set of real-valued functions (x * a) + b,
a E A, b E Rl coincides with the VC dimension of the set of indicator func-
tions () {(x * a) + b}, a E A, bE R l , it is sufficient to find a method for mea-
suring the VC dimension of the set of indicator functions.
t We call the estimated value the effective VC dimension or for simplicity the estimate of VC
dimension. However, this value is obtained by taking into account values x of training data and
therefore can describe some capacity concept that is between the annealed entropy and the
VC dimension. This, however, is not very important since all bounds on generalization ability
derived in Chapters 4 and 5 are valid for any capacity concept that is larger than the annealed
entropy.

13.2 STRUCTURE ON THE SET OF REGULARIZED LINEAR FUNCTIONS
537
The idea of measuring the VC dimension of the set of indicator functions
is inspired by the technique of obtaining the bounds described in Chapter 4.
Let
Y E {O, I},
x E Rn
(13.19)
be training data. If in the training data yare real values, create artificial
training data with random zero-one values for y.
Using the same technique that was used in Chapter 4 for obtaining the
bound on maximal deviation between frequency on two subsamples, one can
prove that there exists such a monotonic decreasing-to-zero function $(t),
where t = £/h- is the ratio of the number of elements of the data to the
capacity, that the following inequality holds
{
(
If
1
21
)
}
E s:r £~ IYi - o{(Xi * a) + b}l- £i~IIYi - o{(Xi * a) + b}1
~ $ (~_ )
(13.20)
Using different concepts of capacity one obtains different expressions of
the function $ (:_ ). In particular
$ (i) < $- (H~n(2£)) < $- (G
A(2£)) < $- (In2£/h +1)
h-
-
£
-
£
-
£/h'
where H~n(2£) is the annealed entropy, GA(2£) is the growth function, and
h is the VC dimension.
Let us hypothesize that there exists such a capacity parameter h- called
the effective VC dimension (which can depend on an unknown probability
measure on X) and such universal function $ (:_) that for any fixed set
of functions f(x, a) and for any fixed probability measure on X the equality
(not only the inequality as (13.20)) is valid:
{
(
1
f
1
2f
)}
E s:r £~ IYi - 0{(Xi * a) + b}I- £i~l Iy - 0{(Xi * a) + b}I
=$(:_)
(13.21)
Suppose that this hypothesis is true: There exists a universal function $(t), t =
£/ h-, such that (13.21) holds. Then in order to construct the method for
measuring the VC effective dimension of the set of indicator functions
o{(x * a) + b}, one needs to solve the following two problems:

538
13 SV MACHINES FOR FUNCTION ESTIMATION
1. Using training data define the experiment for constructing random
values
(
1
f
k
1
2£k
)
gf; = sup
£" L IYi - O{(Xi * a) + b}l- £" L
IYi - O{(Xi * a) + b}1
(l,b
k. i=l
k.
i=f~+l
2. Find a good approximation to the universal function <I> (~) .
Having solved these two problems, estimate the VC dimension as follows:
1. For different fk. define the values gk., that is, define the pairs
(13.22)
2. Choose the parameter h' of the universal function E gf = <I> (:. ) that
provides the best fit to the data (13.22).
How to Construct a Set of Examples. To construct a set of examples
(13.22) using the data (13.19) do the following:
1. Choose (randomly) from the set of data (13.19) a subset of size Uk'
2. Split (randomly) this subset into two equal subsets:
3. Change the labels Yi in the first subset to the opposite Yi = 1 - Yi.
4. Construct the new set of data
(13.23)
containing first the subset with changed labels and second the subset
with unchanged labels.
5. Minimize the empirical risk
(13.24)
in a set of indicator functions with parameters a E A. Let a* and b* be
the parameters that minimize the empirical risk (13.24). Then (f/(, gf'),
where
1
f k
1
Uk
gf~ = £"L IYi - O{(Xi * a*) + b*}I- £" L IYi - O{(Xi * a*) + b*}I,
k i=l
k. i=f+l

13.2 STRUCTURE ON THE SET OF REGULARIZED LINEAR FUNCTIONS
539
is the desired pair. Indeed, it is easy to check that
~/k = 1 - 2Remp(a', b').
(13.25)
6. Repeating this experiment several times for different k, one obtains set
(13.22).
How to Approximate the Function 4> (~). To construct the function
<I> (~), one uses a machine with known VC dimension h to create the ex-
amples (13.22). Then by using these examples one can construct the function
<I>(t), t = ~ as a regression.
The idea behind this method of measuring the VC dimension is very sim-
ple. Create a sample (13.23) that does not lead to generalization (the proba-
bility of correct answers for the problem is 0.5). Estimate the expectations of
the empirical risk for different number of such examples. For these examples
the expectations of empirical risk can be less than 0.5 only due to the capacity
of the set of function but not due to the generalization. Knowing how the
expectation of the minimum of empirical risk increases with increasing the
number of observations one can estimate the capacity.
Choosing a Regularization Parameter for Ridge Regression. Sup-
pose that our machine can effectively control the capacity. For example the
ridge-regression machine that in order to minimize the error, minimizes the
functional
1
21k
R(a) = U L(Y - (Xi * a) - b)2 + yea *Aa).
(13.26)
k
i=1
For this machine the capacity is controlled by parameter y. For fixed capac-
ity (fixed y ::> 0) using various samples of size f k we obtain the parameters
ark' bpk that provide minimum to functional (13.26) on data (13.23). We use
these parameters in (13.24) to estimate Remp(a', b') and then use the values
~fk (13.25) in sequence (13.22)0
To estimate the effective VC dimension we use the following universal
function <I>(t), t = (~):
<I>(t) = { ~.16 In2t +1(1 +
t - 0.15
if t S; ~
1
1.2(t - 0015))'f
1
+
In 2t +lit > 2'
Note that this approximation up to the values of the constants coincides
with the functions that define bounds in Chapter 4.

540
13 SV MACHINES FOR FUNCTION ESTIMATION
Table 13.1. Number of Independent coordinates and effective VC dimension
obtained from the measurements of Ieamlng machines
Number of independent coordinates:
40
30
20
10
Effective VC dimension:
40
31
20
11
13.2.4
Experiments on Measuring the Effective VC Dimension
The following experiments with measuring the effective VC dimension show
that the obtained values provide a good estimate of the VC dimensions.
Example 1. Consider the following classifier: The classifier maps n-dimen-
sional vectors x into n-dimensional vectors z using some degenerate linear
transformation where only m coordinates of input vector x are linearly inde-
pendent. In Z space the classifier constructs a linear decision rule.
For such a machine the VC dimension is equal to m, the number of linear
independent coordinates. Using the described measuring method (with 'Y = 0
in functional (13.26)), we obtained results presented in Table 13.I.
Table 13.1 describes the experiments with four different machines that
have the same dimensionality of the input space n = 50 and different number
of linear independent coordinates in Z space (40, 30, 20, and 10).
o
h = 40
h = 31
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3 -
0.2
0.1oo"-------'----L--
5
10
15
{fh
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3-
0.2
0.1 -
°o"-------'----L--
5
10
15
{fh
h = 20
15
h = 11
5
10
{Ih
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
00
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1 -
°o'---------'-------L--
5
10
15
Llh
FIGURE 13.6. The best fit to the universal curve in experiments for estimating the VC
dimension of machines with degenerating mapping.

13.2 STRUCTURE ON THE SET OF REGULARIZED LINEAR FUNCTIONS
541
Figure 13.6 shows the best fit to the universal curve for this experiment to
the fitting curve <I> (~) .
r
= 10-4 , h = 23, MSE = 0.0009
1,------,-----,----,
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1o'-------'---'-----'----'------' [I h
o
2
4
8
10
Example 2. Let us estimate the effective VC dimension of the SV machine
r
= 10-5, h = 66, MSE = 0.0014
1.-------------.------,.--,
0.9
0.8 -
0.7
0.6
0.5
0.4
0.3
0.2
0.1o
Dh
012
r = 10-6 , h = 173, MSE = 0.00003
r = 10-7, h = 337, MSE = 0.00006
1
1
0.9
0.9 f-
"
-
0.8 ~
0.8 -
-
0.7
0.7 f-
-
0.6
0.6 '-
-
0.5
0.5 -
-
0.4
0.4 -
-
0.3
0.3 -
-
0.2
0.2 -
-
0.1
0.1 -
-
0
[/h
0
I
[/h
0
1
2
0
1
2
(a)
h
400,--,----,----,----.-------,.--,--,----,
350
300
250
200
150
100
50
o
log r
-8-7-6-5-4-3-2-1 0
(b)
FIGURE 13.7. (0) The best fit to the universal curve in experiments for estimating the
effective VC dimension of the SV machine with an RBF kernel for different regularization
parameters 'Y. (b) The estimate of effective VC dimension of the SV machine with a
fixed RBF kernel as the function of values 'Y.

542
13 SV MACHINES FOR FUNCTION ESTIMATION
-
-
g = 0.1, h = 175, MSE = 0.00017
1,----------,
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1o L--
L--I_ _-----.J fth
012
g = 0.5, h = 405, MSE = 0.00033
1
I
0.9
"
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1o
fth
o
2
h
g = 0.3, h = 293, MSE = 0.00016
1.--------,------,
0.9
0.8
"-
0.7
,
0.6
0.5
0.4
0.3
0.2
0.1o
fth
o
1
2
g = 0.6, h = 458.35, SSE = 0.00047
1.----,------,
0.9 -
1
0.8
"-
0.7
-
~
0.6f-
0.5
OAf-
0.3
0.2 -
0.1 -
o L.--.__-----'I
-----' [;h
o
1
2
(a)
600 -
500 -
400
300
200 -
100
000102030405060708091
g
(b)
FIGURE 13.8. (a) The best fit in experiments for estimating the effective VC dimension
of the SV machine with an RBF kernel for different parameters width 9 and fixed
regularization parameter y. (b) The estimate of effective VC dimension depending on
parameter g.
with the radial basis function kernel K(x,y) = exp {_g2(X - y)2} defined in
256-dimensional space. In these experiments we fix the parameter of width
g and estimate the effective VC dimension for different regularization pa-
rameters y. The experiment was conducted using the U.S. Postal Service
database.

13.3 FUNCTION APPROXIMATION USING THE SV METHOD
543
Figure 13.7a shows the best fit to the universal curve in experiments for
estimating the effective VC dimension of the SV machine with a fixed RBF
kernel and different regularization parameters y. Figure 13.7b shows the
function that defines the effective VC dimension depending on y. Every point
on the plot is an average over 10 measurements. The following is shown: the
value of parameter y, the estimated effective VC dimension h, and the mean-
squared deviation of the measurements from the universal curve.
Figure 13.Sa shows the best fit to the universal curve in experiments for
estimating the effective VC dimension of the SV machine with RBF functions
with different values of parameter g and fixed regularization parameter y.
Figure 13.Sb shows the estimate of effective VC dimension of the SV machine
with an RBF kernel depending on parameter g. Every point on the plot is
an average of more than 10 measurements. The following are shown: the
values of parameterg, the estimated effective VC dimension h, and the mean-
squared deviation of the measurements from the universal curve.
The experiments were conducted for the U.S. Postal Service database.
13.3
FUNCTION APPROXIMATION USING THE SV METHOD
Consider examples of solving the function approximation problem using the
SV method. With the required level of accuracy 8 we approximate one- and
two-dimensional functions defined on a uniform lattice Xi = ia/ £ by its values
Our goal is to demonstrate that the number of support vectors that are used
to construct the SV approximation depends on the required accuracy 8: The
less accurate the approximation, the lower the number of support vectors
needed.
In this section, to approximate real-valued functions we usc linear splines
with an infinite number of knots.
First we describe experiments for approximating the one-dimensional sine
function
f(x) = sin(x - 10)
x -10
(13.27)
defined on 100 points of the uniform lattice of the interval 0 <:::: x
<:::: 20.
Then we approximate the two-dimensional sine function
f(x,y) = sin J(x - 10)2 + (y - 10)2
J(x - 10)2 + (y - 10)2
(13.28)
defined on the points of the uniform lattice in 0 <:::: x <:::: 20, 0 <:::: y
<:::: 20.
To construct the one-dimensional linear spline approximation we use the

544
13 SV MACHINES FOR FUNCTION ESTIMATION
kernel defined in Chapter 11, Section 11.7:
1
2
(XI\Xc)3
K(X,Xi) = 1 +XiX+ 21x - xil(x 1\ Xi) +
3
We obtain an approximation in the form
N
Y = I::(at - adK(x, Xi) + b,
i=1
where the coefficients a* and aj are the solution of the quadratic optimization
problem defined in Chapter 11.
Figures 13.9 and 13.10 show approximations of the function (13.27) with
different levels of accuracy. The circles on the figures indicate the support
vectors. One can see that by decreasing the required accuracy of the approx-
imation, the number of support vectors decreases.
f = 0.01, 39 SV /100 total
1,-----,----,----r-,--------=-----,--,---,-----,~
0.8
0.6 -
0.4
0.2 -
o
-0.2
-0.4 L-----'----------"--------.L_-L-----'--------'--_L-----'----------'--------'
-10 -8 -6 -4 -2
0
2
4
6
8
10
(a)
f =0.05, 14 SV / 100 total
Support vectors
Estimated function
Non-support vectors
Original function
-0.4 L----l.------L-----"_..l-----'--------L_L..---'-------'-------"
-10 -8 -6 -4 -2
0
2
4
6
8
10
(b)
FIGURE 13.9. Approximations with a different level of accuracy requires a different
number of support vectors: (0) 39 SV for B = 0.01, (b) 14 SV for B = 0.05.

13.3 FUNCTION APPROXIMATION USING THE SV METHOD
545
E = 0.1, 10 SV /100 total
1.----,----r-;----,---.."..,---,;--...,....--,----,-----,
0.8
0.6
0.4
0.2
a ,"
-0.2
-0. 4 '-------'-------'--_'-------'-------'-------l_--'-------'------'-------'
-10 -8 -6 -4 -2
a
2
4
6
8 10
(a)
E =0.2,6 SV / 100 total
Support vectors
Estimated function
Non-support vectors
Original function
."
\i
\.\
.~.,
\
.".-'..
0'"
,
--....::.j;
...._.'
1 .----,----r-;----,--""7!"'"---,-...,....--,----,-----,
0.8
0.6
0.4
0.2
-0.2
-0.4 '--------'----------'---------"'------'----------'-------'_--'---------'--------'------.J
-10 -8 -6 -4 -2
a
2
4
6
8
10
(b)
FIGURE 13.10. Approximations with a different level of accuracy requires a different
number of support vectors: (a) 10 SV for £ = 0.1. and (b) 6 SV for £ = 0.2.
To approximate two-dimensional sinc function (13.28) we used the kernel
K(X,Y;Xi,Yi)
K(X,Xi)K(Y,Yi)
(
1
2
(x t\ Xi)3)
1 + XXi + 2"lx - X;! (t\Xi)
+
3
(
1
I
2
(y t\Yi)3)
x
1 + YYi + 2"IY - Yi (y t\ Yi)
+
3
'
which is defined by multiplication of the two one-dimensional kernels.
We obtain an approximation in the form
N
Y = 2)at - ai)K(x,Xi)K(Y,Yi) + b,
i=1

546
13 SV MACHINES FOR FUNCTION ESTIMATION
where coefficients u* and u are defined by solving the same quadratic opti-
mization problem as in the one-dimensional case.
Figure 13.11 shows the two-dimensional sinc function and its approxima-
tion with the required accuracy 6 = 0.03 approximated using lattices with 400
points. Figure 13.12 shows the approximations obtained with the same accu-
racy 6 = 0.03 using different number of grid points: 2025 in Fig. 13.12(a), and
7921 in Fig. 13.12(b). One can see that changing the number of grid points by
a factor of 20 increases the number of support vectors by less than a factor
of 2: 153 SV in Fig. 13.11(b), 234 SV in Fig. 13.12(a), and 285 SV in Fig.
13.12 (b).
13.3.1
Why Does the Value of E Control the Number of Support
Vectors?
The following model describes the mechanism of choosing the support vectors
for function approximation using the SV machine with an 6-insensitive loss
function.
Suppose one would like to approximate a function f(x) with the accuracy
6-that is, to describe function f(x) by another function f* (x) such that
the function f(x) is situated into the 6 tube of f*(x). To construct such a
function let us take an elastic 6 tube (a tube that tends to be flat) and put
function f(x) into the 6 tube. Since the elastic tube tends to become flat.
it will touch some points of function f(x). Let us fasten the tube at these
points. Then the axis of the tube defines the 6 approximation f* (x) of the
function f(x), and coordinates of the points where the 6-tube touches the
function f(x) define the support vectors. The kernel K(Xi' Xj) describes the
law of elasticity.
Indeed, since the function f(x) is in the 6 tube, there are no points of
the function with distance of more than 6 to the center line of the tube.
Therefore the center line of the tube describes the required approxima-
tion.
To see that points which touch the 6-tube define the support vectors, it is
sufficient to note that we obtained our approximation by solving an optimiza-
tion problem defined in Chapter 11 for which the Kuhn-Tucker conditions
hold. According to definition the support vectors are the ones for which in
the Kuhn-Tucker condition the Lagrange multipliers are different from zero
and hence the second multiplier must be zero. This multiplier defines the
border points in an optimization problem of inequality type-that is, coordi-
nates where the function f(x) touches the 6 tube. The wider the 6 tube, the
lower the number of touching points.
This model is valid for the function approximation problem in any number
of variables.
Figure 13.13 shows the 6-tube approximation that corresponds to the case
of approximation of the one-dimensional sinc function with accuracy 6 =
0.2.

13.3 FUNCTION APPROXIMATION USING THE SV METHOD
547
Original function - - -
0.5
o
-0.5
(a)
E = 0.03. 153 SV/400 total
Support vectors
<>
Estimated function
0.5
o
-0.5
(b)
FIGURE 13.11. Two-dimensional sine function (a) and its approximation with accuracy
0.03 obtained using 400 grid points. (b) The approximation was constructed on the
basis of 153 SV (squares).

548
13 SV MACHINES FOR FUNCTION ESTIMATION
E =0.03,234 SV/2025 total
Support vectors
<)
Estimated function
0.5
o
-0.5
(a)
E = 0.03, 285 SV/7921 total
0.5
o
-0.5
(b)
FIGURE 13.12. Approximations to two-dImensional slnc function defined on the latlices
containing different numbers of grid points with the same accuracy e = 0.03 does
not require a big difference In the number of support vectors: (d) 234 SV for the
approximation constructed using 2025 grid points. and (b) 285 SV for the approximation
constructed using 7921 grid points.

13.4 SV MACHINE FOR REGRESSION ESTIMATION
549
t: =0.2
~l
1
,
l'
, \
,
,
,
T
, iT}, '
" liT
TT
.nl ll
r
.~
r: j
I
11.1
II'
[
1
11·
·.L 1
-'. 1 .l-
4
4
1
0.8
0.6
0.4
0.2
o
-0.2
-0.4
-10
-8
-6
-4
-2
o
2
4
6
8
10
FIGURE 13.13. The e-tube model of function approximation.
13.4
SV MACHINE FOR REGRESSION ESl'IMATION
We start this section with simple examples of regression estimation tasks
where regressions are defined by one- and two-dimensional sinc functions.
Then we consider estimating multidimensional linear regression functions us-
ing the SV method. We construct a linear regression task that is favorable
for a feature selection method and compare results obtained for a forward
feature selection method with results obtained by the SV machine. Then we
compare the SV regression method with new nonlinear techniques on three
multidimensional artificial tasks suggested by J. Friedman and one multidi-
mensional real-life (Boston housing) task (these tasks are usually used in
benchmark studies of different regression estimation methods).
13.4.1
Problem of Data Smoothing
Let the set of data
be defined by the one-dimensional sinc function on the interval [-10, 10]; the

550
13 SV MACHINES FOR FUNCTION ESTIMATION
values y; are corrupted by noise with normal distribution
sinx
y; = -- +t;,
x
O
2
2
Et, = , Et; = a .
The problem is to estimate the regression function
sinx
y=-
x
from 100 observations on uniform lattice of interval [-10, 10].
Figures 13.14 and 13.15 show the results of SV regression estimation ex-
periments from data corrupted by different levels of noise. The rectangles in
the figures indicate the support vectors. The approximations were obtained
using linear splines with infinite number of knots.
Figures 13.16, 13.17, and 13.18 show approximation of the two-dimensional
regression function
sin Jx 2 + y2
y= -~~,.-
Jx2 +y2
defined on a uniform lattice on the interval [-10, 10] x [-10, 10]. The ap-
proximations where obtained using a two-dimensional linear with an infinite
number of knots.
13.4.2
Estimation of Linear Regression Functions
This section describes experiments with SV machines in estimating linear
regression functions (Drucker et aI., 1997).
We compare the SV machine to two different methods for estimating the
linear regression function, namely the ordinary least square method (OLS)
and the forward stepwise feature selection (FSFS) method.
Recall that the OLS method is a method that estimates the coefficients of
a linear regression function by minimizing the functional
f
R(a) = l)y, - (a *x;))2.
;=1
The FSFS method is a method that first chooses one coordinate of the vector
that gives the best approximation of data. Then it fixes this coordinate and
adds a second coordinate such that these two define the best approximation of
the data, and so on. One uses some technique (Le., the functionals described
in Section 13.1) to choose the appropriate number of coordinates.
We consider the problem of linear regression estimation from the data

13.4 SV MACHINE FOR REGRESSION ESTIMATION
551
a =0.05, E =0.075, C =1,15 SV/100 total
1.2 r----r---y----,---r---T""""--.,..----,---,----,----..,
0.8
iC>
.J.~ +
" .
if/+
...,
:
.14-
:
.''/
... "!,..
Support vectors
Estimated function
Nonsupport vectors
Original function
+
10
8
6
~
~
0
2
4
(a)
a =0.2, E =0.3, C =1, 14 SV/100 total
-6
-0.4 '--_---''--_---'__---'-__---1..__--'-__.........__""''''-__--'-__-'-_---'
-10
1.4 r------r-----r--.,----r---,----,----,------r--,.....---,
1.2
Support veclors
<>
Estimated function
Nonsupport vectors
+
Original function
+
-0.4
+
+
+
<>
-0.6 '--_--'__----"__---L__.........__--'-__--'-__--'-__-'-__-'-
__
·10
-8
-6
~
-2
0
2
4
6
B
10
(b)
FIGURE 13.14. The regression function and it approximations obtained from the data
with different levels of noise and different values e: fT= 0.05 and e= 0.075 in (0); fT =
0.2
and e = 0.3 in (b). Note that the approximations were constructed using approximately
the same number of support vectors (14 in part (0) and 15 in part (b».

552
13 SV MACHINES FOR FUNCTION ESTIMATION
(J =0.5, £ =0.75, C = 1, 14 SV/l00 lotal
2r----.----r--r--~--""T""--,....--,.___-~--_._-___.
1.5
~! +
+
,
Support vectors
<>
Estimated function
Nonsupport vectors
+
Original function
<>
0.5
a
-0.5
·1
<>
+
+
+
+
+
+
+
<>
+
0
<>
o
-1.5
-10
-6
-4
-2
a
2
4
(al
a =0.5. £ = 0.1, C = 0.2, B1 SV/l00 total
6
8
10
2r----..---,..---,..---..----r----.-----,-----.----r-----,
1.5
i
<>
<>
Support vectors
0
Estimated function
Nonsupport vectors
+
Original function
o
0.5
a
0
0"
¢
~,
-0.5
P
-1
o
o
10
8
6
4
2
-2
-4
-6
-8
-1.5 l-..__1.-__.L-__.L.-__..L-..__..L-__..L...__-'-__---L__-l...__--l
-10
o
(b)
FIGURE 13.15. The regression function and its approximations obtained from the data
with the same level of noise u = 0.5 and different values of 8 (8 = 0.25 in (0) and
8 = 0.15 in (b». Note that different value of 8 imply a different number of support
vectors in approximating function: 14 in (0) and 81 in (b».

13.4 SV MACHINE FOR REGRESSION ESTIMATION
553
a =0.1, E =0.15, 107 SVl400 total
Estimated function ---
.Q.5
(a)
Support vectors
0
0
0
00
00
o~
0
<>
0 0
0
<>
0
0
0.5
<>
<>
00
0
0<>
00
<>
0
0
0 •
0<>
0
0
0
0
0
0
~
«>
00
0
0
<>
<>
0
.Q.5
0
0
(b)
FIGURE 13.16. (0) The approximation to the regression and (b) 107 support vectors.
obtained from the data set of size 400 with noise a == 0.1 and B == 0.15

554
13 SV MACHINES FOR FUNCTION ESTIMATION
(j =0.1, £ =0.25, 159 SV/3969 total
Estimated function ---
-0.5
(a)
support vectors
0
1.5
()
0
¢
¢¢o
o
0
¢
¢
¢
0.5
0(>0
¢
¢
<>
¢
<:>
<:l:)¢ ¢
<>
¢
¢
a
¢
¢
¢¢ ¢~
¢
<>
o¢t
()
~
0
-0.5
0
<>
¢
o
¢
<>
~
<>
<:>
<>
(b)
FIGURE 13.17. (a) The approximation to the regression and (b) 159 support vectors
obtained from the data set of size 3969 with the same noise a = 0.1 and e = 0.25.

13.4 SV MACHINE FOR REGRESSION ESTIMATION
555
a =0.1, e =0.15, 649 SV/3969 total
Estimated function ----.
0.5
o
-0.5
(al
Support vectors
0
1.5
0.5
o
o od>
-0.5
(bl
FIGURE 13.18. (0) the approximation to the regression and (b) 649 support vectors
obtained from the data set of size 3969 with the same noise u = 0.1 and E: = 0.15.

556
13 SV MACHINES FOR FUNCTION ESTIMATION
Table 13.2. Resu" of compartson ordinary least-squared (OLS), forward step
feature selection (FSFS), and support vector (SY) methods
SNR
Normal
Laplacian
Uniform
OLS
FSFS
SV
OLS
FSFS
SV
OLS
FSFS
SV
0.8
45.8
28.0
29.3
40.8
24.5
25.4
39.7
24.1
28.1
1.2
20.0
12.8
14.9
]8.1
11.0
12.5
17.6
11.7
12.8
2.5
4.6
3.]
3.9
4.2
2.5
3.2
4.]
2.8
3.6
5.0
1.2
0.77
1.3
1.0
0.60
0.52
1.0
0.62
1.0
in 30-dimensional vector space x = (x(l), ..., x(30)) where the regression func-
tion depends only on three coordinates
30
y(x) = 2x;1) +x(2) +x?) + 0Lx(k)
;=4
(13.29)
and the data are obtained as measurements of this function at randomly
chosen points x. The measurements are done with additive noise
that is independent of Xi.
Table 13.2 shows that for large noise (small SNR) the SV regression gives
results that are close to (favorable for this model) FSFS method, which is
significantly better than the OLS method.
The experiments with the model
demonstrated the advantage of SV technique for all levels of SNR defined
in Table 13.2.
13.4.3
Estimation of Nonlinear Regression Functions
For these regression estimation experiments we chose regression functions
suggested by Friedman (1991) that were used in many benchmark studies:
1. Friedman model #1 considered the following function of 10 variables
(13.30)
This function, however, depends on only five variables. In this model the
10 variables are uniformly distributed in [0, 1J and the noise is normal
with parameters N(O, 1).

13.4 SV MACHINE FOR REGRESSION ESTIMATION
557
2. Friedman model #2,
has four independent variables uniformly distributed in the following
region:
o < x(1) < 100
-
-
,
4077" < x(2) < 56077"
-
,
o < x(3) < 1
-
-,
1 S x(4) S 11.
The noise is adjusted for a 3:1 SNR.
3. Friedman model #3 also has four independent variables
(13.31)
(13.32)
that are uniformly distributed in the same region (13.31). The noise was
adjusted for a 3:1 SNR.
In the following, we compare the SV regression machine with the ad-
vanced regression techniques called bagging (Breiman, 1996) and AdaBoostt
(Freund and Schapire, 1995), which construct committee machines from the
solutions given by regression trees. The experiments were conducted using
the same format (Drucker, 1997; Drucker et al., 1997).
Table 13.3 shows results of experiments for estimating Friedman's func-
tions using bagging, boosting, and a polynomial (d=2) SV methods. The
experiments were conducted using 240 training examples. Table 13.3 shows
Table 13.3. Comparison 01 bagging and boosted
regression trees with SV regression trees with SV
regression In solving three Friedman tasks
Bagging
Boosting
SV
Friedman #1
2.2
1.65
0.67
Friedman #2
11.463
11.684
5.402
Friedman #3
0.0312
0.0218
0.026
t AdaBoost algorithm was proposed for pattern recognition problem. It was adopted for regres-
sion estimation by H. Drucker (1997).

558
13 SV MACHINES FOR FUNCTION ESTIMATION
Table 13.4. Performance of Boston housing task for
different methods
Bagging
Boosting F SV I
---1-2-.4--~----1-0-.7------,
7.2
Table 13.5. Performance of Boston housing task for different
methods
MARS-l
14.37
MARS-3
15.91
POLYMARS
14.07
an average of more than 10 runs of the model error (mean square deviation
between real regression function and obtained approximation).
Table 13.4 shows performance obtained from the Boston housing task
where 506 examples of 13-dimensional real-life data where used as follows:
401 randomly chosen examples for the training set, RO for the validation set
and 25 for test set. Table 13.4 shows results of averaging more than 100 runs.
The SV machine constructed polynomials (mostly of degree 4 and 5) chosen
on the basis of validation set. For the Boston housing task, the performance
shows the mean squared difference between predicted and actual values y
on the test set.
Table 13.5 shows performance of the classical statistical methods for solv-
ing the Boston housing task: MARSI (multivariate adaptive regression spline,
lint:ar-Friedman, 1991), MARS3 (multivariate adaptive regression spline,
cubic), and POLYMARS (MARS-type method) reported by Stone et al.
(1997). The direct comparisons, however, could not be done because the ex-
periments were conducted under different formats: 303 random chosen data
were used as the training set and 202 as the test set. The performance shows
the mean squared difference between predicted and actual values y on the
test set.
13.5
SV ME'rHOD FOR SOLVING THE POSITRON EMISSION
TOMOGRAPHY (PET) PROBLEM
In this section we consider the PET problem as an example of a solution of
a linear operator equation using the SV technique.
13.5.1
Description of PET
Positron emission tomography is a medical diagnostic technique that involves
the reconstruction of radio activity within the body following the injection or
inhalation of a tracer labeled with a positron emitting nuclide. The mechanism
of PET is the following: During the disintegration of the radioactive nucleus

13.5 SV METHOD FOR SOLVING THE PET PROBLEM
559
Radioactive source
1
Detector 1
Line of response
FIGURE 13.19. Scheme of PET measurements.
Detector 2
collected in the body, positrons are emitted. These positrons collide with
nearby electrons, resulting in the annihilation of the electron and positron
and the emission of two gamma rays in opposite directions. Figure 13.19
shows two directions on opposite sides of a radioactive source. From each
point within the source, a gamma ray pair can be emitted in any direction.
Two-dimensional PET, however, only takes into account the rays that belong
to one fixed plane. In this plane if a gamma ray hits a detector 1 and then
within a small time interval another gamma ray hits detector 2, then it is
known that an emission must have accrued from a point somewhere along
the line A - B joining these two detectors, the so-called line of response.
This event is called a coincidence. The total number of coincidences for this
pair of detectors is proportional to the integral of the tracer concentration
along the line A-B. In order to obtain regional (in the plane) information
about the tracer distribution, a large number of detector pairs with lines of
response at many different angles are given. The set of all detector pairs
whose lines of response are at a given angle J.L form a J.L projection. The set
of all projections form a sinogram. Figure 13.20 illustrates two projections,
each with six lines of response, and the corresponding sinogram.
Typically there are between 100 and 300 of these projection angles, J.Lj, with
each projection having between 100 and 200 lines of response mi' This gives
Projection angle 0
Ring of -t
detectors
Line of
response
x x x x x x
x x x x
Sinogram
FIGURE 13.20. Scheme of data collection in the 2D PET problem.

560
13 SV MACHINES FOR FUNCTION ESTIMATION
between 10,000 and 60,000 of lines of response, each with a corresponding
recorded number of coincidences p(mkl J.Ld. Therefore we are given etriplets
mk, J.Lk,p(mk, J.Ld called observations. The problem is given the set of obser-
vations (sinogram) to reconstruct the density of nuclear concentration within
a given plane of the body.
13.5.2
Problem of Solving the Radon Equation
Consider Fig. 13.21, which shows a line of response inclined at the angle
J.L to the y axis and at a distance m from the origin. Let the circle that
contains the detectors have radius 1. Suppose that coincidence count p(m, J.L)
is proportional to the integral of the concentration function f(x, y) along
the line defined by a pair m, J.L. The operator, called the Radon tramform
operator, defines the integral of f(x, y) along any line
!
~
Rf(x, y) =
,f(m cos J.L + It sin J.L, m sin J.L -
It cos J.L) du = p(m, J.L),
-Vt-m-
(13.33)
where coordinates x and y along the line are defined by the equations
x
y
m cos J.L + It sin J.L,
m sin J.L - u cos J.L
(13.34)
and the position of the line is defined by the parameters
-1<m<1,
y
1
o::; J.L ::; 1T.
-1
-1
x
FIGURE 13.21. Parameters of the Radon equation.

13.5 SV METHOD FOR SOLVING THE PET PROBLEM
561
The interval of integration is defined by
-am = -VI - m 2 SUS VI - m 2 = +am·
The main result of the theory of solving the Radon equation (given func-
tion p(m, J.L), find the function f(x, y) satisfying Eq. (13.33)) is that under
wide conditions there exists the inverse operator
In other words, there exists a solution to the Radon equation. However,
finding this solution is an ill-posed problem.
Our goal is to find the solution to this ill-posed problem in a situation
where function p(m, J.L) is defined by its values Pk in a finite number £ of
points mk, J.Lkl k = 1, ... ,e. Moreover, the data are not perfect: They are cor-
rupted by some random noise
In other words, the problem is as follows: Given measurements
find the solution to the Radon PET equation (1.33). Therefore we face the
necessity of solving a stochastic ill-posed problem.
13.5.3
Generalization of the Residual Principle of Solving PET
Problems
According to the theory for solving stochastic ill-posed problems described
in the Appendix to Chapter I and in Chapter 7, in order to find the solution
to the operator equation
Af(t) = F(x)
(13.35)
using approximation Fl(x) instead of the exact right-hand side F(x) of equa-
tion (13.35), one has to minimize (in a given set of functions {t(t)}) the
regularized functional
R = IIAf(t) - F*(x)11
2 + yW(f),
where y > 0 is some regularization constant, and W (f) is a regularizing func-
tional.
In the PET problem, where we are given a finite number of measurements,
usually one considers the following functional:
l
(
1
) 2
R(f) =f; ('-L/(m, cos IL' +11 sin IL', m, sin IL, - II cos ILkldll
+ YW(f).

562
13 SV MACHINES FOR FUNCTION ESTIMATION
One also considers the set of piecewise constant or piecewise linear functions
{I(x, y)} in which one is looking for the solution.
In Section 11.11, when we considered the problem of solving an integral
equation with an approximately defined right-hand side we discussed the idea
of the residual method:
Suppose that solving the linear operator equation (13.35) with approx-
imation Ff (x) instead of F(x), one has information about the accuracy of
approximation
.1 = IIF(x) - Fp(x))ll.
In this situation the residual method suggests that we choose the solution
f -y (t) which minimizes the functional W (I) and satisfies the constraint
IIAf-y(t) - Fp(x))11 -s; .1.
For the PET problem, one cannot evaluate the exact value of .1; the result
of the measurement is a random event, the stochastic accuracy of which
is characterized by the variance. The random variation in the number of
coincidences along any line of response can be characterized as follows:
Therefore for the PET problem one can use a stronger regularization idea,
namely to minimize the functional W (j) subject to constraints
kk - f:~~'f-y(mkCOSlJ-k+usinlJ-k' mksinlJ-k -UCOSlJ-k)dUI ~ Deb (13.36)
where D> 0 is some constant. In Chapter 11 we show that the SV method
with an e-insensitive loss function (with different ej for different vectors Xj) is
the appropriate method for solving such problems. However, before applying
the SV method for solving linear operator equations to the PET equation,
let us briefly mention existing classical ideas for solving the PET problem.
13.5.4
The Classical Methods of Solving the PET Problem
The classical methods of solving the PET problem are based on finding the
solution in a set of piecewise constant functions. For this purpose one can
introduce the n x n = N pixel space where in any pixel one considers the
value of the function to be constant. Let e be the number of measurements.
Then one can approximate the integral equation (13.35) by the algebraic
equation
Ax = b,
x ~ 0,
(13.37)
where A E RfxN is a known matrix, x E RN is a vector that defines the values
of the approximating function in the set of pixels, and b E RP is a vector that
defines the number of coincidences along the lines of response.

13.5 SV METHOD FOR SOLVING THE PET PROBLEM
563
The regularized method for the solution of Eq. (13.37) is the following:
Minimize the functional
R=(b-Ax)(b-Ax)T +y(x*x),
(here we use W (x) = (x *x). One can use other regularizers as well.)
The residual principle for solving this problem led to the following state-
ment: Choose a regularization parameter y for which the solution x* mini-
mizes the functional (x, x) and satisfies the constraints
f
bk - L ai,kxk
~ 8k,
i=l
where bk is a coordinate of vector b, x;* is a coordinate of vector x*, and ai.k
is an element of matrix A.
The main problem with solving this equation is its size: As we mentioned,
the size of M is ~ 10,000-60,000 observations and the number of parameters
N to be estimated is ~ 60,000 (N = 256 x 256).
This is a hard optimization problem. The classical methods of solving PET
considered various ideas of solving this equation.
The main advantage of the SV method is that when using this method one
does not need to reduce the solution of the PET problem to solving of the
system of linear algebraic equations with huge number of variables.
13.5.5
The SV Method for Solving the PET Problem
We are looking for a solution of the PET problem in the set of two-dimen-
sional spline functions with an infinite number of nodes. Below to simplify the
formulas we consider (as in the classical case) piecewise constant functions
(splines of order d = 0 with an infinite number of knots). One can solve this
problem in other sets of functions, say by expansion on B splines or using
an expansion on Gaussians (there is a good approximation to B splines; see
Chapter 11, Section 11.7).
Thus, let us approximate the desired function by the expression
f(x,y) = [11
[~ O(x - t)O(y - r)r/J(t, r) dt dr,
(13.38)
where r/J(t, r) is an appropriate function of Hilbert space.
Putting this function in the Radon equation, we obtain the corresponding
regression problem in image space:
R [11
l~ O(x - t)O(y - r)r/J(t, r) dt dr
= llll~ R [O(x - t)O(y - r)] r/J(t, r) dt dr = p(m, J.L).
(13.39)

564
13 SV MACHINES FOR FUNCTION ESTIMATION
Consider the following functions:
<P(mk! ILk! t, T)
= RmA.J.l.JJ(X - t)O(y - T)
r+
Um
•
=
J~
O(mk cos ILk +usinILk - t)O(mksinILk -UCOSILk - T)du.
-Um•
(13.40)
Using this function, we rewrite equality (13.39) as follows:
k = 1, ..., e.
Thus, we reduce the problem of solving the PET equation in a set of
piecewise constant functions to the problem of regression approximation in
the image space using the data Pi, mi, ILi, i = 1, .", e. We would like to find
the function ljJ* (t, T) that satisfies the conditions
and that has a minimal norm. We will use this function in Eq. (13.38) to
obtain the solution of the desired problem.
To solve the PET problem using the SV technique, we construct two func-
tions: the kernel function in the image space
(13.41)
and the cross-kernel function
(13.42)
where the function <P(m, IL; t, T) is defined by expression (13.40).
To obtain these kernels in explicit form, we change the order of integration
in (13.41) and (13.42) and take into account the following equality:
[II [~ O(Xi - t)O(Xj - t)O(yi - T)O(yj - T) dt dT
= (2 + min(xi' xj))(2 + min(Yi, Yj))'

13.5 SV METHOD FOR SOLVING THE PET PROBLEM
565
We obtain the following expression for the kernel function:
K(mi, J.l.i;mj, J.l.j)
= jl jl <I>(mi, J.l.i;t, r)<I>(mj, J.l.j;t, r) dt dr
-I
-I
= /1 jl [Rm"iLr 0 (Xi - t)O (Yi - r)] x [Rmi'iLl 0 (Xj - t)O (Yj - r)] dt dr
-I
-I
~ R m,,",R m ,,", {1: 1: o(x; - t)O(Xj - t)O(y; - T)O(yj - T) dtdr}
rm jam
= La~
-a~ [2 + min {(mi cos J.l.i + UI sin J.l.i), (mj cos J.l.j + U2 sinJ.l.j)}]
,
I
x [2 + min {(mi sin J.l.i - UI cos J.l.i), (mj sin J.l.j - U2 cos J.l.j)}] dUI dU2.
(13.43)
We also obtain the following expression for the cross-kernel function:
K(mi, J.l.i,X,Y)
= /11/11 [Rm'.iL,O(Xi - t)O(yi - r)] x [O(x - t)O(y - r)] dtdr
~ R m,,", {/,1: o(x; - t)O(y; - T)O(X - t)O(y - T) }
= /:~ [2+min{(miCOSJ.l.i+uISinJ.l.i), x}]
,
x [2 + min {(mi sin J.l.i - UI cos J.l.i), y}] dUI.
(13.44)
After elementary but cumbersome calculations, one can compute these
piecewise polynomial integrals analytically.
Now to solve the PET problem on the basis of the SV technique, we need
to do the following:
First, using kernel function (13.43) we need to obtain the SV solution for
the regression approximation problem in image space. That is, we need to
obtain the support vectors (mk,
J.l.k),
k = 1, ..., N, and the corresponding
coefficients a"k - ak,
k = 1, ...,N.
Second, using the cross-kernel function (13.44), we need to use the ob-
tained support vectors and the obtained coefficients to define the desired
approximation
N
f(x,y) = 2:)a"k - ak)K(mk' J.l.k;X,y),
k=1
Note that for any support vector (mk, J.l.d in image space there is a corre-

566-
13 SV MACHINES FOR FUNCTION ESTIMATION
166 SVl2048 total
150
Estimated function ---
(a)
0.5
o
-0.5
-1
-1
·0.5
a
0.5
(b)
FIGURE 13.22. (0) Reconstructed image obtained on (b) the basis of 166 support lines.

13.6 REMARK ABOUT THE SV METHOD
567
sponding line of response in preimage space defined by the expression
x = mk cos J.Lk + u sin J.Lk ,
Y= mk sin J.Lk - Ucos J.Lk,
-J1 - m~ :::; U :::; J1 - mz·
Therefore in preimage space the expansion of the function on support vectors
(mkl J.Lk), k = 1, ..., N, actually means the expansion of the desired solution
on the lines of response.
Figure 13.22a shows a reconstructed image from 2048 observations in mod-
eling the PET scan. The obtained spline approximation (of order d = 0) was
constructed on the basis of 166 support vectors. Figure 13.22b shows the lines
of response corresponding to the support vectors.
13.6
REMARK ABOUT THE SV METHOD
In the last two chapters we described some examples of applying the SV
method to various function estimation tasks. We considered a wide range of
tasks, starting with a relatively simple one (estimating indicator functions)
and concluding with a relatively complex one (solving ill-posed operator
equations based on measurements of its right-hand side).
In all dependency estimation tasks we tried, the very straightforward
implementation of the SV approach demonstrated good results.
In the simplest dependency estimation problem-the pattern recognition
problem-we obtained results that were not worse than the results obtained
by the special state-of-the-art learning machines constructed for this specific
problem.
In the function approximation tasks we were able both to construct ap-
proximations using a very rich set of functions and to control the trade-off
between accuracy of approximation and complexity of the approximating
function.
In examples of regression estimation the achieved advantage in accuracy
compared to classical state-of-the-art methods sometimes was significant.
In the PET problem we did not create an intermediate problem-the pixels
representation. We solved this problem in functional space.
In solving all the described examples we did not use any engineering. It
is known, however, that special tailoring of the methods for the problem at
hand is an important source of performance improvement. The SV approach
has a rich opportunity for such tailoring.


III
STATISTICAL FOUNDATION
OF LEARNING THEORY
Part /II studies uniform laws of large numbers that make generalization
possible.


14
NECESSARY AND SUFFICIENT
CONDITIONS FOR
UNIFORM CONVERGENCE
OF FREQUENCIES TO
THEIR PROBABILITIES
The last three chapters of this book studies the convergence of empirical
processes. In this chapter we derive the necessary and sufficient conditions
of uniform two-sided convergence of the frequencies to their probabilities.
According to the classical Bernoulli's theorem the frequency of any ran-
dom event A converges to the probability of this event in the sequence of
independent trials.
In the first part of this book it was shown that it is important to have
convergence in probability simultaneously for all events A E S of a given set
of events S, the so-called case of uniform convergence of the frequencies to
their probabilities over the given set ofevents. In other words, it is important to
guarantee the existence of uniform convergence in probability of the averages
to their mathematical expectations over the given set of indicator functions,
that is,
However, to show the relation of the results obtained here to the problem of
the theoretical statistics (discussed in Chapter 2) we shall use the classical ter-
minology, which is a little different from the terminology used in the first part
of the book. Instead of the set of indicator functions Q(z, a), a E A, we shall
consider the set S of events A(a) = {z: Q(z, a) > O}, a E A, and instead
of conditions for uniform convergence of the averages to their mathematical
expectation over a given set of indicator functions we shall consider condi-
571

572
14 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
tions for uniform convergence of the frequencies II(A) to their probabilities
P(A) over a given set 5 of events A:
p
sup Iv(A) - P(A)I ---t O.
AES
(--'00
It is clear that these two problems of uniform convergence are completely
equivalent.
To stress that this part of the book has more general goals than founda-
tions of the learning theory (the results obtained here actually belongs to
foundations of the theoretical statistics), we also change the notations of the
space. Instead of the space Z, which has a specific structure in the learning
theory, we consider an abstract space X.
14.1
UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR
PROBABILITIES
Let X be a set of elementary events and let P (x) be a probability measure
defined on this set. Let 5 be some collection of random events-that is, a
collection of subsets A of the set X measurable with respect to probability
measure P(x) (5 is included in a a algebra of random events but does not
necessarily coincide with it).
Denote by X(f) the space of samples from X of size f. Because this sample
was obtained in iteration of independent trials with the same distribution, we
formalize by the assignment of the product measure on X(f).
For any sample
and any event A E 5 the frequency of appearance of the event A is deter-
mined. It is equal to the number n(A) of elements of the sample which belong
to the event A, divided by the size f of the sample:
1
n(A)
II(A;X ) = II(A;Xt, "',Xl) = -f-'
Bernoulli's theorem asserts that for fixed event A the deviation of the fre-
quency from probability converges to zero (in probability) when the sample
size increases; that is, for any A and any 8 the convergence
P{IP(A) - II(A;Xf )! > 8} ---> 0
f --'00
holds true.

14.2 BASIC LEMMA
573
In this chapter we are interested in the maximal (for the given set S)
deviation of the frequency from its probability:
7TS (XI ) = sup IP(A) - v(A;Xf)l·
AES
The value 7TS (Xf ) is a function of the point Xl in the space X(f). We will
assume that this function is measurable with respect to the measure on X(f)-
that is, that 7TS(XI) is a random variable.
We say that the frequencies of events A E S converge (in probability) to
their probabilities uniformly on the set S if the random variable 7TS(Xf ) tends
in probability to zero as the value f increases.
This chapter is devoted to the estimation of the probability of the event
and determining the conditions when for any e > 0 the equality
lim P {7TS(Xf ) > e} = 0
f --+00
holds true.
14.2
BASIC LEMMA
We start by considering an important lemma. We are given a sample of size
2£:
For the event A E S we calculate from the first half-sample
the frequency
(A' X2f) _ n(A;Xf)
Vl,
-
f
'
and from the second half-sample
X~ = Xf+l, ... , X21
we calculate the frequency

574
14 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
Consider the deviations between these two frequencies:
Denote the maximal deviation over the given set S of events A by
pS(X2i ) = supp(A;X2f ).
AES
We suppose that the function pS (X2i ) is measurable.
Thus for the given set S of events we have to construct two random vari-
ables: the random variable TTS(Xi) and the random variable pS (X2i ).
As will be shown in subsequent sections, it is possible both to upperbound
the distribution function of the random variable pS(X2f ) and low bound
this distribution function. However, our main interest is the bounds on the
distribution of random variable 7TS(X').
The following lemma connects the distribution of random variable ~(Xf )
with the distribution of random variable pS(Xu).
Basic Lemma. The distributions of the random variables ~.(Xf ) and pS (X2f )
are related in the following way:
I. For f 2:: 2/82 the inequality
(14.1 )
is valid.
2. The inequality
is valid.
Proof By definition we have
where
(J(U)={~
if u > 0,
if u < o.
Taking into account that the space X(2f) of samples of size 2f is the direct
product of two subspaces, namely Xl (i) and X 2(e) (two half-samples of size

14.2 BASIC LEMMA
575
f), one can assert that for any measurable function c/> (XI, ..., X2i) the equality
is valid (Fubini's theorem).
Therefore
(in the inner integral the first half-sample is fixed.) Denote hy Q the following
event in the space Xl (f)
Bounding the domain of integration, we obtain
P {ps (Xu) > ~} ~ ( dP(Xf) (
0 [ps (Xu) -
~J dP(Xi).
(14.3)
2
lQ
lX2(Pj
2
We now bound the inner integral on the right-hand side of inequality which
we denote by I. Here the sample XI,
,Xf is fixed and is such that
1TS(XI,
,xp) > B.
Hence there exists an A * E S such that
Let, for example,
V(A*;XI, ""Xi) < P(A*) -
B
(the case V(A*;XI, ... ,xr) > P(A*) + B is considered analogously). Then in
order that the conditions
Iv(A*;XI, ...,Xf) - V(A*;Xf+l, ""X2f)1 > i
be satisfied, it is sufficient that the relation
v(A*;Xp+I, ...,X2a > P(A *) - i
be fulfilled from which we obtain
I
~
(
0 [v(A*;Xf+l, ""X2a - P(A *) + iJ dP(X~)
lX2(f)L
C;[P(A)]k[1 ~ P(A)]{-k.
klf>P(A')-~

576
14 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
The last sum exceeds 1/2 for £ > 2/e2• Returning to (14.3) we obtain that
for £ > 2/e 2
The first inequality has been proved.
To prove the second inequality, we note that the inequality
implies validation of either the inequality
e
Iv(A;Xi, ... ,Xf) - P(A)I > "2
or the inequality
e
Iv(A;Xf+i, ".,xu) - P(A)I > 2'
Taking into account that half-samples Xi and X~ are statistically independent,
we obtain
P {sup Iv(A;x], ... ,Xt) - V(A;Xf+lI ... ,xu)1 > e}
AES
~1-- (1
~- P {~~~ Iv(A;XI' ...,Xt) -- P(A)I > ~} )
x (1- P {~~~ Iv(A;Xf+lI""Xu) - P(A)I > ~}).
From the last inequality comes
P {ps (Xu) > e} ~ P { TTS(Xt ) > ~} _ (p {TTS (Xt ) > ~}) 2 ,
the second inequality of the lemma.
The lemma has been proved.
14.3
ENTROPY OF THE SET OF EVENTS
Let X be a set, let S be a system of it subsets, and let Xl = Xi, ..., Xf be a
sequence of elements X of size £. Each set A E S determines a subset X~
of this set consisting of elements belonging to A. We say that A induces a
subset X~ on the set Xi.

14.3 ENTROPY OF THE SET OF EVENTS
577
Denote by
N S(Xl, ... , Xi)
the number of different subsets X~ induced by the sets A E S.
It is clear that
1 ~ NS(Xl, ... ,Xi) ~ 2'.
Assume that this function is measurable and consider the function
It is clear as well that
O~HS(.e)~.e.
(14.4)
We call this function entropy of the set of events S on the samples of
size .e.
This function has the property of semi-additivity
H S(n + m) S H S(n) + HS(m).
(14.5)
To prove this, consider the sample
Any subset of this set that was induced by the event A E S contains a subset
of the set
that was induced by A and also contains the subset of the set
XII+l, ... , XII+m
that was induced by this event.
Since the value NS(x\, ...,XII' XII+l , ...,xlI+m) does not exceed the number of
pairs of subsets, where any pair contains one subset that was obtained from
Xl, ""x lI and one subsequence that was obtained from XII+l, ... ,XII+m•
Therefore
From this inequality we obtain
log2 N S(Xl, ... , XII' ..., XII+m) S log2 N S(Xl, ... , XII) + log2 N S(Xl+m , ... , x lI+m).
(14.6)
Averaging this relation, we obtain (14.5).
Remark. Using inequality (14.5) repeatedly, one can derive
H S(k.e) ~ kHs(.e).
(14.7)

578
14 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
14.4
ASYMPTO'nC PROPERTIES OF THE ENTROPY
In this section we formulate and prove some asymptotic properties of the
entropy of the set of events on the sample of the size £. We shall use these
properties for proving the necessary and sufficient conditions of uniform con-
vergence of the frequencies to their probabilities.
HS(f)
.
.
Lemma 14.1. The sequence -£-, £ = 1,2, ,.., has a lzmlt c, 0 'S c 'S I, as
£ -t 00:
1.
HS(£)_
1m
0
-
C.
f---.x
~
The proof of this lemma repeats the proof of the analogous lemma in
information theory for Shannon's entropy.
Proof Since
HS (£)
0<--<1
-
£
-,
there exists a lower bound
I,
. f HS (£)
c = 1mIn -0-'
f---.,X!
~
where 0 'S c 'S 1.
Then for any 6' > 0 a value £0 can be found such that
(14.8)
Note that any arhitrary £ can he rewritten in the form
£ = n£o + k,
where n :::: 0 and k < £0. Using properties (14.5) and (14.7), one can obtain a
bound
H S(£) = HS(n£o +k)
~ nHs(£o) + HS(k) ~ nHs(f) + k.
From this we derive

14.4 ASYMPTOTIC PROPERTIES OF THE ENTROPY
579
Using the condition (14.8), one obtains
llS(£)
1
-- <c+e+-.
£
n
Since f tends to infinity, n tends to infinity as well. We obtain
llS(£)
lim sup -£- < c + e,
f-4OO
and because e is arbitrary we find that
The lemma has been proved.
Lemma 14.2. For any £ the ll:(f) is an upper bound for limit
llS(£)
c= lim --;
£--->00
£
in other words,
Proof The assertion of this lemma actually was proved in the proof of
Lemma 14.1. In Lemma 14.1 we obtained the inequality
which is valid for arbitrary n, £0 and £ = n£. As was proved in Lemma 14.1,
the ratio lls (£)/ £ converges to some limit. Therefore for any e there exist
some no such that for any n > no the inequality
holds. Since e, £0, and n are arbitrary values, we have
lim H S(£) < H S(£0)
n--->:><,
£
-
£0
for any £0.
The lemma is proved.

580
14 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
Now consider the random variable
The next lemma shows that when f
---t 00 this random variable converges (in
probability) to the same limit to which the sequence HS(f)/f converges,
Lemma 14...1. If the convergence
I,
HS(f)_
1m
f
-
C,
(---;00
takes place, then the random variable
converges in probability to c; that is,
lim P{lrs(xl, ... ,Xi) - cl > e} = O.
i---;Xi
In addition, the probabilities
P +(e, f) = P {rs(x I , ... , X() - c > e},
P - (e,f) = P {c - rS(x I , ..., X () > e}
satisfy the conditions
00L P+(e, f) < 00,
(=1
lim P-(e, f) = O.
(---;00
Proof First, we estimate P+(e, f). Since
I,
HS(f)_
1m
f
-
C,
(---;00
for any e > 0 there exists an fo such that the inequality
holds true,

14.4 ASYMPTOTIC PROPERTIES OF THE ENTROPY
581
Consider the random sequence
""n-I I
NS(
)
n-l
(
) _
L;=O og2
Xi£o+l, ... , X(i+l)fo
_ ~
A(
)
q n
-
- L.J'
Xifo+l, ... , X(i+l)fo •
£0
;=0
Note that the sequence q(n)/n, n = 1,2, ..., is an average of n random inde-
pendent variables with expectation HS(£o)/£o. Therefore the expectation of
the random variable q(n)/n equals to HA(£o)/£o as well.
Since the random variable ,A is bounded, it possesses the central moments
of any order:
o ~ ,S(Xl, ,,,,Xfo) ~ 1.
Let M 2 and M4 be the central moments of order two and four. It is clear that
Then the central moment of order 4 for random variable q(n)jn is
M 4
n - 1
2
1
-3 +3-3-M2 < -2'
n
n-
n
Using Chebyshev's inequality for moment of order 4, we obtain
P {
q(n) _ _HA-,-(£-,-o)
}
4
> 8
< -2-'
n
£0
n 8
According to (14.6), the inequality
holds true; that is,
From (14.9) and the last inequality, we obtain
Now let 8 = e/3. Taking into account that
(14.9)

582
14 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
we obtain the inequality
{
S
2e}
244
P
'nfo > C + 3
< e4n2 '
(14.10)
For arbitrary £ > £0 we write £ -=- 11£0 + k, where 11 -=- [£/ £0] and k < £0'
Since (14.6) we have
log2 Ns (Xt, ... ,xr) :s log2 NS(xr, ""Xnfo) + k.
Therefore
Reinforcing this inequality, we obtain
Now let £ be so large that the inequality
1
e
-<-
n
3
holds. Then (14.10) and (14.11) imply the inequality
+
{
S
}
244
P (e,£)=P
'f >c+e
< e4nZ '
(14.11)
(14.12)
Note that n -4 00 when f -4 00. Taking this remark into account, we conclude
from (14.12) that the inequality
lim P+(e, f) = 0
f-.x
holds true.
Besides, from the same reason the inequality
L P+(e, f) < 00
rcc I
(14.13)
holds true.
Indeed, since P+(e, P) :s 1 it is sufficient to evaluate the part of this sum
starting with some large Po. For this part of the sum we obtain the bound
using inequality (14.12) inequality. Therefore we have
~
~
244
L P+(e, f) < eo + L
e4n2 < 00.
I
I
n~fo
Thus the first part of the lemma is proved.

14.4 ASYMPTOTIC PROPERTIES OF THE ENTROPY
583
To prove the lemma, it remains to show that the equality
lim P-(e,f.) = 0
f-;XJ
holds true.
Consider fo such that for all f > fo the inequality
holds true. Note that HS (f)If is the expectation of the random variable
rj = rS(Xl, .. ', Xf). Let us write this fact in the form
Denote the right-hand side of this equality with R l and denote left-hand side
of the equality with R2. When f > fa we have
Now let ~ > 0 be an arbitrary small value. Then
Using our notation, we rewrite this inequality in the form
Combining the estimates for R] and R2, we have
In the case when f tends to infinity, we obtain

514
14 UNifORM CONVERGENCE Of fREQUENCIES TO THEIR PROBABILITIES
Since {j is an arbitrary small value and P_(e, £) is a positive value, we con-
clude that
lim P-(e,£) =0.
1->00
The lemma is proved.
14.5
NECESSARY AND SUFFICIENT CONDITIONS OF UNIFORM
CONVERGENCE. PROOF OF SUFFICIENCY
Chapter 3 formulated the theorem according to which the convergence
is the necessary and sufficient condition for uniform convergence (in proba-
bility) of the frequencies to their probabilities over a given set of events. In
this section we will prove a stronger assertion.
Theorem 14.1. Let the functions NS(Xl, ... ,xp), 1TS(XI, ...,xp), pS(XI' ...,xp) be
measurable for all £.
Then:
If the equality
lim H
S(£) = 0
f~x
£
'
(14.14)
holds true, then the uniform convergence takes place with probability one
(almost surely).
If, however, the equality
HS(f)
lim -- =c>O
f->x
P
,
(14.15)
holds true, then there exists (j(c) > 0 which does not depend on f such
that
lim P{1TS(XI"",Xf) > {j} = 1;
f->XJ
that is, the probability that a maximal (over given set of events) deviation of
the frequency from the corresponding probability exceeds {j tends to one
with increasing number of f.

14.5 UNIFORM CONVERGENCE. PROOF OF SUFFICIENCY
585
Therefore from this theorem we see that equality (14.14) is the necessary
and sufficient condition for uniform convergence of the frequencies to their
probabilities over a given set of functions. In this section we prove the first
part of this theorem: sufficiency of condition (14.14) for uniform convergence
with probability one. The second part of this theorem will be proven in the
next two sections of this chapter.
The proof of this part of the theorem actually repeats the proof of the
Theorem 4.1.
Proof of the Sufficiency of the Condition (14.14) for Uniform Convergence
with Probability One. Suppose that the equality
lim H!I.(£) = 0
f-....oo
e
holds true. Let us evaluate the value
P{suplv(A;X1, ,,,,Xl) - P(A)I > e} = p{1Tf > e}.
AES
According to the Basic Lemma, the inequality
P {1T; > e} < 2P {pf > ~}
holds true.
On the other hand, it was shown in the proof of the Theorem 4.1 that the
equality
(2l)!
{
S
e}
1 1 '" [s
U
e]
2f
P
Pf > 2"
= (2/)!
L.J 8
P (T;X
) - 2" dP(X
)
X(2l) ;=1
holds true, where T; are all possible permutations of the sequence Xl, ... , X2(.
Besides, in Chapter 4, Section 4.13 it was shown that
K
1
(2l)!'"
[s
2l
e]
(2/)! L.J 8
P (T;X
) - 2
1=1
S
-e2e
< 3N (XI, ""x2l')exp -4-'
Note that for sufficiently large e the value K does not exceed 1.
Now, let us divide the region of integration into two parts: subregion Xl,
where

586
14 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
and subregion X 2, where
IOg2 NS (Xl,""XU)
e2
2£
> g'
Then using a majorant for K, we obtain
P {pIE > ~} < 2 r NS(xJ, ... ,xu)e-e
1f/4dp(X2f ) + r dP(X2f ).
J~
hI
Note that since
we have
(for P+ ( ~2 ,2£) see Section 14.4). Taking into account that in the region XI
the inequality
N s(
) < 2e2f/4
Xl, ... ,Xu
_
holds true, we obtain
P {pIf > ~} < 2· 2e2f/4. e-e
1f/4 + P+ (~2, 2£) .
(14.16)
The first term on the right-hand side of inequality (14.16) tends to zero when
£ --+ Xi, and the second term of the inequality tends to zero in accordance with
Lemma 14.3. Even more, since in accordance with this lemma the inequality
tP+(i,£) <00
{=J
is valid, then the inequality
X-L P {ps (x I, ... , X2f) > ~} < 00
f=l
is valid as well. The last inequality implies the inequality
x,
LP{1TS(Xt, ...,xu) > e} < Xi.
f=l
According to the Borel-Cantelli lemma, this inequality implies the conver-
gence of frequencies to their probabilities with probability one.
Thus, the first part of the theorem has been proven.

14.6 UNIFORM CONVERGENCE. PROOF OF NECESSITY
587
14.6
NECESSARY AND SUFFICIENT CONDITIONS OF UNIFORM
CONVERGENCE. PROOF OF NECESSITY
Now let the equality
HS(f)
lim -fl- =c>O
(--->oo
f-
be valid. In accordance with the Basic Lemma, if the equality
lim P{pS(Xl' ...,xu) > 2o} = 1
( --->CJO
is valid, then the equality
lim P{ 1TS(Xl, ...,xu) > o} = 1
(--X)
(14.17)
is also valid.
Therefore to prove the second part of the theorem it is sufficient to show
that under condition (14.15), equality (14.17) holds true for some 0 = o(c).
To clarify the idea of proving this part of the theorem, let us consider its
particular case, namely the case when equality
lim HS(f) = 1
{--oo
f
holds true. In this case, as was shown in the remark to Lemma 14.2, the
equality
is valid for any f.
Since HS(f)/f is the mathematical expectation of the random variable
the equality
is valid. This means that for any finite f with probability one, the equality

588
14 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
is valid; that is, almost any sample XI, ..., Xf induced all 2f possible subsets
by events of the set S. In particular, this means that for almost any sample
XI, ..., Xu an event A * E S can be found such that
Then
Xi E / A*,
i=1,2, ...,£,
i=£+1, ... ,2£.
and therefore with probability one we obtain
sup IVI(A';XI, ...,Xf) - vZ(A*;Xf+l, ...,xu)1 = l.
AES
In this case for any i) -:; 0.5 the equality
is valid.
The idea of proving the necessity of (14.15) in the general case is based
on the fact that if the equality
HS(£)
lim-- =c > 0
f--.
£
holds, then from almost any sample of size £ the subsample of size n(£) can
be subtracted where n(£) is a monotonously increasing function such that
this subsample can be shattered by events from the A E Sin a1l2n(f) possible
ways.
To implement this idea we need the following lemma.
Lemma 14.4. Suppose that for some a (0 < a -:; 1), some f > 9/aZ, and some
sample
XI, ...,Xf
the inequality
holds true.

14.6 UNIFORM CONVERGENCE. PROOF OF NECESSITY
589
Then the subsample
Xi1"",Xi,
of size
r = [ql],
where q = a2el9 (e - is the basis of logarithm), can be found such that the
equality
holds true.
Proof According to Lemma 4.2 (for this lemma see Chapter 4, Section 4.3),
this subsample exists if the inequality
,-1
S
~
.
N (X1,,,,,Xl) > L.JC; = <I>(£,r)
i=l
is valid.
To prove this lemma it is sufficient to check the inequality
2al > <1>(£, r).
(14.18)
Taken into account that for the case r ~ 2 and £ ~ r + lone can use the
bound for function <1>(£, r) obtained in Chapter 4, Section 4.10, we obtain
<I>(£,r) < (£re )'
Note that the function (felt)' monotonously increases with t when t < 1.
Therefore
where
r=[q£]~qf.
The relationship (14.18) will be proved if we prove the inequality

590
14 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
Taking the logarithm of both sides of this inequality and simplifying the
expression, we obtain
a > q logz (~) .
Note that for z > 0 the following inequality
210gze
logz z ~
Vi.
e
(14.19)
holds true.
Indeed, this inequality is true because the function log2 z/Vi. achieves
its maximum at the point z = eZ and the maximum of this function equals
210g2 e/e. Therefore the inequality
1.<- 210g2e
a > veq ----=--
e
implies inequality (14.19). When q = aZe/9, this inequality holds true since
the equality
210gze
a>
3
a
is true.
The lemma has been proved.
Recall that according to Lemma 14.3 if
.
HS(f)
lIm -- =c>O,
[-''-'0
f
then the probability
p{lgNS(X~,,,,,Xf)>c-o}
tends to one when f tends to infinity and 0 > O. Hence for sufficiently large
f with probability arbitrarily close to one, the inequality
(14.20)
holds true. According to Lemma 14.4, in this case from any sample the sub-
sample of the size
can be found such that it induces all possible 2' subsets by the set of events S.
This fact gives a key to prove the necessary condition of the theorem.

14.6 UNIFORM CONVERGENCE. PROOF OF NECESSITY
591
Scheme of the Proving the Necessity of the Conditions of the Theorem. To
prove the necessity of the conditions of the theorem we have to show that
for some 8(c) the equality
lim P{ps(Xj, ,,,,X2i) > 28} = 1
f --->::xl
is valid. To prove this fact we compare the frequencies of occurrence of the
events on the first half-sample and on the second half-sample. To do this we
take a sample of size U and then split it randomly into two subsamples of
equal size. Then for any events of the set S we calculate and compare the
number of occurred events of these subsets.
Now let us consider another scheme. Suppose that the sample of size 2£
satisfies the condition
Then one can extract from the Xl, ... , Xli the sample X' of size
on which all subsamples can be induced.
Now let us randomly split this sample into two equal subsamples: subsam-
pies X~/2 and subsample X;/2. Then let us independently split the remainder
XU / xr into two equal subsamples: subsample X:- r/2 and subsample X~-rI2.
According to the construction there exists such event A' that all elements of
X~/2 belong to A' and all elements of X;/2 do not belong to A'. Suppose that
in the subsamples X:- r/2 and X;-r/2 there are m elements that belong to A *.
Approximately half of them belong to X~- r/2, while the other half belong to
X i - r/ 2 Th
2
.
en
and consequently
sup IVj(A*) - vz(A*)1 > q.
AES
Because q > 0 does not depend on the length of the sample, there is no
uniform convergence.
Of course this scheme is not equivalent to the initial one since the sample
x r and the remainder X2i / xr are not necessarily split into two equal parts
when one splits sample XU into two equal parts. However, for sufficiently
large £ (and consequently r), these conditions are fulfilled rather precisely.
In the next section we will give the formal proof, which takes into account
all these assumptions and approximations.

592
14 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
14.7
NECESSARY AND SUFFICIENT CONDlnONS. CON'rlNUATION
OF PROVING NECESSITY
Let the equality
HS(f)
lim -- =c>O
f~X!
£
hold true.
To prove the necessity, we just have to estimate the quantity
where Ti , i = 1, ..., (2£)!, are all (2f)! possible permutations of the sam-
ple Xl, ...,xu. Denote by K(X2f ) the integrand and reduce the domain of
integration
Now let us examine the integrand K(X2f) assuming that
that is,
Let us choose
1
0< q(c) < 2
in such a way that (in accordance with Lemma 14.4) for sufficiently large f the
subsample x n of the size n > qf exists in which the set of events S induces
all possible subsamples (i.e., NS (Xn ) = 2n ). Now we choose 8(c) = q/8. Note
that values q and 8 do not depend on f.
Observe that all permutations Tj can be classified into the groups Rs cor-
responding to some partition of the sample XI, ... , Xu into first and second
half-samples.
It is clear that the quantity
p(T;XU ) = sup IV] (A; TiX 2i ) - v2(A; T;Xu)1
AES

14.7 CONTINUATION OF PROVING NECESSITY
593
depends only on the group Rs and does not depend on specific transmutation
Ti into the group. Therefore
where the summation is taken over all different separations the sample into
two subsamples.
Now, let x n be the subsample of the size n in which the set of events
S induces all 2n subsamples. Denote by X 2f - n the complement of X Il with
respect to the X 2f (the number of elements in the X 2f -
1l equals 2f - n).
The partition Rs of the sample XU into two half-samples is completely
described if the partition Rl of the subsample x n into the two subsamples
and the partition R; of the sample X U - Il into the two subsamples are given.
Let Rs = R1R;' Let r(k) be the number of elements in the subsample X n
which belong under partition Rl to the first half-sample and let m(j) be the
number of elements of the subsample X U - n which belong under partition R]
to the first half-sample. Clearly, r(k) + m(j) = f for k and j corresponding to
the same partition Rs • We have
K = dl Lt
(1 [ps(RLR;X2f
) - 28],
2l
k
j
where 'Lj is the summation over only those j for which m(j) = f - r(k), and
where 'LZ is summation over only those k for which r(k) = r. For each RL
we can specify a set A(k) E S such that A(k) includes exactly the elements
of subsample x n which belong under partition Rl to the first half-sample.
Introduce the notations:
p(k) is the number of the elements in the subsample x 2f-n belonging to
A(k).
t(k,j) is the number of the elements in X 21 - n belonging, under partition
Rj, to the first half-sample.
Then
(A(k). Xu) = (r + t)
VI,
f
'
v2(A(k);Xu ) = (P ; t),
p(A(k);Xu ) = IVl(A(k);X2l) _ v2(A(k);Xu )1 = Ir + 2; - pI.

594
14 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
We further take into account that
pS(X2f ) = supp(A;X2f ) > p(A(k);X2f ).
AES
Replacing pS(X2f ) by p(A(k);X2f ) we estimate K to obtain
Observe that the number of partitions R} satisfying the conditions s(j) =
£ - , for fixed , is
cf - r
2f~r-p(k)'
and the number of partitions R; which in addition correspond to the same t
for fixed, and A(k) is
ct
Cf - r- t
p(k)
2f-r-p(k)'
Then the estimate for K is
1
K>-~~~et
Cf - r- t
-
Cf L.J L.J L.J
p(k)
2f~n-p(k)'
2f
r
k
t
After an elementary transformation, one obtains
crcf~r
C t
C f - r- t
K > ~
n
2f-n ~ ~ ~
p(k)
2f-n-p(k)
- L.J
C f
L.J C r L.J
Cf-r
r
2f
k
n
t
2f-n
(14.21 )
where the summation on t are carried out in the limits determined by the
expression
I' + 2t - pi
2 ~
£
>
u.
Now let
q
0< B < 20'
Consider the quantity K*:
C Cf
r
C t
)Cf -r-t
K* = ~
~
2P-n ~ ~ ~
p(k
U-n-p(k)
LJ
C f
L.J C r L.J
Cf-r
'
r
2f
k
n
t
2f-n
which differs from (14.21) only in the limits of summation
n
I, - -I < Bn
2 -
,
I
p(k)(£ - ,) I
0
t -
2£ _ n
< Be
(14.22)
(14.23)
(14.24)

14.7 CONTINUATION OF PROVING NECESSITY
595
Observe that if rand t satisfy inequalities (14.23) and (14.24), then inequality
(14.22) holds true. Taking into account these inequalities, we obtain
r + 2: -p > ~ [~ _ en + 2f2~ n (f - ~ - en) - 20£ - p]
> ~ [~ - e((n + 2£ + 2~~n)]
As far as
q£ < n < £,
from the last expression we obtain
q
S =-8'
q
~; <-
20
r + 2t - p
! [!! _5 £] = c.l = 2S
f
> £
2
e
4
.
Since the domain of summation of K includes the domain of summation K*,
we have
K
~ K*.
Note that for any 11 > 0 there exists £0 = £o(11,Q) such that for all £ > £0 we
have the inequality
(here the summation is taken over r which satisfy (14.23)) and the inequality
ct Cl - r - t
""" ----,--P_2::-l_-n_-.!...p > 1 -
11
L.J
CLr
r
2l-n
(here the summation is taken over t which satisfy (14.24)).
Indeed,
(14.25)
is the probability to draw r black balls from the urn containing n black balls
and 2£ - n white balls, when one randomly draws f balls without replace-
ment. In this case the expectation of number of black balls in the sample
is equal to n/2, and the right-hand side of inequality (14.25) is the proba-
bility that the deviation of the number of black balls from the expectation

596
14 UNIFORM CONVERGENCE OF FREQUENCIES TO THEIR PROBABILITIES
of the black balls exceed en. Since for the scheme of drawn balls without
replacement the law of large numbers holds true starting for some large f,
the inequality (14.25) is valid.
Analogously, the quantity
C1 Ct - r - t
p
U-n-p
Ct - r
2f-n
is the probability to draw t black balls from the urn containing p black balls
and 2f - n - p white balls when one randomly draws i- r balls without
replacement. The expectation of the number of black balls in the sample is
equal to
p(i - r)
2f - n '
and consequently inequality (14.26) expresses the law of large numbers in
this case.
Then, taken into account that the number of partitions Rk of the subsample
x n for fixed r is equal to C;, we obtain for f > fa
K 2: (1 - 11f.
Thus, for f > fa and 8 = q/8 we obtain
P{ps(X
2f
) > 28} >
(g2NSIX2f)
1. K(X2t )dP(X
2f
)
h
I
>2
Since according to Lemma 14.2 we have
)~~ p- (~,f) = 0,
we obtain
lim P{ps(X2f ) > 28} 2: (1 - 11)2.
(--->00
Taken into account that 11 is arbitrarily small, we conclude that the equality
lim P {ps (X2f ) > 28} = 1
f->oo
holds true.
Thus the theorem is proved.

15
NECESSARY AND SUFFICIENT
CONDITIONS FOR UNIFORM
CONVERGENCE OF MEANS
TO THEIR EXPECTATIONS
In Chapter 14 we obtained the necessary and sufficient conditions for uni-
form (two-sided) convergence of frequencies to their probabilities over a
given set of events that also can be described in terms of uniform two-sided
convergence of the means to their expectations for a given set of indicator
functions.
In this chapter we will generalize these results to the set of bounded real-
valued functions
as F(x, a) S b.
(15.1)
Below, without loss of generality we assume that a = 0 and b = 1. (Note that
indicator functions satisfy the conditions.) We are looking for the necessary
and sufficient conditions of uniform convergence of the means to their ex-
pectations over a given set of functions F(x, a), a E A; in other words, we
are looking for conditions under which the limit
lim P {sup EF(x, a) - -e
1t
F(xi, a) > s} = 0
f->eX)
aEA
;=1
holds true.
15.1
E ENTROPY
(15.2)
We start with some definitions.
Let A be a bounded set of vectors in Rf • Consider a finite set of T c Rf
597

598
15 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTArlONS
such that for any yEA there exists an element t E T satisfying
p(t,y) < o.
We call this set a relative 0 net of A E Rf •
Below we shall assume that the metric is defined by
p(t,y) = max It I
- /1,
1Sci Sen
and the norm of a vector z is given by
Ilzll = max Izl
1991
If an 0 net T of a set A is such that TeA, then we call it a proper 0 net
of the sel A.
The minimal number of elements in an 0 net of the set A relative to R{
will be denoted by N (0, A), and the minimal number of elements in a proper
o net is denoted by No(o, A). It is easy to see that
On the other hand,
No(o,A) ;:: N(o,A).
No(20,A) < N(o,A).
(15.3)
(15.4)
Indeed, let T be a minimal 0 net of A relative to Rf • We assign to each
element t E T an element yEA such that p(t, y) < 0 (such an element }'
always exists, since otherwise the 0 net could have been reduced). The totality
To of elements of this kind forms a proper 20 net in A (for each yEA there
exists t E T such that p(t, y) < 0, and for such atE T there exists T E To
such that p(T, t) < 0 and hence p(y, T) < 20).
Let F (x, a) be a class of real functions in the variable x E X depending
on an abstract parameter a E A. Let
be a sample. Consider in the space Rf a set A of vectors z with coordinates
Zl = F(Xi, a),
i=I, ...,£
formed by all a E A.
If the condition a ~ F(x, a) ~ 1 is fulfilled, then the set

15.1 e ENTROPY
599
belongs to an £i-dimensional cube 0 -s; Zi -s; 1 and is therefore bounded and
possesses a finite e net.
The number of elements of a minimal relative e net of A in R( is
and the number of elements of a minimal proper e net is Nt(Xl, ... ,x(; e), If
a probability measure P(x) is defined on X and Xl, ..., Xf is an independent
random sample and NA(Xl' ...,xf;e) is a function measurable with respect to
this measure on sequences Xl, ...,X" then there exists an expected entropy
(or simply an e entropy)
It is easy to verify that a minimal relative e net satisfies
(15.5)
(Recall that P(ZI, zz) = maxlS;iS;n Iz~ -
z~I·)
Indeed, in this case a direct product of relative e nets is also a relative e
net. Thus,
(15.6)
At the end of this section it will be shown that there exists the limit
( ) _ I'
HA(e, f)
c e
-
1m
Ii
,
(--400
l:
and that the convergence
o -s; c(e) -s; In [1 + ~]
holds.
We will consider two cases:
1. The case where for all e > 0 the following equality holds true:
(15.7)
2. The case where there exists an eo such that we have c(eo) > 0 (then
also for all e < eo we have c(e) > 0).
It follows from (15.4) and (15.7) that in the first case
(15.8)

600
15 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTATIONS
for all e > 0 and it follows from (15.3) and (15.7) that in the second case
.
{lnN(~(Xl, ...,xp;e)
(
}
hm P
f
> ceo) - D
= 1
p-"x!
(15.9)
for all e ~ eo,
5 > O.
We will show that (15.8) implies uniform convergence on the means to
their expectations, while under condition (15.9) such a convergence is not
valid. Thus the following theorem is valid.
Theorem 15.1. The equality
"Ie> 0
is a necessary and sufficient condition for the uniform convergence of means
to their expectations for a bounded family offunctions F(x, a) a E A.
This chapter is devoted to the proof of this theorem.
We now prove (as in Chapter 14) that the limit
exists and the convergence (15.8) is valid.
15.1 .1
Proof of the Existence of the Limit
As
for any eo > 0 there is a lower bound
Therefore for any 5 > 0, such an fo can be found that
Now take arbitrary f > fo. Let
f = nfo+m,

15.1 e ENTROPY
601
where n = [£/£0]' Then by virtue of (15.6) we obtain
Strengthen the latter inequality
Since n --t 00 when £ --t 00, we have
Because {j > 0 is arbitrary, the upper bound coincides with the lower one.
15.1 .2
Proof of the Convergence of the Sequence
We prove that when £ increases, the sequence of random values
converges in probability to the limit Co. For this it is sufficient to show that
for any (j > 0 we have
P;(/) = P{/ > Co + {j} ------t 0
(-'00
and for any f-t > 0 we obtain
P;(r() = P{/ < Co - f-t} ------t O.
(-'00
Consider a random sequence
1
n
glo = _ ~ /0
n
n~
I
;=1
of independent random values ,io. Evidently

602
15 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTATIONS
Because 0 < r1° ::; 1, we have
Therefore
Write the Chebyshev's inequality for the fourth moment:
P {I
to _ HJ\eo,£o)I }
_4
gn
IJ
> e
<
2
4'
~O
n e
Consider a random variable g~, where £ = n£o + m. By virtue of (15.5),
1
r f = rnfo+m < gto + -.
-
n
n
Now let e = ()/3, and let £0 and £ = n£o + m be so large that
1
()
-<-
n - 3'
Then
Because n ~ 00 when £ ~ 00 we obtain
To bound the value P,;(rf ) we consider the equality
Mark its left-hand side with R), mark its right-hand side with Rz, and bound
R 1 and Rz for £ such that

15.2 THE QUASICUBE
603
The lower bound of RI is
and the upper bound of Rz is
Combining these bounds we obtain
Since
HA(eo, f)
------> Co,
f
f->CXJ
we obtain
Because Dand JL are arbitrary, we conclude that
lim P;; (rf ) ------> 0
f->oo
f->oo
15.2
THE QUASICUBE
We shall define by induction an n-dimensional quasicube with an edge a.
Definition. A set Q in the space R1 is called a one-dimensional quasicuhe
with an edge a if Q is a segment [c, c + a].
A set Q in the space Rn is called an n-dimensional quasicube with an edge
a if there exists a coordinate subspace Rn- I (for simplicity it will be assumed
below that this subspace is formed by the first n - 1 coordinates) such that a
projection Qof the set Q on this subspace is an (n - 1)-dimensional quasicube

604
15 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTATIONS
with an edge a and for each point z* = (zl, ..., Z~-I) of the quasicube Q the
set of numerical values zn such that (zl, ..., Z~-I, zn) E Q forms a segment
[c,c+a], where c in general does not depend on z•. (Fig. 15.1).
The space Rn-I is called an (n - 1)-dimensional canonical space. In turn,
an (n - 2)-dimensional canonical space Rn-2 can be constructed for this space,
and so on.
The totality of subspaces R1, ... , Rn is called a canonical structure.
The following lemma is valid. This lemma is an analog (for the value of
the set) of the Lemma 4.1 proved in Chapter 4, Section 4.10.
Lemma 15.1. Let a convex set A belong to an f.-dimensional cube whose
coordinates satisfy
0::; z' ::; 1,
i=I, ...,f..
Let V(A) be the f.-dimensional volume of the set A.
If for some
the condition
O::;a::;l,
f. > 1
V(A) > C;af - n
(15.10)
is fulfilled, one can then find a coordinate n-dimensional subspace such that
the projection of the set A on this subspace contains a quasicube with an edge
a.

15.2 THE QUASICUBE
605
Proof We shall prove the lemma using an induction method.
1. For n = £ the condition (15.10) is
V(A) > C; = 1.
On the other hand,
V (A) ::; 1.
(15.11)
(15.12)
Therefore the condition (15.10) is never fulfilled and the assertion of
the lemma is trivially valid.
2. For n = 1 and any f we shall prove the lemma by contradiction. Let
there exist no one-dimensional coordinate space such that the projec-
tion of the set A on this space contains the segment [c, c + a]. The pro-
jection of a bounded convex set on the one-dimensional axis is either
an open interval, a segment, or a semiclosed interval. Consequently, by
assumption the length of this interval does not exceed a. However, then
the set A itself is contained in an (ordinary) cube with an edge a. This
implies that
V(A) < at.
Taking into account that a ::; 1, we obtain
which contradicts condition (15.10) of the lemma.
3. Consider now the general inductive step. Let the lemma be valid for all
n < no for all f, as well as for n = no + 1 for all f such that n :::; £ :::; fo.
We shall show that it is valid for n = no + 1, £ = fo + 1.
Consider a coordinate subspace Rfo of dimension £0 consisting of vectors
_
(
1
fo)
z -
z ,"', z
.
Let AI be a projection of A on this subspace. (Clearly AI is convex.) If
(15.13)
then by the induction assumption there exists a subspace of dimension n such
that the projection of the set AI on this subspace contains a quasicube with
an edge a. The lemma is thus proved in the case (15.13).
Let
(15.14)

606
15 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTATIONS
Consider two functions
A,.
(
I
Eo) -
{.
(
I
fo
) E A}
0/1 Z , ... , z
- sup z.
z, ...,z ,z
,
z
A.... ( I
(0) -' f{
. ( I
fo
) E A}
0/2 Z , ... ,Z
-l~
Z.
Z , ... ,Z
,Z
.
These functions are convex upward and downward, respectively. Therefore
the function
A,._(
I
fll) _
A,.
(
I
fo)
A,._ (
I
fl,)
'f'3 Z , ... , Z
-
0/1 Z , ... , Z
-
'V2 Z , ... , Z
is convex upward.
Consider the set
(15.15)
This set is convex and is located in Rio.
For the set All, one of two inequalities is fulfilled: Either
(15.16)
or
(15.17)
Assume that (15.16) is fulfilled. Then by the induction assumption there exists
a coordinate space RII - I of the space Ri such that projection A III of the set
All on it contains an (n - I)-dimensional quasicube 011-1 with an edge a.
We now consider the n-dimensional coordinate subspace RII formed by
RII- I and the coordinate Zio. Let, A IV be the projection of the set A on the
subspace RII. For a given point
(
I
II-I)
AllI
z., ...,z.
E
we consider the set d = d(zl, ..., Z~-I) of values of z such that
(
I
II-I)
AIV
z., ...,z.
, Z
E
.
It is easy to see that the set d contains an interval with endpoints
(
I
II-I) _
•
A,. (I
PO)
rl
Z , ... , z
- sup 0/1 Z , ...z
,
ZEAIJ
•
( I
II-I)_·fA....(1
PO)
r2 Z , ... , Z
-
10
0/2 Z , ... Z
,
zEAIJ

15.2 THE QUASICUBE
607
where sup* and inf* are taken over the points z E All which are projected
onto a given point (zl, ... ,Z:-I). Clearly, in view of (15.15) we have
'1 -'2 > a.
We now assign to each point (z I, ... , Zll-I) E A JJJ a segment c(ZI , ... , Zll-I) of
length a on the axis Zfo+l:
where
(
I
II-I)
(I
n-I)
'1
Z
, ... ,Z
+'2 Z , ... ,Z
(J =
2
.
Clearly,
( In-I)
d(
I
11-1)
CZ, ... ,Z
c
Z, ... ,Z
.
Consider now the set Q E RII consisting of points (Zl, ... , zlI-l, Zfo+l) such
that
(
I
II-I)
0
(15 18)
z ,...,z
E~£II_I,
.
/\1+1 E C(ZI, ... , Zll-l).
(15.19)
This set is the required quasicube 011' Indeed, in view of (15.18) and (15.19)
the set Q satisfies the definition of an n-dimensional quasicube with an edge
a. At the same time we have Q E A/v by construction.
To prove the lemma, we need to consider the case when the inequality
(15.17) is fulfilled, that is,
Then
V(A)
r <p:,(ZI, ... , ZEO) dz l dz2... dz fo
fAI
r
cl>3(ZI, ... , Zfo) dz l dz 2... dl\1
fAI_AII
+ r
<p:'(ZI, ...,Zfo)dzldz2... dzfo
fAil
< aV(A 1) + V(A lI ),
and in view of (15.14) and (15.17) we obtain
which contradicts the lemma's condition.

608
15 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTATIONS
15.3
e-EXTENSION OF A SET
Let A be a convex bounded set in Rn We assign to each point z E A an open
cube O(z) with the center at z and the edge e oriented along the coordinate
axes.
Consider the set
At: = UO(z),
ZEA
along with the set A, which we shall call an e extension of the set A. The set
At: is the set of points y = (y 1, ... ,i), for each of which there exists a point
z E A such that
e
p(z,y) < 2'
It is easy to show that an e extension At: of the convex set A is convex.
Now choose a minimal proper e net on the set A. Let the minimal number
of elements of a proper e net of the set A he No(e,A). Denote by V(At:)
the volume of the set At:.
Lemma 15.2. The inequality
(15.20)
is valid.
~
Proof Let T be a proper e/2 net of the set A. Select a subset T of the set
T according to the following rules:
1. The first point i 1 of the set t is an arbitrary point of T.
2. Let m distinct points £1, .." z"m be chosen, An arbitrary point of z E T
such that
min p(ij,z) ~ e
l:'Oi :'Om
is selected as an (m + 1)th point of T.
3. If there is no such point or if T has been exhausted, then the construc-
tion is completed.
Let the set T, constructed in the manner described above, be a 1.5e net in
A, Indeed, for any z E A, there exists t E T such that p(z. t) < e /2. For such
a t there exists Z E T such that p(i, t) < e. Consequently, p(z, z) < 1.5e and
the number of elements in T is at least No(1.5e,A).
Furthermore, the union of open cubes with edge e and centers at the
points of t
is included in At:. At the same time, cubes with centers at

15.3 e-EXTENSION OF A SET
609
different points do not intersect. (Otherwise, there would exist ZE H(zl)
and Z E O(Z2), Zl,Z2 E t, and hence p(ZI,Z) < el2 and P(Z2,Z) < e12, from
which P(Zl, Z2) < e and ZI = Z2') Consequently,
The lemma is proved.
Lemma 15.3. Let a convex set A belong to the unit cube in Rf , and let As be
its e-extension (0 < e ::; 1); and for some
I' > In(l + e)
let the inequality
No(1.5e,A) > eyf
be fulfilled. Then there exist tee, y) and aCe, y) such that-provided that n =
[tot'] > o-one can find a coordinate subspace of dimension n = [tot'] such that
a projection of As on this space contains an n-dimensional quasicube with an
edge a.
Proof In view of Lemmas 15.1 and 15.2 and the condition (15.20), which is
valid for this lemma, in order that there exist an n-dimensional coordinate
subspace such that the projection of As on this subspace would contain an
n-dimensional quasicube with an edge a, it is sufficient that
where b = al(l + e).
In turn it follows from Stirling's formula that for this purpose it is sufficient
that
where
1'1 = I' In(l + e).
Setting t = nit' and taking 0 < t <
~, we obtain
t(lnt -1)
1 b
Ine + 1'1
-
+n <---
1-t
1-t
'
using an equivalent transformation.

610
15 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTATIONS
Under the stipulated restrictions this equality will be fulfilled if the in-
equality
3
2
- 2:t(lnt - 1) + Inb < (1 + 2t) Ins + j'YI
is satisfied. Now choose toes, 'Y) such that conditions
1
0< toes, 'Y) :::; 3'
3
'YI
-2 to(lnto -1) < 6'
'YI
-2to In s < -6
(15.21)
will be satisfied. This can always be achieved, since by assumption in this case
the inequality (15.21) will be fulfilled for
'YI
Inb = Ins + 3'
or
{
'Y - InC1 - s) }
a = (1 + s}sexp
3
.
The lemma is thus proved.
15.4
AN AUXILIARY LEMMA
(15.22)
Now consider a class of functions <I> = {F (x, a):
a E A}, which is defined
on X. We assume the class to be convex in the sense that if
F(x, ad, ... , F(x, a,) C <1>,
then
(15.23 )
,
~ T;F(x, aj) C <1>,
;=1
T; 2 O.
Now define two sequences: the sequence
Xi EX
and a random independent numerical sequence
YI, ...,y,
(15.24)

15.4 AN AUXILIARY LEMMA
611
possessing the property
with probability 0.5,
with probability 0.5.
Using these sequences, we define the quantity
1
f
Q(<I»
= Ey
sup eL F(x;, a)y;
F(x,a)E<I>
;=1
(The expectation is taken over the random sequences (15.24).)
In Section 15.1 we denoted by A the set of f-dimensional vectors z with
coordinates
z; = F(x;, a),
i = 1, ...,f,
for all possible a E A. Clearly A belongs to the unit f-dimensional cube in
R' and is convex.
We rewrite the function Q(<I» in the form
1
'
.
Q(<I»
= Ey
sup e LZ1y;
F(x,a)E<I>
;=\
The following lemma is valid.
Lemma 15.4. If for B > 0 the inequality
No(1.5B, A) > eyE,
is fulfilled for the set A, then the inequality
y>ln(I+B)
is valid, where t > 0 does not depend on f.
Proof As was shown in the previous section, if the conditions of the lemma
are fulfilled, there exist t (B, y) and a(B, y) such that there exists a coordinate
subspace of dimension n = rtf] with the property that a projection of the set
At: on this subspace contains an n-dimensional quasicube with edge a. We
have assumed here, without loss of generality, that this subspace forms the
first n coordinates and that the corresponding n-dimensional subspace forms
a canonical subspace of this quasicube.
We define the vertices of the quasicube using the following iterative rule:
1. The vertices of the one-dimensional cube are the endpoints of the seg-
ment c and c + a.

612
15 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTATIONS
2. To define vertices of an n-dimensional quasicube in an n-dimensional
canonical space, we proceed as follows. Let the vertices of an (n - 1)-
dimensional quasicube be detennined. Assign the segment
to each such vertex Zk, ..., ZZ-l (k is number of the vertex), where
and .on is an n-dimensional quasicube.
This segment is fonned by the intersection of the line (zl, ...,zt1,zn)
and the quasicube. The endpoints of the segment form the vertices of the
quasicube.
Thus if
is the kth vertex of an (n - 1)-dimensional quasicube, then
are correspondingly the (2k - 1)th and 2kth vertices of the n-dimensional
quasicube.
Now we assign to an arbitrary sequence
Yl, ···,Yn
(yi={l,-l})
a vertex z* of a quasicube defined as follows:
j = 2, ... ,n.
In turn, to each vertex z* of a quasicube in Rn we assign a point
z* = (zl, ... ,z~) E A

15.4 AN AUXILIARY LEMMA
613
such that the distance between the projection (zl"", z:) of this point in Rn
and the vertex z* is at most 8/2, that is,
.
.
8
Iz1 - i.11 < -
*
•
2'
j = 1, ""n,
This is possible because z. E PrA e on Rn ,
Thus we introduce two functions
(
~1
~n)
Z.
Z. z*, ,..,z* '
We shall denote the difference z! -
2~ by OJ (j = 1, ""n) (IDjl ~ 8/2) and
bound the quantity
Q(<fl)
1
R
Esup £ LziYi
lEA
i=1
! ~ Ey·(z~i +D') +! ~ Ey·z i
I! L
I
*
I
I! L
I.'
i=1
i=n+l
Observe that the second summand in the sum is zero, since every term of
the sum is a product of two independent random variables Yi and z~, i > n,
one of which (Yi) has zero mean,
We shall bound the first summand, For this purpose consider the first term
in the first summand:
To bound the kth term
I
1E[
(A..k-I(~I
~k-l)
a
~)]
k = £
Yk
'f'
Z*, ,." Z.
+ 2"Yk + Ok
,
we observe that the vertex (zl, ..,,2:- 1) was chosen in such a manner that it
would not depend on Yk but only on Yl, "',Yk-I' Therefore
1 [a
]
1
h=-
-+EYkDk >-(a-8),
I!
2
-2£

614
J5 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTATIONS
Thus we obtain
f
1"1
n
(t
1)
Q(ct» > E :.~~ "l f::; Z.Yi ~ 2£ (a - e) > (a - e) 2 - 2£
.
Choosing the quantity a in accordance with (15.22), we arrive at
The lemma is thus proved.
15.5
NECESSARY AND SUFFICIENT CONDITIONS FOR UNIFORM
CONVERGENCE. THE PROOF OF NECESSITY
Theorem 15.1. For the uniform convergence of the means to their mathemat-
ical expectations over a uniformly bounded class of functions F(x, a), a E A,
it is necessary and sufficient that for any e > 0 the equality
(15.25)
be satisfied.
To prove the necessity we can assume, without loss of generality, that the
class F(x, a), a E A, is convex in the sense of (15.23), since from the uniform
convergence of the means to their mathematical expectations for an arbitrary
class, it follows that we obtain the same convergence for its convex closure,
and the condition (15.25) for a convex closure implies the same for the initial
class of functions.
Proof of Necessity. Assume the contrary. For some eo > 0 let the equality
(15.26)
be fulfilled, and at the same time let uniform convergence hold: that is. for
all e let the relationship
(15.27)
be satisfied. This will lead to a contradiction.

15.5 THE PROOF OF NECESSITY
615
Since functions, F(x, a), a E A, are uniformly bounded by 1, it follows
from (15.27) that
This implies that if £) ~ 00 and £ - £) ~ 00, then the equality
is fulfilled.
Consider the expression
We subdivide the summation with respect to n into two "regions"
1:
In - ~I < £2/3,
ll:
In - ~12 £2/3.
Then taking into account that
1
n
I
£ L F(xj, a) - L
F(Xi, a) S 1,
i=)
i=n+)
we obtain
Note that in region 1 (1/2 _1/£2/3 < n/£ < 1/2 + 1/£2/3) we have
en
L 2: f~l,
nEt
(15.28)

616
15 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTATIONS
while in region I I we obtain
en
'"" -p ~O
L
2P
P~c:x.
•
nEil
Furthermore,
(15.29)
lim EI(x], ...,xp)
f ---+:>0
(
en
1
:::; lim L
2; + -2 maxEsup
p---+:>0
nEI
aEA
nE/I
It follows from (15.28) that
1 nIP
en)
n~F(Xi' a) - £ _ n i~IF(Xi' a) ~ 2; .
1
n
1
f
maxEsup - LF(xi,a) - -- L
F(xi,a)
~O.
nEI
aEA n .
£ - n .
f---+:>o
1=1
l=n+1
Thus taking (15.29) into account we have
lim EI(x], ...,xp) = o.
( ---.x,
On the other hand,
1
P!
EI(x), ... ,x,) = E £! LI(Tdx), ...,xt}),
k=1
(15.30)
where Tk (k = 1, ..., £!) are all the permutations of the sequence. We trans-
form the right-hand side:
(Here j(i, k) is the index obtained when the permutation Tk acts on i.) In
the last expression the summation is carried out over all the sequences
YI,""YP,
which have n positive values.
{
I,
Yi =
-1,

15.5 THE PROOF OF NECESSITY
617
Furthermore, we obtain
EI(x] , .. " x,) = E ;1' { L
sup} L,.=(] YiF(Xi, ex) } .
YI, .."Y' aEA
In (15.31) the summation is carried over all sequences
Choose for eo > 0 a number such that
(15.31)
Since c(e) is nondecreasing as e decreases, one can choose e so that the
relations
o< 1.5e ::; eo,
I (1
)
c(eo)ln2
n
+e <
2
'
c(1.5e) ~ c(eo)
are fulfilled. Then in view of (15.9) the probability of fulfillment of the
inequality
A
{C(80) In2}
No (x], ...,xp;1.5e) > exp
2
f.
(15.32)
tends to 1. According to Lemma 15.4, when (15.32) is satisfied, the expression
in the curly brackets in (15.31) exceeds the quantity
where
c(eo)Jn2
I (
)
y=
2
-nl+e
and t = tee, y) does not depend on f.. Hence we conclude that
This inequality contradicts the statement (15.30). The contradiction obtained
proves the first part of the theorem.

618
15 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTAnONS
15.6
NECESSARY AND SUFFICIENT CONDI'rIONS FOR UNIFORM
CONVERGENCE. THE PROOF OF SUFFICIENCY
The folJowing lemma is valid.
Lemma 15.5. For e> 22 the inequality
B
holds true.
Therefore iffor any B > 0 the relation
is valid, then for any B > 0 the convergence
also holds true.
(15.33)
Proof The proof of this lemma mainly repeats the proof of the basic lemma
(Section 14.2). The only difference is that instead of Chernoff's inequality we
use Hoeffding's inequality. We denote by Rr the event
Then for sufficiently large e the inequality
P{Rr} > TI > 0
is fulfilled. We introduce the notation

15.6 THE PROOF OF SUFFICIENCY
619
and consider the quantity
P2f = P {suPS(X\, ...,xu;a) > ~}
aEA
r ...1 0 [suPS(XI, ... ,X2f; a) - ;0] dP(xd ... dP(X2f).
lx\
Xu
aEA
Next the inequality
P2f 2: r{r ...1o [SUPS(XI"",x2r;a)-;0]
1R I
lx/+\
Xu
aEA
X dP(xp+I) ... dP(X2f)} dP(xd ... dP(x().
is valid. To each point XI,"" Xp belonging to Rf
we assign the value
a*(xl, ...,xr) such that
P
~ L F(Xi, a*) - EF(x, a*) > e.
i=1
~
.
f
Denote by Rr the event In X = {Xp+l, ...,xu} such that
1
2f
f L F(Xi, a*) - EF(x, a*)
:s;~.
i=f+1
Furthermore,
P2f 2: i
l {hi 0 [S(XI, ...,xu;a*(XI, ...,xp)) -~] dP(X(+d ...dP(X2f)}
dP(xd ... dP(X2P)'
However, if (XI,""Xp) E Rp, while (Xp+l""'XU) eRr, then the integrand
equals one. For f > 22 using Hoeffding inequality we obtain P (Re ) > ~ and
e
~
therefore
11
1
P2f> 2:
dP(xd ... dP(xd = 2:P (Rr).
Rf
This proves first part of the lemma.
To prove second part of the lemma, let us assume that there exists such
eo > 0 that P(Rf ) =1= O. Then according to (15.32) we have
which contradicts the condition of the lemma. The lemma is thus proved.

620
15 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTATIONS
The Proof of the Sufficiency of Conditions of the Theorem. We shall prove
that under the conditions of the theorem we have
P {SUP S(X1,...,XU;a) > e} ----; O.
aEi\
€->oo
In view of Lemma 15.5, it follows from conditions (15.33) that the statement
of the theorem is fulfilled; that is,
ph~~ }t,F(Xi'UJ-EF(X,U) >8},.~o
We shall show the validity of (15.33).
For this purpose we note that in view of symmetry of the definition of the
measure, the equation
P {suPS(X)"",X2€,a) > e}
aEA
1
(2£)!
{
}
= (2£)! L P
supS(Tj(x), ...,xu),a) > e
j=l
aEA
{
I
(U)l
}
= /
(2£)! L O[supS(Tj(x), ... ,x2€),a) - e]
dP(x) ... dP(x2f)
j=)
aEA
(15.34)
holds true. Here Tj , j = 1, ... , (2£)! are all the permutations of the indices,
and Tj (x), ...,xu) is a sequence of arguments obtained from the sequence
x), ...,X2i when the permutation Tj is applied.
Now consider the integrand in (15.34):
1
(2f)!
K = (2£)! L 0 [supS(Tj(x) , ...,xu), a) - e].
j=)
aEA
Let A be the set of vectors in Ru with coordinates Zi = F (Xi, a), i = 1, ..., 2£
for all a EA.
Let z(l), ... , z(No) be the minimal proper e net in A, and let a(I), ... , a (No)
be the values of a such that
Zi (k) = F(x;, a(k»,
We show that if the inequality
i = 1, ... , 2£ , k = 1, ... , No.
e
max Sex), ...,xu;a(k» < -3
)SkSNo

15.6 THE PROOF OF SUFFICIENCY
621
is fulfilled, then the inequality
supS(x], ...,xy,a) < B
aEA
is also valid.
Indeed, for any a there exists a(k) such that.
IF(x;, a) - F(x;, a(k))1 < }'
Therefore
1
f
1
2f
f LF(x;, a) - f L
F(x;, a)
;=]
;=f+]
i = 1, ...,2£.
1 (
e
e
)
= f
~ F(x;, a) - ~ F(x;, a(k))
1 (
2f
2f
)
-f
;~] F(x;, a) - ;~] F(x;, a(k))
1(f
2f
)
+7
~ F(x;, a(k)) - ;~] F(x;, a(k))
1
e
2f
~ 2~ + 7 L
F(x;, a(k)) -
L
F(x;, a(k)) < B.
;=]
;=f+]
Analogous bounds are valid for S(Tj(x], ...,Xy), a). Therefore
We evaluate the expression in curly brackets:

622
15 UNIFORM CONVERGENCE OF MEANS TOTHEIR EXPECTATIONS
where Tj(i) is the index into which the index i is transformed in the permu-
tation TJo We order the values F(Xi, a(k)) by magnitude:
F(x·
a(k)) < .
0
• < F(x·
a(k))
I)'
-
-
'21'
and denote zP = F(xjp, a(k)).
Next we use the notations
dp = zP -
Zp-l ,
for F(x;, a(k)) :s: zP,
for F(xi,a(k)) > zP,
for
TJ~] (i) :s: e,
for T;.-I (i) > e,
where Tj- 1(i) is the index which is transformed into i by the permutation Tj •
Then
f
2P
1eL F(XT,U) ,a(k)) - L F(XT,U)' a(k))
i=1
i=P+I
1
2P.
2f
.
= eL dpL Siprf - L d pL Sip (1 - rf)
p
;=1
p
i=]
1
2P
.
= Ldp eL Sip(2rf - 1)
p
i~1
Furthermore, if the equality
1
2f
max - "Sip(2rf - 1) < ~
p
f. LJ
3
j=]
is fulfilled, then the inequality
is also valid. The condition (15.35) is equivalent to the following:
(15.35)
(15.36)

15.6 THE PROOF OF SUFFICIENCY
623
Thus we obtain
1 (2£)!
[1
2f
.
B]
-
'"" max (1
-
'"" l). (2rl -
1) --
(2£)! L- peL-
lp
I
3
j~1
i~1
{ I
(2£)!
[1
2f
.
< ~
(2e)! ~ (1 f ~ l)ip(2rf - 1)
Let there be 2e balls, of which
2f
Ll)ip = m
i=1
(15.37)
are black, in an urn model without replacement. We select e balls (without
replacement). Then the expression in the curly brackets of (15.37) is the
probability that the number of black balls chosen from the urn will differ
from the number of remaining black balls by at least Be/3. This value equals
ck Cf - k
r = '""
m
2f-m
L-
Cf
'
k
2f
where k runs over all the values such that
In Chapter 4, Section 4.13 the quantity r is bounded as
Thus
2£
{2e}
{2e}
II < L3exp
-
B
9
= 6eexp
- B
9
.
p=l
Returning to the estimate of K, we obtain
(15.38)

624
15 UNIFORM CONVERGENCE OF MEANS TOTHEIR EXPECTATIONS
Finally, for any c > 0 we obtain
{
1 e
1
2f
}
P
~~~ eEF(x;, a) - e;~l F(x;, a) > 8
::;1
dP(xd··· dP(X2f)
In N,i\(Xt ,...•x21;e/3»cl
+1
K(XI, ...,x2£)dP(x\)... dP(X2f)
In NI·~(Xl .....X2f;e/3):scf
p{ lnNo!\.(X\, ... ,Xu;813)
}
6 1J
{82£
IJ}
::;
£
> C
+
f- exp
- -9 + Cf-
•
(15.39)
Setting c < 8 2/10, we obtain that the second term on the right-hand side
approaches zero as £ increases. In view of the condition of the theorem and
the relation (15.8), the first term tends to zero.
Thus, the theorem has been proven.
15.7
COROLLARIES FROM THEOREM 15.1
Theorem 15.2. The inequality
{
1
f
}
P
~~~ EF(x, a) - f ~ F(x;, a) > 8
::; 12£ENI\(x], ...,xu; 8) exp {_;2: + cf }
holds true. The bound is nontrivial if
To prove this theorem it is sufficient to put (15.38) into (15.34) and use
the result of Lemma 15.5 for £ ~ 22 , For £ < 22 , the bound is trivial.
8
8
Theorem 15.3. For uniform convergence of means to their mathematical ex-
pectations it is necessary and sufficient that for any 8 > 0 the equality
be fulfilled, where A e is the 8 extension of the set A.

15.7 COROLLARIES FROM THEOREM 15.1
625
Proof of Necessity. Let £, 8 > 0 and 8 < £ and let To be a minimal proper
8 net of A with the number of elements Nt(xl, ...,xu; 8). We assign to each
point in To a cube with an edge £ + 28 and center at this point, oriented along
the coordinate axes.
The union of these cubes contains AI.' and hence
from which we obtain
In view of the basic theorem we obtain
lim E ~ In V(A e ) ~ In(£ + 28).
f-4OO
~
Since V (AI.') > £f and 8 is arbitrary, we arrive at the required assertion.
Proofof Sufficiency. Assume that the uniform convergence is not valid. Then
for some
E: > 0 we have
lim 210 E In Nt(x\, ...,xu; 1.5£) = 'Y > 0,
P-400
~
from which, in view of Lemma 15.2, we obtain
The theorem is proved.
Denote by L(xt, ... , Xf; £) the number of elements in a minimal £ net of
the set A(x\ ..., Xl) in the metric
f
1 "'.
.
p(Zt, zz) = f ~ Iz~ -
z~l·
i=\
Theorem 15.4. For a uniform convergence of means to the mathematical
expectations it is necessary and sufficient that a function T (£) exists such
that
lim P{L(x\, ...,xp;£) > T(£)} = O.
f--->oo
To prove this theorem we prove two lemmas.

626
15 UNIFORM CONVERGENCE OF MEANS TO THEIR EXPECTATIONS
Lemma 15.6. Ifuniform convergence is valid in the class offunctions F(x, a),
a E A, then it is also valid in the class IF(x, a)l, a E A.
Proof The mapping
F(x, a) --1F(x, a)1
does not increase the distance
Therefore
where No\ and N(~ are the minimal numbers of the elements in an 8 net in the
sets A and A representatively generated by the classes F(x, a) and IF(x, a)l.
Consequently the condition
implies
The lemma is proved.
Consider a two-parameter class of functions
along with the class of functions F (x, a), a E A.
Lemma 15.7. Uniform convergence in the class F(x, a) implies uniform con-
vergence in f(x, ai, az).
Proof Uniform convergence in F(x, a) clearly implies such a convergence
in F(x, al) - F(x, az). Indeed, the condition

15.7 COROLLARIES FROM THEOREM 15.1
627
and the condition
1
f
1 (
EF(x, ad - EF(x, az) -
£. L F(x;, ad + £. L F(x;, az)
;=1
;=1
1
f
1
f
< EF(x, ad - £. L F(x;, al) + EF(x, az) -
£. L F(x;, az)
;=1
;=1
imply that
1
f
E (F(x, ad - F(x, az)) - f L (F(x;, ad - F(x;, az))
:S 28.
;=1
Applying Lemma 15.6, we obtain the required result.
Proofof Theorem 15.4. To prove the necessity, note that according to Lemma
15.7 the uniform convergence of the class F(x, a) implies the uniform con-
vergence of the class f(x, aI, az), that is,
Consequently for any 8 > 0 there exist finite £0 and sequence x~, ...,x;o such
that the left-hand side of (15.40) is smaller than e. This means that the dis-
tance
1
t(1
PI(UI, az) = £ L IF(xt, ad - F(xt, az)1
o ;=1
approximates with accuracy e the distance in the space L 1(P)
(15.41)
(15.42)
uniformly in al and az. However, in the metric (15.41) there exists on the set
F(x, u), U E A, a finite 8 net 5 with the number of elements L(x~, ... ,X;;8).
The same net 5 forms a 28 net in the space A with the metric (15.42). Next
we utilize the uniform convergence of PI (UI' uz) to i>2(al, uz) and obtain that
the same net 5, with probability tending to one as £ ---> 00, forms a 38 net on
the set A (x~, ... ,x;). Setting
T(8) = L(xr, ...,X;;8),
we obtain the assertion of the theorem.
The proof of sufficiency of the conditions is analogous to the proof of
sufficiency for Theorem 15.1.


16
NECESSARY AND
SUFFICIENT CONDITIONS
FOR UNIFORM ONE-SIDED
CONVERGENCE OF MEANS
TO THEIR EXPECTATIONS
In this chapter we achieve our main goal: We derive the necessary and suf-
ficient conditions of uniform one-sided convergence of the means to their
expectations over a given set of bounded functions F(x, a), a E A; in other
words, we derive the conditions under which the limit
lim P {sup (EF(X, a) - ~t F(Xi, a)) > £} = 0
t -'00
aEi\
(,
.1=1
holds true for any £ > O.
16.1
INTRODUCTION
In Chapter 15 we discussed the problem of uniform two-sided convergence
of the means to their mathematical expectations over the set of functions
F(x, a), a E A:
The existence of uniform two-sided convergence forms the sufficient con-
ditions for consistency of the empirical risk minimization induction principle.
However, uniform two-sided convergence is too strong a requirement for
justification of the principle of the empirical risk minimization. In Chapter 3
629

630
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
we proved that for consistency of the empirical risk minimization principle,
it is necessary and sufficient that the uniform one-sided convergence
lim P {sup (EF(X, ex) - !t F(Xi, ex)) > e} = 0
f~x
oE,\
{'
i=)
be true.
In this chapter we will derive the necessary and sufficient conditions for
uniform one-sided convergence.
In Chapter 3 we gave a special definition for nontrivial consistency of the
maximum likelihood method (which requires the consistency of estimating
any density from a given set of densities). In this chapter we prove that the
necessary and sufficient conditions imply the (nontrivial) consistency for the
maximum likelihood method as wel1.
To derive the necessary and sufficient conditions of uniform one-sided
convergence, we have to consider several constructions.
16.2
MAXIMUM VOLUME SECTIONS
Let there be specified a space X, a probability measure P(x), and a set of
functions
a ~ F(x, ex) ~ A,
ex E A
measurable with respect to P (x). (Without restrictions In generality we
assume that a = 0 and A = 1.)
Let
XI, ... ,X,
be an i.i.d. sample from X.
We consider an £-ary space and a set Z of vectors z = (z I, ... , z') defined
on it by the rule
Z = { z: :lex E A, Vi Zi = F(Xi, ex) } .
We also consider an e extension of the set Z-that is, a set of £-ary vectors
Ye = {y: :lz E Z, p(y, z) < ~} ,
p(y, z) = max Ii - zll·
)SiS'
Here Ye is the union of all open cubes oriented along the coordinate axes,
with edge e and with center at the points of the set Z.
Let Ve(x), ... ,x,) be a volume of the set Ye = Ye(x), ""Xl)' We denote
(16.1)

16.2 MAXIMUM VOLUME SECTIONS
631
In Theorem 15.1 (Chapter 15, Section 15.1) it is shown that the conditions
Ve > 0
(16.2)
form the necessary and sufficient conditions for uniform two-sided conver-
gence and are equivalent to
I·
H~(f) - CA - I
1m
0
-
I' -
ne.
,~oo
{;
(16.3)
Now suppose that the conditions defined by (16.3) are not satisfied; that is,
the conditions for uniform two-sided convergence are equivalent to
(16.4)
We set x = Xl and construct the set Ye (X,X2, ... ,x,) for the specified Xz, ...,x,.
Consider the section produced on cutting this set by a hyperplane
as a set Yeo b(X,X2, ...,Xl') of vectors y = (y2, ... ,yE) E Rf - I such that there
exists a* E A satisfying the conditions
IF(x, a*) - bl < ~,
IF(xi,a*)-yil <~,
i=2, ...,f.
The volume VI', b(X,X2' ...,Xl') of the set Ye , b(X,X2, ...,x,) is nonzero for b's
such that
e
3a E A : IF(x, a) - bl < 2'
Obviously, if (16.5) is satisfied, then the inequalities
hold true. Accordingly, the inequalities
(f -1)loe ~ loVe, b(X,X2,""X,) ~ (f -1)ln(1 + e)
hold true. We denote
(16.5)

632
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
The functions H~~ b(x, £) and C~: b(x) are defined on the set of b's satisfying
(16.4). In the domain of definition for C~ b(x) the following inequalities hold
true:
Ine ~ C~ b(x) S; In(1 + e).
We denote by D~ the set of b's such that
The following theorem is valid:
Theorem 16.1. For almost all x's,
(16.6)
Equality (16.6) is satisfied on the set D~ formed by an aggregation of a finite
number of intervals of a length each not less than e.
To prove the Theorem 16.1, we consider the set Ye,ll,b(XI, ""Xl) E Rl - 1,
e > 0, 8 > 0, of vectors y = (y2, .", /) such that there exists a E A for which
and
(a)
8
IF(x[,a) -bl < 2
(b)
.
e
IF(x;,a) -ll < 2'
i=2, ...,£.
Accordingly
we
denote
by
Ve.il,b(XI, ""Xl)
the
volume
of
the
set
Ye,ll,b(Xl, ...,Xi):
Here the functions H~,Il,b(x, £) and C~Il,b(X) are defined for b's such that
3a:
8
IF(x, a) - bl < 2'
Obviously, the following equality holds

16.2 MAXIMUM VOLUME SECTIONS
633
Lemma 16.1. For almost all x's,
where the maximum is taken in the domain of definition for C~\b(x).
Proof (a) First we show that the inequality
sup C~8,b(x) ~ C~
b
holds true. Indeed
(16.7)
because the definition of the set Y",8,b(Xt,X2, ...,x,) differs from that of the
set Ye (X2, ...,Xf) in only the additional condition (a).
Therefore
from which (16.7) follows immediately.
(b) Now we will show that for almost all x's there exists b such that
(16.8)
To this end, we consider a finite sequence of numbers bo,bl, ..., bk such that
bo = 0,
bk = 1,
i = 0, 1, ...,k - 1.
The number k depends solely on ~.
Note that the equality
kUYe,8,b,(X,X2, ,,,,Xl) = Ye (X2, ,,,,Xl)
i=o
holds true (because the union of ~-neighborhoodsof the points bi covers the
entire set of values of F(x, a)). Therefore
k
Ve(X2, ''', Xl) < L Ve,8,b, (x, X2, ...,X,)
i=O
<
(k+l)m~xVe,8,b,(X,X2'''''Xf)'
I

634
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
Hence
In Ve (X2, ...,xp)
In(k + 1)
In VeOh (X,X2, ... ,xp)
__'---,--_'-'- <
+ max
' ,
I
•
£-1
-
£-1
i
£-1
In Chapter 15 (Section 15.7) it is shown that
Similarly, it is established that
(16.9)
(16.10)
in the domain of definition. Furthermore, since k is independent of f, it
follows from (16.8) and (16.9) that
The inequalities (16.8) and (16.11) prove the lemma.
Lemma 16.2. Given 0 < e, for almost all x's there holds
C~\(x) =
max
C~\ ",(x),
,
1319' <:132
"
where
(16.11)
e-o
f31 ----:: b- -2-'
Proof By definition,
e-o
f3z =- b + -2-'
A
A'
Ce,,,(X) = Ce ,
where A' is derived from A by imposing an additional constraint
e
IF(x, 0') - bl < 2'
By applying Lemma 16.1 to this subclass, we get
(16.12)
(16.13)
Moreover, in view of (16.12), we can strengthen Lemma t6.1 and obtain
(16.14)

16.2 MAXIMUM VOLUME SECTIONS
635
where {31 and 132 are defined in the condition of Lemma 16.2. Indeed, we can
choose the sequence ba, ... , bk used to prove Lemma 16.1 so that
8-8
ba=b---
2
'
8-8
bk =b+ -2-'
and bi+\
- bi < 8/2 (in this case the union of neighborhoods covers the entire
set of values of F(x, 0'), 0' E A). By repeating the proof of Lemma 16.1, we
obtain (16.14). But for b from the segment [13\,f32J the narrowing of A to A'
is immaterial because, given
8
IF(x, 0') - bl < 2'
the condition
8
IF(x, 0') - bl < 2
will be satisfied automatically. Thus
C~b(X)=
max
C~\b'(X).
,
131 S:.b' S:.lh
,.
This completes the proof of Lemma 16.2.
(16.15)
Proof of Theorem 16.1. The proof of the first part of Theorem 16.1 follows
from Lemma 16.1 on inserting 8 for 8.
The proof of the second part of the theorem follows from the fact that,
by virtue of Lemma 16.2, for any point b where
t\
A'
Ceb(x) = Ce
and for any 0 < 8 < 8, one can find a point b' such that
Ib' - bl <
8
- 8
2
and
C~8,b' = C~.
But then, by virtue of the same lemma and over the entire segment
b'
8 - 8
b
b'
8
- 8
---<
<
+--
2
-
-
2
the following equality will be satisfied:
(16.16)
(16.17)
C~b(X) = C~.
In view of the arbitrary smallness of 8, the conclusion of Theorem 16.1 follows
from this.

636
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
16.3
THE THEOREM ON THE AVERAGE LOGARITHM
We denote by K:- the Lebesgue measure of the set D~.
Theorem 16.2. The inequality
holds true.
(16.18)
To prove Theorem 16.2, we fix Xl, ... ,xf and define the density g(y) in R f :
if Y ~ Ye(Xl' ".,Xf),
if y E Ye(Xl' ...,Xf).
On any coordinate subspace Rk this density induces the density
We denote
where H Rk (.) is the Shannon entropy of the density gk' In particular,
We denote
Note that, with specified e in advance, H Rk (e) depends solely on the dimen-
sionality of k and is independent of the choice of a specific subspace (which
follows from the independence of the sample): that is,
Therefore,
A
A
H(e, e) = He (e).

16.3 THE THEOREM ON THE AVERAGE LOGARITHM
637
We denote
ll(k f) _ { H(l, f)
,
-
H(k,£)-H(k-1,f)
Lemma 16.3. The following inequality
ll(k + 1, f) ::; ll(k, f)
holds true.
for k = 1,
for k > 1.
Proof Let Rk and Rk+1 (Rk C Rk+l) be two coordinate subspaces with co-
d"
I
k
d
I
k
S
•
I W d
or mates y , ...,y an y , ...,y ,y ,respectIve y.
e enote
We have
HRk+I(XI, ""Xl)
= - r
gRk+I(y)lngRk+l(y)dy
1Rk+1
= _ r{r g(YSlyl, ...,yk)g(yI, ...,yk)
1y'
iRk
x In [g(ySlyl, ...,yk)g(yl, ...,l)] dyl, "', dyk} dyS
= HRk(XI, ,,,,Xl)
-is {kk g(ysly l, ..·,i)g(yl, ·..,l) In [g(YSli, ...,yk)] dyl, ..., dl } dyS.
Hence
Il(Rk+1, Rk )
=is {tk g(ySlyl, ... ,yk)g(yl, ...,yk) In [g(ySlyl, ...,yk)] di, ...,dyk } dyS;
(16.19)
that is, Il(Rk+l, Rk)
IS the average conditional entropy for the specified
I
k
Y , ...,y .

638
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
We now put:
Rk - the space yl, ''',l;
Rk+l _ the space y',
,yk, yk+l;
R}+l _ the space y I,
, yk, yk+2;
Rk+2 _ the space y' ,
,yk, yk+1 ,yk+2.
By applying (16.19) to pairs ~(R~+I,Rk) and
~(Rk+2,Rk+I ), respectively,
and recalling the theorem of nonnegativity of information proved in infor-
mation theory, we get
By averaging over the sample XI, ... , Xt, we obtain
Hence
~(k, f) 2' ~(k + 1, f).
(16.20)
In accordance with the above note, Eq. (16.20), in contrast to (16.19), depends
solely on the dimensionality and does not depend on the choice of specific
subspace. Lemma 16.3 has thus been proved.
Corollary 1. The inequality
A
A
fI(l f) > H(f, f) = He (f)
,
-
f
f
holds true.
Indeed, since
t
H~\(f) = H(f, f) =L ~(k, f),
k=l
~(l,f) = H(l,f)
the validity of Corollary 16.1 stems from Lemma 16.3.
Corollary 2. The inequality
lim H(l, f) 2' C~
f~')O
holds true.

16.3 THE THEOREM ON THE AVERAGE LOGARITHM
639
Lemma 16.4. For almost all x's, the inequality
(i. e., the condition y E D.~) entails
Proof By definition,
On the other hand, as was noted earlier,
Therefrom follows the conclusion of Lemma 16.4.
We denote further
where Rk = {y: i, ...,yk}.
Lemma 16.5. For almost all x's and for all eO's, the following relation holds
true:
~
A
P
P{HR1(X,XZ, ""Xf) > InKx + eO} ----> O.
f~x
Proof Consider the aextension D~(a) of the set D~\-that is, the set of such
y's for which there exists y* E D.~ satisfying the conditions
Iy - y*1 < ~,
a> O.
Let b~(a) be the complement to the aextension of the D~(a) on the segment
-e/2 ~ y ~ 1 + e/2. By Theorem 16.1, DNa) consists of a finite number of
closed intervals. We will now show that for all x's we have
(16.21 )

640
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
Obviously, it will suffice to prove the above statement for an arbitrary seg-
ment n constituting jj~'l.(8). Let
bi+\ - bi < 8,
where k is only function of 8.
We denote by Yt:,n(x) the set of vectors y = 0'1, ...,y') such that there
exists ex E A satisfying the conditions
8
8
a\ - 2 ::; F(x, ex) ::; a2 + 2'
.
8
IF(x;,ex)-il < 2'
i=l, ...,£.
Then, by definition,
Yt:,y(x) c Yt:,n(x)
for yEn;
k
Yt:.n(x) c UYt:,b, (x).
i=1
Hence
k
sup Ve,y(x) ::; Vt:.n(x) ::; L Vt:,b, (x)
yEn
;=\
and, as a consequence,
such that for all i's, bj E nand
C~b (x) < C;.
, ,
But, by Lemma 16.4,
p
maxg(b j )
----f 0,
;
1-+00
from which we get (16.21). Furthermore, we have
j
\+t:/2
HRI(x,X2...,Xf) = -
g(y)lng(y)dy
-t:/2
-!
gO') Ing(y) dy-! _ gO') Ing(y) dy
YED~\(li)
YED~\(li)
::; In L:(D~(8)) + L:(jj~(o))
sup
[gO') Ing(y)],
yED~\(li)
where L:(A) is Lebesgue measure of the set A.

16.3 THE THEOREM ON THE AVERAGE LOGARITHM
641
Hence, by (16.21), for all B* > aand for almost all x's we have
PX,X2,""X/ {fJRI(x, ...,x£) > In£(D~U») + B*} --- O.
(-'00
Furthermore, since (16.22) holds for any 0 > 0 and
£(D~(o» -t K:,
/)-.0
we find that for almost all x's
for all B* > O. This completes the proof of Lemma 16.5.
(16.22)
(16.23)
Lemma 16.6. Let IFf (x, y)I< B be a function of two variables, x E X and
y E Y measurable on X x Y with P(x,y) = P(x)P(y).
Let there exist a function 4> (x) measurable on X, such that for almost all
x's and for all B > 0 we obtain
lim Py {F£(x,y) ~ 4> (x) + d = O.
f-+oo
Then
Proof We set B > 0, 0 > O. We denote by At the event in the space X:
From the statement of Lemma 16.6 we have
lim Px{A£) = O.
f-+oo
Furthermore,
Ex,yFp(x,y) LIv Ft{x,y)dP(x)dP(y):::; BPx(Ap)
+ r [/
F,(x,y)dP(y)
lXEAf
-F/(x,y»<f>(X)+E:
+ r
Fp(X,y)dP(Y)] dP(x)
1Ff(x ,y )s.<f> (X)+E:
< BPx(Ad + BlJ +L(4) (x) + B) dP(x).
(16.24)

642
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
Taking into account (16.24) and the arbitrary smallness of 71 and 8, thus we
have obtained the statement of Lemma 16.6.
Proof of Theorem /6.2. In Lemma 16.6, we put
X =XI,
Fr(x,y) = H(XI, ... ,X,) :::; In(1 + 8),
4>(x) s K~'"
Subject to (16.23), we obtain
limH(I,p) S IlnK.~\dP(X).
r --> 'Xo
Combining the above result with that of Lemma 16.4, we get
c~\:s liminfH(l,£):s limH(I,£):s IlnK~\dP(X).
f-->oo
f-->'Xo
This completes the proof of Theorem 16.2.
16.4
THEOREM ON THE EXISTENCE OF A CORRIDOR
Definition. We call the corridor R; the set of pairs (x, D~\).
Theorem 16.3. To each point x we may let correspond the set D~\ on the seg-
ment [-8, 1+ 8], with Lebesgue measure K~ such that the following conditions
are satisfied:
1.
2. For almost all XI,.'" Xf (in the sense of the measure P (x, ... ,Xf)) and
almost all i ,...,l ,
yi E D~, (in the sense of Lebesgue measure). there
can be found a* E A such that
for all i = 1, ...,f..
To prove this theorem we consider the following process. Let us call it the
process A.
Definition of the Process A. Let there be specified an infinite sample
XI, ... ,Xr, ...,

16.4 THEOREM ON THE EXISTENCE OF A CORRIDOR
643
collcctcd in a scrics of indcpcndcnt trials with distribution P (x). At each step
of the process, we will construct:
1. The subset Ai of functions F(x, a), a E Ai, Ai C A.
2. The corridor R;' corresponding to this subset.
We put Al = A and R~1 = R~.
Suppose that Ai and R~' are constructed by the ith step, that is,
D.~~' is
specified for each x E X and the point x; occurs at that step. We choose the
number y; E D~' in a random fashion and independently in keeping with the
density of the distribution
We set
P(y) = {~
K A,
x,
'f
dD'\'
I Y 'f
x,'
ify ED'\'.
x,
Ai+1 = {a:
a E Ai and IF(x;, a) - i/ < ~}.
Then the corridor at the (i + 1)th step will be R;HI.
The process is arranged to run so that, despite the decrease in the sets
the quantities C~\I preserve their values; that is,
and, in consequence, Ai is nonempty for all i's. This follows from the fact
that, by definition of D~', the narrowing of A; by the condition
8
IF(x, a) - yl < 2
leaves C~\ unchanged. Noting further that
and taking into account the result of Theorem 16.2, we get
(16.25)

644
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
We let the numerical set
00
DO=n DA,
x
x
i=l
correspond to each point x E X. Accordingly,
K~ = lim K;I.
1-+00
It follows from Theorem 16.1 that D~ is the union of a finite number of
nonintersecting intervals, segments, or semi-intervals of a length not less than
e and belongs to the segment [-e, 1+ e]. Therefore,
K~ 2:: e.
If the K.~' are measurable functions, then K~ is measurable too.
Furthermore, since the In K:I are uniformly modulo-bounded, it follows
that for any realization of the process we have
Thus, any realization of the process A enables one to fmd
D~ satisfying
requirement 1 of Theorem 16.3. We will show now that almost any realization
of process A generates D~ satisfying requirement 2 of Theorem 16.3.
Lemma 16.7. Let
be a sample of length f + k from X, let the numbers yl, .... yk be sampled in
the course of the process A, and let Ah1 be the subset A constructed by the
(k + 1)th step ofprocess. Consider the set R~ specified by direct product
R~ =
and introduce a uniform density,
hi
II
DAk+1
XI
'
i=k+l

16.4 THEOREM ON THE EXISTENCE OF A CORRIDOR
645
on that set. Consider the subset G~ E R~ consisting of sequences yk+l, ...,yk+f
such that yi E D:'k and the system of inequalities
.
8
Iy' - F(Xi, 0:)1 < 2'
i=k+1, ...,k+i
(16.26)
is resolvable for 0: E Ak.
Then for any fixed i 2: 1 the equality holds true
lim E (
/-Lo(y) dV = 1.
k->oo
lc;
(Here the expected value is taken for all realizations of the process up to kth
step and for the extensions of the sample Xk+l, ..., Xk+f)'
Proof To begin with, we assume that
and that the sequence
I
k
Y , ...,y
is fixed. Then on any extension of the process A, as far as the (k + i)th step,
the sequences
I
k+1
y, ...,y
will be sampled with a certain density /-LI. We denote by T; the carrier of
that density.
From the definition of the process A and of the density /-Lo, it follows that
T; C R~ and that on T; the ratio of the densities /-Loi/-LI is defined by
k+t
K A,
/-Lo
IT
x,
/-LI =
K Ak +l
•
i=k+1
x,
Note that /-LI does not depend on y for y E Rt , but /-Lo does.
For
(16.27)
the system (16.26) is obviously a simultaneous one (the set of its solutions is
just Ak+f +I ). Therefore,

646
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
Hence
{
lLodV2: { lLodV= {
(ILO)lLldV.
~~
i~
i~
ILl
By taking the logarithm of the above inequality, we get
In { lLodV? In {
(ILO) ILl dV ~ {
In (ILO) ILl dV.
iG~
iT,k
ILl
iT;
ILl
Therefore using (16.27) we obtain
We now average the above inequality over all realizations of the process as
far as the kth step and over all extensions Xk+h ... , xk+':
We denote
(16.28)
where averaging is done over all realizations of the process as far as the
ith step. By (16.25), we find that Wi is a decreasing sequence bounded from
below. Therefore
lim
IWp+k -
Wk I =-= O.
k--.x;
Note also that for k < i < k + f we have
In the above notation, the inequality (16.28) takes the form
for k tending to infinity and for a fixed e.

16.4 THEOREM ON THE EXISTENCE OF A CORRIDOR
647
Finally, using the inequality
x ~ 1 + In x,
we get
E {
JLodV~1+Eln { JLodV-d.
lG~
lG~
Lemma 16.7 has been proved.
Note. If we denote by G~ the complement to G7 in R~-that is, the set of
sequences
for which the system (16.26) is nonsimultaneous-then for k tending to in-
finity and for a fixed f. it is true that
{
JLo dV --> O.
lCk
k-+oo
£
Continued Proof of Theorem 16.3. Let
f
DO = nDA,
x
x
1
;=1
where D~' are obtained in the course of the process. By the time the process
is completed, let an additional sample
be collected. We denote by Tp E E( the direct product
f
Tp = IT D~"
;=1
We introduce a uniform distribution on it specified by the density
(y \
p) _ {O 1
JL
, ...,y
-
------:-_--,----
0;=1 K.~'
if Y f/Tf ,
if y E T(.

648
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
Let G p be the subset Tp of sequence y 1, ... ,l, such that the system
i=1, ...,e
(16.29)
is nonsimultaneous for a E A.
Theorem 16.3 will have been proved if we establish that
E (k /-LdV = 0,
}6,
where averaging is done over all realizations of the process A and over all
samples Xl, ...,Xp.
We consider. as in Lemma 16.7, the uniform distribution /-La on the samples
yl, ...,yf from the direct product
P
Rk = II DAbl.
f
x,
;=1
(16.30)
Since D~ C D~k, it follows that Tf C R~.
Now, as in Lemma 16.7, we denote by G~ the subset R~ for which the
system (16.29) is simultaneous for a E Ak> and we denote by G~ the comple-
ment to G~ in R~. From (16.30) and by the definition of Op and O~ it follows
that
Then
because K~ and K~~k are bounded from above and below bye and (1 + e).
By averaging the above inequality over all realizations of the process A
and over all extensions .tl, ...,xp, we get
On strength of the note to Lemma 16.7, the right-hand side of the inequality
tends to zero with k tending to infinity and with efixed in advance; and since

16.4 THEOREM ON THE EXISTENCE OF A CORRIDOR
649
this inequality holds true for any k, it follows that for all e ~ 1 we obtain
E (
J.tdV = O.
lc,
This completes the proof of Theorem 16.3.
Corollary 1. From conclusion 2 of Theorem 16.3 it follows that
Proof Indeed, from the definition of Ve(XI,
,Xr) and from item 2 of
Theorem 16.3 it follows that for almost all Xl,
,Xr we obtain
f
Ve(Xl, ..., Xf) ~ II K~.
;=1
Hence
On passing to the limit, we obtain
Taken in conjunction with the statement of item 1 in Theorem 16.3, this
proves Corollary 1.
Corollary 2. For the class of functions F(x, a), a E A, and for the measure
Px , let there hold true the inequality
c~ = In e + 1],
1] > O.
Suppose here that there is specified another measure, P;, absolutely continuous
with respect to Px and let the density
()
dP;
px =--
dPx
satisfy the condition
p(X) > a> O.

650
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
Then
where
Proof Indeed, the inequality
f
V~\(XI, ...,xd 2: II K~,
i=1
is satisfied for almost all x I, ... , Xf in the case of the measure P; as well. By
reasoning along the same lines as in Corollary 1, we obtain
Ep.ln V~\(Xl' ... ,Xf) I
(I
•
~ p
2:
InKt , dP;.
Furthermore. recalling that
In K~ - In e 2: 0,
we get
lIn K~ dPI'
lin e dP.; + Irln K.? - In e] dP;
Ine+ IrlnK.~ -lne]p(x)dPt
>
Ine+a[C~\-lne]=lne+a1J.
Corollary 3. Let
c~\ > Ine.
Also let Px and P; be absolutely continuous with respect to each other. Then
Proof Let
c~\ = /In K~ dPx > In e

16.5 THEOREM ON EXISTENCE OF FUNCTIONS CLOSE TO CORRIDOR BOUNDARIES
651
hold true. Denote
I = {x: InK2 > Ine}.
Then P(I) > 0 and, in consequence, P*(I) > O. Therefore,
C~~ ~ jlnK2dP; ~ Ine+ 1[lnK~ -In£]dP; ~ In£.
Corollary 4. For almost all realizations of the process A, for all f > 1, for
almost all samples Xl, ",Xi, for all yi E Dxo (where Dxo is the closure D~ =
I
I
I
n%:t D~~k), for all B > 0, and for k ~ 1, one can find u* E Ak such that for all
i's (1 :s: i :s: f) we obtain
.
e
IF(xj, a*) - y'l :s: 2 + B
with
jln K.~ dPx = c~\.
16.5
THEOREM ON THE EXISTENCE OF FUNCTIONS CLOSE TO
THE CORRIDOR BOUNDARIES (THEOREM ON POTENTIAL
NONFALSIFIABILITY)
Theorem 16.4. Let
c~'\ = In e + TJ,
1.
Then there exist functions
IfJI (x) ~ l/Jo(x)
that possess the following properties:
jllfJl(X) -l/Jo(x)1 dPx ~ £(e l1 -
1).
2. For any given B > 0, one can show a subclass A* c A slich that C{ =
C~'\, and one can also show functions
such that
<Pl = sup Q(x, a),
aEA'
</Jo(x) :s: l/Jo(x),
<Po = inf Q(x. a)
aE\'

652
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
3.
/(¢l(X) -l/Il(x))dPx < 5,
/(I/!o(X) - q>o(x))dPx < 5.
4. Fur any 51 > 0 and f 2 l,fur almost any sequence Xl, ..., Xf, and for any
sequence Wj, •.. , Wf (w = 0, 1), one can find u* E A* such that
i=l, ...,e.
Proof We will show that almost any realization of the process A described
in the previous section allows one to find the required functions 1/11 (x) and
I/Jr..)(x)-if one sets
6
1/11 (x) = sup y - 2'
YED~
I/!o(x) = inf y + -2
6
YED~
(16.31)
and uses as A* the subclass Ak generated at the kth step of the process, where
k is chosen according to 5 and the specific realization of the process.
To prove this we need some intermediate results.
Lemma 16.8. l"et Y and y* (y* c Y) be two open sets in Euclidean space
Ek . Let their volumes, V and V*, respectively, be finite and V* < V, Suppose
that the density p(x), whose carrier T belongs to Y, has a finite entropy
H=- /p(X)lnp(X)dV.
Then the estimate
*
In V - H + In2
p <
In V - In V*
'
where
p'= hP(X)dV,
holds true,
Proof of Lemma 16.8. The entropy H will be a maximum if P(Y') = p' and
in the case of a uniform distribution on y' and YjY*-that is, when
{
p*
p(x) =
~ _ p')
V - V"
if x E Y*,
if x E YjY',

16.5 THEOREM ON EXISTENCE OF FUNCTIONS CLOSE TO CORRIDOR BOUNDARIES
653
Therefore
*
(1
*)
H < _po In L - (1 - pO) In
- p
V*
V - V*
-p*Inp* - (1 - pO) In(l - pO) + p*In V* + (1 - pO) In(V - V*)
~ In2+ In V - p*(ln V -In V*).
Hence
*
In V - H + In2
p <
.
-
In V -In V*
Lemma 16.8a. Let for some point x and some number b the inequality
C~x < C~
holds true. We define the set
{
e
e}
Bk(x,b) =
a; a E A k and b- 2::; F(x,a)::; b+ 2 '
where Ak is the subclass constructed by the kth step of the process A. Then
P{Bk(x, b) i= 0} -----.0
k-'c<J
(the probability is taken over the set of realizations of the process A).
In other words, the probability that the system of inequality
e
IF(x, a) - bl < 2'
.
e
IF(xj, a) - y'l < 2'
i = 1, ...,k,
(16.32)
for a E A will remain simultaneous tends to zero in the course of the process
A.
Proof We set t < k, and we fix the sample Xl, ''', Xt, Xt+l, ..., Xk and the
sequence yl, ...,l obtained in the course of the process A. We consider,
as in Lemma 16.7, the density I-tl on the sequence yt+l , ..., yk in
k
Rt = II DAHl
k
X,
'
;=t+l
generated by the process A on steps t + 1, "', k.
We further denote by
Y;~(b, Xt+l, ... , Xk) the subset
R~ consisting of
sequences yI+!, ...,yk such that the system (16.32) is simultaneous for a E A.
Then
P{B,(x, b) of 0) ~ E {L,~, [l;,~ JL'dV] dP.,., ",,', },
where averaging E is taken over the process as far as the tth step.
(16.33)

654
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
We denote by V the volume of the set
R~, and we denote by V' the
volume Y~\(b, X1+l, ... , tk). Then
and, owing to the condition of Lemma 16.8a, we obtain
Therefore, on setting
c
= C:- C:~(b) >0
1
2
,
we get
We now estimate
(16.34)
recalling that, with t specified in advance, V and V' depend solely on
XI+), ... , Xk:
We denote by I, and h the terms on the right-hand side. Then
Also, by virtue of Lemma 16.8 and on replacing Y = R1 and Y' = Y;\,
p(x) = /-L I, we obtain
I) < r
(ljk)(ln V - H + In2) dP
J(I/k)(lnV -lnV'kel
(l/k)(ln V -In V.)
x
< l,d....x. (ljk)(In Vc~ H + In2) dPx .

16.5 THEOREM ON EXISTENCE OF FUNCTIONS CLOSE TO CORRIDOR BOUNDARIES
655
Here H is the entropy of the distribution fJ.\ on the sequence yt+\, ...,l. with
Xr+\, ... , Xk specified in advance.
Note that H ~ In V, so the extension of the integral to the entire space
Xr+\, "', Xk is quite legitimate. Furthermore, since
lim lz = 0
k-.oo
by virtue of (16.34) and since
by definition, in view of Corollary 4 of Theorem 16.3 we obtain
Therefore, for fixed t and Ar we have
On inserting the above result in (16.33) and noting that the function under
the integral is bounded, we obtain
where E is taken over the realizations of the process A. This estimate is valid
for any t 2: 1 and in view of Corollary 4 of Theorem 16.3:
Therefore
lim P{Bk(x, b) =1= 0} = O.
k-HXJ
Corollary 1. Suppose that for some x E X and some number b, the inequality
hold true for all y 2: b. Then for
ih(x, b) = {a:
a E A and F(x, a) > b - i}

656
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
the following relation holds true:
lim p{ih(x,b) 1= 0} = O.
k~oo
Proof By taking a decreasing finite sequence of numbers b l , "', bs such that
b l = 1 + B,
bs = b,
we get
s
ih(x, b) = UBk(x,hd,
;=1
where Bk(x, b) is defined in the conditions of Lemma 16.8 and all numbers
b; satisfy the conditions of Lemma 16.8. Therefore
s
p{ih(x,b) 1= 0} ~ LP{Bk(x,b;) 1= 0} ~ O.
k~~
;
We have thus proved Corollary 1.
Corollary 2. If, for some x, a number b, and the step ko of the process A,
for all y > 0, then for
it is true that
where the probability is determined over all extension of the process beyond
step ko.
Lemma 16.9. Let 0/1 (x) and %(x) be defined, according to (16.31). Consider
cbt(x) = sup F(x, a),
aEAk
cbt(x) =
inf F(x,a).
aEAk
Then for any x and almost any realization of the process A we obtain

16.5 THEOREM ON EXISTENCE OF FUNCTIONS CLOSE TO CORRIDOR BOUNDARIES
657
with
Proof We will prove Lemma 16.9 for cf>l(X) and "'I (x). The case cf>o(x) and
l/Jo(x) can be proved in a similar way. We denote
Then, by definition,
Corollary 2 of Lemma 16.8 may be stated thus:
If, for some x, b, and k, the condition
is satisfied, then
P { cf>t(x) > b - i} k~ o.
On the other hand,
because if Y E D~,~, then there exists a E Ak such that
8
F(x, a) > y - 2'
Therefore we get
cf>t (x) ~ "'(x).
k-+oo
Furthermore, since cf>t(x) is a monotone decreasing sequence bounded from
below, it follows that the convergence almost surely stems from convergence
in probability.
Corollary 1. For almost any realization of the process A, it is true that
almost everywhere in X, as k tends to infinity.

658
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
Corollary 2. For almost any realization of the process A, the functions rf>; (x)
and rf>t (x) converge in the mean with respect to X towards «/fo(x) and 1/11 (x),
respectively; that is,
lim /
1rf>t (x) -
1/10(x)/ dPx = 0,
k -->::>0
}~~, /
Irf>t(x) -1/I1(x)1 dPx = O.
Proof This result stems immediately from Corollary 1 in view of the fact
that integrands are bounded.
Continued Proof of Theorem 16.4. To complete the proof, it remains to com-
bine the results of Corollary 4 of Theorem 16.3 and Corollaries 1 and 2 of
Lemma 16.9.
Indeed, the conclusion of those corollaries holds true for any realization
of the process A simultaneously. By choosing one such realization, we get
the following:
1.
1/11 (x) ~ «/fo(x),
/
[1/11 (x) ~ I/Io(x)] dPx = /
IK2~ el dPx = / K2 dPx - e,
because K~ ~ e.
But (see Corollary 4 of Theorem 16.3)
In /
K~ dPx ~ /
InK~ dPx =
C~\.
Hence,
/
/1/11 (x) -l/Io(x)1 dPx ~ exp {C~\} - e = e(e ll - 1).
Requirement 1 is thus satisfied.
2. By virtue of Corollary 2 of Lemma 16.9, one can, proceeding from the
specified 5 > 0, choose k such that
/ Irf>t (x) -
1/11 (x)I dPx < 5,
/
Irf>(~(x) - «/fo(x) 1 dPx < 5
with rf>i((x) ~ 1/11 (x) and
rf>(~(x) S; «/fo(x). By using Ak as A* we satisfy
requirements 2 and 3.

16.5 THEOREM ON EXISTENCE OF FUNCTIONS CLOSE TO CORRIDOR BOUNDARIES
659
3. By Corollary 2 of Lemma 16.9, for almost any sequence xj, ... ,x(, one
can find for the specified 5) > 0 the value k) > k such that
IcI»k1(Xi) -l/J](Xi)1 < 5],
IcI>;' (Xi) -
~(Xi)1 < 5)
simultaneously for all i's (1 ::; i ::; f).
Now let
Wj, ... ,Wf
be any sequence of O's and 1'so We set
(16.35)
if Wi = 1,
if Wi = O.
Then Yi E b~, where b~ is the closure of D~. By Corollary 4 of Theorem
16.3, one can find
such that
IF(Xi, a*) - /1 < ~ + 5]
for all i's (1 ::; i ::; f).
Furthermore, let Wi = 0 for, say, some i. Then
and
that is,
IF(Xi, a*) -
l/Jw,(xd/ < 5).
The case Wi = 1 is proved similarly. Requirement 4 is satisfied.
We have thus proved Theorem 16.4.
(16.36)

660
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
16.6
THE NECESSARY CONDITIONS
Theorem 16.5. For one-sided uniform convergence to take place it is necessary
that, for any e > 0, there should exist a finite e net in the metric L j (P) of the
set offunctiuns F(x, a), a E A. (That is a finite collection al •... , aN such that
for any a* E A one can find ak for which the inequality
(16.37)
is satisfied.)
For (nontrivial) consistency of the maximum likelihood method, an analo-
gous theorem is valid.
Theorem 16.5a. Let p(x, a), a E A be a set of densities, satisfying the con-
dition
Ilnp(x, a)1 ~ B,
a E A.
For the maximum likelihood method to be consistent it is necessary that for
any e, there should exist a finite collection aI, ... , aN, such that for any a* E A
the following inequality
/
Ilnp(x, a*) - Inp(x, adldPx ~ e
is satisfied for at least one k (1 ~ k S; N).
Lemma 16.10. For the class offunctions F(x, a), a E A, let one-sided uniform
convergence take place, that is,
sup (EF(X, a) - ~t
F(xj, a)) ~ 0,
aEA
~
j=1
i-.")(J
(16.38)
and let there exist a bounded function t/Jo(x) such that for any 81 > 0 and for
almost any sequence XI, ... , Xi there is a* E A such that for all i's (1 ~ i ~ e)
the inequalities hold
Then
IF(Xi, a*) - tf1(Xi)I < 81,
inf EF(x, a) ~ Et/Jo(x).
aEA
(16.39)

16.6 THE NECESSARY CONDITIONS
661
Proof We choose 81 > O. Let XI, ... , Xl be a sample. We set out to find a'
satisfying (16.39). Then
(
1 t)
1 (
sup
EF(x, a) - £L F(x;, a)
2 EF(x, a') - £L F(x;, a')
aEA
;=1
;=1
~ (EF(x, u') - E¢I>(x)) + ( E"",(x) - ~ ~ ¢I>(Xj ))
1
f
+£ L (t/Jo(xd - F(Xi, a·))
;=1
By passing to the limit in probability, we get by (16.38) and by the law of
large numbers for l/Jo(x)
02 inf EF(x, a) - El/Jo(x) - 81,
aEA
that is,
inf EF(x, a) ~ El/Jo(x) + 81.
aEA
In view of the arbitrary choice of 81, we have thus obtained the statement of
Lemma 16.10.
For the maximum likelihood case the analogous lemma is valid.
Lemma 16.10a. Let the maximum likelihood method be (nontrivial) consistent
for a class of uniformly bounded densities p(x, a), a E A, uniformly separable
from zero; that is, for any ao we have
l
.
1 '""
PaO
IOf Ii LJ -lnp(x;, a) ---> E ao (-lnp(x, ao))·
aEA {.
l---'too
;=1
(16.38a)
Suppose also that there is a bounded function l/Jo(x) such that for any 81 > 0
and for almost any sequence XI, "', Xl (in the sense of the basic measure) there
exists a' E A such that for all i's (1 ~ i ~ f) we have
Then
Ilnp(xi, a*) + l/Jo(x;)I ~ 81.
(16.39a)

662
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
Proof We choose 81 > O. Let Xl, ... , Xf be the sample and let a* E A satisfy
(l6.39a). Then
1
f
Eao (-lnp(x, ao)) - inf -e L(-Inp(x;, a))
aE.\
;=1
1
f
2 Ea1,(-lnp(x,ao)) - £ L(-lnp(x;,a*))
;=1
= Eao(-lnp(x,ao)) - Eaotfil)(x)
(
If
)
1
f
+
Eaot/Jo(x) - f ~ tfil)(x;)
+ £ t1(I/JO(X;) + lnp(x{, a*))
:> (E."(- Inp(x, an)) - E."ofro(x») + ( E."ofro(x) - ~t ofro(XI») + 0\
By passing to the limit in probability and noting that (16.39a) is satisfiable
for almost any sequence in the sense of the measure Pao, we obtain
In view of the arbitrary choice of 81, we have thus obtained the statement of
Lemma 16.lOa.
Auxiliary Statement. Let F(x, a), a E A, be a class of functions, let
c/Jo(x) = inf F(x, a)
aE,\
be a measurable function, and let there exist a function tfil)(x) such that:
(a)
(b)
(c)
c/>o(x) ::; tfil)(x),
j (t/Jo(x) -
Cpo(x)) dPx < 8,
inf jF(X,a)dPx < jt/Jo(X)dPx.
aE.\
Then for any a the inequalities
(1)
(2)
are valid.
jIF(X, a) - cPI)(x)IdPx ::; EF(x, a) + Etfil)(x) + 28,
inf jIF(X, a) dPx -
t/Jo(x)IdPx ~ 2il
aE,\

16.6 THE NECESSARY CONDITIONS
663
Proof Let a EA. We denote
I = {x: F(x, a) < l/Jo(x)}.
Then
/
IF(x, a) - rpo(x)IdPx
= / (F(x, a) - l/Jo(x)) dPx + 2!(r/Jo(x) - F(x, a)) dPx
~ / (F(x, a) -l/Jo(x)) dPx + 2 /(r/I()(x) - (Po(x)) dPx
~ / (F(x, a) - l/Jo(x)) dPx + 25.
By applying the operator inf to both sizes of the inequality, we get
inf /
IF(x, a) - %(x)1 dPx ~ inf EF(x, a) - Er/I()(x) + 25.
aEA
aEA
Recalling point (c) above, we thus obtain the desired statement.
Proof of Theorem 16.5. Assume the reverse; that is, suppose that one-sided
uniform convergence occurs, but there exists 80 > 0 for which there is no
finite 80 net in L 1(P).
Step 1. Decompose the class A into finite number of subclasses AI, ''', AN
such that for each of them the condition
sup EF(x, a) -
inf EF(x, a) <
8,30
aEA,
aEA,
(16.40)
is satisfied. Obviously, this can be always done. Moreover, for at least one
of those subclasses there will exist no network in L 1(P). We denote it as
A'.
Step 2. In any set having no finite 80 net, it is possible to choose an infi-
nite (countable) 80-discrete subset-that is, such that for any two of its
elements, x and y, we obtain
p(x, y) 2 80·
We choose this 80-discrete subset in A' for the metric L1(P) and denote
it as A". Obviously, this A" will also have no finite 80 net.
Step 3. It is shown in Chapter 15 that the existence of a finite eo net in L 1(P)
for any given 80 is a necessary condition for means to converge uniformly

664
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
to their expected values. Hence from Corollary 2 of Theorem 16.3 we
conclude that for any A** there exist positive numbers £ and TI such that
c~ > In £ + TI.
Step 4. By Theorem 16.4, there exists a function r/Jo(x) such that for 8 = £0/2
one can find a subclass A:* c A** for which
(a)
C~\:' = C~.. > In £ + TI,
(b) r/Jo(x) ~ infaEA:, F(x, a) = <f>o(x),
(c) J(r/Jo(x) - ¢o(x)) dPx :::; 8,
(d) For any 81 > 0 and for almost any sample XI, ''',Xi there exists a* E
A:* such that
IF(xr , a*) - r/Jo(xi)1 < {)I.
Note that A' inhibits the eo-discrete properties in L I (P), the condition
(16.40), and one-sided uniform convergence.
Step 5. On applying Lemma 16.10 to the class A:* (by virtue of Property 2),
we obtain
inf EF(x, a) :S EIPO(X),
aEA:'
Step 6. On applying the auxiliary statement (by virtue of (b) and (c) and Step
5), we obtain the following:
1. For any a E A:*
EIF(x, a) - l/Jo(x)I < E(F(x, a) - l/Jo(x)) + 28.
2.
inf EIF(x, a) - r/Jo(x)1 :::; 28.
aEA:·
Step 7. From statement 1 above we have
inf IEF(x, a) - Er/Jo(x)I :::; 28.
£lEA:·
Hence from (16.40) for any a E A:* we obtain
£0
IEF(x, a)l- IEr/Jo(x)1 < 3 + 28.
Inserting the () = £0/4, we obtain
2£0
EIF(x, a) -l/Jo(x)1 :::; T'

16.6 THE NECESSARY CONDITIONS
665
Since the class A:* is eo-discrete, we find that it consists of just one element.
But this contradicts property (a) of Step 4 because for a one-element A it
is always the case that
c~ = Inc.
This completes the proof of Theorem 16.5.
Proof of the Theorem 16.5a. This proof runs along approximately the same
lines as that of Theorem 16.5. Let us trace it step by step. We denote F(x, a) =
-Inp(x, a).
Step 1. Not mandatory. We assume A* = A.
Step 2. Same as for Theorem 16.5.
Step 3. Same as for Theorem 16.5.
Step 4. Same as for Theorem 16.5 except that b = eoa/8A, where
a = infp(x, a),
0, x
A = supp(x,a),
a, x
a> 0,
A < 00.
(16.41)
Step 5. By applying Lemma 16.10a to subclass A:* and recalling that the strict
consistency of the maXImum likelihood method is inherited for any sub-
class, we obtain for any aD E A;*
Step 6. In view of property (c), Step 4, and (16.41), we have for a E A:*
/ (t/Jo(x) - cPo(x))p(x, an) dPx ::; A / (lf1o(x) - cPo(x)) dPx < Ab,
where
cPo(x) = inf F(x, a).
aEA:·
By applying the auxiliary statement for the measure Parp we get
and, by virtue of Step 5,
/
IF(x, an) - t/Jo(x)lp(x, an) dPx ::; 4Ab.

666
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
In consequence and on the strength of (16.41) we obtain
/
4A5
e
IF(x, ao) - l/Jo(X)IdPx ~ -a- = 4'
This inequality holds true for any lX() E A:*
In view of the triangle inequality and eo-discreteness, it turns out that
the class A:* consists of just one element, which contradicts property (a) of
Step 4.
This completes the proof of Theorem 16.5a.
16.7
THE NECESSARY AND SUFFICIENT CONDITIONS
Theorem 16.6. Let the conditions of measurability be satisfied for functions
F(x, a), a E A. For one-sided uniform convergence to take place
P {sup (EF(X, a) - ~t
F(x;, a)) > eo} -+ 0,
aEA
(
.
f-+~
1=1
it is necessary and sufficient that. for any positive numbers €, 11, and 5, there
should exist a set of uniformly bounded measurable functions <P(x, a), a E A,
such that
F(x, a) ~ <P(x, a),
E(F(x, a) - <P(x, a)) < 5,
and for set ct>(x, a), a E A, the inequality
(16.42)
(16.43)
is valid. where entropy H~(f.) is computed for the class <P(x, a), a EA.
Theorem 16.6a. Let the class of densities p(x, a), a E A, specifying the mea-
sure Pa with respect to the basis probability measure p.t be such that the condi-
tions of measurability are satisfied, and the densities themselves are uniformly
bounded and uniformly separated from zero:
°< a ~ p(x, a) ~ A < 00.
Then, in order that the maximum likelihood method be nontrivial consistent
for the class p(x, a), a E A, that is, for any an E A
f
.
1 ""'(
Pao
mf n L... -Inp(x;, a)) ---+ Eall ( - Inp(x, lX())),
aEA {
1-+00
;=1

16.7 THE NECESSARY AND SUFFICIENT CONDITIONS
667
it is necessary and sufficient that, for any positive numbers E, TI, and 8, there
should exist a set of uniformly bounded functions <t>(x, a), a E A, such that
for any a E A
-Inp(x, a) ~ <t>(x, a),
Eao (-Inp(x, a) - <t>(x, a)) < 8
and for the set of functions <t>(x, a), a E A the inequality
HA(f)
C' = lim
F.
< In e +
£
P-+rXJ
f
TI
is valid, where H:(n is computed for the class <t>(x, a), a EA.
(16.42a)
(16.43a)
Proof of Sufficiency for Theorem 16.6. We assume the number eo and eval-
uate the quantity
We set out to show that
lim Tp = O.
£-+00
We choose the positive numbers
eo
e = 18'
(16.44)
On their basis we find the class of functions <t>(x, a), a E A, satisfying the
conditions (16.42) and (16.43). For any a E A we have
1
p
EF(x, a) - £L F(xi, a)
;=1
1
p
~ E<t>(x, a) + E(F(x, a) - <t>(x, a)) - £L <t>(x;, a)
;=1
1
f
< E<t>(x, a) ~ f L <t>(x;, a) + 8.
i== 1

668
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
Hence, subject to (16.44) we obtain
T, ,; 10 bv,'IE<I>(X, a)
~t <I>(x" a)I~ (ell + 8)} dP,
< P {sup EcI>(xj, a) - ~t
cI>(Xj, a) > ~}.
oEA
j=l
It was shown in Lemma 15.5 (see Chapter 15, Section 15.6) that for sufficiently
large f's and for e > 0 we have
{
If
12£
}
B f
== P
~~\ E~ cI>(Xj, a) - Ef~1 cI>(Xj, a) > e
1
{
1
f
}
>"2P
~~\ EcI>(xr , a) - E~ cI>(Xi, a) > 3e
.
In turn, as shown in Section 15.6, Eq. 15.39, for any c > 0 the following
inequality holds true:
B
P {
lnNA(eI3;XI, ...,Xf)
}
60
[e2(£ + 1)
0]
f
::;
£
> c
+
~ exp -
9
+ c~
.
By also setting e = eo/6 and c = "'1, we obtain for sufficiently large e's
{ I
A (eo.
)}
[ (l:J
)]
Tf::;P elnN
18,xl"",xf
>"'1
+6t'exp
-
360-"'1
It'·
(16.45)
Now it follows from (16.3) that
Finally, we obtain from (16.2), (16.43), (16.44), and (16.45)
The sufficiency has thus been proved.
Proof of Sufficiency for Theorem 16.6a. The consistency of the maximum
likelihood method for a class of densities p(x, a), a E A, follows from the
one-sided uniform convergence for the class of functions - In p(x, a) in any

16.7 THE NECESSARY AND SUFFICIENT CONDITIONS
669
specified measure P00' an E A. To demonstrate, we set an E A. Then, by the
law of large numbers we have
e
1 ""'
Pao
-e L.J -lnp(x, an) ---+ Eon -lnp(x, an).
1-+00
i=1
Therefore it will suffice to establish that for any e > 0 we obtain
1
f
P{Eoo(-lnp(x, an)) - inf -e L(-lnp(xi,a) > e} ~O.
oEA
1-+00
i=1
But for any 0' E A we have
Eoo lnp(x, 0') ::; EO() lnp(x, 0'0)'
Therefore the statement of Theorem 16.6a follows from the condition
for any e > 0, that is, from condition for one-side uniform convergence.
From Corollary 1 of Theorem 16.3 it follows, however, that if the condi-
tions of Theorem 16.6a hold for the measure Px, then they will hold for any
measure Po as well. By applying Theorem 16.6 (sufficiency) we obtain the
sought-after result.
Proof of Necessity. For purposes of proof, we will need one more lemma.
Lemma 16.11. Let F(x, 0'), 0' E A, be measurabLe in x and uniformLy bounded
functions defined on X. Furthermore, Let B C X and
(a) for any 8> 0, k > 0 and for almost any sample XI, ...,Xk (Xi E B), let
there exist 0'* E A such that
IF(Xi' a*) -
~(xi)1 < 8,
and
(b) for some 80 > 0 let
P {sup (EF(X, a) - -e
1t F(x;, 0')) > 8o} ~. O.
oEA
.
1-+00
1=1
Then
f ~(x)dPx ~ inf f F(x, a)dPx - 8.
lB
oEA lB
(16.46)

670
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
Proof Note that with P(B) = 0 the lemma is trivial.
Suppose that P (B) ::::: 0 and suppose that conclusion of the lemma is in-
correct. Then there should exist a number 80 > 0 such that
r t/Jo(x) dPx < inf r F(x, a) dPx + (80 - 0).
18
aE.\ 18
To begin with, we consider the case P (B) = 1. We denote
5, = J. 9 h~p,(EF(x, a) - }t. F(Xi, a)) - a-} dPx
Condition (b) implies that
lim Sf = O.
f-H:)CJ
(16.47)
We fix the sample Xl, ,."
Xf and. in view of condition (a). we choose a* such
that
IF(x;, a*) -
~)(x)1 < ~.
This leaves us with a string of inequalities that hold true for almost any
sample:
</> "" ~~p,(EF(x, a) - }t, F(x" a)) - a-
f
> EF(x, a*) -
~ LF(x;, a*) - 80
;=1
f
> EF(x,a*)- ~ Lt/Jo(x;)- (00- ~O)
;=1
f
.
1 "
(81))
:::::
~~~ EF(x, a) - "i L- t/Jo(x;) -
00 + 2" .
;=1
By applying (16.47) and noting that P(B) = 1, we obtain
e
¢::::: fs!J1<)(X)dPr+(0+80)-~Et/Jo(X;)-(0+~»)
J. o/kl(x) dP, -
}t o/kl(Xi) + ~.
Going back to estimate Se, we get
5, ~ P { Eo/It,(x) - }t. o/kl(Xi) > - ~ } .

16.7 THE NECESSARY AND SUFFICIENT CONDITIONS
671
By the law of large numbers, however, the right-hand side of the inequality
tends to one, and this contradicts condition (b).
We now pass to the case 0 < P(B) < 1. It is an easy matter to see that
for an arbitrary symmetric function g(x], ..., Xf), where XI, ... , Xf is the sample
collected in a series of independent trials with a distribution Px and for an
arbitrary set B c X, the following identity holds:
/
g(x[, ..., Xf) dPxl .....X ,
f
=L C; f
[1
g(X], ... ,Xf)dPx.+\ .....xl] dPr\ ....xk·
k=O
}X\ .....Xk EB
Xh\ , ....xd· B
We now introduce on X the densities
if X E B,
if X ri- B,
if x E B,
if x ri- B,
and denote the measures p(I) and p(2) defined by the conditions
dp(2) = 7T2dP.,.
Then
fL C;pk(B)(1 - p(B»'-k
k=O
x1 [f
g(XI, ..., Xf) dP~:!l ..".XI] dP~ll.) ... x•.
Xl'·",Xk
}x/'a)I""Xf
(16.48)
We denote now
Sf ~ P {~~~ ( EF(x,a) -} P'F(X;, a») > lin}
f 0 br.(EF(x, a) - }t F(x;, a)) -lio] dP.
(1649)
By condition (b),
lim Sf = O.
f -'CXJ
We will let this requirement contradict the assumption (16.47).

672
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
We denote the function under the integral sign as g(X1, ..., Xl) and use
relation (16.48). We set
sup F(x, a) = Ao.
a.x
We fix P, k, and a part of the sample Xl, ... ,xk, assuming that the following
conditions are satisfied:
I
k
I
80
1 - PP (B) < 8Ao'
I
P-k
I
Bo
1 - P(1 - PCB)) < 8Ao'
1
1
k
I
80
- PP(B)
< 8(80 + Do)'
and also Xi E B (1::; i::; k):
1
k
8()
E1t/Jo(x) - kL t/Jo(Xi) < 8'
i=l
where
I
(I)
1
(
E1t/Jo(x) =
t/Jo(x)dPx
= PCB) 18 1/Jo(x)dPx .
Using condition (a), we choose a* so as to satisfy the condition
\t/Jo(.ti) - F(Xi, a*)1 < ~.
Now we have
</> := ~~~ (EP(X,a) - ~ ~P(x;,a))
f
> EF(x, a*) -
~ L F(x;, a*).
;=1
We denote
EBF(x, a) = Is F(x, a) dPx ,
Ef3F(x,a) = Is F(x,a)dPx ,
(16.50)
(16.51)
(16.52)

16.7 THE NECESSARY AND SUFFICIENT CONDITIONS
673
such that
EF(x, a) = EBF(x, a) + EiJF(x, a),
EiJF(x, a) ~ Ao·
Furthermore, the following identities hold:
1
i
EF(x, a*) - eL F(x;, a*)
;=1
EBF(x, a') + EiJF(x, a') - } [t, F(x" a') +,tl F(x;, a')]
= ~ [E1F(X,a') - ~ t,F(Xi,a')]
+ £ ~ k [E,F(X, a') - £ ~ k;tl F(x;, a')]
+ EBF(x, a*) (1- £P~B)) + EiJF(x, a*) (1- £(1 ~-P~B)))'
(16.53)
where
-J
(I) -
EBF(x, a)
E[F(x,a) -
F(x,a)dPx
-
PCB)
,
_I
(2) -
EiJF(x, a)
E2F(x,a) -
F(x,a)dPx
-
1-P(B)'
By denoting as T the quantity
1
k
T = E[F(x, a*) - kL F(x" a)
'=1
we have, by virtue of (16.51) and (16.52),
k
T ~ E[F(x, a*) - ~ L !/Jo(x;) - ~
;=1
2 (EIF(x, a') - Ep/-l)(x)) + (El oJ.b(x) - ~t, ¢I'(X;)) - ~
~ E1F(x, a*) - E1!/Jo(x) _
~o
=
p(1B)J(F(x, a*) - !/Jo(x))dPx _
~o.

674
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
Now it follows from (16.47) that
T ~ p(lB) ["l F(x,a*)dPx-"l l/Jo(X)dPt ]
-
~)
> P/B) [l~~.l F(x,a)dPx - .ll/Jo(X)dPx] -
~o
1
80
> PCB) (00 + 80) - 4'
And further from (16.50) we have
k
k
80
iT;:: RP(B) (00 + 80) - 4
(00+ 80)- (1- ep~B))(00+80)- ~
5
2
0<1 + S8(),
Going back to the estimate 4>, we obtain from (16.53)
'"
2> &, + ~eo + l ~ k [E,F(X, a') - l I kit, F(Xi, a')]
+EBF(x, a*) (1 - RP~B)) + EiJF(x, a*) ( 1 - t(1 ~~~B))) .
By applying (16.50), we obtain
f
4> ;:: ~80 + 0<) -
E2F(x, a*) - £ ~ k L F(x l , a*)
i=k+\
Thus, for £, k, and Xl, ".,xk satisfying conditions (16.50) and (16.51) we
have
g(X" ..., XI) ~ 0['" - &,1 2> 0 (~ell- E,F(x, a') - l ~ kit, F(x" a') )
and
/
g(x(, ..., Xf) dP~~~I.".'Xf
2> P { E,F(x, a') - l ~ kit, F(Xi, a') '" ~ell}.

16.7 THE NECESSARY AND SUFFICIENT CONDITIONS
675
By the law of large numbers for uniformly bounded functions the last expres-
sion tends to unity as (f ~ k) tends to infinity with an estimate which solely
depends on f - k. That is, there exists an estimate
such that
lim
Pl(f - k) = l.
(f-k)---;~
Thus, in conditions (16.50) and (16.51) we have
R(XI, ...,Xk) =
(
g(XI, ...,Xf)dP;;:I......,f ~ Pl(f -k).
lXk+I,"',x,
Going back to the estimate Sf (see (16.49)) and using (16.48), we get
f
Sf = f; C;p k(B)(l - P (B) )f-k 11,.... Xi R(XI' ,,,Xk) dP;;?.,x"
~ L:+ C;pk(B)(l - p(B))f-kp(f - k) Ix dPx}o-.x",
where L:+ is taken only over k's satisfying (16.50), and X is the set of
sequences XI, ""Xk satisfying (16.51). From (16.51) we have
By the law of large numbers, the last expression for a bounded quantity tends
to unity as k increases, with an estimate depending solely on k, that is,
lim P2(k) = 1.
k-'>x
By extending the estimate Sf, we obtain
Note that with f tending to infinity, all k's and (f - k)'s satisfying (16.50)
uniformly tend to infinity. Hence

676
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
By the law of large numbers for the binomial distribution we obtain
lim Sp = 1,
p-..:)()
in contradiction to condition (b). The lemma has thus been proved.
Continued Proof of Theorem 15.6 (Necessity). We propose the following
method for constructing the class of functions <I>(x , a), a EA. Let the positive
numbers e, S, and Tf be specified. We set
(16.54)
By Theorem 16.5, the class F(x, a), a E A, can be decomposed into a finite
number of subclasses Aj so that the diameter of each in L 1(P) is smaller than
Do, that is,
sup
/
IF(x, al) - F(x, (2)1 dPx < So·
al,a2EA,
(16.55)
In each subclass, we select one function F(x, aj), aj E Aj. To each function
F (x , a), a E Aj , there corresponds a new function
<I>(x, a) = min(F(x, a), F(x, aj)).
The class of all functions <I>(x , a), a E A, is the one sought.
Indeed conditions (16.42) stem immediately from (16.54) and (16.55) and
from the definition of <I>(x ,a). Only (16.43) remains to be checked.
Suppose that (16.43) is not satisfied; that is, for the class <I>(x, a), a E A,
we have
C: :;: Ine + Tf.
Then for at least one subclass <I>(x, a), a E Ai, we obtain
C:' :;: In e + Tf.
We fix Aj and let the assumption contradict (16.53). By Theorem 16.4, there
exist such functions 1/11 (x) and l/Jo(x) that
(a)
ljJl (x) :;: l/Jo(x);
(b) J 11/11 (x) - 1/1()(x)IdPx :;: exp C~l - e :;: (eT/ -1)e :;: TJe;
(c) F(x,aj) = maxaEA, <I>(x,a) :;: 1/11 (x);
(d) for almost any sequence Xl, ''', Xp and for any number (]" > 0, one can
find a· EA· such that
j=1, ...,e.

16.7 THE NECESSARY AND SUFFICIENT CONDITIONS
677
In view of (b) and (c), we have
/ (F(x, ai) - l/Jo(X)) dPx > /
IIjJJ(x) -l/Jo(x)1 dPx > 871·
We denote by B C X the set
{x:
l/Jo(x) < F(x, aj) - l>}.
(16.56)
Then for almost any sequence XI, ... , x, E B and for any number (J" > 0 there
will be a* E A such that
j=1, ...,£.
(16.57)
For this to happen, it suffices to choose a positive
and, by taking advantage of (d), to find a* satisfying
j=1, ... ,£.
Furthermore, since all Xj E B we have
Therefore taking into account the definition of <!lex, a*) we conclude that
Now we will apply Lemma 16.11 to the subset Aj (condition (a) of Lemma
16.11 has just been shown, and condition (b) follows from one-sided uniform
convergence). By virtue of its conclusion we obtain
r l/Jo(x)dPx 2: inf r F(x,a)dPx -
l>.
18
aEA,18
From (16.56) we have
871 < /(F(X,aj)-l/Jo(X))dPx
= fa (F(x, a,) -l/Jo(x)) dPx + fa (F(x, aj) -l/Jo(x)) dPx.
On the set i3 it is true that
F(x, a;) - l/Jo(x) < Do.
(16.58)

678
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
Therefore it follows from (16.58) that
817 < 50 +hF(x, ai) dPx-l !J!o(x) dPx
S; 2<50 +/F(X,aj )dPx -
inf /F(X,a)dPr
aEA,
and from (16.54) we have
817 < 250 +
sup
IF(X, a\) - F(x, (2)! < 3<50,
al,a/EA,
in contradiction to (16.53).
Thus Theorem 16.6 has been proved.
Proof of Necessity for Theorem 16.6u. By conditiuns of Theorem 16.6a, fur
any ao E A we have
where
For the specified positive 8, 5, and 17, we set
.
(
817U
50 < mm
2(A + 1)'
(16.59)
(16.60)
By (16.59), the set A can be decomposed into a finite number of subclasses
Aj such that
In each subclass we select aj E Aj and put
<I>(x, a) = min( ~ Inp(x, a), - Inp(x, a;),
a E A"
Conditions (16.42a) follow immediately from the definition. Suppose that
(16.43a) is not satisfied, that is, for at least one subclass <I>(x , a), a E Aj , one
has

16.7 THE NECESSARY AND SUFFICIENT CONDITIONS
679
On denoting
F(x, a) = -lnp(x, a)
we can, as in the proof of Theorem 16.6, choose functions ljJ\ (x) and l/Jo (x)
satisfying conditions (a), (b), (c), and (d) and (16.56). The property (16.57)
will likewise be satisfied; furthermore, on fixing a E Ai, it may be taken that
it is satisfied for almost any sequence in the sense of Pa'
In order to be able to apply Lemma 16.11, however, we now have to resort
to the nontrivial consistency of the maximum likelihood method, instead
of one-sided uniform convergence. Let us apply this condition to the case
ao = ai:
Therefore
(16.61)
In view of (16.59) and of the choice of Ai, we have
sup Ea,IF(x,a) -F(x,ai)1 < Aoo.
aE.\,
Hence
sup IEa,F(x,a) - Ea,F(x,adl < Aoo.
aEA,
By combining the above inequality with (16.51), we obtain
We now apply Lemma 16.11 to the class <I>(x, a) for the measure Pa,. For
any measurable B c X we get
!
l/JO(X) dPa, ~ inf
( F(x, a) dPa, - (A + 1)00.
aEA,18
From (16.56) and (16.59) we have
8TJ < !(F(x,ad -ljJ{)(x))dPx ~ ~ !(F(x,ai) -ljJo(x))dPa,.
(16.62)

680
16 CONDITIONS FOR UNIFORM ONE-SIDED CONVERGENCE
As before, we denote
B = {x: ifio(x) < F(x, a;) - 8o}.
From (16.62) we obtain
cTJ < ~ [L(F(X,a;)-ifio(x))dPal + h(F(X,ad-ifio(X))dPal]
< ! [80 + 8o(A + 1) + r F(x, ad; dPa, -
inf r F(x, ad dPa,] .
II
JB
aE,\, JB
And, finally,
in contradiction to (16.60).
This completes the proof of Theorem 16.6a.

COMMENTS AND
BIBllOGRAPHICAl
REMARKS
INTRODUCTION
Two events that
transformed the
world
forever
occurred
during the
twentieth
century:
scientific
progress
and
the
information technology
revolution.
Modern scientific progress began at the turn of this century. It changed our
philosophy and our understanding of general models of the world, shifting
them from purely deterministic to stochastic. Fifty years later the informa-
tion technology revolution began. It had enormous impact on life in general,
opening new opportunities and enabling people to be more creative in solving
everyday tasks.
In discussing scientific progress, one usually considers physics as the pri-
mary example of changing the general model of the world in a relatively
short time: from Newton's macro-models of relatively small velocity to micro-
models of quantum mechanics and physics of high velocities (the theory of
relativity). It is often stressed that at the time these models were introduced
they were not considered as something of practical importance. The history
of physics collected a number of remarks in which creators of new models
were skeptical of practical use for their theories. In 50 years, however, new
theories and new ways of thinking became the basis for a technological rev-
olution. As we will see this underestimation of theoretical models was not
only specific to physics.
Revolutionary changes took place in many branches of science. For us it is
important that new ideas also occurred in understanding the principles of in-
ductive inference and creating statistical methods of inference. The names of
three great scientists who addressed the problem of induction from different
points of view should be mentioned with regard to these new ideas:
681

682
COMMENTS AND BIBLIOGRAPHICAL REMARKS
Karl Popper, who considered the problem of induction from a philosoph-
ical perspective;
Andrei N. Kolmogorov, who considered the problem of induction from a
statistics foundation perspective;
Ronald A. Fisher, who considered the problem of induction from an ap-
plied statistics perspective.
The problem of inductive inference has been known for more than two
thousand years. In the Introduction we discussed the Occam razor principle
dating back to the fourteenth century. The modern analysis of induction, as
a problem of deriving universal assertions from particular observations. was
started, however, in the eighteenth century when D. Hume and especially I.
Kant introduced the problem of demarcation:
What is the distinction between empirical theories (theories that reflect trlith
for our world) and mathematics, logic, and metaphysical systems?
In the 1930s K. Popper proposed his solution to the demarcation problem
based on the concept of falsifiability of theories. He proposed to consider as
a necessary condition for correctness of empirical theories the possibility of
their falsification. The easier it is to falsify a theory, the better the chances that
the theory is true. In his solution of the demarcation problem, K. Popper for
the first time connected the generalization ability with the capacity concept.
His demarcation principle was very general. It was not restricted to some
specific mathematical model in the framework of which one could provide
exact analysis. Nevertheless, it describes one of the main factors contributing
to generalization (the capacity factor) that will later appear as a result of
exact analysis in statistical learning theory.
At approximately the same time as Popper, Glivenko and Cantelli proved
that an empirical distribution function converges to the actual one with
increasing number of observations and Kolmogorov found the asymptoti-
cally exact rate of convergence. These results demonstrated that one could
find an approximation to a distribution function that is dose to the desired
one in the metric C. Of course these results still were far from solving the
main problem of statistics: estimating the unknown probability measure. To
estimate a probability measure we need convergence of estimates to the ac-
tual distribution function in a metric that is stronger than C. Nevertheless,
existence of a fast (exponential) rate of convergence of the empirical distribu-
tion function to the actual one gave a hope that this problem had a solution.
These two results-namely. the discovery of the factors responsible for
generalization and the discovery of the first (asymptotically exact) bound on
the rate of uniform convergence of the frequencies to their probabilities for
the special set of events-were a good start in developing general methods
of statistical inductive inference. It was clear that as soon as a general theory
of estimating the probability measure was developed, it would be possible to
construct general statistical methods of induction useful for practical appli-
cations.

CHAPTER 1
683
However, a particular approach was suggested by R. Fisher approximately
at the same time when K. Popper and A. N. Kolmogorov made the very first
steps toward the general theory of inductive inference.
R. Fisher, who was involved in many applied projects needed statistical in-
ference not in 20 years, but immediately. Moreover, he needed methods based
on simple calculations. Under these restrictions he suggested an excellent so-
lution. He simplified the core problem of statistical inference-estimating
probability measures-by reducing it to the problem of estimating parame-
ters of density function. Then he developed, on the basis of this simplified
core problem, almost all branches of modern statistics such as discriminanl
analysis, regression analysis, and density estimation.
Fisher's simplification of the core problem of statistical inference and his
success in solving simple practical problems had deep consequences. It split
statistical science into two parts: theoretical statistics, the branch of science
that considers general methods of inference, and applied statistics, the branch
of science that considers particular models of inference.
Due to the excellent development of the simplified approach, it became
common opinion that for practical purposes the simplified version of statis-
tical inference is sufficient and theoretical statistics was not considered an
important source for new ideas in inductive inference.
As soon as the information technology revolution provided opportunities
for estimating high-dimensional functions (the 1960s). the "curse of dimen-
sionality" was discovered: that is the difficulties that arise when one considers
multi-dimensional problems. In fact it was discovered that it is impossible to
beat the curse of dimensionality in the framework of Fisher's paradigm. It
should be noted that belief in this paradigm was so strong that for more
than 25 years nobody tried to overcome it.t The curse of dimensionality was
accepted as a law of nature that should be taken into account when solving
problems.
To overcome this curse, one should come back to the theoretical foun-
dation of statistics in order to identify factors responsible for generalization
which in many ways reflected (a) the philosophy discussed in the 1930s by K.
Popper and (b) the analysis of uniform convergence of frequencies to their
probabilities that was started for the particular cases by Glivenko. Canlelli,
and Kolmogorov.
CHAPTER 1
The Beginning
No\\' it is hard to say who made the very first step toward Statistical Learning
Theory which suggested that we consider the problem of minimization of the
risk functional based on empirical data as a general learning problem. For me
t The idea that it is possible to overcome the curse of dimensionality using a neural network was
expressed for the first time in the early 1990s.

684
COMMENTS AND BIBLIOGRAPHICAL REMARKS
this happened in 1963 at machine learning seminars at the Moscow Institute
of Control Sciences.
That year, at one of the seminars Novikoff's theorem on convergence of
the perceptron algorithm was discussed. This theorem had tremendous impact
on the audience.
Nowadays, it is hard to understand why this theorem, whose proof is based
on simple arguments, could make such a big impact. The explanation is prob-
ably the following: The early 1960s were the beginning of the revolution in
information technology. In the following pages, we will see, even focusing on
one specific area, how many new ideas were originated at this time.
In particular, in the beginning of the 1960s, for the first time, people
associated their future with the computer revolution. They tried to under-
stand future technology, its influence on human values, and its impact on the
development of science.
These discussions were started by the famous book entitled Cybernetics
(the new word invented for this new subject), written by a remarkable math-
ematician N. Wiener. Wiener tried to describe his vision of future involve-
ment of mathematical methods in everyday life where, by using computers,
one would be able to solve intelledual tasks. This book was a great success.
After Wiener's book, there appeared a number of publications written by
specialists in different areas who described their visions of future computer
civilizations.
Most of these books, however, saw the source of success in solving intellec-
tual problems in the power of computers rather than in the power of math-
ematical analysis. It created the impression that exact mathematical analysis
of intellectual problems was the old-fashioned way of solving them. Using
computers and simple algorithms that imitate methods used by people (or
animals or nature), one could achieve the highest level of performance sim-
ply due to the power of computers. The problem of imitating is not very
complicated: It is enough to observe carefully the way in which the solution
was obtained by humans and describe it as an algorithm.
The very first experiments with toy problems demonstrated the first success
of this philosophy. In the early 1960s it looked as if the next step would bring
significant results. The next step has never come to be.
Nevertheless, computer hardliners declared the creed, reiterated even in
the late 1990s:
Complex theories do not work, simple algorithms do.
It should be noted that this declaration was not immediately rejected by
scientific communityt: Many positive revolutionary changes occurred in the
1960s, and it was not clear if this declaration was not one of them. The
t It is not easy to reject this philosophy. For example, should one of the last ideas of this type.
the genetic programming still popular in the late 1990s, be rejected?

CHAPTER 1
685
reaction of a large part of the scientific community somehow reflected this
philosophy: The interest shifted to the problem of organizations and construc-
tion of complex systems based on primitive automata. People were ready to
accept the philosophy according to which it is not necessary to understand
what is going on (what are the general principles) but is, instead, enough to
understand how it is going on (how these principles are implemented). There-
fore it became popular to describe complex behavior as a result of primitive
actions of a large number of simple agents and to associate complexity of
behavior with the number of agents. To specify what type of simple agents
to use and in what kind of simple interaction they are involved, one had to
analyze human solutions of the problems.
Therefore the main researchers in cybernetics became biologists, physiol-
ogists, psychologists, philosophers, and, of course, computer scientists.
In 1958, F Rosenblatt, a physiologist, introduced a learning model, called
the Perceptron, reflecting the classical neurophysiological understanding of
the learning mechanism as an interaction of a large number of simple agents
(McCulloch-Pitts model of neuron) with a simple reaction to rewards and
punishment as the learning algorithm. The new idea in the Perceptron was
its implementation on computers demonstrating that it can generalize.
The Perceptron was not only considered a success in solving one special
problem, it was considered a success of an idea of simple organization of a
large number of simple agents. The future improvement of learning machines
was connected with more accurate analysis of properties of simple agents in
the brain and with more accurate analysis of the general rules of their inter-
actions. After the Perceptron there appeared a number of learning models
(for example, called Pandemonium and Cortex) where the analysis centered
mainly on speculations about the relation of these models to the construction
of the brain.
Novikoff's Theorem
Novikoff's theorem gave an alternative approach. According to this theorem,
the Perceptron realizes a simple mathematical idea: It maps input vectors into
another space in which it constructs a separating hyperplane. Future analysis
showed that the generalization ability of Perceptrons can be explained by
simple mathematical constructions. This theorem gave the first answer to the
question, What is going on?
Novikoff's theorem immediately gave rise to the following questions:
1. If it is important to construct a separating hyperplane in feature space
why should this not be done in the most effective way? There are better
mathematical methods for constructing separating hyperplanes.
If there exists one separating hyperplane then there exist many of them.
Why not choose the optimal one? Control theory demonstrated how
much gain can be achieved using optimal solutions.

686
COMMENTS AND BIBLIOGRAPHICAL REMARKS
2. The goal of learning is generalization rather than separating training
data. Why does separating training data lead to generalization? Is sep-
arating the training data the best way to control generalization?
In other words, from Novikoff's theorem arose the questions whose answers
comprise statistical learning theory. The discussion of these questions was
one of the main topics of the machine learning seminars.
In the course of these discussions, somehody removed all unnecessary
details of the learning problem and concentrated on the core problem-
namely, minimizing the risk functional
R(a) =IQ(z, a) dP(z),
based on empirical data
Zl, "', Zr·
aEA
Minimization of Risk from Empirical Data and the Classical
Statistics Paradigm
Minimization of the risk functional based on empirical data was not consid-
ered in great detail in the classical statistical paradigm. Classical tradition
is to consider three main statistical problems: density estimation, regression
estimation, and discriminant function estimation, separately, using specific
parametric models for each of these problems. Of course, three particular
settings of the problem, instead of a single general one, were considered not
because statisticians did not see this trivial generalization, but because the
particular models used in classical statistics for solving the main problems of
function estimation based on empirical data did not allow such generalization.
As we mentioned in the Introduction, the classical approach to solving
these problems was based on methods developed by R. Fisher in the 1920s
and 1930s. Fisher suggested three approaches for solving main function esti-
mating problems based on the maximum likelihood method:
1. He suggested using the maximum likelihood method for estimating
parameters ao of a density function belonging to a parametric set of
densities p(x, a):
f
L(a) = Llnp(x;,a) ~ m:x.
;=1
2. He suggested using the maximum likelihood method for estimating
parameters of the regression function, belonging to a parametric set of
functions f(x, a). The regression is estimated from data that are values

CHAPTER I
687
of the regression function at given points corrupted by additive noise g
with known density function p(~)
Estimating parameters of regression in this case is equivalent to esti-
mating parameters of density p(~) = P(Yi - f(xi, a)).
3. He suggested using the maximum likelihood method for estimating
parametric densities of different classes Pk(x,a),
k = 1, ..,m, in dis-
criminant analysis. The estimated densities are used to construct a dis-
criminant function.
In 1946 Harold Cramer in his famous book Mathematical Methods (~fStatis-
tics (Cramer, 1946), by putting these methods on a firm mathematical basis,
created the classical paradigm of applied statistics. The key point in the clas-
sical paradigm is analysis of the accuracy of the estimation of the vector
parameters that specify the unknown functions rather than analysis of per-
formance of the estimated functions. That is why classical statistics did not
consider the problem of minimizing the risk functional for a given set of
functions.
The problem of estimating functions with good performance rather than
parameters of unknown functions became the core problem of statistical
learning theory. This problem defined a new development of statistical the-
ory, pushing it toward the theory of function approximation and functional
analysis.
Three Elements of Scientific Theory
According to Kant, any theory should contain three elements:
1. Setting of the problem
2. Resolution of the problem
3. Proofs
At first glance, this remark looks obvious. However, it has a deep meaning.
The crux of this remark is an idea that these three elements of theory in
some sense are independent and equally important.
1. The setting of the problem specifies the models that have to be analyzed.
It defines the direction of research.
2. However, the resolution of the problem does not come from deep the-
oretical analysis of the setting of the problem, but rather precedes this
analysis.
3. Proofs are constructed not for searching for the solution of the problem,
but for justification of the solution that has already been suggested.

688
COMMENTS AND BIBLIOGRAPHICAL REMARKS
The first two elements of the theory reflect the understanding of the essence
of the problem of interest, its philosophy. The proofs make the general (philo-
sophical) model a scientific theory.
Two Resolutions of the Risk Minimization Problem
In Chapter 1, we considered minimization of risk functional on the basis of
empirical data as one of two settings of the learning problem (imitation of
supervisor). For this setting, we consider the resolution called the principle
of empirical risk minimization. In order to find the minimum of the expected
risk, we minimize the empirical risk functional
constructed on the basis of data. In Chapter 6, we made a modification to
this resolution: We considered the structural risk minimization principle.
However, these principles (resolutions) are not the only possibilities. An
important role in learning processes belongs to the stochastic approximation
principle discovered by Robbins and Monroe (1951), where in order to min-
imize the expected loss functional on the basis of empirical data (in a set of
vector-parameterized functions), one uses the following iterative procedure
where V' (> Q(z, a) is a gradient (or generalized gradient) of the function
Q(z, a) and 'Yn is a sequence of constants that depend on n. It was shown
that under wide conditions on Q(Z, a) and 'Yn this procedure converges.
M. A, Aizerman, E. M. Braverman, and L. I. Rozonoer (1965-1967),
Amari (1967), and Ya. Z, Tsypkin (1968) constructed the general asymptotic
theory of learning processes based on the stochastic approximation induction
principle. Later, in 1970-1974 several books were published on this theory
(Aizerman, Braverman, and Rozonoer, 1970; Tsypkin, 1971; Tsypkin, 1973).
The stochastic approximation inductive principle, however, cannot be con-
sidered as a model for learning from small samples. A more realistic model for
these methods is the empirical risk minimization inductive principle. There-
fore along with analysis of the stochastic approximation inductive principle
the theory of the empirical risk minimization inductive principle had been
developed (Vapnik and Chervonenkis, 1968-1974).
The Problem of Density Estimation
The second setting of the learning problem (identification of a supervisor
function) is connected with the density estimation problem.
Analyzing the development of a theory of density estimation, one can see

CHAPTER 1
689
how profound Kant's remark was. Classical density estimation theories, both
parametric and nonparametric, contained only two elements: resolution of
the problem and proofs. They did not contain the setting of the problem.
In the parametric case, Fisher suggested the maximum likelihood method
(resolution of the problem); later it was proved by Le Cam (1953), Ihra-
gimov and Hasminskii (1981), and others that under some (and, as we saw
in this book, not very wide) conditions the maximum likelihood method is
consistent.
The same happened with nonparametric resolutions of the problem:
histogram methods (Rosenblatt, 1956), Parzen's window methods (Parzen,
1962), projection methods (Chentsov, 1963), and so on. First the methods
were proposed, followed by proofs of their consistency. In contrast to para-
metric methods the nonparametric methods are consistent under wide con-
ditions.
The absence of a general setting of the problem made the density esti-
mation methods look like a list of recipes. It also appeared that heuristic
efforts make the only possible approach to improve suggested density esti-
mation methods. This created a huge collection of heuristic corrections to
nonparametric methods for their practical applications.
The attempt to suggest a general setting of the density estimation problem
was done in an article by Vapnik and Stefanuyk (1978) where the density esti-
mation problem was considered, as a problem of solving an integral equation
with an unknown right-hand side, but given data. This general setting (which
is general because it follows from the definition of density) immediately con-
nected density estimation theory with two fundamental theories:
1. Theory of solving ill-posed problems
2. Glivenko-Cantelli theory
Theory of III-Posed Problems
The theory of ill-posed problems can be considered one of the most impor-
tant achievements in understanding the nature of many problems. Originally
it was developed for solving inverse problems of mathematical physics. Later,
however, the general nature of this theory was understood. It was demon-
strated that one has to take into account the statements of this theory every
time when one faces an inverse problem-that is, when one tries to derive the
unknown causes from known consequences. In particular, the results of the
theory of ill-posed problems are important for statistical inverse problems,
one of which is the problem of density estimation.
The existence of ill-posed problems was discovered by Hadamard (1902).
Hadamard thought that ill-posed problems are purely mathematical phenome-
non and that the real-life problems were well-posed. Soon, however, it was
discovered that there exist important real-life problems that are ill-posed.

690
COMMENTS AND BIBLIOGRAPHICAL REMARKS
Tikhonov (1943), proving a lemma about an inverse operator, described
the nature of well-posed problems and therefore discovered ways for regu-
larization of ill-posed problems. It took 20 more years before Phillips (1962),
Ivanov (1962), Tikhonov (1963), and Lavrentev (1962) came to the same
constructive regularization idea described-however, in a slightly different
form.
The important message of the regularization theory was the fact that in
the problem of solving operator equations
Af(t) = F(x),
which define an ill-posed problem, the obvious resolution to the problem,
namely minimizing the functional
R(f) = IIAf -- FW,
does not lead to good results. Instead one should use a nonobvious resolution
that suggests minimizing the "corrupted" functional
R~(f) = jlAf - FI1 2 + l'W(f).
These results were the first indication that in function estimation problems
obvious resolutions may be not the best.
It should be added that even before the regularization method was intro-
duced. V Fridman (1956) found regularization properties of stopping early
an iterative procedure of solving operator equations (note that here is the
same idea: a "corrupted" solution is better than an "uncorrupted" one).
The regularization technique in solving ill-posed problems was not only
the first indication of the existence of nonobvious resolutions to the problems
that are better than the obvious resolution, but it also gave an idea how
to construct these nonobvious resolutions. One can clearly see that many
techniques in statistics, and later in learning theory, that construct a better
solution to the problem were adopted from the regularization tcchniquc for
solving ill-posed problems.
Glivenko-Cantelli Theorem and Kolmogorov Bounds
In 1933. the same journal published three articles that can be considered as
the cornerstone of statistical science. Glivenko proved that the empirical dis-
tribution function always converges to the unknown continuous distribution
function, Cantelli proved that the empirical distribution function converges
to any unknown distribution function, and Kolmogorov gave an exact asymp-
totic rate of convergence of the empirical distribution function to the desired
continuous distribution function.
The important message of these results is that empirical data contain
enough information to estimate an unknown distribution function. As was

CHAPTER 2
691
Table 1. Structure of the classical theory of statistics and fhe statistical leamlng
theory
Classical Statistics
Statistical Learning Theory
Paradigm
Paradigm
Setting of
Estimation of function
Minimizing expected risk
the problem
parameters
using empirical data
Resolution of
ML method
ERM or SRM methods
the problem
Proofs
Effectiveness of
Existence of uniform law
parameter estimation
of large numbers.
shown in Chapter 2, to estimate the probability measure, one needs to esti-
mate a density function, that is, to solve an ill-posed problem.
This ill-posed problem, however, is not too hard: It is equivalent to esti-
mating the first derivative of a function on the basis of measurements of this
function; the measurements are such that when using them one can construct
an approximation that converges exponentially fast to the unknown distribu-
tion function (for example, this is true for an empirical distribution function).
Therefore (according to Chapter 7), using the regularization method for solv-
ing an integral equation that defines a density estimation problem, one can
construct various methods (classical and new) that estimate density if the
latter exists.
Moreover, as we saw in Chapter 2, the solution of the risk minimization
problem does not require estimating a probability measure as a whole; it
is sufficient to estimate it partially (on some subset of events). The partial
estimate defined by a subset as described in the Glivenko-Cantelli theorem
is always possible. For this subset, there exist exponential bounds on the rate
of convergence, according to the Kolmogorov theorem. One of the goals of
learning theory therefore was to obtain the same results for different subsets
of events. This goal was achieved almost 40 years after Glivenko-Cantelli-
Kolmogorov theorems had been proved.
Therefore, when analyzing the roots of different approaches to a func-
tion estimation problem, one can make Table 1, which shows the difference
between the classical statistics paradigm and the statistical learning theory
paradigm.
CHAPTER 2
In many respects, the foundations of statistical learning theory coincide with
the foundations of statistical theory as a whole.
To see this, we have to discuss the foundations of statistics from some

692
COMMENTS AND BIBLIOGRAPHICAL REMARKS
general point of view. In the 1930s, when Glivenko, Cantelli, and Kolmogorov
proved their theorems, the most important problem in the foundation of
statistics was considered the problem of the nature of randomness. Several
points of view were under consideration.
In
1933 Kolmogorov
(1933b)
introduced the axioms of probability
theory. With this axiomatization the probability theory became a purely
deductive discipline (say, as geometry) whose development depends only on
formal inferences from the axioms. This boosted the development of proba-
bility theory. However, the theory lost its connection to the physical concepts
of randomness-it simply ignored them. Nevertheless, the question "What is
randomness?" remained and needed to be answered. Thirty-two years after
introducing the axioms, Kolmogorov (1965) suggested the answer: He intro-
duced the algorithmic complexity concept and defined random values as the
output of algorithms with high complexity.
Therefore the problem of the foundation of statistics has two natures:
(1) the mathematical (formal), connected with axiomatization of probability
theory, and (2) the physical, describing randomness as an outcome of too
complex algorithms.
In Chapter 2, we touched upon the formal (mathematical) part of the
problem of the foundation of statistics and its relation to the foundation of
learning theory, and in Chapter 6 when we considered the structural risk min-
imization principle we discussed the relation of the algorithmic complexity
concept and the capacity concept.
In Chapter 2, when sketching the main problem of statistics as an estima-
tion of probability measure from a collection of data, we stressed that the
foundation of statistics is connected to the problem of estimating the density
function in the L) norm: If the density function does exist, then there exists
the estimator of the probability measure. The connection of estimating the
probability measure to density estimation in the L 1 norm was discussed by
several authors, including Abou-Jaoude (1976), and Chentsov (1981). In par-
ticular, they discussed the conditions for existence of L 1 convergence of the
density estimator.
In 1985 Luc Devroye and Laslo Gyorfi published a book entitled Non-
parametric Density Estimation: The L 1 View, which presented a comprehen-
sive study of nonparametric density estimation methods. In the presentation
in Chapter 2, devoted to convergence of probability measure, I followed the
ideas of Chentsov
(1988), described
in
the
appendix
("Why the
L 1
approach?") to the Russian translation of this book.
Describing a partial estimate of the probability measure over some subset
of a sigma algebra, we considered the generalized Glivenko-Cantelli prob-
lem. In classical statistics the generalization of this theorem and the corre-
sponding Kolmogorov-type bounds were obtained for multidimensional em-
pirical distribution functions and for a sharp nonasymptotic bound in the
one-dimensional case. The main results here were obtained by Dvoretzky,
Kiefer, and Wolfovitz (1956) and by Massart (1990). It was shown that the

CHAPTER 3
693
(nonasymptotic) rate of convergence of empirical distribution function to the
actual distribution function has the bound
p {sup IF(x) - Femp(x)I > e} < 2e-
2e2r
.
xER"
The general picture of the Glivenko-Cantelli problem as uniform conver-
gence over an arbitrary set of events was established in the 1970s after the
main results about uniform convergence of the frequency to their probabil-
ities over a given set of events were obtained and the necessary capacity
concepts were introduced.
Therefore, introduction of the generalized Glivenko-Cantelli problem is
in some sense a reconstruction of the history. This generalization could have
happened before the analysis of the pattern recognition problem was com-
plete, but it did not. It is a direct consequence of the analysis of the ERM
principle for the pattern recognition problem.
CHAPTER 3
The presentation of material in Chapter 3 also does not reflect the historical
development of the theory. The Key Theorem of learning theory that starts
Chapter 3 was proven 20 years after the pattern recognition theory had been
constructed (Vapnik and Chervonenkis, 1989). The theory that induded the
Key Theorem was developed to show that for consistency of the empirical
risk minimization induction principle, existence of the uniform law of large
numbers is necessary and sufficient; and therefore for any analysis of learning
machines that use the ERM principle, one cannot avoid this theory.
The First Results in VC Theory. Late 19605
Development of statistical learning theory started with a modest result. Recall
that in Rosenblatt's Perceptron the feature space was binary (Rosenblatt sug-
gested using McCulloch-Pitts neurons to perform mapping). In the mid-1960s
it was known that the number of different separations of the n-dimensional
binary cube by hyperplanes is bounded as N < e
1l2
• Using the reasoning of
Chapter 4 for the optimistic case in a simple model, we demonstrated (Vap-
nik and Chervonenkis, 1964) that if one separates (without error) the training
data by a hyperplane in n-dimensional binary (feature) space, then with prob-
ability 1 -
11 one can assert that the probability of test error is bounded as
In N - In 11
n2 - In 11
P <
<---
-
f
f
In this bound the capacity term In N has order of magnitude n2. Deriving
such bounds for nondiscrete feature space, we introduced the capacity con-

694
COMMENTS AND BIBLIOGRAPHICAL REMARKS
cepts used in this book: first the growth function, then the VC dimension, and
only after these concepts the entropy of the set of indicator functions. By the
end of 1966 the theory of uniform convergence of frequencies to their prob-
abilities was completed. It included the necessary and sufficient conditions of
consistency, as well as the nonasymptotic bounds on the rate of convergence.
The results of this theory were published in (Vapnik and Chervonenkis,
1968, 1971). Three years later we published a book (Vapnik and Chervo-
nenkis, 1974) describing the theory of pattern recognition. The 1974 book
contained almost all the results on pattern recognition described in the present
book.
The generalization of the results obtained for the set of indicator functions
to the set of bounded real-valued functions was a purely technical achieve-
ment. It did not need construction of new concepts. By the end of the 1970s,
this generalization was complete. In 1979 it was published in a book (Vapnik,
1979) that generalized the theory of estimating indicator functions to estimat-
ing real-valued functions, and in two years (1981) we published the necessary
and sufficient conditions for the uniform law of large numbers (Vapnik and
Chervonenkis, 1981). The 1979 book in which the last result was included
was translated into English in 1982. It contained almost all the results on
real-function estimation described in this book.
Two strong reactions to the mathematical techniques developed appeared
in the late 1970s and early 1980s: one at MIT and another at Kiev State
University. The fact is that in the theory of probability an important role
belongs to the analysis of two problems: the law of large numbers and the
central limit theorem. In our analysis of the learning problem we introduced
a uniform law of large numbers and described the necessary and sufficient
conditions for its existence. The question arose about the existence of the
uniform central limit theorem. The discussion about a uniform central limit
theorem was started by Dudley (1978).
Using capacity concepts analogous to those developed in the uniform large
numbers theory, Kolchinskii (1981), Dudley (1978, 1984), Pollard (1984), and
Gine and Zinn (1984) constructed this theory.
Gine and Zinn also extended the necessary and sufficient conditions ob-
tained for the uniform law of large numbers from the sets of uniformly
bounded functions to the sets of unbounded functions. These results were
presented in Theorem 3.5.
After the discovery of the conditions for the uniform central limit theo-
rem, the uniform analog of the classical structure of probability theory was
constructed. For learning theory, however, it was important to show that it is
impossible to achieve generalization using the ERM principle if one violates
the uniform law of large numbers.
This brought us to the Key Theorem, which points out the necessity of an
analysis of uniform one-sided convergence (uniform one-sided law of large
numbers). From a conceptual point of view, this part of the analysis was ex-

CHAPTER 3
695
tremely important. At the end of the 1980s and the beginning of the 1990s
there was a common opinion that statistical learning theory provides a pes-
simistic analysis of the learning processes, the worst-case analysis. The inten-
tion was to construct the "real-case analysis" of the ERM principle.
In the Key Theorem of the learning theory it was proven that the theory
of the ERM principle which differs from the developed one is impossible.
Violation of the uniform law of large numbers brings us to a situation that
in the philosophy of science is called a nonfalsifiable theory.
These results brought statistical learning theory to interaction with one of
the most remarkable achievements in philosophy in this century: K. Popper's
theory of induction.
Now knowing statistical learning theory and rereading Popper's theory
of induction, one can see how profound was his intuition: When analyzing
the problem of induction without using special (mathematical) models, he
discovered that the main concept responsible for generalization ability is the
capacity.t
Milestones of Learning Theory
At the end of Chapter 3, we introduced three milestones that describe the
philosophy of learning theory. We introduced three different capacity con-
cepts that define the conditions (two of them are the necessary and sufficient
ones) under which various requirements to generalization are valid. To obtain
the new sufficient conditions for consistency of the learning processes, one
can construct any measure of capacity on a set of functions that are bounded
from below by those defined in the milestone.
Thus, in Chapter 1 we introduced the setting of a learning problem as a
problem of estimating a function using empirical data.
For resolution of this problem using the ERM principle, we obtained
proofs of consistency using the capacity concept.
CHAPTER 4
The results presented in Chapter 4 mostly outline the results described in
Vapnik and Chervonenkis (1974). The only difference is that the constant in
the bound (4.25) was improved. In Vapnik and Chervonenkis (1968, 1971,
1974) the bound defined by Theorem 4.1 had constant c = 1/4 in front of £2
in Eq. (4.46).
In 1991 Leon Bottou showed me how to improve the constant (1 instead
t It is amazing how close he was to the concept of VC dimension.

696
COMMENTS AND BIBLIOGRAPHICAL REMARKS
of 1/4). The bound with improved constant was published by Parrondo and
Van den Broeck (1993).
However, for many researchers, the goal was to obtain constant 2 in front
of e'2 as in the asymptotically exact formula given by Kolmogorov. This goal
was achieved by Alexander (1984), Devroye (1988), and Talegrand (1994). To
get 2 in front of e 2, the other components of the bound must be increased.
Thus Alexander's bound has too large a constant, and Talagrand's bound
contains an undefined constant. In Devroy's bound the right-hand side is
proportional to
!( (
£2)
11
h
1 + In h
exp
e
- 2e2
l
instead of
presented in this book (see Eq. (4.46)). Asymptotically, Devroy's bound is
sharper. However, for small samples (say, l/h < 20) the bound given in this
book is better for all
e < Jlnl/2.
-
20
Also, the bounds on risk obtained from bounds on uniform convergence
with c = 1 have clear physical sense: they depend on the ratio l / h.
The important role in the theory of bounds belongs to Theorem 4.3 which
describes the structure of the growth function, showing that this function
either is equal to l In 2 or can be bounded from above by the function
h(lnl/h+1).
This theorem was published for the first time (without proofs) in 1968
(Y. Vapnik and A. Chervonenkis, 1968). Vapnik and Chervonenkis (1971)
published the proofs. In 1972, Sauer (1972) and Shelah (1972) independently
published this theorem in a form of the combinatorial lemma.
CHAPTER 5
The content of Chapter 5 mostly outlines the results obtained in the late
1970s and published in Vapnik (1979, English translation (982).
The main problem in obtaining constructive bounds for uniform conver-
gence is generalization of the VC dimension concept for sets of real-valued

CHAPTER 6
697
functions. There are several ways to make this generalization. In Chapter 5
we used the direct generalization that was suggested in the 1974 book (Vap-
nik and Chervonenkis, 1974). This generalization led to simple bounds and
makes it possible to introduce the bounds on risk for sets of unbounded loss
functions.
There exist, however, other ways to generalize the VC dimension concept
for sets of real-valued functions. One of these is based on a capacity concept
called the VC subgraph, which was introduced by R. Dudley (1978). Using
the VC subgraph concept (which was renamed the pseudodimension), Pollard
(1984) obtained a bound on the rate of uniform convergence for the set of
bounded functions. These results were used by Haussler (1992) to obtain
bounds for the rate of generalization of learning machines that implement
sets of bounded real-valued functions.
In the distribution free case for sets of indicator functions the finiteness
of the VC dimension defines the necessary and sufficient conditions for uni-
form convergence. For sets of real-valued functions the finiteness of the VC
dimension (or the pseudodimension) is only a sufficient condition. The neces-
sary and sufficient conditions are described by a modified version of the VC
dimension (or the pseudodimension) (Alon et al. 1993). This modification
was suggested by Kearns and Schapire (1994).
CHAPTER 6
The idea of the existence of the advanced induction principle that involved
capacity control appeared in the 1960s in different branches of science. First
it was introduced by Phillips (1962), Tikhonov (1963), Ivanov (1962), and
Lavrentiev (1962) as a method for solving ill-posed problems. Later in the
1970s it appeared in statistics as advanced methods for density estimation:
sieve method (Grenander, 1981), penalized method of density estimation
(Tapia and Thomson, 1978), and so on. This analysis was done in the frame-
work of asymptotic theory and had described more or less qualitative results.
The quantitative theoretical analysis of the induction principle based on
the algorithmic complexity concept was started by Solomonoff (1960), Kol-
mogorov (1965), and Chaitin (1966). This idea was immediately recognized
as a basis for creating a new principle of inductive inference. In 1968 C. Wal-
lace and D. M. Boulton, on the basis of Solomonoff-Kolmogorov-Chaitin
ideas, introduced the so-called Minimum Message Length (MML) principle
(Wallace and Boulton, 1968). Later, in 1978, an analogous principle, called
Minimum Description Length, was suggested by Rissanen (1978).
The important result that demonstrated self-sufficiency of the Solomonoff-
Kolmogorov-Chaitin concept of algorithmic complexity for induction was
obtained by Barron and Cover (1991) for the density estimation problem.
In Chapter 6 we applied the Solomonoff-Kolmogorov-Chaitin ideas to the
pattern recognition problem. We showed that the compression idea is self-
sufficient in order to obtain the bounds on the generalization ability of the

698
COMMENTS AND BIBLIOGRAPHICAL REMARKS
MML-MDL induction principle for a finite number of observations (Vapnik,
1995).
In Chapter 10 we obtained a bound for SV machines which depends on
the minimum of three values, one of which is the number of essential support
vectors. Since the ratio of the number of support vectors to the numbt:r of
observations can be considered as a compression coefficient and the number
of essential support vectors is less than the number of support vectors, the
obtained bound can be better than the ones that follow from the compres-
sion scheme; that is, there is room for searching for an advanced induction
principle.
In 1974 using the bound for uniform convergence we introduced the Struc-
tural Risk minimization induction principle. In naming this principle we tried
to stress the importance of capacity control for generalization. The main dif-
ference between the SRM principle and methods considered before was that
we tried to control a general capacity factor (e.g., the VC dimension) instead
of a specific one (say, the number of parameters). Lugosi and Zegev (1994)
proved that SRM principle is universally consistent (see Devroye et aI., 1996).
An important feature of the SRM principle is that capacity control can
be implemented in many different ways (using different type of structures).
This describes the mathematical essence of the SRM principle. The physical
essence for this problem is to describe which type of structure is appropriate
for our real-world tasks.
When discussing this question, one usually refers to Occam's razor princi-
ple:
Entities should not be multiplied beyond necessity.
In other words,
The simplest explanation is the best.
In this book we have encountered several interpretations of the concept
of simplest explanation which fit the general SRM scheme. In particular, one
can define the concept of the simplest as one that (1) has the smallest number
of features (free parameters), (2) has the smallest algorithmic complexity, and
(3) has the largest margin.
Which of them corresponds to Occam's razor? If we apply Occam's razor
principle to the problem of choosing one of these three interpretations, it
would choose option 1 (the smallest number of features).
Chapter 12 and especially Chapter 13 demonstrated that algorithms which
ignore the number of parameters and control the margin (such as SV
machines, neural networks, and AdaBoost schemes) often outperform classi-
cal algorithms based on the philosophy of controlling the number of param-
eters.

CHAPTER 6
699
In the light of this fact, Occam's razor principle is misleading and perhaps
should be discarded in the statistical theory of inference.
The important part of the problem of estimating multidimensional func-
tions is the problem of function approximation. As stated in the Bernstein-
Vallee-Poussin theorem, a high rate of approximation can be achieved only
for smooth functions. However, the concept of smoothness of functions in
high-dimensional spaces (that reflect the same phenomenon) can be described
differently. In Chapter 6 we considered the nonclassical smoothness concepts
that were introduced by Barron (1993), Breiman (1993), and Jones (1992).
For such smooth functions they suggested simple structures with elements
described only by the number of basis functions of the type f((x * w) + wo).
Another interesting set of functions for which the rate of approximation is
fast (except for the logarithmic factor) and the constants in the bound depend
on VC dimension of the set of approximating functions was introduced by
Girosi (1995).
The idea of local approximation of functions has been considered in statis-
tics for many years. It was introduced in nonparametric statistics as the k-
nearest neighbor method for density estimation or as the Nadaraya-Watson
method for regression estimation: Nadaraya (1964), Watson (1964). Classical
analysis of these methods is asymptotic. In order to achieve the best results
in the nonasymptotic case, it is reasonable to consider a more flexible scheme
or local model that includes both the choice of the best locality parameter
and the complexity of the local model (in the classical consideration, both
the locality parameter and complexity of the local model are fixed).
An article by Vapnik and Boltou (1993) reported bounds for such models.
Section 6, which is devoted to local learning methods, is based on this article.
Now it would be very useful to define the optimal strategy for simultaneous
choice of both parameters. This problem is not of just purely theoretical
interest, but also of practical importance, since by using local methods one
can significantly improve performance. This fact was reported for pattern
recognition in an article by Bottou and Vapnik (1992) where, by using a local
version of the neural network, performance was improved more than 30%.
Using this idea for regression, Bottou, Oriancourt, and Ignace constructed
in 1994 a system for highway traffic forecast that outperformed the existing
system at Ministere de L'Equipment (France) by almost 30%.
Remarks on Bayesian Inference
In this book we have not considered the Bayesian approach. However, to
better understand the essence of the SRM (or MOL) principle, it is useful to
compare it to Bayesian inference.
In the middle of the eighteenth century, Thomas Bayes derived
... the first expression in precise quantitative form of a mode of inductive
inference (Encyclopaedia Britannica, 1965).

700
COMMENTS AND BIBLIOGRAPHICALREMARKS
This expression became one of the most important formulas in probability
theory:
P(AIB) = P(BIA)P(A)
P(B)
.
When
B=Zt, ..·,Zp
is a sequence of i.i.d. observation and P (A) is an a priori probability function
on a set of vector parameters A that control distribution P(BIA), then
P(AI
) = P(zdA) x ... x P(zpIA)P(A)
Zj, .. ·,Zp
P(
)
.
z), ... ,Zp
This formula defines a posteriori probabilities P(AIZt, ...,Zl') on parameters
A (after one takes into account the sequence ZI, ... , Zp and the a priori prob-
abilities P(A».
The a posteriori probabilities can be used for estimating a function from a
given collection of functions. Consider, for simplicity, the problem of regres-
sion estimation from a given set of functions [(x, a), a E A, using measure-
ments corrupted by additive noise:
(here an E A). Using a priori probabilities P(a), a sequence of measurements
and information about the distribution function of the noise P (~) one can
estimate the a posteriori prohability on parameters a that define functions
[(x, a) as follows
Let us call Bayesian any inference that is made on the basis of an a pos-
teriori probability functiont P (a 1':8).
The Bayesian approach considers the following two strategies of inference
from a posteriori probability functions:
t This is a particular formulation of the Bayesian approach. A more general formulation exists
based on concepts of subjective probability and utility.

CHAPTER 6
701
1. The inference based on the idea of maximization of a posteriori prob-
ability (MAP) where one chooses the function that maximizes a poste-
riori probability P(aIB). This function coincides with the function that
maximizes the functional
1
i
1
R(a) = i LlnP(Yi - f(Xi, a)) + £InP(a).
i=t
(a)
2. The inference based on the idea of averaging an admissible set of func-
tions over a posteriori probability where one constructs an approximat-
ing function that is the average of functions from an admissible set with
respect to a posteriori probabilities:
<I> (xIB) = / f(x, a)P(aIB) da.
(b)
The constructed function has the following remarkable property: it min-
imizes the expectation of quadratic loss from admissible regression func-
tions where the expectation is taken both over the training data and
over the set of admissible functions:
lI>(<I»
= / (f(x,a) - <I>(xIB))2P(Bla)P(a)dxdadB.
(c)
The fact that <I> (xIB) minimizes the functionalll>(<I»
is often considered
as the justification of the averaging Bayesian inference.
In this book we consider consistency as the smallest requirement for function
estimation methods.
One can show that the method of maximum of a posteriori probability is
always consistent if the set of admissible functions contains a countable num-
ber of elements. Compare this to the maximum likelihood method (minimum
empirical risk method) that is always consistent only if the set of admissible
functiuns is finite. However, fur the uncuuntable infinite set of admissible
functions the method of maximum a posteriori probability is not necessarily
consistent. To construct a consistent method, one should modify the MAP
method in the spirit of SRM in order to control capacity. (Recall that the
SRM method is strongly universally consistent.)
In spite of the fact that the averaging method minimizes functional (c), it is
not necessarily consistent as well. See the article by Diaconis and Freedman
(1986) for details. This means that to make the averaging method universally
consistent, one has to modify it.
More important, however, is the fact that to use Bayesian inferences, one
must have strong a priori information:
1. The given set of functions of the learning machine coincides with a set
of target functions (qualitative a priori information).

702
COMMENTS AND BIBLIOGRAPHICAL REMARKS
2. A priori probabilities on the set of target functions are described by
the given expression pea) (quantitative a priori information).
Statement 2 (quantitative information) is not as important as statement
I (qualitative information). One can prove that, under certain conditions,
if quantitative a priori information is incorrect (but qualitative is correct),
then with an increasing number of observations the influence of incorrect
information decreases. Therefore, if the qualitative information is correct,
the Bayesian approach is appropriate.
The requirement for the correctness of the qualitative information is cru-
cial: The set of target functions must coincide with the set of functions of a
learning machine. Otherwise Bayes' formula has no sense.
Therefore in the framework of Bayesian inference one cannot consider
the following problem: Find the function that approximates a desired one in
the best possible way if a set of functions of a learning machine does not
coincide with a set of target functions. In this situation, any chosen function
from the admissible set has zero a priori probability; consequently, according
to Bayes formula, the a posteriori probability is also equal to zero. In this
case inference based on a posteriori probability functiun is impossible.
In contrast to the MAP method, the capacity (algorithmic complexity) con-
trol methods SRM (or MDL) use weak a priori information about reality:
They use a structure on the set of functions (the set of functions is ordered
according to the idea of usefulness of the functions) and choose the appropri-
ate element of structures by capacity control. To construct a structure on the
set of functions, one does not need to use information that includes an exact
description of reality. Therefore, when using the SRM (MDL) approach, one
can approximate a set of functions that is different from the admissible set
of functions of the learning machines (the appropriate structure affects the
rate of convergence; however, for any admissible structure the SRM method
is consistent).
The difference between the SRM approach and the MAP approach is in
the following: The SRM approach does not need a priori information about
the set of target functions due to capacity control, while the MAP approach
does not include the capacity control but uses such a priori information. The
capacity control makes the SRM method universally consistent, while even
the correct a priori information about the set of target functions does not
guarantee consistency of the MAP method.
The averaging method has a more general framework than averaging (b)
with respect to the posteriori probability. One can consider this method as
constructing a hyperplane in Hilbert space, where using training data Bone
defines a function P(aIB) that specifies the hyperplane. The specific feature
of the averaging method is that function P(aIB) has to be non-negative.
In the Bayesian approach, one estimates this function with posteriori prob-
abilities, which limits this type of inference due to the necessity of using the

CHAPTER 6
703
Bayes inversion formula. It is possible however to construct averaging meth-
ods that do not rely on the Bayesian formula (see V Vovk, 1991).
In learning theory several ideas of averaging were introduced that also do
not rely on averaging according to posteriori probabilities, including the Bag-
ging averaging suggested by L. Breiman (1996) and the AdaBoost averaging
suggested by Y. Freund and R. Schapire (1995).
As in the SVM theory for pattern recognition the generalization ability
of averaging methods was shown also to be controlled by the value of the
margin.
Suppose we are given training data
(Yt,xd, .. ·,(Yp,Xp),
Yi E {-1,1}
and a set of n indicator functions u, (x), ... ,un(x).
Consider the n dimensional vector (feature vector)
and the training data in the corresponding feature space
It was shown (Shapire et al., 1997) that AdaBoost constructs the averaging
rule
n
f(x) = I: 13kUk (x),
13k 2: 0,
k=1
that separates the training data in the feature space
y,,(Ui * w) 2: 1,
w:2': 0
and minimizes L] norm of nonnegative vector W = (w], ... , wn )
In the more general case one can suggest minimizing the functional
n
P
I:Wk + CI:g,.,
wk:2': 0
k=]
i=]
subject to constraints
y,.(u,. * w) > 1 - gj,
{;:2': 0,
i = 1, ... ,e,
W 2 O.
(d)

704
COMMENTS AND BIBLIOGRAPHICAL REMARKS
To construct the averaging hyperplane one can also use the Lz norm for the
target functional (the SVM type approach). In this case one has to minimize
the functional
t
(w * w) + CL gi,
Wk ~ 0
i=\
subject to constraints (d), where vector w must be nonnegative.
The solution to this problem is the function
f
[(x) = (w * u(x»
= L ai(u(x) * u;) + (f * u(x»,
i=\
where the coefficients ai, i = 1, ... , £. and the vector f = ('YI, ... , 'Yn) are the
solution of the following optimization problem:
Maximize the functional
f
1
f
W(a, f) = L ai - 2L aiajYiYj(Ui * Uj)
;=1
i,j=\
subject to constraints
o'S ai 'S C,
'Yj ~ 0,
; = 1, ... , £.
j=l,,,.,n
The important difference between the optimal separating hyperplanes and
the averaging hyperplanes is that the averaging hyperplanes must satisfy one
additional constraint, the coordinates of the vector w must he nonnegative.
This constaint creates a new situation both in analysis of the quality of con-
structed hyperplanes and in optimization techniques. On one hand it reduces
the capacity of linear machines which can be used for effective capacity con-
trol. On the other hand the existing techniques allow us to average over a
small amount of decision rules (say, up to several thousand).
The challenge is to develop methods that will allow us to average over
large (even infinite) numbers of decision rules using margin control. In other
words, the problem is to develop efficient methods for constructing averaging
hyperplanes in high dimensional spaces, analogous to the SVM methods,
where there are no constraints on the coefficients of hyperplanes.
CHAPTER 7
The generalization of the theory of solving ill-posed problems originally in-
troduced for the deterministic case to solve stochastic ill-posed problems

CHAPTER 7
705
is very straightforward. Using the same regularization techniques that were
suggested for solving deterministic ill-posed problems and also using the
same key arguments based on the lemma about the inverse operator, we
generalized the main theorems about the regularization method (Vapnik
and Stcfanuyk, 1976) to a stochastic model.
Later, Stefanuyk (1986)
generalized this result for the case of an approximately defined operator.
It was well known that the main problem of statistics-estimating a density
function from a more-or-Iess wide set of functions is ill-posed. Nevertheless
the analysis of methods for solving density estimation problem was not con-
sidered from the formal point of view of regularization theory.
Instead, in the tradition of statistics one first suggests some method for
solving this problem, then proves its favorable properties, and then introduces
some heuristic corrections to make this method useful for practical tasks
(especially for multidimensional problems).
The attempts to derive new estimators from a more general point of view
of solving the stochastic ill-posed problem was started with analysis of the
various algorithms for density estimation (Aidu and Vapnik, 1989). It was
observed that almost all classical algorithms (such as Parzen windows, pro-
jection methods) can be obtained on the basis of the standard regularization
method of solving stochastic ill-posed problems under conditions that one
chooses the empirical distribution function (which is a discontinuous func-
tion) as an approximation to an unknown distribution function (which is a
continuous function). In Chapter 7 we constructed new estimators using the
continuous approximation to the unknown distribution function.
The real challenge, however, is to find a good estimator for multidimen-
sional density defined on bounded support. To solve this problem using ideas
described in Chapter 7, one has to define a good approximation to an un-
known distribution function: a continuous monotonic function that converges
to the desired function with an increasing number of observations as fast as
an empirical distribution function converges. Note that for a fixed number of
observations the higher the dimensionality of space, the "less smooth" the
empirical distributiun functiun. Therefore in the multidimensional case using
smooth approximations to the unknown continuous distribution function is
very important.
On the other hand, for a fixed number of observations, the larger the
dimensionality of the input space, the greater the number of observations
that are "border points." This makes it more difficult to use the smoothness
properties of distribution functions. That is, it is very hard to estimate even
smooth densities in more or less high-dimensional spaces.
Fortunately, in practice one usually needs to know the conditional density
rather than the density function. One of the ideas presented in Chapter 7 is
the estimation of the conditional density (conditional probability) function
without estimating densities. The intuition behind this idea is the following: In
many applications the conditional density function can be approximated well
in low-dimensional space even if the density function is a high-dimensional

706
COMMENTS AND BIBLIOGRAPHICAL REMARKS
function. Therefore the density estimation problem can be more complicated
than the one that we have to solve.
The low-dimensional approximation of conditional density is based on two
ideas (Vapnik, 1988):
1. One can approximate conditional density locally (along a given line
passing through the point of interest).
2. One can find the line passing through the point of interest along which
the conditional density (or conditional probability) function changes
the most.
Note that if the regression function (or the Bayesian decision rule) can be
approximated well by a linear function, then the desired direction is orthog-
onal to the linear approximation. Therefore one can split the space into two
subspaces: One of these is defined by the direction of the approximated linear
function, and the other is an orthogonal complement to the first one.
The idea using linear regression is not very restrictive because when using
the SV machine. one can perform this splitting into feature spaces.
CHAPTER 8
Transductive inference was discussed for the first time in my 1971 booklet
devoted to the problem of pattern recognition. Since that time the discussion
on transductive inference was repeated in our 1974 book (Vapnik and Cher-
vonenkis, 1974) and in my 1979 book (Vapnik, 1979) almost without any
significant modifications (for English translation of my 1979 book I added
sections devoted to estimating real values at given points). Chapter 8 repeats
the content of the corresponding chapter from the English edition of the 1979
book.
In spite of the fact that transductive inference can be considered as one
of the most important directions of development of statistical learning
theory. which should have a strong influence not only on technical discussions
on methods of generalization but also on the understanding of ways of infer-
ence of human beings, there was almost nothing done in the development of
this inference. There is only one article by Vapnik and Sterin (1977) apply-
ing transductive inference. In this article by using the transductive version of
generalized portrait algorithms (the linear SV machine in input space). the
advantage of this type of inference against inductive inference for small sam-
ple size was demonstrated: For some real-life pattern recognition problems.
the number of test errors was significantly reduced.
In 1976 the generalized portrait algorithm was restricted to constructing an
optimal hyperplane in the input space. Now by using generalization of this
algorithm, the SV method. one can develop general types of transductive
algorithms.

CHAPTER 8
707
Speculations on Transductive Inference: Inference Through
Contradiction
Let me suggest a speculation on transductive inference which I believe reflects
nonstandard ways of human inference.
Suppuse we are given simultaneuusly the training set
the test set
Xf+I,···,Xf+k,
and the admissible set of indicator functions f(x, a), a E A.
The discrete space Xl, . .. , Xf+k factorizes our set of functions into a finite
number of equivalence classes F), ..., FN (Fk = {f(x, a): a E Ad).
For solving the problem of estimating the values of functions at the given
points, let us consider the empirical risk minimization principlet: among N
equivalence classes we look for the decision class that separates the training
set with zero errors. Let FI , •• , Fn be such equivalence classes. If fl > I we
have to choose one class among these fl equivalence classes.
In Chapter 8, along with the special concept of power equivalence classes
for a linear set of functions, we describe a maximum a posteriori probability
(MAP)-type approach as a way of introducing a "smart" concept of power
of equivalence classes.
Let us repeat it once more. Suppose that there exists a generator which
randomly and independently generates f + k vectors constructing the current
discrete space XI, ""Xf+k'
Suppose also that there exist a priori distributions P (a) on the set of
functions w = f(x, a), a E A which determine the desired classifier.
We considered the fulluwing scheme:
1. First, a random current discrete space appears.
2. Then this discrete space is randomly divided into two subsets: a subset
that contains f vectors and a subset that contains k vectors.
3. According to the distribution P (a), the desired classification function
f(x, a) is chosen. Using this function, one determines the values of
functions at the points of the first subset, which forms the training set.
The problem is to formulate a rule for estimating the values of the desired
function on the second subset which guarantees the minimal expected number
of errors.
The MAP solution of this problem is as follows:
t We consider here the empirical risk minimization principle only for simplicity. It is more inter-
esting to use the structural risk minimization principle.

708
COMMENTS AND BIBLIOGRAPHICALREMARKS
1. Consider as the power of the equivalence class the a priori distribution
of probability that the desired function belongs to a given equivalence
class
k=1,2, ...,N;
here a priori means after defining the current discrete space, but before
splitting it on the training and the test sets.
2. Choose among the equivalence classes one which separates the training
set without error and has the largest power.
Although the formal solution is obtained, the MAP approach actually
does not solve the conceptual problem-namely, to introduce an appropriate
concept of power of equivalence classes. It only removes the decision step
from the formal part of the problem to its informal part. Now everything
depends on the a priori information-that is, the distribution function P (a).
The specification of this function is considered as a problem that should be
solved outside the MAP inference. Thus, to solve the problem of transductive
inference in the framework of the MAP approach, one has to develop a
general way for obtaining a priori information.
Of course, nobody can generate a priori information. One can only trans-
form the information from one form to another. Let us consider the following
idea for extracting the needed information from the data.
Assume that we have the a priori information in the following form. We
are given a (finite) set of vectors
(let us call it the universe) which does not coincide with the discrete space
but is in some sense close to any possible current space.
For example, if we try to solve the problem of digit recognition, the uni-
verse can be a set of signs with approximately the same topology and the
same complexity. In other words, the universe should contain the examples
which are not digits but which are made in the spirit of digits-that is, have
approximately the same features, the same idea of writing, and so on. The
universe should reflect (in examples) our general knowledge about real life,
where our problem can appear.
We say that the vector xi from our universe is contradictory to the equiv-
alence class Fj if in this class there exists an indicator function that takes 1
on vector xi and there also exists a function that takes value 0 on this point.
We define the power of the equivalence class as the number of examples
from the universe which is contradictory to this equivalence class.
Now we can describe the hypothetical transduction step in the following
way.

CHAPTER 9
709
Try to find among the equivalence classes separating the training set one
which has the maximum number of contradictions in the universe. t
Thus, we split the definition of the power of equivalence classes into two
parts: informal and formal. The informal part is the content of our universe
and the formal part is the evaluation of the power of equivalence classes on
the basis on the universe.
The idea considering the contradictions on the universe as a measure of
power of equivalence classes goes in the same direction as (a) measure of
power for equivalence classes that give solutions for a linear set of functions
(based on the margin; see Section 8.5, Chapter 8) or (b) a priori probability
of an equivalence class in the MAP statement.
The idea of such an inference can be described as follows:
Be more specific; try to use a solution which is valid for current discrete
space and which does not have a sense out of current space.
Or it can be described in the spirit of Popper's ideas as follows:
Try to find the most falsifiable equivalence class which solves the problem.
Of course, from the formal point of view there is no way to find how to
choose the universe, as well as no way to find the a priori distribution in the
MAP scheme.
However, there is a big difference between the problem of constructing an
appropriate universe and the problem of constructing an appropriate a priori
distribution in the MAP scheme.
The universe is knowledge about an admissible collection of examples,
whereas the a priori distribution is knowledge about an admissible set of
decision functions.
People probably have some feeling about a set of admissible examples,
but they know nothing about a distribution on admissible decision functions.
CHAPTER 9
In 1962 Novikoff proved a theorem that bounds the number of corrections
of the Perceptron
t Of course, this is only a hasic idea. Deep resolution of the problem should consider the trade-
offs between the number of errors on training data and the number of contradiction examples
of the universe. This trade-off is similar to those for induction inference.

710
COMMENTS AND BIBLIOGRAPHICAL REMARKS
Using this bound we showed that in the on-line learning regime perceptron
can construct a separating hyperplane with an error rate proportional to
M InMIf.
How good is this bound?
Let us consider a unit cube of dimensionality n and all hyperplanes sep-
arating vertices of this cube. One can show that it is possible to split the
vertices into two subsets such that the distance between corresponding con-
vex hulls (margin) is proportional to 2- n . Therefore in the general case, the
a priori bound on quality of the hyperplane constructed by a perceptron is
very bad. However for special cases when the margin p is large (the number
of corrections M is small), the bound can be better than the bounds that de-
pend on dimensionality of space n. The mapping of input vectors into feature
space can be used to create such cases.
Therefore the very first theorem of learning theory introduced a concept
of margin that later was used for creating machines with linear decision rules
in Hilbert spaces.
However, in the framework of the theory of perceptrons the idea of con-
trolling the margin was not considered. The analysis of perceptrons mainly
concentrated on the fact that sets of decision rules of the perceptron are not
rich enough to solve many real-life problems. Recall that Rosenblatt pro-
posed to map input vectors into a binary feature space with a reasonable
number of features.
To take advantage of a rich set of functions, one can either increase the
dimensionality of the feature space (not necessarily binary) and control the
generalization using both the value of margin and the value of empirical risk
(this idea was later realized in the support vector machines), or construct a
multilayer perceptron (neural network) with many controlled neurons.
In 1986 in two different publications, Rumelhart, Hinton and Williams
(1986) and LeCun (1986), the back-propagation method of training multi-
layer networks was introduced. Later it was discovered that Bryson et al.
(1963) had described the back-propagation algorithm with Lagrange formal-
ism. Although their description was in the framework of optimal control (they
considered a multistage system defined as a cascade of elementary systems)
the resulting procedure was identical to back-propagation.
Discovering the back-propagation algorithm made the problem of learning
very popular. During the next 10 years, scores of books and articles devoted
to this subject were published. However, in spite of the high interest of the
scientific community with regard to neural networks, the theoretical analysis
of this learning machine did not add much to the understanding of the reason
of generalization. Neural network technology remains an art in solving real-
life problems.
Therefore at the end of the 1980s and the beginning of the 1990s re-
searchers started looking for alternatives to back-propagation neural net-
works. In particular, the subject of special interest became the Radial Basis
Function method. As we have discussed already in the main part of the book,

CHAPTER 10
711
the idea of radial basis functions can be clearly seen in the method of po-
tential functions introduced in 1965 (Aizerman, Braverman, and Rozonoer,
1965). The analysis of this method concentrated on on-line learning proce-
dures, while the analysis of radial basis functions was done in the framework
of off-line learning. See Powell (1992) for details.
CHAPTER 10
As soon as experiments with the Perceptron became widely known, the dis-
cussion on improvement of the Perceptron algorithm started. In the beginning
of the 1960s there were many iterative, mostly on-line, methods that later
were summarized in books by Tsypkin (Tsypkin, 1971, 1973) as a realization
of the idea of stochastic approximation. At the same time, the off-line meth-
ods for constructing hyperplanes were also under investigation. In 1963 the
method of Generalized Portrait for constructing the optimal separating hy-
perplane in dual space was suggested (Vapnik and Lerner, 1963, Vapnik and
Chervonenkis, 1964). This method actually is the support vector method for
constructing an optimal hyperplane in the separable case considered in Sec-
tion 10.1 of Chapter 10. In many practical applications we saw the advantage
of an optimal hyperplane compared to a nonoptimal separating hyperplane.
In our 1974 book (Vapnik and Chervonenkis, 1974) we published Theorem
10.7, according to which, the generalization ability of the optimal hyperplane
that separates training data without errors depends on the expectation of the
random variable min(V2/ p2, N, n).
In 1974 this theorem (without kernel technique) had limited applications:
It could be applied only to the linearly separable pattern recognition prob-
lem. Nevertheless, it showed that for this case, classical understanding of
the reason for generalization, which relies on the ratio of the number of
parameters to the number of observations, does not contain all the truth.
There are other factors. The problem was whether these factors reflect the
nature of the generalization problem or whether they reflect pure mathemat-
ical artifacts.
The SV method demonstrated that these factors must be considered as fac-
tors that control generalization ability. To use these factors more efficiently we
map relatively low-dimensional input vectors into a high-dimensional feature
space where we construct the optimal separating hyperplane. In this space we
ignore the dimensionality factor and rely on two others (while the classical
approach ignored two other factors).
To make this idea practical we use kernel representation of the inner
product based on Mercer's theorem. Before commenting on this idea, Jet me
make one remark.
In Chapter 12 we described experiments, where in order to achieve high
generalization we constructed a polynomial of degree 9 in 400-dimensional
input space. That is, in order to achieve good performance we separated

712
COMMENTS AND BIBLIOGRAPHICAL REMARKS
60,000 examples in-a 1023 dimensional feature space. The good generalization
was obtained dueto the optimality of the constructed hyperplane.
Note that the idea of constructing separating polynomials was discussed in
the pattern recognition methods since Fisher suggested discriminant analysis.
The main idea of discriminant analysis is the following: Given two normal
laws
i = 1,2
that describe the distribution of two classes of instances and given probability
p of occurrence of instances of the first class (q = 1 - P for the second),
construct the best (Bayesian) decision rule.
The optimal decision rule for this problem is the following quadratic dis-
criminant function:
In the particular case when 2] = 22 = 2, the quadratic discriminant function
reduces to a linear one:
F ()
II {;'(
\T~-1
1 (
T~-l
T~-I)
I p)
I X
=
v
J-t2 - J-tJ)
4.i
X -
2"
J-t14.i
J-tl - J-t2 4.i
J1.2
-
n - r·
q"
-
The idea of the classical discriminant method is to estimate the parame-
ters of the distribution function J-tl, J-t2, 21,22, p and then put them into an
expression for the optimal discriminant function (the so-called substitution
method). Of course it is not very difficult to prove that when the number of
observations is sufficiently large, this method will give good results.
Fisher, however, understood that for practical reasons the sufficient num-
ber of observations has to be large and suggested that we use the linear
discriminant rule even if 21 I- 22. He proposed to construct the artificial co-
variance matrix 2 = Y21 + (1 - Y)22 and substitute it into an expression for
the linear discriminant rule. Anderson and Bahadur (1966) solved the prob-
lem of choosing a coefficient y that defines the optimal decision rule among
linear rules in the case when the best (Bayesian) rule is quadratic. When the
dimensionality of the input space exceeds several dozens, the linear discrim-
inant function is used.
Therefore from the very beginning of discriminant analysis, Fisher un-
derstood the overfitting problem; and even in the case when the optimal
decision rule is quadratic, he preferred a linear discriminant function. The
SV method can ignore Fisher's concern, due to optimality of the hyperplane
in the corresponding feature space.

CHAPTER 11
713
To construct a hyperplane in high-dimensional feature space, we use a
general representation of the inner product in Hilbert spaces. According
to Mercer's theorem, an inner product in Hilbert spaces has an equivalent
representation in kernel form. This fact was established by Mercer in 1909
(Mercer, 1909). Since then the Mercer theorem, the related theory of positive
definite functions, and the theory of reproducing kernels Hilbert spaces have
become important topics of research [see Aronszajn (1943), Steward (1976),
Mitchelli (1986), Wahba (1990)J. In particular, this theorem was used to prove
the equivalence between the method of potential functions and Rosenblatt's
perceptron (Aizerman, Braverman, and Rozonoer, 1964).
Therefore by the mid-1960s, two main elements of the SV machine (the
expansion of the optimal hyperplane on support vectors and the constructing
hyperplane in feature space using Mercer kernels) were known. It needed
only one step to combine these two elements. This step, however, was done
almost 30 years later in an article by Boser, Guyon, and Vapnik (1992).
After combining the SV expansion with kernel representation of the inner
product, the main idea of the SV machine was realized: One could construct
linear indicator functions in high-dimensional space that had a low capacity.
However, one could construct these hyperplanes (or corresponding kernel
representation in input space) only for the separable case.
The extension of the SV technique for nonseparable cases was obtained
in an article by Cortes and Vapnik (1995).
After the SV technique was discovered, the generalization ability of some
other learning techniques also was explained by the margin concept rather
than by the number of free parameters. Bartlett (1997) proved this fact for
neural networks, and Schapire, Freund, Bartlett, and Lee (1997) proved it
for the so-called AdaBoost learning technique.
This technique was used by SchOlkopf, Smola, and MUHer (1997) for
constructing nonlinear component analysis by providing linear component
analysis in feature space.
Remark
It should be noted that Theorem 10.6 gives a hint that more advanced models
of generalization may exist than one based on maximization of the margin.
The error bound for optimal hyperplanes described in Theorem 10.6 depends
on the expectation of the ratio of two random variables: the diameter of the
sphere that contains the support vectors to the margin.
It is quite possible that by minimizing this ratio one can control the gen-
eralization better than by maximizing the margin (the denominator of the
ratio).
Note that in a high dimensional feature space, where a SV machine con-
structs hyperplanes, the training set is very sparse and therefore the solution
that minimizes this ratio can be very different from one that maximizes the
margin.

714
COMMENTS AND BIBLIOGRAPHICAL REMARKS
CHAPTER 11
The generalization of SV machines for estimating real-valued functions was
done in the book The Nature of Statistical Learning Theory (Vapnik, 1995).
It contained a new idea, namely, the e-insensitive loss function. There were
two reasons for introducing this loss function:
(1) to introduce a margin in order to control the generalization of the
learning machine and
(2) to trade the accuracy of approximation for simplicity of solution (for
the number of SVs).
With this generalization the SV method became a general method for func-
tion representation in high-dimensional spaces which can be used for various
problems of function estimation including problems of density estimation and
solving linear operator equations [Vapnik, Golowich, and Smola (1997)].
For solving ill-posed problems there exists one more reason to use the
e-insensitive loss function: By choosing different values of e for different
points of observation. one can better control the regularization process.
CHAPTER 12
As we mentioned, in 1986 the back-propagation method for estimating
parameters of multilayer Perceptrons (neural networks) was proposed. In
spite of the fact that this had almost no impact on the theory of induction
or understanding of the reasons for generalization (if one does not take into
account speculations about imitation of the brain), the discovery of neural
networks should be considered as a turning point in the technology of statis-
tical inference.
In many examples it was demonstrated that for real-life (rather than small
artificial) problems, neural networks give solutions that outperform classical
statistical methods. The important insight was that to obtain good perfor-
mance it was necessary to construct neural networks that contradicted an
existing paradigm in statistics: The number of parameters of well-performing
neural networks was much larger than would be expected from classical statis-
tics recommendations. In these networks, to obtain good generalization, one
incorporated some heuristics both in the architecture (construction) of the
network and in the details of the algorithms. Ignoring these heuristics de-
creased the performance.
Therefore many researchers consider neural network applications to real-
life problems to be more art than science.
In 1985 Larry Jackel headed the Adaptive System Research Department
at AT&T Bell Laboratories which Yann LeCun joined in 1989. Since that
time, the department has become one of the most advanced centers in the

CHAPTER 12
715
art of solving one specific real-life problem using neural networks, namely,
the problem of handwritten digit recognition.
To achieve the highest level of performance for this task, a series of neural
networks called LeNet were constructed starting from LeNet 1 (1989), a five-
layer convolution neural network, up to seven-layer LeNet 5 (1997) in which,
along with classical neural network architecture, various elements of learning
techniques were incorporated (including capacity control, constructing new
examples using various distortions and noise models). See LeCun et al. (1998)
for detail.
Many years of racing for the best results in one specific application is ex-
tremely important, since starting from some level any significant improve-
ment in performance can be achieved only due to the discovery of new
general techniques. The following accomplishments based on new general
techniques have been obtained by this group during the past eight years.
For a relatively small (7,000 of training data) postal service database, the
results and corresponding techniques are as follows:
1. Convolutional network (1989)-5.1 % error rate
2. Local learning network (1992)-3.3% error rate
3. Tangent distance in the nearest-neighbor method (1993)-2.7% error
rate.
The last performance is close to the level of human performance for this
database.
Since 1994, experiments also have been conducted using a relatively large
(60,000 training examples) NIST database, where the following accomplish-
ments were achieved:
1. Convolutional network (LeNet 1)-1.7%
2. Convolutional network with control.led capacity (LeNet 4)-1.1 %
3. Boosted scheme of three networks LeNet 4 with controlled capacity-
0.7%
4. Network providing linear transformation invariant LeNet 5-0.9%
5. Network providing linear transformation invariants and elements of
noise model LeNet 5a-0.8%.
These results were also on the level of human performance for the NIST
database.
Therefore it was challenging to compare the performance of the SV ma-
chines with the results obtained using machines of LeNet series. In all ex-
periments with the SV machine reported in Chapter 12 we used a standard
polynomial machine where we chose an appropriate order of polynomial and
parameter C defining box constraints in the quadratic optimization problem.

716
COMMENTS AND BIBLIOGRAPHICAL REMARKS
The experiments described with SV machines were started by B. Boser
and I. Guyon and were then continued by C. Cortes, C. Burges, and B.
Scholkopf.
Using standard SV polynomial machines, C. Burges and B. Scholkopf
(1997) and SchOlkopf et al. (1998) achieved results that are very close to
the best for the databases considered.
1. 2.9% of error rate for postal service database (the record is 2.7%
obtained using tangent distance)
2. 0.8% of error rate for NIST dataset (the record is 0.70% obtained
using three LeNet 4 machines combined in a boosted scheme and
using additional training data generated by tangent vectors (Lie deriva-
tives)).
In both cases the best result was obtained due to incorporating a priori
information about invariants. For the SV machine, this fact stresses the impor-
tance of the problem of constructing kernels that reflect a priori information
and keep desired invariants. In experiments with SV machines, however, we
did not use this opportunity in full measure.
The important point for the digit recognition problem (and not only for
this problem) was the discovery of the tangent distance measure by Simard
et al. (1993). The experiments with digit recognition gave the clear message
that in order to obtain a really good performance it is necessary to incorpo-
rate a priori information about existing invariants. Since this discovery, the
methods for incorporating invariants were present in different forms (using
boosting procedure, using virtual examples, constructing special kernels) in
all algorithms that achieved records for this problem.
CHAPTER 13
Estimation of a real-valued function from a given collection of data tradi-
tionally was considered the central problem in applied statistics. The main
techniques for solving this problem, the least-squares method and least modu-
lus method, were suggested a long time ago by Gauss and Laplace. However.
its analysis started only in our century. The main results in justification of
these methods, however, were not unconditional. All theorems about favor-
able properties of these methods contain some restrictive conditions under
which the methods would be considered optimal. For example, theorems
that analyze the least-squares method for estimating linear functions state
the following:
Among all linear and unbiased methods of estimating parameters of linear
functions the least-squares method has the smallest variance (Markov-
Gauss theorem). However, why does the estimator have to be linear
and unbiased?

CHAPTER 13
717
If one estimates parameters of the linear function corrupted by additive
normal noise, then among all unbiased estimators the least-squares es-
timator has the smallest variance. Again, why should the estimator be
unbiased? And why should the noise be normal?
Under some conditions on additive noise the least-squares method pro-
vides the asymptotic unbiased estimate of parameters of linear functions
that has the smallest variance. Which method is the best for a fixed number
of observations?
James and Stein (1961) constructed an estimator of the mean of random
(n ~ 3)-dimensional vectors distributed according to the normal law with unit
covariance matrix that was biased and that for any fixed number of observa-
tions is uniformly better than the estimate by the sample mean. (This result
is equivalent to the existence of a biased estimator that is uniformly better
than a linear estimator obtained by the least-squares method in the normal
regression problem). Later, Baranchik introduced a set of such estimators
that contained James-Stein's estimator. The main message from these analy-
ses was that to estimate linear regression well one needs to consider a biased
estimator.
In the 1960s the theory of solving ill-posed problems suggested specific
methods for l:onstructing biased estimators by using regularization terms.
Later in the framework of statistical learning theory, the idea of regularization
was used for regression estimation problems.
Classical statistics concentrated on the problem of model selection where
to find an estimate of the linear in its parameters function one has to first
specify appropriate basis functions (including the number of these functions)
and then to estimate a linear function in each basis function. This method,
generally speaking, also constructed a biased estimator of parameters.
Note that none of these approaches did develop an exact method (with
all parameters fixed) for controlling the desired value of bias. Instead, semi-
theoretical approaches were developed for selecting a regularization param-
eter (in solving ill-posed problems) and choosing appropriate elements of a
structure (in the SRM method).
Therefore it is extremely important to compare them experimentally. The
results of this comparison (which was done by Cherkassky and Mulier (1998))
are presented in Chapter 13.
Later, Cherkassky and Mulier (1998) demonstrated that using this bound
for choosing an appropriate number of wavelets in the wavelet decomposi-
tion of the signals outperforms the technique specially constructed for this
purpose.
The most interesting part of capacity control is when the capacity of the
structure differs from the number of free parameters, for example, defined
by the regularization term as in methods for solving an ill-posed problem.
For this situation, it was suggested using the same formulas where
instead of the number of parameters, one used the so-called "effective num-

718
COMMENTS AND BIBLIOGRAPHICAL REMARKS
ber of parameters." In formulas obtained from statistical learning theory.
capacity is defined by the VC dimension that does not necessarily coincide
with the number of parameters.
It is not easy, however, to obtain the exact estimate of the VC dimension
for a given set of functions. In this situation the only solution is to measure
the VC dimension of the sets of elements of the structure in experiments with
a learning machine. The idea of such experiments is simple: The deviation of
the expectation of the minimum of empirical risk from 1/2 for training data
with random (with probability 1/2) choice of labels depends on the capacity
of the set of functions. The larger the capacity, the larger the deviation.
Assuming that for maximal deviation there exists a relation of equality type
(for small samples, the theory can guarantee only a relation of an inequality
type) and that as in the obtained bound, the expected deviation depends
on one parameter, namely £./ h. one can estimate the universal curve from a
machine with known VC dimension and then use this curve to estimate the
VC dimension of any machine.
The idea that such experiments can describe the capacity of a learn-
ing machine (it was called "effective VC dimension") was suggested in an
article by Vapnik, Levin, and LeCun (1994). In experiments conducted by E.
Levin. Y. LeCun. and later I. Guyon, C. Cortes, and P. Laskov with machines
estimating linear functions, high precision of this method was shown.
It should be noted that the idea that for randomly labeled data the devia-
tion of the minimum value of empirical risk from 1/2 can be used to define
bounds for prediction error has been under discussion for more than 20 years.
In the 1970s it was discussed by Pinsker (1979). and in the 1990s Brailovsky
(1994) reintroduced this idea. The subject of analysis was the hypothesis that
this deviation defines the value of confidence interval. However, as was shown
in Chapter 4 the value of the confidence interval depends not only on the
number of observations and on the capacity of the set of functions, but on
the value of the empirical risk as well. It looks more realistic that expecta-
tions of the deviation define the capacity of the learning machine. Using the
estimated capacity and the obtained bound (maybe with different constants).
one can estimate the prediction accuracy. The method described in Chapter
13 is a step in this direction.
The main problem in approximation of data by a smooth function is to
control the trade-off between accuracy of approximation of the data and
complexity of the approximating function. In the experiments with approxi-
mation of the sine-function by linear splines with an infinite number of knots.
we demonstrated that by controlling the insensitivity value t: in the SV tech-
nique one can effectively control such a trade-off.
The problem of regression estimation is one of the key problems of
applied statistics. Before the 1970s the main approach to estimating multi-
dimensional regression was constructing linear approximating functions
using more or less the same techniques, such as the least-squares method

CHAPTER 13
719
or the least modulus method (robust methods). The set of linear functions,
however, often turns out to be too poor to approximate the regression func-
tion well. Therefore in the 1970s generalized linear functions were introduced
(set of functions that are a linear combination of a relatively small number
of basis functions). Researchers hoped that they could define a reasonably
small number of basis functions that would make it possible to approximate
the unknown regression well. The experiments, however, showed that it is
not easy to choose such a basis.
In 1980-1990 the natural generalization of this idea, the so-called dictio-
nary method, was suggested. In this method, one defines a priori a large
(possibly infinite) number of possible bases and uses training data both for
choosing the small number of basis functions from the given set and for esti-
mating the appropriate coefficients of expansion on a chosen basis. The dictio-
nary method includes such methods as Projection Pursuit (see Friedman and
Stuetzle (1981), Huber (1985)) and MARS (Multivariate Adaptive Regres-
sion Spline) (see Friedman (1991)). The last method is very attractive from
both analytical and computational points of view and therefore became an
important tool in multidimensional analysis.
In contrast to the dictionary method, the SV method suggests using all
elements of the dictionary and controlling capacity by a special type of reg-
ularization. In other words, both the dictionary method and the SV method
realize the SRM induction principle. However, they use different types of
structures on the set of admissible functions. Moreover, both the MARS
method and the SV method with kernels for constructing splines use the
same dictionary containing tensor products of basis functions defined by poly-
nomial splines. Therefore, comparison of MARS-type methods with the SV
machine is, in fact, comparison of two different ideas of capacity control: by
model selection and by regularization (assuming that both algorithms choose
the best possible parameters).
The experiments described in this chapter demonstrate the advantage of
regularization compared to feature selection.
The described method of solving linear equations is a straightforward gen-
eralization of the SV regression estimation method. However, it gives two
new opportunities in solving the PET problem:
• One can exclude the pixel-parameterization of the solution.
• One can use a more sophisticated scheme of regularization by treating
different measurements with different levels of accuracy.
The challenging problem in PET is to obtain a 3D solution. The main diffi-
culty in solving 3D PET using the classical technique is the necessity of voxel-
parameterization (3D piecewise constant functions). The 2D pixel represen-
tation contains a 256 x 256 constant to be estimated which is approximately
equal to the number of observations. In the 3D problem, one has to estimate

720
COMMENTS AND BIBLIOGRAPHICAL REMARKS
256 x 256 x 256 parameters using observations which number much less than
the number of parameters. The considered features of PET solution using the
SV technique give a hope that 3D solutions are possible.
CHAPTERS 14, 15, AND 16
These chapters are written on the basis of articles by Vapnik and Chervo-
nenkis (1971, 1981, and 1989).
EPILOGUE: INFERENCE FROM SPARSE DATA
Statistical learning theory does not belong to any specific branch of science:
It has its own goals, its own paradigm, and its own techniques.
In spite of the fact that the first publications presented this theory as
results in statistics, statisticians (who had their own paradigm) never consid-
ered this theory as a part of statistics.
Probabilists started using these techniques approximately 10 years after
their introduction. They adopted the new ideas, reconsidered the Glivenko-
Cantelli problem, developed the theory of the uniform central limit theorem,
and obtained asymptotically sharp bounds on the uniform law of large num-
bers. However, they were not interested in developing inductive principles
for function estimation problems.
In the mid 1980s, computer scientists tried to absorb part of this theory.
In 1984 the probably approximately correct (PAC) model of learning was
introduced (Valiant, 1984) which combined a simplified statistical learning
model with an analysis of computational complexity. In this model, however,
the statistical part was too simplified; it was restricted by problems of learn-
ability. As was shown by Blumer et al. (1989) the constructions obtained in
statistical learning theory give the complete answer to the PAC problem.
In the last few years mathematicians have become interested in learning
theory. Two excellent books devoted to mathematical problems of learning
appeared: A Probabilistic Theory of Pattern Recognition by L. Devroye, L.
Gyorfi, and G. Lugosi (1996) and A Theory of Learning and Generalization
by M. Vidyasagar (1997). In these books, the conceptual line of statistical
learning theory is described with great art. However, another aspect of the
problem exists: Using our new understanding of the models of generalization
to construct efficient function estimation methods.
Statistical learning theory is such that all parts of it are essential: Any
attempt to simplify it or separate one part from another harms the theory,
its philosophy, and its methods for applications. In order to accomplish its
goals, the theory should be considered as a whole.
Learning theory has one clear goal: to understand the phenomenon of in-
duction that exists in nature. Pursuing this goal, statistical learning theory has

EPILOGUE: INFERENCE FROM SPARSE DATA
721
obtained results that have become important for many branches of mathemat-
ics and in particular for statistics. However, further study of this phenomenon
requires analysis that goes beyond pure mathematical models.
As does any branch of natural science, learning theory has two sides:
1. The mathematical side that describes laws of generalization which are
valid for all possible worlds and
2. The physical sidt: that describt:s laws which are valid for our specific
world, the world where we have to solve our applied tasks.
From the mathematical part of learning theory it follows that machines can
generalize only because they use elements of a structure with restricted
capacity. Therefore machines cannot solve the overwhelming majority of pos-
sible formal problems using small sample sizes. To be successful, learning
machines must use structures on the set of functions that are appropriate for
problems of our world. Ignoring this fact can lead to destructive analysis (as
shown by the criticism of perceptrons in the late-1960s and the criticism of
learning theories based on "no free lunch theorems" in the mid-1990s).
This book mostly considers the mathematical part of the problem. How-
ever, in solving applied problems we observed some phenomena that can
be considered a raw material for analysis of physical laws of our world; the
advantage of certain structures over others, the important role of invariants,
the same support vectors for different kernels, etc.
Constructing the physical part of the theory and unifying it with the math-
ematical part should be considered as one of the main goals of statistical
learning theory.
To achieve this goal we have to concentrate on the problem which can be
called
Inference from Sparse Data
where, in order to generalize well, one has to use both mathematical and
physical factors.
In spite of all results obtained, statistical learning theory is only in its
infancy: There are many branches of this theory that have not yet been
analyzed and that are important both for understanding the phenomenon of
learning and for practical applications. They are waiting for their researchers.


REFERENCES
S. Abou-Jaoude (1976), Conditions necessaires et suffisants de convergence L 1 en
probabilite de I'histogramme pour une densite. Ann. de Inst. H. Poincare Set. B
(12),213-231.
F. A. Aidu and V. N. Vapnik (1989), Estimation of probability density on the basis of
the method of stochastic regularization, Autom. Remote Control 4, 84-97.
M. A. Aizerman, E. M. Braverman, and L. I. Rozonoer (1964a), Theoretical foun-
dations of the potential function method in pattern recognition learning, Aurom.
Remote Control 25,821-837.
M. A. Aizerman, E. M. Braverman, and L. I. Rozonoer (1964b), The problem of
pattern recognition learning and the method of potential functions, Autom. Remote
Control 25, 1175-1193.
M. A. Aizerman, E. M. Braverman, and L. I. Rozonoer (1970), Method of Potential
Functions in the Theory of Pattern Recognition (in Russian), Nauka, Moscow, p.
384.
H. Akaike (1970), Statistical predictor identification, Ann. Inst. Stat. Math.. 202-217.
K. Alexsander (1984), Probability inequalities for empirical processes and law of
iterated logarithm, Ann. Probab. 4, 1041-1067.
D. Alon, S. Ben-David, N. Cesa-Bianchi, and D. Haussler (1993), Scale-sensitive di-
mensions, uniform convergence, and learnability, in Proceedings ofthe 34th Annual
IEEE Conference on Foundations of Computer Science., pp. 292-301.
S. Amari (1967), A theory of adaptive pattern classifiers, IEEE Trans. Electron Com-
put. EC-16, 299-307.
T. W. Anderson and R. R. Bahadur (1966), Classification into two multivariate normal
distributions with different covariance matrices, Ann. Math. Stat. 133(2).
N. Aronszajn (1943), The theory of reproducing kernels and their applications, Cam-
bridge Phil. Soc. Proc. 39, 133-153.
A. R. Barron (1993), Universal approximation bounds for superpositions of a sigmoid
function, IEEE Trans. In! Theory 39(3), 930-945.
A. R. Barron and T. Cover (1991), Minimum complexity density estimation. IEEE
Trans. In! Theory 37, 1034-1054.
P. Bartlett (1997), For valid generalization the size of the weights is more important
than the size of network, in Advances in Neural Information Processing Systems.
Vol. 9, MIT Press, Cambridge, MA, pp. 134-140.
723

724
REFERENCES
D. Belsley, E. Kuh, and R. Welsch (1980), Regression Diagnostics: Identifying Influ-
ential Data and Sources of Collinearity, Wiley, New York.
J. Berger (1985), Statistical Decision Theory and Bayesian Analysis, Springer, New
York.
A. Blumer, A. Ehrenfeucht, D. Haussler and M. Warmuth (1989), Learnability and
the Vapnik-Chenvonenkis dimension, J. ACM 36, 929-965.
S. Bochner (1932), Vorlesungen iiber Fouriercche Integrale. Academisch Verlags-
gese IIschaft, Leipzig. English translation: S. Bochner (1959) Lectures on Fourier
Integral, Ann. Math. Stud., 42.
B. Boser, I. Guyon, and V. N. Vapnik (1992), A training algorithm for optimal margin
classifiers. in Fifth Annual Workshop on Computational Learning Theory. ACM.
Pittsburgh, pp. 144-152.
L. Bottou and V. Vapnik (1992), Local learning algorithms, Neural Compue. 4(6), pp.
888-901.
L. Bottou, C. Cortes, J. Denker, H. Drucker, I. Guyon, L. Jackel, Y. LeCun, U. Miller,
E. Sackinger, P. Simard, and V. Vapnik (1994), Comparison of classifier methods:
A case study in handwritten digit recognition, in Proceedings of the 12th IAPR
International Conference on Pattern Recognition, Vol. 2, IEEE Computer Society
Press. Los Alamos, CA, pp. 77-83.
V. L. Brailovsky (1994), Probabilistic approach to model selection: Comparison with
unstructured data, in Selecting Models from Data: AI and Statistic, Springer-Verlag.
New York, pp. 61-70.
L. Breiman (1993), Hinging hyperplanes for regression, classification and function
approximation, IEEE Trans. In! Theory 39(3), 999-1013.
L. Breiman (1996). Bagging predictors, Mach. Learn. 24(2), 123-140.
L. Breiman, J. H. Friedman, R. A. Olshen, and C. 1. Stone (1984), Classification and
Regression Trees, Wadsworth, Belmont, CA.
A. Bruce, D. Donoho, and H. Y. Gao (1996), Wavelet analysis, IEEE Spectrum Oct,
26-35.
A. Bryson, W. Denham, and S. Dreyfus (1963), Optimal programming problem with
inequality constraints. I: Necessary conditions for extremal solutions, AIAA 1. 1,
2544-2550.
J. Bunch, L. Kaufman (1980), A computational method for the indefinite quadratic
optimization problem, Linear Algebra and Its Applications 34, 341-370.
C. Burges (1996), Simplified support vector decision rules, in Proceedings ofthe ICML
'96, Bari, Italy.
C. Burges and B. Scholkopf (1997), Improving the accuracy and speed of support
vector machines, in Advances in Neural Information Processing Systems, Vol. 9,
The MIT Press, Cambridge, MA.
E P. Cantelli (1933). Sulla determinazione empirica della leggi di probabilita, G. Inst.
Ital. Attuari 4.
G. J. Chaitin (1966), On the length of programs for computing finite binary sequences,
1. Assoc. Comput Mach. 13, 547-569.
S. Chen, D. Donoho, and M. Saunders (1995), "Atomic Decomposition by Basis
Pursuit." Technical Report 479, Department of Statistics, Stanford University.

REFERENCES
725
N. N. Chentsov (1963), Evaluation of an unknown distribution density from observa-
tions, Soviet Math. 4, 1559-1562.
N. N. Chentsov (1981), On correctness of problem of statistical point estimation.
Theory Probab. Appl., 26,13-29.
V. Cherkassky and F. Mulier (1998), Learning from Data: Concepts, Theory, and
Methods, Wiley, New York.
V. Cherkassky, F. Mulier, and V. Vapnik (1996), Comparison of VC method with
classical methods for model selection, in Proceedings of the World Congress on
Neural Networks, San Diego, CA, pp. 957-962.
H. Chernoff (1952), A measure of asymptotic efficiency of test of a hypothesis based
on the sum of observations, Ann. Math. Stat. 23,493-507.
C. Cortes and V. Vapnik (1995), Support vector networks. Mach. Learn. 20, 1-25.
R. Courant and D. Hilbert (1953), Methods of Mathematical Physics, Wiley, New
York.
H. Cramer (1946), Mathematical Methods of Statistics, Princeton University Press.
Princeton, NJ.
p. Craven and H. Wahba (1979), Smoothing noisy data with spline functions: estimat-
ing the correct degree of smoothing by the method of generalized cross-validation,
Numer. Math. 31, 377-403.
G. Cybenko (1989), Approximation by superpositions of sigmoidal function. Math.
Control Signals Syst. 2, 303-314.
L. Devroye (1988), Automatic pattern recognition: A study of the probability of error,
IEEE Trans. Pattern Anal. Mach. Intel/. 10(4).530-543.
L. Devroye and L. Gyorfi (1985), Nonparametric Density Estimation: The L( View.
Wiley, New York.
L. Devroye, L. Gyorfi, and G. Lugosi (1996), A Probabilistic Theory of Pattern Recog-
nition, Springer, New York.
P. Diaconis and D. Freedman (1986), On the consistency of Bayesian Estimates (with
discussions), Ann. Stat. 14(1), 1-67.
H. Drucker (1997), Improving regression using boosting techniques. in Proceedings
of the International Conference on Machine Learning (ICML '97). D. H. Fisher.
Jr., ed., Morgan Kaufmann, San Mateo, CA, pp. 107-113.
H. Drucker, C. Burges, L. Kaufman, A. Smola. and V. Vapnik (1997), Support vector
regression machines, in Advances in Neural Information Processing Systems. Vol.
9, MIT Press, Cambridge, MA.
H. Drucker, R. Schapire, and P. Simard (1993), Boosting performance in neural net-
works, Int. J. Pattern Recognition Artif. Intel!. 7(4),705-719.
R. M. Dudley (1978), Central limit theorems for empirical measures, Ann. Probab.
6(6),899-929.
R. M. Dudley (1984), Course on Empirical Processes, Lecture Notes in Mathematics,
Vol. 1097, Springer, New York, pp. 2-142.
R. M. Dudley (1987), Universal Donsker classes and metric entropy, Ann. Probab.
15(4), 1306-1326.

726
REFERENCES
A. Dvoretzky, J. Kiefer, and J. Wolfovitz (1956), Asymptotic minimax character of a
sample distribution function and of the classical multinomial estimator, Ann Math.
Stat. 33, pp. 642-669.
H. W. Eng!, M. Hanke, and A. Neubauer (1996), Regularization of Inverse Problems,
Kluwer Academic Publishers, Hingham, MA, 318 pages.
R. A. Fisher (1952), Contributions to Mathematical Statistics, Wiley, New York.
Y. Freund and R. Schapire (1995), A decision-theoretic generalization of on-line learn-
ing and an application to learning, in Computational Learning Theory, Springer,
New York. pp. 23-37.
v: Fridman (1956), Methods of successive approximations for Fredholm integral equa-
tion of the first kind, Uspekhi Math. Nallk 11, 1 (in Russian).
J. H. Friedman (1991), Multivariate adaptive regression splines, Ann. Stat. (with dis-
cussion) 19, 1-141.
J. H. Friedman and W. Stuetzle (1981), Projection pursuit regression, JASA 76, 817-
823.
E. Gine and J. Zinn (1984), Some limit theorems for empirical processes. Ann. Probab.
12(4), 929-989.
F. Girosi (1998), An equivalence between sparse approximation and Support Vector
Machines, Neural Computation (to appear).
F. Girosi. Approximation error bounds that use VC bounds. in Proceedings of ICANN
'95. Paris, 1995.
F. Girosi and G. Anzellotti (1993). Rate of convergence for radial basis functions and
neural networks, Artificial Neural Networks for Speech and Vi!>ion, Chapman &
Hall, London, pp. 97-113.
v: I. Glivenko (1933), Sulla determinazione empirica di probabilita, G. Inst. Ital.
Attllari 4.
I. S. Gradshteyn and I. M. Ryzhik (1980), Table of Integrals, Series. and Products.
Academic Press. New York.
U. Grenander (1981), Abstract Inference, Wiley, New York.
J. Hadamard (1902). Sur les problemes aux derivees portielies et leur signification
physique, Bull. Univ. Princeton 13, 49-52.
D. Haussler (1992), Decision theoretic generalization of the PAC model for neural
nets and other learning applications, In! Comput. 100, 78-150.
T. J. Hestie anf R. J. Tibshirani (1990). Generalized Linear Models. Chapman and
Hall, London.
A. E. Hoerl and R. W. Kennard (1970), Ridge regression: Biased estimation for non-
orthogonal problems, Technometrics 12, 55-67.
P. Huber (1964), Robust estimation of location parameter, Ann. Math. Stat.. 35(1).
P. Huber (1985), Projection pursuit, Ann. Stat. 13,435-475.
W. Hurdlie (1990), Applied Nunparametric Regression, Cambridge: Cambridge Uni-
versity Press.
I. A. Ibragimov and R. Z. Hasminskii (1981), Statistical Estimation: Asymptotic The-
ory. Springer, New York.
v: v: Ivanov (1962), On linear problems which are not well-posed, Soviet Math. Dokl.
3(4),981-983.

REFERENCES
727
v. V. Ivanov (1976), The Theory ofApproximate Methods and Their Application to the
Numerical Solution ofSingular Integral Equations. Nordhoff International, Leyden.
W. James and C. Stein (1961), Estimation with quadratic loss, in Proceedings of the
Fourth Berkeley Symposium on Mathematical Statistics and Probabiity. Vol. 1, Uni-
versity of California Press, Berkeley, CA.
Th. Joachims (1998) Making large-scale SVM learning practical. In: B. Scholkopf. C.
Burges, A. Smola (eds.) Advances in Kernel methods-Support Vector Learning,
MIT Press, Cambridge, MA.
L. K. Jones (1992), A simple lemma on greedy approximation in Hilbert space and
convergence rates for projection pursuit regression. Ann. Stat. 20(1),608-613.
M. Karpinski and T. Werther (1989), VC dimension and uniform learnability of sparse
polynomials and rational functions, SIAM J. Compllt. (Preprint 8S37-CS. Bonn
University. 1989.)
M. Kearns and R. Schapire (1994), Efficient distribution-free learning of probabilistic
concepts, 1. Computer and System Sci. 48(3),464-497.
V. I. Kolchinskii (1981), On central limit theorem for empirical measures, Theory uf
Probability and Mathematical Statistics 2.
A. N. Kolmogorov (1933a), Sulla determinazione empirica di una leggi di distribuzione.
G. Inst. Ital. Attuari 4.
A. N. Kolmogorov (1933b), Grundbegriffe der Wahrscheinlichkeitsrechmmg, Springer.
Berlin. (English translation: A. N. Kolmogorov (1956). Foundation of the Theory
of Prohahility, Chelsea, New York.)
A. N. Kolmogorov (1965), Three approaches to the quantitative definitions of infor-
mation, Prob. Inf Transm. 1(1), 1-7.
A. N. Kolmogorov and S. V. Fomin (1970). Introductory Real Analysis. Prentice-Hall.
Englewood Cliffs, NJ.
M. M. Lavrentiev (1962), On Ill-Posed Problems of Mathematical Physics, Novosi-
birsk, SO AN SSSR (in Russian).
L. LeCam (1953), On some asymptotic properties of maximum likelihood estimates
and related Bayes estimates, Univ. Calif Public Stat. 11.
y. LeCun (1986), Learning processes in an asymmetric threshold network, Disordered
Systems and Biological Organizations. Springer. Les Houches. France, pp. 233-240.
Y. LeCun, B. Boser, J. S. Denker, D. Henderson, R. E. Howard, W. Hubbard. and
L. J. Jackel (1990), Handwritten digit recognition with back-propagation network,
in Advances in Neural Information Processing Systems, Vol. 2, Morgan Kaufman.
San Mateo, CA, pp. 396-404.
Y. LeCun, L. Bottou, Y. Bengio, and P. Haffner (1998), Gradient-based learning ap-
plied to document recognition, Proceedings of the IEEE. Special Issue on Intelli-
gent Signal Processing.
G. G. Lorentz (1966), ApprOXimation of Functions, Holt-Rinehart-Winston, New
York.
A. Luntz and V. Brailovsky (1969), On estimation of characters obtained in statistical
procedure of recognition, (in Russian) Technicheskaya Kibernetica. 3.
N. M. Markovich (1989), Experimental analysis of non-parametric estimates of a
probability density and methods for smoothing them. Autom. and Remote Contr.
7.

728
REFERENCES
P. Massart (1990). The tight constant in the Dvoretzky-Kiefer-Wolfowitz inequality,
Ann. Probab. 18, 1269-1283.
T. Mercer (1909), Functions of positive and negative type and their connection with
the theory of integral equations. Trans. Lond. Philos. Soc. A, 209,415-446.
H. N. Mhaskar (1993), Approximation properties of a multi-layer feed-forward arti-
ficial neural network, Adv. Comput. Math. 1,61-80.
C. A. Micchelli (1986), Interpolation of scattered data: Distance matrices and condi-
tionally positive definite functions, Constr. Approx. 2, 11-22.
S. G. Mikhlin (1964). Variational Methods of Mathematical Physics. Pergamon Press,
Oxford.
M. L. Miller (1990). Subset Selection in Regression, Chapman & Hall, London.
M. L. Minsky and S. A. Papert (1969), Perceptrons. MIT Press, Cambridge, MA.
J. E. Moody (1992), The effective number of parameters: An analysis of general-
ization and regularization in non-linear learning systems, in Advances in Neural
Information Processing Systems, Vol. 5, Morgan Kaufmann, San Mateo, CA.
1. J. More and G Toraldo (1991), On the solution of large quadratic programming
problems with bound constraints, SIAM Optim. 1(1).93-113.
S. Mukherjee, E Osuna, and F. Girosi (1997), Nonlinear prediction of chaotic time
series using support vector machines, in Proceedings of IEEE Conference Neural
Networks for Signal Processing, Amelia Island.
K. R. MUlier, A. J. Smola, G. Ratsch, B. Scholkopf, J. Kohlomorgen, and V Vapnik
(1997), Predicting time series with support vector machines, in Proceedings of the
1997 ICANN Conference.
B. Murtagh and M. Saunders (1978), Large-scale linearly constrained optimization.
Math. Program. 14,41-72.
A. B. J. Novikoff (1962), On convergence proofs on perceptrons, in Proceedings of
the Symposium on the Mathematical Theory of Automata, Vol. XII, Polytechnic
Institute of Brooklyn, pp. 615-622.
E. Osuna, R. Freund, and F. Girosi (1997a), Training support vector machines: An
application to face detection, in Proceedings 1997 IEEE Computer Society Confer-
ence on Computer Vision and Pattern Recognition, Computer Society, Los Alamos.
E. Osuna, R. Freund, and F. Girosi (l997b), Improved training algorithm for support
vector machines, in Proceedings of IEEE Conference Neural Networks for Signal
Processing, Amelia Island.
J. M. Parrondo and C. Van den Broeck (1993), Vapnik-Chervonenkis bounds for
generalization, J. Phys. A 26,2211-2223.
E. Parzen (1962), On estimation of probability function and mode, Ann. Math. Stat.
33(3).
D. Z. Phillips (1962), A technique for numerical solution of certain integral equation
of the first kind, J. Assoc. Comput. Mach. 9, 84-96.
1. 1. Pinsker (1979), The chaotization principle and its application in data analysis (in
Russian), in Models, Algorithms, Decision Making. Nauka, Moscow.
J. Platt (1998), Sequential minimal optimization: A fast algorithm for training support
vector machines. In: B. SchOlkopf, C. Burges, A. Smola (eds.) Advances in Kernel
Methods-Support Vector Learning. MIT Press, Cambridge. MA.

REFERENCES
729
T. Poggio and F. Girosi (1990), Networks for approximation and learning, Proc. IEEE,
78(9).
D. Pollard (1984), Convergence of Stochastic Processes, Springer, New York.
K. Popper (1968), The Logic of Scientific Discovery, 2nd ed., Harper Torch Book,
New York.
M. J. D. Powell (1992), The theory of radial basis functions approximation in 1990.
Advances in Numerical Analysis Volume I/: Wavelets, Subdivision Algorithms and
Radial Basis Functions, W. A. Light, ed., Oxford University. pp. 105-210.
J. Rissanen (1978), Modeling by shortest data description, Automatica 14,465-471.
J. Rissanen (1989), Stochastic Complexity and Statistical Inquiry, World Scientific.
H. Robbins and S. Monroe (1951), A stochastic approximation method, Ann. Math.
Stat. 22,400-407.
F. Rosenblatt (1962), Principles of Neurodynamics: Perceptron and Theory of Brain
Mechanisms, Spartan Books, Washington, DC.
M. Rosenblatt (1956), Remarks on some nonparametric estimation of density func-
tion, Ann. Math. Stat. 27, 642-669.
D. E. Rumelhart, G. E. Hinton, and R. J. Williams (1986), Learning internal rep-
resentations by error propagation. Parallel Distributed Processing: Explorations
in the Macrostructure of Cognition, Vol. I, Bradford Books, Cambridge. MA, pp.
318-362.
N. Sauer (1972), On the density of families of sets, J. Comb. Theory (A) 13, 145-147.
M. Saunders and B. Murtagh (1994), MINOS 5.4 User's Guide, Report SOL 83-20R,
Department of Operations Research, Stanford University (revised Feb. 1995).
R. E. Schapire, Y. Freund, P. Bartlett, and W. Sun Lee (1997), Boosting the margin:
A new explanation for the effectiveness of voting methods, in Machine Learning:
Proceedings of the Fourteenth International Conference, pp. 322-330.
B. SchOlkopf, A. Smola, and K. Muller (1997), Kernel principal component analysis,
in ICANN '97.
B. Scholkopf. P. Simard, A. Smola. and V. Vapnik (1998), Prior knowledge in support
vector kernels, in Advances in Neural Information Processing Systems, Vol. 10.
MIT Press, Cambridge, MA.
G. Schwartz (1978), Estimating the dimension of a model, Ann. Stat. 6,461-464.
J. Shao (1993), Linear model selection by cross-validation, J. Am. Stat. Assoc. Theory
and Methods 422.
S. Shelah (1972), A combinatorial problem: Stability and order of models and theory
of infinitary languages, Pacific J. Math. 41,247-261.
R. Shibata (1981), An optimal selection of regression variables, Biometrica 68. 461-
464.
A. N. Shiryayev (1984), Probability, Springer, New York.
P. Y. Simard, Y. LeCun, and J. Denker (1993), Efficient pattern recognition using a
new transformation distance, NeuralInf Processing Syst. 5, 50-58.
N. V. Smirnov (1970), Theory of Probability and Mathematical Statistics (Selected
Works), Nauka, Moscow (in Russian).
R. J. Solomonoff (1960), A Preliminary Report on General Theory of Inductive
Inference, Technical Report ZTB-138, Zator Company, Cambridge, MA.

730
REFERENCES
R. J. Solomonoff (1964), A formal theory of inductive inference, Parts 1 and 2, In!
Control 7, 1-22,224-254.
A. R. Stefanyuk (1986), Estimation of the likelihood ratio function in the "disorder"
problem of random processes, Autom. Remote Control 9, 53-59.
J. M. Steele (1978), Empirical discrepancies and subadditive processes, Ann. Probab.
6,118-127.
E. M. Stein (1970), Singular Integrals and Differentiability Properties of Functions,
Princeton University Press, Princeton, NJ.
J. Stewart (1976), Positive definite functions and generalizations, historical survey.
Rocky Mountain J. Math. 6(3),409-434.
C. Stone, M. Hansen, C. Kooperberg, and Y. Throung (1997), Polynomial splines and
their tensor products in extended linear modeling (with discussion). Ann. Stat. 25
(to appear).
W. Stute (1986), On almost sure convergence of conditional empirical distribution
function, Ann. Probab. 14(3),891-901.
M. Talegrand (1994), Sharper bounds for Gaussian and empirical processes, Ann.
Probab.22.
R. A. Tapia and J. R. Thompson (1978), Nonparametric Probability Density Estima-
tion, Johns Hopkins University Press, Baltimore.
A. N. Tikhonov (1943), On the stability of inverse problem, Dok/. Acad. Nauk USSR
39, 5 (in Russian).
A. N. Tikhonov (1963), On solving ill-posed problem and method of regularization,
Dok/. Akad. Nauk USSR 153, 501-504.
A. N. Tikhonov and V. Y. Arsenin (1977), Solution of Ill-Posed Problems. W. H.
Winston, Washington. DC.
E. C. Titchmarsh (1948), Introduction to Theory of Fourier Integrals. The Clarendon
Press, Oxford.
Ya. Z. Tsypkin (1971). Adaptation and Learning in Automatic Systems. Academic
Press, New York.
Ya. Z. Tsypkin (1973). Foundation ofthe Theory of Learning Systems, Academic Press,
New York.
M. Unser and A. Aldroubi (1992). Polynomial splines and wavelets, in Wavelets-A
Tlltorial in Theory and Applications, C. K Chui, ed., pp. 91-122.
L. Valiant (1984), A theory of the learnability, Commun. ACM 27,1134-1142.
R. Vanderbei (1994), LOQO: An Interior Point Code for Quadratic Programming,
Technical Report SOR-94-15.
A. W. van der Vaart and J. A. Wellner (1996), Weak Convergence and Empirical
Processes, Springer, New York
V. N. Vapnik (1979), Estimation of Dependencies Based on Empirical Data, Nauka,
Moscow (in Russian). (English translation: V. Vapnik (1982), Estimation of Depen-
dencies Based on Empirical Data, Springer, New York.)

REFERENCES
731
V. N. Vapnik (1988), Inductive principles of statistics and learning theory, in Year-
book of the Academy of Sciences of the USSR on Recognition. Classification, and
Forecasting (in Russian), Vol. 1, Nauka, Moscow. (English translation: V.N. Vapnik
(1995), Inductive principles of statistics and learning theory, in Mathematical Per-
spectives on Neural Networks, Smolensky, Mozer, and Rumelhart, eds., Lawrence
Erlbaum Associates.
V. N. Vapnik (1993), Three fundamental concepts of the capacity of learning machines,
Physica A 200, 538-544.
V. N. Vapnik (1995), The Nature of Statistical Learning Theory, Springer, New York.
V. N. Vapnik and L. Bottou (1993), Local Algorithms for Pattern Recognition and
Dependencies Estimation, Neural Comput. 5(6),893-908.
V. N. Vapnik and A. Va. Chervonenkis (1964), On one class of perceptrons, Autom.
and Remote Contr. 25(1).
V. N. Vapnik and A. Va. Chervonenkis (1968), On the uniform convergence of relative
frequencies of events to their probabilities, Soviet Math. Dokl. 9,915-918.
V. N. Vapnik and A. Va. Chervonenkis (1971), On the uniform convergence of relative
frequencies of events to their probabilities," Theory Probab. Appl. 16, 264-280.
V. N. Vapnik and A. Va. Chervonenkis (1974), Theory of Pattern Recognition, Nauka,
Moscow (in Russian). (German translation: W. N. Wapnik. A. Va. Tschervonenkis
(1979), Theorie der Zeichenerkennung, Akademia, Berlin.)
V. N. Vapnik and A. Va. Chervonenkis (1981), Necessary and sufficient conditions
for the uniform convergence of the means to their expectations, Theory Probab.
Appl. 26, 532-553.
V. N. Vapnik and A. Va. Chervonenkis (1989), The necessary and sufficient condi-
tions for consistency of the method of empirical risk minimization, Yearbook of the
Academy of Sciences ofthe USSR, on Recognition, Classification, and Forecasting,
Vol. 2, Nauka, Moscow, pp. 207-249 (in Russian). (English translation: V. N. Vap-
nik and A. Va. Chervonenkis (1991), The necessary and sufficient conditions for
consistency of the method of empirical risk minimization, Pattern Recogn. Image
Anal. 1(3),284-305.)
V. N. Vapnik, S. E. Golowich, and A. Smola (1997), Support vector method for func-
tion approximation, regression, and signal processing, in Advances in Neural In-
formation Processing Systems, Vol. 9, MIT Press, Cambridge, MA.
V. Vapnik and A. Lerner (1963) Pattern recognition using generalized portrait method.
Autom. Remote Control. 24.
V. Vapnik, E. Levin, and Y. LeCun (1994), Measuring the VC Dimension of a Learning
Machine, Neural Computation 10(5).
V. N. Vapnik, N. M. Markovich, and A. R. Stefanyuk (1992). Rate of convergence in
L 2 of the projection estimator of the distribution density. Awom. Remote Control
5.
V. N. Vapnik and A. R. Stefanyuk (1978), Nonparametric methods for estimating
probability densities, Autom. Remote ControlS.
V. N. Vapnik and A. M. Sterin (1977), On structural risk minimization of overall risk
in a problem of pattern recognition, Autom. Remote Control 10.
M. Vidyasagar (1997), A Theory of Learning and Generalization with Application to
Neural Networks and Control Systems, Springer, New York.

732
REFERENCES
V. Vovk (1992), Universal forecasting algorithms, Information and Computation 96(2)
245-277.
B. von Bahr and G. G. Essen (1965), Inequalities for rth absolute moment of a sum
of random variables, 1 < r:S 2, Ann. Math. Stat. 36(1),299-303.
G. Wahba (1990), Spline Model for Observational Data, Society for Industrial and
Applied Mathematics, Philadelphia.
C. S. Wallace and D. M. Boulton (1968), An information measure for classification,
Comput. J. 11, 185-195.
G. Watson (1964), Smooth regression analysis, Sankhya, Series A (26),359-372.
RS. Wenocur and R M. Dudley (1981), Some special Vapnik-Chervonenkis classes,
Discrete Math. 33, 313-318.
J. Weston, A. Gammerman, M. Stitson, V. Vapnik and V. Vovk (1998) Density esti-
mator using support vector machines. In: B. Scholkopf, C. Burges, A. Smola (eds.)
Advances in Kernel Methods-Support Vector Learning. MIT Press, Cambridge,
MA.
D. H. Wolpert (1995), The relationship between PAC, the statistical physics frame-
work, the Bayesian framework, and the VC framework, in Mathematics of Gen-
eralization, Proceedings Santa Fe Institute Studies of Complexity, Volume XX.
Addison-Wesley Publishing Company.

AdaIl<>o$I. 557
Admissible """"UTeS. 221
Algorithmic <omple,ily. 224
Annealed conopy:
for indicator functio"". 118. 129. 137. 537
(0< real-valued function.. 191
ANOVA dcrompoosition. 471
A posteriori probability, 700
A priori information. 506
AppfOJlImation rate, 235
Averaging methods, 703. 704
Axiom' of probability tl>c:ory, 60
Back.propagation. 395
Bagging. 557
Barh·Essen'.-EMen inequality. lOS
Basic ''''''1n,til;.S for indicator funclion!l:
ge""ral case, 137
pe..imi'lic c..... 129
B..ic inequall'i.. for real-valued function"
general """, 1%
pessimistic case, 192
ao.ic lemma. 132. 573
B••k problem of mathematical.18ti<tics, 62
Baok problem of probability theory. 62
Bayes rule. 37
Bay""ian inference, 700-7(1)
Baye.ian mategy. 170
Bern.teiD theorem. 251
Be., point of the sel. 367. 370
B~'"l'hne, 4<j6
INDEX
Bothncr\ Ihem-em, 433
Boosting, 512
Borel-Clnlelli lemma. 41
Borel's "'•. 63
Bound' on risk:
for function eSlimation. 193, 197, 212-217
for [IIltlern r.cognilion, no, 138, 148
Br.tagnolle-Huber in.qualily, 30
Canoni",,1 hyperplan., 412
Canonical slrUC1ure, 604
ChenlSQ~'s Iheorem. 66
Chernoff's inequalily, 94, 123
ChrisIOff.l-Darboux formula, 461
Choosing Ih. degr•• of polynomial. 525
Cod<: book. 225
Complel...mplt, 340
Compk:ltly conlinuous op<ral<:>r, 52
C01tIplcltly monotO!1it funclion, 434
Compr.ssion Coefficienl, 2Z5
Condilioo.1 disUibution, 20
Condil;.".,.1 probability .slimal;""', 36. 39.
337, 4l:l4
Condil;.,n,,1 density e"im'lion. 39, 333, 4118
Coosislency, 49.!IO. 305
of the .1rlltIUr.1 risk minimization melhod,
m
Consistency:
nonlri~ial, 82
micl. 85. 88, 92. Su abo 1>OO1rivial
Iri~i.l, 80

734
INDEX
C"r,.o'lo"",,:
almOIn 'urely. 40
in probabilily. 40
Corridor. (1.12
Cr....·l.<;mcl. 4n
Cunc (If dimensi"".lit~.251
tk<luclive ",.._ins. 106
tk...i1y estlm.lIon.
2~. JO. 34.
3~. JII. oil!.
295. lOS. 3OlI. 319.•'N. 4lIJ
Dem,,"',,"o" problem. 106
Diclion"f)' melhod. 719
Digil recosn"ion. 49'6. ~Il
DiteCl ""lIlng. :J6
Di,ichlct
~c.....,l. N9
Di",rimlnan\ :mal~sis. 711
hnesr, 712
DOll"buhon,
rondiuonal. 20
)OI.... :!II,24
DulII \fl'Ite. 404
Early Sloppi"'l, Il'lO
Empllle.1 d"lribulion. ~,36
Empiriclll me"""". 63. M
l:mpine.1 nsk funnionlll JJ.:14
Empirical ri,k mirumizllllOn. J2. 48. 82, lIIl
Empirical proceS5:
one-sided. 86. 114. 116
1...·,Hided. R6
Entr"JI~ of a ""I of e'enl'. 576
Enlr"JI~ '" a ""I of indical'" fU'lCliom. '11
Enlropy (If a ..I of ,eal·."lued funelion..
"
En.elope. 101. IllJ
• enlrtlf>r. 'J9. ~'1i
.·Ul
..,." 6lII'I
.-nct
k, 99
fiMe.'J9
mi",m,,1. 99
proJ'C,.5"'''
,elali'e.598
,·in""""li•• 00 funellon. 44J
Equi,.lon<c cia."".. J.l4. 350. 359
E.I;mou,,,,.
0' oont!,lional densily. 39. 333, 4I!lI
'"wn.dllioo.al p.obabilily. :J6. 39. 337,.1\4
8t1mlltoon ,ol'lunction values a"i,'<" 1"''''1$.
3-'0, 36J. 365
Uti""'.",. 62
dl«uvc.445
u"tu""d, 445
EII.ell"e numbor (If pa..""'t.... ~31
Ev.n,.6O
E:lpcCl.d lou. 23
E:lpcCled riot. 28
"estun: ...I«t...... ~26
Fealurc >pote. 376. 421
Fe,.. ke.ncl 249. 471)
Fefmal~ IlKon:m•.wo
Finne 1'I'e&IIOn Em... :'\!4
Fishc...Wald :lOIl,nl. II
Forward ,"epw,"" r.alu"" ""lert;"" ""'Ihod..
""
ro."",,, k.·.neJ. .K>II
Frtdbolm inlegral <'1"ali"". 4~
frequency. 62
Funn"", .pproxim.lion. 248. 54l
G,,_n m'.llu.e. 4lll
C-",nerallcami", model. 19.20
Gencfll~,ed<roo>.-..Ildal""'. ~24
GencralUc"tl Gli"enko-CanlcUi t""Ofen,. 72.
142
Ge...ralized """"lh lunetlnn. 217
GellC••li,ed opI,mal hy·pc'plII.... @
Gliwnk.....Ca"'elii lhc<>rcm.41. 71
Growlh ImlCllOl1. 1111. 145. ~37
Hard margio. 40Il
lIard·lh'eohold
"iclllll~ rU'lClion. 259
Ile.m;le p;>Iyntlmi.I•. 462. 4(;3
Hidden layeR. 3111
Hoefftllnl', IllCqUllli,y. 1115
Hul'Cr ~ ju...,,,,,,. 44(,. 441. 4411. 453. 4511
H,,~r I"""'<m. 4n
ld<:nlific.I....... 21
l<lc:nl,flClll"", p'ohlcrn..\7
111·"'.....<1 prubkm.•5
lmil~tlon. 21
In<kp,,n<knt t,ial. 60
1n.d...ttJr funetion. 25
rndi",e' me.,,,.in,. 28. 271
In.dUCllon pri...ipk, .12, 48. 73
In.dueuvt: ,euoning. 106
Inne, prodUCl io Hilbc" ~paec. 423
lnleval <'lllalion. 311
lnvarillnl p""",rt;"~. 516
Jackson ~".ncL 410
Jacbon IM",.m. 250
Jcnocn 'nc<j...Jiry, JO
Joi"t di,"ibut""'. roo N
K_nen..' ncighhon. 261.:\ClS
K"nt'! <kmarcillon I"ublem. 107

IW.....I "","",,y ""....wn. 31"
Kc_1I lor ANOVA dcaIm"..n-. H2
""
II~
B~ 468
IW.
II
""ubrized Fooril:. u·
I""
..$6l, <I6'J
K~...... t"ntnUot ~
• rtll • /in,le _M. <II ~ <161
...u. an inIinolC .1IOIIbr. 01 bMIu. ~
KollflOlOl....-Sm;._ d............. 42. 328
K......~"TUck~r.
lheorem. :W3
rond~ion. l'M. 010$. 411
.....~"'ng~ mllhlpl~". :WI. <104. 410. 45(1
l...oI......1\.. :W3. J').l. 410
La. 0I1.o.~ ......be... 87
La.. 01 Lbc i1~n'~d Losamhra..:I•.l28
/..-<'UfVC. sn
Lo......' from ~
mplcs. 19
1.....tBinl
ad"
20
~toM
res IDCIIood..w
Love.....,
aumalOr.• If>
Le~ lIoeor'e-. "
LeSe\. SII-SI2. 7U
u.~s_QI
).210
l.oIc•• de,__
llO. SN __ sqIIOnl.
in,. hypetpla....
LrDea. 6-'''''''''r-nbilirl-- 407
Local .llO"lhm. 363. J6S
Loc.l a"",,,,um••,,,,,. 21>1
Local rio.k fw>cI"""'i. 260
Local riJk
min,m~'lion. 2S7
u..
fll"'I~"'. 23. 28. 2'1. J2
M.,I pnnciple for inr~.cfl'C from Imln ~m·
..... "
Ma'Jll\.. ..m
M..m.
Iikdihood IKlhocl 92.lJ6. 660
M
marlin ..,.".,tpla>oc. SN ope"",,1
h)pctpbne.
"l.................. oca.... 1lJIl
~1'i11J model 01 .......-, 6llS 69)
Mcrw• ......,....13
M"'-u .... M"'~D. 110. 177
M..._
duaifll_ 10111'''' 224. UI. 69B
M__ ... ............ 22-0. 698
MookI ...~S21
MOOutuo <II.....-y. lS<I
MlI~l<l..$ dll...fiau-. -037
M"llila)~r
~rttplr .... J9S
Mul.lplical'v, Cb:rn<>IrJ '.........Iny. 127
Mulllv.nani adapt..., """,...on 5f'~"" (MA RS).
SSII. 719
NCM.al nel""Ofl<. SH .,.., MuIr_1'" ~••
....-
SV ....._. m. -on. 461."
NI$T. dota"-'. SII
l'I"'~.IOlI
....... ".
pol~lIIoal 110
Nonr-nme'''' de"""y ..._.""'
r.r~~n" eMinI........ D. '"ltI
.....""'" alm.aun. J)). )18
spline eSlimalon. ) I). ) 14. 480
Nomcpa.able "'11. 40lI
N....'kotrllhcor~m. 377. 3llll, 414. 6!f.S
Occam'lnzor principle. 10,698
Omcp ......" S1.lalia.. 4)
Ope.al'" 0:","'1I0Il. SI
1,,,,,••• 472
Opt""•• byf"CfpbllC. «l2.G, -012. -o)j. <f'J3
Oochnlry Ln>! Squara. SN It". "l"I'U
_....
0ut1M:n. 21S
(M::... rM
fllflClloOlll..O~ ~
I'aniII =1'•• """""'IC-. 69, n, 78
r•.--
on.lOll. oI&S
r.ll~rn
2.,~,.Q. 82. 261. ot93
~""'plron.
J7~
Pulyl"" apJJrQ>:IDlI'_ <If ....ribuI"'" f"",·
1101\.. 316
PoIy""",i11I:
kernel. 460
SV m",h,ne, 4JO. 460.•Yll, S11
Poppe... "";'or""'. 107
Poo,I,vC
do<linil~ IlIncl""'. 433
Po<lttOn u,~ lornoc'.phy, SSlI
1'0>1,1 tip (:(ll;Ia. 4%
Pulcmilll t.-.ur.. 387
Pr,...1'f'K'C• .aot
l"ruWbiIrt)' deuy.)j
PrMMilrty clioornw.... :u. 61
~J
.60.62
Pro,tttooa run- me.hod. 11'
....... ,.
fHI
f'rubIU· '"
~ 60
o.-tnhc.....1"'" fI"Ob'om. -0'3, '"'16
.".,..,..""
R...bol boo... funCl..-, 387. J89
SV m",hi"". 4)1. 460, 4<18. S03
RlId<'" equoI""". S60
R_......"" ••,i.bIc.60

736
INDEX
Random e~lrop)' of. ocl of indicalor func:·
liom. 96
Random, enl'opy. ~
Rale 0( _W,n.inlal;on. 23~. 240. 247
R.te of converge""e. 49. 319 <ce aloo RLe
of awrox!malion
Rale 0( "",,·sided unifOfm ronvc'le""e. 192.
m
Ibleofl.............d ....tform """ve'lo""e. lJO.
",
R.le of relat;"'e uoiform c"rIVe'le....,. 137.
148. 197. 200. 216. 34~. 347
Ratio of demllio. e'limalion. 2'15, 330. 334
Re"e.."", estimation. 24. 20. 34. 48, 82,
237. 2tl2. 549
Re~ro"lon fU""lion. 26
Regul.ri7.alion melhod, 47. Sol, m, 477
Rogul.,izlIl"'" parameter, ~~. 327. 531. 539
Regula'izet,55
Ropruduci.. kcrn<'lliilbcn "pKe, 490
R~...1pr",,:iple. 478
Rodge reifCS'ion. ~31. ~39
R..k,23
R..k !"""tional. 23
....,.1. 260
Robu't
<lcnsil~, 446
Robu"
rcgrc..ion. 4.w
eSl,m'I..,.-.446
Saddle puiol. J9.I
Sample <clccllon. 214. 3S5. Jl>2
Schefl"e's thcc«:m. 68
Sct>oxnbc,g tlle..,.-cm. 434
srn.wart>. crileria. 524
Seleel"'" vI SVM. 428
Scmilncal .ppr".im'lIon. 161
Separable "'1'" 401
Sep"..li08
h~pc,,,Ia,,,,. 316
Sel of jot];ca',,". 1110
Sh.U.ring. 147
Shibal." m."I<I ..,""ct(lf. S24
Sic.. method. M7
..··lJebra.60
S,&f'1OId ful>Clion. 3llS
Sim"""l !.."",ion e>l;m.llOn model. 18J
S,mpk.1 pall'"''
teCOf,~ition model.
le""..1c....c. 127-129
opllmlSlic "">c, IB-127
peM',m'<lic: ca><:. 122-124
SI.I't rondi.,on. J9.I
Sml""", dlSl,ih<'1ion, 43. 328
SmooIIu", pa,amel.. f", density estima·
Iors, 327
SmooIh..... ch..'eterlslicl. 252. 253. 257
Sobolcv_Liouvilie .""ce. 2SlI
Sofl ma,gin. 411
Sofl.lhrcsbold vicintly 'uncllOn. 2S9
Sp,..., .pproxim,tion, 4S9
Sr-nc poIynumials:
altcbr.ic. ~IS. SJO
In......''''elnc. no
SpllllC. 313.479. SoIol
Stable IoOfUlion. 44. 52
St""Ila'lic ,,,,,",,,im"""'. 3Il4
Si""h"lic II1,poocd problcm. 47. 29S
Sloppins ,ule. 378
51""'lur.1 ri.k min,mw"ion. 221. 223. 2211.
268. 343
Sl"""t""'. 221
SupcNISOI",20
Su"",," "«lor m,ch'lle. S« S"I'P"" Vec·
lor ""'lhod
Support "ector mClhod. 415. 4.$4. 4n. olS'I,
Sol3,~
SUP!"'" vec'",S. 406. 413. 449
t~nli"). 413. 698
TaB•. 2IU
T.nlc~1 di
....,. 506, 51~. 716
Tensor prod
s. 462
Training sample-, .Jolt, Jj6
Tfalrunll "''1'''''''''. J56
T""inin,l ..,1. 20
T,.mduc,i.e .nre,e....,. 339. JSS. 43'1. 518
n.'o-laye, ""urnl SV n,.chines. 432
Uni!.....m ""nlral hmn Ihcorcm.li'I-I
Unir."". """"e'~"""
"",,-"<lcd. 86. t>2Il
lwo-<idcd. 87, m
Uni/ann I.... of la'l( numbers. S7
U.s. Pool.l Ser>'icc d'gil l.la,ahasc. 4%
V(" dimcnslOO. 147. I~S-16J. 254. 413. SOO
ef'eclive, 531. 540
r", rcal·..I""d ful>Cliono, 191
VC <u"st.ph. (HI
Vicinl1y function. l59
Wllson-Nld,,,ayo e..,m.lor. 261
WeU·p<JllCd probk:m. «. 53
w",ki,,! ..mple. .JoI1 . J57

