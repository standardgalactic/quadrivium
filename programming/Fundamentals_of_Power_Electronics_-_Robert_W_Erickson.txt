
Fundamentals of 
Power Electronics 
SECOND EDITION 

Fundamentals of 
Power Electronics 
SECOND EDITION 
Robert W. Erickson 
Dragan Maksimovic 
University of Colorado 
Boulder, Colorado 

Distributors for North, Central and South America: 
Kluwer Academic Publishers 
10 I Philip Drive 
Assinippi Park 
Norwell, Massachusetts 02061 USA 
Telephone (781) 871-6600 
Fax (781) 871-6528 
E-Mail <kluwer@wkap.com> 
Distributors for all other countries: 
Kluwer Academic Publishers Group 
Distribution Centre 
Post Office Box 322 
3300 AH Dordrecht, THE NETHERLANDS 
Telephone 31 78 6576 000 
Fax 31 78 6576 254 
E-Mail services@wkap.nl> 
.... 
. 
. 
'' 
Electromc Servtces <http://www.wkap.nl> 
Library of Congress Cataloging-in-Publication 
Erickson, Robert W. (Robert Warren), 1956-
Fundarnentals of power electronics I Robert W. Erickson, Dragan Maksimovic.--znd ed. 
p. em. 
Includes bibliographical references and index. 
ISBN 978-1-4757-0559-1 
ISBN 978-0-306-48048-5 (eBook) 
DOI 10.1007/978-0-306-48048-5 
I. Power electronics. I. Maksimovic, Dragan, 1961- II. Title. 
TK7881.15 .E75 2000 
621.381--dc21 
Copyright© 2001 by Kluwer Academic Publishers. Sixth Printing 2004. 
00-052569 
Cover art Copyright © 1999 by Lucent Technologies Inc. All rights reserved. Used with 
permission. 
Softcover reprint of the hardcover 2nd edition 2001 978-0-7923-7270-7 
All rights reserved. No part of this publication may be reproduced, stored in a retrieval system or 
transmitted in any form or by any means, mechanical, photo-copying, recording, or otherwise, 
without the prior written permission of the publisher, Kluwer Academic Publishers, 101 Philip 
Drive, Assinippi Park, Norwell, Massachusetts 02061 
Printed on acid-free paper. 

Dedicated to 
Linda, William, and Richard 
Lidija, Filip, Nikola, and Stevan 

Contents 
Preface 
1 
I 
2 
3 
Introduction 
1.1 
Introduction to Power Processing 
1.2 
1.3 
Several Applications of Power Electronics 
Elements of Power Electronics 
References 
Converters in Equilibrium 
Principles of Steady State Converter Analysis 
2.1 
2.2 
2.3 
2.4 
2.5 
2.6 
Introduction 
Inductor Volt-Second Balance, Capacitor Charge Balance, and the Small-Ripple 
Approximation 
Boost Converter Example 
Cuk Converter Example 
Estimating the Output Voltage Ripple in Converters Containing Two-Pole 
Low-Pass Filters 
Summary of Key Points 
References 
Problems 
Steady-State Equivalent Circuit Modeling, Losses, and Efficiency 
3.1 
The DC Transformer Model 
3.2 
Inclusion of Inductor Copper Loss 
3.3 
Construction of Equivalent Circuit Model 
xix 
1 
7 
9 
11 
13 
13 
15 
22 
27 
31 
34 
34 
35 
39 
39 
42 
45 

viii 
Contents 
3.3.1 
Inductor Voltage Equation 
46 
3.3.2 
Capacitor Current Equation 
46 
3.3.3 
Complete Circuit Model 
47 
3.3.4 
Efficiency 
48 
3.4 
How to Obtain the Input Port of the Model 
50 
3.5 
Example: Inclusion of Semiconductor Conduction Losses in the Boost 
Converter Model 
52 
3.6 
Summary of Key Points 
56 
References 
56 
Problems 
57 
4 
Switch Realization 
63 
4.1 
Switch Applications 
65 
4.1.1 
Single-Quadrant Switches 
65 
4.1.2 
Current-Bidirectional Two-Quadrant Switches 
67 
4.1.3 
Voltage-Bidirectional Two-Quadrant Switches 
71 
4.1.4 
Four-Quadrant Switches 
72 
4.1.5 
Synchronous Rectifiers 
73 
4.2 
A Brief Survey of Power Semiconductor Devices 
74 
4.2.1 
Power Diodes 
75 
4.2.2 
Metal-Oxide-Semiconductor Field-Effect Transistor (MOSFET) 
78 
4.2.3 
Bipolar Junction Transistor (BJT) 
81 
4.2.4 
Insulated Gate Bipolar Transistor (IGBT) 
86 
4.2.5 
Thyristors (SCR, GTO, MCT) 
88 
4.3 
Switching Loss 
92 
4.3.1 
Transistor Switching with Clamped Inductive Load 
93 
4.3.2 
Diode Recovered Charge 
96 
4.3.3 
Device Capacitances, and Leakage, Package, and Stray Inductances 
98 
4.3.4 
Efficiency vs. Switching Frequency 
100 
4.4 
Summary of Key Points 
101 
References 
102 
Problems 
103 
5 
The Discontinuous Conduction Mode 
107 
5.1 
Origin of the Discontinuous Conduction Mode, and Mode Boundary 
108 
5.2 
Analysis of the Conversion Ratio M(D,K) 
112 
5.3 
Boost Converter Example 
117 
5.4 
Summary of Results and Key Points 
124 
Problems 
126 
6 
Converter Circuits 
131 
6.1 
Circuit Manipulations 
132 
6.1.1 
Inversion of Source and Load 
132 
6.1.2 
Cascade Connection of Converters 
134 
6.1.3 
Rotation of Three-Terminal Cell 
137 

Contents 
ix 
6.1.4 
Differential Connection of the Load 
138 
6.2 
A Short List of Converters 
143 
6.3 
Transformer Isolation 
146 
6.3.1 
Full-Bridge and Half-Bridge Isolated Buck Converters 
149 
6.3.2 
Forward Converter 
154 
6.3.3 
Push-Pull Isolated Buck Converter 
159 
6.3.4 
Fly back Converter 
161 
6.3.5 
Boost-Derived Isolated Converters 
165 
6.3.6 
Isolated Versions of the SEPIC and the Cuk Converter 
168 
6.4 
Converter Evaluation and Design 
171 
6.4.1 
Switch Stress and Utilization 
171 
6.4'.2 
Design Using Computer Spreadsheet 
174 
6.5 
. Summary of Key Points 
177 
References 
177 
Problems 
179 
II Converter Dynamics and Control 
185 
7 
AC Equivalent Circuit Modeling 
187 
7.1 
Introduction 
187 
7.2 
The Basic AC Modeling Approach 
192 
7.2.1 
Averaging the Inductor Waveforms 
193 
7.2.2 
Discussion of the Averaging Approximation 
194 
7.2.3 
Averaging the Capacitor Waveforms 
196 
7.2.4 
The Average Input Current 
197 
7.2.5 
Perturbation and Linearization 
197 
7.2.6 
Construction of the Small-Signal Equivalent Circuit Model 
201 
7.2.7 
Discussion of the Perturbation and Linearization Step 
202 
7.2.8 
Results for Several Basic Converters 
204 
7.2.9 
Example: A Nonideai Flyback Converter 
204 
7.3 
State-Space Averaging 
213 
7.3.1 
The State Equations of a Network 
213 
7.3.2 
The Basic State-Space Averaged Model 
216 
7.3.3 
Discussion of the State-Space Averaging Result 
217 
7.3.4 
Example: State-Space Averaging of a Nonideal Buck-Boost Converter 
221 
7.4 
Circuit Averaging and Averaged Switch Modeling 
226 
7.4.1 
Obtaining a Time-Invariant Circuit 
228 
7.4.2 
Circuit Averaging 
229 
7.4.3 
Perturbation and Linearization 
232 
7.4.4 
Switch Networks 
235 
7.4.5 
Example: Averaged Switch Modeling of Conduction Losses 
242 
7.4.6 
Example: Averaged Switch Modeling of Switching Losses 
244 
7.5 
The Canonical Circuit Model 
247 
7.5.1 
Development of the Canonical Circuit Model 
248 

x 
Contents 
7.5.2 
Example: Manipulation of the Buck-Boost Converter Model 
into Canonical Form 
250 
7.5.3 
Canonical Circuit Parameter Values for Some Common Converters 
252 
7.6 
Modeling the Pulse-Width Modulator 
253 
7.7 
Summary of Key Points 
256 
References 
257 
Problems 
258 
8 
Converter Transfer Functions 
265 
8.1 
Review of Bode Plots 
267 
8.1.1 
Single Pole Response 
269 
8.1.2 
Single Zero Response 
275 
8.1.3 
Right Half-Plane Zero 
276 
8.1.4 
Frequency Inversion 
277 
8.1.5 
Combinations 
278 
8.1.6 
Quadratic Pole Response: Resonance 
282 
8.1.7 
The Low-Q Approximation 
287 
8.1.8 
Approximate Roots of an Arbitrary-Degree Polynomial 
289 
8.2 
Analysis of Converter Transfer Functions 
293 
8.2.1 
Example: Transfer Functions of the Buck-Boost Converter 
294 
8.2.2 
Transfer Functions of Some Basic CCM Converters 
300 
8.2.3 
Physical Origins of the RHP Zero in Converters 
300 
8.3 
Graphical Construction of Impedances and Transfer Functions 
302 
8.3.1 
Series Impedances: Addition of Asymptotes 
303 
8.3.2 
Series Resonant Circuit Example 
305 
8.3.3 
Parallel Impedances: Inverse Addition of Asymptotes 
308 
8.3.4 
Parallel Resonant Circuit Example 
309 
8.3.5 
Voltage Divider Transfer Functions: Division of Asymptotes 
311 
8.4 
Graphical Construction of Converter Transfer Functions 
313 
8.5 
Measurement of AC Transfer Functions and Impedances 
317 
8.6 
Summary of Key Points 
321 
References 
322 
Problems 
322 
9 
Controller Design 
331 
9.1 
Introduction 
331 
9.2 
Effect of Negative Feedback on the Network Transfer Functions 
334 
9.2.1 
Feedback Reduces the Transfer Functions 
from Disturbances to the Output 
335 
9.2.2 
Feedback Causes the Transfer Function from the Reference Input 
to the Output to be Insensitive to Variations in the Gains in the 
Forward Path of the Loop 
337 
9.3 
Construction of the Important Quantities 11( 1 + T) and Tl( 1 + T) 
and the Closed-Loop Transfer Functions 
337 
9.4 
Stability 
340 

9.4.1 
The Phase Margin Test 
9.4.2 
The Relationship Between Phase Margin 
and Closed-Loop Damping Factor 
9.4.3 
Transient Response vs. Damping Factor 
9.5 
Regulator Design 
9.5.1 
Lead (PD) Compensator 
9.5.2 
Lag (PI) Compensator 
9.5.3 
Combined (P/D) Compensator 
9.5.4 
Design Example 
9.6 
Measurement of Loop Gains 
9.6.1 
Voltage Injection 
9.6.2 
Current Injection 
9.6.3 
Measurement of Unstable Systems 
9.7 
Summary of Key Points 
References 
Problems 
10 
Input Filter Design 
10.1 
Introduction 
10.1.1 
Conducted EMI 
10.1.2 
The Input Filter Design Problem 
10.2 
Effect of an Input Filter on Converter Transfer Functions 
10.2.1 
Discussion 
10.2.2 
Impedance Inequalities 
10.3 
Buck Converter Example 
10.3.1 
Effect of Undamped Input Filter 
10.3.2 
Damping the Input Filter 
10.4 
Design of a Damped Input Filter 
10.4.1 
RrCb Parallel Damping 
10.4.2 
RrLb Parallel Damping 
10.4.3 
RrLb Series Damping 
10.4.4 
Cascading Filter Sections 
10.4.5 
Example: Two Stage Input Filter 
10.5 
Summary of Key Points 
References 
Problems 
Contents 
xi 
341 
342 
346 
347 
348 
351 
353 
354 
362 
364 
367 
368 
369 
369 
369 
377 
377 
377 
379 
381 
382 
384 
385 
385 
391 
392 
395 
396 
398 
398 
400 
403 
405 
406 
11 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
409 
11.1 
DCM Averaged Switch Model 
11.2 
Small-Signal AC Modeling of the DCM Switch Network 
11.2.1 
Example: Control-to-Output Frequency Response 
of a DCM Boost Converter 
11.2.2 
Example: Control-to-Output Frequency Responses 
of a CCM/DCM SEPIC 
410 
420 
428 
429 

xii 
Contents 
11.3 
High-Frequency Dynamics of Converters in DCM 
11.4 
Summary of Key Points 
References 
Problems 
12 
Current Programmed Control 
12.1 
Oscillation forD> 0.5 
12.2 
A Simple First-Order Model 
12.2.1 
Simple Model via Algebraic Approach: Buck-Boost Example 
12.2.2 
Averaged Switch Modeling 
12.3 
A More Accurate Model 
12.3.1 
12.3.2 
12.3.3 
12.3.4 
12.3.5 
12.3.6 
Current-Programmed Controller Model 
Solution of the CPM Transfer Functions 
Discussion 
Current-Programmed Transfer Functions of the CCM Buck Converter 
Results for Basic Converters 
Quantitative Effects of Current-Programmed Control 
on the Converter Transfer Functions 
12.4 
Discontinuous Conduction Mode 
12.5 
Summary of Key Points 
References 
Problems 
III Magnetics 
13 
Basic Magnetics Theory 
13.1 
Review of Basic Magnetics 
13.1.1 
Basic Relationships 
13.1.2 
Magnetic Circuits 
13.2 
Transformer Modeling 
13.2.1 
The Ideal Transformer 
13.2.2 
The Magnetizing Inductance 
13.2.3 
Leakage Inductances 
13.3 
Loss Mechanisms in Magnetic Devices 
13.3.1 
Core Loss 
13.3.2 
Low-Frequency Copper Loss 
13.4 
Eddy Currents in Winding Conductors 
13.4.1 
Introduction to the Skin and Proximity Effects 
13.4.2 
Leakage Flux in Windings 
13.4.3 
Foil Windings and Layers 
13.4.4 
Power Loss in a Layer 
13.4.5 
Example: Power Loss in a Transformer Winding 
13.4.6 
Interleaving the Windings 
13.4.7 
PWM Waveform Harmonics 
431 
434 
434 
435 
439 
441 
449 
450 
454 
459 
459 
462 
465 
466 
469 
471 
473 
480 
481 
482 
489 
491 
491 
491 
498 
501 
502 
502 
504 
506 
506 
508 
508 
508 
512 
514 
515 
518 
520 
522 

Contents 
xiii 
13.5 
Several Types of Magnetic Devices, Their B-H Loops, 
and Core vs. Copper Loss 
525 
13.5.1 
Filter Inductor 
525 
13.5.2 
AC Inductor 
527 
13.5.3 
Transformer 
528 
13.5.4 Coupled Inductor 
529 
13.5.5 
Flyback Transformer 
530 
13.6 
Summary of Key Points 
531 
References 
532 
Problems 
533 
14 
Inductor Design 
539 
14.1 
Filter Inductor Design Constraints 
539 
14.1.1 
Maximum Flux Density 
541 
14.1.2 
Inductance 
542 
14.1.3 
Winding Area 
542 
14.1.4 
Winding Resistance 
543 
14.1.5 
The Core Geometrical Constant Kg 
543 
14.2 
A Step-by-Step Procedure 
544 
14.3 
Multiple-Winding Magnetics Design via the Kg Method 
545 
14.3.1 
Window Area Allocation 
545 
14.3.2 
Coupled Inductor Design Constraints 
550 
14.3.3 
Design Procedure 
552 
14.4 
Examples 
554 
14.4.1 
Coupled Inductor for a Two-Output Forward Converter 
554 
14.4.2 
CCM Fly back Transformer 
557 
14.5 
Summary of Key Points 
562 
References 
562 
Problems 
563 
15 
Transformer Design 
565 
15.1 
Transformer Design: Basic Constraints 
565 
15.1.1 
Core Loss 
566 
15.1.2 
Flux Density 
566 
15.1.3 
Copper Loss 
567 
15.1.4 
Total Power Loss vs. till 
568 
15.1.5 
Optimum Flux Density 
569 
15.2 
A Step-by-Step Transformer Design Procedure 
570 
15.3 
Examples 
573 
15.3.1 
Example 1: Single-Output Isolated Cuk Converter 
573 
15.3.2 Example 2: Multiple-Output Full-Bridge Buck Converter 
576 
15.4 
AC Inductor Design 
580 
15.4.1 
Outline of Derivation 
580 
15.4.2 
Step-by-Step AC Inductor Design Procedure 
582 

xiv 
Contents 
15.5 
Summary 
583 
References 
583 
Problems 
584 
IV Modern Rectifiers and Power System Harmonics 
587 
16 
Power and Harmonics in Nonsinusoidal Systems 
589 
16.1 
Average Power 
590 
16.2 
Root-Mean-Square (RMS) Value of a Waveform 
593 
16.3 
Power Factor 
594 
16.3.1 
Linear Resistive Load, Nonsinusoidal Voltage 
594 
16.3.2 
Nonlinear Dynamic Load, Sinusoidal Voltage 
595 
16.4 
Power Phasors in Sinusoidal Systems 
598 
16.5 
Harmonic Currents in Three-Phase Systems 
599 
16.5.1 
Harmonic Currents in Three-Phase Four-Wire Networks 
599 
16.5.2 
Harmonic Currents in Three-Phase Three-Wire Networks 
601 
16.5.3 
Harmonic Current Flow in Power Factor Correction Capacitors 
602 
16.6 
AC Line Current Harmonic Standards 
603 
16.6.1 
International Electrotechnical Commission Standard 1000 
603 
16.6.2 
IEEE/ ANSI Standard 519 
604 
Bibliography 
605 
Problems 
605 
17 
Line-Commutated Rectifiers 
609 
17.1 
The Single-Phase Full-Wave Rectifier 
609 
17.1.1 
Continuous Conduction Mode 
610 
17.1.2 
Discontinuous Conduction Mode 
611 
17.1.3 
Behavior when Cis Large 
612 
17.1.4 
Minimizing THD when C is Small 
613 
17.2 
The Three-Phase Bridge Rectifier 
615 
17.2.1 
Continuous Conduction Mode 
615 
17.2.2 
Discontinuous Conduction Mode 
616 
17.3 
Phase Control 
617 
17.3.1 
Inverter Mode 
619 
17.3.2 
Harmonics and Power Factor 
619 
17.3.3 
Commutation 
620 
17.4 
Harmonic Trap Filters 
622 
17.5 
Transformer Connections 
628 
17.6 
Summary 
630 
References 
631 
Problems 
632 
18 
Pulse-Width Modulated Rectifiers 
637 
18.1 
Properties of the Ideal Rectifier 
638 

Contents 
xv 
18.2 
Realization of a Near-Ideal Rectifier 
640 
18.2.1 
CCM Boost Converter 
642 
18.2.2 
DCM Flyback Converter 
646 
18.3 
Control of the Current Waveform 
648 
18.3.1 
Average Current Control 
648 
18.3.2 
Current Programmed Control 
654 
18.3.3 
Critical Conduction Mode and Hysteretic Control 
657 
18.3.4 
Nonlinear Carrier Control 
659 
18.4 
Single-Phase Converter Systems Incorporating Ideal Rectifiers 
663 
18.4.1 
Energy Storage 
663 
18.4.2 
Modeling the Outer Low-Bandwidth Control System 
668 
18.5 
RMS Values of Rectifier Waveforms 
673 
18.5.1 
Boost Rectifier Example 
674 
18.5.2 
Comparison of Single-Phase Rectifier Topologies 
676 
18.6 
Modeling Losses and Efficiency in CCM High-Quality Rectifiers 
678 
18.6.1 
Expression for Controller Duty Cycle d(t) 
679 
18.6.2 
Expression for the DC Load Current 
681 
18.6.3 
Solution for Converter Efficiency 11 
683 
18.6.4 
Design Example 
684 
18.7 
Ideal Three-Phase Rectifiers 
685 
18.8 
Summary of Key Points 
691 
References 
692 
Problems 
696 
v Resonant Converters 
703 
19 
Resonant Conversion 
705 
19.1 
Sinusoidal Analysis of Resonant Converters 
709 
19.1.1 
Controlled Switch Network Model 
710 
19.1.2 
Modeling the Rectifier and Capacitive Filter Networks 
711 
19.1.3 
Resonant Tank Network 
713 
19.1.4 
Solution of Converter Voltage Conversion Ratio M = V!Vg 
714 
19.2 
Examples 
715 
19.2.1 
Series Resonant DC-DC Converter Example 
715 
19.2.2 
Subharmonic Modes of the Series Resonant Converter 
717 
19.2.3 
Parallel Resonant DC-DC Converter Example 
718 
19.3 
Soft Switching 
721 
19.3.1 
Operation of the Full Bridge Below Resonance: 
Zero-Current Switching 
722 
19.3.2 
Operation of the Full Bridge Above Resonance: 
Zero-Voltage Switching 
723 
19.4 
Load-Dependent Properties of Resonant Converters 
726 
19.4.1 
Inverter Output Characteristics 
727 
19.4.2 
Dependence of Transistor Current on Load 
729 
19.4.3 
Dependence of the ZVS/ZCS Boundary on Load Resistance 
734 

xvi 
Contents 
19.4.4 
Another Example 
19.5 
Exact Characteristics of the Series and Parallel Resonant Converters 
19.5.1 
Series Resonant Converter 
19.5.2 
Parallel Resonant Converter 
19.6 
Summary of Key Points 
References 
Problems 
20 
Soft Switching 
20.1 
Soft-Switching Mechanisms of Semiconductor Devices 
20.1.1 
Diode Switching 
20.1.2 
MOSFET Switching 
20.1.3 
IGBT Switching 
20.2 
The Zero-Current-Switching Quasi-Resonant Switch Cell 
20.2.1 
Waveforms of the Half-Wave ZCS Quasi-Resonant Switch Cell 
20.2.2 
The Average Terminal Waveforms 
20.2.3 
The Full-Wave ZCS Quasi-Resonant Switch Cell 
20.3 
Resonant Switch Topologies 
20.3.1 
The Zero-Voltage-Switching Quasi-Resonant Switch 
20.3.2 
The Zero-Voltage-Switching Multi-Resonant Switch 
20.3.3 
Quasi-Square-Wave Resonant Switches 
20.4 
Soft Switching in PWM Converters 
20.4.1 
The Zero-Voltage Transition Full-Bridge Converter 
20.4.2 
The Auxiliary Switch Approach 
20.4.3 
Auxiliary Resonant Commutated Pole 
20.5 
Summary of Key Points 
References 
Problems 
Appendices 
Appendix A 
RMS Values of Commouly-Observed Converter Waveforms 
A.l 
Some Common Waveforms 
A.2 
General Piecewise Waveform 
Appendix B 
Simulation of Converters 
B.l 
Averaged Switch Models for Continuous Conduction Mode 
B.l.l 
Basic CCM Averaged Switch Model 
B.l.2 
CCM Subcircuit Model that Includes Switch Conduction Losses 
B.l.3 
Example: SEPIC DC Conversion Ratio and Efficiency 
B.l.4 
Example: Transient Response of a Buck-Boost Converter 
B.2 
Combined CCM/DCM Averaged Switch Model 
B.2.l 
Example: SEPIC Frequency Responses 
B.2.2 
Example: Loop Gain and Closed-Loop Responses 
of a Buck Voltage Regulator 
737 
740 
740 
748 
752 
752 
755 
761 
762 
763 
765 
768 
768 
770 
774 
779 
781 
783 
784 
787 
790 
791 
794 
796 
797 
798 
800 
803 
805 
805 
809 
813 
815 
815 
816 
818 
819 
822 
825 
827 

B.2.3 
Example: DCM Boost Rectifier 
B.3 
Current Programmed Control 
B.3.1 
Current Programmed Mode Model for Simulation 
B.3.2 
Example: Frequency Responses of a Buck Converter with 
Current Programmed Control 
References 
AppendixC 
Middlebrook's Extra Element Theorem 
C.l 
Basic Result 
C.2 
Derivation 
C.3 
Discussion 
C.4 
Examples 
C.4.1 
A Simple Transfer Function 
C.4.2 
An Unmodeled Element 
C.4.3 
Addition of an Input Filter to a Converter 
C.4.4 
Dependence of Transistor Current on Load in a Resonant Inverter 
References 
AppendixD 
Magnetics Design Tables 
D.l 
Pot Core Data 
D.2 
EE Core Data 
D.3 
EC Core Data 
D.4 . ETD Core Data 
D.5 
PQ Core Data 
D.6 
American Wire Gauge Data 
References 
Index 
Contents 
xvii 
832 
834 
834 
837 
840 
843 
843 
846 
849 
850 
850 
855 
857 
859 
861 
863 
864 
865 
866 
866 
867 
868 
869 
871 

Preface 
The objective of the First Edition was to serve as a textbook for introductory power electronics courses 
where the fundamentals of power electronics are defined, rigorously presented, and treated in sufficient 
depth so that students acquire the knowledge and skills needed to design practical power electronic sys-
tems. The First Edition has indeed been adopted for use in power electronics courses at a number of 
schools. An additional goal was to contribute as a reference book for engineers who practice power elec-
tronics design, and for students who want to develop their knowledge of the area beyond the level of 
introductory courses. In the Second Edition, the basic objectives and philosophy of the First Edition have 
not been changed. The modifications include addition of a number of new topics aimed at better serving 
the expanded audience that includes students of introductory and more advanced courses, as well as 
practicing engineers looking for a reference book and a source for further professional development. 
Most of the chapters have been significantly revised and updated. Major additions include a new Chapter 
10 on input filter design, a new Appendix B covering simulation of converters, and a new Appendix C on 
Middlebrook's Extra Element Theorem. In addition to the introduction of new topics, we have made 
major revisions of the material to improve the flow and clarity of explanations and to provide additional 
specific results, in chapters covering averaged switch modeling, dynamics of converters operating in dis-
continuous conduction mode, current mode control, magnetics design, pulse-width modulated rectifiers, 
and resonant and soft-switching converters. 
A completely new Chapter 10 covering input filter design has been added to the second addi-
tion. The problem of how the input filter affects the dynamics of the converter, often in a manner that 
degrades stability and performance of the converter system, is explained using Middlebrook's Extra Ele-
ment Theorem. This design-oriented approach is explained in detail in the new Appendix C. Simple con-
ditions are derived to allow filter damping so that converter transfer functions are not changed. Complete 
results for optimum filter damping are presented. The chapter concludes with a discussion about the 
design of multiple-section filters, illustrated by a design example. 
Computer simulation based on the averaged switch modeling approach is presented in Appen-
dix B, including PSpice models for continuous and discontinuous conduction mode, and current-mode 
control. Extensive simulation examples include: finding the de conversion ratio and efficiency of a 
SEPIC, plotting the transient response of a buck-boost converter, comparing the control-to-output trans-
fer functions of a SEPIC operating in CCM and DCM,determining the loop gain, line-to-output transfer 
function, and load transient response of a closed-loop buck voltage regulator, finding the input current 

xx 
Preface 
waveform and THD of a DCM boost rectifier, and comparing the transfer functions and output imped-
ances of buck converters operating with current programmed control and with duty cycle control. The 
major purpose of Appendix B is to supplement the text discussions, and to enable the reader to effec-
tively use averaged models and simulation tools in the design process. The role of simulation as a design 
verification tool is emphasized. In our experience of teaching introductory and more advanced power 
electronics courses, we have found that the use of simulation tools works best with students who have 
mastered basic concepts and design-oriented analytical techniques, so that they are able to make correct 
interpretations of simulation results and model limitations. This is why we do not emphasize simulation 
in introductory chapters. Nevertheless, Appendix B is organized so that simulation examples can be 
introduced together with coverage of the theoretical concepts of Chapters 3, 7, 9, 10, 11, 12, and 18. 
Middlebrook's Extra Element Theorem is presented in Appendix C, together with four tutorial 
examples. This valuable design-oriented analytical tool allows one to examine effects of adding an extra 
element to a linear system, without solving the modified system all over again. The theorem has many 
practical applications in the design of electronic circuits, from solving circuits by inspection, to quickly 
finding effects of unmodeled parasitic elements. In particular, in the Second Edition, Middlebrook's 
Extra Element Theorem is applied to the input filter design of Chapter 10, and to resonant inverter design 
in Chapter 19. 
In Chapter 7, we have revised the section on circuit averaging and averaged switch modeling. 
The process of circuit averaging and deriving averaged switch models has been explained to allow read-
ers not only to use the basic models, but also to construct averaged models for other applications of inter-
est. Examples of extensions of the averaged switch modeling approach include modeling of switch 
conduction and switching losses. Related to the revision of Chapter 7, in Appendix B we have included 
new material on simulation of converters based on the averaged switch modeling approach. 
Chapter 8 contains a new substantial introduction that explains the engineering design process 
and the need for design-oriented analysis. The discussions of design-oriented methods for construction 
of frequency response have been revised and expanded. A new example has been added, involving 
approximate analysis of a damped input filter. 
Chapter 11 on dynamics of DCM (discontinuous conduction mode) converters, and Chapter 12 
on current-mode control, have been thoroughly revised and updated. Chapter 11 includes a simplified 
derivation of DCM averaged switch models, as well as an updated discussion of high-frequency DCM 
dynamics. Chapter 12 includes a new, more straightforward explanation and discussion of current-mode 
dynamics, as well as new complete results for transfer functions and model parameters of all basic con-
verters. 
The chapters on magnetics design have been significantly revised and reorganized. Basic mag-
netics theory necessary for informed design of magnetic components in switching power converters is 
presented in Chapter 13. The description of the proximity effect has been completely revised, to explain 
this important but complex subject in a more intuitive manner. The design of magnetic components based 
on the copper loss constraint is described in Chapter 14. A new step-by-step design procedure is given 
for multiple-winding inductors, and practical design examples are included for the design of filter induc-
tors, coupled inductors and fly back transformers. The design of magnetic components (transformers and 
ac inductors) based on copper and core loss considerations is described in Chapter 15. 
To improve their logical flow, the chapters covering pulse-width modulated rectifiers have been 
combined into a single Chapter 18, and have been completely reorganized. New sections on current con-
trol based on the critical conduction mode, as well as on operation of the CCM boost and DCM fly back 
as PWM rectifiers, have been added. 
Part V consists of Chapter 19 on resonant converters and Chapter 20 on soft-switching convert-
ers. The discussion of resonant inverter design, a topic of importance in the field of high-frequency elec-
tronic ballasts, has been expanded and explained in a more intuitive manner. A new resonant inverter 

xxi 
design example has also been added to Chapter 19. Chapter 20 contains an expanded tutorial explanation 
of switching loss mechanisms, new charts illustrating the characteristics of quasi-square-wave and multi-
resonant converters, and new up-to-date sections about soft-switching converters, including the zero-
voltage transition full-bridge converter, the auxiliary switch approach, and the auxiliary resonant com-
mutated pole approach for de-de converters and dc-ac inverters. 
The material of the Second Edition is organized so that chapters or sections of the book can be 
selected to offer an introductory one-semester course, but yet enough material is provided for a sequence 
of more advanced courses, or for individual professional development. At the University of Colorado, we 
cover the material from the Second Edition in a sequence of three semester-long power electronics 
courses. The first course, intended for seniors and first-year graduate students, covers Chapters 1 to 6, 
Sections 7.1, 7.2, 7.5, and 7.6 from Chapter 7, Chapters 8 and 9, and Chapters 13 to 15. A project-ori-
ented power electronics design laboratory is offered in parallel with this course. This course serves as a 
prerequisite for two follow-up courses. The second course starts with Section 7.4, proceeds to Appendi-
ces B and C, Chapters 10, 11 and 12, and concludes with the material of Chapters 16 to 18. In the third 
course we cover resonant and soft-switching techniques of Chapters 19 and 20. 
The website for the Second Edition contains comprehensive supporting materials for the text, 
including solved problems and slides for instructors. Computer simulation files can be downloaded from 
this site, including a PSpice library of averaged switch models, and simulation examples. 
This text has evolved from courses developed over seventeen years of teaching power electron-
ics at the University of Colorado. These courses, in tum, were heavily influenced by our previous experi-
ences as graduate students at the California Institute of Technology, under the direction of Profs. 
Slobodan Cuk and R. D. Middlebrook, to whom we are grateful. We appreciate the helpful suggestions 
of Prof. Arthur Witulski of the University of Arizona. We would also like to thank the many readers of 
the First Edition, students, and instructors who offered their comments and suggestions, or who pointed 
out errata. We have attempted to incorporate these suggestions wherever possible. 
ROBERT W. ERICKSON 
DRAGAN MAKSIMOVIC 
Boulder, Colorado 

1 
Introduction 
1.1 
INTRODUCTION TO POWER PROCESSING 
The field of power electronics is concerned with the processing of electrical power using electronic 
devices [ 1-7]. The key element is the switching converter, illustrated in Fig. 1.1. In general, a switching 
converter contains power input and control input ports, and a power output port. The raw input power is 
processed as specified by the control input, yielding the conditioned output power. One of several basic 
functions can be performed [2]. In a de-de converter, the de input voltage is converted to a de output 
voltage having a larger or smaller magnitude, possibly with opposite polarity or with isolation of the 
input and output ground references. In an ac--<:lc rectifier, an ac input voltage is rectified, producing a de 
output voltage. The de output voltage and/or ac input current waveform may be controlled. The inverse 
process, dc-ac inversion, involves transforming a de input voltage into an ac output voltage of controlla-
ble magnitude and frequency. Ac-ac cycloconversion involves converting an ac input voltage to a given 
ac output voltage of controllable magnitude and frequency. 
Control is invariably required. It is nearly always desired to produce a well-regulated output 
Po we r 
Fig. 
1.1 The switching converter, a basic 
inp ut 
power processing block. 
Switching 
converter 
Control 
in ut 
p 
Po wer 
put 
out 

2 
Introduction 
Fig. 1.2 A controller is generally required. 
r 
Powe 
inp ut 
Feed lfo~ani -----1 
Switching 
converter 
Control 
input 
Controller r-
j Reference 
Po wer 
put 
out 
Feedbac k 
voltage, in the presence of variations in the input voltage and load current. As illustrated in Fig. 1.2, a 
controller block is an integral part of any power processing system. 
High efficiency is essential in any power processing application. The primary reason for this is 
usually not the desire to save money on one's electric bills, nor to conserve energy, in spite of the nobility 
of such pursuits. Rather, high efficiency converters are necessary because construction of low-efficiency 
converters, producing substantial output power, is impractical. The efficiency of a converter having out-
put power Pout and input power P;11 is 
The power lost in the converter is 
Equation (1.2) is plotted in Fig. 1.3. In a con-
TJ 
verter that has an efficiency of 50%, power 
Ploss is dissipated by the converter elements 
and this is equal to the output power, Pour 
This power is converted into heat, which 
must be removed from the converter. If the 
output power is substantial, then so is the 
loss power. This leads to a large and expen-
sive cooling system, it causes the electronic 
elements within the converter to operate at 
high temperature, and it reduces the system 
reliability. Indeed, at high output powers, it 
may be impossible to adequately cool the 
converter elements using current technology. 
Increasing the efficiency is the key 
to obtaining higher output powers. For exam-
ple, if the converter efficiency is 90%, then 
0.8 
0.6 
0.4 
0.2 
0 
0.5 
the converter loss power is equal to only 11% Fig. 1.3 Converter power loss vs. efficiency. 
(1.1) 
1.5 

1.1 
Introduction to Power Processing 
3 
Fig. 1.4 A goal of current converter technology is to construct converters of small size and weight, which process 
substantial power at high efficiency. 
of the output power. Efficiency is a good measure of the success of a given converter technology. Figure 
1.4 illustrates a converter that processes a large amount of power, with very high efficiency. Since very 
little power is lost, the converter elements can be packaged with high density, leading to a converter of 
small size and weight, and of low temperature rise. 
How can we build a circuit that changes the voltage, yet dissipates negligible power? The vari-
ous conventional circuit elements are illustrated in Fig. 1.5. The available circuit elements fall broadly 
into the classes of resistive elements, capacitive elements, magnetic devices including inductors and 
transformers, semiconductor devices operated in the linear mode (for example, as class A or class B 
amplifiers), and semiconductor devices operated in the switched mode (such as in logic devices where 
transistors operate in either saturation or cutoff). In conventional signal processing applications, where 
efficiency is not the primary concern, magnetic devices are usually avoided wherever possible, because 
of their large size and the difficulty of incorporating them into integrated circuits. In contrast, capacitors 
and magnetic devices are important elements of switching converters, because ideally they do not con-
sume power. It is the resistive element, as well as the linear-mode semiconductor device, that is avoided 
[2]. Switched-mode semiconductor devices are also employed. When a semiconductor device operates in 
the off state, its current is zero and hence its power dissipation is zero. When the semiconductor device 
operates in the on (saturated) state, its voltage drop is small and hence its power dissipation is also small. 
In either event, the power dissipated by the semiconductor device is low. So capacitive and inductive ele-
ments, as well as switched-mode semiconductor devices, are available for synthesis of high-efficiency 
converters. 
Let us now consider how to construct the simple de-de converter example illustrated in Fig. 1.6. 
The input voltage Vg is 100 V. It is desired to supply 50 V to an effective 5 Q load, such that the de load 
current is 10 A. 
Introductory circuits textbooks describe a low-efficiency method to perform the required func-
tion: the voltage divider circuit illustrated in Fig. 1.7(a). The de-de converter then consists simply of a 
1 
--'1SiS1f'\.-
~ v 
s 
·~~~~· 
T 
h [ 
Linear-
DT8 
T8 
mode 
Switched-mode 
Resistors 
Capacitors 
Magnetics 
Semiconductor devices 
Fig. 1.5 Devices available to the circuit designer [2]. 

4 
Introduction 
I 
lOA 
+ 
vg 
De-de 
R 
v 
converter 
IOOV 
5Q 
50V 
Fig. 1.6 A simple power processing example: construction of a 500 W de-de converter. 
(a) 
r··------·------··-----··-······----------··-----···--····----····------1 
+ 50V -
Ploss= 500W 
. 
. 
. 
. 
~--·-············-······················································-~ 
(b) 
. 
. 
. 
. 
. 
. 
················-·······-·················································· 
I 
lOA 
+ 
R 
V 
5Q 
50V 
I 
lOA 
+ 
R 
V 
5Q 
50V 
P0u1=500W 
Fig. 1.7 Changing the de voltage via dissipative means: (a) voltage divider, (b) series pass regulator. 
variable resistor, whose value is adjusted such that the required output voltage is obtained. The load cur-
rent flows through the variable resistor. For the specified voltage and current levels, the power Ploss dissi-
pated in the variable resistor equals the load power Pout = 500 W. The source V8 supplies power 
Pin= 1000 W. Figure 1.7(b) illustrates a more practical implementation known as the linear series-pass 
regulator. The variable resistor of Fig. 1.7(a) is replaced by a linear-mode power transistor, whose base 
current is controlled by a feedback system such that the desired output voltage is obtained. The power 
dissipated by the linear-mode transistor of Fig. 1.7(b) is approximately the same as the 500 W lost by the 
variable resistor in Fig. 1.7(a). Series-pass linear regulators generally find modern application only at 
low power levels of a few watts. 
Figure 1.8 illustrates another approach. A single-pole double-throw (SPDT) switch is connected 
as shown. The switch output voltage v.(t) is equal to the converter input voltage V8 when the switch is in 
position 1, and is equal to zero when the switch is in position 2. The switch position is varied periodi-
cally, as illustrated in Fig. 1.9, such that v.(t) is a rectangular waveform having frequency fs and period 
Ts = l!fs. The duty cycle D is defined as the fraction of time in which the switch occupies position 1. 
Hence, 0 $; D $; 1. In practice, the SPDT switch is realized using switched-mode semiconductor devices, 

1.1 
Introduction to Power Processing 
5 
r···············································--------····························: 
.---+---<l~ 
2 
vs(t) 
L ................................................................................. .l 
Fig. 1.8 
Insertion of SPOT switch which changes the de component of the voltage. 
I 
lOA 
',(t) l- __ -~: 
mm ~- ---~ mm ~- y,_~~v, 
i+--DT -f.-(1-D)T.-+-! 
: 
s 
: 
s 
: 
switch i 
i 
i 
position: i 
i 
2 
i 
Fig. 1.9 
Switch output voltage waveform vs(t). 
which are controlled such that the SPDT switching function is attained. 
+ 
v(t) 
50V 
The switch changes the de component of the voltage. Recall from Fourier analysis that the de 
component of a periodic waveform is equal to its average value. Hence, the de component of v .(t) is 
1 iTs 
Vs = T 
v.(t)dt = DV8 
s 0 
(1.3) 
Thus, the switch changes the de voltage, by a factor equal to the duty cycle D. To convert the input volt-
age V8 = 100 V into the desired output voltage of V = 50 V, a duty cycle of D = 0.5 is required. 
Again, the power dissipated by the switch is ideally zero. When the switch contacts are closed, 
then their voltage is zero and hence the power dissipation is zero. When the switch contacts are open, 
then the current is zero and again the power dissipation is zero. So we have succeeded in changing the de 
voltage component, using a device that is ideally lossless. 
In addition to the desired de component V8, the switch output voltage waveform v.(t) also con-
tains undesirable harmonics of the switching frequency. In most applications, these harmonics must be 
removed, such that the output voltage v(t) is essentially equal to the de component V = Vs. A low-pass fil-
ter can be employed for this purpose. Figure 1.10 illustrates the introduction of a single-section L-C low-
pass filter. If the filter comer frequency f0 is sufficiently less than the switching frequency fs, then the fil-
ter essentially passes only the de component of v .(t). To the extent that the switch, inductor, and capacitor. 
elements are ideal, the efficiency of this de-de converter can approach 100%. 
In Fig. 1.11, a control system is introduced for regulation of the output voltage. Since the output 
voltage is a function of the switch duty cycle, a control system can be constructed that varies the duty 
cycle to cause the output voltage to follow a given reference. Figure 1.11 also illustrates a typical way in 
which the SPDT switch is realized using switched-mode semiconductor devices. The converter power 
stage developed in Figs. 1.8 to 1.11 is called the buck converter, because it reduces the de voltage. 
Converters can be constructed that perform other power processing functions. For example, Fig. 

6 
Introduction 
r··········-------------------------------------------------------------------------~ 
i(t) 
~----+--o 
+ 
2 
c 
R 
v(t) 
l ................................................................................... !p =500W 
Ploss small 
out 
Fig. 1.10 
Addition of L-C low-pass filter, for removal of switching harmonics. 
Power 
input 
Switching converter 
Load 
r··------------------------------------·------------------------------; 
~--+--. 
~---+~+----r---. 
Transistor 
gate driver 
v 
Reference 
input 
vr~f' 
Fig. 1.11 
Addition of control system to regulate the output voltage. 
(a) 
Fig. 
1.12 
The boost converter: 
(a) ideal converter circuit, (b) output 
voltage V vs. transistor duty cycle D. 
(b) 
v 
5V8 
4V g 
3V8 
2V g 
v 
g 
0 
2 
0 
0.2 
0.4 
0.6 
0.8 
D 
c 
Sensor 
gain 
+ 
R 
v 

(a) 
(b) 
v,(t) 
.. ··· 
······· --
1.2 Several Applications of Power Electronics 
7 
,-,....----.....--r-
.. -·· 
.. · 
.. ····· 
.. · 
·· ... 
·· ... 
··. ·· .. 
2 
• .. 
··· .. 
Fig. 1.13 
A bridge-type dc-l(llac inverter: (a) ideal inverter circuit, (b) typical pulse-width-modulated switch volt-
age waveform v.(t), and its low-frequency component. 
1.12 illustrates a circuit known as the boost converter, in which the positions of the inductor and SPDT 
switch are interchanged. This converter is capable of producing output voltages that are greater in magni-
tude than the input voltage. In general, any given input voltage can be converted into any desired output 
voltage, using a converter containing switching devices embedded within a network of reactive elements. 
Figure 1.13(a) illustrates a simple dc-l!llac inverter circuit. As illustrated in Fig. 1.13(b), the 
switch duty cycle is modulated sinusoidally. This causes the switch output voltage vs(t) to contain a low-
frequency sinusoidal component. The L-C filter cutoff frequency f0 is selected to pass the desired low-
frequency components of vs(t), but to attenuate the high-frequency switching harmonics. The controller 
modulates the duty cycle such that the desired output frequency and voltage magnitude are obtained. 
1.2 
SEVERAL APPLICATIONS OF POWER ELECTRONICS 
The power levels encountered in high-efficiency switching converters range from (1) less than one watt, 
in de-de converters within battery-operated portable equipment, to (2) tens, hundreds, or thousands of 
watts in power supplies for computers and office equipment, to (3) kilowatts to Megawatts, in variable-
speed motor drives, to (4) roughly 1000 Megawatts in the rectifiers and inverters that interface de trans-
mission lines to the ac utility power system. The converter systems of several applications are illustrated 
in this section. 
A power supply system for a laptop computer is illustrated in Fig. 1.14. A lithium battery pow-
ers the system, and several de-de converters change the battery voltage into the voltages required by the 
loads. A buck converter produces the low-voltage de required by the microprocessor. A boost converter 
increases the battery voltage to the level needed by the disk drive. An inverter produces high-voltage 
high-frequency acto drive lamps that light the display. A charger with transformer isolation converts the 
ac line voltage into de to charge the battery. The converter switching frequencies are typically in the 
vicinity of several hundred kilohertz; this leads to substantial reductions in the size and weight of the 
reactive elements. Power management is used, to control sleep modes in which power consumption is 
reduced and battery life is extended. In a distributed power system, an intermediate de voltage appears at 
the computer backplane. Each printed circuit card contains high-density de-de converters that produce 

8 
Introduction 
ac line input 
85-265 Vrms 
Charger 
PWM 
Rectifier 
Fig. 1.14 A laptop computer power supply system. 
Display 
backlighting 
locally-regulated low voltages. Commercial applications of power electronics include off-line power sys-
tems for computers, office and laboratory equipment, uninterruptable ac power supplies, and electronic 
ballasts for gas discharge lighting. 
Figure 1.15 illustrates a power system of an earth-orbiting spacecraft. A solar array produces 
the main power bus voltage Vbus· DC-DC converters convert Vbus to the regulated voltages required by 
the spacecraft payloads. Battery charge/discharge controllers interface the main power bus to batteries; 
these controllers may also contain de-de converters. Aerospace applications of power electronics include 
the power systems of aircraft, spacecraft, and other aerospace vehicles. 
Figure 1.16 illustrates an electric vehicle power and dr.ive system. Batteries are charged by a 
converter that draws high power-factor sinusoidal current from a single-phase or three-phase ac line. The 
batteries supply power to variable-speed ac motors to propel the vehicle. The speeds of the ac motors are 
controlled by variation of the electrical input frequency. Inverters produce three-phase ac output voltages 
of variable frequency and variable magnitude, to control the speed of the ac motors and the vehicle. A 
de-de converter steps down the battery voltage to the lower de levels required by the electronics of the 
system. Applications of motor drives include speed control of industrial processes, such as control of 
compressors, fans, and pumps; transportation applications such as electric vehicles, subways, and loco-
motives; and motion control applications in areas such as computer peripherals and industrial robots. 
Power electronics also finds application in other diverse industries, including de power supplies, 
Dissipative 
shunt regulator 
I 
+ 
Solar 
array 
vbus 
-
I 
I 
I 
I 
Battery 
De-de 
De-de 
charge/discharge 
converter 
converter 
controllers 
Batteries 
~.IJ ~.IJ 
I 
I 
Payload 
Payload 
Fig. 1 .15 Power s stem of an earth-orbitin 
y 
s acecraft. 
g p 

1.3 
Elements of Power Electronics 
9 
CJ? 
9 
ac machine 
ac machine 
I I I 
Inverter 
Inverter 
control bus 
50/60Hz 
-
1 
battery 
)-IP 
+1 
l 
~ 
system 
controller 
Battery 
DC-DC 
charger 
: f 
converter 
Vehicle 
~ electronics 
~ 
~ 
Low-voltage 
i 
de bus 
3¢ac line 
Inverter 
Inverter 
Variable-frequency 
I I 
I I I 
Variable-voltage ac 
ac machine 
ac machine 
2S 
2S 
Fig. 1.16 An electric vehicle power and drive system. 
uninterruptable power supplies, and battery chargers for the telecommunications industry; inverter sys-
tems for renewable energy generation applications such as wind and photovoltaic power; and utility 
power systems applications including high-voltage de transmission and static VAR (reactive volt-ampere) 
compensators. 
1.3 
ELEMENTS OF POWER ELECTRONICS 
One of the things that makes the power electronics field interesting is its incorporation of concepts from 
a diverse set of fields, including: 
analog circuits 
electronic devices 
control systems 
power systems 
magnetics 
electric machines 
numerical simulation 
Thus, the practice of power electronics requires a broad electrical engineering background. In addition, 
there are fundamental concepts that are unique to the power electronics field, and that require specialized 
study. 
The presence of high-frequency switching makes the understanding of switched-mode convert-
ers not straightforward. Hence, converter modeling is central to the study of power electronics. As intro-
duced in Eq. (1.3), the de component of a periodic waveform is equal to its average value. This ideal can 

10 
Introduction 
be generalized, to predict the de components of all converter waveforms via averaging. In Part I of this 
book, averaged equivalent circuit models of converters operating in steady state are derived. These mod-· 
els not only predict the basic ideal behavior of switched-mode converters, but also model efficiency and! 
losses. Realization of the switching elements, using power semiconductor devices, is also discussed. 
Design of the converter control system requires models of the converter dynamics. In Part II of 
this book, the averaging technique is extended, to describe low-frequency variations in the converter 
waveforms. Small-signal equivalent circuit models are developed, which predict the control-to-output 
and line-to-transfer functions, as well as other ac quantities of interest. These models are then employed 
to design converter control systems and to lend an understanding of the well-known current-programmed 
control technique. 
The magnetic elements are key components of any switching converter. The design of high-
power high-frequency magnetic devices having high efficiency and small size and weight is central to 
most converter technologies. High-frequency power magnetics design is discussed in Part III. 
Pollution of the ac power system by rectifier harmonics is a growing problem. As a result, many 
converter systems now incorporate low-harmonic rectifiers, which draw sinusoidal currents from the util-
ity system. These modem rectifiers are considerably more sophisticated than the conventional diode 
bridge: they may contain high-frequency switched-mode converters, with control systems that regulate 
the ac line current waveform. Modem rectifier technology is treated in Part IV. 
Resonant converters employ quasi-sinusoidal waveforms, as opposed to the rectangular wave-
forms of the buck converter illustrated in Fig. 1.9. These resonant converters find application where high-
frequency inverters and converters are needed. Resonant converters are modeled in Part V. Their loss 
mechanisms, including the processes of zero-voltage switching and zero-current switching, are dis-
cussed. 
REFERENCES 
[1] 
W. E. NEWELL, "Power Electronics-Emerging from Limbo," IEEE Power Electronics Specialists Confer-
ence, 1973 Record, pp. 6-12. 
[2] 
R. D. MIDDLEBROOK, "Power Electronics: An Emerging Discipline," IEEE International Symposium on 
Circuits and Systems, 1981 Proceedings, April1981. 
[3] 
R. D. MIDDLEBROOK, "Power Electronics: Topologies, Modeling, and Measurement," IEEE International 
Symposium on Circuits and Systems, 1981 Proceedings, Apri11981. 
[4] 
S. CUK, "Basics of Switched-Mode Power Conversion: Topologies, Magnetics, and Control," in Advances 
in Switched-Mode Power Conversion, vol. 2, pp. 279--310, Irvine: Teslaco, 1981. 
[5] 
N. MOHAN, "Power Electronics Circuits: An Overview," IEEE IECON, 1988 Proceedings, pp. 522-527. 
[6] 
B. K. BOSE, "Power Electronics-A Technology Review," Proceedings of the IEEE, vol. 80, no. 8, August 
1992,pp. 1303-1334. 
[7] 
M. NISHIHARA, "Power Electronics Diversity," International Power Electronics Conference (Tokyo), 1990 
Proceedings, pp. 21-28. 

Part I 
Converters in Equilibrium 

2 
Principles of Steady-State 
Converter Analysis 
2.1 
INTRODUCTION 
In the previous chapter, the buck converter was introduced as a means of reducing the de voltage, using 
only nondissipative switches, inductors, and capacitors. The switch produces a rectangular waveform 
v,(t) as illustrated in Fig. 2.1. The voltage v,(t) is equal to the de input voltage Vg when the switch is in 
position 1, and is equal to zero when the switch is in position 2. In practice, the switch is realized using 
(a) 
(b) 
v,.(t) 
0 
Switch 
position: 
+ 
2 
v,(t) 
R 
v(t) 
-
DTS-- D'T,. --
0 
DT,. 
2 
Fig. 2.1 
Ideal switch, (a), used to reduce the voltage de component, and (b) its output voltage waveform v,(t). 

14 
Principles of Steady-State Converter Analysis 
Fig. 2.2 Determination of the switch output voltage 
de component, by integrating and dividing by the 
switching period. 
0 
area = 
(v,) = DVg 
.... , .... ,, ............................................. .. 
DT,V8 
0 
DT_,. 
power semiconductor devices, such as transistors and diodes, which are controlled to turn on and off as 
required to perform the function of the ideal switch. The switching frequency J;, equal to the inverse of 
the switching period T,, generally lies in the range of 1 kHz to 1 MHz, depending on the switching speed 
of the semiconductor devices. The duty ratio Dis the fraction of time that the switch spends in position 1, 
and is a number between zero and one. The complement of the duty ratio, D', is defined as (l -D). 
The switch reduces the de component of the voltage: the switch output voltage v,(t) has a de 
component that is less than the converter de input voltage Vg. From Fourier analysis, we know that the de 
component of v,(t) is given by its average value ( v), or 
I ) 
1 iT, 
\ v, = T . v,(t)dt 
s 0 
(2.1) 
As illustrated in Fig. 2.2, the integral is given by the area under the curve, or DT, Vg. The average value is 
therefore 
(2.2) 
So the average value, or de component, of v,(t) is equal to the duty cycle times the de input voltage Vg. 
The switch reduces the de voltage by a factor of D. 
What remains is to insert a low-pass filter as shown in Fig. 2.3. The filter is designed to pass the 
de component of v,(t), but to reject the components of v,(t) at the switching frequency and its harmonics. 
The output voltage v(t) is then essentially equal to the de component of v,(t): 
v~lv)=DV 
\ s 
g 
(2.3) 
The converter of Fig. 2.3 has been realized using loss less elements. To the extent that they are ideal, the 
inductor, capacitor, and switch do not dissipate power. For example, when the switch is closed, its volt-
age drop is zero, and the current is zero when the switch is open. In either case, the power dissipated by 
the switch is zero. Hence, efficiencies approaching 100% can be obtained. So to the extent that the com-
ponents are ideal, we can realize our objective of changing de voltage levels using a loss less network. 
L 
+ 
+ 
2 
v,(t) 
c 
R 
v(t) 
Fig. 2.3 Insertion of low-pass filter, to remove the switching harmonics and pass only the de component of v,(t) to 
the output. 

2.2 
Inductor Volt-Second Balance, Capacitor Charge Balance, and the Small-Ripple Approximation 
15 
v 
Fig. 2.4 
Buck converter de output voltage V vs. duty cycle D. 
D 
The network of Fig. 2.3 also allows control of the output. Figure 2.4 is the control characteristic 
of the converter. The output voltage, given by Eq. (2.3), is plotted vs. duty cycle. The buck converter has 
a linear control characteristic. Also, the output voltage is less than or equal to the input voltage, since 
0 :<::: D :<::: 1. Feedback systems are often constructed that adjust the duty cycle D to regulate the converter 
output voltage. Inverters or power amplifiers can also be built, in which the duty cycle varies slowly with 
time and the output voltage follows. 
The buck converter is just one of many possible switching converters. Two other commonly 
used converters, which perform different voltage conversion functions, are illustrated in Fig. 2.5. In the 
boost converter, the positions of the inductor and switch are reversed. It is shown later in this chapter that 
the boost converter steps the voltage up: V::O: Vg. Another converter, the buck-boost converter, can either 
increase or decrease the magnitude of the voltage, but the polarity is inverted. So with a positive input 
voltage, the ideal buck-boost converter can produce a negative output voltage of any magnitude. It may at 
first be surprising that de output voltages can be produced that are greater in magnitude than the input, or 
that have opposite polarity. But it is indeed possible to produce any desired de output voltage using a pas-
sive network of only inductors, capacitors, and embedded switches. 
In the above discussion, it was possible to derive an expression for the output voltage of the 
buck converter, Eq. (2.3), using some simple arguments based on Fourier analysis. However, it may not 
be immediately obvious how to directly apply these arguments to find the de output voltage of the boost, 
buck-boost, or other converters. The objective of this chapter is the development of a more general 
method for analyzing any switching converter comprised of a network of inductors, capacitors, and 
switches [1-8]. 
The principles of inductor volt-second balance and capacitor charge balance are derived; these 
can be used to solve for the inductor currents and capacitor voltages of switching converters. A useful 
approximation, the small-ripple or linear-ripple approximation, greatly facilitates the analysis. Some 
simple methods for selecting the filter element values are also discussed. 
2.2 
INDUCTOR VOLT-SECOND BALANCE, CAPACITOR CHARGE BALANCE, AND 
THE SMALL-RIPPLE APPROXIMATION 
Let us more closely examine the inductor and capacitor waveforms in the buck converter of Fig. 2.6. It is 
impossible to build a perfect low-pass filter that allows the de component to pass but completely removes 
the components at the switching frequency and its harmonics. So the low-pass filter must allow at least 
some small amount of the high-frequency harmonics generated by the switch to reach the output. Hence, 
in practice the output voltage waveform v(t) appears as illustrated in Fig. 2.7, and can be expressed as 
v(t) = V + V,;pple(t) 
(2.4) 
So the actual output voltage v(t) consists of the desired de component V, plus a small undesired ac com-

16 
Principles of Steady-State Converter Analysis 
(a) 
',~cf 
~ 
Rf 
+ 
vg 
v 
(b) 
L 
2 
(c) 
+ 
R 
0.8 
Q 0.6 
~ 0.4 
0.2 
4 
§: 
3 
~ 2 
1 
M(D) = 1-D 
D 
o+----+---+---+---+-----< 
0 
0.2 
0.4 
0.6 
0.8 
D 
D 
0 
0.2 
0.4 
0.6 
0.8 
0 
-1 
Q 
-2 
~ -3 
-4 
M(D) = 1--~ 
-5 
Fig. 2.5 
Three basic converters and their de conversion ratios M(D) = VIV8 : (a) buck, (b) boost, (c) buck-boost. 
Fig. 
2.6 
Buck converter cir-
cuit, with the inductor voltage 
vL(t) and capacitor current ic(t) 
waveforms specifically identi-
fied. 
vg 
2 
c 
+ 
R 
v(t) 
ponent vrippte(t) arising from the incomplete attenuation of the switching harmonics by the low-pass filter. 
The magnitude of v rippt/t) has been exaggerated in Fig. 2. 7. 
The output voltage switching ripple should be small in any well-designed converter, since the 
object is to produce a de output. For example, in a computer power supply having a 3.3 V output, the 
switching ripple is normally required to be less than a few tens of millivolts, or less than 1% of the de 
component V. So it is nearly always a good approximation to assume that the magnitude of the switching 

2.2 
Inductor Volt-Second Balance, Capacitor Charge Balance, and the Small-Ripple Approximation 
17 
Fig. 
2.7 
Output voltage waveform v(t), 
consisting of de component V and switching 
ripple v ,ipple(t). 
v(t) 
v 
0 
ripple is much smaller than the de component: 
II v ,ipple II « v 
(2.5) 
Therefore, the output voltage v(t) is well approximated by its de component V, with the small ripple term 
v rippl/t) neglected: 
v(t)"' V 
(2.6) 
This approximation, known as the small-ripple approximation, or the linear-ripple approximation, 
greatly simplifies the analysis of the converter waveforms and is used throughout this book. 
Next let us analyze the inductor current waveform. We can find the inductor current by integrat-
ing the inductor voltage waveform. With the switch in position 1, the left side of the inductor is con-
nected to the input voltage V8, and the circuit reduces to Fig. 2.8(a). The inductor voltage vL(t) is then 
given by 
(2.7) 
As described above, the output voltage v(t) consists of the de component V, plus a small ac ripple term 
vdppte(t). We can make the small ripple approximation here, Eq. (2.6), to replace v(t) with its de compo-
nent V: 
(2.8) 
So with the switch in position 1, the inductor voltage is essentially constant and equal to Vg- V, as shown 
in Fig. 2.9. By knowledge of the inductor voltage waveform, the inductor current can be found by use of 
the definition 
( ) - L diL(t) 
VL t -
dt 
(2.9) 
(a) 
iL(t) 
L 
(b) 
L 
+ 
+ vL(t) -
+ 
ic(t) 
ic(t) 
vg 
c 
R 
v(t) 
vg 
iL(t) 
c 
R 
v(t) 
Fig. 2.8 
Buck converter circuit: (a) while the switch is in position 1, (b) while the switch is in position 2. 

18 
Principles of Steady-State Converter Analysis 
Fig. 2.9 
Steady-state inductor voltage waveform, 
buck converter. 
Switch 
position: 
Vg- V 
-
DTS -- +--D'Ts--+ 
t 
-V 
2 
Thus, during the first interval, when vL(t) is approximately (Vg - V), the slope of the inductor current 
waveform is 
(2.10) 
which follows by dividing Eq. (2.9) by L, and substituting Eq. (2.8). Since the inductor voltage vL(t) is 
essentially constant while the switch is in position I, the inductor current slope is also essentially con-
stant and the inductor current increases linearly. 
Similar arguments apply during the second subinterval, when the switch is in position 2. The 
left side of the inductor is then connected to ground, leading to the circuit of Fig. 2.8(b ). It is important to 
consistently define the polarities of the inductor current and voltage; in particular, the polarity of vL(t) is 
defined consistently in Figs. 2.7, 2.8(a), and 2.8(b). So the inductor voltage during the second subinterval 
is given by 
(2.11) 
Use of the small ripple approximation, Eq. (2.6), leads to 
(2.12) 
So the inductor voltage is also essentially constant while the switch is in position 2, as illustrated in Fig. 
2.9. Substitution of Eq. (2.I2) into Eq. (2.9) and solution for the slope of the inductor current yields 
(2.13) 
Hence, during the second subinterval the inductor current changes with a negative and essentially con-
stant slope. 
We can now sketch the inductor current waveform (Fig. 2.IO). The inductor current begins at 
some initial value iL(O). During the first subinterval, with the switch in position I, the inductor current 
increases with the slope given in Eq. (2.10). At timet= DTs, the switch changes to position 2. The cur-
rent then decreases with the constant slope given by Eq. (2.13). At timet= Ts, the switch changes back to 
Fig. 2.10 
Steady-state inductor current waveform, 
buck converter. 
iL(DT d_ 
iL(J)t::~v;;o:g:r_-;=~,..-~---"T~;;;;.;;._:.,.~:.----------
_L_ 
L 
0 
DTS 
Jl1i 
.. l 
L 

2.2 
Inductor Volt-Second Balance, Capacitor Charge Balance, and the Small-Ripple Approximation 
19 
position 1, and the process repeats. 
It is of interest to calculate the inductor current ripple !:J.ic As illustrated in Fig. 2.10, the peak 
inductor current is equal to the de component I plus the peak-to-average ripple !:J.iL. This peak current 
flows through not only the inductor, but also through the semiconductor devices that comprise the switch. 
Knowledge of the peak current is necessary when specifying the ratings of these devices. 
Since we know the slope of the inductor current during the first subinterval, and we also know 
the length of the first subinterval, we can calculate the ripple magnitude. The iL(t) waveform is symmetri-
cal about I, and hence during the first subinterval the current increases by 2!:J.iL (since !:J.iL is the peak rip-
ple, the peak-to-peak ripple is 2!:J.iL). So the change in current, 21:J.iL' is equal to the slope (the applied 
inductor voltage divided by L) times the length of the first subinterval (DTJ 
(change in iL) = (slope)(length of subinterval) 
(v- v) 
(2L1iL) = ---7;-- (DT,) 
(2.14) 
Solution for !:J.iL yields 
(2.15) 
Typical values of I:J.iL lie in the range of 10% to 20% of the full-load value of the de component I. It is 
undesirable to allow !:J.iL to become too large; doing so would increase the peak currents of the inductor 
and of the semiconductor switching devices, and would increase their size and cost. So by design the 
inductor.current ripple is also usually small compared to the de component I. The small-ripple approxi-
mation iL(t) "'I is usually justified for the inductor current. 
The inductor value can be chosen such that a desired current ripple !:J.iL is attained. Solution of 
Eq. (2.15) for the inductance L yields 
v- v 
L=-
8 -DT 
2L1iL 
s 
This equation is commonly used to select the value of inductance in the buck converter. 
(2.16) 
It is entirely possible to solve converters exactly, without use of the small-ripple approximation. 
For example, one could use the Laplace transform to write expressions for the waveforms of the circuits 
of Figs. 2.8(a) and 2.8(b). One could then invert the transforms, match boundary conditions, and find the 
periodic steady-state solution of the circuit. Having done so, one could then find the de components of 
the waveforms and the peak values. But this is a great deal of work, and the results are nearly always 
intractable. Besides, the extra work involved in writing equations that exactly describe the ripple is a 
waste of time, since the ripple is small and is undesired. The small-ripple approximation is easy to apply, 
and quickly yields simple expressions for the de components of the converter waveforms. 
The inductor current waveform of Fig. 2.10 is drawn under steady-state conditions, with the 
converter operating in equilibrium. Let's consider next what happens to the inductor current when the 
converter is first turned on. Suppose that the inductor current and output voltage are initially zero, and an 
input voltage V8 is then applied. As shown in Fig. 2.11, iL(O) is zero. During the first subinterval, with the 
switch in position 1, we know that the inductor current will increase, with a slope of (Vg- v)/L and with 
v initially zero. Next, with the switch .in position 2, the inductor current will change with a slope of- v/L; 
since vis initially zero, this slope is essentially zero. It can be seen that there is a net increase in inductor 
current over the first switching period, because iL(T,) is greater than iL(O). Since the inductor current 

20 
Principles of Steady-State Converter Analysis 
i/T,) ..... 
iL(O) = 0 fiL--+--+----+--------------+---1----
0 DT, T, 
2T, 
nT, 
(n + 1)T, 
t 
Fig. 2.11 
Inductor current waveform during converter turn-on transient. 
flows to the output, the output capacitor will charge slightly, and v will increase slightly. The process 
repeats during the second and succeeding switching periods, with the inductor current increasing during 
each subinterval 1 and decreasing during each subinterval 2. 
As the output capacitor continues to charge and v increases, the slope during subinterval 1 
decreases while the slope during subinterval 2 becomes more negative. Eventually, the point is reached 
where the increase in inductor current during subinterval I is equal to the decrease in inductor current 
during subinterval 2. There is then no net change in inductor current over a complete switching period, 
and the converter operates in steady state. The converter waveforms are periodic: iL(nT) = iL((n + l)TJ 
From this point on, the inductor current waveform appears as in Fig. 2.10. 
The requirement that, in equilibrium, the net change in inductor current over one switching 
period be zero leads us to a way to find steady-state conditions in any switching converter: the principle 
of inductor volt-second balance. Given the defining relation of an inductor: 
( ) -LdiL(t) 
VL t -
dt 
(2.17) 
Integration over one complete switching period, say from t = 0 to T,, yields 
(2.18) 
This equation states that the net change in inductor current over one switching period, given by the left-
hand side ofEq. (2.18), is proportional to the integral of the applied inductor voltage over the interval. In 
steady state, the initial and final values of the inductor current are equal, and hence the left -hand side of 
Eq. (2.18) is zero. Therefore, in steady state the integral of the applied inductor voltage must be zero: 
(2.19) 
The right-hand side of Eq. (2.19) has the units of volt-seconds or flux-linkages. Equation (2.19) states 
that the total area, or net volt-seconds, under the vL(t) waveform must be zero. 
An equivalent form is obtained by dividing both sides of Eq. (2.19) by the switching period T,: 
(2.20) 
The right-hand side of Eq. (2.20) is recognized as the average value, or de component, of vL(t). Equation 

22 Inductor Volt-Second Balance, Capacitor Charge Balance, and the Small-Ripple Approximation 
21 
Fig. 2.12 The principle of inductor volt-second 
balance: in steady state, the net volt-seconds applied 
to an inductor (i.e., the total area A) must be zero. 
v- v 
g 
-DT-
·' 
Total area A. 
~ 
I 
-V 
(2.20) states that, in equilibrium, the applied inductor voltage must have zero de component. 
I 
The inductor voltage waveform of Fig. 2.9 is reproduced in Fig. 2.12, with the area under the 
vL(t) curve specifically identified. The total area A is given by the areas of the two rectangles, or 
(2.21) 
The average value is therefore 
(2.22) 
By equating (vL) to zero, and noting that D + D' = l, one obtains 
(2.23) 
Solution for Vyields 
(2.24) 
which coincides with the result obtained previously, Eq. (2.3). So the principle of inductor volt-second 
balance allows us to derive an expression for the de component of the converter output voltage. An 
advantage of this approach is its generality-it can be applied to any converter. One simply sketches the 
applied inductor voltage waveform, and equates the average value to zero. This method is used later in 
.this chapter, to solve several more complicated converters. 
Similar arguments can be applied to capacitors. The defining equation of a capacitor is 
. ( ) _ C dvc(t) 
tc t -
dt 
(2.25) 
Integration of this equation over one switching period yields 
(2.26) 
In steady state, the net change over one switching period of the capacitor voltage must be zero, so that 
the left-hand side of Eq. (2.26) is equal to zero. Therefore, in equilibrium the integral of the capacitor 
current over one switching period (having the dimensions of amp-seconds, or charge) should be zero. 
There is no net change in capacitor charge in steady state. An equivalent statement is 

22 
Principles of Steady-State Converter Analysis 
1 LT, . 
(. ) 
0 = -T 
lc(t)dt = lc 
s 0 
(2.27) 
The average value, or de component, of the capacitor current must be zero in equilibrium. 
This should be an intuitive result. If a de current is applied to a capacitor, then the capacitor will 
charge continually and its voltage will increase without bound. Likewise, if a de voltage is applied to an 
inductor, then the flux will increase continually and the inductor current will increase without bound. 
Equation (2.27), called the principle of capacitor amp-second balance or capacitor charge balance, can 
be used to find the steady-state currents in a switching converter. 
2.3 
BOOST CONVERTER EXAMPLE 
The boost converter, Fig. 2.13(a), is another well-known switched-mode converter that is capable of pro-
ducing a de output voltage greater in magnitude than the de input voltage. A practical realization of the 
switch, using a MOSFET and diode, is shown in Fig. 2.13(b). Let us apply the small-ripple approxima-
tion and the principles of inductor volt-second balance and capacitor charge balance to find the steady-
state output voltage and inductor current for this converter. 
With the switch in position 1, the right-hand side of the inductor is connected to ground, result-
ing in the network of Fig. 2.14(a). The inductor voltage and capacitor current for this subinterval are 
given by 
(2.28) 
Use of the linear ripple approximation, v"' V, leads to 
(a) 
L 
2 
+ 
R 
v 
(b) 
+ 
R 
v 
Fig. 2.13 
Boost converter: (a) with ideal switch, (b) practical realization using MOSFET and diode. 

2.3 
Boost Converter Example 
23 
(a) 
L 
+ 
R 
v 
(b) 
L 
+ 
R 
v 
Fig. 2.14 
Boost converter circuit, (a) while the switch is in position l, (b) while the switch is in position 2. 
(2.29) 
With the switch in position 2, the inductor is connected to the output, leading to the circuit of Fig. 
2.14(b). The inductor voltage and capacitor current are then 
VL=Vg-V 
. 
. 
v 
lc=zL-R 
Use of the small-ripple approximation, v"' V and iL"' I, leads to 
(2.30) 
(2.31) 
Equations (2.29) and (2.31) are used to sketch the inductor voltage and capacitor current waveforms of 
Fig. 2.15. 
Fig. 2.15 
Boost converter voltage 
and current waveforms. 
(b) 
vg 
-
DT, - - D'T,.-
t 
ic(t) 1 
I- VIR 
~ 
DT -~- D't, -t-_ 
-VIR 

24 
Principles of Steady-State Converter Analysis 
Fig. 2.16 De conversion ratio M(D) of 
the boost converter. 
5 
4 
3 
2 
M(D)= b· = 1 ~D 
0 ~----+-----,_-----r----~----~ 
0 
0.2 
0.4 
0.6 
0.8 
D 
It can be inferred from the inductor voltage waveform of Fig. 2.15(a) that the de output voltage 
Vis greater than the input voltage V8. During the first subinterval, vL(t) is equal to the de input voltage V8, 
and positive volt-seconds are applied to the inductor. Since, in steady-state, the total volt-seconds applied 
over one switching period must be zero, negative volt-seconds must be applied during the second sub-
interval. Therefore, the inductor voltage during the second subinterval, (V8 -
V), must be negative. 
Hence, Vis greater than V8 • 
The total volt-seconds applied to the inductor over one switching period are: 
By equating this expression to zero and collecting terms, one obtains 
Vg(D + D')- VD' = 0 
Solution for V, and by noting that (D + D') = 1, yields the expression for the output voltage, 
vg 
V=-
D' 
(2.32) 
(2.33) 
(2.34) 
The voltage conversion ratio M(D) is the ratio of the output to the input voltage of a de-de converter. 
Equation (2.34) predicts that the voltage conversion ratio is given by 
M(D) = .1'_ = ...L = --1-
V8 
D' 
1-D 
(2.35) 
This equation is plotted in Fig. 2.16. At D = 0, V = V8 • The output voltage increases as D increases, and in 
the ideal case tends to infinity as D tends to 1. So the ideal boost converter is capable of producing any 
output voltage greater than the input voltage. There are, of course, limits to the output voltage that can be 
produced by a practical boost converter. In the next chapter, component nonidealities are modeled, and it 
is found that the maximum output voltage of a practical boost converter is indeed limited. Nonetheless, 
very large output voltages can be produced if the nonidealities are sufficiently small. 
The de component of the inductor current is derived by use of the principle of capacitor charge 
balance. During the first subinterval, the capacitor supplies the load current, and the capacitor is partially 
discharged. During the second subinterval, the inductor current supplies the load and, additionally, 
recharges the capacitor. The net change in capacitor charge over one switching period is found by inte-
grating the ic(t) waveform of Fig. 2.15(b ), 

2.3 Boost Converter Example 
25 
Fig. 2.17 
Variation of inductor current de 
I 
VjR 
8 
component I with duty cycle, boost converter. 
6 
4 
2 
0.2 
rs . 
( V) 
( V) , 
Jo zc(t)dt= -R DT,+ I -R DTs 
0.4 
D 
Collecting terms, and equating the result to zero, leads the steady-state result 
0.6 
0.8 
By noting that (D + D') = 1, and by solving for the inductor current de component I, one obtains 
I - v 
- D'R 
(2.36) 
(2.37) 
(2.38) 
So the inductor current de component I is equal to the load current, VIR, divided by D'. Substitution of 
Eq. (2.34) to eliminate Vyields 
(2.39) 
This equation is plotted in Fig. 2.17. It can be seen that the inductor current becomes large as D 
approaches 1. 
This inductor current, which coincides with the de input current in the boost converter, is greater 
than the load current. Physically, this must be the case: to the extent that the converter elements are ideal, 
the converter input and output powers are equal. Since the converter output voltage is greater than the 
input voltage, the input current must likewise be greater than the output current. In practice, the inductor 
current flows through the semiconductor forward voltage drops, the inductor winding resistance, and 
other sources of power loss. As the duty cycle approaches one, the inductor current becomes very large 
and these component nonidealities lead to large power losses. In consequence, the efficiency of the boost 
converter decreases rapidly at high duty cycle. 
Next, let us sketch the inductor current iL(t) waveform and derive an expression for the inductor 
current ripple !'iiL. The inductor voltage waveform vL(t) has been already found (Fig. 2.15), so we can 
sketch the inductor current waveform directly. During the first subinterval, with the switch in position 1, 
the slope of the inductor current is given by 
(2.40) 
Likewise, when the switch is in position 2, the slope of the inductor current waveform is 

26 
Principles of Steady-State Converter Analysis 
Fig. 
2.18 
Boost converter inductor current 
waveform iL(t). 
I 
0 
DT, 
(2.41) 
The inductor current waveform is sketched in Fig. 2.18. During the first subinterval, the change in induc-
tor current, 211iu is equal to the slope multiplied by the length of the subinterval, or 
(2.42) 
Solution for 11iL leads to 
(2.43) 
This expression can be used to select the inductor value L such that a given value of 11iL is obtained. 
Likewise, the capacitor voltage v(t) waveform can be sketched, and an expression derived for 
the output voltage ripple peak magnitude 11v. The capacitor current waveform ic(t) is given in Fig. 2.15. 
During the first subinterval, the slope of the capacitor voltage waveform v(t) is 
(2.44) 
During the second subinterval, the slope is 
(2.45) 
The capacitor voltage waveform is sketched in Fig. 2.19. During the first subinterval, the change in 
capacitor voltage, - 211v, is equal to the slope multiplied by the length of the subinterval: 
- 2Llv = R~ DT, 
Solution for 11v yields 
Fig. 
2.19 
Boost converter output voltage 
waveform v(t). 
v(t) 
v 
(2.46) 
11v 
0 
DT, 
T, 

2.4 
Cuk Converter Example 
27 
L1v = 2Xc DTs 
(2.47) 
This expression can be used to select the capacitor value C to obtain a given output voltage ripple peak 
magnitude ~v. 
2.4 
CUK CONVERTER EXAMPLE 
As a second example, consider the Cuk converter of Fig. 2.20(a). This converter performs a de conver-
sion function similar to the buck-boost converter: it can either increase or decrease the magnitude of the 
de voltage, and it inverts the polarity. A practical realization using a transistor and diode is illustrated in 
Fig. 2.20(b). 
This converter operates via capacitive energy transfer. As illustrated in Fig. 2.21, capacitor C1 is 
connected through L1 to the input source while the switch is in position 2, and source energy is stored in 
C1• When the switch is in position 1, this energy is released through~ to the load. 
The inductor currents and capacitor voltages are defined, with polarities assigned somewhat 
arbitrarily, in Fig. 2.20(a). In this section, the principles of inductor volt-second balance and capacitor 
charge balance are applied to find the de components of the inductor currents and capacitor voltages. The 
voltage and current ripple magnitudes are also found. 
During the first subinterval, while the switch is in position 1, the converter circuit reduces to 
Fig. 2.21(a). The inductor voltages and capacitor currents are: 
(a) 
(b) 
Vu = V8 
vu=-vi-Vz 
ic1 = iz 
• 
• 
Vz 
1c2 = lz-7[ 
+ 
R 
+ 
R 
Fig. 2.20 Cuk converter: (a) with ideal switch, (b) practical realization using MOSFET and diode. 
(2.48) 

28 
Principles of Steady-State Converter Analysis 
(a) 
Ll 
Lz 
i2 
+ 
iC2 
vg 
vl 
c2 
v2 
R 
+ 
(b) 
Ll 
L2 
i2 
+ VL2 -
+ 
+ 
iC2 
vg 
vl 
c2 
vz 
R 
Fig. 2.21 
Cuk converter circuit: (a) while switch is in position 1. (b) while switch is in position 2. 
We next assume that the switching ripple magnitudes in i1(t), i2(t), v1(t), and vz(t) are small compared to 
their respective de components /p /2, Vp and V2. We can therefore make the small-ripple approximation, 
and Eq. (2.48) becomes 
vLl = V8 
Vn =-VI- Vz 
ict = Iz 
. 
I 
Vz 
1cz= z-7[ 
(2.49) 
During the second subinterval, with the switch in position 2, the converter circuit elements are connected 
as in Fig. 2.2l(b). The inductor voltages and capacitor currents are: 
vLl=Vg-v1 
Vn =- Vz 
ict = i1 
.· 
. 
Vz 
lcz = lz -R 
We again make the small-ripple approximation, and hence Eq. (2.50) becomes 
VLl = Vg- VI 
vL2 =- V2 
iC! =I 1 
. 
I 
Vz 
1cz= z-7[ 
(2.50) 
(2.51) 
Equations (2.49) and (2.51) are used to sketch the inductor voltage and capacitor current waveforms in 
Fig. 2.22. 
The next step is to equate the de components, or average values, of the waveforms of Fig. 2.22 

2.4 
Cuk Converter Example 
29 
(a) 
vg 
-
DTS--- D'T.-
(b) 
Fig. 2.22 
Cuk converter waveforms: 
(a) inductor voltage vL1(t), (b) inductor 
voltage vL2(t), (c) capacitor current ic1(t), 
(d) capacitor current icz(t). 
-
DT_, -
-- D'Ts-
(c) 
-
DT_, --- D'Ts-
(d) 
/ 2 - V2/R (= 0) 
to zero, to find the steady-state conditions in the converter. The results are: 
(vu) =DVg + D'(Vg- V1) = 0 
(vu) = D(- Y1- v2) + D'(- V2) = o 
(ic1) = Dl2 + D'/ 1 = 0 
(iC2)=12- ~ =0 
t 
t 
-
t 
-
(2.52) 
Solution of this system of equations for the de components of the capacitor voltages and inductor cur-
rents leads to 
(2.53) 
The dependence of the de output voltage V2 on the duty cycleD is sketched in Fig. 2.23. 
The inductor current waveforms are sketched in Fig. 2.24(a) and 2.24(b); and the capacitor C1 

30 
Principles of Steady-State Converter Analysis 
D 
0 
0.2 
0.4 
0.6 
0.8 
0 
Fig. 
2.23 
De conversion ratio 
-1 
M(D) =- V/Vg of the Cuk converter. 
~ 
-2 
-3 
-4 
M(D)= Vz =-_Q_ 
vg 
1-D 
-5 
voltage waveform v1(t) is sketched in Fig. 2.24(c). During the first subinterval, the slopes of the wave-
forms are given by 
di1(t) 
Vu(t) 
V8 
Clt=--c;-=r; 
diz(t) 
vL2(t) 
- V1 - V2 
Cit= -y:;- = __ 
L_2_ 
dv1(t) 
iCI(t) 
12 
dt=~=c; 
(2.54) 
Equation (2.49) has been used here to substitute for the values of vw vL2, and ic1 during the first subinter-
val. During the second interval, the slopes of the waveforms are given by 
Fig. 2.24 
Cuk converter waveforms: 
(a) inductor current i1(t), (b) inductor 
current i2(t), (c) capacitor voltage v1(t). 
(b) 
(c) 
v 1(t)~ 
v,urrr 
DT, 
T, 

2.5 Estimating the Output Voltage Ripple in Converters Containing Two-Pole Low-Pass Filters 
31 
Equation (2.51) was used to substitute for the values of vw vL2, and ic1 during the second subinterval. 
During the first subinterval, the quantities i1(t), i2(t), and v1(t) change by 2.:1il' - 2.:1i2, and 
- 2.:1vl' respectively. These changes are equal to the slopes given in Eq. (2.54), multiplied by the sub-
interval length DT5 , yielding 
(2.56) 
The de relationships, Eq. (2.53), can now be used to simplify these expressions and eliminate VI' V2, and 
II' leading to 
(2.57) 
These expressions can be used to select values of Lp L2, and Cl' such that desired values of switching 
ripple magnitudes are obtained. 
Similar arguments cannot be used to estimate the switching ripple magnitude in the output 
capacitor voltage v2(t). According to Fig. 2.22(d), the current icz(t) is continuous: unlike vw vL2, and iw 
the capacitor current icz(t) is nonpulsating. If the switching ripple of i2(t) is neglected, then the capacitor 
current icz(t) does not contain an ac component. The small-ripple approximation then leads to the conclu-
sion that the output switching ripple .:1v2 is zero. 
Of course, the output voltage switching ripple is not zero. To estimate the magnitude of the out-
put voltage ripple in this converter, we must not neglect the switching ripple present in the inductor cur-
rent i2(t), since this current iipple is the only source of ac current driving the output capacitor C2. A 
simple way of doing this in the Cuk converter and in other similar converters is discussed in the next sec-
tion. 
2.5 
ESTIMATING THE OUTPUT VOLTAGE RIPPLE IN CONVERTERS CONTAINING 
TWO-POLE LOW-PASS FILTERS 
A case where the small ripple approximation is not useful is in converters containing two-pole low-pass 
filters, such as in the output of the Cuk converter (Fig. 2.20) or the buck converter (Fig. 2.25). For these 

32 
Principles of Steady-State Converter Analysis 
L 
+ 
2 
Fig. 2.25 The buck converter contains a two-pole output filter. 
converters, the small-ripple approximation predicts zero output voltage ripple, regardless of the value of 
the output filter capacitance. The problem is that the only component of output capacitor current in these 
cases is that arising from the inductor current ripple. Hence, inductor current ripple cannot be neglected 
when calculating the output capacitor voltage ripple, and a more accurate approximation is needed. 
An improved approach that is useful for this case is to estimate the capacitor current waveform 
ic(t) more accurately, accounting for the inductor current ripple. The capacitor voltage ripple can then be 
related to the total charge contained in the positive portion of the ic(t) waveform. 
Consider the buck converter of Fig. 2.25. The inductor current waveform iL(t) contains a de 
component I and linear ripple of peak magnitude lliv as shown in Fig. 2.10. The de component I must 
flow entirely through the load resistance R (why?), while the ac switching ripple divides between the 
load resistance R and the filter capacitor C. In a well-designed converter, in which the capacitor provides 
significant filtering of the switching ripple, the capacitance C is chosen large enough that its impedance 
at the switching frequency is much smaller than the load impedance R. Hence nearly all of the inductor 
current ripple flows through the capacitor, and very little flows through the load. As shown in Fig. 2.26, 
the capacitor current waveform ic(t) is then equal to the inductor current waveform with the de compo-
nent removed. The current ripple is linear, with peak value !liL' 
When the capacitor current ic(t) is positive, charge is deposited on the capacitor plates and the 
capacitor voltage vc(t) increases. Therefore, between the two zero-crossings of the capacitor current 
waveform, the capacitor voltage changes between its minimum and maximum extrema. The waveform is 
symmetrical, and the total change in vc is the peak-to-peak output voltage ripple, or 2/lv. 
This change in capacitor voltage can be related to the total charge q contained in the positive 
Fig. 
2.26 Output capacitor voltage 
and current waveforms, for the buck 
converter in Fig. 2.25. 
icf..t) 
Total charge 
q 
vcf..r) 
v ................. ~ ........ :::::::::::::::: ... 
::::J.·~~ ...................................... .J tlv 

2.5 
Estimating the Output Voltage Ripple in Converters Containing Two-Pole Low-Pass Filters 
33 
Fig. 2.27 
Estimating inductor current 
ripple when the inductor voltage wave-
form is continuous. 
iL(t) 
Total 
jlu.x linkage 
f... 
---·-·'·-······················ __ ·:::::r·iii"""""""""""""""""":::::::::.::: .. ::::··::JI:li 
portion of the capacitor current waveform. By the capacitor relation Q = CV, 
q = c(2t.v) 
(2.58) 
As illustrated in Fig. 2.26, the charge q is the integral of the current waveform between its zero crossings. 
For this example, the integral can be expressed as the area of the shaded triangle, having a height l'!.iL. 
Owing to the symmetry of the current waveform, the zero crossings occur at the centerpoints of the DTs 
and D'Ts subintervals. Hence, the base dimension of the triangle is TJ2. So the total charge q is given by 
(2.59) 
Substitution of Eq. (2.58) into Eq. (2.59), and solution for the voltage ripple peak magnitude l'lv yields 
(2.60) 
This expression can be used to select a value for the capacitance C such that a given voltage ripple l'lv is 
obtained. In practice, the additional voltage ripple caused by the capacitor equivalent series resistance 
(esr) must also be included. 
Similar arguments can be applied to inductors. An example is considered in Problem 2.9, in 
which a two-pole input filter is added to a buck converter as in Fig. 2.32. The capacitor voltage ripple 
cannot be neglected; doing so would lead to the conclusion that no ac voltage is applied across the input 
filter inductor, resulting in zero input current ripple. The actual inductor voltage waveform is identical to 
the ac portion of the input filter capacitor voltage, with linear ripple and with peak value l'lv as illustrated 
in Fig. 2.27. By use of the inductor relation A.= Li, a result similar to Eq. (2.60) can be derived. The de~c 
ivation is left as a problem for the student. 

34 
Principles of Steady-State Converter Analysis 
2.6 
1. 
2. 
3. 
4. 
5. 
6. 
SUMMARY OF KEY POINTS 
The de component of a converter waveform is given by its average value, or the integral over one switch-
ing period, divided by the switching period. Solution of a de-de converter to find its de, or steady-state, 
voltages and currents therefore involves averaging the waveforms. 
The linear- (or small-) ripple approximation greatly simplifies the analysis. In a well-designed converter, 
the switching ripples in the inductor currents and capacitor voltages are small compared to the respective 
de components, and can be neglected. 
The principle of inductor volt-second balance allows determination of the de voltage components in any 
switching converter. In steady state, the average voltage applied to an inductor must be zero. 
The principle of capacitor charge balance allows determination of the de components of the inductor cur-
rents in a switching converter. In steady state, the average current applied to a capacitor must be zero. 
By knowledge of the slopes of the inductor current and capacitor voltage waveforms, the ac switching rip-
ple magnitudes may be computed. Inductance and capacitance values can then be chosen to obtain desired 
ripple magnitudes. 
In converters containing multiple-pole filters, continuous (nonpulsating) voltages and currents are applied 
to one or more of the inductors or capacitors. Computation of the ac switching ripple in these elements can 
be done using capacitor charge and/or inductor flux-linkage arguments, without use of the small-ripple 
approximation. 
7. 
Converters capable of increasing (boost), decreasing (buck), and inverting the voltage polarity (buck-boost 
and Cuk) have been described. Converter circuits are explored more fully in the problems and in a later 
chapter. 
REFERENCES 
[1] 
[2] 
[3] 
[4] 
[5] 
[6] 
[7] 
[8] 
S. CUK, "Basics of Switched-Mode Power Conversion: Topologies, Magnetics, and Control," in Advances 
in Switched-Mode Power Conversion, Vol. 2, pp. 279-310, Irvine, CA: Teslaco, 1981. 
N. MOHAN, T. UNDELAND, and W. ROBBINS, Power Electronics: Converters, Applications,. and Design, 
2nd edit., New York: John Wiley & Sons, 1995. 
J. KASSAKIAN, M. SCHLECHT, and G. VERGESE, Principles of Power Electronics, Reading, MA: Addison-
Wesley, 1991. 
R. SEVERNS and G. E. BLOOM, Modern De-to-de Switch Mode Power Converter Circuits, New York: Van 
Nostrand Reinhold, 1985. 
D. HART, Introduction to Power Electronics, New York: Prentice Hall, 1997. 
M. RASHID, Power Electronics: Circuits, Devices, and Applications, 2nd edit., New York: Prentice Hall, 
1993. 
P. KREIN, Elements of Power Electronics, New York: Oxford University Press, 1998. 
K. KIT SUM, Switch Mode Power Conversion-Basic Theory and Design, New York: Marcel Dekker, 
1984. 

Problems 
35 
PROBLEMS 
2.1 
Analysis and design of a buck-boost converter: A buck-boost converter is illustrated in Fig. 2.28(a), and 
a practical implementation using a transistor and diode is shown in Fig. 2.28(b). 
Fig. 2.28 
Buck-boost converter 
of Problem 2.1: (a) ideal converter 
circuit, (b) implementation using 
MOSFET and diode. 
(a) 
(b) 
R 
R 
+ 
v 
+ 
v 
(a) 
Find the dependence of the equilibrium output voltage V and inductor current I on the duty ratio 
D, input voltage Vg, and load resistance R. You may assume that the inductor current ripple and 
capacitor voltage ripple are small. 
(b) 
Plot your results of part (a) over the range 0:;; D:;; 1. 
(c) 
De design: for the specifications 
vc = 3ov 
R=4Q 
(i) 
Find D and I 
V=-20V 
f,= 40kHz 
(ii) 
Calculate the value of L that will make the peak inductor current ripple /'.i equal to ten per-
cent of the average inductor current I. 
(iii) Choose C such that the peak output voltage ripple /'.v is 0.1 V. 
(d) 
Sketch the transistor drain current waveform ir(t) for your design of part (c). Include the effects 
of inductor current ripple. What is the peak value of iT? Also sketch ir(t) for the case when L is 
decreased such that /'.i is 50% of I. What happens to the peak value of iT in this case? 
(e) 
Sketch the diode current waveform iD(t) for the two cases of part (d). 
2.2 
In a certain application, an unregulated de input voltage can vary between 18 and 36 V. It is desired to 
produce a regulated output of 28 V to supply a 2 A load. Hence, a converter is needed that is capable of 
both increasing and decreasing the voltage. Since the input and output voltages are both positive, con-
verters that invert the voltage polarity (such as the basic buck-boost converter) are not suited for this 
application. 
One converter that is capable of performing the required function is the nonisolated SEPIC (sin-
gle-ended primary inductance converter) shown in Fig. 2.29. This converter has a conversion ratio M(D) 
that can both buck and boost the voltage, but the voltage polarity is not inverted. In the normal converter 
operating mode, the transistor conducts during the first subinterval (0 < t < DT.), and the diode conducts 
during the second subinterval (DT, < t < T,). You may assume that all elements are ideal. 
(a) 
Derive expressions for the de components of each capacitor voltage and inductor current, as 
functions of the duty cycleD, the input voltage V8, and the load resistance R. 

36 
Principles of Steady-State Converter Analysis 
Fig. 2.29 
SEPIC of Problems 2.2 and 2.3. 
+ 
v 
Load 
R 
(b) 
A control circuit automatically adjusts the converter duty cycleD, to maintain a constant output 
voltage of V = 28 V. The input voltage slowly varies over the range 18 V s V8 s 36 V. The load 
current is constant and equal to 2 A. Over what range will the duty cycle D vary? Over what 
range will the input inductor current de component / 1 vary? 
2.3 
For the SEPIC of Problem 2.2, 
(a) 
Derive expressions for each inductor current ripple and capacitor voltage ripple. Express these 
quantities as functions of the switching period Ts; the component values Li' L2, Ci' C2; the duty 
cycleD; the input voltage V8 ; and the load resistance R. 
(b) 
Sketch the waveforms of the transistor voltage vDs(t) and transistor current iD(t), and give 
expressions for their peak values. 
2.4 
The switches in the converter of Fig. 2.30 operate synchronously: each is in position 1 for 0 < t < DTs, 
and in position 2 for DTs < t < Ts. Derive an expression for the voltage conversion ratio M(D) = V/V8• 
Sketch M(D) vs. D. 
Fig. 2.30 
H-bridge converter of Problems 2.4 and 2.6. 
2.5 
The switches in the converter of Fig. 2.31 operate synchronously: each is in position 1 for 0 < t < DT5, 
and in position 2 for DT, < t < T5 • Derive an expression for the voltage conversion ratio M(D) = V/V8 • 
Sketch M(D) vs. D. 
L 
2 
Fig. 2.31 
Current-fed bridge converter of Problems 2.5, 2.7, and 2.8. 
2.6 
For the converter of Fig. 2.30, derive expressions for the inductor current ripple /';.iL and the capacitor 
voltage ripple /';.vc-
2.7 
For the converter of Fig. 2.31, derive an analytical expression for the de component of the inductor cur-

Problems 
37 
rent,/, as a function of D, Vg, and R. Sketch your result vs. D. 
2.8 
For the converter of Fig. 2.31, derive expressions for the inductor current ripple !liL and the capacitor 
voltage ripple five-
2.9 
To reduce the switching harmonics present in the input current of a certain buck converter, an input filter 
consisting of inductor L1 and capacitor C 1 is added as shown in Fig. 2.32. Such filters are commonly 
used to meet regulations limiting conducted electromagnetic interference (EMI). For this problem, you 
may assume that all inductance and capacitance values are sufficiently large, such that all ripple magni-
tudes are small. 
LI 
iT 
QI 
Lz 
+ 
+ 
T 
vg 
vei 
DI 
Cz 
R 
v 
Fig. 2.32 Addition of &-C input filter to buck converter, Problem 2.9. 
(a) 
Sketch the transistor current waveform ir(t). 
(b) 
Derive analytical expressions for the de components of the capacitor voltages and inductor cur-
rents. 
(c) 
Derive analytical expressions for the peak ripple magnitudes of the input filter inductor current 
and capacitor voltage. 
(d) 
Given the following values: 
Input voltage 
Output voltage 
Switching frequency 
f, = 100 kHz 
Load resistance 
R = 6 Q 
Select values for L1 and C1 such that (i) the peak voltage ripple on Cl' five!' is two percent of the de 
component Vel• and (ii) the input peak current ripple fii 1 is 20 rnA. 
Extra credit problem: Derive exact analytical expressions for (i) the de component of the output volt-
age, and (ii) the peak-to-peak inductor current ripple, of the ideal buck-boost converter operating in 
steady state. Do not make the small-ripple approximation. 

3 
Steady-State Equivalent Circuit Modeling, 
Losses, and Efficiency 
Let us now consider the basic functions performed by a switching converter, and attempt to represent 
these functions by a simple equivalent circuit. The designer of a converter power stage must calculate the 
network voltages and currents, and specify the power components accordingly. Losses and efficiency are 
of prime importance. The use of equivalent circuits is a physical and intuitive approach which allows the 
well-known techniques of circuit analysis to be employed. As noted in the previous chapter, it is desir-
able to ignore the small but complicated switching ripple, and model only the important de components 
of the waveforms. 
The de transformer is used to model the ideal functions performed by a de-de converter [1-4]. 
This simple model correctly represents the relationships between the de voltages and currents of the con-
verter. The model can be refined by including losses, such as semiconductor forward voltage drops and 
on-resistances, inductor core and copper losses, etc. The resulting model can be directly solved, to find 
the voltages, currents, losses, and efficiency in the actual nonideal converter. 
3.1 
THE DC TRANSFORMER MODEL 
As illustrated in Fig. 3.1, any switching converter contains three ports: a power input, a power output, 
and a control input. The input power is processed as specified by the control input, and then is output to 
the load. Ideally, these functions are performed with 100% efficiency, and hence 
(3.1) 
or, 
(3.2) 

40 
Steady-State Equivalent Circuit Modeling, Losses, and Efficiency 
Power 
input 
I g 
+ 
vg 
-
Fig. 3.1 
Switching converter terminal quantities. 
Ig 
Switching 
de-de 
converter 
D 
Control input 
I 
+ 
v 
-
I 
Power 
~ ·~~~ M(D)T 
Meow, I { I• ; 
input 
Power 
output 
Power 
output 
Fig. 3.2 
A switching converter equivalent circuit using dependent sources, corresponding to Eqs. (3.3) and (3.4). 
These relationships are valid only under equilibrium (de) conditions: during transients, the net stored 
energy in the converter inductors and capacitors may change, causing Eqs. (3.1) and (3.2) to be violated. 
In the previous chapter, we found that we could express the converter output voltage in an equa-
tion of the form 
V=M(D)V8 
(3.3) 
where M(D) is the equilibrium conversion ratio of the converter. For example, M(D) = D for the buck 
converter, and M(D) = 11(1 - D) for the boost converter. In general, for ideal PWM converters operating 
in the continuous conduction mode and containing an equal number of independent inductors and capac-
itors, it can be shown that the equilibrium conversion ratio M is a function of the duty cycle D and is 
independent of load. 
Substitution of Eq. (3.3) into Eq. (3.2) yields 
(3.4) 
Hence, the converter terminal currents are related by the same conversion ratio. 
Equations (3.3) and (3.4) suggest that the converter could be modeled using dependent sources, 
as in Fig. 3.2. An equivalent but more physically meaningful model (Fig. 3.3) can be obtained through 
the realization that Eqs. (3.1) to (3.4) coincide with the equations of an ideal transformer. In an ideal 
transformer, the input and output powers are equal, as stated in Eqs. (3.1) and (3.2). Also, the output volt-
age is equal to the turns ratio times the input voltage. This is consistent with Eq. (3.3), with the turns ratio 
taken to be the equilibrium conversion ratio M(D). Finally, the input and output currents should be 
related by the same turns ratio, as in Eq. (3.4). 
Thus, we can model the ideal de-de converter using the ideal de transformer model of Fig. 3.3. 

Fig. 3.3 Ideal de transformer 
model of a de-de converter 
operating in continuous con-
duction mode, corresponding 
to Eqs. (3.1) to (3.4). 
Power 
input 
+ 
3.1 
The DC Transformer Model 
41 
1: M(D) 
I 
+ 
Power 
v 
output 
Control input 
This symbol represents the first-order de properties of any switching de-de converter: transformation of 
de voltage and current levels, ideally with 100% efficiency, controllable by the duty cycle D. The solid 
horizontal line indicates that the element is ideal and capable of passing de voltages and currents. It 
should be noted that, although standard magnetic-core transformers cannot transform de signals (they 
saturate when a de voltage is applied), we are nonetheless free to define the idealized model of Fig. 3.3 
for the purpose of modeling de-de converters. Indeed, the absence of a physical de transformer is one of 
the reasons for building a de-de switching converter. So the properties of the de-de converter of Fig. 3.1 
can be modeled using the equivalent circuit of Fig. 3.3. An advantage of this equivalent circuit is that, for 
constant duty cycle, it is time invariant: there is no switching or switching ripple to deal with, and only 
the important de components of the waveforms are modeled. 
The rules for manipulating and simplifying circuits containing transformers apply equally well 
to circuits containing de-de converters. For example, consider the network of Fig. 3.4(a), in which a 
resistive load is connected to the converter output, and the power source is modeled by a Thevenin-equiv-
alent voltage source V1 and resistance R1• The converter is replaced by the de transformer model in Fig. 
3.4(b). The elements V1 and R1 can now be pushed through the de transformer as in Fig. 3.4(c); the volt-
Fig. 
3.4 Example of use of the de 
transformer model: (a) original circuit; 
(b) substitution of switching converter de 
transformer model; (c) simplification by 
referring all elements to secondary side. 
(a) 
R1 
.----.JJv-~r---,_----. 
+ 
(c) 
R 
Switching 
de-de 
converter 
D 
+ 
v 
+ 
v 
R 
R 

42 
Steady-State Equivalent Circuit Modeling, Losses, and Efficiency 
age source V1 is multiplied by the conversion ratio M(D), and the resistor R1 is multiplied by M2(D). This 
circuit can now be solved using the voltage divider formula to find the output voltage: 
(3.5) 
It should be apparent that the de transformer/equivalent circuit approach is a powerful tool for under-
standing networks containing converters. 
3.2 
INCLUSION OF INDUCTOR COPPER LOSS 
The de transformer model of Fig. 3.3 can be extended, to model other properties of the converter. Non-
idealities, such as sources of power loss, can be modeled by adding resistors as appropriate. In later chap-
ters, we will see that converter dynamics can be modeled as well, by adding inductors and capacitors to 
the equivalent circuit. 
Let us consider the inductor copper loss in a boost converter. 
Practical inductors exhibit power loss of two types: (1) copper loss, origi-
L 
RL 
nating in the resistance of the wire, and (2) core loss, due to hysteresis and ~ 
eddy current losses in the magnetic core. A suitable model that describes 
Fig. 3.5 Modeling indue-
the inductor copper loss is given in Fig. 3.5, in which a resistor RL is placed 
tor copper loss via series 
in series with the inductor. The actual inductor then consists of an ideal 
resistor Rc 
inductor, L, in series with the copper loss resistor Rc 
The inductor model of Fig. 3.5 is inserted into the boost converter circuit in Fig. 3.6. The circuit 
can now be analyzed in the same manner as used for the ideallossless converter, using the principles of 
inductor volt-second balance, capacitor charge balance, and the small-ripple approximation. First, we 
draw the converter circuits during the two subintervals, as in Fig. 3.7. 
For 0 < t < DTs, the switch is in position 1 and the circuit reduces to Fig. 3.7(a). The inductor 
voltage vL(t), across the ideal inductor L, is given by 
and the capacitor current ic(t) is 
. ( ) _ 
v(t) 
let --R 
(3.6) 
(3.7) 
Next, we simplify these equations by assuming that the switching ripples in i(t) and v(t) are small com-
pared to their respective de components I and V. Hence, i(t) "" I and v(t) "" V, and Eqs. (3.6) and (3.7) 
L 
2 
+ 
c 
R 
v 
Fig. 3.6 Boost converter circuit, including inductor copper resistance R L' 

3.2 
Inclusion of Inductor Copper Loss 
43 
(a) 
+ 
c 
R 
v 
(b) 
+ 
c 
R 
v 
Fig. 3.7 
Boost converter circuits during the two subintervals, including inductor copper loss resistance RL: 
(a) with the switch in position l, (b) with the switch in position 2. 
become 
vL(t) = vg- IRL 
ic(t)=-* 
(3.8) 
For DT, < t < T,, the switch is in position 2 and the circuit reduces to Fig. 3.7(b). The inductor current and 
capacitor voltage are then given by 
vL(t) = vg- i(t)RL- v(t)"' vg- IRL- v 
ic(f) = i(t)- v~) "'I-* 
We again make the small-ripple approximation. 
(3.9) 
The principle of inductor volt-second balance can now be invoked. Equations (3.8) and (3.9) are 
used to construct the inductor voltage waveform vL(t) in Fig. 3.8. The de component, or average value, of 
the inductor voltage vL(t) is 
(3.10) 
By setting ( vL) to zero and collecting terms, one obtains 
(3.11) 
(recall that D + D' = 1). It can be seen that the inductor winding resistance RL adds another term to the 
inductor volt-second balance equation. In the ideal boost converter (RL = 0) example of Chapter 2, we 
were able to solve this equation directly for the voltage conversion ratio V/V8 • Equation (3.11) cannot be 
immediately solved in this manner, because the inductor current I is unknown. A second equation is 
needed, to eliminate I. 

44 
Steady-State Equivalent Circuit Modeling, Losses, and Efficiency 
Fig. 3.8 Inductor voltage and capacitor 
current waveforms, for the nonideal boost 
converter of Fig. 3.6. 
Vg -!RL 
-DTs--
-VIR 
-D'Ts--+ 
t 
Vg -!RL- V 
1- VIR 
t 
The second equation is obtained using capacitor charge balance. The capacitor current ic(t) 
waveform is given in Fig. 3.8. The de component, or average value, of the capacitor current waveform is 
(3.12) 
By setting < ic ) to zero and collecting terms, one obtains 
O=D'I -* 
(3.13) 
We now have two equations, Eqs. (3.11) and (3.13), and two unknowns, V and/. Elimination of I and 
solution for V yields 
(3.14) 
This is the desired solution for the converter output voltage V. It is plotted in Fig. 3.9 for several values of 
R/R. It can be seen that Eq. (3.14) contains two terms. The first, 1/D', is the ideal conversion ratio, with 
RL = 0. The second term, 1/(1 + RJ D'2R), describes the effect of the inductor winding resistance. If RL is 
much less than D'2R, then the second term is approximately equal to unity and the conversion ratio is 
approximately equal to the ideal value 1/D'. However, as RL is increased in relation to D'2R, then the sec-
ond term is reduced in value, and V!Vg is reduced as well. 
. 
As the duty cycleD approaches one, the inductor winding resistance RL causes a major qualita-
tive change in the V/Vg curve. Rather than approaching infinity at D = 1, the curve tends to zero. Of. 
course, it is unreasonable to expect that the converter can produce infinite voltage, and it should be com-
forting to the engineer that the prediction of the model is now more realistic. What happens at D = 1 is 
that the switch is always in position 1. The inductor is never connected to the output, so no energy is 
transferred to the output and the output voltage tends to zero. The inductor current tends to a large value, 
limited only by the inductor resistance RL' A large amount of power is lost in the inductor winding resis-
tance, equal to Vg 2/Rv while no power is delivered to the load; hence, we can expect that the converter 
efficiency tends to zero at D = 1. 
Another implication of Fig. 3.9 is that the inductor winding resistance RL limits the maximum 

3.3 
Construction of Equivalent Circuit Model 
45 
5 
4.5 
4 
3.5 
3 
';:;;.."' 2.5 
:;:: 
2 
1.5 
Fig. 3.9 Output voltage vs. duty cycle, boost converter with inductor copper loss. 
voltage that the converter can produce. For example, with RLIR = 0.02, it can be seen that the maximum 
V/Vg is approximately 3.5. If it is desired to obtain V/Vg = 5, then according to Fig. 3.9 the inductor wind-
ing resistance RL must be reduced to less than 1% of the load resistance R. The only problem is that 
decreasing the inductor winding resistance requires building a larger, heavier, more expensive inductor. 
So it is usually important to optimize the design, by correctly modeling the effects of loss elements such 
as R0 and choosing the smallest inductor that will do the job. We now have the analytical tools needed to 
do this. 
3.3 
CONSTRUCTION OF EQUIVALENT CIRCUIT MODEL 
Next, let us refine the de transformer model, to account for converter losses. This will allow us to deter-
mine the converter voltages, currents, and efficiency using well-known techniques of circuit analysis. 
In the previous section, we used the principles of inductor volt-second balance and capacitor 
charge balance to write Eqs. (3.11) and (3.13), repeated here: 
(vJ =0= Vg-IRL -D'V 
(ic)=O=D'/-* 
(3.15) 
These equations state that the de components of the inductor voltage and capacitor current are equal to 
zero. Rather than algebraically solving the equations as in the previous section, we can reconstruct a cir-
cuit model based on these equations, which describes the de behavior of the boost converter with induc-
tor copper loss. This is done by constructing a circuit whose Kirchoff loop and node equations are 

46 
Steady-State Equivalent Circuit Modeling, Losses, and Efficiency 
Fig. 
3.10 Circuit whose loop equation is identical to 
. Eq. (3.16), obtained by equating the average inductor voltage 
( vL) to zero. 
identical to Eqs. (3.15). 
3.3.1 
Inductor Voltage Equation 
D'V 
(3.16) 
This equation was derived by use of Kirchoff's voltage law to find the inductor voltage during each sub-
interval. The results were averaged and set to zero. Equation (3.16) states that the sum of three terms hav-
ing the dimensions of voltage are equal to (vJ, or zero. Hence, Eq. (3.16) is of the same form as a loop 
equation; in particular, it describes the de components of the voltages around a loop containing the 
inductor, with loop current equal to the de inductor current/. 
So let us construct a circuit containing a loop with current/, corresponding to Eq. (3.16). The 
first term in Eq. (3.16) is the de input voltage V8, so we should include a voltage source of value Vg as 
shown in Fig. 3.10. The second term is a voltage drop of value /R0 which is proportional to the current I 
in the loop. This term corresponds to a resistance of value RL. The third term is a voltage D'V, dependent 
on the converter output voltage. For now, we can model this term using a dependent voltage source, with 
polarity chosen to satisfy Eq. (3.16). 
3.3.2 
Capacitor Current Equation 
(3.17) 
This equation was derived using Kirchoff's current law to find the capacitor current during each subinter-
val. The results were averaged, and the average capacitor current was set to zero. 
Equation (3.17) states that the sum of two de currents are equal to ( ic ), or zero. Hence, Eq. 
(3.17) is of the same form as a node equation; in particular, it describes the de components of currents 
Fig. 3.11 
Circuit whose node equation is identical to Eq. (3.17), 
obtained by equating the average capacitor current (ic) to zero. 
D'I 
' tj 
' ' 
Node 
) 
VIR 
+ 
v 
R 

3.3 
Construction of Equivalent Circuit Model 
47 
+ 
D'V 
D'I 
v 
R 
Fig. 3.12 The circuits of Figs. 3.10 and 3.11, drawn together. 
+ 
v 
R 
Fig. 3.13 Equivalent circuit model of the boost converter, including aD': 1 de transformer and the inductor wind-
ing resistance R L' 
flowing into a node connected to the capacitor. The de capacitor voltage is V. 
So now let us construct a circuit containing a node connected to the capacitor, as in Fig. 3.11, 
whose node equation satisfies Eq. (3.17). The second term in Eq. (3.17) is a current of magnitude VIR, 
proportional to the de capacitor voltage V. This term corresponds to a resistor of value R, connected in 
parallel with the capacitor so that its voltage is V and hence its current is VIR. The first term is a current 
D'I, dependent on the de inductor current I. For now, we can model this term using a dependent current 
source as shown. The polarity of the source is chosen to satisfy Eq. (3.17). 
3.3.3 
Complete Circuit Model 
The next step is to combine the circuits of Figs. 3.10 and 3.11 into a single circuit, as in Fig. 3.12. This 
circuit can be further simplified by recognizing that the dependent voltage and current sources constitute 
an ideal de transformer, as discussed in Section 3.1. The D'V dependent voltage source depends on V, the 
voltage across the dependent current source. Likewise, the D'I dependent current source depends on I, 
the current flowing through the dependent voltage source. In each case, the coefficient is D'. Hence, the 
dependent sources form a circuit similar to Fig. 3.2; the fact that the voltage source appears on the pri-
mary rather than the secondary side is irrelevant, owing to the symmetry of the transformer. They are 
therefore equivalent to the de transformer model of Fig. 3.3, with turns ratio D':l. Substitution of the 
ideal de transformer model for the dependent sources yields the equivalent circuit of Fig. 3.13. 
The equivalent circuit model can now be manipulated and solved to find the converter voltages 
and currents. For example, we can eliminate the transformer by referring the V8 voltage source and RL 
resistance to the secondary side. As shown in Fig. 3.14, the voltage source value is divided by the effec-
tive turns ratio D', and the resistance RL is divided by the square of the turns ratio, D'2. This circuit can be 
solved directly for the output voltage V, using the voltage divider formula: 

48 
Steady-State Equivalent Circuit Modeling, Losses, and Efficiency 
Fig. 3.14 Simplification of the equivalent circuit of 
Fig. 3.13, by referring all elements to the secondary 
side of the transformer. 
+ 
v 
R 
(3.18) 
This result is identical to Eq. (3.14). The circuit can also be solved directly for the inductor current/, by 
referring all elements to the transformer primary side. The result is: 
(3.19) 
3.3.4 
Efficiency 
The equivalent circuit model also allows us to compute the converter efficiency 11· Figure 3.13 predicts 
that the converter input power is 
(3.20) 
The load current is equal to the current in the secondary of the ideal de transformer, or D'I. Hence, the 
model predicts that the converter output power is 
pout= (V) (D'/) 
(3.21) 
Therefore, the converter efficiency is 
(3.22) 
Substitution ofEq. (3.18) into Eq. (3.22) to eliminate Vyields 
(3.23) 
This equation is plotted in Fig. 3.15, for several values of RjR. It can be seen from Eq. (3.23) that, to 
obtain high efficiency, the inductor winding resistance RL should be much smaller that D'2R, the load 
resistance referred to the primary side of the ideal de transformer. This is easier to do at low duty cycle, 
where D' is close to unity, than at high duty cycle where D' approaches zero. It can be seen from Fig. 

3.3 
Construction of Equivalent Circuit Model 
49 
100% 
90% 
80% 
70% 
60% 
11 
50% 
40% 
30% 
20% 
10% 
0% 
0 
0.1 
0.2 
0.3 
0.4 
0.5 
0.6 
0.7 
0.8 
0.9 
D 
Fig. 3.15 
Efficiency vs. duty cycle, boost converter with inductor copper loss. 
3.15 that the efficiency is typically high at low duty cycles, but decreases rapidly to zero near D = 1. 
Thus, the basic de transformer model can be refined to include other effects, such as the induc-
tor copper loss. The model describes the basic properties of the converter, including (a) transformation of 
de voltage and current levels, (b) second-order effects such as power losses, and (c) the conversion ratio 
M. The model can be solved to find not only the output voltage V, but also the inductor current I and the 
efficiency 11· All of the well-known techniques of circuit analysis can be employed to solve the model, 
making this a powerful and versatile approach. 
The example considered so far is a relatively simple one, in which there is only a single loss ele-
ment, RL. Of course, real converters are considerably more complicated, and contain a large number of 
loss elements. When solving a complicated circuit to find the output voltage and efficiency, it behooves 
the engineer to use the simplest and most physically meaningful method possible. Writing a large num-
ber of simultaneous loop or node equations is not the best approach, because its solution typically 
requires several pages of algebra, and the engineer usually makes algebra mistakes along the way. The 
practicing engineer often gives up before finding the correct solution. The equivalent circuit approach 
avoids this situation, because one can simplify the circuit via well-known circuit manipulations such as 
pushing the circuit elements to the secondary side of the transformer. Often the answer can then be writ-
ten by inspection, using the voltage divider rule or other formulas. The engineer develops confidence that 
the result is correct, and does not contain algebra mistakes. 

50 
Steady-State Equivalent Circuit Modeling, Losses, and Efficiency 
Fig. 3.16 Buck converter example. 
+ 
2 
c 
R 
3.4 
HOW TO OBTAIN THE INPUT PORT OF THE MODEL 
Let's try to derive the model of the buck converter of Fig. 3.16, using the procedure of Section 3.3: The 
inductor winding resistance is again modeled by a series resistor RL' 
The average inductor voltage can be shown to be 
(3.24) 
This equation describes a loop with the de inductor current IL. The de components of the voltages around 
this loop are: (i) the DV8 term, modeled as a dependent voltage source, (ii) a voltage drop ILRL, modeled 
as resistor Rv and (iii) the de output voltage V c 
The average capacitor current is 
(3.25) 
This equation describes the de currents flowing into the node connected to the capacitor. The de compo-
nent of inductor current, IL, flows into this node. The de load current VciR (i.e., the current flowing 
through the load resistor R) flows out of this node. An equivalent circuit that models Eqs. (3.24) and 
(3.25) is given in Fig. 3.17. This circuit can be solved to determine the de output voltage Vc 
What happened to the de transformer in Fig. 3.17? We expect the buck converter model to con-
tain a de transformer, with turns ratio equal to the de conversion ratio, or 1:D. According to Fig. 3.2, the 
secondary of this transformer is equivalent to a dependent voltage source, of value DV8 • Such a source 
does indeed appear in Fig. 3.17. But where is the primary? From Fig. 3.2, we expect the primary of the 
de transformer to be equivalent to a dependent current source. In general, to derive this source, it is nec-
essary to find the de component of the converter input current i/t). 
The converter input current waveform i/t) is sketched in Fig. 3.18. When the switch is in posi-
tion 1, i/t) is equal to the inductor current. Neglecting the inductor current ripple, we have i/t) "'fL. 
When the switch is in position 2, i/t) is zero. The de component, or average value, of i/t) is 
Fig. 
3.17 Equivalent circuit derived from 
Eqs. (3.24) and (3.25). 
... .,~ ,.-< ~ 
+ (vL)-
=0 G 
RL 
+ 
Vc!R 
(ic) + : 
= 0 - -~-
Vc 
R 

Fig. 
3.18 Converter input current 
waveform i8(1). 
0 
Fig. 3.19 Converter input port de equivalent circuit. 
Fig. 3.20 The circuits of Figs. 3.17 and 
3.19, drawn together. 
Fig. 3.21 
Equivalent circuit of the buck 
converter, including a 1 :D de transformer 
and the inductor winding resistance Rc 
3.4 How to Obtain the Input Port of the Model 
51 
0 
+ 
R 
+ 
R 
1 i. T, . 
18 =T 
·t/f)dt=DIL 
s 
0 
(3.26) 
The integral of i8(t) is equal to the area under the i/t) curve, or DT )L according to Fig. 3.18. The de com-
ponent 18 is therefore (DTJJ!Ts = DIL. Equation (3.26) states that 18, the de component of current drawn 
by the converter out of the V8 source, is equal to DIL. An equivalent circuit is given in Fig. 3.19. 
A complete model for the buck converter can now be obtained by combining Figs. 3.17 and 
3.19 to obtain Fig. 3.20. The dependent current and voltage sources can be combined into a de trans-
former, since the DV8 dependent voltage source has value D times the voltage V8 across the dependent 
current source, and the current source is the same constant D times the current IL through the dependent 
voltage source. So, according to Fig. 3.2, the sources are equivalent to a de transformer with turns ratio 
l:D, as shown in Fig. 3.21. 
In general, to obtain a complete de equivalent circuit that models the converter input port, it is 
necessary to write an equation for the de component of the converter input current. An equivalent circuit 

52 
Steady-State Equivalent Circuit Modeling, Losses, and Efficiency 
corresponding to this equation is then constructed. In the case of the buck converter, as well as in other 
converters having pulsating input currents, this equivalent circuit contains a dependent current source 
which becomes the primary of a de transformer model. In the boost converter example of Section 3.3, it 
was unnecessary to explicitly write this equation, because the input current igCt) coincided with the 
inductor current i(t), and hence a complete equivalent circuit could be derived using only the inductor 
voltage and capacitor current equations. 
3.5 
EXAMPLE: INCLUSION OF SEMICONDUCTOR CONDUCTION LOSSES IN THE 
BOOST CONVERTER MODEL 
As a final example, let us consider modeling semiconductor conduction losses in the boost converter of 
Fig. 3.22. Another major source of power loss is the conduction loss due to semiconductor device for-
ward voltage drops. The forward voltage of a metal oxide semiconductor field-effect tran'sistor (MOS-
FET) or bipolar junction transistor (BJT) can be modeled with reasonable accuracy as an on-resistance 
Ron· In the case of a diode, insulated-gate bipolar transistor (IGBT), or thyristor, a voltage source plus an 
on-resistance yields a model of good accuracy; the on-resistance may be omitted if the converter is being 
modeled at a single operating point. 
When the gate drive signal is high, the MOSFET turns on and the diode is reverse-biased. The 
circuit then reduces to Fig. 3.23(a). In the conducting state, the MOSFET is modeled by the on-resistance 
Ron· The inductor winding resistance is again represented as in Fig. 3.5. The inductor voltage and capaci-
tor current are given by 
VL(t) = Vg- iRL- iR 011 "' V8 -/RL- fR011 
ic(t) =- -R- "'-* 
(3.27) 
The inductor current and capacitor voltage have again been approximated by their de components. 
When the gate drive signal is low, the MOSFET turns off. The diode becomes forward-biased 
by the inductor current, and the circuit reduces to Fig. 3.23(b). In the conducting state, the diode is mod-
eled in this example by voltage source V0 and resistance R0 . The inductor winding resistance is again 
modeled by resistance RL' The inductor voltage and capacitor current for this subinterval are 
(3.28) 
The inductor voltage and capacitor current waveforms are sketched in Fig. 3.24. 
L 
+ 
b 
c 
R 
v 
Fig. 3.22 Boost converter example. 

3.5 example: Inclusion of Semiconductor Conduction Losses in the Boost Converter Model 
53 
(a) 
+ 
c 
R 
v 
(b) 
+ 
R 
v 
Fig. 3.23 
Boost converter circuits: (a) when MOSFET conducts, (b) when diode conducts. 
The de component of the inductor voltage is given by 
(3.29) 
By collecting terms and noting that D + D' = 1, one obtains 
(3.30) 
This equation describes the de components of the voltages around a loop containing the inductor, with 
loop current equal to the de inductor current I. An equivalent circuit is given in Fig. 3.25. 
Fig. 3.24 
Inductor voltage vL(t) and 
capacitor current ic(t) waveforms, for 
the converter of Fig. 3.22. 
Vg - IRL- IRon 
-Drs--
D'Ts-
vg -IRL- vD-IRD- v 
I- VIR 
-VIR 
t 
t 

54 
Steady-State Equivalent Circuit Modeling, Losses, and Efficiency 
D'VD 
D'RD 
Fig. 
3.25 Equivalent circuit 
corresponding to Eq. (3.30). 
+ !D'RD-
vg 
0 
D'V 
VIR 
+ 
Fig. 
3.26 Equivalent circuit 
corresponding to Eq. (3.32). 
D'I 
v 
R 
The de component of the capacitor current is 
(3.31) 
Upon collecting terms, one obtains 
(3.32) 
This equation describes the de components of the currents flowing into a node connected to the capacitor, 
with de capacitor voltage equal to V. An equivalent circuit is given in Fig. 3.26. 
The two circuits are drawn together in 3.27. The dependent sources are combined into an ideal 
D':l transformer in Fig. 3.28, yielding the complete de equivalent circuit model. 
Solution of Fig. 3.28 for the output voltage Vyields 
(3.33) 
+ 
v 
R 
Fig. 3.27 The circuits of Figs. 3.25 and 3.26, drawn together. 

3.5 Example: Inclusion of Semiconductor Conduction Losses in the Boost Converter Model 
55 
+ 
v 
R 
Fig. 3.28 
Equivalent circuit model of the boost converter of Fig. 3.22, including ideal de transformer, inductor 
winding resistance, and MOSFET and diode conduction losses. 
Dividing by Vg gives the voltage conversion ratio: 
(3.34) 
It can be seen that the effect of the loss elements V0 , Rv R""' and R0 is to decrease the voltage conversion 
ratio below the ideal value (1/D'). 
The efficiency is given by Yl = P0 jPin" From Fig. 3.28, Pin= V/ and Pout= VD'I. Hence, 
(3.35) 
For high efficiency, we require 
VjD'» V0 
D' 2R >> RL + DR0 , + D'Ro 
(3.36) 
It may seem strange that the equivalent circuit model of Fig. 3.28 contains effective resistances DR on and 
D'R0 , whose values vary with duty cycle. The reason for this dependence is that the semiconductor on-
resistances are connected in the circuit only when their respective semiconductor devices conduct. For 
example, at D = 0, the MOSFET never conducts, and the effective resistance DRon disappears from the 
model. These effective resistances correctly model the average power losses in the elements. For 
instance, the equivalent circuit predicts that the power loss in the MOSFET on-resistance is PDRon· In 
the actual circuit, the MOSFET conduction loss is PRon while the MOSFET conducts, and zero while the 
MOSFET is off. Since the MOSFET conducts with duty cycleD, the average conduction loss is DPR00 , 
which coincides with the prediction of the model. 
In general, to predict the power loss in a resistor R, we must calculate the root-mean-square cur-
rent Inns through the resistor, rather than the average current. The average power loss is then given by 
Im}R. Nonetheless, the average model of Fig. 3.28 correctly predicts average power loss, provided that 
the inductor current ripple is small. For example, consider the MOSFET conduction loss in the buck con-
verter. The actual transistor current waveform is sketched in Fig. 3.29, for several values of inductor cur-
rent ripple t;.i. Case (a) corresponds to use of an infinite inductance L, leading to zero inductor current 
ripple. As shown in Table 3.1, the MOSFET conduction loss is then given by Im}R00 = DI2Ron' which 

56 
Steady-State Equivalent Circuit Modeling, Losses, and Efficiency 
i(t) 
Fig. 3.29 Transistor current waveform, for various 
filter inductor values: (a) with a very large inductor, 
such that D.i "' 0; (b) with a typical inductor value, 
such that D.i = 0. ll; (c) with a small inductor value, 
chosen such that D.i = I. 
0 
0 
agrees exactly with the prediction of the average model. Case (b) is a typical choice of inductance L, 
leading to an inductor current ripple of D.i = 0.11. The exact MOSFET conduction loss, calculated using 
the rms value of MOSFET current, is then only 0.33% greater than the prediction of the average model. 
In the extreme case (c) where D.i ==I, the actual conduction loss is 33% greater than that predicted by the 
average model. Thus, the de (average) model correctly predicts losses in the component nonidealities, 
even though rms currents are not calculated. The model is accurate provided that the inductor current rip-
ple is small. 
Talble 3.1 
Effect of inductor current ripple on MOSFET conduction Joss 
3.6 
1. 
2. 
3. 
Inductor current ripple 
MOSFET rms current 
Average power Joss in R011 
(a) D.i=O 
IJD 
(b) D.i=0.1i 
( 1.00167)I JD 
(c) D.i=I 
( 1.155)I JD 
SUMMARY OF KEY POINTS 
The de transformer model represents the primary functions of any de-de converter: transformation of de 
voltage and current levels, ideally with 100% efficiency, and control of the conversion ratio M via the duty 
cycle D. This model can be easily manipulated and solved using familiar techniques of conventional cir-
cuit analysis. 
The model can be refined to account for Joss elements such as inductor winding resistance and semicon-
ductor on-resistances and forward voltage drops. The refined model predicts the voltages, currents, and 
efficiency of practical nonideal converters. 
In general, the de equivalent circuit for a converter can be derived from the inductor volt-second balance 
and capacitor charge balance equations. Equivalent circuits are constructed whose loop and node equa-
tions coincide with the volt-second and charge balance equations. In converters having a pulsating input 
current, an additional equation is needed to model the converter input port; this equation may be obtained 
by averaging the converter input current. 
REFERENCES 
[l] 
R. D. MIDDLEBROOK, "A Continuous Model for the Tapped-Inductor Boost Converter," IEEE Power Elec-
tronics Specialists Conference, 1975 Record, pp. 63-79, June 1975. 

Problems 
57 
[2] 
S. M. CUK, "Modeling, Analysis, and Design of Switching Converters," Ph.D. thesis, California Institute 
of Technology, November 1976. 
[3] 
G. WESTER and R. D. MIDDLEBROOK, "Low-Frequency Characterization of Switched De-De Converters," 
IEEE Transactions on Aerospace and Electronic Systems, Vol. AES-9, pp. 376-385, May 1973. 
[4] 
R. D. MIDDLEBROOK and S.M. CUK, "Modeling and Analysis Methods for De-to-De Switching Convert-
ers," IEEE International Semiconductor Power Converter Conference, 1977 Record, pp. 90-111. 
PROBLEMS 
3.1 
In the buck-boost converter of Fig. 3.30, the inductor has winding resistance RL" All other losses can be 
ignored. 
(a) 
Derive an expression for the nonideal voltage conversion ratio V!V8• 
(b) 
Plot your result of part (a) over the range 0 :5 D :5 1, for RJR = 0, 0.01, and 0.05. 
(c) 
Derive an expression for the efficiency. Manipulate your expression into a form similar to Eq. 
(3.35) 
+ 
v 
Fig. 3.30 Nonideal buck-boost converter, Problems 3.1 and 3.2. 
3.2 
The inductor in the buck-boost converter of Fig. 3.30 has winding resistance RL. All other losses can be 
ignored. Derive an equivalent circuit model for this converter. Your model should explicitly show the 
input port of the converter, and should contain two de transformers. 
3.3 
In the converter of Fig. 3.31, the inductor has winding resistance RL. All other losses can be ignored. The 
switches operate synchronously: each is in position 1 for 0 < t < DT9 , and in position 2 for DT9 < t < T9• 
(a) 
Derive an expression for the nonideal voltage conversion ratio V!V8. 
(b) 
Plot your result of part (a) over the range 0 :5 D :5 1, for RJR = 0, 0.01, and 0.05. 
(c) 
Derive an expression for the efficiency. Manipulate your expression into a form similar to Eq. 
(3.35) 
L 
2 
Fig. 3.31 
Nonideal current-fed bridge converter, Problems 3.3 and 3.4. 
3.4 
The inductor in the converter of Fig. 3.31 has winding resistance RL. All other losses can be ignored. 
Derive an equivalent circuit model for this converter. 

58 
Steady-State Equivalent Circuit Modeling, Losses, and Efficiency 
+ 
R 
v 
Fig. 3.32 
Nonideal buck converter, Problem 3.5. 
3.5 
In the buck converter of Fig. 3.32, the MOSFET has on-resistance Ron and the diode forward voltage 
drop can be modeled by a constant voltage source V 0 . All other losses can be neglected. 
(a) 
Derive a complete equivalent circuit model for this converter. 
(b) 
Solve your model to find the output voltage V. 
(c) 
Derive an expression for the efficiency. Manipulate your expression into a form similar to Eq. 
(3.35). 
3.6 
To reduce the switching harmonics present in the input current of a certain buck converter, an input filter 
is added as shown in Fig. 3.33. Inductors L1 and L2 contain winding resistances RLI and RL2, respec-
tively. The MOSFET has on-resistance Ron' and the diode forward voltage drop can be modeled by a 
constant voltage V 0 plus a resistor R0 . All other losses can be ignored. 
+ 
R 
v 
Fig. 3.33 
Buck converter with input filter, Problem 3.6. 
(a) 
Derive a complete equivalent circuit model for this circuit. 
(b) 
Solve your model to find the de output voltage V. 
(c) 
Derive an expression for the efficiency. Manipulate your expression into a form similar to Eq. 
(3.35). 
3.7 
A 1.5 V battery is to be used to power a 5 V, I A load. It has been decided to use a buck-boost converter 
in this application. A suitable transistor is found with an on-resistance of 35 mQ, and a Schottky diode is 
found with a forward drop of 0.5 V. The on-resistance of the Schottky diode may be ignored. The power 
stage schematic is shown in Fig. 3.34. 
lA 
+ 
5V 
Load 
.(,=40kHz 
Fig. 3.34 
Nonideal buck-boost converter powering a 5 V load from a 1.5 V battery, Problem 3.7 

Problems 
59 
(a) 
Derive an equivalent circuit that models the de properties of this converter. Include the transistor 
and diode conduction losses, as well as the inductor copper loss, but ignore all other sources of 
loss. Your model should correctly describe the converter de input port. 
(b) 
It is desired that the converter operate with at least 70% efficiency under nominal conditions 
(i.e., when the input voltage is 1.5 V and the output is 5 V at 1 A). How large can the inductor 
winding resistance be? At what duty cycle will the converter then operate? Note: there is an easy 
way and a not-so-easy way to analytically solve this part. 
(c) 
For your design of part (b), compute the power loss in each element. 
(d) 
Plot the converter output voltage and efficiency over the range 0 S D S 1, using the value of 
inductor winding resistance which you selected in part (b). 
(e) 
Discuss your plot of part (d). Does it behave as you expect? Explain. 
For Problems 3.8 and 3.9, a transistor having an on-resistance of 0.5 Q is used. To simplify the problems, you 
may neglect all losses other than the transistor conduction loss. You may also neglect the dependence of MOS-
FET on-resistance on rated blocking voltage. These simplifying assumptions reduce the differences between 
converters, but do not change the conclusions regarding which converter performs best in the given situations. 
3.8 
It is desired to interface a 500 V de source to a 400 V, 10 A load using a de-de converter. Two possible 
approaches, using buck and buck-boost converters, are illustrated in Fig. 3.35. Use the assumptions 
described above to: 
(a) 
Derive equivalent circuit models for both converters, which model the converter input and out-
put ports as well as the transistor conduction loss. 
(b) 
Determine the duty cycles that cause the converters to operate with the specified conditions. 
(c) 
Compare the transistor conduction losses and efficiencies of the two approaches, and conclude 
which converter is better suited to the specified application. 
(a) 
lOA 
+ 
+ 
soov 
400V 
(b) 
lOA 
+ 
soov 
400V 
+ 
Fig. 3.35 
Problem 3.8: interfacing a 500 V source to a 400 V load, using (a) a buck converter, (b) a 
buck-boost converter. 
3.9 
It is desired to interface a 300 V battery to a 400 V, 10 A load using a de-de converter. Two possible 
approaches, using boost and buck-boost converters, are illustrated in Fig. 3.36. Using the assumptions 
described above (before Problem 3.8), determine the efficiency and power loss of each approach. Which 
converter is better for this application? 

60 
Steady-State Equivalent Circuit Modeling, Losses, and Efficiency 
(a) 
+ 
+ 
300V 
400V 
(b) 
lOA 
+ 
300V 
400V 
+ 
Fig. 3.36 Problem 3.9: interfacing a 300 V battery to a 400 V load, using: (a) a boost converter, (b) a 
buck-boost converter. 
3.10 
A buck converter is operated from the rectified 230 V ac mains, such that the converter de input voltage 
IS 
V8 = 325 v ± 20% 
A control circuit automatically adjusts the converter duty cycleD, to maintain a constant de output volt-
age of V = 240 V de. The de load current I can vary over a 10: 1 range: 
lOA::;J:s;lA 
The MOSFET has an on-resistance ofO.S Q. The diode conduction loss can be modeled by a 0.7 V 
source in series with a 0.2 Q resistor. All other losses can be neglected. 
(a) 
Derive an equivalent circuit that models the converter input and output ports, as well as the loss 
elements described above. 
(b) 
Given the range of variation of V8 and I described above, over what range will the duty cycle 
vary? 
(c) 
At what operating point (i.e., at what value of V8 and I) is the converter power loss the largest? 
What is the value of the efficiency at this operating point? 
3.11 
In the Cuk converter of Fig. 3.37, the MOSFET has on-resistance R0 , and the diode has a constant for-
ward voltage drop V D· All other losses can be neglected. 
+ 
R 
v 
Fig. 3.37 Cuk converter, Problem 3.11. 
(a) 
Derive an equivalent circuit model for this converter. Suggestion: if you don't know how to han-
dle some of the terms in your de equations, then temporarily leave them as dependent sources. A 
more physical representation of these terms may become apparent once de transformers are 
incorporated into the model. 

Problems 
61 
(b) 
Derive analytical expressions for the converter output voltage and for the efficiency. 
(c) 
For V0 = 0, plot VIV8 vs. Dover the range 0:5 D :51, for (i) R0JR = 0.01, and (ii) R0.fR = 0.05. 
(d) 
For V0 = 0, plot the converter efficiency over the range 0 :5 D :5 1, for (i) R0JR = 0.01, and (ii) 
R0JR=0.05. 

4 
Switch Realization 
We have seen in previous chapters that the switching elements of the buck, boost, and several other de-de 
converters can be implemented using a transistor and diode. One might wonder why this is so, and how 
to realize semiconductor switches in general. These are worthwhile questions to ask, and switch imple-
mentation can depend on the power processing function being performed. The switches of inverters and 
cycloconverters require more complicated implementations than those of de-de converters. Also, the way 
in which a semiconductor switch is implemented can alter the behavior of a converter in ways not pre-
dicted by the ideal-switch analysis of the previous chapters-an example is the discontinuous conduction 
mode treated in the next chapter. The realization of switches using transistors and diodes is the subject of 
this chapter. 
Semiconductor power devices behave as single-pole single-throw 
(SPST) switches, represented ideally in Fig. 4.!. So, although we often draw 
converter schematics using ideal single-pole double-throw (SPDT) switches as 
in Fig. 4.2(a), the schematic of Fig. 4.2(b) containing SPST switches is more 
realistic. The realization of a SPDT switch using two SPST switches is not as 
trivial as it might at first seem, be.cause Fig. 4.2(a) and 4.2(b) are not exactly 
equivalent. It is possible for both SPST switches to be simultaneously in the on 
state or in the off state, leading to behavior not predicted by the SPDT switch 
of Fig. 4.2(a). In addition, it is possible for the switch state to depend on the 
Fig. 4.1 SPST switch, 
applied voltage or current waveforms-a familiar example is the diode. Indeed, 
with defined voltage and 
it is common for these phenomena to occur in converters operating at light 
current polarities. 
load, or occasionally at heavy load, leading to the discontinuous conduction 
mode previously mentioned. The converter properties are then significantly modified. 
How an ideal switch can be realized using semiconductor devices depends on the polarity of the 
voltage that the devices must block in the off state, and on the polarity of the current that the devices 

64 
Switch Realization 
(a) 
Fig. 
4.2 Buck converter: (a) contammg 
SPDT switch, (b) containing two SPST 
switches. 
(b) 
L 
2 
+ 
c 
R 
v 
+ 
c 
R 
v 
must conduct in the on state. For example, in the de-de buck converter of Fig. 4.2(b ), switch A must 
block positive voltage Vg when in the off state, and must conduct positive current iL when in the on state. 
If, for all intended converter operating points, the current and blocking voltage lie in a single quadrant of 
the plane as illustrated in Fig. 4.3, then the switch can be implemented in a simple manner using a tran-
sistor or a diode. Use of single-quadrant switches is common in de-de converters .. Their operation is dis-
cussed briefly here. 
In inverter circuits, two-quadrant switches are 
required. The output current is ac, and hence is some-
times positive and sometimes negative. If this current 
flows through the switch, then its current is ac, and the 
semiconductor switch realization is more complicated. 
A two-quadrant SPST switch can be realized using a 
transistor and diode. The dual case also sometimes 
occurs, in which the switch current is always positive, 
but the blocking voltage is ac. This type of two-quadrant 
switch can be constructed using a different arrangement 
of a transistor and diode. Cycloconverters generally 
require four-quadrant switches, which are capable of 
blocking ac voltages and conducting ac currents. Real-
izations of these elements are also discussed in this 
chapter. 
Next, the synchronous rectifier is examined. 
The reverse-conducting capability of the metal oxide 
Switch 
on state 
current 
Switch 
off state voltage 
Fig. 4.3 A single-quadrant switch is capable of 
conducting currents of a single polarity, and of 
blocking voltages of a single polarity. 
semiconductor field-effect transistor (MOSFET) allows it to be used where a diode would normally be 
required. If the MOSFET on-resistance is sufficiently small, then its conduction loss is less than that 
obtained using a diode. Synchronous rectifiers are sometimes used in low-voltage high-current applica-
tions to obtain improved efficiency. Several basic references treating single-, two-, and four-quadrant 

4.1 Switch Applications 
65 
switches are listed at the end of this chapter [1-8]. 
Several power semiconductor devices are briefly discussed in Section 4.2. Majority-carrier 
devices, including the MOSFET and Schottky diode, exhibit very fast switching times, and hence are 
preferred when the off state voltage levels are not too high. Minority-carrier devices, including the bipo-
lar junction transistor (BJT), insulated-gate bipolar transistor (IGBT), and thyristors [gate turn-off (GTO) 
and MOS-controlled thyristor (MCT)] exhibit high breakdown voltages with low forward voltage drops, 
at the expense of reduced switching speed. 
Having realized the switches using semiconductor devices, switching loss can next be dis-
cussed. There are a number of mechanisms that cause energy to be lost during the switching transitions 
[11]. When a transistor drives a clamped inductive load, it experiences high instantaneous power loss 
during the switching transitions. Diode stored charge further increases this loss, during the transistor 
turn-on transition. Energy stored in certain parasitic capacitances and inductances is lost during switch-
ing. Parasitic ringing, which decays before the end of the switching period, also indicates the presence of 
switching loss. Switching loss increases directly with switching frequency, and imposes a maximum 
limit on the operating frequencies of practical converters. 
4.1 
SWITCH APPLICATIONS 
4.1.1 
Single-Quadrant Switches 
The ideal SPST switch is illustrated in Fig. 4.1. The switch contains power terminals 1 and 0, with cur-
rent and voltage polarities defined as shown. In the on state, the voltage v is zero, while the current i is 
zero in the off state. There is sometimes a third terminal C, where a control signal is applied. Distinguish-
ing features of the SPST switch include the control method (active vs. passive) and the region of the i-v 
plane in which they can operate. 
A passive switch does not contain a 
control terminal C. The state of the switch is 
determined by the waveforms i(t) and v(t) 
applied to terminals 0 and l. The most common 
example is the diode, illustrated in Fig. 4.4. The 
ideal diode requires that v(t) ~ 0 and i(t) 2:: 0. The 
diode is off (i = 0) when v < 0, and is on (v = 0) 
when i > 0. It can block negative voltage but not 
positive voltage. A passive SPST switch can be 
realized using a diode provided that the intended 
operating points [i.e., the values of v(t) and i(t) 
(a) 
+ 
v 
0 
(b) 
on 
off 
v 
when the switch is in the on and off states]lie on 
the diode characteristic of Fig. 4.4(b). 
Fig. 4.4 Diode symbol (a), and its ideal characteristic (b). 
The conducting state of an active 
switch is determined by the signal applied to the control terminal C. The state does not directly depend 
on the waveforms v(t) and i(t) applied to terminals 0 and 1. The BJT, MOSFET, IGBT, GTO, and MCT 
are examples of active switches. Idealized characteristics i(t) vs. v(t) for the BJT and IGBT are sketched 
in Fig. 4.5. When the control terminal causes the transistor to be in the off state, i = 0 and the device is 
capable of blocking positive voltage: v 2:: 0. When the control terminal causes the transistor to be in the on 
state, v = 0 and the device is capable of conducting positive current: i 2:: 0. The reverse-conducting and 

66 
Switch Realization 
Fig. 4.5 Bipolar junction transistor (BJT) 
and insulated gate bipolar transistor (IGBT) 
symbols (a), and their idealized switch 
characteristics (b). 
(a) 
Fig. 4.6 
Power MOSFET symbol (a), and 
its idealized switch characteristics (b). 
0 
0 
0 
+ 
v 
+ 
v 
+ 
v 
{b) 
on 
off 
v 
on 
off 
v 
·on 
(reverse conduction) 
reverse-blocking characteristics of the BJT and IGBT are poor or nonexistent, and have essentially no 
application in the power converter area. The power MOSFET (Fig. 4.6) has similar characteristics, 
except that it is able to conduct current in the reverse direction. With one notable exception (the synchro-
nous rectifier discussed later), the MOSFET is normally operated with i <:: 0, in the same manner as the 
BJT and IGBT. So an active SPST switch can be realized using a BJT, IGBT, or MOSFET, provided that 
the intended operating points lie on the transistor characteristic of Fig. 4.5(b ). 
To determine how to implement an SPST switch using a transistor or diode, one compares the 
switch operating points with the i-v characteristics of Figs. 4.4(b ), 4.5(b ), and 4.6(b ). For example, when 
it is intended that the SPDT switch of Fig. 4.2(a) be in position 1, SPST switch A of Fig. 4.2(b) is closed, 
and SPST switch B is opened. Switch A then conducts the positive inductor current, iA = iu and switch B 
must block negative voltage, v8 = -Vg. Thes.e switch operating points are illustrated in Fig. 4.7. Likewise, 
when it is intended that the SPDT switch of Fig. 4.2(a) be in position 2, then SPST switch A is opened 
and switch B is closed. Switch B then conducts the positive inductor current, i8 = iL, while switch A 
blocks positive voltage, VA= Vg. 
By comparison of the switch A operating points of Fig. 4.7(a) with Figs. 4.5(b) and 4.6(b), it can 
be seen that a transistor (BJT, IGBT, or MOSFET) could be used, since switch A must block positive 
voltage and conduct positive current. Likewise, comparison of Fig. 4.7(b) with Fig. 4.4(b) reveals that 
switch B can be implemented using a diode, since switch B must block negative voltage and conduct pos-
itive current. Hence a valid switch realization is given in Fig. 4.8. 

4.1 
Switch Applications 
67 
iA 
Switch A 
on 
iL 
Switch 8 
on 
iL 
Switch A 
off 
Switch 8 
off 
Fig. 4.7 
Operating points of switch A, (a), and switch B, (b), in the buck converter of Fig. 4.2(b). 
Figure 4.8 is an example of a single-quadrant switch realization: the devices are capable of con-
ducting current of only one polarity, and blocking voltage of only one polarity. When the controller turns 
the transistor on, the diode becomes reverse-biased since v8 = -Vg. It is required that Vg be positive; oth-
erwise, the diode will be forward-biased. The transistor conducts current iv This current should also be 
positive, so that the transistor conducts in the forward direction. 
When the controller turns the transistor off, the diode must turn on so that the inductor current 
can continue to flow. Turning the transistor off causes the inductor current i L (t) to decrease. Since 
vL(t) = L diL(t)!dt, the inductor voltage becomes sufficiently negative to forward-bias the diode, and the 
diode turns on. Diodes that operate in this manner are sometimes called freewheeling diodes. It is 
required that iL be positive; otherwise, the diode cannot be forward-biased since i8 = iv The transistor 
blocks voltage Vg; this voltage should be positive to avoid operating the transistor in the reverse blocking 
mode. 
L 
Fig. 4.8 
Implementation of the SPST switches of Fig. 4.2(b) using a transistor and diode. 
4.1.2 
Current-Bidirectional Two-Quadrant Switches 
In any number of applications such as dc-ac inverters and servo amplifiers, it is required that the switch-
ing elements conduct currents of both polarities, but block only positive voltages. A current-bidirectional 
two-quadrant SPST switch of this type can be realized using a transistor and diode, connected in an anti-
parallel manner as in Fig. 4.9. 
The MOSFET of Fig. 4.6 is also a two-quadrant switch. However, it should be noted here that 

68 
Switch Realization 
Fig. 
4.9 A current-bidirectional two-
quadrant SPST switch: (a) implementation 
using a transistor and antiparallel diode, 
(b) idealized switch characteristics. 
Fig. 4.10 The power MOSFET 
inherently contains a built-in 
body diode: (a) equivalent circuit, 
(b) addition of external diodes to 
prevent conduction 
of body 
diode. 
(a) 
(a) 
+ 
v 
+ 
v 
(b) 
on 
· (transistor conducts) 
off 
v 
on 
(diode conducts) 
(b) 
practical power MOSFETs inherently contain a built-in diode, often called the body diode, as illustrated 
in Fig. 4.10. The switching speed of the body diode is much slower than that of the MOSFET. If the body 
diode is allowed to conduct, then high peak currents can occur during the diode tum-off transition. Most 
MOSFETs are riot rated to handle these currents, and device failure can occur. To avoid this situation, 
external series and antiparallel diodes can be added as in Fig. 4.10(b). Power MOSFETs can be specifi-
cally designed to have a fast-recovery body diode, and to operate reliably when the body diode is allowed 
to conduct the rated MOSFET current. However, the switching speed of such body diodes is still some-
what slow; and significant switching loss due to diode stored charge (discussed later in this chapter) can 
occur. 
A SPDT current-bidirectional two-quadrant switch can again be derived using two SPST 
switches as in Fig. 4.2(b ). An example is given in Fig. 4.11. This converter operates from positive and 
negative de supplies, and can produce an ac output voltage v(t) having either polarity. Transistor Q2 is 
driven with the complement of the Q1 drive signal, so that Q1 conducts during the first subinterval 
0 < t < DTs, and Q2 conducts during the second subinterval DTs < t < T,. 
It can be seen from Fig. 4.11 that the switches must block voltage 2Vg. It is required that V8 be 
positive; otherwise, diodes D1 and D2 will conduct simultaneously, shorting out the source. 
It can be shown via inductor volt-second balance that 
(4.1) 
This equation is plotted in Fig. 4.1 2. The converter output voltage v0 is positive forD > 0.5, and negative 
forD < 0.5. By sinusoidal variation of the duty cycle, 

Fig. 
4.11 Inverter circuit 
using two-quadrant switches. 
D(t) = 0.5 + D"'sin(rot) 
4.1 
Switch Applications 
69 
-. 
+ 
(4.2) 
with D111 being a constant less that 0.5, the output voltage becomes sinusoidal. Hence this converter could 
be used as a dc-ac inverter. 
The load current is given by vJR; in equilibrium, this current coincides with the inductor cur-
rent iv 
(4.3) 
The switches must conduct this current. So the switch current is also positive when D > 0.5, and negative 
when D < 0.5. With high-frequency duty cycle variations, the L-C filter may introduce a phase lag into 
the inductor current waveform, but it is nonetheless true that switch currents of both polarities occur. So 
the switch must operate' in two quadrants of the plane, as illustrated in Fig. 4.13. When iL is positive, Q1 
and D2 alternately conduct. When iL is negative, Q2 and D 1 alternately conduct. 
A well-known dc-3¢ac inverter circuit, the voltage-source inverter (VSI), operates in a similar 
manner. As illustrated in Fig. 4.14, the VSI contains three two-quadrant SPDT switches, one per phase. 
These switches block the de input voltage Vg, and must conduct the output ac phase currents ia, ib, and ic, 
Fig. 4.12 Output voltage vs. duty cycle, for the 
inverter of Fig. 4.11. This converter can produce 
Vg 
both positive and negative output voltages. 
D 

70 
Switch Realization 
Fig. 4.13 The switches in the inverter of Fig. 4.11 must be 
capable of conducting both positive and negative current, but 
need block only positive voltage. 
+ 
Fig. 4.14 The dc-3!2!ac voltage-source inverter requires two-quadrant switches. 
respectively. 
Switch 
on state 
current 
Switch 
off state 
voltage 
Another current-bidirectional two-quadrant switch example is the bidirectional battery 
charger/discharger illustrated in Fig. 4.15. This converter can be used, for example, to interface a battery 
to the main power bus of a spacecraft. Both the de bus voltage vbus and the battery voltage vbatt are always 
positive. The semiconductor switch elements block positive voltage vbus· When the battery is being 
charged, iL is positive, and Q 1 and D2 alternately conduct current. When the battery is being discharged, 
iL is negative, and Q2 and D 1 alternately conduct. Although this is a de-de converter, it requires two-
quadrant switches because the power can flow in either direction. 
+ 
Spacecraft 
main power bus 
Fig. 4.15 Bidirectional battery charger/discharger, based on the de-de buck converter. 
+ 

Fig. 
4.16 
Voltage-bidirectional two-quadrant switch 
properties. 
Fig. 4.17 
A voltage-bidirectional two-quad-
rant SPST switch: (a) implementation using a 
transistor and series diode, (b) idealized switch 
characteristics. 
(u) 
4.1.3 
Voltage-Bidirectional Two-Quadrant Switches 
(b) 
+ 
\1 
4.1 
Switch Applications 
71 
Switch 
on state 
current 
off 
(diode 
blocks voltage) 
on 
off 
Switch 
off state 
voltage 
\1 
(transistor 
blocks voltage) 
Another type of two-quadrant switch, having the voltage-bidirectional properties illustrated in Fig. 4.16, 
is sometimes required. In applications where the switches must block both positive and negative volt-
ages, but conduct only positive current, an SPST switch can be constructed using a series-connected tran-
sistor and diode as in Fig. 4.17. When it is intended that the switch be in the off state, the controller turns 
the transistor off. The diode then blocks negative voltage, and the transistor blocks positive voltage. The 
series connection can block negative voltages up to the diode voltage rating, and positive voltages up to 
the transistor voltage rating. The silicon-controlled rectifier is another example of a voltage-bidirectional 
two-quadrant switch. 
A converter that requires this type of two-quadrant switch is the dc-3¢ac buck-boost inverter 
shown in Fig. 4.18 [4]. If the converter functions in inverter mode, so that the inductor current iL(t) is 
always positive, then all switches conduct only positive current. But the switches must block the output 
ac line-to-line voltages, which are sometimes positive and sometimes negative. Hence voltage-bidirec-
tional two-quadrant switches are required. 

72 
Switch Realization 
iL 
Fig. 4.18 
Dc-30ac buck-boost inverter. 
4.1.4 
Four-Quadrant Switches 
The most general type of switch is the four-quadrant switch, 
capable of conducting currents of either polarity and block-
ing voltages of either polarity, as in Fig. 4.19. There are sev-
eral ways of constructing a four-quadrant switch. As 
illustrated in Fig. 4.20(b), two current-bidirectional two-
quadrant switches described in Section 4.1.2 can be con-
nected back-to-back. The transistors are driven on and off 
simultaneously. Another approach is the antiparallel connec-
tion of two voltage-bidirectional two-quadrant switches 
described in Section 4.1.3, as in Fig. 4.20(a). A third 
approach, using only one transistor but additional diodes, is 
given in Fig. 4.20(c). 
Cycloconverters are a class of converters requiring 
four-quadrant switches. For example, a 3¢ac-to-3¢ac matrix 
converter is illustrated in Fig. 4.21. Each of the nine SPST 
switches is realized using one of the semiconductor networks 
of Fig. 4.20. With proper control of the switches, this con-
verter can produce a three-phase output of variable fre-
(a) 
Fig. 
4.20 Three ways of 
implementing a four-quadrant 
SPST switch. 
0 
(b) 
+ 
v 
Switch 
on state 
current 
+ 
vab(t) 
+ 
vbc(t) 
'~>a 
q>b 
'i>c 
Switch 
off state 
voltage 
Fig. 4.19 
A four-quadrant switch can con-
duct either polarity of current, and can block 
either polarity of voltage. 
(c) 
+ 
+ 
v 
v 
0 

4.1 Switch Applications 
73 
3!1!ac input 
3¢ac output 
Fig. 4.21 
A 3s<iac-3S'lac matrix converter, which requires nine SPST four-quadrant switches. 
quency and voltage, from a given three-phase ac input. Note that there are no de signals in this converter: 
all of the input and output voltages and currents are ac, and hence four-quadrant switches are necessary. 
4.1.5 
Synchronous Rectifiers 
The ability of the MOSFET channel to conduct current in the reverse direction makes it possible to 
employ a MOSFET where a diode would otherwise be required. When the MOSFET is connected as in 
Fig. 4.22(a) [note that the source and drain connections are reversed from the connections of Fig. 4.6(a)], 
the characteristics of Fig. 4.22(b) are obtained. The device can now block negative voltage and conduct 
positive current, with properties similar to those of the diode in Fig. 4.4. The MOSFET must be con-
trolled such that it operates in the on state when the diode would normally conduct, and in the off state 
when the diode would be reverse-biased. 
Thus, we could replace the diode in the buck converter of Fig. 4.8 with a MOSFET, as in Fig. 
4.23. The BJT has also been replaced with a MOSFET in the figure. MOSFET Q2 is driven with the com-
plement of the Q1 control signal. 
The trend in computer power supplies is reduction of output voltage levels, from 5 V to 3.3 V 
and lower. As the output voltage is reduced, the diode conduction loss increases; in consequence, the 
diode conduction loss is easily the largest source of power loss in a 3.3 V power supply. Unfortunately, 
the diode junction contact potential limits what can be done to reduce the forward voltage drop of diodes. 
Schottky diodes having reduced junction potential can be employed; nonetheless, low-voltage power 
Fig. 4.22 Power MOSFET connected as 
a synchronous rectifier, (a), and its ideal· 
ized switch characteristics, (b). 
(a) 
0 
(b) 
+ 
v 
on 
(reverse conduction) 
off 
v 
on 

74 
Switch Realization 
Fig. 4.23 Buck converter, implemented using a synchronous rectifier. 
supplies containing diodes that conduct the output current must have low efficiency. 
A solution is to replace the diodes with MOSFETs operated as synchronous rectifiers. The con-
duction loss of a MOSFET having on-resistance R011 and operated with rms current is Inns' is Inn} R011 • 
The on-resistance can be decreased by use of a larger MOSFET. So the conduction loss can be reduced 
as low as desired, if one is willing to pay for a sufficiently large device. Synchronous rectifiers find wide-
spread use in low-voltage power supplies. 
4.2 
A BRIEF SURVEY OF POWER SEMICONDUCTOR DEVICES 
The most fundamental challenge in power semiconductor design is obtaining a high breakdown voltage, 
while maintaining low forward voltage drop and on-resistance. A closely related issue is the longer 
switching times of high-voltage low-on-resistance devices. The tradeoff between breakdown voltage, 
on-resistance, and switching times is a key distinguishing feature of the various power devices. 
The breakdown voltage of a reverse-biased p-n junction and its associated depletion region is a 
function of doping level: obtaining a high breakdown voltage requires low doping concentration, and 
hence high resistivity, in the material on at least one side of the junction. This high-resistivity region is 
usually the dominant contributor to the on-resistance of the device, and hence high-voltage devices must 
have higher on-resistance than low-voltage devices. In majority carrier devices, including the MOSFET 
and Schottky diode, this accounts for the first-order dependence of on-resistance on rated voltage. How-
ever, minority carrier devices, including the diffused-junction p-n diode, the bipolar junction transistor 
(BJT), the insulated-gate bipolar transistor (IGBT), and the thyristor family (SCR, GTO, MCT), exhibit 
another phenomenon known as conductivity modulation. When a minority-carrier device operates in the 
on state, minority carriers are injected into the lightly doped high-resistivity region by the forward-biased 
p-n junction. The resulting high concentration of minority carriers effectively reduces the apparent resis-
tivity of the region, reducing the on-resistance of the device. Hence, minority-carrier devices exhibit 
lower on-resistances than comparable majority-carrier devices. 
However, the advantage of decreased on-resistance in minority-carrier devices comes with the 
disadvantage of decreased switching speed. The conducting state of any semiconductor device is con-
trolled by the presence or absence of key charge quantities within the device, and the turn-on and turn-off 
switching times are equal to the times required to insert or remove this controlling charge. Devices oper-
ating with conductivity modulation are controlled by their injected minority carriers. The total amount of 
controlling minority charge in minority-carrier devices is much greater than the charge required to con-
trol an equivalent majority-carrier device. Although the mechanisms for inserting and removing the con-
trolling charge of the various devices can differ, it is nonetheless true that, because of their large amounts 
of minority charge, minority-carrier devices exhibit switching times that are significantly longer than 
those of majority-carrier devices. In consequence, majority-carrier devices find application at lower volt-

4.2 A Brief Survey of Power Semiconductor Devices 
75 
age levels and higher switching frequencies, while the reverse is true of minority-carrier devices. 
Modem power devices are fabricated using up-to-date processing techniques. The resulting 
small feature size allows construction of highly interdigitated devices, whose unwanted parasitic ele-
ments are less significant. The resulting devices are more rugged and well-behaved than their predeces-
sors. 
A detailed description of power semiconductor device physics and switching mechanisms is 
beyond the scope of this book. Selected references on power semiconductor devices are listed in the ref-
erence section [9-19]. 
4.2.1 
Power Diodes 
As discussed above, the diffused-junction p-n diode contains a lightly doped or intrinsic high-resistivity 
region, which allows a high breakdown voltage to be obtained. As illustrated in Fig. 4.24(a), this region 
comprises one side of the p- n- junction (denoted n-); under reverse-biased conditions, essentially all of 
the applied voltage appears ~cross the depletion region inside then- region. On-state conditions are illus-
trated in Fig. 4.24(b). Holes are injected across the forward-biased junction, and become minority carri-
ers in the n- region. These minority carriers effectively reduce the apparent resistivity of then- region via 
conductivity modulation. Essentially all of the forward current i(t) is comprised of holes that diffuse 
across the p- n region, and then recombine with electrons from the n region. 
Typical switching waveforms are illustrated in Fig. 4.25. The familiar exponential i-v character-
Fig. 4.24 
Power diode: (a) under 
reverse-bias conditions, (b) under 
forward-bias conditions. 
(a) 
-
(b) 
{ 
.__v v 
~ 
1.:: 
v 
I+ 
Low doping concemration 
p 
~~-
0 
0 
0 
E 
-
v 
+ 
Depletion region. reverse-biased 
v 
+I 
Conduc1ivity modulmion 
p 
11' 
0 
0 
0 
0 
0 
0 
-
Minority carrier injection 
---
11 
0 
0 
r-
0 
11 
r-
0 
r-
0 
r-
r-
0 

76 
Switch Realization 
Fig. 
4.25 Diode voltage and 
current waveforms. Interval (1 ): 
off state. Interval (2): turn-on 
transition. Interval (3): on state. 
Intervals (4) and (5): turn-off 
transition. Interval (6): off state. 
v(r) 
i(t) 
0 
(6) 
is tic of the p-n diode is an equilibrium relation. During transients, significant deviations from the expo-
nential characteristic are observed; these deviations are associated with changes in the stored minority 
charge. As illustrated in Fig. 4.25, the diode operates in the off state during interval (1), with zero current 
and negative voltage. At the beginning of interval (2), the current increases to some positive value. This 
current charges the effective capacitance of the reverse-biased diode, supplying charge to the depletion 
region and increasing the voltage v(t). Eventually, the voltage becomes positive, and the diode junction 
becomes forward-biased. The voltage may rise to a peak value of several volts, or even several tens of 
volts, reflecting the somewhat large resistance of the lightly doped n- region. The forward-biased p-n-
junction continues to inject minority charge into the n- region. As the total minority charge in the n-
region increases, conductivity modulation of then- region causes its effective resistance to decrease, and 
hence the forward voltage drop v(t) also decreases. Eventually, the diode reaches equilibrium, in which 
the minority carrier injection rate and recombination rate are equal. During interval (3), the diode oper-
ates in the on state, with forward voltage drop given by the diode static i-v characteristic. 
The turn-off transient is initiated at the beginning of interval (4). The diode remains forward-
biased while minority charge is present in the vicinity of the diode p- n- junction. Reduction of the stored 
minority charge can be accomplished either by active means, via negative terminal current, or by passive 
means, via recombination. Normally, both mechanisms occur simultaneously. The charge Q, contained 
in the negative portion of the diode turn-off cmTent waveform is called the recovered charge. The portion 
of Q, occurring during interval (4) is actively-removed minority charge. At the end of interval (4), the 
stored minority charge in the vicinity of the p- n- junction has been removed, such that the diode junction 
becomes reverse-biased and is able to block negative voltage. The depletion region effective capacitance 
is then charged during interval (5) to the negative off-state voltage. The portion of Q, occurring during 
interval (5) is charge supplied to the depletion region, as well as minmity charge that is actively removed 
from remote areas of the diode. At the end of interval (5), the diode is able to block the entire applied 
reverse voltage. The length of intervals (4) and (5) is called the reverse recovery time tr. During interval 
( 6), the diode operates in the off state. The diode tum-off transition, and its influence on switching loss in 
a PWM converter, is discussed further in Section 4.3.2. 

4.2 A Brief Survey of Power Semiconductor Devices 
77 
Table 4.1 
Characteristics of several commercial power rectifier diodes 
Part number 
Rated maximum 
Rated average 
VF (typical) 
t, (max) 
voltage 
current 
Fast recovery rectifiers 
1N3913 
400V 
30A 
l.lV 
400 ns 
SD453N25S20PC 
2500V 
400A 
2.2V 
3 JlS 
Ultra-fast recovery rectifiers 
MUR815 
150V 
SA 
0.975 v 
35 ns 
MUR1560 
600V 
15A 
1.2 v 
60 ns 
RHRU100120 
1200V 
lOOA 
2.6V 
60 ns 
Schottky rectifiers 
MBR6030L 
30V 
60A 
0.48V 
444CNQ045 
45V 
440A 
0.69V 
30CPQ150 
150V 
30A 
1.19V 
Diodes are rated according to the length of their reverse recovery time tr. Standard recovery rec-
tifiers are intended for 50 Hz or 60Hz operation; reverse recovery times of these devices are usually not 
specified. Fast recovery rectifiers and ultrafast recovery rectifiers are intended for use in converter appli-
cations. The reverse recovery timet,, and sometimes also the recovered charge Q,, are specified by man-
ufacturers of these devices. Ratings of several commercial devices are listed in Table 4.1. 
Schottky diodes are essentially majority-carrier devices whose operation is based on the rectify-
ing characteristic of a metal-semiconductor junction. These devices exhibit negligible minority stored 
charge, and their switching behavior can be adequately modeled simply by their depletion-region capac-
itance and equilibrium exponential i-v characteristic. Hence, an advantage of the Schottky diode is its 
fast switching speed. An even more important advantage of Schottky diodes is their low forward voltage 
drops, especially in devices rated 45 V or less. Schottky diodes are restricted to low breakdown voltages; 
very few commercial devices are rated to block 100 V or more. Their off-state reverse currents are con-
siderably higher than those of p-n junction diodes. Characteristics of several commercial Schottky recti-
fiers are also listed in Table 4.1. 
Another important characteristic of a power semiconductor device is whether its on-resistance 
and forward voltage drop exhibit a positive temperature coefficient. Such devices, including the MOS-
FET and IGBT, are advantageous because multiple chips can be easily paralleled, to obtain high-current 
modules. These devices also tend to be more rugged and less susceptible to hot-spot formation and sec-
ond-breakdown problems. Diodes cannot be easily connected in parallel, because of their negative tem-
perature coefficients: an imbalance in device characteristics may cause one diode to conduct more 
current than the others. This diode becomes hotter, which causes it to conduct even more of the total cur-
rent. In consequence, the current does not divide evenly between the paralleled devices, and the current 
rating of one of the devices may be exceeded. Since BJTs and thyristors are controlled by a diode junc-
tion, these devices also exhibit negative temperature coefficients and have similar problems when oper-
ated in parallel. Of course, it is possible to parallel any type of semiconductor device; however, use of 
matched devices, a common thermal substrate, and/or external circuitry may be required to cause the on-
state currents of the devices to be equal. 

78 
Switch Realization 
Fig. 4.26 Cross-section of DMOS n-channel 
power MOSFET structure. Crosshatched regions 
are metallized contacts. Shaded regions are insu-
lating silicon dioxide layers. 
n 
'777777777777771777777777777777 
Drain 
4.2.2 
Metal Oxide Semiconductor Field-Effect Transistor (MOSFET) 
The power MOSFET is a modern power semiconductor device having gate lengths close to one micron. 
The power device is comprised of many small parallel-connected enhancement-mode MOSFET cells, 
which cover the surface of the silicon die. A cross-section of one cell is illustrated in Fig. 4.26. Current 
flows vertically through the silicon wafer: the metallized drain connection is made on the bottom of the 
chip, while the metallized source connection and polysilicon gate are on the top surface. Under normal 
operating conditions, in which v ds ~ 0, both the p-n and p-n- junctions are reverse-biased. Figure 4.27(a) 
illustrates operation of the device in the off state. The applied drain-to-source voltage then appears across 
the depletion region of the p- n- junction. Then- region is lightly doped, such that the desired breakdown 
voltage rating is attained. Figure 4.27(b) illustrates operation in the on state, with a sufficiently large pos-
itive gate-to-source voltage. A channel then forms at the surface of the p region, underneath the gate. The 
drain current flows through then- region, channel, n region, and out through the source contact. The on-
resistance of the device is the sum of the resistances of the n- region, the channel, the source and drain 
contacts, etc. As the breakdown voltage is increased, the on-resistance becomes dominated by the resis-
tance of the n- region. Since there are no minority carriers to cause conductivity modulation, the on-
resistance increases rapidly as the breakdown voltage is increased to several hundred volts and beyond. 
The p- n- junction is called the body diode; as illustrated in Fig. 4.27(c), this junction forms an 
effective diode in parallel with the MOSFET channel. The body diode can become forward-biased when 
the drain-to-source voltage v,b.(t) is negative. This diode is capable of conducting the full rated current of 
the MOSFET. However, most MOSFETs are not optimized with respect to the speed of their body 
diodes, and the large peak currents that flow during the reverse recovery transition of the body diode can 
cause device failure. Several manufacturers produce MOSFETs that contain fast recovery body diodes; 
these devices are rated to withstand the peak currents during the body diode reverse recovery transition. 
Typical n-channel MOSFET static switch characteristics are illustrated in Fig. 4.28. The drain 
current is plotted as a function of the gate-to-source voltage, for various values of drain-to-source volt-
age. When the ~ate-to-source voltage is less than the threshold voltage V1h, the device operates in the off 
state. A typical value of V1h is 3 V. When the gate-to-source voltage is greater than 6 or 7 V, the device 
operates in the on state; typically, the gate is driven to 12 or 15 V to ensure minimization of the forward 
voltage drop. In the on state, the drain-to-source voltage VDs is roughly proportional to the drain current 

Fig. 
4.27 Operation of the power 
MOSFET: (a) in the off state, vds 
appears across the depletion region in 
the n- region; (b) current flow through 
the conducting channel in the on state; 
(c) body diode due to the p- n-junction. 
(a) 
(b) 
(c) 
4.2 A Brief Survey of Power Semiconductor Devices 
79 
Depletio11 region 
n 
Channel 
n 
Drain 
II 
' 72777777777772{727777777777777 
b Drain 
!D. The MOSFET is able to conduct peak currents well in excess of its average current rating, and the 
nature of the static characteristics is unchanged at high current levels. Logic-level power MOSFETs are 
also available, which operate in the on state with a gate-to-source voltage of 5 V. A few p-channel devices 
can be obtained, but their properties are inferior to those of equivalent n-channel devices. 
The on-resistance and forward voltage drop of the MOSFET have a positive temperature coeffi-
cient. This property makes it reliHively easy to parallel devices. High current MOSFET modules are 
available, containing several parallel-connect chips. 
The major capacitances of the MOSFET are illustrated in Fig. 4.29. This model is sufficient for 

80 
Switch Realization 
Fig. 4.28 
Typical static characteristics 
of a power MOSFET. Drain current ID is 
lOA 
plotted vs. gate-to-source voltage V05 , 
5 A 
for various values of drain-to-source 
voltage V Ds· 
ov 
5V 
IOV 
15 v 
Vcs 
qualitative understanding of the MOSFET switching behavior; more accurate models account for the 
parasitic junction field-effect transistor inherent in the DMOS geometry. Switching times of the MOS-
FET are determined essentially by the times required for the gate driver to charge these capacitances. 
Since the drain current is a function of the gate-to-source voltage, the rate at which the drain current 
changes is dependent on the rate at which the gate-to-source capacitance is charged by the gate drive cir-
cuit. Likewise, the rate at which the drain voltage changes is a function of the rate at which the gate-to-
drain capacitance is charged. The drain-to-source capacitance leads directly to switching loss in PWM 
converters, since the energy stored in this capacitance is lost during the transistor tum-on transition. 
Switching loss is discussed in Section 4.3. 
The gate-to-source capacitance is essentially linear. However, the drain-to-source and gate-to-
drain capacitances are strongly nonlinear: these incremental capacitances vary as the inverse square root 
of the applied capacitor voltage. For example, the dependence of the incremental drain-to-source capaci-
tance can be written in the form 
(4.4) 
where C0 and V0 are constants that depend on the construction of the device. These capacitances can eas-
ily vary by several orders of magnitude as v ds varies over its normal operating range. For v ds ::;;> V0, Eq. 
Fig. 4.29 
MOSFET equivalent circuit which accounts for the body 
diode and effective terminal capacitances. 
D 
s 

4.2 
A Brief Survey of Power Semiconductor Devices 
81 
Table 4.2 Characteristics of several commercial n-channel power MOSFETs 
Part number 
Rated maximum 
Rated average 
Ron 
Qg (typical) 
voltage 
current 
IRFZ48 
60V 
SOA 
0.018 Q 
110nC 
IRF510 
lOOV 
5.6A 
0.54Q 
8.3 nC 
IRF540 
lOOV 
28A 
0.077 Q 
72 nC 
APTl OM25BNR 
lOOV 
75A 
0.025 Q 
171 nC 
IRF740 
400V 
lOA 
0.55 Q 
63 nC 
MTM15N40E 
400V 
15A 
0.3Q 
110 nC 
APT5025BN 
500V 
23A 
0.25Q 
83 nC 
APTlOOlRBNR 
lOOOV 
11 A 
l.OQ 
150nC 
(4.4) can be approximated as 
' 
fff 
co 
(4.5) 
Cd/vds)"' Co 
== {V;;; 
vds 
These expressions are used in Section 4.3.3 to determine the switching loss due to energy stored in Cds· 
Characteristics of several commercially available power MOSFETs are listed in Table 4.2. The 
gate charge Q8 is the charge that the gate drive circuit must supply to the MOSFET to raise the gate volt-
age from zero to some specified value (typically 10 V), with a specified value of off state drain-to-source 
voltage (typically 80% of the rated VDs)· The total gate charge is the sum of the charges on the gate-to-
drain and the gate-to-source capacitance. The total gate charge is to some extent a measure of the size 
and switching speed of the MOSFET. 
Unlike other power devices, MOSFETs are usually not selected on the basis of their rated aver-
age current. Rather, on-resistance and its influence on conduction loss are the limiting factors, and MOS-
FETs typically operate at average currents somewhat less than the rated value. 
MOSFETs are usually the device of choice at voltages less than or equal to approximately 400 
to 500 V. At these voltages, the forward voltage drop is competitive or superior to the forward voltage 
drops of minority-carrier devices, and the switching speed is significantly faster. Typical switching times 
are in the range 50 ns to 200 ns. At voltages greater than 400 to 500 V, minority-carrier devices having 
lower forward voltage drops, such as the IGBT, are usually preferred. The only exception is in applica-
tions where the high switching speed overrides the increased cost of silicon required to obtain acceptably 
low conduction loss. 
4.2.3 
Bipolar Junction Transistor (BJT) 
A cross-section of an NPN power BJT is illustrated in Fig. 4.30. As with other power devices, 
current flows vertically through the silicon wafer. A lightly doped n- region is inserted in the collector, to 
obtain the desired voltage breakdown rating. The transistor operates in the off state (cutoff) when the p-n 
base-emitter junction and the p-n- base-collector junction are reverse-biased; the applied collector-to-
emitter voltage then appears essentially across the depletion region of the p-n- junction. The transistor 
operates in the on state (saturation) when both junctions are forward-biased; substantial minority charge 
is then present in the p and n- regions. This minority charge causes the n- region to exhibit a low on-

82 
Switch Realization 
Fig. 4.30 Power BJT structure. Crosshatched 
regions are metallized contacts. 
n 
'222222222222221'::~:,::22222222 
resistance via the conductivity modulation effect. Between the off state and the on state is the familiar 
active region, in which the p-n base-emitter junction is forward-biased and the p-n- base-collector junc-
tion is reverse-biased. When the BJT operates iri the active region, the collector current is proportional to 
the base region minority charge, which in tum is proportional (in equilibrium) to the base current. There 
is in addition a fourth region of operation known as quasi-saturation, occurring between the active and 
saturation regions. Quasi-saturation occurs when the base current is insufficient to fully saturate the 
device; hence, the minority charge present in the n- region is insufficient to fully reduce the n- region 
resistance, and high transistor on-resistance is observed. 
Consider the simple switching circuit of Fig. 4.31. Fig-
ure 4.32 contains waveforms illustrating the BJT tum-on and 
tum-off transitions. The transistor operates in the off state dur-
ing interval (1), with the base-emitter junction reverse-biased by 
the source voltage v .(t) =- v.1• The tum-on transition is initiated 
at the beginning of interval (2), when the source voltage changes 
to v.(t) = + v.2• Positive current is then supplied by source v. to 
the base of the BIT. This current first charges the capacitances of 
the depletion regions of the reverse-biased base-emitter and 
base-collector junctions. At the end of interval (2), the base-
emitter voltage exceeds zero sufficiently for the base-emitter 
v.(t) 
junction to become forward-biased. The length of interval (2) is 
called the tum-on delay time. During interval (3), minority 
charge is injected across the base-emitter junction from the 
+ 
emitter into the base region; the collector current is proportional 
Fig. 
4.31 Circuit for BJT switching 
to this minority base charge. Hence during interval (3), the col-
time example. 
lector current increases. Since the transistor drives a resistive 
load Rv the collector voltage also decreases during interval (3). This causes the voltage to reduce across 
the reverse-biased base-collector depletion region (Miller) capacitance. Increasing the base current IBI 
(by reducing R8 or increasing V s2) increases the rate of change of both the base region minority charge 
and the charge in the Miller capacitance. Hence, increased 181 leads to a decreased tum-on switching 
time. 
Near or at the end of interval (3), the base-collector p-n- junction becomes forward-biased. 
Minority carriers are then injected into the n- region, reducing its effective resistivity. Depending on the 
device geometry and the magnitude of the base current, a voltage tail [interval (4)] may be observed as 

4.2 A Brief Survey of Power Semiconductor Devices 
83 
0.7V 
-V 1--v 
sl 
:""..,.__! -
0 
!---=----{r! 
j 
~ 
~I 
0 I 
INI 
): ! 
! 
(1) (2) ! (3) 
(4) 
(5) 
i (6) 
(7) i (8) 
(9) 
Fig. 4.32 BJT turn-on and turn-off transition waveforms. 
the apparent resistance of then- region decreases via conductivity modulation. The BIT reaches on-state 
equilibrium at the beginning of interval (5), with low on-resistance and with substantial minority charge 
present in both the n- and p regions. This minority charge significantly exceeds the amount necessary to 
support the active region conduction of the collector current Icon; its magnitude is a function of 
181 -leo/~. where~ is the active-region current gain. 
The tum-off process is initiated at the beginning of interval (6), when the source voltage 
changes to v .(t) = - v.,. The base-emitter junction remains forward-biased as long as minority carriers 
are present in its vicinity. Also, the collector current continues to be ic(t) = Icon as long as the minority 

84 
Switch Realization 
Fig. 4.33 Ideal base current waveform for minimi-
zation of switching times. 
:u 
0 
charge exceeds the amount necessary to support the active region conduction of Icon' that is, as long as 
excess charge is present. So during interval (6), a negative base current flows equal to 
- ls2 = (- V51 - vBE(t))IRs- This negative base current actively removes the total stored minority charge. 
Recombination further reduces the stored minority charge. Interval (6) ends when all of the excess 
minority charge has been removed. The length of interval (6) is called the storage time. During interval 
(7), the transistor operates in the active region. The collector current ic(t) is now proportional to the 
stored minority charge. Recombination and the negative base current continue to reduce the minority 
base charge, and hence the collector current decreases. In addition, the collector voltage increases, and 
hence the base current must charge the Miller capacitance. At the end of interval (7), the minority stored 
charge is equal to zero, and the base-emitter junction can become reverse-biased. The length of interval 
(7) is called the tum-off time or fall time. During interval (8), the reverse-biased base-emitter junction 
capacitance is discharged to voltage - V51 • During interval (9), the transistor operates in equilibrium, in 
the off state. 
It is possible to tum the transistor off using ls2 = 0; for example, we could let V51 be approxi-
mately zero. However, this leads to very long storage and turn-off switching times. If ls2 = 0, then all of 
the stored minority charge must be removed passively, via recombination. From the standpoint of mini-
mizing switching times, the base current waveform of Fig. 4.33 is ideal. The initial base current /BI is 
large in magnitude, such that charge is inserted quickly into the base, and the turn-on switching times are 
short. A compromise value of equilibrium on state current /Bon is chosen, to yield a reasonably low col-
lector-to-emitter forward voltage drop, while maintaining moderate amounts of excess stored minority 
charge and hence keeping the storage time reasonably short. The current- IB2 is large in magnitude, such 
that charge is removed quickly from the base and hence the storage and tum-off switching times are min-
imized. 
Unfortunately, in most BJTs, the magnitudes of IBI and Is2 must be limited because excessive 
values lead to device failure. As illustrated in Fig. 4.34, the base current flows laterally through the p 
Fig. 4.34 A large /82 leads to focusing of the 
emitter current away from the base contacts, due 
to the voltage induced by the lateral base region 
current. 

4.2 A Brief Survey of Power Semiconductor Devices 
85 
region. This current leads to a voltage drop in the resistance of the p material, which influences the volt-
age across the base-emitter junction. During the tum-off transition, the base current- 182 causes the base-
. emitter junction voltage to be greater in the center of the base region, and smaller at the edges near the 
base contacts. This causes the collector current to focus near the center of the base region. In a similar 
fashion, a large /81 causes the collector current to crowd near the edges of the base region during the 
tum-on transition. Since the collector-to-emitter voltage and collector current are simultaneously large 
during the switching transitions, substantial power loss can be associated with current focusing. Hence 
hot spots are induced at the center or edge of the base region. The positive temperature coefficient of the 
base-emitter junction current (corresponding to a negative temperature coefficient of the junction volt-
age) can then lead to thermal runaway and device failure. Thus, to obtain reliable operation, it may be 
necessary to limit the magnitudes of 181 and 182• It may also be necessary to add external snubber net-
works which the reduce the instantaneous transistor power dissipation during the switching transitions. 
Steady-state characteristics of the BJT are illustrated in Fig. 4.35. In Fig. 4.35(a), the collector 
current I c is plotted as a function of the base current 18 , for various values of collector -to-emitter voltage 
Vee· The cutoff, active, quasi-saturation, and saturation regions are identified. At a given collector cur-
(a) 
lOA 
Saturation region 
SA 
--------V 
Cl> = 0.5 V 
~-----------veE= 
0.2 V 
SA 
lOA 
(b) 
Increasing /8 
Fig. 4.35 BIT static characteristics: (a) fc vs. /8 , illustrating the regions of operation; (b) Ic vs. VeE• illustrating 
voltage breakdown characteristics. 

86 
Switch Realization 
rent /0 to operate in the saturation region with minimum forward voltage drop, the base current 18 must 
be sufficiently large. The slope dlcld/8 in the active region is the current gain p. It can be seen that P 
decreases at high current-near the rated current of the BJT, the current gain decreases rapidly and hence 
it is difficult to fully saturate the device. Collector current lc is plotted as a function of collector-to-emit-
ter voltage VCE in Fig. 4.35(b), for various values of 18 . The breakdown voltages BV,.s, BVcEO' and 
BV cso are illustrated. BV cso is the avalanche breakdown voltage of the base-collector junction, with the 
emitter open-circuited or with sufficiently negative base current. BVCEo is the somewhat smallercollec-
tor-emitter breakdown voltage observed when the base current is zero; as avalanche breakdown is 
approached, free carriers are created that have the same effect as a positive base current and that cause 
the breakdown voltage to be reduced. BVsus is the breakdown voltage observed with positive base cur-
rent. Because of the high instantaneous power dissipation, breakdown usually results in destruction of 
the BJT. In most applications, the off state transistor voltage must not exceed BVCEo· 
High-voltage BJTs typically have low current gain, and 
hence Darlington-connected devices (Fig; 4.36) are common. If tran-
sistors Q1 and Q2 have current gains P1 and P2, respectively, then the 
Darlington-connected device has the substantially increased current 
gain P1 + P2 + P1P2. In a monolithicDarlington device, transistors Q1 
and Q2 are integrated on the same silicon wafer. Diode D1 speeds up 
the tum-off process, by allowing the base driver to actively remove 
the stored charge of both Q1 and Q2 during the tum-off transition. 
At voltage levels below 500 V, the BJT has been almost 
entirely replaced by the MOSFET in power applications. It is also 
being displaced in higher voltage applications, where new designs 
utilize faster IGBTs or other devices. 
4.2.4 
Insulated Gate Bipolar Transistor (IGBT) 
Fig. 
4.36 Darlington-connected 
BJTs, including diode for improve-
ment of turn-off times. 
A cross-section of the IGBT is illustrated in Fig. 4.37. Comparison with Fig. 4.26 reveals that the IGBT 
and power MOSFET are very similar in construction. The key difference is the p region connected to the 
collector of the IGBT. So the IGBT is a modem four-layer power semiconductor device having a MOS 
gate. 
Fig. 
4.37 
IGBT structure. Crosshatched 
regions are metallized contacts. Shaded regions 
are insulating silicon dioxide layers. 
p 
Minority carrier 
injecrion 
'7777 777 7 77 7777/7 72 77 77 7777 772 7 
1 
Collecror 

Fig. 
4.38 The IGBT: (a) schematic 
symbol, (b) equivalent circuit. 
(a) 
4.2 
A Brief Survey of Power Semiconductor Devices 
87 
(b) 
c 
Collector 
G~ 
Emitter 
The function of the added p region is to inject minority charges into the n- region while the 
device operates in the on state, as illustrated in Fig. 4.37. When the IGBT conducts, the p-n- junction is 
forward-biased, and the minority charges injected into then- region cause conductivity modulation. This 
reduces the on-resistance of the n- region, and allows high-voltage IGBTs to be constructed which have 
low forward voltage drops. As of 1999, IGBTs rated as low as 600 V and as high as 3300 V are readily 
available. The forward voltage drops of these devices are typically 2 to 4 V, much lower than would be 
obtained in equivalent MOSFETs of the same silicon area. 
Several schematic symbols for the IGBT are in current use; the symbol illustrated in Fig. 
4.38(a) is the most popular. A two-transistor equivalent circuit for the IGBT is illustrated in Fig. 4.38(b). 
The IGBT functions effectively as an n-channel power MOSFET, cascaded by a PNP emitter-follower 
BJT. The physical locations of the two effective devices are illustrated in Fig. 4.39. It can be seen that 
there are two effective currents: the effective MOSFET channel current ip and the effective PNP collec-
tor current i2• 
The price paid for the reduced voltage drop of the IGBT is its increased switching times, espe-
cially during the turn-off transition. In particular, the IGBT turn-off transition exhibits a phenomenon 
known as current tailing. The effective MOSFET can be turned off quickly, by removing the gate charge 
such that the gate-to-emitter voltage is negative. This causes the channel current i 1 to quickly become 
zero. However, the PNP collector current i2 continues to flow as long as minority charge is present in the 
n- region. Since there is no way to actively remove the stored minority charge, it slowly decays via 
recombination. So i2 slowly decays in proportion to the minority charge, and a current tail is observed. 
The length of the current tail can be reduced by introduction of recombination centers in then- region, at 
Fig. 4.39 
Physical locations of the effective 
MOSFET and PNP components of the IGBT. 
p 
'777777777772221'::::::77777777 

88 
Switch Realization 
Table4.3 Characteristics of several commercial IGBTs 
Part number 
Rated maximum 
Rated average 
VF (typical) 
t1(typical) 
voltage 
current 
Single-chip devices 
HGTP12N60A4 
600V 
23A 
2.0V 
70ns 
HGTG32N60E2 
600V 
32A 
2.4 v 
0.62/lS 
PIGTG30N120D2 
1200V 
30A 
3.2V 
0.58 /lS 
Multiple-chip modules 
CM400HA-12E 
600V 
400A 
2.7V 
0.3 /lS 
CM300HA-24E 
1200V 
300A 
2.7V 
0.3 /lS 
CM800HA-34H 
1700V 
SOOA 
3.3 v 
0.6/lS 
High voltage modules 
CM 800HB-50H 
2500V 
SOOA 
3.15V 
1.0 /lS 
CM 600HB-90H 
4500V 
900A 
3.3V 
1.2 /lS 
the expense of a somewhat increased on-resistance. The current gain of the effective PNP transistor can 
also be minimized, causing i1 to be greater than i2• Nonetheless, the tum-off switching time of the IGBT 
is significantly longer than that of the MOSFET, with typical tum-off times in the range 0.5 p,s to 5 p,s. 
Switching loss induced by IGBT current tailing is discussed in Section 4.3.1. The switching frequencies 
of PWM converters containing IGBTs are typically in the range 1 to 30kHz. 
The added p-n- diode junction of the IGBT is not normally designed to block significant volt-
age. Hence, the IGBT has negligible reverse voltage-blocking capability. 
Since the IGBT is a four-layer device, there is the possibility of SCR-type latchup, in which the 
IGBT cannot be turned off by gate voltage control. Recent devices are not susceptible to this problem. 
These devices are quite robust, hot-spot and current crowding problems are nonexistent, and the need for 
external snubber circuits is minimal. 
The on-state forward voltage drop of the IGBT can be modeled by a forward-biased diode junc-
tion, in series with an effective on-resistance. The temperature coefficient of the IGBT forward voltage 
drop is complicated by the fact that the diode junction voltage has a negative temperature coefficient, 
while the on-resistance has a positive temperature coefficient. Fortunately, near rated current the on-
resistance dominates, leading to an overall positive temperature coefficient. In consequence, IGBTs can 
be easily connected in parallel, with a modest current derating. Large modules are commercially avail-
able, containing multiple parallel-connected chips. 
Characteristics of several commercially available single-chip IGBTs and multiple-chip IGBT 
modules are listed in Table 4.3. 
4.2.5 
Thyristors (SCR, GTO, MCT) 
Of all conventional semiconductor power devices, the silicon-controlled rectifier (SCR) is the oldest, has 
the lowest cost per rated kVA, and is capable of controlling the greatest amount of power. Devices having 
voltage ratings of 5000 to 7000 V and current ratings of several thousand amperes are available. In utility 
de transmission line applications, series-connected light-triggered SCRs are employed in inverters and 
rectifiers that interface the ac utility system to de transmission lines which carry roughly 1 kA and 1 MV. 
A single large SCR fills a silicon wafer that is several inches in diameter, and is mounted in a hockey-
puck-style case. 

Fig. 4.40 The SCR: (a) schematic symbol, 
(b) equivalent circuit. 
(a) 
4.2 A Brief Survey of Power Semiconductor Devices 
89 
(b) 
Anode 
Anode (A) 
Gate (G) 
1--L---o Gate 
Cathode (K) 
The schematic symbol of the SCR is illustrated in Fig. 4.40(a), and an equivalent circuit con-
taining NPN and PNP BJT devices is illustrated in Fig. 4.40(b). A cross-section of the silicon chip is 
illustrated in Fig. 4.41. Effective transistor Q1 is composed of then, p, and n- regions, while effective 
transistor Q2 is composed of the p, n-, and p regions as illustrated. 
The device is capable of blocking both positive and negative anode-to-cathode voltages. 
Depending on the polarity of the applied voltage, one of the p-n- junctions is reverse-biased. In either 
case, the depletion region extendsinto the lightly doped n- region. As with other devices, the desired 
voltage breakdown rating is obtained by proper design of the n- region thickness and doping concentra-
tion. 
The SCR can enter the on state when the applied anode-to-cathode voltage vAK is positive. Posi-
tive gate current ia then causes effective transistor Q 1 to turn on; this in turn supplies base current to 
effective transistor Q2, and causes it to turn on as well. The effective connections of the base and collec-
tor regions of transistors Q1 and Q2 constitute a positive feedback loop. Provided that the product of the 
current gains of the two transistors is greater than one, then the currents of the transistors will increase 
regeneratively. In the on state, the anode current is limited by the external circuit, and both effective tran-
sistors operate fully saturated. Minority carriers are injected into all four regions, and the resulting con-
ductivity modulation leads to very low forward voltage drop. In the on state, the SCR can be modeled as 
a forward-biased diode junction in series with a low-value on-resistance. Regardless of the gate current, 
the SCR is latched in the on state: it cannot be turned off except by application of negative anode current 
or negative anode-to-cathode voltage. In phase controlled converters, the SCR turns off at the zero cross-
ing of the converter ac input or output waveform. In forced commutation converters, external commuta-
Fig. 
4.41 
Physical locations of the effective 
NPN and PNP components of the SCR. 
K 
n 
p 
'222272?2?ZZZZ?lr:Z22ZZZZZZZZZZ 

90 
Switch Realization 
Fig. 4.42 
Static iA-vAK characteristics of the SCR. 
Reverse 
blocking 
Reverse 
breakdown 
Forward 
conducting 
increasing ic 
Forward/ 
blocking 
tion circuits force the controlled tum-off of the SCR, by reversing either the anode current or the anode-
to-cathode voltage. 
Static i rv AK characteristics of the conventional SCR are illustrated in Fig. 4.42. It can be seen 
that the SCR is a voltage-bidirectional two-quadrant switch. The tum-on transition is controlled actively 
via the gate current. The tum-off transition is passive. 
During the tum-off transition, the rate at which forward anode-to-cathode voltage is reapplied 
must be limited, to avoid retriggering the SCR. The tum-off time tq is the time required for minority 
stored charge to be actively removed via negative anode current, and for recombination of any remaining 
minority charge. During the tum-off transition, negative anode current actively removes stored minority 
charge, with waveforms similar to diode tum-off transition waveforms of Fig. 4.25. Thus, after the first 
zero crossing of the anode current, it is necessary to wait for time tq before reapplying positive anode-to-
cathode voltage. It is then necessary to limit the rate at which the anode-to-cathode voltage increases, to 
avoid retriggering the device. Inverter-grade SCRs are optimized for faster switching times, and exhibit 
smaller values oft q· 
Conventional SCR wafers have large feature size, with coarse or nonexistent interdigitation of 
the gate and cathode contacts. The parasitic elements arising from this large feature size lead to several 
limitations. During the tum-on transition, the rate of increase of the anode current must be limited to a 
safe value. Otherwise, cathode current focusin,g can occur, which leads to formation of hot spots and 
device failure. 
The coarse feature size of the gate and cathode structure is also what prevents the conventional 
SCR from being turned off by active gate control. One might apply a negative gate current, in an attempt 
to actively remove all of the minority stored charge and to reverse-bias the p-n gate-cathode junction. 
The reason that this attempt fails is illustrated in Fig. 4.43. The large negative gate current flows laterally 
through the adjoining the p region, inducing a voltage drop as shown. This causes the gate-cathode junc-
tion voltage to be smaller near the gate contact, and relatively larger away from the gate contact. The 
negative gate current is able to reverse-bias only the portion of the gate-cathode junction in the vicinity of 
the gate contact; the remainder of the gate-cathode junction continues to be forward-biased, and cathode 
current continues to flow. In effect, the gate contact is able to influence only the nearby portions of the 
cathode. 
The gate turn off thyristor, or GTO, is a modern power device having small feature size. The 
gate and cathode contacts highly interdigitated, such that the entire gate-cathode p-n junction can be 
reverse-biased via negative gate current during the turn-off transition. Like the SCR, a single large GTO 
can fill an entire silicon wafer. Maximum voltage and current ratings of commercial GTOs are lower than 
those of SCRs. 

Fig. 4.43 Negative gate cun·ent is unable . to 
completely reverse-bias the gate-cathode junction. 
The anode current focuses away from the gate 
contact. 
4.2 A Brief Survey of Power Semiconductor Devices 
91 
The turn-off gain of a GTO is the ratio of on-state current to the negative gate current magnitude 
required to switch the device off. Typical values of this gain are 2 to 5, meaning that several hundred 
amperes of negative gate current may be required to turn off a GTO conducting 1000 A. Also of interest 
is the maximum controllable on-state current. The GTO is able to conduct pe<;~k currents significantly 
greater than the rated average current; however, it may not be possible to switch the device off under gate 
control while these high peak currents are present. 
The MOS~controlled thyristor, or MCT, is a recent power device in which MOSFETs are inte-
grated onto a highly interdigitated SCR, to control the turn-on and turn-off processes. Like the MOSFET 
and IGBT, the MCT is a single-quadrant device whose turn-on and turn-off transitions are controlled by 
aMOS gate terminal. Commercial MCTs are p-type devices. Voltage-bidirectional two-quadrant MCTs, 
and n-type MCTs, are also possible. 
A cross-section of an MCT containing MOSFETs for control of the turn-on and turn-off transi-
tions is illustrated in Fig. 4.44. An equivalent circuit which explains the operation of this structure is 
given in Fig. 4.45. To turn the device on, the gate-to-anode voltage is driven negative. This forward-
biases p-channel MOSFET Q3, forward-biasing the base-emitter junction of BJT Q1• Transistors Q1 and 
Q2 then latch in the on-state. To turn the device off, the gate-to-anode voltage is driven positive. This for-
ward-biases n-channel MOSFET Q4, which in tum reverse-biases the base-emitter junction of BJT Q2. 
The BJTs then tum off. It is important that the on-resistance of the n-channel MOSFET be small enough 
Fig. 
4.44 MCT structure. Crosshatched 
regions are metallized contacts. Lightly 
shaded regions are insulating silicon dioxide 
layers. 
Q4 channel 
II 

92 
Switch Realization 
Fig. 4.45 
Equivalent circuit for the MCT. 
Anode 
that sufficient influence on the cathode current is exerted-this limits the maximum controllable on state 
current (i.e., the maximum current that can be interrupted via gate control). 
High-voltage MCTs exhibit lower forward voltage drops and higher current densities than 
IGBTs of similar voltage ratings and silicon area. However, the switching times are longer. Like the 
GTO, the MCT can conduct considerable surge currents; but again, the maximum current that can be 
interrupted via gate control is limited. To obtain a reliable turn-off transition, external snubbers are 
required to limit the peak anode-to-cathode voltage. A sufficiently fast gate-voltage rise time is also 
required. To some extent, the MCT is still an emerging device-future generations of MCTs may exhibit 
considerable improvements in performance and ratings. 
4.3 
SWITCHING LOSS 
Having implemented the switches using semiconductor devices, we can now discuss another major 
source of loss and inefficiency in converters: switching loss. As discussed in the previous section, the 
turn-on and turn-off transitions of semiconductor devices require times of tens of nanoseconds to micro-
seconds. During these switching transitions, very large instantaneous power loss can occur in the semi-
conductor devices. Even though the semiconductor switching times are short, the resulting average 
power loss can be significant. 
Semiconductor devices are charge controlled. For example, the conducting state of a MOSFET 
is determined by the charge on its gate and in its channel, and the conducting state of a silicon diode or a 
BIT is determined by the presence or absence of stored minority charge in the vicinity of the semicon-
ductor junctions inside the device. To switch a semiconductor device between the on and off states, the 
controlling charge must be inserted or removed; hence, the amount of controlling charge influences both 
the switching times and the switching loss. Charge, and energy, are also stored in the output capacitances 
of semiconductor devices, and energy is stored in the leakage and stray inductances in the circuit. In 
most converter circuits, these stored energies are also lost during the switching transitions. 
In this section the major sources of switching loss are described, and a simple method for esti-
mation of their magnitudes is given. For clarity, conduction losses and semiconductor forward voltage 
drops are neglected throughout this discussion. 

4.3 Switching Loss 
93 
iA 
iL(t) 
L 
vg 
VB 
Ideal 
diode 
is 
Fig. 4.46 MOSFET driving a clamped inductive load, buck converter example. 
4.3.1 
Transistor Switching with Clamped Inductive Load 
Let's consider first the switching waveforms in the buck converter of Fig. 4.46. Let us treat the diode as 
ideal, and investigate only the switching loss due to the MOSFET switching times. The MOSFET drain-
to-source capacitance is also neglected. 
The diode and inductor present a clamped inductive load to the transistor. With such a load, the 
transistor voltage vA(t) and current iA(t) do not change simultaneously. For example, a magnified view of 
the transistor tum-off-transition waveforms is given in Fig. 4.47. For simplicity, the waveforms are 
Fig. 4.47 Magnified view of transistor 
turn-off transition waveforms for the circuit 
of Fig. 4.46. 
Tra11sistor 
wavefonns 
Diode 
waveforms 
0 
0 
-V 
g 
0 
0 
area 
w off 

94 
Switch Realization 
approximated as piecewise-linear. The switching times are short, such that the inductor current iL(t) is 
essentially constant during the entire switching transition t0 < t < t2• No current flows through the diode 
while the diode is reverse-biased, and the diode cannot become forward-biased while its voltage vs(t) is 
negative. So first, the voltage v it) across the transistor must rise from zero to V8. The interval length 
(t1 - t0 ) is essentially the time required for the gate driver to charge the MOSFET gate-to-drain capaci-
tance. The transistor current iA(t) is constant and equal toiL during this interval. 
The diode voltage vs(t) and current is(t) are given by 
vit) = V A(t)- V8 
iA(t) + iit) = iL 
(4.6) 
At timet= tl' when vA = V8, the diode becomes forward-biased. The current iL now begins to commute 
from the transistor to the diode. The interval length (t2 - t1) is the time required for the gate driver to dis-
charge the MOSFET gate-to-source capacitance down to the threshold voltage which causes the MOS-
FET to be in the off state. 
The instantaneous power pA(t) dissipated by the transistor is equal to vA(t)iit). This quantity is 
also sketched in Fig. 4.47. The energy W0fflost during the transistor turn-off transition is the area under 
this waveform. With the simplifying assumption that the waveforms are piecewise-linear, then the energy 
lost is the area of the shaded triangle: 
(4.7) 
This is the energy lost during each transistor turn-off transition in the simplified circuit of Fig. 4.46. 
The transistor turn-on waveforms of the simplified circuit of Fig. 4.46 are qualitatively similar 
to those of Fig. 4.47, with the time axis reversed. The transistor current must first rise from 0 to iL" The 
diode then becomes reverse-biased, and the transistor voltage can fall from Vg to zero. The instantaneous 
transistor power dissipation again has peak value ViL• and if the waveforms are piecewise linear, then the 
energy lost during the turn-on transition won is given by 0.5 VgiL multiplied by the transistor turn-on time. 
Thus, during one complete switching period, the total energy lost during the turn-on and turn-
off transitions is (Won + W0ff). If the switching frequency is f., then the average power loss incurred due to 
switching is 
P,w = i.J 
PA(t)dt = (Won+ Woff )fs 
switching 
transitions 
So the switching loss P,w is directly proportional to the switching frequency. 
(4.8) 
An example where the loss due to transistor switching times is particularly significant is the cur-
rent tailing phenomenon observed during the turn-off transition of the IGBT. As discussed in Section 
4.2.4, current tailing occurs due to the slow recombination of stored minority charge in the n- region of 
the IGBT. This causes the collector current to slowly decay after the gate voltage has been removed. 
A buck converter circuit containing an ideal diode and nonideal (physical) IGBT is illustrated in 
Fig. 4.48. Turn-off transition waveforms are illustrated in Fig. 4.49; these waveforms are similar to the 
MOSFET waveforms of Fig. 4.47. The diode is initially reverse-biased, and the voltage vit) rises from 
approximately zero to V8• The interval length (t1 - t0 ) is the time required for the gate drive circuit to 
charge the IGBT gate-to-collector capacitance. At time t = t1, the diode becomes forward-biased, and 
current begins to commute from the IGBT to the diode. The interval (t2 - t1) is the time required for the 
gate drive circuit to discharge the IGBT gate-to-emitter capacitance to the threshold value which causes 

4.3 Switching Loss 
95 
iA 
iL(t) 
L 
vg 
VB 
Ideal 
diode 
iB 
Fig. 4.48 IGBT switching loss example. 
the effective MOSFET in Fig. 4.38(b) to be in the off state. This time can be minimized by use of a high-
current gate drive circuit which discharges the gate capacitance quickly. However, switching off the 
effective MOSFET does not completely interrupt the IGBT current iit): current i2(t) continues to flow 
through the effective PNP bipolar junction transistor of Fig. 4.38(b) as long as minority carriers continue 
to exist within its base region. During the interval t2 < t < t3, the current is proportional to this stored 
minority charge, and the current tail interval length (t3 - t2) is equal to the time required for this. remain-
ing stored minority charge to recombine. 
The energy Woff lost during the tum-off transition of the IGBT is again the area under the instan-
taneous power waveform, as illustrated in Fig. 4.49. The switching loss can again be evaluated using Eq. 
(4.8). 
The switching times of the IGBT are typically in the vicinity of 0.2 to 2 p,s, or several times 
Fig. 
4.49 IGBT turn-off transition 
waveforms for the circuit of Fig. 4.48. 
IGBT 
waveform.)· 
Diode 
waveforms 
0 
0 
iL 
0 
0 

96 
Switch Realization 
longer than those of the power MOSFET. The resulting switching loss limits the maximum switching 
frequencies of conventional PWM converters employing IGBTs to roughly 1 to 30kHz. 
4.3.2 
Diode Recovered Charge 
As discussed previously, the familiar exponential i-v characteristic of the diffused-junction p-n diode is 
an equilibrium relationship. During switching transients, significant deviations from this characteristic 
are observed, which can induce transistor switching loss. In particular, during the diode tum-off tran-
sient, its stored minority charge must be removed, either actively via negative current i8(t), or passively 
via recombination inside the device. The diode remains forward-biased while minority charge is present 
in the vicinity of the diode semiconductor junction. The initial amount of minority charge is a function of 
the forward current, and its rate of change, under forward-biased conditions. The turn-off switching time 
is the time required to remove all of this charge, and to establish a new reverse-biased operating point. 
This process of switching the diode from the forward-biased to reverse-biased states is called reverse 
recovery. 
Again, most diffused-junction power diodes are actually p-n--n+ or p-i-n devices. The lightly 
doped or intrinsic region (of the diode and other power semiconductor devices as well) allows large 
breakdown voltages to be obtained. Under steady-state forward-biased conditions, a substantial amount 
of stored charge is present in this region, increasing its conductivity and leading to a low diode on-resis-
tance. It takes time to insert and remove this charge, however, so there is a tradeoff between high break-
down voltage, low on-resistance, and fast switching times. 
To understand how the diode stored charge induces transistor switching loss, let us consider the 
buck converter of Fig. 4.50. Assume for this discussion that the transistor switching times are much faster 
than the switching times of the diode, such that the diode reverse recovery mechanism is the only signif-
icant source of switching loss. A magnified view of the transistor-tum-on transition waveforms under 
these conditions is given in Fig. 4.51. 
Initially, the diode conducts the inductor current, and hence some amount of stored minority 
charge is present in the diode. The transistor is initially in the off state. When the transistor turns on, a 
negative current flows through the diode; this current actively removes some or most of the diode stored 
minority charge, while the remainder of the minority charge recombines within the diode. The rate of 
change of the current is typically limited by the package inductance and other stray inductances present 
in the external circuit; hence, the peak magnitude of the reverse current depends on the external circuit, 
and can be many times larger than the forward current iL. The area within the negative portion of the 
diode current waveform is the recovered stored charge Q,, while the interval length (t2 - t0 ) is the reverse 
recovery timet,. The magnitude of Q, is a function of the on state forward current iL at the initiation of 
the turn-off process, as well as the circuit-limited rate-of-change of the diode current, dis(t)ldt. During 
Fig. 4.50 
Example, switching loss induced by diode stored charge. 
L 
Silicon 
diode 

4.3 Switching Loss 
97 
the interval t0 < t < fp the diode remains forward-biased, and hence the transistor voltage is v ,f At time 
t = tp the stored charge in the vicinity of the p-n- or p-i junction is exhausted. This junction becomes 
reverse-biased, and begins to block voltage. During the interval t1 < t < t2 , the diode voltage decreases to 
-V8 • Some negative diode current continues to flow, removing any remaining stored minority charge as 
well as charging the depletion layer capacitance. At time t = t2, this current is essentially zero, and the 
diode operates in steady state under reverse-biased conditions. 
Diodes in which the interval length (t2 - t 1) 
is short compared to (t1 - t0) are called abrupt-recov-
ery or "snappy" diodes. Soft recovery diodes exhibit 
1 
1 
f ( 
)/( 
) Wh 
· · fi 
Transistor 
arger va ues o 
t2 - t 1 t 1 - t0 . 
en s1gm cant 
waveforms 
package and/or stray inductance is present in series 
with the diode, ringing of the depletion region capac-
itance with the package and stray inductances may 
be observed. ·If severe, this ringing can cause excess 
reverse voltage that leads to device failure. External 
R-C snubber circuits are sometimes necessary for 
reliable operation, The reverse-recovery characteris-
0 
tics of soft recovery diodes are intended to exhibit 
Diode 
less ringing and voltage overshoot. Snubbing of 
waveforms r---=iL:...._~ 
these diodes can be reduced or eliminated. 
The instantaneous power pA(t) dissipated in 
the transistor is also sketched in Fig. 4.51. The 
energy lost during the turn-on transition is 
WD= J vA(t)iA(t)dt 
switching 
transition 
(4.9) 
For 
an 
abrupt-recovery 
diode 
in 
which 
(t2 - t1) « (t1 - t0), this integral can be evaluated in a 
simple manner. The transistor voltage v it) is then 
equal to V8 for essentially the entire diode recovery 
interval. In addition, iA = iL - i8. Equation (4.9) then 
becomes 
wD ~ J vg(iL - is(t))dt 
switching 
1ransition 
(4.10) 
0 
Area 
-Qr 
0 
0 
Fig. 4.51 Transistor-turn-on transition waveforms 
for the circuit of Fig. 4.50. 
where the recovered charge Qr is defined as the inte-
gral of the diode current- is(t) over the interval t0 < t < t2. Hence, the diode reverse recovery process 
leads directly to switching loss W of:. This is often the largest single component of switching loss in a 
conventional switching converter. It can be reduced by use of faster diodes, designed for minimization of 
stored minority charge. 

98 
Switch Realization 
Fig. 4.52 The energy stored in the semicon-
ductor output capacitances is lost during the 
transistor turn-on transition. 
4.3.3 
Device Capacitances, and Leakage, Package, and Stray Inductances 
Reactive elements can also lead to switching loss. Capacitances that are effectively in parallel with 
switching elements are shorted out when the switch turns on, and any energy stored in the capacitance is 
lost. The capacitances are charged without energy loss when the switching elements tum off, and the 
transistor turn-off loss Woff computed in Eq. ( 4.7) may be reduced. Likewise, inductances that are effec-
tively in series with a switching element lose their stored energy when the switch turns off. Hence, series 
inductances lead to additional switching loss at tum-off, but can reduce the transistor turn-on loss. 
The stored energies of the reactive elements can be summed to find the total energy loss per 
switching period due to these mechanisms. For linear capacitors and inductors, the stored energy is 
We= L tcv2 
capacitive 
1 
1 
elements 
(4.11) 
WL= L _2\L/2 
inductive 
1 1 
elements 
A common source of this type of switching loss is the output capacitances of the semiconductor switch-
ing devices. The depletion layers of reverse-biased semiconductor devices exhibit capacitance which 
stores energy. When the transistor turns on, this stored energy is dissipated by the transistor. For example, 
in the buck converter of Fig. 4.52, the MOSFET exhibits drain-to-source capacitance Cds• and the 
reverse-biased diode exhibits junction capacitance CF During the switching transitions these two capaci-
tances are effectively in parallel, since the de source Vg is effectively a short-circuit at high frequency. To 
the extent that the capacitances are linear, the energy lost when the MOSFET turns on is 
(4.12) 
Typically, this type of switching loss is significant at voltage levels above !00 V. The MOSFET gate 
drive circuit, which must charge and discharge the MOSFET gate capacitances, also exhibits this type of 
loss. 
As noted in Section 4.2.2, the incremental drain-to-source capacitance Cds of the power MOS-
FET is a strong function of the drain-to-source voltage vds· Cd,(vd) follows an approximate inverse-
square-root dependence of v ds• as given by Eq. ( 4.5). The energy stored in Cds at v ds = VDS is 
(4.13) 

4.3 
Switching Loss 
99 
where ic = Cds(v d,.) dv d/dt is the current in C ds· Substitution of Eq. ( 4.5) into ( 4.13) yields 
(4.14) 
This energy is lost each time the MOSFET switches on. From the standpoint of switching loss, the drain-
to-source capacitance is equivalent to a linear capacitance having the value jcds( V Ds). 
The Schottky diode is essentially a majority-carrier device, which does not exhibit a reverse-
recovery transient such as in Fig. 4.51. Reverse-biased Schottky diodes do exhibit significant junction 
capacitance, however, which can be modeled with a parallel capacitor C1 as in Fig. 4.52, and which leads 
to energy loss at the transistor turn-on transition. 
Common sources of series inductance are transformer leakage inductances in isolated convert-
ers (discussed in Chapter 6), as well as the inductances of interconnections and of semiconductor device 
packages. In addition to generating switching loss, these elements can lead to excessive peak voltage 
stress during the transistor turn-off transition. Interconnection and package inductances can lead to sig-
nificant switching loss in high-current applications, and leakage inductance is an important source of 
switching loss in many transformer-isolated converters. 
Diode stored minority charge can induce switch-
ing loss in the (nonideal) converter reactive elements. As 
an example, consider the circuit of Fig. 4.53, containing 
an ideal voltage source vi(t), an inductor L, a capacitor C 
(which may represent the diode junction capacitance, or vJt) 
the junction capacitance in parallel with an external 
capacitor), and a silicon diode. The diode switching pro-
cesses of many converters can be modeled by a circuit of 
L 
Silicon 
diode 
c 
this form. Many rectifier circuits containing SCRs exhibit 
similar waveforms. The voltage source produces the rect-
angular waveform v;(t) illustrated in Fig. 4.54. This volt-
age is initially positive, causing the diode to become 
Fig. 4.53 
A circuit in which the diode stored 
charge induces ringing, and ultimately switch-
ing loss, in (nonideal) reactive elements. 
forward-biased and the inductor current iL(t) to increase linearly with slope V1/L. Since the current is 
increasing, the stored minority charge inside the diode also increases. At timet= tp the source voltage 
vi(t) becomes negative, and the inductor current decreases with slope diL!dt =- V2/L. The diode stored 
charge also decreases, but at a slower rate that depends not only on iL but also on the minority carrier 
recombination lifetime of the silicon material in the diode. Hence, at timet= t2, when iL(t) reaches zero, 
some stored minority charge remains in the diode. So the diode continues to be forward-biased, and the 
inductor current continues to decrease with the same slope. The negative current for t > t2 constitutes a 
reverse diode current, which actively removes diode stored charge. At some time later, t = t3, the diode 
stored charge in the vicinity of the diode junction becomes zero, and the diode junction becomes reverse-
biased. The inductor current is now negative, and must flow through the capacitor. The inductor and 
capacitor then form a series resonant circuit, which rings with decaying sinusoidal waveforms as shown. 
This ringing is eventually damped out by the parasitic loss elements of the circuit, such as the inductor 
winding resistance, inductor core loss, and capacitor equivalent series resistance. 
The diode recovered charge induces loss in this circuit. During the interval t2 < t < t3, the minor-
ity stored charge Qr recovered from the diode is 
(4.15) 

100 
Switch Realization 
Ot------1----------
v8(t) 
Of-----!!-----t--i----
·················l··················J·······r·············· 
Fig. 4.54 Waveforms of the circuit of Fig. 
4.53. 
This charge is directly related to the energy stored in the 
inductor during this interval. The energy WL stored in 
the inductor is the integral of the power flowing into the 
inductor: 
(4.16) 
During this interval, the applied inductor voltage is 
(4.17) 
Substitution of Eq. (4.17) into Eq. (4.16) leads to 
(4.18) 
Evaluation of the integral on the left side yields the 
stored inductor energy at t = t3, or LiL2(t3)12. The right-
side integral is evaluated by noting that V2 is constant 
and by substitution of Eq. (4.15), yielding V2Qr. Hence, 
the energy stored in the inductor at t = t3 is 
(4.19) 
or, the recovered charge multiplied by the source volt-
age. For t > t3, the ringing of the resonant circuit formed 
by the inductor and capacitor causes this energy to be circulated back and forth between the inductor and 
capacitor. If parasitic loss elements in the circuit cause the ringing amplitude to eventually decay to zero, 
then the energy becomes lost as heat in the parasitic elements. 
So diode stored minority charge can lead to loss in circuits that do not contain an active switch-
ing element. Also, ringing waveforms that decay before the end of the switching period indicate the pres-
ence of switching loss. 
4.3.4 
Efficiency vs. Switching Frequency 
Suppose next that we add up all of the energies lost due to switching, as discussed above: 
(4.20) 
This is the energy lost in the switching transitions of one switching period. To obtain the average switch-
ing power loss, we must multiply by the switching frequency: 
(4.21) 
Other losses in the converter include the conduction losses Pcond' modeled and solved as in Chapter 3, 

4.4 Summary of Key Points 
101 
100% 
................. 4~_(l_SY.!f!P..~I_Jf.~ .... , ............... . 
Fig. 
4.55 
Efficiency vs. switching 
frequency, based on Eq. (4.22), using 
arbitrary choices for the values of loss 
and load power. Switching loss causes 
the efficiency to decrease rapidly at 
high frequency. 
90% 
80% 
70% 
60% 
50% 
10kHz 
!~ 
l ~-
100kHz 
1 MHz · 
and other frequency-independent fixed losses P fixed• such as the power required to operate the control cir-
cuit. The total loss is therefore 
Ploss ::::: p cond + p fixed + W tot f..w 
(4.22) 
which increases linearly with frequency. At the critical frequency 
pcond + p fixed 
fcrit.::: 
W . 
tot 
(4.23) 
the switching losses are equal to the other converter losses. Below this critical frequency, the total loss is 
dominated by the conduction and fixed loss, and hence the total loss and converter efficiency are not 
strong functions of switching frequency. Above the critical frequency, the switching loss dominates the 
total loss, and the converter efficiency decreases rapidly with increasing switching frequency. Typical 
dependence of the full-load converter efficiency on switching frequency is plotted in Fig. 4.55, for an 
arbitrary choice of parameter values. The critical frequency fcrit can be taken as a rough upper limit on the 
switching frequency of a practical converter. 
4.4 
SUMMARY OF KEY POINTS 
1. 
How an SPST ideal switch can be realized using semiconductor devices depends on the polarity of the 
voltage that the devices must block in the off state, and on the polarity of the current which the devices 
must conduct in the on state. 
2. 
Single-quadrant SPST switches can be realized using a single transistor or a single diode, depending on 
the relative polarities of the off state voltage and on state current. 

102 
Switch Realization 
3. 
Two-quadrant SPST switches can be realized using a transistor and diode, connected in series (bidirec-
tional-voltage) or in antiparallel (bidirectional-current). Several four-quadrant schemes are also listed here. 
4. 
A "synchronous rectifier" is a MOSFET connected to conduct reverse current, with gate drive control as 
necessary. This device can be used where a diode would otherwise be required. If a MOSFET with suffi-
ciently low R011 is used, reduced conduction loss is obtained. 
5. 
Majority carrier devices, including the MOSFET and Schottky diode, exhibit very fast switching times, 
controlled essentially by the charging of the device capacitances. However, the forward voltage drops of 
these devices increases quickly with increasing breakdown voltage. 
6. 
Minority carrier devices, including the BJT, IGBT, and thyristor family, can exhibit high breakdown volt-
ages with relatively low forward voltage drop. However, the switching times of these devices are longer, 
and are controlled by the times needed to insert or remove stored minority charge. 
7. 
Energy is lost during switching transitions, owing to a variety of mechanisms. The resulting average power 
loss, or switching loss, is equal to this energy loss multiplied by the switching frequency. Switching loss 
imposes an upper limit on the switching frequencies of practical converters. 
8. 
The diode and inductor present a "clamped inductive load" to the transistor. When a transistor drives such 
a load, it experiences high instantaneous power loss during the switching transitions. An example where 
this leads to significant switching loss is the IGBT and the "current tail" observed during its turn-off tran-
sition. 
9. 
Other significant sources of switching loss include diode stored charge and energy stored in certain para-
sitic capacitances and inductances. Parasitic ringing also indicates the presence of switching loss. 
REFERENCES 
[1] 
R. D. MIDDLEBROOK, S. CUK, and W. BEHEN, "A New Battery Charger/Discharger Converter," IEEE 
Power Electronics Specialists Conference, 1978 Record, pp. 251-255, June 1978. 
[2] 
H. MATSUO and F. KUROKAWA, "New Solar Cell Power Supply System Using a Boost Type Bidirectional 
De-De Converter," IEEE Power Electronics Specialists Conference, 1982 Record, pp. 14-19, June 1982. 
[3] 
M. VENTURINI, "A New Sine-Wave-In Sine-Wave-Out Conversion Technique Eliminates Reactive Ele-
ments," Proceedings Seventh International Solid-State Power Conversion Conference (Powercon 7), pp. 
E3.1-E3.13, 1980. 
[4] 
K. D. T. NGO, S. CUK, and R. D. MIDDLEBROOK, "A New Flyback De-to-Three-Phase Converter with 
Sinusoidal Outputs," IEEE Power Electronics Specialists Conference, 1983 Record, pp. 377-388. 
[5] 
S. CUK, "Basics of Switched-Mode Power Conversion: Topologies, Magnetics, and Control," Advances in 
Switched-Mode Power Conversion, Vol. II, Irvine CA: Teslaco, pp. 279-310, 1983. 
[6] 
L. GYUGI and B. PELLY, Static Power Frequency Changers: Theory, Peiformance, and Applications, New 
York: Wiley-Interscience, 1976. 
[7] 
R. S. KAGAN and M. CHI, "Improving Power Supply Efficiency with MOSFET Synchronous Rectifiers," 
Proceedings Ninth International Solid-State Power Conversion Conference (Powercon 9), pp. D4.1-D4.9, 
July 1982. 
[8] 
R. BLANCHARD and P. E. THIBODEAU, "The Design of a High Efficiency, Low Voltage Power Supply 
Using MOSFET Synchronous Rectification and Current Mode Control," IEEE Power Electronics Special-

Problems 
103 
ists Conference, 1985 Record, pp. 355-361, June 1985. 
[9] 
N. MOHAN, T. UNDELAND, and W. ROBBINS, Power Electronics: Converters, Applications, and Design, 
2nd edit., New York: John Wiley & Sons, 1995, Chapters 19-26. 
[10] 
C. L. MA and P. 0. LAURITZEN, "A Simple Power Diode Model with Forward and Reverse Recovery," 
IEEE Power Electronics Specialists Conference, 1991 Record, pp. 411-415, June 1991. 
[11] 
M. SCHLECHT and L. CASEY, "A Comparison of the Square Wave and Quasi-Resonant Topologies," IEEE 
Applied Power Electronics Conference, 1987 Record, pp. 124-134, March 1987. 
[12] 
B. J. BALIGA, Modern Power Devices, New York: John Wiley & Sons, 1987. 
[13] 
P. GRAY, D. DEWITT, A. BOOTHROYD, and J. GIBBONS, Physical Electronics and Circuit Models of Tran-
sistors, Semiconductor Electronics Education Committee, Vol. 2, New York: John Wiley & Sons, 1964. 
[14] 
E. OXNER, Power FETs and Their Applications, Englewood, New Jersey: Prentice-Hall, 1982. 
[15] 
M. RASHID, Power Electronics: Circuits, Devices, and Applications, 2nd edit., Englewood, New Jersey: 
Prentice Hall, 1993, Chapters 3, 4, and 8. 
[16] 
B. J. BALIGA, M. S. ADLER, R. P. LOVE, P. V. GRAY, and N. D. ZAMMER, "The Insulated Gate Transistor 
-A New Three Terminal MOS-Controlled Bipolar Power Device," IEEE Transactions on Electron 
Devices, Vol. 31, No.6, pp. 821-828, June 1984. 
[17] 
V. TEMPLE, "MOS-Controlled Thyristors-A New Class of Power Devices," IEEE Transactions on Elec-
tron Devices, Vol. 33, No. 10, pp. 1609-1618, October 1986. 
[18] 
S. SUL, F. PROFUMO, G. CHO, and T. LIPO, "MCTs and IGBTs: A Comparison of Performance in Power 
Electronics Circuits," IEEE Power Electronics Specialists Conference, 1989 Record, pp. 163-169, June 
1989. 
[19] 
V. TEMPLE, S. ARTHUR, D. WATROUS, R. DE DONCKER, and H. METHA, "Megawatt MOS Controlled 
Thyristor for High Voltage Power Circuits," IEEE Power Electronics Specialists Conference, 1992 Record, 
pp. 1018-1025, June 1992. 
PROBLEMS 
In Problems 4.1 to 4.6, the input voltage V8 is de and positive with 
the polarity shown. Specify how to implement the switches using a 
minimal number of diodes and transistors, such that the converter 
operates over the entire range of duty cycles 0 ~ D ~ l. The switch 
states should vary as shown in Fig. 4.56. You may assume that the 
inductor current ripples and capacitor voltage ripples are small. 
For each problem, do the following: 
(a) 
Realize the switches using SPST ideal 
switches, and explicitly define the voltage and 
current of each switch. 
(b) 
Express the on-state current and off-state volt-
Switch 
position 
2 
Fig. 4.56 
Switch control method for Prob-
lems 4.1 to 4.6. 
age of each SPST switch in terms of the converter inductor currents, capacitor voltages, and/or 

104 
Switch Realization 
4.1 
4.2 
4.3 
4.4 
input source voltage. 
(c) 
Solve the converter to determine the inductor currents and capacitor voltages, as in Chapter 2. 
(d) 
Determine the polarities of the switch on-state currents and off-state voltages. Do the polarities 
vary with duty cycle? 
(e) 
State how each switch can be realized using transistors and/or diodes, and whether the realiza-
tion requires single-quadrant, current-bidirectional two-quadrant, voltage-bidirectional two-
quadrant, or four-quadrant switches. 
+ 
2 
2 

Problems 
105 
4.5 
2 
4.6 
2 
4.7 
An IGBT and a silicon diode operate in a buck converter, with the IGBT waveforms illustrated in Fig. 
4.57. The converter operates with input voltage V8 = 400 V, output voltage V = 200 V, and load current I 
=lOA. 
VCE 
ic 
VcE(t) 
400V 40A 
300V 30A 
200V 20A 
lOOV lOA 
ov 
OA 
ic(t) 
0 
2 
f.l.lS 
Fig. 4.57 IGBT voltage and current waveforms, Problem 4.7. 
(a) 
Estimate the total energy lost during the switching transitions. 
(b) 
The forward voltage drop of the IGBT is 2.5 V, and the diode has forward voltage drop 1.5 V. All 
other sources of conduction loss and fixed loss can be neglected. Estimate the semiconductor 
conduction loss. 
(c) 
Sketch the converter efficiency over the range of switching frequencies 1 kHz ~fs ~ 100kHz, 
and label numerical values. 
4.8 
Two MOSFETs are employed as current-bidirectional two-quadrant switches in a bidirectional battery 
charger/discharger based on the de-de buck converter. This converter interfaces a 16 V battery to a 28 V 
main power bus. The maximum battery current is 40 A. The MOSFETs have on-resistances of 35 mQ. 

106 
Switch Realization 
Their body diodes have forward voltage drops of 1.0 V, and exhibit recovered charge Qr of 25 p,C and 
reverse recovery times tr of 200 ns in the given circuit. You may assume that all diodes in this problem 
have "snappy" reverse recovery characteristics, and also assume that diode stored charge is the dominant 
cause of switching loss in this circuit. You may neglect all losses other than the semiconductor conduc-
tion losses and the switching loss induced by diode stored charge. 
The current-bidirectional two-quadrant switches are realized as in Fig. 4.10(a), utilizing the 
MOSFET body diodes. 
(a) 
Estimate the switching energy loss, conduction loss, and converter efficiency, when the battery is 
being charged at the maximum rate. The switching frequency is 100kHz. 
External diodes are now added as illustrated in Fig. 4.10(b). These diodes have forward voltage drops of 
1.0 V, and exhibit recovered charge Qr of 5 p,C and reverse recovery times tr of 40 ns in the given circuit. 
(b) 
Repeat the analysis of Part (a), for this case. 
(c) 
Over what range of switching frequencies does the addition of the external diodes improve the 
converter efficiency? 
4.9 
A switching converter operates with a switching frequency of 100kHz. The converter waveforms exhibit 
damped sinusoidal ringing, initiated by the transistor turn-off transition, which decays slowly but even-
tually reaches zero before the end of the switching period. This ringing occurs in a series resonant circuit 
formed by parasitic inductances and capacitances in the circuit. The frequency of the ringing is 5 MHz. 
During the first period of sinusoidal ringing, the ac inductor current reaches a peak magnitude of 0.5 A, 
and the ac capacitor voltage reaches a peak magnitude of 200 V. Determine the following quantities: 
(a) 
the value of the total parasitic inductance, 
(b) 
the value of the total parasitic capacitance, 
(c) 
the energy lost per switching period, associated with this ringing, and 
(d) 
the switching loss associated with this ringing. 
(e) 
Derive a general expression for the switching loss, as a function of the switching frequency, 
ringing frequency, and the ringing voltage and current peak magnitudes during the first period of 
ringing. 

5 
The Discontinuous Conduction Mode 
When the ideal switches of a de-de converter are implemented using current-unidirectional and/or volt-
age-unidirectional semiconductor switches, one or more new modes of operation known as discontinu-
ous conduction modes (DCM) can occur. The discontinuous conduction mode arises when the switching 
ripple in an inductor current or capacitor voltage is large enough to cause the polarity of the applied 
switch current or voltage to reverse, such that the current- or voltage-unidirectional assumptions made in 
realizing the switch with semiconductor devices are violated. The DCM is commonly observed in de-de 
converters and rectifiers, and can also sometimes occur in inverters or in other converters containing two-
quadrant switches. 
The discontinuous conduction mode typically occurs with large inductor current ripple in a con-
verter operating at light load and containing current-unidirectional switches. Since it is usually required 
that converters operate with their loads removed, DCM is frequently encountered. Indeed, some convert-
ers are purposely designed to operate in DCM for all loads. 
The properties of converters change radically in the discontinuous conduction mode. The con-
version ratio M becomes load-dependent, and the output impedance is increased. Control of the output 
may be lost when the load is removed. We will see in a later chapter that the converter dynamics are also 
significantly altered. 
In this chapter, the origins of the discontinuous conduction mode are explained, and the mode 
boundary is derived. Techniques for solution of the converter waveforms and output voltage are also 
described. The principles of inductor volt-second balance and capacitor charge balance must always be 
true in steady state, regardless of the operating mode. However, application of the small ripple approxi-
mation requires some care, since the inductor current ripple (or one of the inductor current or capacitor 
voltage ripples) is not small. 
Buck and boost converters are solved as examples. Characteristics of the basic buck, boost, and 
buck-boost converters are summarized in tabular form. 

108 
The Discontinuous Conduction Mode 
5.1 
ORIGIN OF THE DISCONTINUOUS CONDUCTION MODE, 
AND MODE BOUNDARY 
Let us consider how the inductor and switch current waveforms change as the load power is reduced. 
Let's use the buck converter (Fig. 5.1) as a simple example. The inductor current iL(t) and diode current 
iv(t) waveforms are sketched in Fig. 5.2 for the continuous conduction mode. As described in Chapter 2, 
the inductor current waveform contains a de component I, plus switching ripple of peak amplitude AiL" 
During the second subinterval, the diode current is identical to the inductor current. The minimum diode 
current during the second subinterval is equal to (I- AiL); since the diode is a single-quadrant switch, 
operation in the continuous conduction mode requires that this current remain positive. As shown in 
Chapter 2, the inductor current de component I is equal to the load current: 
(5.1) 
since no de current flows through capacitor C. It can be seen that I depends on the load resistance R. The 
Fig. 
5.1 
Buck converter 
example. 
Fig. 5.2 
Buck converter wave-
forms in the continuous conduc-
tion mode: (a) inductor current 
iL(t), (b) diode current i0 (t). 
(a) 
I 
0 
Conducting ; 
devices: 
f 
(b) 
iv(t) 
I 
0 
L 
+ 
c 
R 
v 
DTS 

Fig. 
5.3 Buck converter 
waveforms at the boundary 
between the continuous and 
discontinuous 
conduction 
modes: (a) inductor current 
iL(t), (b) diode current i0 (t). 
(a) 
(b) 
switching ripple peak amplitude is: 
5.1 
Origin of the Discontinuous Conduction Mode, and Mode Boundary 
109 
Conducting 
devices: 
I ·········· 
0 
(5.2) 
The ripple magnitude depends on the applied voltage (Vg - V), on the inductance L, and on the transistor 
conduction time DTs. But it does not depend on the load resistance R. The inductor current ripple magni-
tude varies with the applied voltages rather than the applied currents. 
Suppose now that the load resistance R is increased, so that the de load current is decreased. The 
de component of inductor current I will then decrease, but the ripple magnitude tliL will remain 
unchanged. If we continue to increaseR, eventually the point is reached where I= fliv illustrated in Fig. 
5.3. It can be seen that the inductor current iL(t) and the diode current iv(t) are both zero at the end of the 
switching period. Yet the load current is positive and nonzero. 
What happens if we continue to increase the load resistance R? The diode current cannot be 
negative; therefore, the diode must become reverse-biased before the end of the switching period. As 
illustrated in Fig. 5.4, there are now three subintervals during each switching period Ts. During the first 
subinterval of length D1 Ts the transistor conducts, and the diode conducts during the second subinterval 
of length D2T,. At the end of the second subinterval the diode current reaches zero, and for the remainder 
of the switching period neither the transistor nor the diode conduct. The converter operates in the discon-
tinuous conduction mode. 
Figure 5.3 suggests a way to find the boundary between the continuous and discontinuous con-
duction modes. It can be seen that, for this buck converter example, the diode current is positive over the 
entire interval DTs < t < Ts provided that I> tliL. Hence, the conditions for operation in the continuous 
and discontinuous conduction modes are: 

110 
The Discontinuous Conduction Mode 
Fig. 
5.4 Buck 
converter 
waveforms in the discontinuous 
conduction mode: (a) inductor 
current iL(t), (b) diode current 
iD(t). 
DT5 
T5 
Conducting 
devices: 
-- DI Ts -:-- D2Ts -:.- D3Ts .. : 
QI 
: 
DI i 
X i 
0 
I> LliL for CCM 
I< LliL for DCM 
DTS 
. 
1--DlTs-+1 
(5.3) 
where I and !:1iL are found assuming that the converter operates in the continuous conduction mode. 
Insertion ofEqs. (5.1) and (5.2) into Eq. (5.3) yields the following condition for operation in the discon-
tinuous conduction mode: 
Simplification leads to 
This can also be expressed 
where 
.JJ,_ < D' 
RT, 
and 
(5.4) 
(5.5) 
(5.6) 

5.1 
Origin of the Discontinuous Conduction Mode, and Mode Boundary 
111 
Fig. 5.5 
Buck converter K,,;/D) vs. D. The converter oper-
ates in CCM when K > K,,;,, and in DCM when K < K,,;,· 
2 
D 
The dimensionless parameter K is a measure of the tendency of a converter to operate in the discontinu-
ous conduction mode. Large values of K lead to continuous mode operation, while small values lead to 
the discontinuous mode for some values of duty cycle. The critical value of K at the boundary between 
modes, Kcri/D), is a function of duty cycle, and is equal to D' for the buck converter. 
The critical value Kcrit(D) is plotted vs. duty cycleD in Fig. 5.5. An arbitrary choice of K is also 
illustrated. For the values shown, it can be seen that the converter operates in DCM at low duty cycle, and 
in CCM at high duty cycle. Figure 5.6 illustrates what happens with heavier loading. The load resistance 
R is reduced in value, such that K is larger. If K is greater than one, then the converter operates in the con-
tinuous conduction mode for all duty cycles. 
It is natural to express the mode boundary in terms of the load resistance R, rather than the 
dimensionless parameter K. Equation (5.6) can be rearranged to directly expose the dependence of the 
mode boundary on the load resistance: 
R < R,,;,(D) 
for CCM 
(5.7) 
R > Rc,jD) 
for DCM 
where 
So the converter enters the discontinuous conduction mode when the load resistance R exceeds the criti-
cal value Rcrir This critical value depends on the inductance, the switching period, and the duty cycle. 
Note that, since D':::; 1, the minimum value of Rcrir is 2L!Ts. Therefore, if R < 2LIT,., then the converter 
will operate in the continuous conduction mode for all duty cycles. 
These results can be applied to loads that are not pure linear resistors. An effective load resis-
Fig. 5.6 
Comparison of K with Kcri,(D), for a larger 
value of K. Since K > l, the converter operates in CCM 
for all D. 
K> Kcrit: 
2 
CCM 
............................................... f!:..":. .. ~~:.~.~L .. 
D 

112 
The Discontinuous Conduction Mode 
TableS.l CCM-DCM mode boundaries for the buck, boost, and buck-boost converters 
Converter 
Kcrit(D) 
max (Kcrit) 
Rcrit(D) 
min (Rcrit) 
OSD~I 
O~D~I 
Buck 
(1-D) 
2L 
21,_ 
(1-D)T, 
T, 
Boost 
D(1-D)2 
4 
2L 
27 L 
27 
D(1-D)2 T, 
TT, 
Buck-boost 
(1- D)2 
2L 
21,_ 
(1-D)2 T, 
T, 
tance R is defined as the ratio of the de output voltage to the de load current: R = VII. This effective load 
resistance is then used in the above equations. 
A similar mode boundary analysis can be performed for other converters. The boost converter is 
analyzed in Section 5.3, while analysis of the buck-boost converter is left as a homework problem. The 
results are listed in Table 5.1, for the three basic de-de converters. In each case, the dimensionless 
parameter K is defined as K = 2L/RT8 , and the mode boundary is given by 
or 
R < Rc,;,(D) 
for CCM 
(5.8) 
or 
R > Rc,;,(D) for DCM 
5.2 
ANALYSIS OF THE CONVERSION RATIO M(D, K) 
With a few modifications, the same techniques and approximations developed in Chapter 2 for the 
steady-state analysis of the continuous conduction mode may be applied to the discontinuous conduction 
mode. 
(a) Inductor volt-second balance. The de component of the voltage applied to an inductor must be zero: 
(5.9) 
(b) Capacitor charge balance. The de component of current applied to a capacitor must be zero: 
• 
1 iTs. 
(tc) = T 
lc(t)dt = 0 
s 0 
(5.10) 
These principles must be true for any circuit that operates in steady state, regardless of the operating 
mode. 
(c) The linear ripple approximation. Care must be used when employing the linear ripple approximation in the 
discontinuous conduction mode. 
(i) 
Output capacitor voltage ripple. Regardless of the operating mode, it is required that the output volt-
age ripple be small. Hence, for a well-designed converter operating in the discontinuous conduction 
mode, the peak output voltage ripple ~v should be much smaller in magnitude than the output volt-
age de component V. So the linear ripple approximation applies to the output voltage waveform: 

5.2 Analysis of the Conversion Ratio M(D, K) 
113 
v(t) ~ V 
(5.11) 
(ii) 
Inductor current ripple. By definition, the inductor current ripple is not small in the discontinuous 
conduction mode. Indeed, Eq. (5.3) states that the inductor current ripple t1iL is greater in magnitude 
than the de component f. So neglecting the inductor current ripple leads to inaccurate results. In 
other converters, several inductor currents, or a capacitor voltage, may contain large switching ripple 
which should not be neglected. 
The equations necessary for solution of the voltage conversion ratio can be obtained by invoking volt-
second balance for each inductor voltage, and charge balance for each capacitor current, in the network. 
The switching ripple is ignored in the output capacitor voltage, but the inductor current switching ripple 
must be accounted for in this buck converter example. 
Let us analyze the conversion ratio M == V!Vg of the buck converter of Eq. (5.1). When the tran-
sistor conducts, for 0 < t < D1 T,, the converter circuit reduces to the network of Fig. 5.7(a). The inductor 
voltage and capacitor current are given by 
VL(t) = Vg- v(t) 
. ( ) 
. ( ) 
v(t) 
tct =tLt -R 
(5.12) 
By making the linear ripple approximation, to ignore the output capacitor voltage ripple, one obtains 
Fig. 5. 7 
Buck converter circuits for operation in 
the discontinuous conduction mode: (a) during 
subinterval 1, (b) during subinterval 2, (c) during 
subinterval 3. 
(a) 
(b) 
(c) 
c 
R 
c 
R 
c 
R 
+ 
v(t) 
+ 
v(t) 
+ 
v(t) 

114 
The Discontinuous Conduction Mode 
VL(t) ~ Vg- V 
ic(t) ~ i 1ft)-* 
Note that the inductor current ripple has not been ignored. 
(5.13) 
The diode conducts during subinterval 2, D1 Ts < t < (D1 + D2)T5 • The circuit then reduces to 
Fig. 5.7(b). The inductor voltage and capacitor current are given by 
(5.14) 
By neglecting the ripple in the output capacitor voltage, one obtains 
vL(t) ~- V 
ic(t) ~ iL(t)-* 
(5.15) 
The diode becomes reverse-biased at timet= (D1 + D2)T5 • The circuit is then as shown in Fig. 5.7(c), 
with both transistor and diode in the off state. The inductor voltage and inductor current are both zero for 
the remainder of the switching period (D1 + D 2)T5 < t < T5 • The network equations for the third subinter-
val are given by 
(5.16) 
Note that the inductor current is constant and equal to zero during the third subinterval, and therefore the 
inductor voltage must also be zero in accordance with the relationship vL(t) = LdiL(t)ldt. In practice, par-
asitic ringing is observed during this subinterval. This ringing occurs owing to the resonant circuit 
formed by the inductor and the semiconductor device capacitances, and typically has little influence on 
the converter steady-state properties. Again ignoring the output capacitor voltage ripple, one obtains 
vL(t) = 0 
ic(t) =-* 
(5.17) 
Equations (5.13), (5.15), and (5.17) can now be used to plot the inductor voltage waveform as in Fig. 5.8. 
According to the principle of inductor volt-second balance, the de component of this waveform must be 
zero. Since the waveform is rectangular, its de component (or average value) is easily evaluated: 
(5.18) 
Solution for the output voltage yields 
(5.19) 
The transistor duty cycleD (which coincides with the subinterval! duty cycle D1) is the control input to 
the converter, and can be considered known. But the subinterval 2 duty cycle D2 is unknown, and hence 

5.2 Analysis of the Conversion Ratio M(D, K) 
115 
Fig. 5.8 Inductor voltage waveform vL(t), buck 
converter operating in discontinuous conduction 
mode. 
-D1T8 ---D2T8 -:+D3Ts ... , 
1 o I 
-V 
another equation is needed to eliminate D2 and solve for the output voltage V. 
The second equation is obtained by use of capacitor charge balance. The connection of the 
capacitor to its adjacent components is detailed in Fig. 5.9. The node equation of this network is 
. ( ) 
. ( ) 
v(t) 
1L t =tc t +R 
By capacitor charge balance, the de component of capacitor current must be zero: 
(5.20) 
(5.21) 
Therefore, the de load current must be supplied entirely by the other elements connected to the node. In 
particular, for the case of the buck converter, the de component of inductor current must be equal to the 
de load current: 
· 
. 
(5.22) 
So we need to compute the de component of the inductor current. 
Since the inductor current ripple is not small, determination of the inductor current de compo-
nent requires that we examine the current waveform in detail. The inductor current waveform is sketched 
in Fig. 5.10. The current begins the switching period at zero, and increases during the first subinterval 
with a constant slope, given by the applied voltage divided by the inductance. The peak inductor current 
ipk is equal to the constant slope, multiplied by the length of the first subinterval: 
(5.23) 
The de component of the inductor current is again the average value: 
(5.24) 
v(t)IR 
ic(t) 
+ 
Fig. 5.9 Connection of the output capacitor to adjacent components. 
c 
R 
v(t) 

116 
The Discontinuous Conduction Mode 
Fig. 5.10 Inductor current waveform 
iL(t), buck converter operating in dis-
continuous conduction mode. 
( i L) = I 
0 
DT. 
T. 
!-D1T8 -j+-D2T8 -!+ D3T8 -.j 
The integral, or area under the iL(t) curve, is the area of the triangle having height ipk and base dimension 
(D1 + D2)T •. Use of the triangle area formula yields 
(5.25) 
Substitution of Eqs. (5.23) and (5.25) into Eq. (5.24) leads to 
(5.26) 
Finally, by equating this result to the de load current, according to Eq. (5.22), we obtain 
(5.27) 
Thus, we have two unknowns, V and D2, and we have two equations. The first equation, Eq. (5.19), was 
obtained by inductor volt-second balance, while the second equation, Eq. (5.27), was obtained using 
capacitor charge balance. Elimination of D2 from the two equations, and solution for the voltage conver-
sion ratio M(Dp K) = V/Vg, yields 
(5.28) 
where 
K=2URT8 
valid for 
K < Kcrit 
This is the solution of the buck converter operating in discontinuous conduction mode. 
The complete buck converter characteristics, including both continuous and discontinuous con-
duction modes, are therefore 

Fig. 5.11 
Voltage conversion ratio 
M(D, K), buck converter. 
M= 
l.O 
M(D,K) 
0.8 
0.6 
0.4 
0.2 
0.0 
0.0 
D 
2 
1 +v 1+ 4K 
Dz 
5.3 
Boost Converter Example 
117 
0.2 
0.4 
0.6 
0.8 
1.0 
D 
forK> Kcrit 
(5.29) 
forK< Kcrit 
where the transistor duty cycleD is identical to the subinterval 1 duty cycle D1 of the above derivation. 
These characteristics are plotted in Fig. 5.11, for several values of K. It can be seen that the effect of the 
discontinuous conduction mode is to cause the output voltage to increase. As K tends to zero (the 
unloaded case), M tends to unity for all nonzero D. The characteristics are continuous, and Eq. (5.28) 
intersects the CCM characteristic M = D at the mode boundary. 
5.3 
BOOST CONVERTER EXAMPLE 
As a second example, consider the boost converter of Fig. 5.12. Let's determine the boundary between 
modes, and solve for the conversion ratio in the discontinuous conduction mode. Behavior of the boost 
converter operating in the continuous conduction mode was analyzed previously, in Section 2.3, and 
expressions for the inductor current de component I and ripple peak magnitude /::;,iL were found. 
When the diode conducts, its current is identical to the inductor current iL(t). As can be seen 
from Fig. 2.18, the minimum value of the inductor current during the diode conduction subinterval 
DTs < t < T5 is (I- /::;.iL). If this minimum current is positive, then the diode is forward-biased for the 
entire subinterval DTs < t < Ts, and the converter operates in the continuous conduction mode. So the 
conditions for operation of the boost converter in the continuous and discontinuous conduction modes 
are: 

118 
The Discontinuous Conduction Mode 
Fig. 5.12 
Boost converter example. 
I> t1iL for CCM 
I< t1iL for DCM 
R 
+ 
v(t) 
(5.30) 
which is identical to ihe results for the buck converter. Substitution of the CCM solutions for I and l::.iu 
Eqs. (2-39) and (2-43), yields 
(5.31) 
This equation can be rearranged to obtain 
.2L.. > DD'2 
for CCM 
RTS 
(5.32) 
which is in the standard form 
K>Kc,;,(D) 
forCCM 
(5.33) 
K < Kc,;,(D) 
for DCM 
0.15 
··············· Kcri,(t) = 2~ 
0.1 
Fig. 5.13 
Boost converter Kcrit(D) vs. D. 
0.05 
0 
0 
0.2 
0.4 
0.6 
0.8 
D 

0.15 
:::E 
u 
u 
5.3 Boost Converter Example 
119 
CCM 
0.1 
.......................................................... ! ........................ !f ......... . 
Fig. 5.14 Comparison of K with KcriJD). 
0.05 
0 
0 
where 
K=.lL_ 
RT, 
and 
0.2 
0.4 
D 
Kc,JD) = DD'2 
'j 
.: i ! 
0.6 
0.8 
The conditions for operation in the continuous or discontinuous conduction modes are of similar form to 
those for the buck converter; however, the critical value Kcrir(D) is a. different function of the duty cycle 
D. The dependence of Kcri/D) on the duty cycleD is plotted in Fig. 5.13. Kcrit(D) is zero at D = 0 and at 
D = 1, and has a maximum value of 4/27 at D = 113. Hence, if K is greater than 4/27, then the converter 
operates in the continuous conduction mode for all D. Figure 5.14 illustrates what happens when K is 
less than 4/27. The converter then operates in the discontinuous conduction mode for some intermediate 
range of values of D near D = 113. But the converter operates in the continuous conduction mode near 
D = 0 and D = 1. Unlike the buck converter, the boost converter must operate in the continuous conduc-
tion mode near D = 0 because the ripple magnitude approaches zer() while the de component I does not. 
Next, let us analyze the conversion ratio M = V/Vg of the boost converter. When the transistor 
conducts, for the subinterval 0 < t < D1 Ts, the converter circuit reduces to the circuit of 5.15(a). The 
inductor voltage and capacitor current are given by 
VL(t) = Vg 
. (t) _ _ v(t) 
tc 
-
R 
Use of the linear ripple approximation, to ignore the output capacitor voltage ripple, leads to 
VL(t) "' Vg 
ic(t) "'-* 
(5.34) 
(5.35) 
During the second subinterval D1T, < t < (D1 + D2)Ts, the diode conducts. The circuit then reduces to 

120 
The Discontinuous Conduction Mode 
Fig. 
5.15 Boost converter circuits: (a) during 
subinterval!, 0 < t < D1 T,, (b) during subinterval2, 
D1 T8 < t < (D1 + D2)T8 , (c) during subinterval 3, 
(D1 + D2)T8 < t < T8 • 
Vg 
i(t) 
L 
i(t) 
L 
i(t) 
L 
Fig. 5.15(b). The inductor voltage and capacitor current are given by 
VL(t) = V8- v(t) 
ic(t) = i(t)- v~) 
Neglect of the output capacitor voltage ripple yields 
vL(t)"' V8 - V 
ic(t) "' i(t)-* 
The inductor current ripple has not been neglected. 
+ 
c 
R 
v(t) 
+ 
c 
R 
v(t) 
icf...t) 
+ 
c 
R 
v(t) 
(5.36) 
(5.37) 
During the third subinterval, (D1 + D2)Ts < t < r •. both transistor and diode are in the off state, 
and Fig. 5.15(c) is obtained. The network equations are: 
VL=O, i=O 
ic(t) =- v~) 
Use of the small-ripple approximation yields 
(5.38) 

5.3 
Boost Converter Example 
121 
Fig. 5.16 
Inductor voltage waveform vL(t), boost 
converter operating in discontinuous conduction 
mode. 
vL(t) = 0 
ic(t) =-* 
+--D!Ts --++-D2Ts-+t+D3Ts+1 
i 
0 
(5.39) 
Equations (5.35), (5.37), and (5.39) are now used to sketch the inductor voltage waveform as in Fig. 
5.16. By volt-second balance, this waveform must have zero de component when the converter operates 
in steady state. By equating the average value of this vL(t) waveform to zero, one obtains 
(5.40) 
Solution for the output voltage Vyields 
(5.41) 
The diode duty cycle D2 is again an unknown, and so a second equation is needed for elimination of D2 
before the output voltage V can be found. 
We can again use capacitor charge balance to obtain the second equation. The connection of the 
output capacitor to its adjacent components is detailed in Fig. 5.17. Unlike the buck converter, the diode 
in the boost converter is connected to the output node. The node equation of Fig. 5.17 is 
(5.42) 
where in(t) is the diode current. By capacitor charge balance, the capacitor current ic(t) must have zero 
de component in steady state. Therefore, the diode current de component (in) must be equal to the de 
component of the load current: 
So we need to sketch the diode current waveform, and find its de component. 
Fig. 5.17 
Connection of the output capacitor to adjacent components 
in the boost converter. 
c 
R 
(5.43) 
+ 
v(t) 

122 
The Discontinuous Conduction Mode 
Fig. 5.18 
Boost converter waveforms 
in the discontinuous conduction mode: 
(a) inductor current i(t), (b) diode current 
(a) 
io(t). 
(b) 
i(t) 
0 
DT, 
T, 
j-D 1 T, --+j+- D2T, -+j+ D3T, ... j 
( iD) .............................................. ··············································· 
0 
D~ 
~ 
j--D1 T, -....j+- D2T, -+-j+ D3T, ..... j 
The waveforms of the inductor current i(t) and diode current iv(t) are illustrated in Fig. 5.18. 
The inductor current begins at zero, and rises to a peak value ipk during the first subinterval. This peak 
value ipk is equal to the slope V/L, multiplied by the length of the first subinterval, D 1 T,: 
(5.44) 
The diode conducts during the second subinterval, and the inductor current then decreases to zero, where 
it remains during the third subinterval. The diode current iv(t) is identical to the inductor current i(t) dur-
ing the second subinterval. During the first and third subintervals, the diode is reverse-biased and hence 
iv(t) is zero. 
The de component of the diode current, ( iv), is: 
. 
1 iTs. 
(z 0 ) =-
t0 (t)dt 
T, o 
(5.45) 
The integral is the area underthe iv(t) waveform. As illustrated in Fig. 5.18(b), this area is the area of the 
triangle having peak value ipk and base dimension D2T,: 
(5.46) 
Substitution ofEqs. (5.44) and (5.46) into Eq. (5.45) leads to the following expression for the de compo-
nent of the diode current: 

5.3 
Boost Converter Example 
123 
By equating this expression to the de load current as in Eq. (5.43), one obtains the final result 
VgD 1D2T, 
V 
2L 
=R 
(5.48) 
So now we have two unknowns, Vand D2 . We have two equations: Eq. (5.41) obtained via inductor volt-
second balance, and Eq. (5.48) obtained using capacitor charge balance. Let us now eliminate D2 from 
this system of equations, and solve for the output voltage V. Solution of Eq. (5.41) for D2 yields 
(5.49) 
By inserting this result into Eq. (5.48), and rearranging terms, one obtains the following quadratic equa-
tion: 
(5.50) 
Use of the quadratic formula yields 
1 +V 1 
4D~ 
V 
-
+ K 
vg = 
2 
(5.51) 
The quadratic equation has two roots: one of the roots of Eq. (5.51) is positive, while the other is nega-
tive. We already know that the output voltage of the boost converter should be positive, and indeed, from 
Eq. (5.41), it can be seen that V!V8 must be positive since the duty cycles D1 and D2 are positive. So we 
should select the positive root: 
(5.52) 
where 
K = 2LIRT, 
valid for 
K < Kcrh(D) 
This is the solution of the boost converter operating in the discontinuous conduction mode. 
The complete boost converter characteristics, including both continuous and discontinuous con-
duction modes, are 
_1_ 
forK> Kcr;t 
1-D 
M= 
1 + J 
1 + 4~2 
(5.53) 
forK< Kc,;t 
2 

124 
The Discontinuous Conduction Mode 
Fig. 5.19 
Voltage conversion ratio M(D, 
K) of the boost converter, including both 
continuous and discontinuous conduction 
modes 
M(D,K) 
5 
4 
3 
2 
0 
0 
0.25 
0.5 
0.75 
D 
These characteristics are plotted in Fig. 5.19, for several values of K. As in the buck converter, the effect 
of the discontinuous conduction mode is to cause the output voltage to increase. The DCM portions of 
the characteristics are nearly linear, and can be approximated as 
(5.54) 
5.4 
SUMMARY OF RESULTS AND KEY POINTS 
The characteristics of the basic buck, boost, and buck-boost are summarized in Table 5.2. Expressions 
for KcriD), as well as for the solutions of the de conversion ratios in CCM and DCM, and for the DCM 
diode conduction duty cycle D2, are given. 
The de conversion ratios of the DCM buck, boost, and buck-boost converters are compared in 
Table 5.2 
Summary of CCM-DCM characteristics for the buck, boost, and buck-boost converters 
Converter 
Kcri/D) 
DCMM(D,K) 
DCMD2(D, K) 
CCMM(D) 
Buck 
(1-D) 
2 
K 
D 
1 + V1 +4K/D 2 
DM(D, K) 
Boost 
D(1- D)2 
1 + JI +4D 2/K 
K 
1 
2 
DM(D,K) 
1-D 
Buck--boost 
(1- D)2 
D 
IK 
D 
-IK 
-1-D 
with 
K= 2LIRT,, 
DCM occurs for K < Kcrit. 

Fig. 
5.20 Comparison of de conversion 
ratios of the buck-boost, buck, and boost 
converters operated in the discontinuous 
conduction mode. 
DCM 
M(D,K) 
0 
0 
5.4 Summary of Results and Key Points 
125 
0.2 
0.4 
0.6 
0.8 
D 
Fig. 5.20. The buck-boost characteristic is a line with slope 1/ JK. The characteristics of the buck and 
the boost converters are both asymptotic to this line, as well as to the line M = 1. Hence, when operated 
deeply into the discontinuous conduction mode, the boost converter characteristic becomes nearly linear 
with slope 11 JK, especially at high duty cycle. Likewise, the buck converter characteristic becomes 
nearly linear with the same slope, when operated deeply into discontinuous conduction mode at low duty 
cycle. 
The following are the key points of this chapter: 
1. 
The discontinuous conduction mode occurs in converters containing current- or voltage-unidirectional 
switches, when the inductor current or capacitor voltage ripple is large enough to cause the switch current 
or voltage to reverse polarity. 
2. 
Conditions for operation in the discontinuous conduction mode can be found by determining when the 
inductor current or capacitor voltage ripples and de components cause the switch on state current or off 
state voltage to reverse polarity. 
3. 
The de conversion ratio M of converters operating in the discontinuous conduction mode can be found by 
application of the principles of inductor volt-second and capacitor charge balance. 
4. 
Extra care is required when applying the small-ripple approximation. Some waveforms, such as the outpui 
voltage, should have small ripple which can be neglected. Other waveforms, such as one or more inductor 
currents, may have large ripple that cannot be ignored. 
5. 
The characteristics of a converter changes significantly when the converter enters DCM. The output volt-
age becomes load-dependent, resulting in an increase in the converter output impedance. 

126 
The Discontinuous Conduction Mode 
PROBLEMS 
5.1 
The elements of the buck-boost converter of Fig. 5.21 are ideal: all losses may be ignored. Your results 
for parts (a) and (b) should agree with Table 5.2. 
+ 
R 
v 
Fig. 5.21 
Buck-boost converter of Problems 5.1 and 5.13. 
(a) 
Show that the converter operates in discontinuous conduction mode when K < Kcrit' and derive 
expressions for K and Kcru· 
(b) 
Derive an expression for the de conversion ratio V/V8 of the buck-boost converter operating in 
discontinuous conduction mode. 
(c) 
ForK= 0.1, plot VIV8 over the entire range 0 ~ D $ 1. 
(d) 
Sketch the inductor voltage and current waveforms forK= 0.1 and D = 0.3. Label salient fea-
tures. 
(e) 
What happens to Vat no load (R-+ =)?Explain why, physically. 
5.2 
A certain buck converter contains a synchronous rectifier, as described in Section 4.1.5. 
(a) 
Does this converter operate in the discontinuous conduction mode at light load? Explain. 
(b) 
The load resistance is disconnected (R-+ =),and the converter is operated with duty cycle 0.5. 
Sketch the inductor current waveform. 
5.3 
An unregulated de input voltage V8 varies over the range 35 V $ V8 $ 70 V. A buck converter reduces this 
voltage to 28 V; a feedback loop varies the duty cycle as necessary such that the converter output voltage 
is always equal to 28 V. The load power varies over the range 10 W $ P1oad ~ 1000 W. The element values 
are: 
5.4 
L= 22 fLH 
Losses may be ignored. 
C=470 fLF 
fs =75kHz 
(a) 
Over what range of V8 and load current does the converter operate in CCM? 
(b) 
Determine the maximum and minimum values of the steady-state transistor duty cycle. 
The transistors in the converter of 
Fig. 5.22 are driven by the same 
gate drive signal, so that they turn 
on and off in synchronism with 
duty cycle D. 
(a) 
Determine the conditions 
under which this con-
verter operates in the dis-
continuous 
conduction 
mode, as a function of the 
steady-state duty ratio D 
R 
Fig. 5.22 
Watkins-Johnson converter of Problem 5.4. 
+ 
v 

Problems 
127 
and the dimensionless parameter K = 2L/RTs. 
(b) 
What happens to your answer to Part (a) forD< 0.5? 
(c) 
Derive an expression for the de conversion ratio M(D, K). Sketch M vs. D forK= 10 and for 
K = 0.1, over the range 0:::; D:::; 1. 
5.5 
DCM mode boundary analysis of the Cuk converter of Fig. 5.23. The capacitor voltage ripples are small. 
+ 
R 
v 
Fig. 5.23 
Cuk converter, Problems 5.5, 5.6, 5.11, and 5.12 
(a) 
Sketch the diode current waveform for CCM operation. Find its peak value, in terms of the rip-
ple magnitudes /';.iLl, /';.iL2' and the de components !1 and !2, of the two inductor currents iLl(t) 
and iL2(t), respectively. 
(b) 
Derive an expression for the conditions under which the Cuk converter operates in the discontin-
uous conduction mode. Express your result in the form K < Kcrit(D), and give formulas forK and 
Kcrit(D). 
5.6 
DCM conversion ratio analysis of the Cuk converter of Fig. 5.23. 
(a) 
Suppose that the converter operates at the boundary between CCM and DCM, with the follow-
ing element and parameter values: 
D=0.4 
vg = 12ov 
L1 =54 J.!H 
fs= 100kHz 
R= 10Q 
L2 = 27 J.!H 
C1 = 47 J.!F 
C2 = 100 J.!F 
Sketch the diode current waveform i0 (t), and the inductor current waveforms i 1(t) and iit). 
Label the magnitudes of the ripples and de components of these waveforms. 
(b) 
Suppose next that the converter operates in the discontinuous conduction mode, with a different 
choice of parameter and element values. Derive an analytical expression for the de conversion 
ratio M(D, K). 
(c) 
Sketch the diode current waveform i0 (t), and the inductor current waveforms i 1(t) and iit), for 
operation in the discontinuous conduction mode. 
5.7 
DCM mode boundary analysis of the SEPIC of Fig. 5.24 
(a) 
Sketch the diode current waveform for CCM operation. Find its peak value, in terms of the rip-
ple magnitudes /';.iLl, /';.iLz• and the de components ! 1 and ! 2, of the two inductor currents iLl(t) 
and iL2(t), respectively. 
(b) 
Derive an expression for the conditions under which the SEPIC operates in the discontinuous 
conduction mode. Express your result in the form K < KcriJD), and give formulas for K and 
KcriJD). 
5.8 
DCM conversion ratio analysis of the SEPIC of Fig. 5.24. 
(a) 
Suppose that the converter operates at the boundary between CCM and DCM, with the follow-

128 
The Discontinuous Conduction Mode 
+ 
R 
v 
Fig. 5.24 
SEPIC, Problems 5.7 and 5.8. 
ing element and parameter values: 
D = 0.225 
f, =100kHz 
V8 = 120V 
R= 100 
L1 = 50 f.!H 
L2 = 75 f.!H 
C1 = 47 f.!F 
C2 = 200 f.!F 
Sketch the diode current waveform i0 (t), and the inductor current waveforms i1 (t) and i2(t). 
Label the magnitudes of the ripples and de components of these waveforms. 
(b) 
Suppose next that the converter operates in the discontinuous conduction mode, with a different 
choice of parameter and element values. Derive an analytical expression for the de conversion 
ratio M(D, K). 
(c) 
Sketch the diode current waveform i0 (t), and the inductor current waveforms i1(t) and i2(t), for 
operation in the discontinuous conduction mode. 
5.9 
An L-C input filter is added to a buck converter as illustrated in Fig. 5.25. Inductors L1 and L2 and capac-
itor C2 are large in value, such that their switching ripples are small. All losses can be neglected. 
+ 
R 
Fig. 5.25 
Buck converter with input filter, Problems 5.9 and 5.10. 
(a) 
Sketch the capacitor C1 voltage waveform v1 (t), and derive expressions for its de component V1 
and peak ripple magnitude ~v 1
. 
(b) 
The load current is increased (R is decreased in value) such that ~v 1 is greater than V1. 
(i) 
Sketch the capacitor voltage waveform v 1 (t). 
(ii) 
For each subinterval, determine which semiconductor devices conduct. 
(iii) 
Determine the conditions under which the discontinuous conduction mode occurs. 
Express your result in the form K < Kcri,(D), and give formulas forK and Kcrir(D). 
5.10 
Derive an expression for the conversion ratio M(D, K) of the DCM converter described in the previous 
problem. Note: D is the transistor duty cycle. 
5.11 
In the Cuk converter of Fig. 5.23, inductors L1 and L2 and capacitor C2 are large in value, such that their 
switching ripples are small. All losses can be neglected. 

Problems 
129 
(a) 
Assuming that the converter operates in CCM, sketch the capacitor C1 voltage waveform vCl(t), 
and derive expressions for its de component V1 and peak ripple magnitude Avc1• 
(b) 
The load current is increased (R is decreased in value) such that Avc1 is greater than V1• 
(i) 
Sketch the capacitor voltage waveform v Cl (t). 
(ii) 
For each subinterval, determine which semiconductor devices conduct. 
(iii) 
Determine the conditions under which the discontinuous conduction mode occurs. 
Express your result in the form K < Kcri,(D), and give formulas for K and Kc,1,(D). 
5.12 
Derive an expression for the conversion ratio M(D, K) of the DCM Cuk converter described in the previ-
ous problem. Note: Dis the transistor duty cycle. 
5.13 
A DCM buck-boost converter as in Fig. 5.21 is to be designed to operate under the following conditions: 
136 v s V8 s 204 v 
5 W S Pload S 100 W 
V=-150V 
fs= 100kHz 
You may assume that a feedback loop will vary to transistor duty cycle as necessary to maintain a con-
stant output voltage of- 150 V. 
Design the converter, subject to the following considerations: 
The converter should operate in the discontinuous conduction mode at all times 
Given the above requirements, choose the element values to minimize the peak inductor current 
The output voltage peak ripple should be less than 1 V. 
Specify: 
(a) 
The inductor value L 
(b) 
The output capacitor value C 
(c) 
The worst-case peak inductor current ipk 
(d) 
The maximum and minimum values of the transistor duty cycleD 
5.14 
A DCM boost converter as in Fig. 5.12 is to be designed to operate under the following conditions: 
18 v s V8 s 36 v 
5WsP1aads 100W 
V=48V 
fs =150kHz 
You may assume that a feedback loop will vary to transistor duty cycle as necessary to maintain a con-
stant output voltage of 48 V. 
Design the converter, subject to the following considerations: 
The converter should operate in the discontinuous conduction mode at all times. To ensure an 
adequate design margin, the inductance L should be chosen such that K is no greater than 75% of 
Kcrit at all operating points. 
Given the above requirements, choose the element values to minimize the peak inductor current. 
The output voltage peak ripple should be less than 1 V. 
Specify: 
(a) 
The inductor value L 
(b) 
The output capacitor value C 
(c) 
The worst-case peak inductor current ipk 

130 
The Discontinuous Conduction Mode 
(d) 
The maximum and minimum values of the transistor duty cycle D. 
(e) 
The values of D, K and Kcrit at the following operating points: (i) Vg = I8 V and P1oad = 5 W; (ii) 
Vg = 36 V and P10aa = 5 W; (iii) Vg = I8 V and P1oad = IOO W; (iv) Vg = 36 V and P1oaa = IOO W. 
5.15 
In de-de converters used in battery-powered portable equipment, it is sometimes required that the con-
verter continue to regulate its load voltage with high efficiency while the load is in a low-power "sleep" 
mode. The power required by the transistor gate drive circuitry, as well as much of the switching loss, is 
dependent on the switching frequency but not on the load current. So to obtain high efficiency at very 
low load powers, a variable-frequency control scheme is used, in which the switching frequency is 
reduced in proportion to the load current. 
Consider the boost converter system of Fig. 5.26(a). The battery pack consists of two nickel-cad-
mium cells, which produce a voltage of Vg = 2.4 V ± 0.4 V. The converter boosts this voltage to a regu-
lated 5 V. As illustrated in Fig. 5.26(b), the converter operates in the discontinuous conduction mode, 
with constant transistor on-time t011 • The transistor off-time t0ffis varied by the controller to regulate the 
output voltage. 
(a) 
r···············,.... 
... _ ... .;...i _ 
___,£ 
[load[ ....................... ! 
+I 
L 
c 
Fig. 
5.26 Boost con-
verter employed in portable 
battery-powered equipment 
with sleep mode, Problem 
5.I5: (a) converter circuit, 
(b) inductor current wave-
form. 
R 
~)I 
..................... -........ , ------~----'--+L.-... --~ 
.................. ] 
Battery pack 
(b) i(t) 
Effective load 
(a) 
Write the equations for the CCM-DCM boundary and conversion ratio M = V/Vg, in terms of ton' 
t0ff' L, and the effective load resistance R. 
For parts (b) and (c), the load current can vary between I 00 p,A and I A. The transistor on time is fixed: 
( 0n = 10 p,s. 
(b) 
Select values for L and C such that: 
The output voltage peak ripple is no greater than 50 m V, 
The converter always operates in DCM, and 
The peak inductor current is as small as possible. 
(c) 
For your design of part (b), what are the maximum and minimum values of the switching fre-
quency? 

6 
Converter Circuits 
We have already analyzed the operation of a number of different types of converters: buck, boost, 
buck-boost, Cuk, voltage-source inverter, etc. With these converters, a number of different functions can 
be performed: step-down of voltage, step-up, inversion of polarity, and conversion of de to ac or vice-
versa. 
It is natural to ask, Where do these converters come from? What other converters occur, and 
what other functions can be obtained? What are the basic relations between converters? In this chapter, 
several different circuit manipulations are explored, which explain the origins of the basic converters. 
Inversion of source and load transforms the buck converter into the boost converter. Ca~cade connection 
of converters, and simplification of the resulting circuit, shows how the buck-boost and Cuk converters 
are based on the buck and the boost converters. Differential connection of the load between the outputs 
of two or more converters leads to a single-phase or polyphase inverter. A short list of some of the better 
known converter circuits follows this discussion. 
Transformer-isolated de-de converters are also covered in this chapter. Use of a transformer 
allows isolation and multiple outputs to be obtained in a de-de converter, and can lead to better converter 
optimization when a very large or very small conversion ratio is required. The transformer is modeled as 
a magnetizing inductance in parallel with an ideal transformer; this allows the analysis techniques of the 
previous chapters to be extended to cover converters containing transformers. A number of well-known 
isolated converters, based on the buck, boost, buck-boost, single-ended primary inductance converter 
(SEPIC), and Cuk, are listed and discussed. 
Finally, the evaluation, selection, and design of converters to meet given requirements are con-
sidered. Important performance-related attributes of transformer-isolated converters include: whether the 
transformer reset process imposes excessive voltage stress on the transistors, whether the converter can 
supply a high-current output without imposing excessive current stresses on the secondary-side compo-
nents, and whether the converter can be well-optimized to operate with a wide range of operating points, 

132 
Converter Circuits 
L 
+ 
Fig. 6.1 
The basic buck converter. 
2 
c 
R 
v 
that is, with large tolerances in V8 and P1oad' Switch utilization is a simplified figure-of-merit that mea-
sures the ratio of the converter output power to the total transistor voltage and current stress. As the 
switch utilization increases, the converter efficiency increases while its cost decreases. Isolated convert-
ers with large variations in operating point tend to utilize their power devices more poorly than noniso-
lated converters which function at a single operating point. Computer spreadsheets are a good tool for 
optimization of power stage designs and for trade studies to select a converter topology for a given appli-
cation. 
6.1 
CIRCUIT MANIPULATIONS 
The buck converter (Fig. 6.1) was developed in Chapter 1 using basic principles. The switch reduces the 
voltage de component, and the low-pass filter removes the switching harmonics. In the continuous con-
duction mode, the buck converter has a conversion ratio of M =D. The buck converter is the simplest and 
most basic circuit, from which we will derive other converters. 
6.1.1 
Inversion of Source and Load 
Let us consider first what happens when we interchange the power input and power output ports of a con-
verter. In the buck converter of Fig. 6.2(a), voltage V1 is applied at port 1, and voltage V2 appears at port 
2. We know that 
(6.1) 
This equation can be derived using the principle of inductor volt-second balance, with the assumption 
that the converter operates in the continuous conduction mode. Provided that the switch is realized such 
that this assumption holds, then Eq. (6.1) is true regardless of the direction of power flow. 
So let us interchange the power source and load, as in Fig. 6.2(b). The load, bypassed by the 
capacitor, is connected to converter port 1, while the power source is connected to converter port 2. 
Power now flows in the opposite direction through the converter. Equation (6.1) must still hold; by solv-
ing for the load voltage V1, one obtains 
(6.2) 
So the load voltage is greater than the source voltage. Figure 6.2(b) is a boost converter, drawn back-
wards. Equation 6.2 nearly coincides with the familiar boost converter result, M(D) = liD', except that D' 
is replaced by D. 
Since power flows in the opposite direction, the standard buck converter unidirectional switch 

6.1 
Circuit Manipulations 
133 
(a) 
Port 1 
Port2 
L 
+ 
+ 
2 
~ 
Power flow 
(b) 
Port 1 
Port2 
L 
Fig. 6.2 Inversion of source and 
load transforms a buck converter 
+ 
into a boost converter: (a) buck con-
VI 
verter, (b) inversion of source and 
load, (c) realization of switch. 
IIIII 
Power flow 
(c) 
Port 1 
Port2 
L 
Power flow 
realization cannot be used with the circuit of Fig. 6.2(b). By following the discussion of Chapter 4, one 
finds that the switch can be realized by connecting a transistor between the inductor and ground, and a 
diode from the inductor to the load, as shown in Fig. 6.2(c). In consequence, the transistor duty cycleD 
becomes the fraction of time which the single-pole double-throw (SPDT) switch of Fig. 6.2(b) spends in 
position 2, rather than in position 1. So we should interchangeD with its complement D' in Eq. (6.2), and 
the conversion ratio of the converter of Fig. 6.2( c) is 
(6.3) 
Thus, the boost converter can be viewed as a buck converter having the source and load connections 
exchanged, and in which the switch is realized in a manner that allows reversal of the direction of power 
flow. 

134 
Converter Circuits 
Converter 1 
+ 
Converter 2 
+ 
vg 
vl 
v 
VI-M (D) 
~=MiD) 
V-
I 
VI 
g 
D 
Fig. 6.3 
Cascade connection of converters. 
6.1.2 
Cascade Connection of Converters 
Converters can also be connected in cascade, as illustrated in Fig. 6.3 [1,2]. Converter 1 has conversion 
ratio M1(D), such that its output voltage V1 is 
(6.4) 
This voltage is applied to the input of the second converter. Let us assume that converter 2 is driven with 
the same duty cycle D applied to converter 1. If converter 2 has conversion ratio M2(D), then the output 
voltage Vis 
(6.5) 
Substitution of Eq. (6.4) into Eq. (6.5) yields 
v 
V = M(D) = M I (D)M 2(D) 
g 
(6.6) 
Hence, the conversion ratio M(D) of the composite converter is the product of the individual conversion 
ratios M 1(D) and MiD). 
Let us consider the case where converter 1 is a buck converter, and converter 2 is a boost con-
verter. The resulting circuit is illustrated in Fig. 6.4. The buck converter has conversion ratio 
The boost converter has conversion ratio 
So the composite conversion ratio is 
j'_=_l_ 
VI 
1-D 
(6.7) 
(6.8) 

6.1 
Circuit Manipulations 
135 
2 
+ 
+ 
2 
R 
v 
Buck converter 
Boost converter 
Fig. 6.4 Cascade connection of buck converter and boost converter. 
2 
+ 
2 
R 
v 
+ 
v 
Fig. 6.5 Simplification of the cascaded buck and boost converter circuit of Fig. 6.4: (a) removal of capacitor Cl' 
(b) combining of inductors L1 and L2. 
(6.9) 
The composite converter has a noninverting buck-boost conversion ratio. The voltage is reduced when 
D < 0.5, and increased when D > 0.5. 
The circuit of Fig. 6.4 can be simplified considerably. Note that inductors L1 and L2, along with 
capacitor Cl' form a three-pole low-pass filter. The conversion ratio does not depend on the number of 
poles present in the low-pass filter, and so the same steady-state output voltage should be obtained when 
a simpler low-pass filter is used. In Fig. 6.5(a), capacitor C1 is removed. Inductors L1 and L2 are now in 
series, and can be combined into a single inductor as shown in Fig. 6.5(b). This converter, the noninvert-
ing buck-boost converter, continues to exhibit the conversion ratio given in Eq. (6.9). 
The switches of the converter of Fig. 6.5(b) can also be simplified, leading to a negative output 
voltage. When the switches are in position 1, the converter reduces to Fig. 6.6(a). The inductor is con-
nected to the input source V8 , and energy is transferred from the source to the inductor. When the 

136 
Converter Circuits 
(a) 
+ 
(b) 
+ 
v 
v 
Fig. 6.6 
Connections of the circuit of Fig. 6.5(b): (a) while the switches are in position 1, (b) while the switches 
are in position 2. 
(a) 
+ 
(b) 
+ 
v 
v 
Fig. 6.7 
Reversal of the output voltage polarity, by reversing the inductor connections while the switches are in 
position 2: (a) connections with the switches in position 1, (b) connections with the switches in position 2. 
switches are in position 2, the converter reduces to Fig. 6.6(b). The inductor is then connected to the· 
load, and energy is transferred from the inductor to the load. To obtain a negative output, we can simply 
reverse the polarity of the inductor during one of the subintervals (say, while the switches are in position 
2). The individual circuits of Fig. 6.7 are then obtained, and the conversion ratio becomes 
V _ 
D 
vg -- 1-D 
(6.10) 
Note that one side of the inductor is now always connected to ground, while the other side is switched 
between the input source and the load. Hence only one SPDT switch is needed, and the converter circuit 
of Fig. 6.8 is obtained. Figure 6.8 is recognized as the conventional buck-boost converter. 
Thus, the buck-boost converter can be viewed as a cascade connection of buck and boost con-
verters. The properties of the buck-boost converter are consistent with this viewpoint. Indeed, the equiv-
alent circuit model of the buck-boost converter contains a 1 :D (buck) de transformer, followed by aD': 1 
(boost) de transformer. The buck-boost converter inherits the pulsating input current of the buck con-
verter, and the pulsating output current of the boost converter. 
Other converters can be derived by cascade connections. The Cuk converter (Fig. 2.20) was 
originally derived [1,2] by cascading a boost converter (converter 1), followed by a buck (converter 2). A 
negative output voltage is obtained by reversing the polarity of the internal capacitor connection during 
one of the subintervals; as in the buck-boost converter, this operation has the additional benefit of reduc-
ing the number of switches. The equivalent circuit model of the Cuk converter contains a D':l (boost) 
Fig. 
6.8 
Converter circuit obtained from the 
subcircuits of Fig. 6.7. 
2 
+ 
v 

6.1 
Circuit Manipulations 
137 
ideal de transformer, followed by a l:D (buck) ideal de transformer. The Cuk converter inherits the non-
pulsating input current property of the boost converter, and the non pulsating output current property of 
the buck converter. 
6.1.3 
Rotation of Three-Terminal Cell 
The buck, boost, and buck-boost converters each contain an inductor that is connected to a SPDT switch. 
As illustrated in Fig. 6.9(a), the inductor-switch network can be viewed as a basic cell having the three 
terminals labeled a, b, and c. It was first pointed out in [1,2], and later in [3], that there are three distinct 
ways to connect this cell between the source and load. The connections a-A b-B c-C lead to the buck 
converter. The connections a-C b-A c-B amount to inversion of the source and load, and lead to the 
boost converter. The connections a-A b-C c-B lead to the buck-boost converter. So the buck, boost, and 
buck-boost converters could be viewed as being based on the same inductor-switch cell, with different 
source and load connections. 
A dual three-terminal network, consisting of a capacitor-switch cell, is illustrated in Fig. 6.9(b ). 
Filter inductors are connected in series with the source and load, such that the converter input and output 
currents are nonpulsating. There are again three possible ways to connect this cell between the source 
and load. The connections a-A b-B c-C lead to a buck converter with L-C input low-pass filter. The con-
nections a-B b-A c-C coincide with inversion of source and load, and lead to a boost converter with an 
added output L-C filter section. The connections a-A b-C c-B lead to the Cuk converter. 
Rotation of more complicated three-terminal cells is explored in [4]. 
(a) 
+ 
v 
(b) 
+ 
v 
Fig. 6.9 
Rotation of three-terminal switch cells: (a) switch/inductor cell, (b) switch/capacitor cell. 

138 
Converter Circuits 
Fig. 6.10 
Obtaining a bipolar output by differential connection of load. 
6.1.4 
Differential Connection of the Load 
In inverter applications, where an ac output is required, a converter is needed that is capable of producing 
an output voltage of either polarity. By variation of the duty cycle in the correct manner, a sinusoidal out-
put voltage having no de bias can then be obtained. Of the converters studied so far in this chapter, the 
buck and the boost can produce only a positive unipolar output voltage, while the buck-boost and Cuk 
converter produce only a negative unipolar output voltage. How can we derive converters that can pro-
duce bipolar output voltages? 
A well-known technique for obtaining a bipolar output is the differential connection of the load 
across the outputs of two known converters, as illustrated in Fig. 6.1 0. If converter 1 produces voltage V1, 
and converter 2 produces voltage V2, then the load voltage Vis given by 
(6.11) 
Although V1 and V2 may both individually be positive, the load voltage V can be either positive or nega-
tive. Typically, if converter 1 is driven with duty cycleD, then converter 2 is driven with its complement, 
D', so that when V1 increases, V2 decreases, and vice versa. 
Several well-known inverter circuits can be derived using the differential connection. Let's real-
ize converters 1 and 2 of Fig. 6.10 using buck converters. Figure 6.11(a) is obtained. Converter 1 is 
driven with duty cycleD, while converter 2 is driven with duty cycleD'. So when the SPDT switch of 
converter 1 is in the upper position, then the SPDT switch of converter 2 is in the lower position, and 
vice-versa. Converter 1 then produces output voltage V1 = DV8 , while converter 2 produces output volt-

6.1 
Circuit Manipulations 
139 
(a) 
Buck converter 1 
+ 
2 
VI 
+ 
v 
vg 
. 
2 
. 
+ 
Vz 
-
Buck converter 2 
. 
(b) 
l 
+ 
v 
-
vg 
2 
-
1 
Fig. 6.11 
Derivation of bridge inverter (H-bridge ): (a) differential connection of load across outputs of buck con-
verters, (b) bypassing load by capacitor, (c) combining series inductors, (d) circuit (c) redrawn in its usual form. 

140 
Converter Circuits 
(c) 
l 
+ 
-
v 
. 
vg 
2 
-. 
l 
. 
(d) 
2 
vg 
Fig. 6.11 
Continued 
Fig. 6.12 
Conversion ratio of the H-bridge inverter circuit. 

6.1 
Circuit Manipulations 
141 
age V2 = D'V8 • The differential load voltage is 
(6.12) 
Simplification leads to 
V=(2D-l)V8 
(6.13) 
This equation is plotted in Fig. 6.12. It can be seen the output voltage is positive forD> 0.5, and negative 
forD< 0.5. If the duty cycle is varied sinusoidally about a quiescent operating point of 0.5, then the out-
put voltage will be sinusoidal, with no de bias. 
The circuit of Fig. 6.ll(a) can be simplified. It is usually desired to bypass the load directly with 
a capacitor, as in Fig. 6.ll(b). The two inductors are now effectively in series, and can be combined into 
a single inductor as in Fig. 6.ll(c). Figure 6.ll(d) is identical to Fig. 6.ll(c), but is redrawn for clarity. 
This circuit is commonly called the H-bridge, or bridge inverter circuit. Its use is widespread in servo 
amplifiers and single-phase inverters. Its properties are similar to those of the buck converter, from which 
it is derived. 
Polyphase inverter circuits can be derived in a similar manner. A three-phase load can be con-
nected differentially across the outputs of three de-de converters, as illustrated in Fig. 6.12. If the three-
phase load is balanced, then the neutral voltage Vn will be equal to the average of the three converter out-
put voltages: 
v, = H 
VI + Vz + v3) 
(6.14) 
de source 
3¢ac load 
Converter 1 
+ 
V1 =M(D 1) vg 
VI 
-
vg 
. 
Converter 2 
+ 
V2 =M(D2) V8 
v2 
-
. 
. 
Converter 3 
+ 
V3 =M(D3) V8 
v3 
Fig. 6.12 Generation of dc-3<jlac inverter by differential connection of 3<jl load. 

142 
Converter Circuits 
(a) 
3<jlacload 
de source 
+ 
I 
VI 
.L 
l 
vg 
+ 
T 
v2 
. 
_L 
----:::L 
+ 
I 
v3 
.:!; 
l -
(b) 
de source 
3<jlacload 
+ 
(c) 
de source 
3<jlacload 
+ 
Fig. 6.13 
Dc-3<jlac inverter topologies: (a) differential connection of 3<jlload across outputs of buck converters: 
(b) simplification of low-pass filters to obtain the dc-3<jlac voltage-source inverter; (c) the dc-3<jlac current-source 
inverter. 

6.2 
A Short List of Converters 
143 
If the converter output voltages V1, V2, and V3 contain the same de bias, then this de bias will also appear 
at the neutral point Vn. The phase voltages Van' Vbn' and Vcn are given by 
van= Vl- VII 
vbn= Vz- VII 
Vcn= V3- V" 
It can be seen that the de biases cancel out, and do not appear in van' vbn' and vcn" 
(6.15) 
Let us realize converters 1, 2, and 3 of Fig. 6.12 using buck converters. Figure 6.13(a) is then 
obtained. The circuit is re-drawn in Fig. 6.13(b) for clarity. This converter is known by several names, 
including the voltage-source inverter and the buck-derived three-phase bridge. 
Inverter circuits based on de-de converters other than the buck converter can be derived in a 
similar manner. Figure 6.13(c) contains a three-phase current-fed bridge converter having a boost-type 
voltage conversion ratio, also known as the current-source inverter. Since most inverter applications 
require the capability to reduce the voltage magnitude, a de-de buck converter is usually cascaded at the 
de input port of this inverter. Several other examples of three-phase inverters are given in [5-7], in which 
the converters are capable of both increasing and decreasing the voltage magnitude. 
6.2 
A SHORT LIST OF CONVERTERS 
An infinite number of converters are possible, and hence it is not feasible to list them all. A short list is 
given here. 
Let's consider first the class of single-input single-output converters, containing a single induc-
tor. There are a limited number of ways in which the inductor can be connected between the source and 
load. If we assume that the switching period is divided into two subintervals, then the inductor should be 
connected to the source and load in one manner during the first subinterval, and in a different manner 
during the second subinterval. One can examine all of the possible combinations, to derive the complete 
set of converters in this class [8-10]. By elimination of redundant and degenerate circuits, one finds that 
there are eight converters, listed in Fig. 6.14. How the converters are counted can actually be a matter of 
semantics and personal preference; for example, many people in the field would not consider the nonin-
verting buck-boost converter as distinct from the inverting buck-boost. Nonetheless, it can be said that a 
converter is defined by the connections between its reactive elements, switches, source, and load; by how 
the switches are realized; and by the numerical range of reactive element values. 
The first four converters of Fig. 6.14, the buck, boost, buck-boost, and the noninverting buck-
boost, have been previously discussed. These converters produce a unipolar de output voltage. With these 
converters, it is possible to increase, decrease, and/or invert a de voltage. 
Converters 5 and 6 are capable of producing a bipolar output voltage. Converter 5, the 
H-bridge, has previously been discussed. Converter 6 is a nonisolated version of a push-pull current-fed 
converter [11-15]. This converter can also produce a bipolar output voltage; however, its conversion ratio 
M(D) is a nonlinear function of duty cycle. The number of switch elements can be reduced by using a 
two-winding inductor as shown. The function of the inductor is similar to that of the flyback converter, 
discussed in the next section. When switch 1 is closed the upper winding is used, while when switch 2 is 
closed, current flows through the lower winding. The current flows through only one winding at any 
given instant, and the total ampere-turns of the two windings are a continuous function of time. Advan-
tages of this converter are its ground-referenced load and its ability to produce a bipolar output voltage 
using only two SPST current-bidirectional switches. The isolated version and its variants have found 

144 
Converter Circuits 
1. Buck 
M(D) = D 
2. Boost 
2 
3. Buck-boost 
4. Noninverting buck-boost 
M(D) = 1 ~D 
M(D) = - ___])_ 
1-D 
M(D) = 1 ~D 
0.5 
D 
0 
0.5 
D 
0 
-1 
-2 
-3 
-4 
M(D) 
M(D) 
0 
0.5 
D 
Fig. 6.14 
Eight members of the basic class of single-input single-output converters containing a single inductor. 
application in high-voltage de power supplies. 
Converters 7 and 8 can be derived as the inverses of converters 5 and 6. These converters are 
capable of interfacing an ac input to a de output. The ac input current waveform can have arbitrary wave-
shape and power factor. 
The class of single-input single-output converters containing two inductors is much larger. Sev-
eral of its members are listed in Fig. 6.15. The Cuk converter has been previously discussed and ana-

6.2 
A Short List of Converters 
145 
5. Bridge 
M(D)=2D-l 
M(D) 
'·f:~: 
D 
-I 
6. Watkins-Johnson 
M(D)-2D-l 
--D-
M(D) 
+ 
or 
+ 
-I 
D 
v 
v 
-2 
-3 
M(D) = 2Dl-l 
M(D) 
~ 
7. Current-fed bridge 
'·[:~: 
0.5 
D 
-I 
-2 
8. Inverse of Watkins-Johnson 
M(D)= zl-1 
M(D) 
~ 
+ 
or 
+ 
0.5 
D 
v 
v 
-I 
-2 
Fig. 6.14 Continued 
lyzed. It has an inverting buck-boost characteristic, and exhibits nonpulsating input and output terminal 
currents. The SEPIC (single-ended primary inductance converter) [16], and its inverse, have noninverting 
buck-boost characteristics. The Cuk and SEPIC also exhibit the desirable feature that the MOSFET 
source terminal is connected to ground; this simplifies the construction of the gate drive circuitry. Two-
inductor converters having conversion ratios M(D) that are biquadratic functions of the duty cycle D are 
also numerous. An example is converter 4 of Fig. 6.15 [17]. This converter can be realized using a single 
transistor and three diodes. Its conversion ratio is M(D) = D2. This converter may find use in nonisolated 
applications that require a large step-down of the de voltage, or in applications having wide variations in 
operating point. 

146 
Converter Circuits 
l. Cuk 
2. SEPIC 
3. Inverse of SEPIC 
4. Buck 2 
M(D)=- 1 ~D 
M(D) = ___!2_ 
1-D 
M(D) = ___!2_ 
1-D 
M(D) =D 2 
+ 
v 
+ 
v 
0.5 
D 
-1 
-2 
-3 
-4 
M(D) 
M(D) 
4 
0 
0.5 
D 
0 
0.5 
D 
M(D) 
0.5 
o.,._--=::..._---+-------+---+ 
0 
0.5 
D 
Fig. 6.15 
Several members ofthe basic class of single-input single-output converters containing two inductors. 
6.3 
TRANSFORMER ISOLATION 
In a large number of applications, it is desired to incorporate a transformer into a switching converter, to 
obtain de isolation between the converter input and output. For example, in off-line applications (where 
the converter input is connected to the ac utility system), isolation is usually required by regulatory agen-

(a) 
(b) 
6.3 
Tran~former Isolation 
147 
Vl:t)-i-l(_t:M_(-t)-'---il-'(-t)-'[--1~; r 
ilt) ,:1) 
[
; 
i3(t) + 
v3(t) 
:: 
-
: ......... :.~~--] 
Ideal 
transformer 
Fig. 6.16 Simplified model of a multiple-winding transformer: (a) schematic symbol, (b) equivalent circuit con-
taining a magnetizing inductance and ideal transformer. 
cies. Isolation could be obtained in these cases by simply connecting a 50 Hz or 60Hz transformer at the 
converter ac input However, since transformer size and weight vary inversely with frequency, significant 
improvements can be made by incorporating the transformer into the converter, so that the transformer 
operates at the converter switching frequency of tens or hundreds of kilohertz. 
When a large step-up or step-down conversion ratio is required, the use of a transformer can 
allow better converter optimization. By proper choice of the transformer turns ratio, the voltage or cur-
rent stresses imposed on the transistors and diodes can be minimized, leading to improved efficiency and 
lower cost 
Multiple de outputs can also be obtained in an inexpensive manner, by adding multiple second-
ary windings and converter secondary-side circuits. The secondary turns ratios are chosen to obtain the 
desired output voltages. Usually only one output voltage can be regulated via control of the converter 
duty cycle, so wider tolerances must be allowed for the auxiliary output voltages. Cross regulation is a 
measure of the variation in an auxiliary output voltage, given that the main output voltage is perfectly 
regulated [18-20]. 
A physical multiple-winding transformer having turns ratio n1:n2:n3: ... is illustrated in Fig. 
6.16(a). A simple equivalent circuit is illustrated in Fig. 6.16(b), which is sufficient for understanding the 
operation of most transformer-isolated converters. The model assumes perfect coupling between wind-
ings and neglects losses; more accurate models are discussed in a later chapter. The ideal transformer 
obeys the relationships 
v1(t) 
vit) 
v3(t) 
fll = n:;- = fi3 = 
0 = n 1i 1' (t) + n 2i 2(t) + niit) + ... 
(6.16) 
In parallel with the ideal transformer is an inductance LM, called the magnetizing inductance, referred to 
the transformer primary in the figure. 
Physical transformers must contain a magnetizing inductance. For example, suppose we discon-
nect all windings except for the primary winding. We are then left with a single winding on a magnetic 
core-an inductor. Indeed, the equivalent circuit of Fig. 6.16(b) predicts this behavior, via the magnetiz-
ing inductance. 

148 
Converter Circuits 
B(t) « J 
v,(t) dt 
saturation 
Fig. 6.17 B-H characteristics oftransformer core. 
The magnetizing current iM(t) is proportional to the magnetic field H(t) inside the transformer 
core. The physical B-H characteristics of the transformer core material, illustrated in Fig. 6.17, govern 
the magnetizing current behavior. For example, if the magnetizing current iM(t) becomes too large, then 
the magnitude of .the magnetic field H(t) causes the core to saturate. The magnetizing inductance then 
becomes very small in value, effectively shorting out the transformer. 
The presence of the magnetizing inductance explains why transformers do not work in de cir-
cuits: at de, the magnetizing inductance has zero impedance, and shorts out the windings. In a well-
designed transformer, the impedance of the magnetizing inductance is large in magnitude over the 
intended range of operating frequencies, such that the magnetizing current iM(t) has much smaller mag-
nitude than i1(t). Then i1'(t)"' i1(t), and the transformer behaves nearly as an ideal transformer. It should 
be emphasized that the magnetizing current iM(t) and the primary winding current i1(t) are independent 
quantities. 
The magnetizing inductance must obey all of the usual rules for inductors. In the model of Fig. 
6.16(b), the primary winding voltage v1(t) is applied across LM, and hence 
Integration leads to 
( ) -L diM(t) 
VI t -
M dt 
(6.17) 
(6.18) 
So the magnetizing current is determined by the integral of the applied winding voltage. The principle of 
inductor volt-second balance also applies: when the converter operates in steady-state, the de component 
of voltage applied to the magnetizing inductance must be zero: 
(6.19) 
Since the magnetizing current is proportional to the integral of the applied winding voltage, it is impor·· 
tant that the de component of this voltage be zero. Otherwise, during each switching period there will be 
a net increase in magnetizing current, eventually leading to excessively large currents and transformer 
saturation. 

6.3 
Transformer Isolation 
149 
The operation of converters containing transformers may be understood by inserting the model 
of Fig. 6.16(b) in place of the transformer in the converter circuit. Analysis then proceeds as described in 
the previous chapters, treating the magnetizing inductance as any other inductor of the converter. 
Practical transformers must also contain leakage inductance. A small part of the flux linking a 
winding may not link the other windings. In the two-winding transformer, this phenomenon may be 
modeled with small inductors in series with the windings. In most isolated converters, leakage induc-
tance is a nonideality that leads to switching loss, increased peak transistor voltage, and that degrades 
cross-regulation, but otherwise has no influence on basic converter operation. 
There are several ways of incorporating transformer isolation into a de-de converter. The full-
bridge, half-bridge, forward, and push-pull converters are commonly used isolated versions of the buck 
converter. Similar isolated variants of the boost converter are known. The ftyback converter is an isolated 
version of the buck-boost converter. These isolated converters, as well as isolated versions of the SEPIC 
and the Cuk converter, are discussed in this section. 
6.3.1 
Full-Bridge and Half-Bridge Isolated 
Buck Converters 
The full-bridge transformer-isolated buck converter is sketched in Fig. 6.18(a). A version containing a 
center-tapped secondary winding is shown; this circuit is commonly used in converters producing low 
output voltages. The two halves of the center-tapped secondary winding may be viewed as separate 
windings, and hence we can treat this circuit element as a three-winding transformer having turns ratio 
1 :n:n. When the transformer is replaced by the equivalent circuit model of Fig. 6.16(b ), the circuit of Fig. 
(a) 
+ 
v 
+ 
g 
-
R 
v 
--1 
D2 
--1 
Q2 
Q4 
(b) 
Ql 
-I 
+ 
v 
+ 
g 
-
R 
v 
-I 
Q2 
Ideal 
' 
.. :: 
:.r.~a.ll.sfor.l11:e.!l11:().4e_!J 
Fig. 6.18 
Full-bridge transformer-isolated buck converter: (a) schematic diagram, (b) replacement of transformer 
with equivalent circuit model. 

150 
Converter Circuits 
Fig. 
6.19 Waveforms of the 
full-bridge transformer-isolated 
buck converter. 
iM(t) ~/! 
~: 
LM l 
,,~,) 1~----vg_._. ----;-. ---------+---++ 
;(t)l~ 
v,(t) 1 nVg 
i 
: 
nVg 
i 
~ 
0 
0 
~ 
ivs(t) ~'------i-----+---+----++ 
0.5 i 
0.5 i r 
0 
i--------1: t .. 
conducting 
devices: 
0 
DT s 
T+DT 
·' 
s 
6.18(b) is obtained. Typical waveforms are illustrated in Fig. 6.19. The output portion of the converter is 
similar to the nonisolated buck converter-compare the vJt) and i(t) waveforms of Fig. 6.19 with Figs. 
2.l(b) and 2.10. 
During the first subinterval 0 < t < DTs, transistors Q1 and Q4 conduct, and the transformer pri-
mary voltage is vy = V8 . This positive voltage causes the magnetizing current iM(t) to increase with a 
slope of V/LM. The voltage appearing across each half of the center-tapped secondary winding is nV8 , 
with the polarity mark at positive potential. Diode D5 is therefore forward-biased, and D6 is reverse-
biased. The voltage v,(t) is then equal to n V8 , and the output filter inductor current i(t) flows through 
diode D5. 
Several transistor control schemes are possible for the second subinterval DTs < t < Ts. In the 
most common scheme, all four transistors are switched off, and hence the transformer voltage is vy = 0. 
Alternatively, transistors Q2 and Q4 could conduct, or transistors Q1 and Q3 could conduct. In any event, 
diodes D5 and D6 are both forward-biased during this subinterval; each diode conducts approximately 
one-half of the output filter inductor current. 
Actually, the diode currents i05 and i06 during the second subinterval are functions of both the 
output inductor current and the transformer magnetizing current. In the ideal case (no magnetizing cur-
rent), the transformer causes i05(t) and i06(t) to be equal in magnitude since, if i1'(t) = 0, then 
ni05(t) = ni06(t). But the sum of the two diode currents is equal to the output inductor current: 

6.3 
Transformer Isolation 
151 
i05(t) +i06(t) = i(t) 
(6.20) 
Therefore, it must be true that i05 = i06 = 0.5i during the second subinterval. In practice, the diode cur-
rents differ slightly from this result, because of the nonzero magnetizing current. 
The ideal transformer currents in Fig. 6.18(b) obey 
i; (t)- ni 05(t) + ni 06(t) = 0 
(6.21) 
The node equation at the primary of the ideal transformer is 
(6.22) 
Elimination of i/(t) from Eqs. (6.21) and (6.22) leads to 
(6.23) 
Equations (6.23) and (6.20) describe, in the general case, the transformer winding currents during the 
second subinterval. According to Eq. (6.23), the magnetizing current iM(t) may flow through the primary 
winding, through one of the secondary windings, or it may divide between all three of these windings. 
How the division occurs depends on the i-v characteristics of the conducting transistors and diodes, and 
on the transformer leakage inductances. In the case where i1 = 0, the solution to Eqs. (6.20) and (6.23) is 
i 05(t) = ~ i(t)- 2~ i M(t) 
i 06(t) = ~ i(t) + 21n iM(t) 
Provided that iM < ni, then i05 and i06 are each approximately 0.5i. 
(6.24) 
The next switching period, T, < t < 2Ts, proceeds in a similar manner, except that the trans-
former is excited with voltage of the opposite polarity. During Ts < t < (T,. + DT,.), transistors Q2 and Q3 
and diode D6 conduct. The applied transformer primary voltage is Vr =- V8, which causes the magnetiz-
ing current to decrease with slope- V/LM. The voltage vs(t) is equal to nVg, and the output inductor cur-
rent i(t) flows through diode D6 . Diodes D5 and D6 again both conduct during (Ts + DTs) < t < 2T,., with 
operation similar to subinterval 2 described previously. It can be seen that the switching ripple in the out-
put filter elements has frequency fs = liT,.. However, the transformer waveforms have frequency 0.5fs. 
By application of the principle of inductor volt-second balance to the magnetizing inductance, 
the average value of the transformer voltage vr(t) must be zero when the converter operates in steady 
state. During the first switching period, positive volt-seconds are applied to the transformer, approxi-
mately equal to 
r vg- ( Q l and Q4 forward voltage drops) 1 ( Q l and Q4 conduction time) 
(6.25) 
During the next switching period, negative volt-seconds are applied to the transformer, given by 
-l V8 -
( Q2 and Q3 forward voltage drops) 1 ( 
Q2 and Q3 conduction time) 
(6.26) 

152 
Converter Circuits 
The net volt-seconds, that is, the sum of Eqs. (6.25) and (6.26), should equal zero. While the full bridge 
scheme causes this to be approximately true, in practice there exist imbalances such as small differences 
in the transistor forward voltage drops or in the transistor switching times, so that ( vr) is small but non-
zero. In consequence, during every two switching periods there is a net increase in the magnitude of the 
magnetizing current. This increase can cause the transistor forward voltage drops to change such that 
small imbalances are compensated. However, if the imbalances are too large, then the magnetizing cur-
rent becomes large enough to saturate the transformer. 
Transformer saturation under steady-state conditions can be avoided by placing a capacitor in 
series with the transformer primary. Imbalances then induce a de voltage component across the capacitor, 
rather than across the transformer primary. Another solution is the use of current-programmed control, 
discussed in a later chapter. The series capacitor is omitted when current-programmed control is used. 
By application of the principle of volt-second balance to the output filter inductor L, the de load 
voltage must be equal to the de component of v/t): 
V = ( v,) 
(6.27) 
By inspection of the v/t) waveform in Fig. 6.19, ( vs) = nDVg. Hence, 
(6.28) 
So as in the buck converter, the output voltage can be controlled by variation of the transistor duty cycle 
D. An additional increase or decrease of the voltage can be obtained via the physical transformer turns 
ration. Equation (6.28) is valid for operation in the continuous conduction mode; as in the nonisolated 
buck converter, the full-bridge and half-bridge converters can operate in discontinuous conduction mode 
at light load. The converter can operate over essentially the entire range of duty cycles 0 :::; D < 1. 
Transistors Q1 and Q2 must not conduct simultaneously; doing so would short out the de source 
Vg, causing a shoot-through current spike. This transistor cross-conduction condition can lead to low 
efficiency and transistor failure. Cross conduction can be prevented by introduction of delay between the 
tum-off of one transistor and the turn-on of the next transistor. Diodes D1 to D4 ensure that the peak tran-
sistor voltage is limited to the de input voltage V8 , and also provide a conduction path for the transformer 
magnetizing current at light load. Details of the switching transitions of the full-bridge circuit are dis-
cussed further in a later chapter, in conjunction with zero-voltage switching phenomena. 
The full-bridge configuration is typically used in switching power supplies at power levels of 
approximately 750 W and greater. It is usually not used at lower power levels because of its high parts 
count-four transistors and their associated drive circuits are required. The utilization of the transformer 
is good, leading to small transformer size. In particular, the utilization of the transformer core is very 
good, since the transformer magnetizing current can be both positive and negative. Hence, the entire core 
B-H loop can be used. However, in practice, the flux swing is usually limited by core loss. The trans-
former primary winding is effectively utilized. But the center-tapped secondary winding is not, since 
each half of the center-tapped winding transmits power only during alternate switching periods. Also, the 
secondary winding currents during subinterval 2 lead to winding power loss, but not to transmittal of 
energy to the load. Design of the transformer of the full-bridge configuration is discussed in detail in a 
later chapter. 
The half-bridge transformer-isolated buck converter is illustrated in Fig. 6.20. Typical wave-
forms are illustrated in Fig. 6.21. This circuit is similar to the full-bridge of Fig. 6.18(a), except transis-
tors Q3 and Q4, and their antiparallel diodes, have been replaced with large-value capacitors ca and cb. 
By volt-second balance of the transformer magnetizing inductance, the de voltage across capacitor Cb is 
equal to the de component of the voltage across transistor Q2, or 0.5Vg. The transformer primary voltage 

v 
+ 
g 
-
6.3 
Transformer Isolation 
153 
+ 
R 
v 
Fig. 6.20 Half-bridge transformer-isolated buck converter. 
Fig. 
6.21 
Waveforms of the 
half-bridge transformer-isolated 
buck converter. 
iM(t) h~'---'-
/i, __ 
__,_____:~---
c- L_ 
i"" 
0 
~ 
ozMvgj 
!-0.~1 
r,,'',,, 
vr(t) j o.sv, 
I~ I 
0 
l-asv, i 
0 f 
i 
j 
! 
i(t) 1~ 
vs(t) 1 
O.SnV, 
! O.SnV, ! 
! 
im(t) 1. 
0 
I 
0 
~ 
0.5 i 
I 0 
0.5 i 
G 
conducting 
devices: 
0 
vT(t) is then 0.5V8 when transistor Q1 conducts, and- 0.5V8 when transistor Q2 conducts. The magnitude 
of vT(t) is half as large as in the full-bridge configuration, with the result that the output voltage is 
reduced by a factor of 0.5: 
V=0.5nDV8 
(6.29) 

154 
Converter Circuits 
The factor of 0.5 can be compensated for by doubling the transformer turns ration. However, this causes 
the transistor currents to double. 
So the half-bridge configuration needs only two transistors rather than four, but these two tran-
sistors must handle currents that are twice as large as those of the full-bridge circuit. In consequence, the 
half-bridge configuration finds application at lower power levels, for which transistors with sufficient 
current rating are readily available, and where low parts count is important. Utilization of the transformer 
core and windings is essentially the same as in the full-bridge, and the peak transistor voltage is clamped 
to the de input voltage V8 by diodes D 1 and D2• It is possible to omit capacitor Ca if desired. The current-
programmed mode generally does not work with half-bridge converters. 
6.3.2 
Forward Converter 
The forward converter is illustrated in Fig. 6.22. This transformer-isolated converter is based on the buck 
converter. It requires a single transistor, and hence finds application at power levels lower than those 
commonly encountered in the full-bridge and half-bridge configurations. Its nonpulsating output current, 
shared with other buck-derived converters, makes the forward converter well suited for applications 
involving high output currents. The maximum transistor duty cycle is limited in value; for the common 
choice n1 = n2, the duty cycle is limited to the range 0 :s; D < 0.5. 
The transformer magnetizing current is reset to zero while the transistor is in the off-state. How 
this occurs can be understood by replacing the three-winding transformer in Fig. 6.22 with the equivalent 
circuit of Fig. 6.16(b ). The resulting circuit is illustrated in Fig. 6.23, and typical waveforms are given in 
Fig. 6.24. The magnetizing inductance LM, in conjunction with diode D 1, must operate in the discontinu-
ous conduction mode. The output inductor L, in conjunction with diode D3, may operate in either contin-
uous or discontinuous conduction mode. The waveforms of Fig. 6.24 are sketched for continuous mode 
operation of inductor L. During each switching period, three subintervals then occur as illustrated in Fig. 
6.25. 
During subinterval!, transistor Q1 conducts and the circuit of Fig. 6.25(a) is obtained. Diode D2 
becomes forward-biased, while diodes D1 and D3 are reverse-biased. Voltage V8 is applied to the trans-
former primary winding, and hence the transformer magnetizing current iM(t) increases with a slope of 
V/LM as illustrated in Fig. 6.24. The voltage across diode D3 is equal to V8 , multiplied by the turns ratio 
n3/n 1• 
The second subinterval begins when transistor Q1 is switched off. The circuit of Fig. 6.25(b) is 
+ 
c 
R 
v 
+ 
Fig. 6.22 
Single-transistor forward converter. 

6.3 
Transformer Isolation 
155 
nl : nz : n3 
Dz 
L 
iM 
+ 
LM 
D3 
VD3 
c 
R 
v 
vg 
+ 
DI 
Fig. 6.23 
Forward converter, with transformer equivalent circuit model. 
Fig. 6.24 
Waveforms of the forward 
converter. 
Conducting 
devices: 
0 
0 
0 
-DT,-- +---D2Ts-i•D3Ts•! 
------+- T 
' 
i 
s 
then obtained. The transformer magnetizing current iM(t) at this instant is positive, and must continue to 
flow. Since transistor Q1 is off, the equivalentcircuit model predicts that the magnetizing current must 
flow into the primary of the ideal transformer. It can be seen that n1 iM ampere-turns flow out of the polar-
ity mark of the primary winding. Hence, according to Eq. (6.16), an equal number of total ampere-turns 
must flow into the polarity marks of the other windings. Diode D2 prevents current from flowing into the 

156 
Converter Circuits 
(a) 
(b) 
(c) 
+ 
+ 
+ 
iM 
: == 0 
: LM 
1.----L--.J 
D2 on 
+ 
+ 
+ 
+j 
_____ ; 
__ : 
i3 
L 
+ 
c 
R 
v 
L 
+ 
c 
R 
v 
L 
+ 
c 
R 
v 
Fig. 6.25 
Forward converter circuit: (a) during subinterval!, (b) during subinterval2, (c) during subinterval3. 
polarity mark of winding 3. Hence, the current iMn1/n2 must flow into the polarity mark of winding 2. So 
diode D1 becomes forward-biased, while diode D2 is reverse-biased. Voltage V8 is applied to winding 2, 
and hence the voltage across the magnetizing inductance is- V8n/n2, referred to winding 1. This nega-
tive voltage causes the magnetizing current to decrease, with a slope of- V8n/n2LM. Since diode D2 is 
reverse-biased, diode D3 must tum on to conduct the output inductor current i(t). 
When the magnetizing current reaches zero, diode D1 becomes reverse-biased. Subinterval 3 
then begins, and the circuit of Fig. 6.25( c) is obtained. Elements Q 1, D 1, and D2 operate in the off state, 
and the magnetizing current remains at zero for the balance of the switching period. 
By application of the principle of inductor volt-second balance to the transformer magnetizing 

6.3 Transformer Isolation 
157 
Fig. 
6.26 Magnetizing 
current 
waveform, 
forward 
converter: 
(a) DCM, D < 0.5; (b) CCM, D > 0.5. 
inductance, the primary winding voltage v1(t) must have zero average. Referring to Fig. 6.24, the average 
of v 1 (t) is given by 
(6.30) 
Solution for the duty cycle D2 yields 
(6.31) 
Note that the duty cycle D3 cannot be negative. But since D + D2 + D3 = 1, we can write 
(6.32) 
Substitution ofEq. (6.31) into Eq. (6.32) leads to 
(6.33) 
Solution for D then yields 
(6.34) 
So the maximum duty cycle is limited. For the common choice n1 = ~· the limit becomes 
(6.35) 
If this limit is violated, then the transistor off-time is insufficient to reset the transformer magnetizing 
current to zero before the end of the switching period. Transformer saturation may then occur. 
The transformer magnetizing current waveform iM(t) is illustrated in Fig. 6.26, for the typical 

158 
Converter Circuits 
case where n1 = n2 . Figure 6.26(a) illustrates operation with D < 0.5. The magnetizing inductance, in 
conjunction with diode D 1, operates in the discontinuous conduction mode, and iM(t) is reset to zero 
before the end of each switching period. Figure 6.26(b) illustrates what happens when the transistor duty 
cycleD is greater than 0.5. There is then no third subinterval, and the magnetizing inductance operates in 
continuous conduction mode. Furthermore, subinterval2 is not long enough to reset the magnetizing cur-
rent to zero. Hence, there is a net increase of iM(t) over each switching period. Eventually, the magnetiz-
ing current will become large enough the saturate the transformer. 
The converter output voltage can be found by application of the principle of inductor volt-sec-
ond balance to inductor L. The voltage across inductor L must have zero de component, and therefore the 
de output voltage Vis equal to the de component of diode D3 voltage v m(t). The waveform v mCt) is illus-
trated in Fig. 6.24.1t has an average value of 
(6.36) 
This is the solution of the forward converter in the continuous conduction mode. The solution is subject 
to the constraint given in Eq. (6.34). 
It can be seen from Eq. (6.34) that the maximum duty cycle could be increased by decreasing 
the turns ratio n2/n1. This would cause iM(t) to decrease more quickly during subinterval 2, resetting the 
transformer faster. Unfortunately, this also increases the voltage stress applied to transistor Q1 . The max-
imum voltage applied to transistor Q1 occurs during subinterval 2; solution of the circuit of Fig. 6.25(b) 
for this voltage yields 
(6.37) 
For the common choice n1 = n2 , the voltage applied to the transistor during subinterval 2 is 2Vg. In prac-
tice, a somewhat higher voltage is observed, due to ringing associated with the transformer leakage 
inductance. So decreasing the turns ratio n2/n1 allows increase of the maximum transistor duty cycle, at 
the expense of increased transistor blocking voltage. 
A two-transistor version of the forward converter is illustrated in Fig. 6.27. Transistors Q1 and 
Q2 are controlled by the same gate drive signal, such that they both conduct during subinterval 1, and are 
off during subintervals 2 and 3. The secondary side of the converter is identical to the single-transistor 
forward converter; diode D3 conducts during subinterval l, while diode D 4 conducts during subintervals 
2 and 3. During subinterval 2, the magnetizing current iM(t) forward-biases diodes D 1 and D2. The trans-
+ 
+ 
c 
R 
v 
Fig. 6.27 
Two-transistor forward converter. 

6.3 
Transformer Isolation 
159 
former primary winding is then connected to V8 , with polarity opposite that of subinterval 1. The magne-
tizing current then decreases, with slope- V/LM. When the magnetizing current reaches zero, diodes D 1 
and D2 become reverse-biased. The magnetizing current then remains at zero for the balance of the 
switching period. So operation of the two-transistor forward converter is similar to the single-transistor 
forward converter, in which n1 = n2 . The duty cycle is limited to D < 0.5. This converter has the advan-
tage that the transistor peak blocking voltage is limited to V8 , and is clamped by diodes D 1 and D2 • Typi-
cal power levels of the two-transistor forward converter are similar to those of the half-bridge 
configuration. 
The utilization of the transformer of the forward converter is quite good. Since the transformer 
magnetizing current cannot be negative, only half of the core B-H loop can be used. This would seem-
ingly imply that the transformer cores of forward converters should be twice as large as those of full- or 
half-bridge converters. However, in modern high-frequency converters, the flux swing is constrained by 
core loss rather than by the core material saturation flux density. In consequence, the utilization of the 
transformer core of the forward converter can be as good as in the full- or half-bridge configurations. Uti-
lization of the primary and secondary windings of the transformer is better than in the full-bridge, half-
bridge, or push-pull configurations, since the forward converter requires no center-tapped windings. Dur-
ing subinterval!, all of the available winding copper is used to transmit power to the load. Essentially no 
unnecessary current flows during subintervals 2 and 3. Typically, the magnetizing current is small com-
pared to the reflected load current, and has negligible effect on the transformer utilization. So the trans-
former core and windings are effectively utilized in modern forward converters. 
6.3.3 
Push-Pull Isolated Buck Converter 
The push-pull isolated buck converter is illustrated in Fig. 6.28. The secondary-side circuit is identical 
with the full- and half-bridge converters, with identical waveforms. The primary-side circuit contains a 
center-tapped winding. Transistor Q1 conducts for time DTs during the first switching period. Transistor 
Q2 conducts for an identical length of time during the next switching period, such that volt-second bal-
ance is maintained across the transformer primary winding. Converter waveforms are illustrated in Fig. 
6.29. This converter can operate oven the entire range of duty cycles 0 ~ D < 1. Its conversion ratio is 
given by 
(6.38) 
This converter is sometimes used in conjunction with low input voltages. It tends to exhibit low primary-
Fig. 6.28 
Push-pull isolated 
buck converter. 
i(t) 
L 
+ 
v,.(t) 
+ 
c 
R 
v 

160 
Converter Circuits 
Fig. 
6.29 Waveforms of the 
push-pull isolated buck converter. 
iM(t) ~/~ 
~: 
LM i 
'it) l 
v, 
i(t)l~ 
' 
: 
: 
: 
,,(t) 1 nV, 
0 
nV, i 
0 
~ 
im (t) ~'-----+-~-o-.5-i---'----~---o._s_i_----' .... 
_ 
0 r--------!rt 
~· 
Conducting 
devices: 
0 
DT, 
T, 
T,+DT, 
2T, 
side conduction losses, since at any given instant only one transistor is connected in series with the de 
source Vg. The ability to operate with transistor duty cycles approaching unity also allows the turns ratio 
n to be minimized, reducing the transistor currents. 
The push-pull configuration is prone to transformer saturation problems. Since it cannot be 
guaranteed that the forward voltage drops and conduction times of transistors Q1 and Q2 are exactly 
equal, small imbalances can cause the de component of voltage applied to the transformer primary to be 
nonzero. In consequence, during every two switching periods there is a net increase in the magnitude of 
the magnetizing current. If this imbalance continues, then the magnetizing current can eventually 
become large enough to saturate the transformer. 
Current-programmed control can be employed to mitigate the transformer saturation problems. 
Operation of the push-pull converter using only duty cycle control is not recommended. 
Utilization of the transformer core material and secondary winding is similar to that for the full-
bridge converter. The flux and magnetizing current can be both positive and negative, and therefore the 
entire B-H loop can be used, if desired. Since the primary and secondary windings are both center-
tapped, their utilization is suboptimal. 

6.3 
Transformer Isolation 
161 
(a) 
vg 
v 
+ 
(b) 
Q, 
D, 
Fig. 6.30 Derivation of the fly-
back converter: (a) buck-boost 
vg 
v 
converter; 
(b) inductor 
L 
is 
wound with two parallel wires; 
+ 
(c) inductor windings are iso-
lated, leading to the flyback con-
(c) 
Q, 
D, 
verter; (d) with a I :n turns ratio 
and positive output. 
vg 
v 
+ 
(d) 
+ 
c 
v 
vg 
+ 
~ 
6.3.4 
Flyback Converter 
The flyback converter is based on the buck-boost converter. Its derivation is illustrated in Fig. 6.30. Fig-
ure 6.30(a) depicts the basic buck-boost converter, with the switch realized using a MOSFET and diode. 
In Fig. 6.30(b ), the inductor winding is constructed using two wires, with a 1:1 turns ratio. The basic 
function of the inductor is unchanged: and the parallel windings are equivalent to a single winding con-
structed of larger wire. In Fig. 6.30(c), the connections between the two windings are broken. One wind-
ing is used while the transistor Q1 conducts, while the other winding is used when diode D1 conducts. 
The total current in the two windings is unchanged from the circuit of Fig. 6.30(b ); however, the current 
is now distributed between the windings differently. The magnetic fields inside the inductor in both cases 

162 
Converter Circuits 
Fig. 6.31 
Flyback converter circuit: 
(a) with transformer equivalent circuit 
model, 
(b) during 
subinterval 
I, 
(c) during subinterval 2. 
(a) 
(b) 
(c) 
+ 
............................................ 
. 
. 
. 
. 
: 
Transformer model 
: 
ifn 
+ 
+ 
c 
R 
v 
+ 
c 
R 
v 
+ 
c 
R 
v 
are identical. Although the two-winding magnetic device is represented using the same symbol as the 
transformer, a more descriptive name is "two-winding inductor." This device is sometimes also called a 
jiyback transformer. Unlike the ideal transformer, current does not flow simultaneously in both windings 
of the fly back transformer. Figure 6.30(d) illustrates the usual configuration of the flyback converter. The 
MOSFET source is connected to the primary-side ground, simplifying the gate drive circuit. The trans-
former polarity marks are reversed, to obtain a positive output voltage. A 1 :n turns ratio is introduced; 
this allows better converter optimization. 
The flyback converter may be analyzed by insertion of the model of Fig. 6.16(b) in place of the 
flyback transformer. The circuit of Fig. 6.31(a) is then obtained. The magnetizing inductance LM func-
tions in the same manner as inductor L of the original buck-boost converter of Fig. 6.30(a). When transis-
tor Q1 conducts, energy from the de source Vg is stored in LM. When diode D1 conducts, this stored 
energy is transferred to the load, with the inductor voltage and current scaled according to the 1:n turns 
ratio. 
During subinterval 1, while transistor Q1 conducts, the converter circuit model reduces to Fig. 

6.3 
Transformer Isolation 
163 
6.3l(b). The inductor voltage Vv capacitor current ic, and de source current ig are given by 
VL = V8 
0 
v 
zc=-R 
ig = i 
(6.39) 
With the assumption that the converter operates in the continuous conduction mode, with small inductor 
current ripple and small capacitor voltage ripple, the magnetizing current i and output capacitor voltage v 
can be approximated by their de components, I and V, respectively. Equation (6.39) then becomes 
VL= V8 
0 
v 
zc=-R 
i8 =I 
(6.40) 
During the second subinterval, the transistor is in the off-state, and the diode conducts. The equivalent 
circuit of Fig. 6.3l(c) is obtained. The primary-side magnetizing inductance voltage vv the capacitor 
current ic, and the de source current ig for this subinterval are: 
vL=-* 
0 
i 
v 
1c=n-f? 
ig = 0 
(6.41) 
It is important to consistently define vL(t) on the same side of the transformer for all subintervals. Upon 
making the small-ripple approximation, one obtains 
VL=-* 
. 
I 
V 
zc=n-7[ 
ig=O 
(6.42) 
The vL(t), ic(t), and igCt) waveforms are sketched in Fig. 6.32 for continuous conduction mode operation. 
Application of the principle of volt-second balance to the primary-side magnetizing inductance 
yields 
Solution for the conversion ratio then leads to 
_ V _ 
D 
M(D)-v-n D' 
g 
(6.43) 
(6.44) 
So the conversion ratio of the fly back converter is similar to that of the buck-boost converter, but contains 
an added factor of n. 
Application of the principle of charge balance to the output capacitor C leads to 
(6.45) 

164 
Converter Circuits 
Fig. 
6.32 
Flyback converter waveforms, 
continuous conduction mode. 
Solution for I yields 
Conducting 
devices: 
I 
nV 
= D'R 
-
-VIn 
!In- VIR 
-VIR 
-
I 
r---
0 
-DTs- -D'Ts-j 
Ts 
. 
(6.46) 
This is the de component of the magnetizing current, referred to the primary. The de component of the 
source current ig is 
(6.47) 
An equivalent circuit that models the de components of the flyback converter waveforms can 
now be constructed. Circuits corresponding to the inductor loop equation (6.43) and to node equations 
(6.45) and (6.47) are illustrated in Fig. 6.33(a). By replacing the dependent sources with ideal de trans-
formers, one obtains Fig. 6.33(b ). This is the de equivalent circuit of the fly back converter. It contains a 
l:D buck-type conversion ratio, followed by a D':l boost-type conversion ratio, and an added factor of 
1 :n arising from the fly back transformer turns ratio. By use of the method developed in Chapter 3, the 
model can be refined to account for losses and to predict the converter efficiency. The flyback converter 
can also be operated in the discontinuous conduction mode; analysis is left as a homework problem. The 
results are similar to the DCM buck-boost converter results tabulated in Chapter 5, but are generalized to 
account for the turns ratio 1 :n. 
The flyback converter is commonly used at the 50 to 100 W power range, as well as in high-
voltage power supplies for televisions and computer monitors. It has the advantage of very low parts 

(a) 
DI 
(b) 
1: D 
I 
I 
D'V 
---n 
6.3 
Transformer Isolation 
165 
+ 
R 
v 
D':n 
+ 
R 
v 
Fig. 6.33 Flyback converter equivalent circuit model, CCM: (a) circuits corresponding to Eqs. (6.43), (6.45), and 
(6.47); (b) equivalent circuit containing ideal de transformers. 
count. Multiple outputs can be obtained using a minimum number of parts: each additional output 
requires only an additional winding, diode, and capacitor. However, in comparison with the full-bridge, 
half-bridge, or two-transistor forward converters, the flyback converter has the disadvantages of high 
transistor voltage stress and poor cross-regulation. The peak transistor voltage is equal to the de input 
voltage Vg plus the reflected load voltage Vln; in practice, additional voltage is observed due to ringing 
associated with the transformer leakage inductance. Rigorous comparison of the utilization of the fly-
back transformer with the transformers of buck-derived circuits is difficult because of the different func-
tions performed by these elements. The magnetizing current of the flyback transformer is unipolar, and 
hence no more than half of the core material B-H loop can be utilized. The magnetizing current must 
contain a significant de component. Yet, the size of the flyback transformer is quite small in designs 
intended to operate in the discontinuous conduction mode. However, DCM operation leads to increased 
peak currents in the transistor, diode, and filter capacitors. Continuous conduction mode designs require 
larger values of LM, and hence larger fiyback transformers, but the peak currents in the power stage ele-
ments are lower. 
6.3.5 
Boost-Derived Isolated Converters 
Transformer-isolated boost converters can be derived by inversion of the source and load of buck-derived 
isolated converters. A number of configurations are known, and two of these are briefly discussed here. 
These converters find some employment in high-voltage power supplies, as well as in low-harmonic rec-
tifier applications. 
A full-bridge configuration is diagrammed in Fig. 6.34, and waveforms for the continuous con-
duction mode are illustrated in Fig. 6.35. The circuit topologies during the first and second subintervals 
are equivalent to those of the basic nonisolated boost converter, and when the turns ratio is 1:1, the induc-
tor current i(t) and output current i0(t) waveforms are identical to the inductor current and diode current 
waveforms of the nonisolated boost converter. 
During subinterval 1, all four transistors operate in the on state. This connects the inductor L 
across the de input source Vg, and causes diodes D1 and D2 to be reverse-biased. The inductor current i(t) 

166 
Converter Circuits 
R 
Fig. 6.34 
Full-bridge transformer-isolated boost converter. 
Vy(t) 
Vln 
0 
0 
- V/n 
vg 
vg 
: 
: 
V8 -V!n 
V8 -V!n 
: 
i(t; 
iJt) I 
0 
Tin 
0 
Un 
I. 
i+--DT--+1+---D'T --i+--DT--+ +--D'T -tt 
Conducting 
devices: 
i 
s 
: 
Ts 
s 
!, 
s 
T 
s 
i 
s 
1 
Fig. 6.35 
Waveforms of the transformer-isolated full-bridge boost converter, CCM. 
+ 
v 

6.3 
Transformer Isolation 
167 
increases with slope V/L, and energy is transferred from the de source Vg to inductor L. During the sec-
ond subinterval, transistors Q2 and Q3 operate in the off state, so that inductor L is connected via transis-
tors Q1 and Q4 through the transformer and diode D1 to the de output. The next switching period is 
similar, except that during subinterval 2, transistors Q1 and Q4 operate in the off state, and inductor Lis 
connected via transistors Q2 and Q3 through the transformer and diode D2 to the de output. If the transis-
tor off-times and the diode forward drops are identical, then the average transformer voltage is zero, and 
the net volt-seconds applied to the transformer magnetizing inductance over two switching periods is 
zero. 
Application of the principle of inductor volt-second balance to the inductor voltage waveform 
vL(t) yields 
(6.48) 
Solution for the conversion ratio M(D) then leads to 
M (D) = J::_ = _!1_ 
V 
D' 
g 
(6.49) 
This result is similar to the boost converter M(D), with an added factor of n due to the transformer turns 
ratio. 
The transistors must block the reflected load voltage V/n = V/D'. In practice, additional voltage 
(a) 
.J.£1 
+ 
c 
R 
v 
(b) 
+ 
c 
R 
v 
Fig. 6.36 
Push-pull isolated converters: (a) based on the boost converter, (b) based on the Watkins-Johnson con-
verter. 

168 
Converter Circuits 
is observed due to ringing associated with the transformer leakage inductance. Because the instantaneous 
transistor current is limited by inductor L, saturation of the transformer due to small imbalances in the 
semiconductor forward voltage drops or conduction times is not catastrophic. Indeed, control schemes 
are known in which the transformer is purposely operated in saturation during subinterval 1 [13, 15]. 
A push-pull configuration is depicted in Fig. 6.36(a). This configuration requires only two tran-
sistors, each of which must block voltage 2VIn. Operation is otherwise similar to that of the full-bridge. 
During subinterval I, both transistors conduct. During subinterval 2, one of the transistors operates in the 
off state, and energy is transferred from the inductor through the transformer and one of the diodes to the 
output. Transistors conduct during subinterval 2 during alternate switching periods, such that transformer 
volt-second balance is maintained. A similar push-pull version of the Watkins-Johnson converter, con-
verter 6 of Fig. 6.14, is illustrated in Fig. 6.36(b). 
6.3.6 
Isolated Versions of the SEPIC and the Cuk Converter 
The artifice used to obtain isolation in the flyback converter can also be applied to the SEPIC and 
inverse-SEPIC. Referring to Fig. 6.37(a), inductor L2 can be realized using two windings, leading to the 
isolated SEPIC of Fig. 6.37(b). An equivalent circuit is given in Fig. 6.37(c). It can be seen that the mag-
(a) 
+ 
R 
v 
(b) 
+ 
R 
v 
(c) 
+ 
R 
v 
: Ideal :: 
: 
:: 
Transf;;~~·;···· l 
c ........... rrt(J_ci_~l ............ ; 
Fig. 6.37 
Obtaining isolation in the SEPIC: (a) basic nonisolated converter, (b) isolated SEPIC, (c) with trans-
former equivalent circuit modeL 

Fig. 6.38 
Waveforms of the 
isolated 
SEPIC, 
continuous 
conduction mode. 
6.3 
Transformer Isolation 
169 
: 
: 
i,(l) 11---0 ---+-t:J-(z-·1 
+ i2-) 
I n~i _---l,.._[_. 
i,~:r:t:±=::. 
j-DTs---+j-D'Ts-j 
Conducting j 
' 
T, 
: 
devices: j 
Q1 
D 1 
netizing inductance performs the energy-storage function of the original inductor L2 . In addition, the 
ideal transformer provides isolation and a turns ratio. 
Typical primary and secondary winding current waveforms iP(t) and iJt) are portrayed in Fig. 
6.38, for the continuous conduction mode. The magnetic device must function as both a flyback trans-
former and also a conventional two-winding transformer. During subinterval 1, while transistor Q1 con-
ducts, the magnetizing current flows through the primary winding, and the secondary winding current is 
zero. During subinterval 2, while diode D1 conducts, the magnetizing current flows through the second-
ary winding to the load. In addition, the input inductor current i 1 flows through the primary winding. This 
induces an additional component of secondary current i 1 In, which also flows to the load. So design of the 
SEPIC transformer is somewhat unusual, and the rms winding currents are larger than those of the fly-
back transformer. 
By application of the principle of volt-second balance to inductors L1 and LM, the conversion 
ratio can be shown to be 
M(D) = _y_ = nr; 
V 
D 
g 
(6.50) 
Ideally, the transistor must block voltage V/D'. In practice, additional voltage is observed due to ringing 
associated with the transformer leakage inductance. 

170 
Converter Circuits 
+ 
+ 
R 
v 
Fig. 6.39 Isolated inverse-SEPIC. 
An isolated version of the inverse-SEPIC is shown in Fig. 6.39. Operation and design of the 
transformer is similar to that of the SEPIC. 
Isolation in the Cuk converter is obtained in a different manner [18]. The basic nonisolated Cuk 
converter is illustrated in Fig. 6.40(a). In Fig. 6.40(b), capacitor C1 is split into two series capacitors C1a 
and Clb' A transformer can now be inserted between these capacitors, as indicated in Fig. 6.40(c). The 
polarity marks have been reversed, so that a positive output voltage is obtained. Having capacitors in 
series with the transformer primary and secondary windings ensures that no de voltage is applied to the 
transformer. The transformer functions in a conventional manner, with small magnetizing current and 
negligible energy storage within the magnetizing inductance. 
Utilization of the transformer of the Cuk converter is quite good. The magnetizing current can 
(a) 
vg 
R 
v 
+ 
Fig. 6.40 Obtaining isolation (b) 
in the Cuk converter: (a) basic 
nonisolated 
Cuk 
converter, 
(b) splitting capacitor C1 into 
two series capacitors, (c) inser-
vg 
R 
v 
tion of transformer between 
capacitors. 
+ 
(c) 
+ 
vg 
R 
v 
1: n 

6.4 
Converter Evaluation and Design 
171 
be both positive and negative, and hence the entire core B-H loop can be utilized if desired. There are no 
center-tapped windings, and all of the copper is effectively utilized. The transistor must block voltage 
V/D', plus some additional voltage due to ringing associated with the transformer leakage inductance. 
The conversion ratio is identical to that of the isolated SEPIC, Eq. (6.50). 
The isolated SEPIC and Cuk converter find application as switching power supplies, typically at 
power levels of several hundred watts. They are also now finding use as ac-dc low-harmonic rectifiers. 
6.4 
CONVERTER EVALUATION AND DESIGN 
There is no ultimate converter perfectly suited for all possible applications. For a given application, with 
given specifications, trade studies should be performed to select a converter topology. Several 
approaches that meet the specifications should be considered, and for each approach important quantities 
such as worst-case transistor voltage, worst-case transistor rms current, transformer size, etc., should be 
computed. This type of quantitative comparison can lead to selection of the best approach, while avoid-
ing the personal biases of the engineer. 
6.4.1 
Switch Stress and Utilization 
Often, the largest single cost in a converter is the cost of the active semiconductor devices. Also, the con-
duction and switching losses associated with the semiconductor devices often dominates the other con-
verter losses. This suggests evaluating candidate converter approaches by comparing the voltage and 
current stresses imposed on the active semiconductor devices. Minimization of the total switch stresses 
leads to minimization of the total silicon area required to realize the power devices of the converter. 
So it is useful to compare the total active switch stress and active switch utilization of candidate 
converter approaches. In a good design, the voltages and currents imposed on the semiconductor devices 
is minimized, while the load power is maximized. If a converter contains k active semiconductor devices, 
the total active switch stress Scan be defined as 
k 
S= LVI 
j= l 
J 1 
(6.51) 
where V1 is the peak voltage applied to semiconductor switch j, and 11 is the rms current applied to 
switchj. Peak rather than rms current is sometimes used, with qualitatively similar results. If the con-
verter load power is P1oad• then the active switch utilization U can be defined as 
U _ pload 
- s 
(6.52) 
The switch utilization is less than one in transformer-isolated converters, and is a quantity to be maxi-
mized. 
For example, consider the transistor utilization in the CCM flyback converter of Fig. 6.30(d). 
The peak transistor voltage occurs during subinterval 2, and is equal to the de input voltage Vg plus the 
reflected load voltage V/n: 
v 
vg 
v Ql,pk = vg + n = u 
(6.53) 

172 
Converter Circuits 
The transistor current waveform coincides with the input current waveform igCt), which is sketched in 
Fig. 6.32. The rms value of this waveform is 
I 
I /l5 
p/oad 
QI.nn.< = 
= V /l5 
g 
(6.54) 
So the total active switch stress is 
(6.55) 
The load power Pload can be expressed in terms of V and I by solution of the equivalent circuit model, 
Fig. 6.33(b ). The result is 
p/oad= D'V h 
(6.56) 
Use of Eq. (6.44) to eliminate V8 from Eq. (6.55), and evaluation of Eq. (6.52), leads to 
U=D'/l5 
(6.57) 
The transistor utilization U tends to zero at D = 0 and at D = 1, and reaches a maximum of U = 0.385 at 
D = 113. 
For given values of Vg, V, and the load power, the designer can arbitrarily choose the duty cycle 
D. The turns ratio is then chosen to satisfy Eq. (6.44), as follows: 
V D' 
n= V, D 
(6.58) 
At low duty cycle, the transistor rms current becomes large because the transformer turns ratio must be 
large. At a duty cycle approaching one, the transistor peak voltage is large. So the choice D = 113 is a 
good one, which minimizes the product of peak transistor voltage and rms transistor current. In practice, 
the converter must be optimized to meet a number of different criteria, so a somewhat different duty 
cycle may be chosen. Also, the converter must usually be designed to operate with some given range of 
load powers and input voltages; this can lead to a different choice of D, as well as to reduced switch uti-
lization. 
For a simple comparison between converters, the switch utilizations of a number of isolated and 
nonisolated converters are collected in Table 6.1. For simplicity, the formulas assume that the converter 
is designed to function at a single operating point, that is, with no variations in Vg, V, or Pload· 
It can be seen that the nonisolated buck and boost converters operate most efficiently when their 
conversion ratios M(D) are near one. In the case of the boost converter, the switch utilization is greater 
than one forD < 0.382, and approaches infinity as D tends to zero. The reason for this is that, at D = 0, 
the transistor is always off and hence its rms current is zero. But at D = 0, V = Vg, so the output power is 
nonzero. All of the load power flows through the diode rather than the transistor. Of course, if it is desired 
that V = Vg, then it would be best to eliminate the boost converter, and directly connect the load to the 
input voltage. But it is nonetheless true that if the output voltage Vis not too much greater than Vg, then a 
large amount of power can be controlled by a relatively small transistor. Similar arguments apply to the 
buck converter: all of the load power must flow through the transistor and hence U:::; 1, yet converter effi-
ciency and cost per watt are optimized when the output voltage Vis not too much smaller than the input 
voltage. 

6.4 
Converter Evaluation and Design 
173 
Table 6.1 
Active switch utilizations of some common de-de converters, single operating point 
Converter 
Buck 
Boost 
Buck-boost, flyback, nonisolated SEPIC, 
isolated SEPIC, non isolated Cuk, isolated Cuk 
Forward, n1 = n2 
Other isolated buck-derived converters 
(full-bridge, half-bridge, push-pull) 
Isolated boost-derived converters 
(full-bridge, push-pull) 
U(D) 
D' 
.fl5 
D' .fl5 
lm 
2 
D' 
2JI +D 
max U(D) 
33J = 0.385 
- 1-=0.353 
2.f2 
2)z = 0.353 
I 2 
max U(D) 
occurs at D = 
0 
I 
3 
I 2 
0 
Incorporation of an isolation transformer leads to reduced switch utilization. In general, trans-
former-isolated buck-derived converters should be designed to operate at as large a duty cycle as other 
considerations will allow. Even so, the switch utilization is reduced to U ~ 0.353, meaning that the switch 
stress is increased by a factor of approximately 2.8 as compared with the nonisolated buck converter at 
D = l. On the other hand, the transformer turns ratio can be chosen to match the load voltage to the input 
voltage and better optimize the converter. For example, in a full-bridge buck-derived converter operating 
with Vg = 500 V and V = 5 V, the turns ratio could be chosen to be nearly 100:1, leading to a duty cycle 
close to one and switch utilization of approximately 0.35. To obtain a 1 kW output power, the total tran-
sistor stress would be 1 kW/0.35 = 2.86 kVA. By comparison, the nonisolated buck converter would 
operate with a duty cycle of0.01 and a switch utilization ofO.l. Its total switch stress would be 1 kW/0.1 
= 10 kVA; transistors with larger rated currents and lower on-resistances would be needed. Similar argu-
ments apply to the transformer-isolated boost-derived converters: these converters are better optimized 
when they operate at low duty cycles. 
The nonisolated buck-boost, nonisolated SEPIC, nonisolated Cuk converter, and the isolated 
SEPIC, flyback, and Cuk converters have similar switch utilizations. In all of these converters, 
U ~ 0.385, which is approximately the same as in the isolated buck-derived converters. So the noniso-
lated versions of these converters tend to have lower switch utilizations than the buck or boost convert-
ers; however, isolation can be obtained with no additional penalty in switch stress. Switch utilization of a 
single-operating-point design is maximized when the turns ratio is chosen such that D = 1/3. 
The cost of the active semiconductor devices of a converter approach can be estimated using the 
converter switch utilization, as follows: 
( 
) 
( semic~~~~~~~~ t~~e cost) 
semiconductor cost 
_ ,--'----------------'~ 
per kW output power - (voltage)( curr~nt )( con~erter) 
deratmg 
deratmg 
sw1tch 
factor 
factor 
utilization 
(6.59) 
The semiconductor device cost per rated kVA is equal to the cost of a semiconductor device, divided by 

174 
Converter Circuits 
the products of its maximum voltage rating and its maximum rms current capability, expressed in $/kVA. 
This figure depends on a variety of factors, including the device type, packaging, voltage and power lev-
els, and market volume. A typical U.S. value in 2000 is less than $1/kVA. Voltage and current derating is 
required to obtain reliable operation of the semiconductor devices. A typical design guideline is that the 
worst-case peak transistor voltage (including transients, voltage spikes due to ringing, and all other antic-
ipated events) should not exceed 75% of the rated transistor voltage, leading to a voltage derating factor 
of (0.75). Hence, the cost of the active semiconductor switches in a 2000 isolated de-de converter is typ-
ically in the range $1 to $10 per kW of output power for medium to high-power applications. 
6.4.2 
Design Using Computer Spreadsheet 
Computer spreadsheets are a useful tool for performing converter trade studies and designs. Given speci-
fications regarding the desired output voltage V, the ranges of the input voltage Vg and the load power 
Pload• the desired output voltage ripple dv, the switching frequency f,., etc., various design options can be 
explored. The transformer turns ratio and the inductor current ripple di can be taken as design variables, 
chosen by the engineer. The range of duty cycle variations and the inductor and capacitor component val-
ues can then be computed. Worst-case values of the currents and voltages applied to the various power-
stage elements can also be evaluated, as well as the sizes of the magnetic elements. By investigating sev-
eral choices of the design variables, a good compromise between the worst-case voltage stresses and cur-
rent stresses can be found. 
A short spreadsheet example is given in Table 6.2. The converter operates from a de voltage 
derived by rectifying a 230 V ± 20% ac source voltage. The converter de input voltage Vg is therefore 
230J2 V ± 20%. The load voltage is a regulated 15 V de, with switching ripple dv no greater than 0.1 V. 
The load power can vary over the range 20 W to 200 W. It is desired to operate with a switching fre-
quency of fs = 100 kHz. These values are entered as specifications, at the top of the spreadsheet. The 
design of a forward converter, Fig. 6.22, and of a ftyback converter, Fig. 6.30(d), to meet these specifica-
tions is investigated in the spreadsheet. Continuous conduction mode designs are investigated: the induc-
tor current ripple di is chosen small enough that the converter operates in CCM at full load power. 
Depending on the choice of di, the converter may operate in either CCM or DCM at minimum load 
power. 
For the single-transistor forward converter, the turns ratios n 2/n1 and n/n1, as well as the induc-
tor current ripple di, can be taken as design variables. For this example, the reset-winding turns ratio 
n2/n1 is chosen to be one, and hence the duty cycle is limited to D < 0.5 as given by Eq. (6.35). The max-
imum duty cycle is computed first. The output voltage of the forward converter, in continuous conduction 
mode, is given by Eq. (6.36). Solution for the duty cycleD leads to 
(6.60) 
The maximum value of D occurs at minimum Vg and at full load, and is given in Table 6.2. The minimum 
CCM value of D, occurring at maximum Vg, is also listed. 
The value of the inductance Lis computed next. The magnitude of the inductor current ripple di 
can be computed in a manner similar to that used for the nonisolated buck converter to obtain Eq. (2.15). 
The result is 
A._ D'VT, 
LJ.l--u 
(6.61) 

Table 6.2 Spreadsheet design example 
Specifications 
Maximum input voltage V8 
Minimum input voltage V8 
Output voltage V 
Maximum load power Pload 
Minimum load power Pload 
Switching frequency fs 
Maximum output ripple ~v 
Forward converter design, CCM 
Design variables 
Reset winding turns ratio n2/n 1 
Turns ratio n/n1 
390V 
260V 
15V 
200W 
20W 
lOOkHz 
0.1 v 
1 
0.125 
6.4 
Converter Evaluation and Design 
175 
Fly back converter design, CCM 
Design variables 
Turns ratio n2/n1 
Inductor current ripple ~i 
0.125 
3 A ref to sec 
Inductor current ripple ~i 
2A ref to sec 
Results 
Maximum duty cycle D 
Minimum D, at full load 
Minimum D, at minimum load 
Inductance L 
Capacitance C 
Worst-case stresses 
Peak transistor voltage v QI 
Rms transistor current 
Transistor utilization U 
Peak diode voltage v02 
Rms diode current i02 
Peak diode voltage v03 
Rms diode current i03 
Rms output capacitor current ic 
0.462 
0.308 
0.251 
261J.H 
251J.F 
780V 
1.13A 
0.226 
49V 
9.1 A 
49V 
11.1 A 
1.15 A 
Results 
Maximum duty cycle D 
Minimum D, at full load 
Minimum D, at minimum load 
Inductance L 
Capacitance C 
Worst-case stresses 
Peak transistor voltage v Ql 
Rms transistor current 
Transistor utilization U 
Peak diode voltage v01 
Rms diode current im 
Peak diode current im 
Rms output capacitor current ic 
0.316 
0.235 
0.179 
19 IJ.H ref to sec 
210 !J.F 
510V 
1.38A 
0.284 
64V 
16.3A 
22.2A 
9.1 A 
The worst-case maximum ripple occurs in CCM at minimum duty cycle. Solution for L yields 
L= D'VTs 
2~i 
(6.62) 
This equation is used to select L such that the worst-case ripple is equal to the specified value of lli. The 
required value of L is listed in Table 6.2. The required value of C that leads to the specified voltage ripple 
llv is also computed, using Eq. (2.60). Since Eq. (2.60) neglects capacitor esr, a larger value of C may be 
required in practice. 
If the converter operates in the discontinuous conduction mode at light load, then the controller 
must reduce the duty cycleD to maintain the required output voltage V. The conversion ratio M(D, K) of 
the DCM forward converter can be found analytically, using the method developed in the previous chap-
ter. Alternatively, the nonisolated buck converter solution, Eq. (5.29), can be applied directly if all ele-
ment values are referred to the transformer secondary side. Herice, the output voltage in DCM is given by 

176 
Converter Circuits 
(6.63) 
with K = 2URT,, and R = V2/P1oad· Solution for the duty cycleD yields 
(6.64) 
The actual duty cycle is the smaller of Eqs. (6.60) and (6.64). The minimum duty cycle occurs at mini-
mum load power and maximum Vg, and is given in Table 6.2. 
Worst-case component stresses can now be evaluated. The peak transistor voltage is given by 
Eq. (6.37). The rms transistor current is calculated with the help of Appendix 1. With the assumption that 
the transformer magnetizing current can be neglected, the transistor current is equal to the reflected 
inductor current i(t)n3/n 1 during subinterval!, and is equal to zero during subintervals 2 and 3. The rms 
transistor current is therefore 
(6.65) 
where I= Ploa/V. The worst-case value of !Ql-rms occurs at maximum load power and at maximum duty 
cycle. Expressions for the worst-case stresses in the diodes and output capacitor, as well as for the fly-
back converter, are found in a similar manner. Their derivation is left as an exercise for the student. 
The designs of Table 6.2 are good ones which illustrate the tradeoffs inherent in selection of an 
isolated converter topology, although some additional design optimization is possible and is left as a 
homework problem. Both designs utilize a turns ratio of 8:1. The rms transistor current is 22% higher in 
the flyback converter. This current could be reduced, at the expense of increased transistor voltage. The 
flyback converter imposes only 510 Von the transistor. A transistor rated at 800 V or 1000 V could be 
used, with an adequate voltage derating factor and some margin for voltage ringing due to transformer 
leakage inductance. The 780 V imposed on the transistor of the forward converter is 53% higher than in 
the flyback converter. Power MOSFETs with voltage ratings greater than 1000 V are not available in 
1997; hence, when voltage ringing due to transformer leakage inductance is accounted for, this design 
will have an inadequate voltage design margin. This problem could be overcome by changing the reset 
winding turns ratio n2/n 1, or by using a two-transistor forward converter. It can be concluded that the 
transformer reset mechanism of the fly back converter is better than that of the conventional forward con-
verter. 
Because of the pulsating nature of the secondary-side currents in the fly back converter, the rms 
and peak secondary currents are significantly higher than in the forward converter. The flyback converter 
diode must conduct an rms current that is 47% greater than that of forward converter diode D3 , and 80% 
greater than the current in forward converter diode D2. The secondary winding of the fly back transformer 
must also conduct this current. Furthermore, the output capacitor of the flyback converter must be rated 
to conduct an rms current of 9.1 A. This capacitor will be much more expensive than its counterpart in 
the forward converter. It can be concluded that the nonpulsating output current property of the forward 
converter is superior to the pulsating output current of the fly back. For these reasons, flyback converters 
and other converters having pulsating output currents are usually avoided when the application calls for a 
high-current output. 

6.5 
1. 
6.5 Summary of Key Points 
177 
SUMMARY OF KEY POINTS 
The boost converter can be viewed as an inverse buck converter, while the buck-boost and Cuk converters 
arise from cascade connections of buck and boost converters. The properties of these converters are consis-
tent with their origins. Ac outputs can be obtained by differential connection of the load. An infinite num-
ber of converters are possible, and several are listed in this chapter. 
2. 
For understanding the operation of most converters containing transformers, the transformer can be mod-
eled as a magnetizing inductance in parallel with an ideal transformer. The magnetizing inductance must 
obey all of the usual rules for inductors, including the principle of volt-second balance. 
3. 
The steady-state behavior of transformer-isolated converters may be understood by first replacing the 
transformer with the magnetizing-inductance-plus-ideal-transformer equivalent circuit. The techniques 
developed in the previous chapters can then be applied, including use of inductor volt-second balance and 
capacitor charge balance to find de currents and voltages, use of equivalent circuits to model losses and 
efficiency, and analysis of the discontinuous conduction mode. 
4. 
In the full-bridge, half-bridge, and push-pull isolated versions of the buck and/or boost converters, the 
transformer frequency is twice the output ripple frequency. The transformer is reset while it transfers 
energy: the applied voltage polarity alternates on successive switching periods. 
5. 
In the conventional forward converter, the transformer is reset while the transistor is off. The transformer 
magnetizing inductance operates in the discontinuous conduction mode, and the maximum duty cycle is 
limited. 
6. 
The flyback converter is based on the buck-boost converter. The flyback transformer is actually a two-
winding inductor, which stores and transfers energy. 
7. 
The transformer turns ratio is an extra degree-of-freedom which the designer can choose to optimize the 
converter design. Use of a computer spreadsheet is an effective way to determine how the choice of turns 
ratio affects the component voltage and current stresses. 
8. 
Total active switch stress, and active switch utilization, are two simplified figures-of-merit which can be 
used to compare the various converter circuits. 
REFERENCES 
[l] 
S. CUK, "Modeling, Analysis, and Design of Switching Converters," Ph.D. thesis, California Institute of 
Technology, November 1976. 
[2] 
S. CUK and R. D. MIDDLEBROOK, "A New Optimum Topology Switching De-to-De Converter," IEEE 
Power Electronics Specialists Conference, 1977 Record, pp. 160-179, June 1977. 
[3] 
E. LANDSMAN, "A Unifying Derivation of Switching De-De Converter Topologies," IEEE Power Electron-
ics Specialists Conference, 1979 Record, pp. 239-243, June 1979. 
[4] 
R. TYMERSKI and V. VORPERIAN, "Generation, Classification, and Analysis of Switched-Mode De-to-De 
Converters by the Use of Converter Cells," Proceedings International Telecommunications Energy Confer-
ence, pp. 181-195, October 1986. 
[5] 
S. CUK and R. ERICKSON, "A Conceptually New High-Frequency Switched-Mode Amplifier Technique 
Eliminates Current Ripple," Proceedings Fifth National Solid-State Power Conversion Conference (Pow-
ercon 5), pp. G3.1-G3.22, May 1978. 

178 
Converter Circuits 
[6] 
F. BARZEGAR and S. CUK, "A New Switched-Mode Amplifier Produces Clean Three-Phase Power," Pro-
r;eedings Ninth International Solid-State Power Conversion Conference (Powercon 9), pp. E3.1-E3.15, 
July 1982. 
[7] 
K. D. T. Noo, S. CUK, and R. D. MIDDLEBROOK, "A New Flyback De-to-Three-Phase Converter with 
Sinusoidal Outputs," IEEE Power Electronics Specialists Conference, 1983 Record, pp. 377-388. 
[8] 
R. W. ERICKSON, "Synthesis of Switched-Mode Converters," IEEE Power Electronics Specialists Confer-
ence, 1983 Record, pp. 9-22, June 1983. 
[9] 
D. MAKSIMOVIC and S. CUK, "General Properties and Synthesis ofPWM De-De Converters," IEEE Power 
Electronics Specialists Conference, 1989 Record, pp. 515-525, June 1989. 
[10] 
M. S. MAKOWSKI, "On Topological Assumptions on PWM Converters-A Reexamination," IEEE Power 
Electronics Specialists Conference, 1993 Record, pp. 141-147, June 1993. 
[11] 
B. ISRAELSEN, J. MARTIN, C. REEVE, and V. SCOWN, "A 2.5 kV High Reliability TWT Power Supply: 
Design Techniques for High Efficiency and Low Ripple," IEEE Power Electronics Specialists Conference, 
1977 Record, pp. 109-130, June 1977. 
[12] 
R. SEVERNS, "A New Current-Fed Converter Topology," IEEE Power Electronics Specialists Conference, 
1979 Record, pp. 277-283, June 1979. 
[13] 
V. J. THOTTUVELIL, T. G. WILSON, and H. A. OWEN, "Analysis and Design of a Push-Pull Current-Fed 
Converter," IEEE Power Electronics Specialists Conference, 1981 Record, pp. 192-203, June 1981. 
[14] 
R. REDL AND N. SOKAL, "Push-Pull Current-Fed Multiple-Output De-De Power Converter with Only 
One Inductor and with 0-100% Switch Duty Ratio," IEEE Power Electronics Specialists Conference, 
1980 Record, pp. 341-345, June 1982. 
[15] 
P. W. CLARKE, "Converter Regulation by Controlled Conduction Overlap," U. S. Patent 3,938,024, Febru-
ary 10, 1976. 
[16] 
R. P. MASSEY and E. C. SNYDER, "High-Voltage Single-Ended De-De Converter," IEEE Power Electron-
ics Specialists Conference, 1977 Record, pp. 156-159, June 1977. 
[17] 
D. MAKSIMOVIC and S. CuK, "Switching Converters with Wide De Conversion Range," IEEE Transac-
tions on Power Electronics, Vol. 6, No.1, pp. 151-157, January 1991. 
· [18] 
R. D. MIDDLEBROOK and S. CUK, "Isolation and Multiple Outputs of a New Optimum Topology Switch-
ing De-to-De Converter," IEEE Power Electronics Specialists Conference, 1978 Record, pp. 256-264, June 
13-15, 1978. 
[19] 
T. G. WILSON, "Cross Regulation in an Energy-Storage De-to-De Converter with Two Regulated Out-
puts," IEEE Power Electronics Specialists Conference, 1977 Record, pp. 190-199, June 1977. 
[20] 
H. MATSUO, "Comparison of Multiple-Output De-De Converters Using Cross Regulation," IEEE Power 
Electronics Specialists Conference, 1979 Record, pp. 169-185, June 1979. 
[21] 
K. HARADA, T. NABESHIMA, and K. HISANAGA, "State-Space Analysis of the Cross-Regulation," IEEE 
Power Electronics Specialists Conference, 1979 Record, pp. 186-192, June 1979. 

Problems 
179 
[22] 
J. N. PARK and T. R. ZALOUM, "A Dual Mode Forward/Flyback Converter," IEEE Power Electronics Spe-
cialists Conference, 1982 Record, pp. 3-13, June 1982. 
[23] 
S. CUK, "General Topological Properties of Switching Structures," IEEE Power Electronics Specialists 
Conference, 1979 Record, pp. 109-130, June 1979. 
[24] 
R. SEVERNS and G. BLOOM, Modern De-to-De Switchmode Power Converter Circuits, New York: Van 
Nostrand Reinhold, 1985. 
[25] 
N. MOHAN, T. UNDELAND, and W. ROBBINS, Power Electronics: Converters, Applications, and Design, 
2nd edit., New York: John Wiley & Sons, 1995. 
[26] 
J. KASSAKIAN, M. SCHLECHT, and G. VERGHESE, Principles of Power Electronics, Reading, MA: Addi-
son-Wesley, 1991. 
[27] 
D. MITCHELL, De-De Switching Regulator Analysis, New York: McGraw-Hill, 1988. 
[28] 
K. KIT SUM, Switch Mode Power Conversion: Basic Theory and Design, New York: Marcel Dekker, 1984. 
[29] 
R. E. TARTER, Solid-State Power Conversion Handbook, New York: John Wiley & Sons, 1993. 
[30] 
Q. CHEN, F. C. LEE, and M. M. JovANOVIC, "DC Analysis and Design of Multiple-Output Forward Con-
verters with Weighted Voltage-Mode Control," IEEE Applied Power Electronics Conference, 1993 Record, 
pp. 449-455, March 1993. 
PROBLEMS 
6.1 
Tapped-inductor 
boost converter. 
The 
boost converter is sometimes modified as 
illustrated in Fig. 6.41, to obtain a larger 
conversion ratio than would otherwise 
occur. The inductor winding contains a 
total of (n1 + n2) turns. The transistor is 
connected to a tap placed n1 turns from the 
left side of the inductor, as shown. The 
tapped inductor can be viewed as a two-
winding (n1: n2) transformer, in which the 
two windings are connected in series. The 
inductance of the entire (n1 + n2) turn 
winding is L. 
Fig. 6.41 
6.1 
ni 
n2 
turns turns 
,......-_,,......-_, 
+ 
R 
V 
Tapped-inductor boost converter, Problem 
(a) 
Sketch an equivalent circuit model for the tapped inductor, which includes a magnetizing induc-
tance and an ideal transformer. Label the values of the magnetizing inductance and turns ratio. 
(b) 
Determine an analytical expression for the conversion ratio M = V!V8 • You may assume that the 
transistor, diode, tapped inductor, and capacitor are lossless. You may also assume that the con-
verter operates in continuous conduction mode. 
(c) 
Sketch M(D) vs. D for n1 = n2, and compare to the nontapped (n2 = 0) case. 
6.2 
Analysis ofthe DCM flyback converter. The flyback converter of Fig. 6.30(d) operates in the discontinu-
ous conduction mode. 
(a) 
Model the fly back transformer as a magnetizing inductance in parallel with an ideal transformer, 

180 
Converter Circuits 
and sketch the converter circuits during the three subintervals. 
(b) 
Derive the conditions for operation in discontinuous conduction mode. 
(c) 
Solve the converter: derive expressions for the steady-state output voltage V and subinterval 2 
(diode conduction interval) duty cycle D2. 
6.3 
Analysis of the isolated inverse-SEPIC of Fig. 6.39. You may assume that the converter operates in the 
continuous conduction mode, and that all inductor current ripples and capacitor voltage ripples are 
small. 
(a) 
Derive expressions for the de components of the magnetizing current, inductor current, and 
capacitor voltages. 
(b) 
Derive analytical expressions for the rms values of the primary and secondary winding currents. 
Note that these quantities do not simply scale by the turns ratio. 
6.4 
The two-transistor flyback converter. The converter of Fig. 6.42 is sometimes used when the de input 
voltage is high. Transistors Q1 and Q2 are driven with the same gating signal, such that they turn on and 
off simultaneously with the same duty cycle D. Diodes D1 and D2 ensure that the off state voltages of the 
transistors do not exceed V8 . The converter operates in discontinuous conduction mode. The magnetiz-
ing inductance, referred to the primary side, is LM. 
Fig. 6.42 
Two-transistor fly-
back converter, Problem 6.4. 
+ 
(a) 
Determine an analytical expression for the steady-state output voltage V. 
c 
(b) 
Over what range of duty cycles does the transformer reset properly? Explain. 
+ 
R 
v 
6.5 
A nonideal fly back converter. The fly back converter shown in Fig. 6.30( d) operates in the continuous 
conduction mode. The MOSFET has on-resistance Ron, and the diode has a constant forward voltage 
drop Vv. The flyback transformer has primary winding resistance RP and secondary winding resistance 
R,. 
(a) 
Derive a complete steady-state equivalent circuit model, which is valid in the continuous con-
duction mode, and which correctly models the loss elements listed above as well as the converter 
input and output ports. Sketch your equivalent circuit. 
(b) 
Derive an analytical expression for the converter efficiency. 
6.6 
A low-voltage computer power supply with synchronous rectification. The trend in digital integrated cir-
cuits is towards lower power supply voltages. It is difficult to construct a high-efficiency low-voltage 
power supply, because the conduction loss arising in the secondary-side diodes becomes very large. The 
objective of this problem is to estimate how the efficiency of a forward converter varies as the output 
voltage is reduced, and to investigate the use of synchronous rectifiers. 
The forward converter of Fig. 6.22 operates from a de input of V8 = 325 V, and supplies 20 A to 
its de load. Consider three cases: (i) V = 5 V, (ii) V = 3.3 V, and (iii) V = 1.5 V. For each case, the turns 
ratio n/n1 is chosen such that the converter produces the required output voltage at a transistor duty 
cycle of D = 0.4. The MOSFET has on-resistance Ron = 5 Q. The secondary-side schottky diodes have 

Problems 
181 
forward voltage drops of VF = 0.5 V. All other elements can be considered ideal. 
(a) 
Derive an equivalent circuit for the forward converter, which models the semiconductor conduc-
tion losses described above. 
(b) 
Solve your model for cases (i), (ii), and (iii) described above. For each case, determine numeri-
cal values of the turns ratio n/n1 and for the efficiency TJ. 
(c) 
The secondary-side Schottky diodes are replaced by MOSFETs operating as synchronous recti-
fiers. The MOSFETs each have an on-resistance of 4 mQ. Determine the new numerical values 
of the turns ratio n3/n1 and the efficiency TJ, for cases (i), (ii), and (iii). 
6.7 
Rotation of switching cells. A network containing switches and reactive elements has terminals a, b, and 
c, as illustrated in Fig. 6.43(a). You are given that the relationship between the terminal voltages is 
VbJVac = p,(D). 
(a) 
A a 
b 
B 
(b) 
Fig. 6.43 Rotation of three-terminal switching cells, 
Problem 6.7 
(c) 
+ 
v 
1: n 
+ 
(a) 
Derive expressions for the source-to-load conversion ratio V/Vg = M(D), in terms of p,(D), for the 
following three connection schemes: 
(i) 
a-A b-B c-C 
(ii) 
a-B b-C c-A 
(iii) a-C b-A c-B 
(b) 
Consider the three-terminal network of Fig. 6.43(b). Determine p,(D) for this network. Plug your 
answer into your results from part (a), to verify that the buck, boost, and buck-boost converters 
are generated. 
(c) 
Consider the three-terminal network of Fig. 6.43(c). Determine p,(D) for this network. Plug your 
answer into your results from part (a). What converters are generated? 
6.8 
Transformer-isolated current-sense circuit. It is often required that the current flowing in a power transis-
tor be sensed. A noninductive resistor R placed in series with the transistor will produce a voltage v(t) 
that is proportional to the transistor drain current iv(t). Use of a transformer allows isolation between the 
power transistor and the control circuit. The transformer turns ratio also allows reduction of the current 
and power loss and increase of the voltage of the resistor. This problem is concerned with design of the 
transformer-isolated current-sense circuit of Fig. 6.44. 

182 
Converter Circuits 
Fig. 6.44 
Transformer-isolated circuit for sensing 
the transistor switch current, Problem 6.8 
R 
+ 
v(t) 
The transformer has a single-turn primary and an n-turn secondary winding. The transistor 
switches on and off with duty cycleD and switching frequency!,. While the transistor conducts, its cur-
rent is essentially constant and is equal to /. Diodes D 1 and D2 are conventional silicon diodes having 
forward voltage drop VD. Diode D2 is a zener diode, which can be modeled as a voltage source of value 
V2 , with the polarity indicated in the figure. For a proper design, the circuit elements should be chosen 
such that the transformer magnetizing current, in conjunction with diode D2, operates in discontinuous 
conduction mode. In a good design, the magnetizing current is much smaller than the transistor current. 
Three subintervals occur during each switching period: subinterval!, in which Q1 and D1 conduct; sub-
interval 2, in which D2 and D2 conduct; subinterval3, in which Qp D 1 and D2 are off. 
(a) 
Sketch the current sense circuit, replacing the transformer and zener diode by their equivalent 
circuits. 
(b) 
Sketch the waveforms of the transistor current iv(t), the transformer magnetizing current iM(t), 
the primary winding voltage, and the voltage v(t). Label salient features. 
(c) 
Determine the conditions on the zener voltage V2 that ensure that the transformer magnetizing 
current is reset to zero before the end of the switching period. 
(d) 
You are given the following specifications: 
Switching frequency 
Transistor duty cycle 
!,=100kHz 
D50.75 
Transistor peak current 
max i D (t) 5 25 A 
The output voltage v(t) should equal 5 V when the transistor current is 25 A. To avoid saturating 
the transformer core, the volt-seconds applied to the single-tum primary winding while the tran-
sistor conducts should be no greater than 2 volt-p,sec. The silicon diode forward voltage drops 
are Vv = 0.7 V. 
Design the circuit: select values of R, n, and V2 . 
6.9 
Optimal reset of the forward converter transformer. As illustrated in Fig. 6.45, it is possible to reset the 
transformer of the forward converter using a voltage source other than the de input V8 ; several such 
schemes appear in the literature. By optimally choosing the value of the reset voltage V,, the peak volt-
age stresses imposed on transistor Q1 and diode D2 can be reduced. The maximum duty cycle can also be 
increased, leading to a lower transformer turns ratio and lower transistor current. The resulting improve-
ment in converter cost and efficiency can be significant when the de input voltage varies over a wide 
range. 
(a) 
As a function of V8 , the transistor duty cycleD, and the transformer turns ratios, what is the min-
imum value of V, that causes the transformer magnetizing current to be reset to zero by the end 
of the switching period? 
(b) 
For your choice of V, from part (a), what is the peak voltage imposed on transistor Q1? 
This converter is to be used in a universal-input off-line application, with the following specifications. 
The input voltage V8 can vary between 127 and 380 V. The load voltage is regulated by variation of the 

Problems 
183 
+ 
R 
v 
+ 
Fig. 6.45 
Forward converter with auxiliary reset winding, Problem 6.9 
duty cycle, and is equal to 12 V. The load power is 480 W. 
(c) 
Choose the turns ratio n3/n 1 such that the total active switch stress is minimized. For your choice 
of n3/n 1, over what range will the duty cycle vary? What is the peak transistor current? 
(d) 
Compare your design of Part (c) with the conventional scheme in which n1 = n2 and V, = V8• 
Compare the worst-case peak transistor voltage and peak transistor current. 
(e) 
Suggest a way to implement the voltage source V,. Give a schematic of the power-stage compo-
nents of your implementation. Use a few sentences to describe the control-circuit functions 
required by your implementation, if any. 
6.10 
Design of a multiple-output de-de flyback converter. For this problem, you may neglect all losses and 
transformer leakage inductances. It is desired that the three-output fly back converter shown in Fig. 6.46 
operates in the discontinuous conduction mode, with a switching frequency off,= 100kHz. The nomi-
nal operating conditions are given in the diagram, and you may that there are no variations in the input 
voltage or the load currents. Select D3 = 0.1 (the duty cycle of subinterval 3, in which all semiconductors 
are off). The objective of this problem is to find a good steady-state design, in which the semiconductor 
peak blocking voltages and peak currents are reasonably low. 
vg 
+ 
165 V de 
Fig. 6.46 
Three-output fly back converter design, Problem 6.1 0. 

184 
Converter Circuits 
(a) 
It is possible to find a design in which the transistor peak blocking voltage is less than 300 V, and 
the peak diode blocking voltages are all less than 35 V, under steady-state conditions. Design the 
converter such that this is true. Specify: (i) the transistor duty cycle D, (ii) the magnetizing 
inductance LM, referred to the primary, (iii) the turns ratios n/np and n3/nP. 
(b) 
For your design of part (a), determine the rrns currents of the four windings. Note that they don't 
simply scale by the turns ratios. 
6.11 
Spreadsheet design. 
(a) 
Develop the analytical expressions for the "Results" and "Worst-case stresses" of the forward 
converter spreadsheet design example of Table 6.2. 
(b) 
Enter the formulas you developed in part (a) into a computer spreadsheet, and verify that your 
computed values agree with those of Table 6.2. 
(c) 
It is desired to reduce the forward converter peak transistor voltage to a value no greater than 
650 V. Modify the design numbers to accomplish this, and briefly discuss the effect on the other 
component stresses. 
(d) 
For these specifications, what is the largest possible value of the transistor utilization of the 
CCM forward converter? How should the spreadsheet design variables be chosen to attain the 
maximum transistor utilization? 
6.12 
Spreadsheet design of an isolated Cuk converter. The isolated Cuk converter of Fig. 6.40( c) is to be 
designed to meet the specifications listed in Table 6.2. The converter is to be designed such that it oper-
ates in continuous conduction mode at full load. 
(a) 
Develop analytical expressions for the following quantities: 
• The maximum and minimum duty cycles, for CCM operation 
• The peak voltages and rms currents of both semiconductor devices 
• The ripple magnitudes of the capacitor voltages and inductor currents 
• The rms capacitor currents 
• The transistor utilization U 
(b) 
Enter the formulas you developed in part (a) into a computer spreadsheet. What are the design 
variables? 
(c) 
For the specifications listed in Table 6.2, select the design variables to attain what you believe is 
the best design. Compare the performance of your design with the fl yback and forward converter 
designs of Table 6.2. 

Part II 
Converter Dynamics and Control 

7 
AC Equivalent Circuit Modeling 
7.1 
INTRODUCTION 
Converter systems invariably require feedback. For example, in a typical de-de converter application, the 
output voltage v(t) must be kept constant, regardless of changes in the input voltage vgCt) or in the effec-
tive load resistance R. This is accomplished by building a circuit that varies the converter control input 
[i.e., the duty cycle d(t)] in such a way that the output voltage v(t) is regulated to be equal to a desired ref-
erence value v ref" In inverter systems, a feedback loop causes the output voltage to follow a sinusoidal 
reference voltage. In modern low-harmonic rectifier systems, a control system causes the converter input 
current to be proportional to the input voltage, such that the input port presents a resistive load to the ac 
source. So feedback is commonly employed. 
A typical de-de system incorporating a buck converter and feedback loop block diagram is 
illustrated in Fig. 7.1. It is desired to design this feedback system in such a way that the output voltage is 
accurately regulated, and is insensitive to disturbances in vgCt) or in the load current. In addition, the 
feedback system should be stable, and properties such as transient overshoot, settling time, and steady-
state regulation should meet specifications. The ac modeling and design of converters and their control 
systems such as Fig. 7.1 is the subject of Part II of this book. 
To design the system of Fig. 7.1, we need a dynamic model of the switching converter. How do 
variations in the power input voltage, the load current, or the duty cycle affect the output voltage? What 
are the small-signal transfer functions? To answer these questions, we will extend the steady-state mod-
els developed in Chapters 2 and 3 to include the dynamics introduced by the inductors and capacitors of 
the converter. Dynamics of converters operating in the continuous conduction mode can be modeled 
using techniques quite similar to those of Chapters 2 and 3; the resulting ac equivalent circuits bear a 
strong resemblance to the de equivalent circuits derived in Chapter 3. 
Modeling is the representation of physical phenomena by mathematical means. In engineering, 

188 
AC Equivalent Circuit Modeling 
Power 
input 
Switching converter 
~-------------· ----· ...... ············----------··· ....................... : 
Load 
+ 
v(t) 
R 
Feedback 
connection 
r··--------------------------
------------------------------------------------------------------------------------------------, 
! Transistor 
! 
! gate driver 
! 
8(1)Dn_/ vc(t)C:.J Voltag' 
I 
reference vref 
! 
I 
: 
dT, T, 
1 
1 
! 
~--------------------------------------------------------------------------------------------------------------------------------: 
Controller 
Fig. 
7.1 
A simple de-de regulator system, including a buck converter power stage and a feedback network. 
it is desired to model the important dominant behavior of a system, while neglecting other insignificant 
phenomena. Simplified terminal equations of the component elements are used, and many aspects of the 
system response are neglected altogether, that is, they are "unmodeled." The resulting simplified model 
yields physical insight into the system behavior, which aids the engineer in designing the system to oper-
ate in a given specified manner. Thus, the modeling process involves use of approximations to neglect 
small but complicating phenomena, in an attempt to understand what is most important. Once this basic 
insight is gained, it may be desirable to carefully refine the model, by accounting for some of the previ-
ously ignored phenomena. It is a fact of life that real, physical systems are complex, and their detailed 
analysis can easily lead to an intractable and useless mathematical mess. Approximate models are an 
important tool for gaining understanding and physical insight. 
As discussed in Chapter 2, the switching ripple is small in a well-designed converter operating 
in continuous conduction mode (CCM). Hence, we should ignore the switching ripple, and model only 
the underlying ac variations in the converter waveforms. For example, suppose that some ac variation is 
introduced into the converter duty cycle d(t), such that 
(7.1) 
where D and Dm are constants, I Dm I « D, and the modulation frequency wm is much smaller than the 
converter switching frequency ws = 2nfs. The resulting transistor gate drive signal is illustrated in 
Fig. 7.2(a), and a typical converter output voltage waveform v(t) is illustrated in Fig. 7.2(b). The spec-
trum of v(t) is illustrated in Fig. 7.3. This spectrum contains components at the switching frequency as 
well as its harmonics and sidebands; these components are small in magnitude if the switching ripple is 
small. In addition, the spectrum contains a low-frequency component at the modulation frequency wm. 
The magnitude and phase of this component depend not only on the duty cycle variation, but also on the 
frequency response of the converter. If we neglect the switching ripple, then this low-frequency compo-

7.1 
Introduction 
189 
(a) 
(b) 
Gate 
drive 
-,,--, 
Actual waveform v(t) 
including ripple 
jJ 
Averaged waveform (v(t))T 
with ripple neglected ' 
Fig. 
7.2 
Ac variation of the converter signals: (a) transistor gate drive signal, in which the duty cycle varies 
slowly, and (b) the resulting converter output voltage waveform. Both the actual waveform v(t) (including high fre-
quency switching ripple) and its averaged, low-frequency component, (v(t))r,• are illustrated. 
Spectrum 
of v(t) 
Modulation 
frequency and its 
harmonics 
------
Switching 
frequency and 
sidebands 
....---..... 
Fig. 
7.3 Spectrum of the output voltage waveform v(t) of Fig. 7.2. 
Switching 
harmonics 
(!) 
nent remains [also illustrated in Fig. 7.2(b)]. The objective of our ac modeling efforts is to predict this 
low-frequency component. 
A simple method for deriving the small-signal model of CCM converters is explained in 
Section 7 .2. The switching ripples in the inductor current and capacitor voltage waveforms are removed 
by averaging over one switching period. Hence, the low-frequency components of the inductor and 
capacitor waveforms are modeled by equations of the form 
(7.2) 
where (x(t))r, denotes the average of x(t) over an interval of length T5 : 

190 
AC Equivalent Circuit Modeling 
(7.3) 
So we will employ the basic approximation of removing the high-frequency switching ripple by averag-
ing over one switching period. Yet the average value is allowed to vary from one switching period to the 
next, such that low-frequency variations are modeled. In effect, the "moving average" ofEq. (7.3) consti-
tutes low-pass filtering of the waveform. A few of the numerous references on averaged modeling of 
switching converters are listed at the end of this chapter [1-20]. 
Note that the principles of inductor volt-second balance and capacitor charge balance predict 
that the right-hand sides of Eqs. (7.2) are zero when the converter operates in equilibrium. Equations 
(7.2) describe how the inductor currents and capacitor voltages change when nonzero average inductor 
voltage and capacitor current are applied over a switching period. 
The averaged inductor voltage and capacitor currents of Eq. (7.2) are, in general, nonlinear 
functions of the signals in the converter, and hence Eqs. (7.2) constitute a set of nonlinear differential 
equations. Indeed, the spectrum in Fig. 7.3 also contains harmonics of the modulation frequency wm. In 
most converters, these harmonics become significant in magnitude as the modulation frequency wm 
approaches the switching frequency W5 , or as the modulation amplitude Dm approaches the quiescent 
duty cycle D. Nonlinear elements are not uncommon in electrical engineering; indeed, ail semiconductor 
devices exhibit nonlinear behavior. To obtain a linear model that is easier to analyze, we usuaiiy con-
struct a smaii-signal model that has been linearized about a quiescent operating point, in which the har-
monics of the modulation or excitation frequency are neglected. As an example, Fig. 7.4 iiiustrates 
linearization of the familiar diode i-v characteristic shown in Fig. 7 .4(b ). Suppose that the diode current 
i(t) has a quiescent (de) value I and a signal component i(t). As a result, the voltage v(t) across the diode 
has a quiescent value V and a signal component v(t). If the signal components are smaii compared to the 
quiescent values, 
(7.4) 
then the relationship between v(t) and z(t) is approximately linear, v(t) = r oi(t). The conductance l!r D 
(a) 
+ 
(b) 
v = V+v 
(c) 
+ 
i 
SA 
4A 
3A 
Actual 
Quiescent 
operating 
Linearized 
function 
point 
i(t) 
:: ·······································~ IVVJ 
o+-~~~~~~+-~~ 
0 
0.5V 
i 1 V 
v 
?-v(t) 
v 
Fig. 
7.4 
Small-signal equivalent circuit modeling of the diode: (a) a nonlinear diode conducting current i; (b) lin-
earization of the diode characteristic around a quiescent operating point; (c) a linearized small-signal model. 

0 
~ 
D 
0 ~--------~--------~--
-Vg ................................ . 
v 
7.1 
Introduction 
191 
Fig. 7.5 Linearization of the static control-to-
output characteristic of the buck-boost converter 
about the quiescent operating point D = 0.5. 
represents the slope of the diode characteristic, evaluated at the quiescent operating point. The small-sig-
nal equivalent circuit model of Fig. 7.4(c) describes the diode behavior for small variations around the 
quiescent operating point. 
An example of a nonlinear converter characteristic is the dependence of the steady-state output 
voltage Vof the buck-boost converter on the duty cycleD, illustrated in Fig. 7.5. Suppose that the con-
verter operates with some de o~tput voltage, say, V = - Vg, corresponding to a quiescent duty cycle of 
D = 0.5. Duty cycle variations d about this quiescent value will excite variations v in the output voltage. 
If the magnitude of the duty cycle variation is sufficiently small, then we can compute the resulting out-
put voltage variations by linearizing the curve. The slope of the linearized characteristic in Fig. 7.5 is 
chosen to be equal to the slope of the actual nonlinear characteristic at the quiescent operating point; this 
slope is the de control-to-output gain of the converter. The linearized and nonlinear characteristics are 
approximately equal in value provided that the duty cycle variations dare sufficiently small. 
Although it illustrates the process of small-signallinearization, the buck-boost example of Fig. 
7.5 is oversimplified. The inductors and capacitors of the converter cause the gain to exhibit a frequency 
response. To correctly predict the poles and zeroes of the small-signal transfer functions, we must linear-
ize the converter averaged differential equations, Eqs. (7.2). This is done in Section 7.2. A small-signal 
ac equivalent circuit can then be constructed using the methods developed in Chapter 3. The resulting 
small-signal model of the buck-boost converter is illustrated in Fig. 7.6; this model can be solved using 
conventional circuit analysis techniques, to find the small-signal transfer functions, output impedance, 
and other frequency-dependent properties. In systems such as Fig. 7.1, the equivalent circuit model can 
be inserted in place of the converter. When small-signal models of the other system elements (such as the 
+ 
c 
v(t) 
R 
Fig. 7.6 Small-signal ac equivalent circuit model of the buck-boost converter. 

192 
AC Equivalent Circuit Modeling 
pulse-width modulator) are inserted, then a complete linearized system model is obtained. This model 
can be analyzed using standard linear techniques, such as the Laplace transform, to gain insight into the 
behavior and properties of the system. 
Two well-known variants of the ac modeling method, state-space averaging and circuit averag-
ing, are explained in Sections 7.3 and 7 .4. An extension of circuit averaging, known as averaged switch 
modeling, is also discussed in Section 7.4. Since the switches are the only elements that introduce 
switching harmonics, equivalent circuit models can be derived by averaging only the switch waveforms. 
The converter models suitable for analysis or simulation are obtained simply by replacing the switches 
with the averaged switch model. The averaged switch modeling technique can be extended to other 
modes of operation such as the discontinuous conduction mode, as well as to current programmed con-
trol and to resonant converters. In Section 7.5, it is shown that the small-signal model of any de-de 
pulse-width modulated CCM converter can be written in a standard form. Called the canonical model, 
this equivalent circuit describes the basic physical functions that any of these converters must perform. A 
simple model of the pulse-width modulator circuit is described in Section 7 .6. 
These models are useless if you don't know how to apply them. So in Chapter 8, the frequency 
response of converters is explored, in a design-oriented and detailed manner. Small-signal transfer func-
tions of the basic converters are tabulated. Bode plots of converter transfer functions and impedances are 
derived in a simple, approximate manner, which allows insight to be gained into the origins of the fre-
quency response of complex converter systems. 
These results are used to design converter control systems in Chapter 9 and input filters in 
Chapter 10. The modeling techniques are extended in Chapters 11 and 12 to cover the discontinuous con-
duction mode and the current programmed mode. 
7.2 
THE BASIC AC MODELING APPROACH 
Let us derive a small-signal ac model of the buck-boost converter of Fig. 7.7. The analysis begins as 
usual, by determining the voltage and current waveforms of the inductor and capacitor. When the switch 
is in position 1, the circuit of Fig. 7.8(a) is obtained. The inductor voltage and capacitor current are: 
. (t) _ C dv(t) _ 
v(t) 
!c 
-
dt -- R 
(7.5) 
(7.6) 
We now make the small-ripple approximation. But rather than replacing vgCt) and v(t) with their de com-
ponents Vg and Vas in Chapter 2, we now replace them with their low-frequency averaged values (vgCt)\:, 
and (v(t))T,' defined by Eq. (7.3). Equations (7.5) and (7.6) then become 
2 
+ 
i(t) 
c 
R 
v(t) 
L 
Fig. 
7.7 
Buck-boost converter example. 

7.2 
The Basic AC Modeling Approach 
193 
R 
Fig. 7.8 
Buck-boost converter circuit: (a) when the switch is in position 1, (b) when the switch is in position 2. 
. ()-Cdv(t)_ 
(v(t)lr, 
lc t-
([t----R-
(7.7) 
(7.8) 
Hence, during the first subinterval, the inductor current i(t) and the capacitor voltage v(t) change with the 
essentially constant slopes given by Eqs. (7.7) and (7.8). With the switch in position 2, the circuit of 
Fig. 7.8(b) is obtained. Its inductor voltage and capacitor current are: 
di(t) 
vL(t) = L----;[( = v(t) 
(7.9) 
. (t) _ C dv(t) __ '( ) _ v(t) 
lc 
-
dt -
z t 
R 
(7.10) 
Use of the small-ripple approximation, to replace i(t) and v(t) with their averaged values, yields 
(7.11) 
. ( ) _ C dv(t) _ 
( '( )) 
( v(t) l r, 
lc t -
dt --
l t r,- --R-
(7 .12) 
During the second subinterval, the inductor current and capacitor voltage change with the essentially 
constant slopes given by Eqs. (7.11) and (7.12). 
7.2.1 
Averaging the Inductor Waveforms 
The inductor voltage and current waveforms are sketched in Fig. 7.9. The low-frequency average of the 
inductor voltage is found by evaluation of Eq. (7.3)-the inductor voltage during the first and second 
subintervals, given by Eqs. (7.7) and (7.11), are averaged: 
(7.13) 
where d'(t) = 1-d(t). The right-hand side of Eq. (7.13) contains no switching harmonics, and models 

194 
AC Equivalent Circuit Modeling 
(a) 
VL(t) (v.<tl)T 
..... / 
'........ 
.----
(vL(t))T, = d(v,(t)Jr, + d'(v(tl)r, 
0 ........ \ ......................................................... . 
dT, 
~s 
L 
7• 
(b) 
i(t) 
0 
Fig. 
7.9 
Buck-boost converter waveforms: 
(a) inductor voltage, (b) inductor current. 
only the low-frequency components of the inductor voltage waveform. Insertion of this equation into 
Eq. (7.2) leads to 
(7.14) 
This equation describes how the low-frequency components of the inductor current vary with time. 
7.2.2 
Discussion of the Averaging Approximation 
In steady-state, the actual inductor current waveform i(t) is periodic with period equal to the switching 
period T5 : i(t + T) = i(t). During transients, there is a net change in i(t) over one switching period. This 
net change in inductor current is correctly predicted by use of the average inductor voltage. We can show 
that this is true, based on the inductor equation 
(7.15) 
Divide by L, and integrate both sides from t to t + T5 : 
(7 .16) 
The left-hand side of Eq. (7.16) is i(t + T5)- i(t), while the right-hand side can be expressed in terms of 
the definition of (vL(t))r,• Eq. (7.3), by multiplying and dividing by Ts to obtain 
i(t + T,)- i(t) = f T, h<tJ) r, 
(7.17) 
The left-hand side of Eq. (7 .17) is the net change in inductor current over one complete switching period. 
Equation (7.17) states that this change is exactly equal to the switching period Ts multiplied by the aver-

7.2 
The Basic AC Modeling Approach 
195 
age slope (vL(t))T/L. 
Equation (7.17) can be rearranged to obtain 
L i(t + T,)- i(t) 
( ()) 
T, 
VL t T, 
(7.18) 
Let us now find the derivative of (i(t))18: 
d(i(t))T 
d ( 1 it+T,. 
) i(t + T)- i(t) 
---' =- -
!('t)d't = 
s 
dt 
dt T, , 
· 
T, 
(7.19) 
Substitution ofEq. (7.19) into (7.18) leads to 
(7.20) 
which coincides with Eq. (7.2). 
Let us next compute how the inductor current changes over one switching period in our buck-
boost example. The inductor current waveform is sketched in Fig. 7.9(b). Assume that the inductor cur-
rent begins at some arbitrary value i(O). During the first subinterval, the inductor current changes with 
the essentially constant value given by Eq. (7.7). The value at the end of the first subinterval is 
( h~)Ts) 
i(dT,) 
-------
i(O) -
+ 
~ 
(final value)= (initial value)+ (length of interval) (average slope) 
(7.21) 
During the second subinterval, the inductor current changes with the essentially constant value given by 
Eq. (7 .11 ). Hence, the value at the end of the second subinterval is 
((vC~)T,) 
i(T) -
i(dT,) 
-------
+ 
(d'T,) 
-------
~ 
(final value)= (initial value)+ (length of interval) (average slope) 
By substitution of Eq. (7.21) into Eq. (7.22), we can express i(T,) in terms of i(O), 
i(T,)=i(O)+ ~ (d(t)h(t))r, +d'(t)(v(t))r,) 
~ 
( VL(t)) T s 
(7.22) 
(7.23) 
Equations (7.21) to (7.23) are illustrated in Fig. 7.10. Equation (7.23) expresses the final value i(T,.) 
directly in terms of i(O), without the intermediate step of calculating i(D'I). This equation can be inter-
preted in the same manner as Eqs. (7.21) and (7.22): the final value i(T,) is equal to the initial value i(O), 
plus the length of the interval T8 multiplied by the average slope (vL(t))r./L. But note that the interval 
length is chosen to coincide with the switching period, such that the switching ripple is effectively 

196 
AC Equivalent Circuit Modeling 
Actual waveform, 
including ripple 
Averaged waveform 
Fig. 7.10 
Use of the average slope to predict 
how the inductor current waveform changes over 
one switching period. The actual waveform i(t) 
and its low-frequency component (i(t))r, are 
illustrated. 
i(t) 
(i(t))T 
__________ / 
_____ ' 
(b) 
0 
dh(t))T, +d'(v(t))T, 
L 
dT, 
(ic(t))r 
0 -------------------------- ___________ \: ____ ~--------- -------------
dTS 
T, 
L 
/.J 
(v(t)) 
- __ 
r, - (i(t)) 
R 
r, 
v(t) 
0+-------~------~---+ 
dT5 
v(dT,) 
( v(t)) T 
( i(t)) T v(T,) 
' 
s 
v(O) 
- ------w;--c-
Fig. 
7.11 
Buck-boost converter waveforms: (a) capacitor current, (b) capacitor voltage. 
removed. Also, the use of the average slope leads to correct prediction of the final value i(T5). It can be 
easily verified that, when Eq. (7.23) is inserted into Eq. (7.19), the previous result (7.14) is obtained. 
7.2.3 
Averaging the Capacitor Waveforms 
A similar procedure leads to the capacitor dynamic equation. The capacitor voltage and current wave-
forms are sketched in Fig. 7 .11. The average capacitor current can be found by averaging Eqs. (7 .8) and 
(7.12); the result is 
(icCtl) r, = d(t) (- (vC~) r,) + d'(t) (- (i(t) )T,- ( vC~) r,) 
(7.24) 
Upon inserting this equation into Eq. (7.2) and collecting terms, one obtains 

7.2 
The Basic AC Modeling Approach 
197 
Fig. 7.12 Buck-boost 
converter 
wave-
forms: input source current iit). 
.......................... ........ Yg~?.!.:.l ...... ........... .. 
0 
0~------L-------~----+ 
0 
d(vU)) 
(v(t)) 
C __ 
T, =- d'(t) (i(t)) - __ 
T, 
dt 
T, 
R 
(7.25) 
This is the basic averaged equation which describes de and low-frequency ac variations in the capacitor 
voltage. 
7.2.4 
The Average Input Current 
In Chapter 3, it was found to be necessary to write an additional equation that models the de component 
of the converter input current. This allowed the input port of the converter to be modeled by the de equiv-
alent circuit. A similar procedure must be followed here, so that low-frequency variations at the converter 
input port are modeled by the ac equivalent circuit. 
For the buck-boost converter example, the current igCt) drawn by the converter from the input 
source is equal to the inductor current i(t) during the first subinterval, and zero during the second sub-
interval. By neglecting the inductor current ripple and replacing i(t) with its averaged value (i(t))r,• we 
can express the input current as follows: 
. 
~ (i(t)) T during subinterval! 
l (t) = 
' 
8 
0 
during subinterval2 
(7.26) 
The input current waveform is illustrated in Fig. 7.12. Upon averaging over one switching period, one 
obtains 
(7.27) 
This is the basic averaged equation which describes de and low-frequency ac variations in the converter 
input current. 
7 .2.5 
Perturbation and Linearization 
The buck-boost converter averaged equations, Eqs. (7.14), (7.25), and (7.27), are collected below: 

198 
AC Equivalent Circuit Modeling 
d(i(t))T 
L-d-' = d(t) (vg(t)J 
+ d'(t) (v(t))T 
t 
~ 
s 
d(v(t)) 
(v(t)) 
C __ 
Ts =- d'(t) (i(t)) - __ 
T, 
dt 
T, 
R 
(7.28) 
These equations are nonlinear because they involve the multiplication of time-varying quantities. For 
example, the capacitor current depends on the product of the control input d'(t) and the low-frequency 
component of the inductor current, (i(t))T; Multiplication of time-varying signals generates harmonics, 
and is a nonlinear process. Most of the techniques of ac circuit analysis, such as the Laplace transform 
and other frequency-domain methods, are not useful for nonlinear systems. So we need to linearize 
Eqs. (7.28) by constructing a small-signal model. 
Suppose that we drive the converter at some steady-state, or quiescent, duty ratio d(t) = D, with 
quiescent input voltage v gCt) = Vg. We know from our steady-state analysis of Chapters 2 and 3 that, after 
any transients have subsided, the inductor current (i(t))r,, the capacitor voltage (v(t))r,, and the input cur-
rent (igCt))Ts will reach the quiescent values/, V, and Ig, respectively, where 
(7.29) 
Equations (7.29) are derived as usual via the principles of inductor volt-second and capacitor charge bal-
ance. They could also be derived from Eqs. (7.28) by noting that, in steady state, the derivatives must 
equal zero. 
To construct a small-signal ac model at a quiescent operating point (I, V), one assumes tbat the 
input voltage vgCt) and the duty cycle d(t) arAe equal to some given quiescent values Vg and D, plus some 
superimposed small ac variations OgCt) and d(t). Hence, we have 
(7.30) 
In response to these inputs, and after any transients have subsided, the averaged inductor current (i(t) )r,, 
the averaged capacitor voltage (v(t))r,, and the averaged input current (igCt))Ts waveforms will be equal to 
the corresponding quiescent values/, V, and Ig, plus some superimposed small ac variations i(t), O(t), and 
igCt): 
(iCt))T =I+i(t) 
s 
(v(t))T =V+v(t) 
s 
(7.31) 
(i8(t)JT,=f8 +i8(t) 
With the assumptions tbat the ac variations are small in magnitude compared to the de quiescent values, 
or 

7.2 
The Basic AC Modeling Approach 
199 
hu) I « I vg I 
IJct)l « IDI 
I i(t) I« III 
(7.32) 
I oct) I « I vI 
l1it)l « 11gl 
then the nonlinear equations (7.28) can be linearized. This is done by inserting Eqs. (7.30) and (7.31) 
into Eq. (7.28). For the inductor equation, one obtains 
(7.33) 
It should be noted that the complement of the duty cycle is given by 
d'(t) = ( 1 - d(t)) = 1 - ( D + d (t)) = D'- d (t) 
(7.34) 
where D' = 1 -D. The minus sign arises in the expression for d'(t) because a d(t) variation that causes 
d(t) to increase will cause d' (t) to decrease. 
By multiplying out Eq. (7.33) and collecting terms, one obtains 
De terms 
1st order ac terms 
(linear) 
2"d order ac terms 
(nonlinear) 
The derivative of I is zero, since I is by definition a de (constant) term. For the purposes of deriving a 
small-signal ac model, the de terms can be considered known constant quantities. On the right-hand side 
of Eq. (7 .35), three types of terms arise: 
De terms: These terms contain de quantities only. 
First-order ac terms: Each of these terms contains a single ac quantity, usually multiplied by a constant 
coefficient such as a de term. These terms are linear functions of the ac variations. 
Second-order ac terms: These terms contain the products of ac quantities. Hence they are nonlinear, 
because they involve the multiplication of time-varying signals. 
It is desired to neglect the nonlinear ac terms. Provided that the small-signal assumption, Eq. (7.32), is 
satisfied, then each of the second-order nonlinear terms is much smaller in magnitude that one or more of 
the linear first-order ac terms. For example, the second-order ac term d(t)vgCt) is much smaller in magni-
tude than the first-order ac term DvgCt) whenever I d(t) I «D. So we can neglect the second-order terms. 
Also, by definition [or by use of Eq. (7.29)], the de terms on the right-hand side of the equation are equal 
to the de terms on the left-hand side, or zero. 
We are left with the first-order ac terms on both sides of the equation. Hence, 
di(t) 
' 
,, 
. ( 
) ' 
L 1ft= Dvg(t) + D v(t) + Vg- V d(t) 
(7.36) 

200 
AC Equivalent Circuit Modeling 
This is the desired result: the small-signal linearized equation that describes variations in the inductor 
current. 
The capacitor equation can be linearized in a similar manner. Insertion ofEqs. (7.30) and (7.31) 
into the capacitor equation of Eq. (7.28) yields 
d( v + O(t)) 
( ' 
A 
) 
( 
• 
) 
( v + O(t)) 
C 
dt 
-
D -d(t) l+t(t)-
R 
Upon multiplying out Eq. (7.37) and collecting terms, one obtains 
( dv 
dO(t)) 
( 
, 
v) 
( 
,. 
O(t) 
A 
) 
C Tt+---;.rt = -DI-R + -Dt(t)-R+ld(t) + 
~~ 
De terms 
1" order ae terms 
(linear) 
d (t)i(t) 
~ 
2"d order ae term 
(nonlinear) 
(7.37) 
(7.38) 
By neglecting the second-order terms, and noting that the de terms on both sides of the equation are 
equal, we again obtain a linearized first-order equation, containing only the first-order ac terms of 
Eq. (7.38): 
C dv(t) =- D'i(t)- O(t) +I d(t) 
dt 
R 
(7.39) 
This is the desired small-signallinearized equation that describes variations in the capacitor voltage. 
Finally, the equation of the average input current is also linearized. Insertion of Eqs. (7.30) and 
(7.31) into the input current equation ofEq. (7.28) yields 
By collecting terms, we obtain 
= (m) + (oi(t)+IdCt)) + 
'----v--' 
~ 
De term 
1 ' 1 order ae term 
De term 
1 '' order ae terms 
(linear) 
d(t)i(t) 
~ 
2"d order ae term 
(nonlinear) 
(7.40) 
(7.41) 
We again neglect the second-order nonlinear terms. The de terms on both sides of the equation are equal. 
The remaining first-order linear ac terms are 
ig(t) = Di(t) + Jd(t) 
(7.42) 
This is the linearized small-signal equation that describes the low-frequency ac components of the con-
verter input current. 
In summary, the nonlinear averaged equations of a switching converter can be linearized about a 
quiescent operating point. The converter independent inputs are expressed as constant (de) values, plus 
small ae variations. In response, the converter averaged waveforms assume similar forms. Insertion of 
Eqs. (7.30) and (7.31) into the converter averaged nonlinear equations yields de terms, linear ac terms, 
and nonlinear terms. If the ac variations are sufficiently small in magnitude, then the nonlinear terms are 

7.2 
The Basic AC Modeling Approach 
201 
much smaller than the linear ac terms, and so can be neglected. The remaining linear ac terms comprise 
the small-signal.ac model of the converter. 
7.2.6 
Construction of the Small-Signal Equivalent Circuit Model 
Equations (7.36), (7.39), and (7.42) are the small-signal ac description of the ideal buck-boost converter, 
and are collected below: 
di(t) 
( 
) 
A 
L lit= DfWl + D'v(t) + V8 - V d(t) 
C d~~) =- D'z(t)- v~) +I d(t) 
(7.43) 
z 
8(t) = Di(t) +I d(t) 
In Chapter 3, we collected the averaged de equations of a converter, and reconstructed an equivalent cir-
cuit that modeled the de properties of the converter. We can use the same procedure here, to construct 
averaged small-signal ac models of converters. 
The inductor equation of (7.43), or Eq. (7.36), describes the voltages around a loop containing 
the inductor. Indeed, this equation was derived by finding the inductor voltage via loop analysis, then 
averaging, perturbing, and linearizing. So the equation represents the voltages around a loop of the 
small-signal model, which contains the inductor. The loop current is the small-signal ac inductor current 
i(t). As illustrated in Fig. 7.13, the term Ldi(t)ldt represents the voltage across the inductor Lin the 
small-signal model. This voltage is equal to three other voltage terms. DvgCt) and D'v(t) represent d~pen­
dent sources as shown. The~e terms will be combined into ideal transformers. The term (V8 - V)d(t) is 
driven by the control input d(t), and is represented by an independent source as shown. 
The capacitor equation of (7.43), or Eq. (7.39), describes the currents flowing into a node 
attached to the capacitor. This equation was derived by finding the capacitor current via node analysis, 
then averaging, perturbing, and linearizing. Hence, this equation describes the currents flowing into a 
node of the small-signal model, attached to the capacitor. As illustrated in Fig. 7.14, the term Cdv(t)ldt 
represents the current flowing through capacitor C in the small-signal model. The capacitor voltage is 
v(t). According to the equation, this current is equal to three other terms. The term- D'i(t) represents a 
dependent source, which will eventually be combined into an ideal transformer. The term- v(t)IR is rec-
D'v(t) 
Fig. 
7.13 Circuit equivalent to the small-signal ac inductor loop equation ofEq. (7.43) or (7.36). 

202 
AC Equivalent Circuit Modeling 
C dO(t) 
dt 
c 
+ 
O(t) 
O(t) 
R 
R 
Fig. 7.14 Circuit equivalent to the small-signal ac capacitor node equation ofEq. (7.43) or (7.39). 
!d(t) 
Di(t) 
Fig. 
7.15 Circuit equivalent to the small-signal ac input source current equation ofEq. (7.43) or (7.42). 
ognized as the current flowing through the load resistor in the small-signafmodel. The resistor is con-
nected in parallel with the capacitor, such that the ac voltage across the resistor R is O(t) as expected. The 
term !d(t) is driven by the control input d(t), and is represented by an independent source as shown. 
Finally, the input current equation of (7.43), or Eq. (7.42), describes the small-signal ac current 
ig(t) drawn by the converter out of the input voltage source 0 gCt). This is a node equation which states that 
!gCt) is equal to the currents in two branches, as illustrated in Fig. 7.15. The first branch, corresponding to 
the Di(t) term, is dependent on the ac inductor current i(t). Hence, we represent this term using a depen-
dent current source; this source will eventually be incorporated into an ideal transformer. The second 
branch, corresponding to the !d(t) term, is driven by the control input d(t), and is represented by an inde-
pendent source as shown. 
The circuits of Figs. 7.13, 7.14, and 7.15 are collected in Fig. 7.16(a). As discussed in Chapter 
3, the dependent sources can be combined into effective ideal transformers, as illustrated in Fig. 7.16(b). 
The sinusoid superimposed on the transformer symbol indicates that the transformer is ideal, and is part 
of the averaged small-signal ac model. So the effective de transformer property of CCM de-de converters 
also influences small-signal ac variations in the converter signals. 
The equivalent circuit of Fig. 7.16(b) can now be solved using techniques of conventional linear 
circuit analysis, to find the converter transfer functions, input and output impedances, etc. This is done in 
detail in the next chapter. Also, the model can be refined by inclusion of losses and other nonidealities-
an example is given in Section 7.2.9. 
7 .2. 7 
Discussion of the Perturbation and Linearization Step 
In the perturbation and linearization step, it is assumed that an averaged voltage or current consists of a 
constant (de) component and a small-signal ac variation around the de component. In Section 7.2.5, the 

7.2 
The Basic AC Modeling Approach 
203 
(a) 
L 
(v,- v)d(t) 
+ 
c 
v(t) 
R 
(b) 
L 
( v,- v)dUJ 
+ 
c v(t) 
R 
Fig. 
7.16 Buck-boost converter small-signal ac equivalent circuit: (a) the circuits of Figs. 7.13 to 7.15, collected 
together; (b) combination of dependent sources into effective ideal transformer, leading to the final model. 
linearization step was completed by neglecting nonlinear terms that correspond to products of the small-
signal ac variations. In general, the linearization step amounts to taking the Taylor expansion of a nonlin-
ear relation and retaining only the constant and linear terms. For example, the large-signal averaged 
equation for the inductor current in Eq. (7.28) can be written as: 
d(i(t))T 
( 
) 
L -d-' = d(t) (v gCtJ) + d'(t) ( v(t)) T = / 1 (v gCtJ) , ( v(t)) T , d(t) 
t 
Ts 
.1 
Ts 
.s 
(7.44) 
Let us expand this expression in a three-dimensional Taylor series, about the quiescent operating point 
(Vg, V, D): 
(7.45) 
+ higher-order nonlinear terms 
For simplicity of notation, the angle brackets denoting average values are dropped in the above equation. 
The derivative of I is zero, since I is by definition a de (constant) term. Equating the de terms on both 
sides of Eq. (7 .45) gives: 
(7.46) 
which is the volt-second balance relationship for the inductor. The coefficients with the linear terms on 
the right-hand side of Eq. (7 .45) are found as follows: 

204 
AC Equivalent Circuit Modeling 
(7.47) 
(7.48) 
(7.49) 
Using (7.47), (7.48) and (7.49), neglecting higher-order nonlinear terms, and equating the linear ac terms 
on both sides ofEq. (7.45) gives: 
di(t) 
( 
) 
A 
L ---;It= Dvg(t) + D'v(t) + V8 - v d(t) 
(7.50) 
which is identical to Eq. (7.36) derived in Section 7.2.5. In conclusion, the linearization step can always 
be accomplished using the Taylor expansion. 
7.2.8 
Results for Several Basic Converters 
The equivalent circuit models for the buck, boost, and buck-boost converters operating in the continuous 
conduction mode are summarized in Fig. 7.17. The buck and boost converter models contain ideal trans-
formers having turns ratios equal to the converter conversion ratio. The buck-boost converter contains 
ideal transformers having buck and boost conversion ratios; this is consistent with the derivation of Sec-
tion 6.1.2 of the buck -boost converter as a cascade connection of buck and boost converters. These mod-
els can be solved to find the converter transfer functions, input and output impedances, inductor current 
variations, etc. By insertion of appropriate turns ratios, the equivalent circuits of Fig. 7.17 can be adapted 
to model the transformer-isolated versions of the buck, boost, and buck-boost converters, including the 
forward, fiyback, and other converters. 
7.2.9 
Example: A Nonideal Flyback Converter 
To illustrate that the techniques of the previous section are useful for modeling a variety of converter 
phenomena, let us next derive a small-signal ac equivalent circuit of a converter containing transformer 
isolation and resistive losses. An isolated fiyback converter is illustrated in Fig. 7.18. The fiyback trans-
former has magnetizing inductance L,.referred to the primary winding, and turns ratio 1:n. MOSFET Q1 
has on-resistance Ron· Other loss elements, as well as the transformer leakage inductances and the 
switching losses, are negligible. The ac modeling of this converter begins in a manner similar to the de 
converter analysis of Section 6.3.4. The fiyback transformer is replaced by an equivalent circuit consist-
ing of the magnetizing inductance Lin parallel with an ideal transformer, as illustrated in Fig. 7.19(a). 
During the first subinterval, when MOSFET Q1 conducts, diode D 1 is off. The circuit then 

7.2 
The Basic AC Modeling Approach 
205 
(a) 
+ 
R 
v(t) 
(b) 
+ 
R 
v(t) 
(c) 
( v,- v)d(t) 
L 
+ 
c 
v(t) 
R 
Fig. 7.17 
Averaged small-signal ac models for several basic converters operating in continuous conduction 
mode: (a) buck, (b) boost, (c) buck-boost. 
+ 
L 
c 
R 
v(t) 
-1 
Fig. 7.18 
Fly back converter example. 

206 
AC Equivalent Circuit Modeling 
(a) 
+ 
R 
v(t) 
(b) 
r·······································; 
! Transformer model ! 
+ 
+ 
c 
R 
v 
(c) 
i/n 
+ 
+ 
c 
R 
v 
, _____________________________________ L. 
___ -< 
__ ,,__ __ _._ __ 
...J 
Fig. 7.19 Flyback converter example: (a) incorporation of transformer equivalent circuit, (b) circuit during sub-
interval I, (c) circuit during subinterval 2. 
reduces to Fig. 7.19(b). The inductor voltage vL(t), capacitor current idt), and converter input current 
igCt) are: 
vL(t) = vgCt)- i(t)Ron 
ic(t) =- v~) 
ig(t) = i(t) 
(7.51) 
We next make the small ripple approximation, replacing the yoltages and currents with their average val-

7.2 · The Basic AC Modeling Approach 
207 
ues as defined by Eq. (7.3), to obtain 
(7.52) 
During the second subinterval, MOSFET Q1 is off, diode D1 conducts, and the circuit of Fig. 7.19(c) is 
obtained. Analysis of this circuit shows that the inductor voltage, capacitor current, and input current are 
given by 
The small-ripple approximation leads to 
(t) _ 
v(t) 
VL 
-- n 
. ( ) _ i(t) 
v(t) 
let ---n-R 
ig(t) = 0 
(v(t))T 
vL(t) =--n-' 
(i(t))T 
(v(t))T 
ic(t) = -n-'-~ 
ig(t) = 0 
(7.53) 
(7.54) 
The inductor voltage and current waveforms are sketched in Fig. 7.20. The average inductor voltage can 
now be found by averaging the waveform of Fig. 7.20(a) over one switching period. The result is 
(a) 
v-iR 
g 
011 
h<t))T 
0 ....................................... \ ...... ~ ................... . 
dT8 
T8 
t 
1... 
.. J 
-vln 
(b) 
i(t) 
0 
Fig. 7.20 Inductor waveforms for the flyback example: (a) inductor voltage, (b) inductor current. 

208 
AC Equivalent Circuit Modeling 
(a) 
ic(t) 
(ic(t))r 
0 
_________ \ ______ ' 
dTs 
Ts L_ 
(b) 
v(t) 
0 
dTs 
Fig. 7.21 
Capacitor waveforms for the flyback example: (a) capacitor current, (b) capacitor voltage. 
By inserting this result into Eq. (7.20), we obtain the averaged inductor equation, 
d(i(t))T, 
_ 
, 
(v(t))T, 
L -d-t - = d(t) ( vg{t)) r,- d(t) (1(t)) T, R00 - d (t) -n--
The capacitor waveforms are constructed in Fig. 7.21. The average capacitor current is 
( - (v(t)) ) 
( (iCt)) 
(vCt)) ) 
(ic(t))r, =d(t) 
R r, +d'(t) ~-~ 
This leads to the averaged capacitor equation 
(7.58) 
The converter input current igCt) is sketched in Fig. 7.22. 
Its average is 
igCt) 
(i(t))T 
.... ./ 
~-
.......................... ......... \i.g~?)_:.L_ __ _ 
(7.55) 
(7.56) 
(7.57) 
(7.59) 
0 
01------.L.------L--
The averaged converter equations (7.56), (7.58) and 
(7.59) are collected below: 
0 
dTs 
Fig. 7.22 Input source current waveform, 
fly back example. 

7.2 
The Basic AC Modeling Approach 
209 
d(i(t))T 
(v(t))T 
L _d_s = d(t) (vg(t)) -d(t) (i(t))T Ron -d'(t) -n-' 
f 
Ts 
s 
d(v(t))T 
(i(t))T 
(v(t))T 
(7.60) 
C~=d'(t)-n-'-~ 
This is a nonlinear set of differential equations, and hence the next step is to perturb and linearize, to con-
struct the converter small-signal ac equations. We assume that the converter input voltage vgCt) and duty 
cycle d(t) can be expressed as quiescent values plus small ac variations, as follows: 
(vgCtl)T, = V8 + vg(t) 
d(t) = D + d(t) 
(7.61) 
In response to these inputs, and after all transients have decayed, the average converter waveforms can 
also be expressed as quiescent values plus small ac variations: 
(i(t))T =I+ z(t) 
s 
(v(t))T =V+v(t) 
s 
(ig(t)) T, =I 8 + l g{t) 
With these substitutions, the large-signal averaged inductor equation becomes 
Upon multiplying this expression out and collecting terms, we obtain 
De terms 
+ 
1" order ac terms (linear) 
( d(t)vg(t) + d(t) v~)- d(t)i(t)R 0 ,) 
~ 
2"d order ac terms (nonlinear) 
(7.62) 
(7.64) 
As usual, this equation contains three types of terms. The de terms contain no time-varying quantities. 
The first-order ac terms are linear functions of the ac variations in the circuit, while the second-order ac 
terms are functions of the products of the ac variations. If the small-signal assumptions of Eq. (7 .32) are 
satisfied, then the second-order terms are much smaller in magnitude that the first-order terms, and hence 
can be neglected. The de terms must satisfy 

210 
AC Equivalent Circuit Modeling 
(7.65) 
This result could also be derived by applying the principle of inductor volt-second balance to the steady-
state inductor voltage waveform. The first-order ac terms must satisfy 
(7.66) 
This is the linearized equation that describes ac variations in the inductor current. 
Upon substitution of Eqs. (7.61) and (7.62) into the averaged capacitor equation (7.60), one 
obtains 
d(V+v(t))_(, 
, 
)(I+iCt)) 
(v+v(t)) 
C 
dt 
-
D -d(t) --n--
R 
By collecting terms, we obtain 
c(dv + dv(t)) = (D'I _Y) + (v'i(t) _ v(t) _IJ(t)) _ 
dt 
dt 
n 
R 
n 
R 
n 
________.., ~ 
De terms 
1 st order ae terms 
(linear) 
J(t)i(t) 
-n-
-----...-.-
2nd order ae term 
(nonlinear) 
We neglect the second-order terms. The de terms of Eq. (7 .68) must satisfy 
0- (D'I _Y) 
-
n 
R 
(7.67) 
(7.68) 
(7.69) 
This result could also be obtained by use of the principle of capacitor charge balance on the steady-state 
capacitor current waveform. The first-order ac terms of Eq. (7.68) lead to the small-signal ac capacitor 
equation 
c dv(t) _ D'i(t) _ v(t) _ 1 Jet) 
dt -
n 
R 
n 
Substitution of Eqs. (7.61) and (7.62) into the averaged input current equation (7.60) leads to 
Upon collecting terms, we obtain 
= (DI) + (Di(t)+IJ(t)) + 
~~ 
De term 
1st order,ae term 
De term 
1." order ae terms 
(linear) 
The de terms must satisfy 
d(t)i(t) 
'--v---' 
znd order ac term 
(nonlinear) 
(7.70) 
(7.71) 
(7.72) 

7.2 The Basic AC Modeling Approach 
211 
Fig. 7.23 Circuit equivalent 
to the small-signal ac inductor 
loop equation, Eq. (7.76) or 
. (7.66). 
L 
(7.73) 
We neglect the second-order nonlinear terms ofEq. (7.72), leaving the following linearized ac equation: 
i g(t) = Di(t) +I J(t) 
(7.74) 
This result models the low-frequency ac variations in the converter input current. 
The equations of the quiescent values, Eqs. (7.65), (7.69), and (7.73) are collected below: 
O=DVg-D'*-DR0,l 
0=(~?-*) 
(7.75) 
lg=Dl 
For given quiescent values of the input voltage Vg and duty cycleD, this system of equations can be eval-
uated to find the quiescent output voltage V, inductor current I, and input current de component lg. The 
results are then inserted into the small-signal ac equations. 
The small-signal ac equations, Eqs. (7.66), (7.70), and (7.74), are summarized below: 
di(t) 
A 
,v(t) 
( 
v 
) A 
.~ 
L 1ft= Dvg(t)- D 71 + Vg + n- IR011 d(t)- DR011l(t) 
c dv(t) _ D'i(t) _ v(t) _I J(t) 
dt -
n 
R 
. n 
(7.76) 
i g(t) = Di(t) +I J(t) 
The final step is to construct an equivalent circuit that corresponds to these equations. 
The inductor equation was derived by first writing loop equations, to find the applied inductor 
voltage during each subinterval. These equations were then averaged, perturbed, and linearized, to obtain 
Eq. (7.66). So this equation describes the small-signal ac voltages around a loop containing the inductor. 
The loop current is the ac inductor current i(t). The quantity Ldi(t)ldt is the low-frequency ac voltage 
across the inductor. The four terms on the right-hand side of the equation are the voltages across the four 
other elements in the loop. The terms DvgCt) and- D'v(t)ln are dependent on voltages elsewhere in the 
converter, and hence are represented as dependent sources in Fig. 7.23. The third term is driven by the 
duty cycle variations d(t) and hence is represented as an independent source. The fourth term, - DRani(t), 
is a voltage that is proportional to the loop current i(t). Hence this term obeys Ohm's law, with effective 
resistance DRan as shown in the figure. So the influence of the MOSFET on-resistance on the converter 

212 
AC Equivalent Circuit Modeling 
Fig. 7.24 Circuit 
equivalent 
to the small-signal ac capacitor 
node equation, Eq. (7.76) or 
(7.70). 
Fig. 7.25 Circuit equivalent 
to the small-signal ac input 
source current equation, Eq. 
(7.76) or (7.74). 
c dv(t) 
dt 
D'i(t) 
c 
-n-
Ia(t) 
Di(t) 
small-signal transfer functions is modeled by an effective resistance of value DR on· 
+ 
v(t) 
R 
v(t) 
R 
Small-signal capacitor equation (7.70) leads to the equivalent circuit of Fig. 7.24. The equation 
constitutes a node equation of the equivalent circuit model. It states that the capacitor current Cdv(t)ldt is 
equal to three other currents. The current D'i(t)/n depends on a current elsewhere in the model, and hence 
is represented by a dependent current source. The term - v(t)/R is the ac component of the load current, 
which we model with a load resistance R connected in parallel with the capacitor. The last term is driven 
by the duty cycle variations a(t), and is modeled by an independent source. 
The input port equation, Eq. (7.74), also constitutes a node equation. It describes the small-sig-
nal ac current igCt), drawn by the converter out of the input voltage source vgCt). There are two other terms 
in the equation. The term Di(t) is dependent on the inductor current ac variation i(t), and is represented 
with a dependent source. The term Ia(t) is driven by the control variations, and is modeled by an inde-
pendent source. The equivalent circuit for the input port is illustrated in Fig. 7.25. 
The circuits of Figs. 7.23, 7.24, and 7.25 are combined in Fig. 7.26. The dependent sources can 
be replaced by ideal transformers, leading to the equivalent circuit of Fig. 7.27. This is the desired result: 
an equivalent circuit that models the low-frequency small-signal variations in the converter waveforms. It 
can now be solved, using conventional linear circuit analysis techniques, to find the converter transfer 
functions, output impedance, and other ac quantities of interest. 
+ 
v(t) 
R 
Fig. 7.26 The equivalent circuits of Figs. 7.23 to 7.25, collected together. 

7.3 
State-Space Averaging 
213 
Fig. 7.27 Small-signal ac equivalent circuit model of the flyback converter. 
7.3 
STATE-SPACEAVERAGING 
A number of ac converter modeling techniques have appeared in the literature, including the current-
injected approach, circuit averaging, and the state-space averaging method. Although the proponents of a 
given method may prefer to express the end result in a specific form, the end results of nearly all methods 
are equivalent. And everybody will agree that averaging and small-signal linearization are the key steps 
in modeling PWM converters. 
The state-space averaging approach [1, 2] is described in this section. The state-space descrip-
tion of dynamical systems is a mainstay of modem control theory; the state-space averaging method 
makes use of this description to derive the small-signal averaged equations of PWM switching convert-
ers. The state-space averaging method is otherwise identical to the procedure derived in Section 7 .2. 
Indeed, the procedure of Section 7.2 amounts to state-space averaging, but without the formality of writ-
ing the equations in matrix form. A benefit of the state-space averaging procedure is the generality of its 
result: a small-signal averaged model can always be obtained, provided that the state equations of the 
original converter can be written. 
Section 7.3.1 summarizes how to write the state equations of a network. The basic results of 
state-space averaging are described in Section 7 .3.2, and a short derivation is given in Section 7 .3.3. Sec-
tion 7.3.4 contains an example, in which the state-space averaging method is used to derive the quiescent 
de and small-signal ac equations of a buck-boost converter. 
7.3.1 
The State Equations of a Network 
The state-space description is a canonical form for writing the differential equations that describe a sys-
tem. For a linear network, the derivatives of the state variables are expressed as linear combinations of 
the system independent inputs and the state variables themselves. The physical state variables of a sys-
tem are usually associated with the storage of energy, and for a typical converter circuit, the physical 
state variables are the independent inductor currents and capacitor voltages. Other typical state variables 
include the position and velocity of a motor shaft. At a given point in time, the values of the state vari-
ables depend on the previous history of the system, rather than on the present values of the system inputs. 
To solve the differential equations of the system, the initial values of the state variables must be specified. 
So if we know the state of a system, that is, the values of all of the state variables, at a given time t0, and 
if we additionally know the system inputs, then we can in principle solve the system state equations to 
find the system waveforms at any future time. 
The state equations of a system can be written in the compact matrix form of Eq. (7.77): 

214 
AC Equivalent Circuit Modeling 
dx(t) 
K-----;[( = Ax(t) + Bu(t) 
(7.77) 
y(t) = Cx(t) + Eu(t) 
Here, the state vector.x(t) is a vector containing all of the state variables, that is, the inductor currents, 
capacitor voltages, etc. The input vector u(t) contains the independent inputs to the system, such as the 
input voltage source vgCt). The derivative of the state vector is a vector whose elements are equal to the 
derivatives of the corresponding elements of the state vector: 
x1(t) 
x(t) = xit) 
(7.78) 
In the standard form of Eq. (7.77), K is a matrix containing the values of capacitance, inductance, and 
mutual inductance (if any), such that Kdx(t)ldt is a vector containing the inductor winding voltages and 
capacitor currents. In other physical systems, K may contain other quantities such as moment of inertia 
or mass. Equation (7.77) states that the inductor voltages and capacitor currents of the system can be 
expressed as linear combinations of the state variables and the independent inputs. The matrices A and B 
contain constants of proportionality. 
It may also be desired to compute other circuit waveforms that do not coincide with the ele-
ments of the state vector x(t) or the input vector u(t). These other signals are, in general, dependent wave-
forms that can be expressed as linear combinations of the elements of the state vector and input vector. 
The vector y(t) is usually called the output vector. We are free to place any dependent signal in this vec-
tor, regardless of whether the signal is actually a physical output. The converter input current igCt) is often 
chosen to be an element of y(t). In the state equations (7.77), the elements of y(t) are expressed as a !In-
ear combination of the elements of the x(t) and u(t) vectors. The matrices C and E contain constants of 
proportionality. 
As an example, let us write the state equations of the circuit of Fig. 7.28. This circuit contains 
two capacitors and an inductor, and hence the physical state variables are the independent capacitor volt-
ages v1(t) and v2(t), as well as the inductor current i(t). So we can define the state vector as 
v1(t) 
x(t) = v2(t) 
(7.79) 
i(t) 
i(t) 
L 
jRi(t) 
icl(t) 
+ + vL(t) - icz(t) 
+ 
Rz 
iin(t) 
Ri 
cl 
v1(t) 
Cz 
vz(t) 
+ 
R3 
Vouif) 
Fig. 7.28 Circuit example. 

7.3 
State-Space Averaging 
215 
Since there are no coupled inductors, the matrix K is diagonal, and simply contains the values of capaci-
tance and inductance: 
C 1 o o 
K= 0 C2 0 
0 0 L 
(7.80) 
The circuit has one independent input, the current source iin(t). Hence we should define the input vector 
as 
u(t) = [ i,,(t)] 
(7.81) 
We are free to place any dependent signal in vector y(t). Suppose that we are interested in also computing 
the voltage v0Jt) and the current iR/t). We can therefore define y(t) as 
(7.82) 
To write the state equations in the canonical form of Eq. (7.77), we need to express the inductor voltages 
and capacitor currents as linear combinations of the elements of x(t) and u(t), that is, as linear combina-
tions ofv1(t), vit), i(t), and ii,/t). 
The capacitor current ic1(t) is given by the node equation 
. (·)-C dv1(t) _. ( )- v1(t) _ '() 
zc1 t -
1 dt - z,, t 
R1 
1 t 
(7.83) 
This equation will become the top row of the matrix equation (7 .77). The capacitor current icit) is given 
by the node equation, 
. ( ) _ C dv2(t) _ '( ) 
___1l{t)__ 
lcz t -
2 
dt - l t - Rz + R3 
(7.84) 
Note that we have been careful to express this current as a linear combination of the elements of x(t) and 
u(t) alone. The inductor voltage is given by the loop equation, 
(7.85) 
Equations (7.83) to (7.85) can be written in the following matrix form: 
dv 1(t) 
1 
0 
-1 
C1 o o 
----;[( 
-R; 
vl(t) 
+l81~ 
0 C2 0 
dvz(t) 
0 
1 
v2(t) 
----;[( 
- Rz + 
R3 
0 0 L 
di(t) 
i(t) 
(7.86) 
-1 
0 
~ 
~ 
dt 
~ 
~ ~ 
K 
dx(t) 
A 
x(t) + 
B 
u(t) 
dt 

216 
AC Equivalent Circuit Modeling 
Matrices A and B are now known. 
It is also necessary to express the elements of y(t) as linear combinations of the elements of x(t) 
and u(t). By solution of the circuit of Fig. 7 .28, v out(t) can be written in terms of v2(t) as 
(7.87) 
Also, iR1 (t) can be expressed in terms of v 1 (t) as 
(7.88) 
By collecting Eqs. (7.87) and (7.88) into the standard matrix form ofEq. (7.77), we obtain 
[ Vom(t) j = 
0 
R3 
0 
v1(t) 
+ [8] [iil,(t)] 
Rz+R3 
v2(t) 
jRI(t) 
1 
0 
0 
i(t) 
-~ 
(7.89) 
~ RI 
~ 
~ 
y(t) 
c 
x(t) 
+ E 
u(t) 
We can now identify the matrices C and E as shown above. 
It should be recognized that, starting in Chapter 2, we have always begun the analysis of con-
verters by writing their state equations. We are now simply writing these equations in matrix form. 
7.3.2 
The Basic State-Space Averaged Model 
Consider now that we are given a PWM converter, operating in the continuous conduction mode. The 
converter circuit contains independent states that form the state vector x(t), and the converter is driven by 
independent sources that form the input vector u(t). During the first subinterval, when the switches are in 
position 1, the converter reduces to a linear circuit that can be described by the following state equations: 
dx(t) 
K ----a(= A 1x(t) + B1u(t) 
(7.90) 
y(t) = C1x(t) + E 1u(t) 
During the second subinterval, with the switches in position 2, the converter reduces to another linear cir-
cuit whose state equations are 
dx(t) 
K----at= A 2x(t) + B2u(t) 
(7.91) 
y(t) = C2x(t) + E 2u(t) 
During the two subintervals, the circuit elements are connected differently; therefore, the respective state 
equation matrices Al' Bl' C1, E 1 and A2, B2, C2, E2 may also differ. Given these state equations, the 
result of state-space averaging is the state equations of the equilibrium and small-signal ac models. 
Provided that the natural frequencies of the converter, as well as the frequencies of variations of 
the converter inputs, are much slower than the switching frequency, then the state-space averaged model 

7.3 State-Space Averaging 
217 
that describes the converter in equilibrium is 
where the averaged matrices are 
O=AX+BU 
Y=CX+EU 
A=DA 1 +D'A 2 
B=DB 1 +D'B2 
C=DC 1 +D'C2 
E=DE1 +D'E2 
The equilibrium de components are 
X = equilibrium (de) state vector 
U =equilibrium (de) input vector 
Y = equilibrium (de) output vector 
D =equilibrium (de) duty cycle 
(7.92) 
(7.93) 
(7.94) 
Quantities defined in Eq. (7.94) represent the equilibrium values of the averaged vectors. Equation (7.92) 
can be solved to find the equilibrium state and output vectors: 
X=-A- 1 BU 
Y=(-cA- 1 B+E)U 
The state equations of the small-signal ac model are 
K d~~) = Ax(t) + Bfi(t) + {(A 1 - A 2) X+ (B 1 - B2) U} d(t) 
y(t) = Cx(t) + Efi(t) + { ( C 1 - C 2) X+ (E 1 - E 2) U} d(t) 
(7.95) 
(7.96) 
The quantities x(t), u(t), y(t), and d(t) in Eq. (7.96) are small ac variations about the equilibrium solution, 
or quiescent operating point, defined by Eqs. (7.92) to (7.95). 
So if we can write the converter state equations, Eqs. (7.90) and (7.91), then we can always find 
the averaged de and small-signal ac models, by evaluation ofEqs. (7.92) to (7.96). 
7.3.3 
Discussion of the State-Space Averaging Result 
As in Sections 7.1 and 7.2, the low-frequency components of the inductor currents and capacitor voltages 
are modeled by averaging over an interval of length T8• Hence, we can define the average of the state vec-
tor x(t) as 
J it+T, 
(xct))r =r 
x('t)d't 
s 
s 
I 
(7.97) 

218 
AC Equivalent Circuit Modeling 
The low-frequency components of the input and output vectors are modeled in a similar manner. By 
averaging the inductor voltages and capacitor currents, one then obtains the following low-frequency 
state equation: 
(7.98) 
This result is equivalent to Eq. (7.2). 
For example, let us consider how the elements of the state vector x(t) change over one switching 
period. During the first subinterval, with the switches in position 1, the converter state equations are 
given by Eq. (7.90). Therefore, the elements of x(t) change with the slopes K-1(A1x(t) + B1u(t)). If we 
make the small ripple approximation, that x(t) and u(t) do not change much over one switching period, 
then the slopes are essentially constant and are approximately equal to 
(7.99) 
This assumption coincides with the requirements for small switching ripple in all elements of x(t) and 
that variations in u(t) be slow compared to the switching frequency. If we assume that the state vector is 
initially equal to x(O), then we can write 
(7.100) 
final 
initial 
interval 
slope 
value 
value 
length 
Similar arguments apply during the second subinterval. With the switch in position 2, the state equations 
are given by Eq. (7.91). With the assumption of small ripple during this subinterval, the state vector now 
changes with slope 
The state vector at the end of the switching period is 
~ 
= ~ 
+ B 
K- 1 (A2 (x(t))Ts +B2 (u(t))Ts) 
~ 
final 
initial 
interval 
value 
value 
length 
slope 
Substitution ofEq. (7.100) into Eq. (7.102) allows us to determine x(T8 ) in terms ofx(O): 
Upon collecting terms, one obtains 
(7.101) 
(7.102) 
(7.103) 

7.3 
State-Space Averaging 
219 
x(t) 
K-1(A 1 (x)r,+B 1 (u)r,) 
K-1(A2(x)r,+B2(uk) 
....... (x(t) )r ...... . 
.. 
x(O) 
................. 
, .. , ..... / ...... ,................................ 
x(T) 
K-1( (dA 1 + d'A2) (xk + (dB 1 + d'B2) (uk) 
0 
dT8 
Fig. 7.29 How an element of the state vector, and its average, evolve over one switching period. 
y(t) 
(y(t) )T 
s 
Fig. 7.30 Averaging an element of the output vector y(t). 
(7.104) 
Next, we approximate the derivative of (x(t))Ts using the net change over one switching period: 
d(x(t) )r 
x(T)- x(O) 
___ 
s "'-'-£' =--'-'-
dt 
T, 
(7.105) 
Substitution ofEq. (7.104) into (7.105) leads to 
(7.106) 
which is identical to Eq. (7.99). This is the basic averaged model which describes the converter dynam-
ics. It is nonlinear because the control input d(t) is multiplied by (x(t))Ts and (u(t))Ts. Variation of a typical 
element ofx(t) and its average are illustrated in Fig. 7.29. 
It is also desired to find the low-frequency components of the output vector y(t) by averaging. 
The vector y(t) is described by Eq. (7.90) for the first subinterval, and by Eq. (7.91) for the second sub-
interval. Hence, the elements of y(t) may be discontinuous at the switching transitions, as illustrated in 
Fig. 7.30. We can again remove the switching harmonics by averaging over one switching period; the 

220 
AC Equivalent Circuit Modeling 
result is 
(y(t)) T, = d(t) ( cl (x(t)) T, + El (u(t)) T,) + d'(t) ( Cz (x(t)) T, + Ez (u(t)) T,) 
(7.107) 
Rearrangement of terms yields 
(7.108) 
This is again a nonlinear equation. 
The averaged state equations, (7.106) and (7.108), are collected below: 
d(x(t))T 
K 
dt '= ( d(t) A 1 + d'(t) A 2) (x(t))T, + (d(t) B1 + d'(t) B2) (u(t))T, 
(7.109) 
(y(t)) T, = ( d(t) cl + d'(t) Cz) (x(t)) T, + ( d(t) El + d'(t) Ez) (u(t)) T, 
The next step is the linearization of these equations about a quiescent operating point, to construct a 
small-signal ac model. When de inputs d(t) = D and u(t) = U are applied, converter operates in equilib-
rium when the derivatives of all of the elements of (x(t))T, are zero. Hence, by setting the derivative of 
(x(t))Ts to zero in Eq. (7 .109), we can define the converter quiescent operating point as the solution of 
O=AX+BU 
Y=CX+EU 
(7.110) 
where definitions (7.93) and (7.94) have been used. We now perturb and linearize the converter wave-
forms about this quiescent operating point: 
(x(tl)T =X+ x(t) 
s 
(u(t))T = U + ii(t) 
s 
(7.111) 
(y(t)) T, = Y + y(t) 
d(t) = D + d(t) =? d'(t) = D'- d(t) 
Here, ft(t) and d(t) are small ac variations in the input vector and duty ratio. The vectors x(t) and y(t) are 
the resulting small ac variations in the state and output vectors. We must assume that these ac variations 
are much smaller than the quiescent values. In other words, 
Here, II x II denotes a norm of the vector x. 
II u II » II u(t) II 
D »ldctll 
II X II » II x(t) II 
II vII » 
II Y<tl II 
Substitution ofEq. (7.111) into Eq. (7.109) yields 
(7.112) 

7.3 
State-Space Averaging 
221 
d(X+ x(t)) 
K 
dt 
( ( D+ d (t)) A 1 + ( D'- d (t)) A 2) (X+ x(t)) 
+ ((D+d(tl) B, + (D'-d(tl) B2) (U+fi(tl) 
(Y+y(tl)= ((D+d(tl) C1 + (D'-d(tl) C2) (X+x(tl) 
+ ( (D+ d(t)) E1 + (D'-d(t)) E2) (U+ fi(t)) 
The derivative dX/dt is zero. By collecting terms, one obtains 
first -order ac 
de terms 
first -order ac terms 
second-order nonlinear terms 
de + 1 '' order ac 
de terms 
first -order ac terms 
second-order nonlinear terms 
(7.113) 
(7.114) 
Since the de terms satisfy Eq. (7 .11 0), they drop out of Eq. (7 .114 ). Also, if the small-signal assumption 
(7.112) is satisfied, then the. second-order nonlinear terms of Eq. (7.114) are small in magnitude com-
pared to the first-order ac terms. We can therefore neglect the nonlinear terms, to obtain the following 
linearized ac model: 
K d!~t) = Ax(t) + Bfi(t) + { (A 1 -A 2) X+ (B,- B2) U }d(t) 
y(t) = Cx(t) + Eii(t) + { ( C1 - C2) X+ (E 1 - E2) U }d(t) 
This is the desired result, which coincides with Eq. (7.95). 
7.3.4 
Example: State-Space Averaging of a Nonideal Buck-Boost Converter 
(7.115) 
Let us apply the state-space averaging method to model the buck-boost converter of Fig. 7.31. We will 
model the conduction loss of MOSFET Q1 by on-resistance R011 , and the forward voltage drop of diode 

222 
AC Equivalent Circuit Modeling 
+ 
c 
R 
v(t) 
Fig. 7.31 Buck-boost converter example. 
D 1 by an independent voltage source of value VD. It is desired to obtain a complete equivalent circuit, 
which models both the input port and the output port of the converter. 
The independent states of the converter are the inductor current i(t) and the capacitor voltage 
v(t). Therefore, we should define the state vector x(t) as 
x(t) = r i(t) 1 
l v(t) j 
(7.116) 
The input voltage vgCt) is an independent source which should be placed in the input vector u(t). In addi-
tion, we have chosen to model the diode forward voltage drop with an independent voltage source of 
value VD. So this voltage source should also be included in the input vector u(t). Therefore, let us define 
the input vector as 
r 
vg(t) 1 
u(t)= V 
D 
(7.117) 
To model the converter input port, we need to find the converter input current igCt). To calculate this 
dependent current, it should be included in the output vector y(t). Therefore, let us choose to define y(t) 
as 
y(t) = [ ig(t) l 
(7.118) 
Note that it isn't necessary to include the output voltage v(t) in the output vector y(t), since v(t) is already 
included in the state vector x(t). 
Next, let us write the state equations for each subinterval. When the switch is in position 1, the 
converter circuit of Fig. 7.32(a) is obtained. The inductor voltage, capacitor current, and converter input 
current are 
di(t) 
. 
L ([t = vgCt) -z(t) Ro" 
C dv(t) __ v(t) 
dt -
R 
ig(t) = i(t) 
These equations can be written in the following state-space form: 
(7.119) 

7.3 
State-Space Averaging 
223 
(a) 
+ 
i(t) 
c 
R 
v(t) 
(b) 
+ 
L 
R 
v(t) 
Fig. 7.32 
Buck-boost converter circuit: (a) during subinterval!, (b) during subinterval2. 
[ L 0 l d l i(t) j 
-Ron 
Q 
I i(t) 1 + [ 1 o l r vg(t) j 
0 C 
dt v(t) = 
0 
1 
v(t) 
0 0 
V 0 
~~ -R ~ 
'----v---' ~ 
~ 
K 
dx(t) 
AI 
x(t) 
Bt 
u(t) 
(7.120) 
---crt 
[ig(t) l 
[1 0 l 
l i(t) 1 + l 0 0 J r vg(t) 1 
'----v---' 
....____._., 
v(t) 
....____._., 
V0 
~ 
~ 
y(t) 
ct 
x(t) 
Et 
u(t) 
So we have identified the state equation matrices A1, Bp Cp and E1. 
With the switch in position 2, the converter circuit of Fig. 7 .32(b) is obtained. For this subinter-
val, the inductor voltage, capacitor current, and converter input current are given by 
L di(t) = v(t)- V 
dt 
D 
C dv(t) = _ v(t) _ i(t) 
dt 
R 
(7.121) 
igCt) = 0 
When written in state-space form, these equations become 

224 
AC Equivalent Circuit Modeling 
[ L 0 l d l 
i(t) j 
0 1 l 
i(t) j + [ 0 - 1ll vg{t) j 
0 C 
dt v(t) = 
1 v(t) 
0 0 
VD 
'----.----' ~ 
-1-R ~ 
'------v-----' ~ 
~ 
K 
dx(t) 
A2 
x{t) 
B2 
u(t) 
(7.122) 
----;[! 
[i/t)] 
[ 00 l l 
i(t) j + 
[ 00 l l vt~) j 
~ ~ v(t) 
~ 
~ 
~ 
y(t) 
c2 
x{t) 
E2 
u(t) 
So we have also identified the subinterval 2 matrices A2, B2, C2, and E2. 
The next step is to evaluate the state-space averaged equilibrium equations (7.92) to (7.94). The 
averaged matrix A is 
In a similar manner, the averaged matrices B, C, and E are evaluated, with the following results: 
B=DB 1 +D'B2=[ ~ -f] 
C = DC 1 + D'C 2 = [ D 0] 
E = DE1 + D'E2 = [ 0 0] 
The de state equations (7.92) therefore become 
[ 
~ l = 
[ D 0] 
[ t l 
+ r ~ -~' J r ~~ 1 
[ t l 
+ 
[ 0 0 l l 
~~ j 
(7.123) 
(7.124) 
(7.125) 
Evaluation of Eq. (7 .95) leads to the following solution for the equilibrium state and output vectors: 
(7.126) 
Alternatively, the steady-state equivalent circuit of Fig. 7.33 can be constructed as usual from 

7.3 
State-Space Averaging 
225 
+ 
v 
R 
Fig. 
7.33 
De circuit model for the buck-boost converter example, equivalent to Eq. (7.125). 
Eq. (7.125). The top row of Eq. (7.125) could have been obtained by application of the principle of 
inductor volt-second balance to the inductor voltage waveform. The second row of Eq. (7.125) could 
have been obtained by application of the principle of capacitor charge balance to the capacitor current 
waveform. The ig(t) equation expresses the de component of the converter input current. By reconstruct-
ing circuits that are equivalent to these three equations, the de model of Fig. 7.33 is obtained. 
The small-signal model is found by evaluation of Eq. (7.95). The vector coefficients of d(t) in 
Eq. (7.95) are 
(AI-Az) X+ (BI-Bz) U= r- V ~IR,,j + l 
Vg~ Vo j = r Vg- V -:Ro,+ Vo 1 
(CI-Cz) X+ (EI-Ez) U= [I] 
The small-signal ac state equations (7.95) therefore become 
[ L 0 l 
A_r i(t) 1 = -DR"" 
D' 
OCdtv(t)j 
-D' 
_l_ 
R 
[t g{t)] = [ D 0 ] r ~~~~ 1 + [ 0 0 l[ v g6t) 1 + [I ]J (t) 
(7.127) 
(7.128) 
Note that, since the diode forward voltage drop is modeled as the constant value VD, there are no ac vari-
ations in this source, and vD(t) equals zero. Again, a circuit model equivalent to Eq. (7.128) can be con-
structed, in the usual manner. When written in scalar form, Eq. (7.128) becomes 
L d~~) = D' v(t)- DROO i(t) + D vgCt) + ( vg- v-I Roo+ VD) d(t) 
C d~~) = -D' i(t)- O~) +I d(t) 
i ,(t) = D i(t) +I d(t) 
(7.129) 
Circuits corresponding to these equations are listed in Fig. 7.34. These circuits can be combined into the 
complete small-signal ac equivalent circuit model of Fig. 7.35. 

226 
AC Equivalent Circuit Modeling 
(a) 
L 
(b) 
(c) 
~ 
Jd(t) 
c dO(t) 
dt 
c 
D'O(t) 
+ 
O(t) 
Di(t) 
O(t) 
R 
R 
Fig. 7.34 Circuits equivalent to the small-signal converter equations: (a) inductor loop, (b) capacitor node, (c) 
input port. 
L 
i(t) DR00 
+ 
v(t) 
R 
Fig. 7.35 Complete small-signal ac equivalent circuit model, nonideal buck-boost converter example. 
7.4 
CIRCUIT AVERAGING AND AVERAGED SWITCH MODELING 
Circuit averaging is another well-known technique for derivation of converter equivalent circuits. Rather 
than averaging the converter state equations, with the circuit averaging technique we average the con-
verter waveforms directly. All manipulations are performed on the circuit diagram, instead of on its equa-

7.4 
Circuit Averaging and Averaged Switch Modeling 
221 
tions, and hence the circuit averaging technique gives a more physical interpretation to the model. Since 
circuit averaging involves averaging and small-signallinearization, it is equivalent to state-space averag-
ing. However, in many cases circuit averaging is easier to apply, and allows the small-signal ac model to 
be written almost by inspection. The circuit averaging technique can also be applied directly to a number 
of different types of converters and switch elements, including phase-controlled rectifiers, PWM convert-
ers operated in discontinuous conduction mode or with current programming, and quasi-resonant con-
verters-these are described in later chapters. However, in other cases it may lead to involuted models 
that are less easy to analyze and understand. To overcome this problem, the circuit averaging and state-
space averaging approaches can be combined. Circuit averaging was developed before state-space aver-
aging, and is described in [4]. Because of its generality, there has been a recent resurgence of interest in 
circuit averaging of switch networks [13-20]. 
The key step in circuit averaging is to replace the converter switches with voltage and current 
sources, to obtain a time-invariant circuit topology. The waveforms of the voltage and current generators 
are defined to be identical to the switch waveforms of the original converter. Once a time-invariant circuit 
network is obtained, then the converter waveforms can be averaged over one switching period to remove 
the switching harmonics. Any nonlinear elements in the averaged circuit model can then be perturbed 
and linearized, leading to the small-signal ac model. 
In Fig. 7 .36, the switching elements are separated from the remainder of the converter. The con-
verter therefore consists of a switch network containing the converter switching elements, and a time-
invariant network, containing the reactive and other remaining elements. Figure 7.36 illustrates the sim-
ple case in which there are two single-pole single-throw (SPST) switches; the switches can then be repre-
sented using a two-port network. In more complicated systems containing multiple transistors or diodes, 
such as in polyphase converters, the switch network may contain more than two ports. 
Power input 
Load 
Time-invariant network 
containing converter reactive elements 
+ 
c 
L 
R : 
----1J--
~ 
+ 
vc(t) 
-
iL(t) 
v(t) 
il (t) 
i2(t) 
+-
Switch network 
+ 
...... 
'l:l 
v1 (t) 
t::: 
() 
v2(t) 
a 
::t 
~ 
N 
-
-
Control 
d(t) 
input 
Fig. 7.36 
A switching converter can be viewed as a switch network connected to a time-invariant network. 

228 
AC Equivalent Circuit Modeling 
+ 
Switch network 
;··---·······---····-----··----······; 
' 
' 
~ 
~. .... ~~F:;'······ 
Fig. 7.37 Schematic of the SEPIC, arranged in the form of Fig. 7.36. 
The central idea of the averaged switch modeling approach is to find an averaged circuit model 
for the switch network. The resulting averaged switch model can then be inserted into the converter cir-
cuit to obtain a complete averaged circuit model of the converter. An important advantage of the aver-
aged switch modeling approach is that the same model can be used in many different converter 
configurations. It is not necessary to rederive an averaged circuit model for each particular converter. 
Furthermore, in many cases, the averaged switch model simplifies converter analysis and yields good 
intuitive understanding of the converter steady-state and dynamic properties. 
The first step in the process of finding an averaged switch model for a switch network is to 
sketch the converter in the form of Fig. 7.36, in which a switch network containing only the converter 
switching elements is explicitly defined. The CCM SEPIC example shown in Fig. 7.37 is used to illus-
trate the process. There is usually more than one way to define the two ports of the switch network; a nat-
ural way to define the two-port switch network of the SEPIC is illustrated in Fig. 7.37. The switch 
network terminal quantities v1(t), i1(t), v2(t), and i2(t) are illustrated in Fig. 7.38 for CCM operation. Note 
that it is not necessary that the ports of the switch network be electrically connected within the switch 
network itself. Furthermore, there is no requirement that any of the terminal voltage or current wave-
forms of the switch network be nonpulsating. 
7.4.1 
Obtaining a Time-Invariant Circuit 
The first step in the circuit averaging technique is to replace the switch network with voltage 
and current sources, such that the circuit connections do not vary in time. The switch network defined in 
the SEPIC is shown in Fig. 7 .39(a). As with any two-port network, two of the four terminal voltages and 

7.4 
Circuit Averaging and Averaged Switch Modeling 
229 
-
0 
0,__ ___ __._ ____ 
___._ __ 
0 
01-----.l..-------L.--
0 
0 
dT8 
0 
01------~------~---+ 
0 
o~----~------~~--· 
0 
0 
dTs 
Fig. 7.38 Terminal switch network waveforms in the CCM SEPIC. 
currents can be taken as independent inputs to the switch network. The remaining two voltages and/or 
currents are viewed as dependent outputs of the switch network. In general, the choice of independent 
inputs is arbitrary, as long as the inputs can indeed be independent in the given converter circuit. For 
CCM operation, one can choose one terminal current and one terminal voltage as the independent inputs. 
Let us select i1(t) and vit) as the switch network independent inputs. In addition, the duty cycle d(t) is 
the independent control input. 
In Fig. 7 .39(b ), the ports of the switch network are replaced by dependent voltage and current 
sources. The waveforms of these dependent sources are defined to be identical to the actual dependent 
outputs v1(t) and iz(t) given in Fig. 7.38. Since all waveforms in Fig. 7.39(b) match the waveforms of 
Figs. 7.39(a) and 7.38, the circuits are electrically equivalent. So far, no approximations have been made. 
7.4.2 
Circuit Averaging 
The next step is determination of the average values of the switch network terminal waveforms 
in terms of the converter state variables (inductor currents and capacitor voltages) and the converter inde-
pendent inputs (such as the input voltage and the transistor duty cycle). The basic assumption is made 
that the natural time constants of the converter network are much longer that the switching period T8• 
This assumption coincides with the requirement for small switching ripple. One may average the wave-
forms over a time interval which is short compared to the system natural time constants, without signifi-
cantly altering the system response. Hence, when the basic assumption is satisfied, it is a good 
approximation to average the converter waveforms over the switching period T8 • The resulting averaged 
model predicts the low-frequency behavior of the system, while neglecting the high-frequency switching 
harmonics. In the SEPIC example, by use of the usual small ripple approximation, the average values of 
the switch network terminal waveforms of Fig. 7.38 can be expressed in terms of the independent inputs 
and the state variables as follows: 

230 
AC Equivalent Circuit Modeling 
(a) 
--------------------------: iz(t) 
+ 
+ 
Switch network 
·---··-----···----····--····--···----------· 
(b) 
+ 
Switch network 
' 
' 
······--····--······-······-··················-' 
(c) 
( i I (t) >r, ,--------------------------------------------------------------------------------: (i2(t) >rs 
+ 
+ 
d'(t); 
) 
d(t) \ vz(t) r, 
Averaged switch network 
·---····---······-...... -· .... ·-......................................... --...... ~ 
(d) 
+ 
Averaged switch network 
···········---------------------------···----···---·····---···-·-·····--·····--·· 
Fig. 
7.39 
Derivation of the averaged switch model for the CCM SEPIC: (a) switch network; (b) switch network 
where the switches are replaced with dependent sources whose waveforms match the switch terminal dependent 
waveforms; (c) large-signal, nonlinear averaged switch model obtained by averaging the switch network terminal 
waveforms in (b); (d) de and ac small-signal averaged switch model. 

7.4 
Circuit Averaging and Averaged Switch Modeling 
231 
We have selected (i1(t))Ts and (v2(t))rs as the switch network independent inputs. The dependent outputs 
of the averaged switch network are then (i2(t))Ts and (v1 (t))rs· The next step is to express, if possible, the 
switch network dependent outputs (iit))Ts and (v1(t))rs as functions solely of the switch network indepen-
dent inputs (i1(t))Ts, (vit))Ts, and the control input d(t). In this step, the averaged switch outputs should 
not be written as functions of other converter signals such as (vgCt))Ts, (vCI(t))Ts, (vC2(t))Ts' (iLI(t))Ts' 
(iL2(t))Ts' etc. 
We can use Eqs. (7.131) and (7.132) to write 
(7.134) 
(7.135) 
Substitution of these expressions into Eqs. (7.130) and (7.133) leads to 
(7.136) 
(7.137) 
The averaged equivalent circuit for the switch network, that corresponds to Eqs. (7.136) and (7.137), is 
illustrated in Fig. 7.39(c). Upon completing the averaging step, the switching harmonics have been 
removed from all converter waveforms, leaving only the de and low-frequency ac components. This 
large-signal, nonlinear, time-invariant model is valid for frequencies sufficiently less than the switching 
frequency. Averaging the waveforms of Fig. 
7.38 modifies only the switch network; the remainder of 
the converter circuit is unchanged. Therefore, the averaged circuit model of the converter is obtained 
simply by replacing the switch network with the averaged switch model. The switch network of 
Fig. 7.39(a) can be identified in any two-switch converter, such as buck, boost, buck-boost, SEPIC, or 
Cuk. If the converter operates in continuous conduction mode, the derivation of the averaged switch 
model follows the same steps, and the result shown in Fig. 7.39(c) is the same as in the SEPIC example. 
This means that the model of Fig. 7.39(c) can be used as a general large-signal averaged switch model 
for all two-switch converters operating in CCM. 

232 
AC Equivalent Circuit Modeling 
7.4.3 
Perturbation and LinearizatiQn 
The model of Fig. 7.39(c) is nonlinear, because the dependent generators given by Eqs. (7.136) and 
(7.137) are nonlinear functions of d(t), (i2(t))Ts and (v1(t))Ts. To construct a small-signal ac model, we per-
turb and linearize Eqs. (7.136) and (7.137) in the usual fashion. Let 
d(t) = D + J(t) 
h<t))T =VI+ iW) 
s 
(ii(t)}r =II+ ii(t) 
s 
( Vz(t)) T = V2 + i'z{t) 
s 
(iz(t)} r = / 2 + i 2(t) 
s 
(7.138) 
With these substitutions, Eq. (7.136) becomes 
(7.139) 
It is desired to solve for the dependent quantity V1 + v1• Equation (7.139) can be manipulated as follows: 
(7.140) 
The terms d(t)v1(t) and d(t)v2(t) are nonlinear, and are small in magnitude provided that the ac variations 
are much smaller than the quiescent values [as in Eq. (7.32)]. When the small-signal assumption is satis-
fied, these terms can be neglected. Upon eliminating the nonlinear terms and solving for the switch net-
work dependent output V1 + v" we obtain 
+ 
Fig. 7.40 
Linearization of the dependent 
voltage source. 
(7.141) 
The term (V/DD')d(t) is driven by the control input J, and 
hence can be represented by an independent voltage 
source as in Fig. 7.40. The term (D'/D)(V2 + vz(t)) is equal 
to the constant value (D'/D) multiplied by the port 2 inde-
pendent voltage (V2 + v2(t)). This term is represented by a 
dependent voltage source in Fig. 7 .40. This dependent 
source will become the primary winding of an ideal trans-
former. 
In a similar manner, substitution of the relationships 
(7.138) into Eq. (7.137) leads to: 
(7.142) 
The terms i1(t)d(t) and i2(t)d(t) are nonlinear, and can be neglected when the small-signal assumption is 
satisfied. Elimination of the nonlinear terms, and solution for /2 + i2, yields: 

7.4 
Circuit Averaging and Averaged S'(Vitch Modeling 
233 
(7.143) 
The term (lz!DD')d(t) is driven by the control input d(t), and 
is represented by an independent current source in Fig. 7.41. 
The term (D'/D)(/1 + i 1(t)) is dependent on the port 1 current 
(11 + i1(t)). This term is modeled by a dependent current 
source in Fig. 7.41; this source will become the secondary 
winding of an ideal transformer. Equations (7 .141) and 
(7.143) describe the averaged switch network model of 
Fig. 7.39(d). Note that the model contains both de and small-
signal ac terms: one equivalent circuit is used for both the de 
Fig. 7.41 Linearization of the depen-
and the smail-signal ac models. The transformer symbol con-
dent current source. 
tains both a solid line (indicating that it is an ideal trans-
former capable of passing de voltages and currents) and a 
sinusoidal line (which indicates that small-signal ac varia-
tions are modeled). The averaged switch model of Fig. 7 .39( d) reveals that the switch network performs 
the functions of: (i) transformation of de and small-signal ac voltage and current levels according to the 
D':D conversion ratio, and (ii) introduction of ac voltage and current variations into the converter circuit, 
driven by the control input d(t). When this model is inserted into Fig. 7.37, the de and small-signal ac 
SEPIC model of Fig. 7.42 is obtained. This model can now be solved to determine the steady-state volt-
ages and currents as well as the small-signal converter transfer functions. 
The switch network of Fig. 7.39(a) can be identified in all two-switch converters, including 
buck, boost, SEPIC, Cuk, etc. As illustrated Fig. 7 .43, a complete averaged circuit model of the converter 
can be constructed simply by replacing the switch network with the averaged switch model. For exam-
+ 
Fig. 7.42 
A de and small-signal ac averaged circuit model of the CCM. SEPIC. 

234 
AC Equivalent Circuit Modeling 
Power input 
+ 
-
(a) 
Power input 
(b) 
Time-invariant network 
containing converter reactive elements 
c 
L 
--H-
-+-'1\0lf\----
iL(t) 
+ 
vc(t) 
-
i (t) ;······································: i (t) 
1 
' 
Switch 
' 2 
+ I 
network 
+ 
v1(t) 
~ ~~ vz(t) 
-
-
c •••••.•.•••••••••• , •..•.••••••••••••• : 
Duty 
d(t) 
cycle 
Time-invariant network 
containing converter reactive elements 
c 
---111-1 -
'-········-~-~-~r.C:ff.~~--swf_!!.C.~--~~~?.!..~ ....... l 
Duty 
cycle 
d(t) 
Loa d 
+ 
R 
< 
v(t) 
Load 
+ 
R 
V+v 
Fig. 
7.43 
Construction of an averaged circuit model for a two-switch converter operating in CCM: (a) the con-
verter circuit with the general two-switch network identified; (b) de and ac small-signal averaged circuit model 
obtained by replacing the switch network with the averaged model. 

7.4 
Circuit Averaging and Averaged Switch Modeling 
235 
(a) 
L 
+ 
iz(t) 
,,(t) l~~:: :: ~~~~k- c 
R 
v(t) 
(b) 
L 
-
Vz + vz + 
-
+ 
11 + iJ 
Iz + iz 
+ 
/ 2 
A 
VJ +VI 
DD'd 
Q 
c 
R 
V+v 
Fig. 7.44 Construction of an averaged circuit model for an ideal boost converter example: (a) converter circuit 
with the switch network of Fig. 7.39(a) identified; (b) a de and small-signal ac averaged circuit model obtained by 
replacing the switch network with the model ofFig. 7.39(d). 
pie, Fig. 7.44 shows an averaged circuit model of the boost converter obtained by identifying the switch 
network of Fig. 7.39(a) and replacing the switch network with the model of Fig. 7.39(d). 
In summary, the circuit averaging method involves replacing the switch network with equivalent 
voltage and current sources, such that a time-invariant network is obtained. The converter waveforms are 
then averaged over one switching period to remove the switching harmonics. The large-signal model is 
perturbed and linearized about a quiescent operating point, to obtain a de and a small-signal averaged 
switch model. Replacement of the switch network with the averaged switch model yields a complete 
averaged circuit model of the converter. 
7.4.4 
Switch Networks 
So far, we have described derivation of the averaged switch model for the general two-switch 
network where the ports of the switch network coincide with the switch ports. No connections are 
assumed between the switches within the switch network itself. As a result, this switch network and its 
averaged model can be used to easily construct averaged circuit models of many two-switch converters, 
as illustrated in Fig. 7.43.1t is important to note, however, that the definition of the switch network ports 
is not unique. Different definitions of the switch network lead to equivalent, but not identical, averaged 
switch models. The alternative forms of the averaged switch model may result in simpler circuit models, 
or models that provide better physical insight. Two alternative averaged switch models, better suited for 
analyses of boost and buck converters, are described in this section. 
Consider the ideal boost converter of Fig. 7.45(a). The switch network contains the transistor 

236 
AC Equivalent Circuit Modeling 
(a) 
+ 
+ 
v(t) 
C R 
. Switch network ! 
~--................................. : 
(b) 
Fig. 7.45 
An ideal boost converter exam-
ple: (a) converter circuit showing another pos-
sible definition of the switch network; (b) 
terminal waveforms of the switch network. 
v2(t) 
(vl(t))T 
·····-·····---··· s ···-- --·---·-·---------------·-··· ............ . 
0 
01--------l'--------l....---
0 
(iz(t))T 
----·····-····----~------- ····························· ............ . 
0 
o~------L-______ _L __ __. 
0 
dT, 
and the diode, as in Fig. 7.44(a), but the switch network ports are defined differently. Let us proceed with 
the derivation of the corresponding averaged switch model. The switch network terminal waveforms are 
shown in Fig. 7.45(b). Since i 1(t) and v2(t) coincide with the converter inductor current and capacitor 
voltage, it is convenient to choose these waveforms as the independent inputs to the switch network. The 
steps in the derivation of the averaged switch model are illustrated in Fig. 7.46. 
First, we replace the switch network with dependent voltage and current generators as illus-
trated in Fig. 7.46(b). The voltage generator v1(t) models the dependent voltage waveform at the input 
port of the switch network, i.e., the transistor voltage. As illustrated in Fig. 7.45(b), v1(t) is zero when the 
transistor conducts, and is equal to vit) when the diode conducts: 
( ) _ { 0, 
0 < t < dT, 
v1 t -
v2(t), dT, < t < T, 
(7.144) 
When v1(t) is defined in this manner, the inductor voltage waveform is unchanged. Likewise, iit) models 
the dependent current waveform at port 2 of the network, i.e., the diode current. As illustrated in 
Fig. 7.45(b), iit) is equal to zero when the transistor conducts, and is equal to i 1(t) when the diode con-
ducts: 

7.4 
Circuit Averaging and Averaged Switch Modeling 
. ( ) _ { 0, 
0 < t < dT, 
12 t -
i 1(t), dT,. < t < T, 
237 
(7.145) 
With i2(t) defined in this manner, the capacitor current waveform is unchanged. Therefore, the original 
converter circuit shown in Fig. 7.45(a), and the circuit obtained by replacing the switch network of 
Fig. 7.46(a) with the switch network of Fig. 7.46(b), are electrically identical. So far, no approximations 
have been made. Next, we remove the switching harmonics by averaging all signals over one switching 
period, as in Eq. (7.3). The results are 
(7.146) 
Here we have assumed that the switching ripples of the inductor current and capacitor voltage are small, 
or at least linear functions of time. The averaged switch model of Fig. 7 .46( c) is now obtained. This is a 
large-signal, nonlinear model, which can replace the switch network in the".original converter circuit, for 
construction of a large-signal nonlinear circuit model of the converter. The switching harmonics have 
been removed from all converter waveforms, leaving only the de and low-frequency ac components. 
The model can be linearized by perturbing and linearizing the converter waveforms about a qui-
escent operating point, in the usual manner. Let 
h<t)) r, = vg + vg(t) 
d(t) = D + d(t) =} d'(t) = D'- d(t) 
(i(t))r = (i 1(t))r =I+ i(t) 
s 
s 
(v(t))r =(v2(t))r =V+v(t) 
s 
s 
(vt(t))r =VI+ vl(t) 
s 
(iz<t))r = / 2 + i 2(t) 
s 
The nonlinear voltage generator at port 1 of the averaged switch network has value 
(D' -J(t)) ( v + v(t)) = D' ( v + v(t))- v J(t)- v(t)d(t) 
(7.147) 
(7.148) 
The term v(t)d(t) is nonlinear, and is small in magnitude provided that the ac variations are much smaller 
than the quiescent values [as in Eq. (7.32)]. When the small-signal assumption is satisfied, this term can 
be neglected. The term Vd(t) is driven by the control input, and hence can be represented by an indepen-
dent voltage source. The term D'(V + v(t)) is equal to the constant valueD' multiplied by the output volt-
age (V + v(t)). This term is dependent on the output capacitor voltage; it is represented by a dependent 
voltage source. This dependent source will become the primary winding of an ideal transformer. 
The nonlinear current generator at the port 2 of the averaged switch network is treated in a sim-
ilar manner. Its current is 
(D'- d(t)) (I+ i(t)) = D' (1 + i(t)) -I d(t)- i(t)d(t) 
(7.149) 
The term i(t)d(t) is nonlinear, and can be neglected provided that the small-signal assumption is satisfied. 

238 
AC Equivalent Circuit Modeling 
(a) 
il(t) r· -----------------------------------
+ 
+ 
(b) 
Switch network 
~--···· ................................... -~ 
(c) 
(il (t))T , ......... ····························· 
s: 
+ 
Averaged switch network 
-------------------------------------------------------------------------··· 
(d) 
/1 + zl r·································································: Iz + lz 
+ 
+ 
Fig. 7.46 
Derivation of the averaged switch model for the CCM boost of Fig. 7.45: (a) switch network; 
(b) switch network where the switches are replaced by dependent sources whose waveforms match the switch ter-
minal waveforms; (c) large-signal, nonlinear averaged switch model obtained by averaging the switch network ter-
minal waveforms; (d) de and ac small-signal averaged switch network modeL 

7.4 
Circuit Averaging and Averaged Switch Modeling 
239 
~~~-·-----------------------------------------------------------------------i 
l 
l 
+ 
c 
R 
V+v 
, 
Averaged switch network 
i 
' 
I 
L---------------------------------------------------------------------------• 
Fig. 7.47 De and small-signal ac averaged circuit model of the boost converter. 
The term Id(t) is driven by the control input d(t), and is represented by an independent current source. 
The term D'(I + i(t)) is dependent on the inductor current (I+ i(t)). This term is modeled by a dependent 
current source; this source will become the secondary winding of an ideal transformer. 
Upon elimination of the nonlinear terms, and replacement of the dependent generators with an 
ideal D':l transformer, the combined de and small-signal ac averaged switch model of Fig. 7.46(d) is 
obtained. Figure 7.47 shows the complete averaged circuit model of the boost converter. 
It is interesting to compare the models of Fig. 7.44(b) and Fig. 7.47. The two averaged circuit 
models of the boost converter are equivalent-they result in the same steady-state solution, and the same 
converter transfer functions. However, since both ports of the switch network in Fig. 7.45(a) share the 
same reference ground, the resulting averaged circuit model in Fig. 7.47 is easier to solve, and gives bet-
ter physical insight into steady-state operation and dynamics of the boost converter. The circuit model of 
Fig. 7.47 reveals that the switch network performs the functions of: (i) transformation of de and small-
signal ac voltage and current levels according to the D':1 conversion ratio, and (ii) introduction of ac 
voltage and current variations into the converter circuit, driven by the control input d(t). The model of 
Fig. 7.47 obtained using the circuit averaging approach is identical to the model of Fig. 7.17(b) obtained 
using the basic ac modeling technique of Section 7 .2. 
· 
Next, we consider the CCM buck converter of Fig. 7.48, where the switch network ports are 
defined to share a common ground terminal. The derivation of the corresponding averaged switch model 
follows the same steps as in the SEPIC and the boost examples. Let us select v1(t) and i2(t) as the inde-
pendent terminal variables of the two-port switch network, since these quantities coincide with the 
applied converter input voltage vgCt) and the inductor current i(t), respectively. We then need to express 
the averaged dependent terminal waveforms (i1 (t))T, and (v2(t))Ts as functions of the control input d(t) and 
of (v1 (t))Ts and (i2(t))T:.. Upon averaging the waveforms of Fig. 7.48(b ), one obtains 
Perturbation and linearization of Eq. (7.150) then leads to 
/ 1 +i 1(t)=D(l 2 +i 2(t))+l2 d(t) 
Vz + vz(t) = D (VI+ vl(t)) +VI d(t) 
(7.150) 
(7.151) 
An equivalent circuit corresponding to Eq. (7.151) is illustrated in Fig. 7.49(a). Replacement of the 

240 
AC Equivalent Circuit Modeling 
(a) 
(b) 
----·····---------·-
L 
(a) 
il (t) 
! iz( t) 
i(t) 
+ 
+ 
vgCt) 
v2(t) 
c 
R 
v(t) 
Switch network 
···------·····-----····· 
(b) 
(it(t))T 
·······················-·- ·······--········----~·-···-- ········---·· 
Fig. 7.48 
Buck converter example: 
(a) converter circuit, (b) switch wave-
forms. 
0 
01------L-----...l---
0 
v2(t) 
( V2(t)) T, 
0 
01-----~-----'---+ 
0 
dTs 
------------------------·----------------------------------------------------· 
11 + t1! 
-
I 12 + i2 
+ 
• 
I + ; 
+ 
V1d(t) I 
l 
vl + 1\ 
I v2 + v2 
I 
[ 
Averaged switch network 
[ 
!. ___________________________________________________________________________ _ 
+ 
R 
V+v 
l .... ~~~!:~~!:~-~~!!.~~--'!.:_t::'.()!:.~---' 
Fig. 7.49 
Averaged switch modeling, buck converter example: (a) de and small-signal ac averaged switch 
model; (b) Averaged circuit model of the buck converter obtained by replacement of the switch network by the aver-
aged switch model. 

7.4 
Circuit Averaging and Averaged Switch Modeling 
241 
(a) 
ii (t) 
r··-------------------------------------1 iz(t) 
+ 
+ 
+ 
T 
v2(t) 
-
' 
' 
' 
~---------········-··············-······-' 
(b) 
i1 (t) 
:---------------------------------------1 i2(t) 
+ 
+ 
+ 
+ 
' 
' 
' 
' 
~--······································' 
(c) 
ii (t) 
:---------------------------------------1 iz(t) 
+ 
+ 
+ 
t ....................................... .! 
Fig. 7.50 Three basic switch networks, and their CCM de and small-signal ac averaged switch models: (a) the 
buck switch network, (b) the boost switch network, and (c) the general two-switch network. 
switch network in Fig. 7.48(a) with the averaged switch model of Fig. 7.49(a) leads to the converter aver-
aged circuit model of Fig. 7 .49(b ). The circuit model of Fig. 7 .49(b) reveals that the switch network per-
forms the functions of: (i) transformation of de and small-signal ac voltage and current levels according 
to the 1 :D conversion ratio, and (ii) introduction of ac voltage and current variations into the converter 
circuit, driven by the control input d(t). The model is easy to solve for both de conversion ratio and small-
signal frequency responses. It is identical to the model shown in Fig. 7.17(a). 
The three basic switch networks-the buck switch network, the boost switch network, and the 
general two-switch network-together with the corresponding averaged switch models are shown in 
Fig. 7.50. Averaged switch models can be refined to include conduction and switching losses. These 
models can then be used to predict the voltages, currents, and efficiencies of nonideal converters. Two 
examples of averaged switch models that include losses are described in Sections 7.4.5 and 7.4.6. 

242 
AC Equivalent Circuit Modeling 
7.4.5 
Example: Averaged Switch Modeling of Conduction Losses 
An averaged switch model can be refined to include switch conduction losses. Consider again the SEPIC 
of Fig. 7.37. Suppose that the transistor on-resistance is Ron and the diode forward voltage drop V0 are 
approximately constant. In this example, all other conduction or switching losses are neglected. Our 
objective is to derive an averaged switch model that includes conduction losses caused by the voltage 
drops across Ron and V0 . Let us define the switch network as in Fig. 7.39(a). The waveforms of the switch 
network terminal currents are the same as in Fig. 7.38, but the voltage waveforms are affected by the 
voltage drops across Ron and V0 as shown in Fig. 7.51. We select i1(t) and v2(t) as the switch network 
independent inputs, as in Section 7.4.1. The average values ofv1(t) and v2(t) can be found as follows: 
(7.152) 
(7.153) 
Next, we proceed to eliminate (iLI(t))Ts, (idt))T,' (vCI(t))Ts, and (v0 (t))Ts, to write the above equations in 
terms of the averaged independent terminal currents and voltages of the switch network. By combining 
Eqs. (7.152) and (7.153), we obtain: 
Since the current waveforms are the same as in Fig. 7.38, Eq. (7.134) can be used here: 
hCt))T 
·················---~------ ........................................ . 
v2(t) 
r(VCI +va-Ron(iLI +iL2) 
v 
-
( vz(t)) T 
2 
---··---··----------·---·------····································· 
0~----j=~===t--; 
0 
dT, 
~-V Ts 
D 
Fig. 7.51 
The switch network terminal volt-
ages v1(t) and vzCt) for the case when the transis-
tor on-resistance is Ron and the diode forward 
voltage drop is VD. 
(7.154) 
(7.155) 

7.4 
Circuit Averaging and Averaged Switch Modeling 
243 
(il (t))y s 
(iz(t))r s 
+ 
Ron 
+ 
d(t) 
(v 1(t))r 
s 
(v2(t))r 
s 
Fig. 7.52 Large-signal averaged switch model for the general two-switch network of Fig. 7.50. This model 
includes conduction losses due to the transistor on-resistance Ron and the diode forward voltage drop V v· 
Substitution of Eqs. (7 .154) and (7 .155) into Eq. (7.152) results in: 
(7.156) 
Equation (7.156) can be solved for the voltage (v1(t))r,: 
(7.157) 
The expression for the averaged current (iz(t))-r, is given by Eq. (7 .137) derived in Section 7 .4.2: 
(7.158) 
Equations (7.157) and (7 .158) constitute the averaged terminal relations of the switch network. An equiv-
alent circuit corresponding to these relationships is shown in Fig. 7.52. The generators that depend on the 
transistor duty cycle d(t) are combined into an ideal transformer with the turns ratio d'(t):d(t). This part 
of the model is the same as in the averaged switch model derived earlier for the switch network with 
ideal switches. The elements Ron /d and VD model the conduction losses in the switch network. This is a 
large-signal, nonlinear model. If desired, this model can be perturbed and linearized in the usual manner, 
to obtain a small-signal ac switch model. 
The model of Fig. 7.52 is also well suited for computer simulations. As an example of this 
application, consider the buck-boost converter in Fig 7 .53( a). In this converter, the transistor on-resis-
tance is Ron= 50 mQ, while the diode forward voltage drop is Vv= 0.8 V. Resistor RL = 100 mQ models 
the copper loss of the inductor. All other losses are neglected. Figure 7 .53(b) shows the averaged circuit 
model of the converter obtained by replacing the switch network with the averaged switch model of 
Fig. 7.52. 
Let's investigate how the converter output voltage reaches its steady-state value, starting from 
zero initial conditions. A transient simulation can be used to generate converter waveforms during the 
start-up transient. It is instructive to compare the responses obtained by simulation of the converter 
switching circuit shown in Fig. 7.53(a) against the responses obtained by simulation of the averaged cir-
cuit model shown in Fig. 7.53(b). Details of how these simulations are performed can be found in 
Appendix B .1. Figure 7.54 shows the start-up transient waveforms of the inductor current and the output 
voltage. In the waveforms obtained by simulation of the averaged circuit model, the switching ripple is 
removed, but other features of the converter transient responses match very closely the responses 

244 
AC Equivalent Circuit Modeling 
(a) 
(b) 
i(t) 
0.1 Q 
RL 
. ········A~~·;~g~··;D;Tici;~;;;;J~T"·······i 
(il(t))r, 
j 
(iz(t))r, 
+ 
,_ 
I (vz(t))r, 
I 
-l .......................................................... ...! + 
+ 
R 
v(t) 
20Q 
+ 
R 
20Q 
Fig. 7.53 
Buck-boost converter example: (a) converter circuit; (b) averaged circuit model of the converter. 
obtained from the switching circuit. Simulations of averaged circuit models can be used to predict con-
verter steady-state and dynamic responses, as well as converter losses and efficiency. 
7 .4.6 
Example: Averaged Switch Modeling of Switching Losses 
Switching losses can also be modeled via averaged switch modeling. As an example, consider again the 
CCM buck converter of Fig. 7.48(a). Let us suppose that the transistor is ideal, and that the diode exhibits 
reverse recovery described in Section 4.3.2. The simplified switch waveforms are shown in Fig. 7.55. Ini-
tially, the diode conducts the inductor current and the transistor is in the off state. When the transistor 
turns on, a negative current flows through the diode so that the transistor current i 1 exceeds the inductor 
current. The time it takes to remove the charge Qr stored within the diode is the reverse recovery time tr. 

i(t) 
60A 
SOA 
40A 
30A 
20 A 
lOA 
0 
0 
v(t) 
lOV 
0 
-lOY 
-20 V 
-30V 
-40 V 
-SOV 
-60 V 
0 
7.4 
Circuit Averaging and Averaged Switch Modeling 
245 
Waveform obtained by simulation 
of the averaged model 
/ 
Waveform obtained by simulation 
of the switching circuit model 
0.2 ms 
0.4 ms 
0.6ms 
t 
0.8 ms 
Waveform obtained by simulation 
of the averaged model 
Waveform obtained by simulation 
/
of the switching circuit model 
0.2 ms 
0.4 ms 
0.6 ms 
0.8 ms 
1 ms 
1 ms 
1.2 ms 
1.2 ms 
Fig. 7.54 Waveforms obtained by simulation of the switching converter circuit shown in Fig. 7.53(a) and by 
simulation of the averaged circuit model of Fig. 7.53(b) 
;2 
::=L 
0 
VI 
: 
VI 
0 5} 
dT . 
r, 
0 
0 [, 
Fig. 7.55 
Switch waveforms, buck 
converter switching loss example. 

246 
AC Equivalent Circuit Modeling 
1 : d(t) 
+ 
+ 
Fig. 7.56 
Large-signal averaged switch model for the buck converter switching loss example. 
It is assumed that the diode is "snappy," so that the voltage drop across the diode remains small during 
the reverse recovery time. After the diode reverse recovery is completed, the diode turns off, and the volt-
age v2 across the diode quickly jumps to the input voltage v1 = vg. For this simple example, conduction 
losses and other switching losses are neglected. 
Let us select v 1 (t) and i2(t) as the independent terminal variables of the two-port switch network, 
and derive expressions for the averaged dependent terminal waveforms (i 1(t))r, and (v2(t))r,· The average 
value of i1(t) is equal to the area under the i 1(t) waveform, divided by the switching period T,: 
(il(t) )T, = f, f' im dt = i,( Q, + tr(iit) )T, + dT,(ilt) )T,) 
= QT, + Ttr (ilt))T + d(iz(t))T 
s 
s 
s 
s 
(7.159) 
The quantity d(t) is the effective transistor duty cycle, defined in Fig. 7.55 as the transistor on-time minus 
the reverse recovery time, divided by the switching period. The average value of v2(t) is equal to: 
(7.160) 
Equations (7.159) and (7.160) constitute the averaged terminal relations of the switch network. An equiv-
alent circuit corresponding to these relationships is constructed in Fig. 7 .56. The generators that depend 
on the effective transistor duty cycle d(t) are combined into an ideal transformer. To complete the model, 
the recovered charge Qr and the reverse recovery time tr can be expressed as functions of the current 
(i2(t))T, [20]. This is a large-signal averaged switch model, which accounts for the switching loss of the 
idealized waveforms of Fig. 7.55. If desired, this model can be perturbed and linearized in the usual man-
ner, to obtain a small-signal ac switch model. 
The model of Fig. 7.56 has the following physical interpretation. The transistor operates with 
the effective duty cycle d(t). This is the turns ratio of the ideal de transformer, which models the first-
order switch property of loss less transfer of power from the switch input to the switch output port. The 
additional current generators model the switching loss. Note that both generators consume power. The 
total switching loss is: 
(7.161) 
These generators also correctly model how the switching loss increases the average switch input current. 

7.5 
The Canonical Circuit Model 
247 
:····-···········································-----------------------·------~ 
. 
. 
. 
. 
1: D 
L 
I 
+ 
+ 
C ·-·-··· 
R 
v 
Fig. 7.57 
De equivalent circuit model, buck converter switching loss example. 
By inserting the switch model of Fig. 7.56 into the original converter circuit of Fig. 7.48(a), and by let-
ting all waveforms be equal to their quiescent values, we obtain the steady-state model of Fig. 7.57. This 
model predicts that the steady-state output voltage is: 
(7.162) 
To find the efficiency, we must compute the average input and output powers. The converter input power 
is 
(7.163) 
The average output power is 
Pout=Vl2=DV/2 
(7.164) 
Hence the converter efficiency is 
TJ =pout= 
1 
P;, 
1 + .i1:._ + ~ 
DTJ 
DT, 
(7.165) 
Beware, the efficiency is not simply equal to VIDV8. 
7.5 
THE CANONICAL CIRCUIT MODEL 
Having discussed several methods for deriving the ac equivalent circuit models of switching converters, 
let us now pause to interpret the results. All PWM CCM de-de converters perform similar basic func-
tions. First, they transform the voltage and current levels, ideally with 100% efficiency. Second, they 
contain low-pass filtering of the waveforms. While necessary to remove the high-frequency switching 
ripple, this filtering also influences low-frequency voltage and current variations. Third, the converter 
waveforms can be controlled by variation of the duty cycle. 
We expect that converters having similar physical properties should have qualitatively similar 
equivalent circuit models. Hence, we can define a canonical circuit model that correctly accounts for all 

248 
AC Equivalent Circuit Modeling 
of these basic properties [1-3]. The ac equivalent circuit of any CCM PWM de--de converter can be 
manipulated into this canonical form. This allows us to extract physical insight, and to compare the ac 
properties of converters. The canonical model is used in several later chapters, where it is desired to ana-
lyze converter phenomena in a general manner, without reference to a specific converter. So the canoni--
cal model allows us to define and discuss the physical ac properties of converters. 
In this section, the canonical circuit model is developed, based on physical arguments. An 
example is given which illustrates how to manipulate a converter equivalent circuit into canonical form. 
Finally, the parameters of the canonical model are tabulated for several basic ideal converters. 
7.5.1 
Development of the Canonical Circuit Model 
The physical elements of the canonical circuit model are collected, one at a time, in Fig. 7.58. 
The converter contains a power input port vgCt) and a control input port d(t), as well as a power output 
port and load having voltage v(t). As discussed in Chapter.3, the basic function of any CCM PWM de--de 
converter is the conversion of de voltage and current levels, ideally with 100% efficiency. As illustrated 
in Fig. 7.58(a), we have modeled this property with an ideal de transformer, having effective turns ratio 
1 :M(D) where M is the conversion ratio. This conversion ratio is a function of the quiescent duty cycle D. 
As discussed in Chapter 3, this model can be refined, if desired, by addition of resistors and other ele-
ments that model the converter losses. 
Slow variations vgCt) in the power input induce ac variations v(t) in the converter output voltage. 
As illustrated in Fig. 7 .58(b ), we expect these variations also to be transformed by the conversion ratio 
M(D). 
The converter must also contain reactive elements that filter the switching harmonics and trans-
fer energy between the power input and power output ports. Since it is desired that the output switching 
ripple be small, the reactive elements should comprise a low-pass filter having a cutoff frequency well 
below the switching frequency. This low-pass characteristic also affects how ac line voltage variations 
influence the output voltage. So the model should contain an effective low-pass filter as illustrated in Fig. 
7.58(c). This figure predicts that the line-to-output transfer function is 
(7.166) 
where H/s) is the transfer function of the effective low-pass filter loaded by resistance R. When the load 
is nonlinear, R is the incremental load resistance, evaluated at the quiescent operating point. The effective 
filter also influences other properties of the converter, such as the small-signal input and output imped-
ances. It should be noted that the elemental values in the effective low-pass filter do not necessarily coin-
cide with the physical element values in the converter. In general, the element values, transfer function, 
and terminal impedances of the effective low-pass filter can vary with quiescent operating point. Exam-
ples are given in the following subsections. 
Control input variations, specifically, duty cycle variations d(t), also induce ac variations in the 
converter voltages and currents. Hence, the model should contain voltage and current sources driven by 
d(t). In the examples of the previous section, we have seen that both voltage sources and current sources 
appear, which are distributed around the circuit model. It is possible to manipulate the model such that all 
of the d(t) sources are pushed to the input side of the equivalent circuit. In the process, the sources may 
become frequency-dependent; an example is given in the next subsection. In general, the sources can be 
combined into a single voltage source e(s)d(s) and a single current source j(s)d(s) as shown in 

(a) 
(c) 
(d) 
7.5 
The Canonical Circuit Model 
249 
Converter model 
(b) 
····················································: 
'· + I 
·H'----t-----'m 
: f · 
1 ........................ -.j.. ..................... .J 
l:M(D) 
! 
, .... ,., 9....---+-----.H 
I ,:.+ 
...................... .j... ....................... i 
Power 
input 
Power 
input 
Power 
input 
D 
Control 
input 
wad 
Power 
input 
:··································································~~;~;···························! 
1 :M(D) 
..-------..... 
D 
.Control 
input 
+ 
Effective 
low-pass 
filter 
z,.(s) 
-
V+v(s) 
R 
l 
........................ .r ........................................................................ .l 
D 
Control 
input 
Z,;(s) -
Effective 
low-pass 
filter 
Load 
+ 
z,.(s) 
-
V+v(s) 
R 
l. .......................... ~ 
...................................................................... i 
D+a(s) 
Control 
input 
Load 
wad 
Fig. 7.58 
Development of the canonical circuit model, based on physical arguments: (a) de transformer model, 
(b) inclusion of ac variations, (c) reactive elements introduce effective low-pass filter, (d) inclusion of ac duty cycle 
variations. 

250 
AC Equivalent Circuit Modeling 
Fig. 7.58(d). This model predicts that the small-signal control-to-output transfer function is 
G.is) = ~(s) = e(s) M(D) H.(s) 
d(s) 
(7.167) 
This tran~sfer function is found by setting the vgCs) variations to zero, and solving for the dependence of 
v(s) on d(s). Figure 7.58(d) is the complete canonical circuit, which can model any PWM CCM de-de 
converter. 
7.5.2 
Example: Manipulation of the Buck-Boost Converter Model into Canonical Form 
To illustrate the steps in the derivation of the canonical circuit model, let us manipulate the equivalent 
circuit of the buck-boost converter into canonical form. A small-signal ac equivalent circuit for the buck-
boost converter is derived in Section 7.2. The result, Fig. 7.16(b), is reproduced in Fig. 7.59. To manipu-
late this network into canonical form, it is necessary to push all of the independent d(t) generators to the 
left, while pushing the inductor to the right and combining the transformers. 
The (Vg - V)d(t) voltage source is in series with the inductor, and hence the positions of these 
two elements can be interchanged. In Fig. 7.60(a), the voltage source is placed on the primary side of the 
l:D ideal transformer; this requires dividing by the effective turns ratio D. The output-side Id(t) current 
source has also been moved to the primary side of the D': 1 transformer. This requires multiplying by the 
turns ratio liD'. The polarity is also reversed, in accordance with the polarities of the D':l transformer 
windings. 
Next, we need to move the I d(t)ID current source to the left of the inductor. This can be done 
using the artifice illustrated in Fig. 7.60(b). The ground connection of the current source is broken, and 
the source is connected to node A instead. A second, identical, current source is connected from node A 
to ground. The second source causes the current flowing into node A to be unchanged, such that the node 
equations of Figs. 7.60(a) and 7.60(b) are identical. 
In Fig. 7.60(c), the parallel combination of the inductor and current source is converted into 
Thevenin equivalent form. The series combination of an inductor and voltage source are obtained. 
In Fig. 7.60(d), the Jd(t)ID current source is pushed to the primary side of the l:D transformer. 
The magnitude of the current source is multiplied by the turns ratio D. In addition, the current source is 
pushed through the (Vg - V)d(t)ID voltage source, using the previously described artifice. The ground 
connection of the source is moved to node B, and an identical source is connected from node B to ground 
such that the circuit node equations are unchanged. 
.L 
(v.- v)dCt) 
+ 
v + v(s) 
R 
Fig. 
7.59 Small-signal ac model of the buck-boost converter, before manipulation into canonical form. 

7.5 
The Canonical Circuit Model 
251 
(a) 
(c) 
(d) 
V8 - V , 
-od 
v,- v , 
-od 
V8 - V , 
-od 
sL/ J 
D' 
L 
L 
Fig. 7.60 
Steps in the manipulation of the buck-boost ac model into canonical form. 
+ 
V + v(s) 
R 
R 
+ 
V + v(s) 
R 
+ 
V + v(s) 
R 

252 
AC Equivalent Circuit Modeling 
Fig. 
7.61 
The buck-boost converter model, in canonical form. 
Effective 
low-pass 
'··········-~-~~~~---·········' 
+ 
v + v(s) 
R 
Figure 7.61 is the final form of the model. The inductor is moved to the secondary side of the 
D':1 transformer, by multiplying by the square of the turns ratio as shown. The sLid(t)ID' voltage source 
is moved to the primary side of the 1:D transformer, by dividing by the turns ratio D. The voltage and 
current sources are combined as shown, and the two transformers are combined into a single D':D trans-
former. The circuit is now in canonical form. 
It can be seen that the inductance of the effective low-pass filter is not simply equal to the phys-
ical inductor value L, but rather is equal to LID'2. At different quiescent operating points, with different 
values of D', the value of the effective inductance will change. In consequence, the transfer function, 
input impedance, and output impedance of the effective low-pass filter will also vary with quiescent 
operating point. The reason for this variation is the transformation of the inductance value by the effec-
tive D':l transformer. 
It can also be seen from Fig. 7.61 that the coefficient of the d(t) voltage generator is 
(7.168) 
This expression can be simplified by substitution of the de relationships (7 .29). The result is 
(7.169) 
When we pushed the output-side Jd(t) current source through the inductor, we obtained a voltage source 
having a frequency dependence. In consequence, the e(s)d voltage generator is frequency-dependent. 
7.5.3 
Canonical Circuit Parameter Values for Some Common Converters 
For ideal CCM PWM de-de converters containing a single inductor and capacitor, the effective low-pass 
filter of the canonical model should contain a single inductor and a single capacitor. The canonical model 
then reduces to the circuit of Fig. 7.62. It is assumed that the capacitor is connected directly across the 
load. The parameter values for the basic buck, boost, and buck-boost converters are collected in Table 
7.1. Again, it should be pointed out that the effective inductance Le depends not only on the physical 

7.6 Modeling the Pulse-Width Modulator 
253 
e(s)d(s) 
+ 
V + v(s) 
R 
Fig. 7.62 The canonical model, for ideal CCM converters containing a single inductor and capacitor. 
Table 7.1 
Canonical model parameters for the ideal buck, boost and buck-boost converters 
Converter 
M(D) 
Le 
e(s) 
j(s) 
Buck 
D 
L 
v 
v 
D2 
R 
Boost 
1 
L 
v(1-A_) 
_L 
D' 
D'2 
D'2R 
D' 2R 
Buck-boost 
D 
L 
V ( 1 sDL) 
v 
- D' 
D'z 
- D 2 
- D' 2R 
- D' 2R 
inductor valueL, but also on the quiescent duty cycle D. Furthermore, the current flowing in the effective 
inductance Le does not in general coincide with the physical inductor current I+ i(t). 
The model of Fig. 7.62 can be solved using conventional linear circuit analysis, to find quanti-
ties of interest such as the converter transfer functions, input impedance, and output impedance. Trans-
former isolated versions of the buck, boost, and buck-boost converters, such as the full bridge, forward, 
and fly back converters, can also be modeled using the equivalent circuit of Fig. 7.62 and the parameters 
of Table 7.1, provided that one correctly accounts for the transformer turns ratio. 
7.6 
MODELING THE PULSE-WIDTH MODULATOR 
We have now achieved the goal, stated at the beginning of this chapter, of deriving a useful equivalent 
circuit model for the switching converter in Fig. 7.1. One detail remains: modeling the pulse-width mod-
ulator. The pulse-width modulator block shown in Fig. 7.1 produces a logic signal 8(t) that commands 
the converter power transistor to switch on and off. The logic signal 8(t) is periodic, with frequency fs and 
duty cycle d(t). The input to the pulse-width modulator is an analog control signal vJt). The function of 
the pulse-width modulator is to produce a duty cycle d(t) that is proportional to the analog control volt-

254 
AC Equivalent Circuit Modeling 
Sawtooth 
wave 
generator 
Analog 
input 
v /t) o-------1 
Fig. 7.63 A simple pulse-width modulator circuit. 
age vc(t). 
Comparator 
o(t) 
PWM 
waveform 
A schematic diagram of a simple pulse-width modulator circuit is given in Fig. 7.63. A saw-
tooth wave generator produces the voltage waveform vsaw(t) illustrated in Fig. 7.64. The .peak-to-peak 
amplitude of this waveform is V M· The converter switching frequency fs is determined by and equal to the 
frequency of vmw(t). An analog comparator compares the analog control voltage vc(t) to vsaw(t). This 
comparator produces a logic-level output which is high whenever vc(t) is greater than vsaw(t), and is oth-
erwise low. Typical waveforms are illustrated in Fig. 7.64. 
If the sawtooth waveform vmw(t) has minimum value zero, then the duty cycle will be zero 
whenever vc(t) is less than or equal to zero. The duty cycle will beD= 1 whenever vc(t) is greater than or 
equal to VM. If, over a given switching period, vsaw(t) varies linearly with t, then for 0::; vc(t)::; VM the 
duty cycle d will be a linear function of v c· Hence, we can write 
d(t) = v/t) 
c 
0 < ( ) < V 
V M 
10f 
_ Vc t _ 
M 
(7.170) 
VM .................................. . 
0 
0(1)1 
I 
I 
I [. 
0 
dT, 
Ts 
Fig. 7.64 Waveforms of the circuit of Fig. 7.63. 

7.6 Modeling the Pulse-Width Modulator 
255 
Fig. 7.65 Pulse-width modulator block diagram. 
1 
VM 
Pulse-width 
modulator 
This equation is the input-output characteristic of the pulse-width modulator [2,11]. 
To be consistent with the perturbed-and-linearized converter models of the previous sections, 
we can perturb Eq. (7.170). Let 
vc<t) = vc + vc(t) 
d(t) = D + d(t) 
Insertion ofEq. (7.171) into Eq. (7.170) leads to 
(7.171) 
(7.172) 
A block diagram representing Eq. (7 .172) is illustrated in Fig. 7 .65. The pulse-width modulator has lin-
ear gain l!V M' By equating like terms on both sides of Eq. (7 .172), one obtains 
(7.173) 
So the quiescent value of the duty cycle is determined in practice by Vc. 
The pulse-width modulator model of Fig. 7.65 is sufficiently accurate for nearly all applica-
tions. However, it should be pointed out that pulse-width modulators also introduce sampling of the 
waveform. Although the analog input signal v c(t) is a continuous function of time, there can be only one 
discrete value of the duty cycle during every switching period. Therefore, the pulse-width modulator 
samples the waveform, with sampling rate equal to the switching frequency fs. Hence, a more accurate 
modulator block diagram is as in Fig. 7.66 [10]. In practice, this sampling restricts the useful frequencies 
of the ac variations to values much less than the switching frequency. The designer must ensure that the 
bandwidth of the control system be sufficiently less than the Nyquist rate fs/2. 
Significant high-frequency variations in the control signal v/t) can also alter the behavior of the 
pulse-width modulator. A common example is when vc(t) contains switching ripple, introduced by the 
feedback loop. This phenomenon has been analyzed by several authors [10,19], and effects of inductor 
current ripple on the transfer functions of current-programmed converters are investigated in Chapter 12. 
But it is generally best to avoid the case where vc(t) contains significant components at the switching fre-
quency or higher, since the pulse-width modulators of such systems exhibit poor noise immunity. 

256 
AC Equivalent Circuit Modeling 
1 
VM 
Sampler 
-_# 
d 
~ 
o--+---1.,~ 
Pulse-width modulator 
:. ................................................................ J 
Fig. 7.66 
A more accurate pulse-width modulator model, including sampling. 
7.7 
1. 
SUMMARY OF KEY POINTS 
The CCM converter analytical techniques of Chapters 2 and 3 can be extended to predict converter ac 
behavior. The key step is to average the converter waveforms over one switching period. This removes the 
switching harmonics, thereby exposing directly the desired de and low-frequency ac components of the 
waveforms. In particular, expressions for the averaged inductor voltages, capacitor currents, and converter 
input current are usually found. 
2. 
Since switching converters are nonlinear systems, it is desirable to construct small-signallinearized mod-
els. This is accomplished by perturbing and linearizing the averaged model about a quiescent operating 
point. 
3. 
Ac equivalent circuits can be constructed, in the same manner used in Chapter 3 to construct de equivalent 
circuits. If desired, the ac equivalent circuits may be refined to account for the effects of converter losses 
and other nonidealities. 
4. 
The state-space averaging method of Section 7.3 is essentially the same as the basic approach of Section 
7 .2, except that the formality of the state-space network description is used. The general results are listed 
in Section 7.3.2. 
5. 
The circuit averaging technique also yields equivalent results, but the derivation involves manipulation of 
circuits rather than equations. Switching elements are replaced by dependent voltage and current sources, 
whose waveforms are defined to be identical to the switch waveforms of the actual circuit. This leads to a 
circuit having a time-invariant topology. The waveforms are then averaged to remove the switching ripple, 
and perturbed and linearized about a quiescent operating point to obtain a small-signal model. 
6. 
When the switches are the only time-varying elements in the converter, then circuit averaging affects only 
the switch network. The converter model can then be derived by simply replacing the switch network with 
its averaged model. De and small-signal ac models of several common CCM switch networks are listed in 
Section 7.4.4. Conduction and switching losses can also be modeled using this approach. 
7. 
The canonical circuit describes the basic properties shared by all de-de PWM converters operating in the 
continuous conduction mode. At the heart of the model is the ideal 1 :M(D) transformer, introduced in 
Chapter 3 to represent the basic de-de conversion function, and generalized here to include ac variations. 
The converter reactive elements introduce an effective low-pass filter into the network. The model also 
includes independent sources that represent the effect of duty cycle variations. The parameter values in the 
canonical models of several basic converters are tabulated for easy reference. 
8. 
The conventional pulse-width modulator circuit has linear gain, dependent on the slope of the sawtooth 
waveform, or equivalently on its peak-to-peak magnitude. 

References 
257 
REFERENCES 
[1] 
R. D. MIDDLEBROOK and SLOBODAN CUK, "A General Unified Approach to Modeling Switching-Con-
verter Power Stages," International Journal of Electronics, Vol. 42, No.6, pp. 521-550, June 1977. 
[2] 
SLOBODAN CUK, "Modeling, Analysis, and Design of Switching Converters," Ph.D. thesis, California 
Institute of Technology, November 1976. 
[3] 
R. D. MIDDLEBROOK AND SLOBODAN CUK, "Modeling and Analysis Methods for De-to-De Switching 
Converters," Proceedings of the IEEE International Semiconductor Power Converter Conference, 1977 
Record, pp. 90-111, March 1977. Reprinted in Advances in Switched-Mode Power Conversion, Vol. 1, Irv-
ine: Teslaco, 1983. 
[4] 
G. W. WESTER and R. D. MIDDLEBROOK, "Low-Frequency Characterization of Switched De-De Convert-
ers," IEEE Transactions an Aerospace and Electronic Systems, Vol. AES-9, pp. 376-385, May 1973. 
[5] 
DANIEL M. MITCHELL, De-De Switching Regulator Analysis, New York: McGraw-Hill, 1988. 
(6] 
SETH R. SANDERS and GEORGE C. VERGESE, "Synthesis of Averaged Circuit Models for Switched Power 
Converters," IEEE Transactions on Circuits and Systems, Vol. 38, No.8, pp. 905-915, August 1991. 
[7] 
P. T. KREIN, J. BENTSMAN, R. M. BASS, and B. C. LESIEUTRE, "On the Use of Averaging for the Analysis 
of Power Electronic Systems," IEEE Transactions on Power Electronics, Vol. 5, No.2, pp. 182-190, April 
1990. 
[8] 
B. LEHMAN and R. M. BASS, "Switching Frequency Dependent Averaged Models for PWM DC-DC Con-
verters," IEEE Transactions on Power Electronics, Vol. 11, No. 1, pp. 89-98, January 1996. 
[9] 
R. M. BASS and J. SUN, "Averaging Under Large-Ripple Conditions," IEEE Power Electronics Specialists 
Conference, 1998 Record, pp. 630-632, May 1998. 
[10] 
ARTHUR R. BROWN and R. D. MIDDLEBROOK, "Sampled-Data Modeling of Switching Regulators," IEEE 
Power Electronics Specialists Conference, 1981 Record, pp. 349-369, June 1981. 
[11] 
R. D. MIDDLEBROOK, "Predicting Modulator Phase Lag in PWM Converter Feedback Loops," Proceed-
ings of the Eighth National Solid-State Power Conversion Conference (Powercon 8), April1981. 
[12] 
A. K!SLOVSKI, R. REDL, AND N. SOKAL, Dynamic Analysis of Switching-Mode DC/DC Converters, New 
York: Van Nostrand Reinhold, 1994. 
[13] 
R. TYMERSKI and V. VORPERIAN, "Generation, Classification and Analysis of Switched-Mode DC-to-DC 
Converters by the Use of Converter Cells," Proceedings of the 1986 International Telecommunications 
Energy Conference (INTELEC'86), pp. 181-195, October 1986. 
[14] 
V. VORPERIAN, R. TYMERSKI, and F. C. LEE, "Equivalent Circuit Models for Resonant and PWM 
Switches," IEEE Transactions on Power Electronics, Vol. 4, No.2, pp. 205-214, April1989. 
[15] 
V. VORPERIAN, "Simplified Analysis of PWM Converters Using the Model of the PWM Switch: Parts I 
and II," IEEE Transactions on Aerospace and Electronic Systems, Vol. AES-26, pp. 490-505, May 1990. 
[16] 
S. FREELAND and R. D. MIDDLEBROOK, "A Unified Analysis of Converters with Resonant Switches," 
IEEE Power Electronics Specialists Conference, 1987 Record, pp. 20-30. 

258 
AC Equivalent Circuit Modeling 
[17] 
ARTHUR WITULSKI and ROBERT ERICKSON, "Extension of State-Space Averaging to Resonant Switches 
-and Beyond," IEEE Transactions on Power Electronics, Vol. 5, No. 1, pp. 98-109, January 1990. 
[18] 
D. MAKSIMOVIC and S. CUK, "A Unified Analysis of PWM Converters in Discontinuous Modes," IEEE 
Transactions on Power Electronics, Vol. 6, No.3, pp. 476-490, July 1991. 
[19] 
D. J. SHORTT and F. C. LEE, "Extensions of the Discrete-Average Models for Converter Power Stages," 
IEEE Power Electronics Specialists Conference, 1983 Record, pp. 23-37, June 1983. 
[20] 
0. AL-NASEEM and R.W. ERICKSON, "Prediction of Switching Loss Variations by Averaged Switch Mod-
eling," IEEE Applied Power Electronics Conference, 2000 Record, pp. 242-248, February 2000. 
PROBLEMS 
7.1 
An ideal boost converter operates in the continuous conduction mode. 
(a) 
Determine the nonlinear averaged equations of this converter. 
(b) 
Now construct a small-signal ac model. Let 
(vg{t)) Ts = Vg + vg{t) 
d(t) = D + J(t) 
(i(t))T =I+i(t) 
s 
(v{tl)r =V+v(t) 
s 
where V8, D, I, and V are steady-state de values; v8(t) and d(t) are small ac variations in the power and 
control inputs; and i(t) and O(t) are the resulting small ac variations in the inductor current and output 
voltage, respectively. Show that the following model results: 
Large-signal de components 
Small-signal ac components 
O=-D'V + vg 
O=D'I -* 
L d~~) =- D'v(t) + V J(t) + v8(t) 
c dv(t) = D'i(t)- I d(t)- v(t) 
dt 
R 
7.2 
Construct an equivalent circuit that corresponds to the boost converter small-signal ac equations derived 
in Problem 7.1 (b). 
7.3 
Manipulate your boost converter equivalent circuit of Problem 7.2 into canonical form. Explain each 
step in your derivation. Verify that the elements in your canonical model agree with Table 7 .1. 
7.4 
The ideal current-fed bridge converter of Fig. 2.31 operates in the continuous conduction mode. 
(a) 
Determine the nonlinear averaged equations of this converter. 
(b) 
Perturb and linearize these equations, to determine the small-signal ac equations of the con-
verter. 

Problems 
259 
+ 
R 
v(t) 
Fig. 7.67 
Inverse SEPIC. Problem 7.7. 
(c) 
Construct a small-signal ac equivalent circuit model for this converter. 
7.5 
Construct a complete small-signal ac equivalent circuit model for the fly back converter shown in Fig. 
7 .18, operating in continuous conduction mode. The transformer contains magnetizing inductance L, 
referred to the primary. In addition, the transformer exhibits significant core loss, which can be modeled 
by a resistor Rc in parallel with the primary winding. All other elements are ideal. You may use any valid 
method to solve this problem. Your model should correctly predict variations in igCt). 
7.6 
Modeling the Cuk converter. You may use any valid method to solve this problem. 
(a) 
Derive the small-signal dynamic equations that model the ideal Cuk converter. 
(b) 
Construct a complete small-signal equivalent circuit model for the Cuk converter. 
7.7 
Modeling the inverse-SEPIC. You may use any valid method to solve this problem. 
(a) 
Derive the small-signal dynamic equations that model the converter shown in Fig. 7.67. 
(b) 
Construct a complete small-signal equivalent circuit model for the inverse-SEPIC. 
7.8 
Consider the nonideal buck converter of Fig. 7.68. The input voltage source vgCt) has internal resistance 
R8 • Other component nonidealities may be neglected. 
(a) 
Using the state-space averaging method, determine the small-signal ac equations that describe 
variations in i, v, and i8, which occur owing to variations in the transistor duty cycled and input 
voltage v8• 
(b) 
Construct an ac equivalent circuit model corresponding to your equations of part (a). 
(c) 
Solve your model to determine an expression for the small-signal control-to-output transfer 
function. 
L 
+ 
R 
v(t) 
Fig. 7.68 
Nonideal buck converter, Problem 7.8. 
7.9 
Use the circuit-averaging technique to derive the de and small-signal ac equivalent circuit of the buck 
converter with input filter, illustrated in Fig. 2.32. All elements are ideal. 

260 
AC Equivalent Circuit Modeling 
(a) 
2 
(b) 
L 
+ 
R 
v(t) 
Fig. 7.69 . Bridge inverter, Problem 7.11: (a) circuit, (b) large-signal averaged model. 
7.10 
A flyback converter operates in the continuous conduction mode; The MOSFET switch has on-resis-
tance Ron' and the secondary-side diode has a constant forward voltage drop V0 . The fly back transformer 
has primary winding resistance RP and secondary winding resistance R8 • 
(a) 
Derive the small-signal ac equations for this converter. 
(b) 
Derive a complete small-signal ac equivalent circuit model, which is valid in the continuous con-
duction mode and which correctly models the above losses, as well as the converter input and 
output ports. 
7.11 
Circuit averaging of the bridge inverter circuit of Fig. 7.69(a). 
(a) 
Show that the converter of Fig. 7.69(a) can be written in the electrically identical form shown in 
Fig. 7.69(b). Sketch the waveforms i1(t) and v1(t). 
(b) 
Use the circuit-averaging method to derive a large-signal averaged model for this converter. 
(c) 
Perturb and linearize your circuit model of part (b), to obtain a single equivalent circuit that 
models de and small-signal ac signals in the bridge inverter. 
7.12 
Use the circuit averaging method to derive an equivalent circuit that models de and small-signal ac sig-
nals in the buck-boost converter. You may assume that the converter operates in the continuous conduc-
tion mode, and that all elements are ideal. 
(a) 
Give a time-invariant electrically identical circuit, in which the switching elements are replaced 
by equivalent voltage and current sources. Define the waveforms of the sources. 
(b) 
Derive a large-signal averaged model for this converter. 
(c) 
Perturb and linearize your circuit model of part (b), to obtain a single equivalent circuit that 
models de and small-signal ac signals in the buck-boost converter. 
7.13 
The two-output flyback converter of Fig. 7.70(a) operates in the continuous conduction mode. It may be 
assumed that the converter is lossless. 
(a) 
Derive a small-signal ac equivalent circuit for this converter. 
(b) 
Show that the small-signar ac equivalent circuit for this two-output converter can be written in 
the generalized canonical form of Fig. 7.70(b). Give analytical expressions for the generators 
e(s) andj(s). 
7.14 
A pulse-width modulator circuit is constructed in which the sawtooth-wave generator is replaced by a 
triangle-wave generator, as illustrated in Fig. 7.7l(a). The triangle waveform is illustrated in Fig. 
7.71(b). 

Problems 
261 
(a) 
ip 
+ 
L 
v1(t) 
vgCt) 
+ 
-
+ 
-I 
v2(t) 
(b) 
e(s)d(s) 
+ 
Fig. 7.70 Two-output ftyback converter, Problem 7.13: (a) converter circuit, (b) small-signal ac 
equivalent circuit. 
Fig. 
7.71 
Pulse-width 
modulator, Problem 7.14. 
(a) ....--------., 
(b) 
Triangle 
wave 
generator 
Analog 
input 
Comparator 
b(t) 
PWM 
waveform 

262 
AC Equivalent Circuit Modeling 
(a) 
Determine the converter switching frequency, in Hz. 
(b) 
Determine the gain d(t)lv c(t) for this circuit. 
(c) 
Over what range ofvc is your answer to (b) valid? 
7.15 
Use the averaged switch modeling technique to derive an ac equivalent circuit model for the buck-boost 
converter of Fig. 7.31: 
(a) 
Replace the switches in Fig. 7.31 with the averaged switch model given in Fig. 7.50(c). 
(b) 
Compare your result with the model given in Fig. 7.16(b). Show that the two models predict the 
same small-signalline-to-output transferfunction Gv8(s) = V!v8• 
7.16 
Modify the CCM de and small-signal ac averaged switch models of Fig. 7.50, to account for MOSFET 
on-resistance Ron and diode forward voltage drop V 0 . 
7.17 
Use the averaged switch modeling technique to derive a de and ac equivalent circuit model for the fly-
back converter of Fig. 7.18. You can neglect all losses and the transformer leakage inductances. 
(a) 
Define a switch network containing the transistor Q1 and the diode D1 as in Fig. 7.39(a). Derive 
a large-signal averaged switch model of the switch network. The model should account for the 
transformer turns ratio n. 
(b) 
Perturb and linearize the model you derived in part (a) to obtain the de and ac small-signal aver-
aged switch model. Verify that for n = 1 your model reduces to the model shown in Fig. 7.39(d). 
(c) 
Using the averaged switch model you derived in part (b), sketch a complete de and small-signal 
ac model of the fly back converter. Solve the model for the steady-state conversion ratio M(D) = 
V/V8• 
(d) 
The averaged switch models you derived in parts (a) and (b) could be used in other converters 
having an isolation transformer. Which ones? 
7.18 
In the flyback converter of Fig. 7.18, the transistor on-resistance is Ron' and the diode forward voltage 
drop is V 0 . Other losses and the transformer leakage inductances can be neglected. Derive a de and 
small-signal ac averaged switch model for the switch network containing the transistor Q 1 and the diode 
D1. The model should account for the on-resistance Ron' the diode forward voltage drop V0 , and the 
transformer turns ratio n. 
7.19 
In the boost converter of Fig. 7.72(a), the v1(t) and iit) waveforms of Fig. 7.72(b) are observed. During 
the transistor turn-on transition, a reverse current flows through the diode which removes the diode 
stored charge. As illustrated in Fig. 7.72(b), the reverse current spike has area- Q, and duration t,. The 
inductor winding has resistance RL" You may neglect all losses other than the switching loss due to the 
diode stored charge and the conduction loss due to the inductor winding resistance. 
(a) 
Derive an averaged switch model for the boost switch network in Fig. 7.72(a). 
(b) 
Use your result of part (a) to sketch a de equivalent circuit model for the boost converter. 
(c) 
The diode stored charge can be expressed as a function of the current / 1 as: 
while the reverse recovery timet, is approximately constant. Given V8 = 100 V, D = 0.5,fs = 100kHz, 
kq = 100 nC/A 112, t, = 100 ns, RL = 0.1 Q, use a de sweep simulation to plot the converter efficiency as a 
function of the load current /LOAD in the range: 
1 A-5,/LOAD-5, lOA 

Problems 
263 
t·······································1 
(a) 
: 
: 
+ 
+ 
v(t) 
(b) 
------- T, 
Area - Q, 
Fig. 
7.72 Boost converter and waveforms illustrating reverse recovery of the diode. Averaged switch 
modeling in this converter is addressed in Problem 7.19. 

8 
Converter Transfer Functions 
The engineering design process is comprised of several major steps: 
1. 
Specifications and other design goals are defined. 
2. 
A circuit is proposed. This is a creative process that draws on the physical insight and experience of the 
engineer. 
3. 
The circuit is modeled. The converter power stage is modeled as described in Chapter 7. Components and 
other portions of the system are modeled as appropriate, often with vendor-supplied data. 
4. 
Design-oriented analysis of the circuit is performed. This involves development of equations that allow 
element values to be chosen such that specifications and design goals are met. In addition, it may be neces-
sary for the engineer to gain additional understanding and physical insight into the circuit behavior, so that 
the design can be improved by adding elements to the circuit or by changing circuit connections. 
5. 
Model verification. Predictions of the model are compared to a laboratory prototype, under nominal oper-
ating conditions. The model is refined as necessary, so that the model predictions agree with laboratory 
measurements. 
6. 
Worst-case analysis (or other reliability and production yield analysis) of the circuit is performed. This 
involves quantitative evaluation of the model performance, to judge whether specifications are met under 
all conditions. Computer simulation is well-suited to this task. 
7. 
Iteration. The above steps are repeated to improve the design until the worst-case behavior meets specifi-
cations, or until the reliability and production yield are acceptably high. 
This chapter covers techniques of design-oriented analysis, measurement of experimental transfer func-
tions, and computer simulation, as needed in steps 4, 5, and 6. 
Sections 8.1 to 8.3 discuss techniques for analysis and construction of the Bode plots of the con-
verter transfer functions, input impedance, and output impedance predicted by the equivalent circuit 

266 
Converter Transfer Functions 
L 
Output 
Line 
+ 
input 
vgCs) 
v(s) R 
zou/s) --
! 
d(s) I Control input 
Fig. 8.1 Small-signal equivalent circuit model of the buck-boost converter, as derived in Chapter 7. 
models of Chapter 7. For example, the small-signal equivalent circuit model of the buckcboost converter 
is illustrated in Fig. 7.17(c). This model is reproduced in Fig. 8.1, with the important inputs and terminal 
imped~nces identified. The line-to-output transfer function GvgCs) is found by setting duty cycle varia-
tions d(s) to zero, and then solving for the transfer function from vg(s) to v(s): 
(8.1) 
This transfer function describes how variations or disturbances in the applied input voltage vgCt) lead to 
disturbances in the output voltage v(t). It is important in design of an output voltage regulator. For exam-
ple, in an off-line power supply, the converter input voltage vgCt) contains undesired even harmonics of 
the ac power line voltage. The transfer function GvgCs) is used to determine the effect of these harmonics 
on the converter output voltage v(t). 
The control-to-output transfer function Gvis) is found by setting the inp~t voltage variations 
vgCs) to zero, and then solving the equivalent circuit model for v(s) as a function of d(s): 
(8.2) 
This transfer function describes how control input variations d(s) influence the output voltage v(s). In an 
output voltage regulator system, Gvis) is a key component of the loop gain and has a significant effect on 
regulator performance. 
The output impedance Zou/s) is found under the conditions that vgCs) and d(s) variations are set 
to zero. Zou/s) describes how variations in the load current affect the output voltage. This quantity is also 
important in voltage regulator design. It may be appropriate to define Zm11(s) either including or not 
including the load resistance R. 
The converter input impedance Z;11(s) plays a significant role when an electromagnetic interfer-
ence (EMI) filter is added at the converter power input. The relative magnitudes of Z;11 and the EMI filter 
output impedance influence whether the EMl filter disrupts the transfer function Gvis). Design of input 
EMI filters is the subject of Chapter 10. 
An objective of this chapter is the construction of Bode plots of the important transfer functions 
and terminal impedances of switching converters. For example, Fig. 8.2 illustrates the magnitude and 
phase plots of Gvis) for the buck-boost converter model of Fig. 8.1. Rules for construction of magnitude 
and phase asymptotes are reviewed in Section 8.1, including two types of features that often appear in 

8.1 
Review of Bode Plots 
267 
o· 
-90' 
-180' 
10!, 
-270' 
+-----+-----+-------1____;::~---------+ -270' 
1kHz 
10kHz 
100kHz 
1 MHz 
f 
Fig. 8.2 Bode plot of control-to-output transfer function predicted by the model of Fig. 8.1, with analytical 
expressions for the important features. 
converter transfer functions: resonances and right half-plane zeroes. Bode diagrams of the small-signal 
transfer functions of the buck-boost converter are derived in detail in Section 8.2, and the transfer func-
tions of the basic buck, boost, and buck-boost converters are tabulated. The physical origins of the right 
half-plane zero are also described. 
A difficulty usually encountered in circuit analysis (step 5 of the above list) is the complexity of 
the circuit model: practical circuits may contains hundreds of elements, and hence their analysis may 
leads to complicated derivations, intractable equations, and lots of algebra mistakes. Design-oriented 
analysis[!] is a collection of tools and techniques that can alleviate these problems. Some tools for 
approaching the design of a complicated converter system are described in this chapter. Writing the 
transfer functions in normalized form directly exposes the important features of the response. Analytical 
expressions for these features, as well as for the asymptotes, lead to simple equations that are useful in 
design. We!lcseparated roots of transfer function polynomials can be approximated in a simple way. Sec-
tion 8.3 describes a graphical method for constructing Bode plots of transfer functions and impedances, 
essentially by inspection. This method can: (1) reduce the amount of algebra and associated algebra mis-
takes; (2) lead to greater insight into circuit behavior, which can be applied to design the circuit; and 
(3) lead to the insight necessary to make suitable approximations that render the equations tractable. 
Experimental measurement of transfer functions and impedances (needed in step 4, model veri-
fication) is discussed in Section 8.5. Use of computer simulation to plot converter transfer functions (as 
needed in step 6, worst-case analysis) is covered in Appendix B. 
8.1 
REVIEW OF BODE PLOTS 
A Bode plot is a plot of the magnitude and phase of a transfer function or other complex-valued quantity, 
vs. frequency. Magnitude in decibels, and phase in degrees, are plotted vs. frequency, using semilogarith-
mic axes. The magnitude plot is effectively a log-log plot, since the magnitude is expressed in decibels 
and the frequency axis is logarithmic. 
The magnitude of a dimensionless quantity G can be expressed in decibels as follows: 

268 
Converter Transfer Functions 
II G lids= 20 log w(ll G II) 
(8.3) 
Table 8.1 
Expressing magnitudes in decibels 
Decibel values of some simple magnitudes are 
listed in Table 8.1. Care must be used when the 
magnitude is not dimensionless. Since it is not 
proper to take the logarithm of a quantity having 
dimensions, the magnitude must first be normal-
ized. For example, to express the magnitude of 
an impedance Z in decibels, we should normal-
ize by dividing by a base impedance Rbase: 
(8.4) 
Actual magnitude 
1/2 
1 
2 
5 = 10/2 
10 
1000 = 103 
Magnitude in dB 
-6dB 
OdB 
6dB 
20 dB- 6 dB= 14 dB 
20dB 
3·20 dB= 60 dB 
The value of Rbase is arbitrary, but we need to tell others what value we have used. So if II Z II is 5 Q, and 
we choose Rbase = 10 Q, then we can say that II Z /Ids= 20 log10(5 Q/lOQ) =- 6dB with respect to 10 Q. 
A common choice is Rbase = lQ; decibel impedances expressed with Rbase = 1 Q are said to be expressed 
in dBQ. So 5 Q is equivalent to 14 dBQ. Current switching harmonics at the input port of a converter are 
often expressed in dBJLA, or dB using a base current of 1 JLA: 60 dBJLA is equivalent to 1000 JLA, or 
1 rnA. 
The magnitude Bode plots of functions equal to powers off are linear. For example, suppose 
that the magnitude of a dimensionless quantity G(j) is 
(!)" 
11°11= To 
(8.5) 
where fo and n are constants. The magnitude in decibels is 
(8.6) 
This equation is plotted in Fig. 8.3, for several values of n. The magnitudes have value 1 ~ 0 dB at fre-
quency f = f0• They are linear functions of log10(j). The slope is the change in 1/ G /Ids arising from a unit 
change in log10(j); a unit increase in log10(j) corresponds to a factor of 10, or decade, increase inf From 
Eq. (8.6), a decade increase infleads to an increase in II G /Ids of 20n dB. Hence, the slope is 20n dB per 
decade. Equivalently, we can say that the slope is 20n log10(2)"' 6n dB per octave, where an octave is a 
factor of 2 change in frequency. In practice, the magnitudes of most frequency-dependent functions can 
usually be approximated over a limited range of frequencies by functions of the form (8.5); over this 
range of frequencies, the magnitude Bode plot is approximately linear with slope 20n dB/decade. 
A simple transfer function whose magnitude is of the form (8.5) is the pole at the origin: 
G(s) =-1-( ojo) 
(8.7) 
The magnitude is 

8.1 
Review of Bode Plots 
269 
O.!fo 
fo 
lOfo 
f 
log scale 
Fig. 8.3 
Magnitude Bode plots of functions which vary as f" are linear, with slope n dB per decade. 
II G(jcu) II= II L~ II= ( ~o) 
(8.8) 
If we define!= wl2n andf0 = oorJ2n, then Eq. (8.8) becomes 
(8.9) 
which is of the form of Eq. (8.5) with n = -1. As illustrated in Fig. 8.3, the magnitude Bode plot of the 
pole at the origin (8.7) has a -20 dB per decade slope, and passes through 0 dB at frequency f = f 0. 
8.1.1 
Single Pole Response 
Consider the simple R-C low-pass filter illustrated in Fig. 8.4. 
The transfer function is given by the voltage divider ratio 
1 
G(s) = v2(s) = 
sC 
vt(s) 
..l_ + R 
sC 
(8.1 0) 
This transfer function is a ratio of voltages, and hence is 
dimensionless. By multiplying the numerator and denomina-
tor by sC, we can express the transfer function as a rational 
fraction: 
G(s)=~1~ 
1 +sRC 
R 
+ 
c 
Fig. 8.4 
Simple R-C low-pass filter 
example. 
(8.11) 

270 
Converter Transfer Functions 
The transfer function now coincides with the following standard normalized form for a single pole: 
G(s)=-1-
( 1 + ~0) 
(8.12) 
The parameter w0 = 2nj0 is found by equating the coefficients of sin the denominators ofEqs. (8.11) and 
(8.12). The result is 
Wo =_j_ 
RC 
(8.13) 
Since R and Care real positive quantities, w0 is also real and positive. The denominator of Eq. (8.12) 
contains a root at s = -w0, and hence G(s) contains a real pole in the left half of the complex plane. 
To find the magnitude and phase of the transfer function, 
we let s = jw, where j is the square root of -1. We then find the mag-
Im( G(jw)) 
G(jw) 
nitude and phase of the resulting complex-valued function. With s = 
jw, Eq. (8.12) becomes 
G(jw) = ( 
1 
) 
l+}JQ. 
Wo 
(8.14) 
The complex-valued G(jw) is illustrated in Fig. 8.5, for one value of 
w. The magnitude is 
II G(jw) II= J [ 
Re (G(jw)) ] 2 + [ Im (G(jw)) ] 2 
1 
(8.15) 
Here, we have assumed that w0 is real. In decibels, the magnitude is 
Re(G(jw)) 
Fig. 8.5 Magnitude and phase of 
the complex-valued function G(}W). 
(8.16) 
The easy way to sketch the magnitude Bode plot of G is to investigate the asymptotic behavior for large 
and small frequency. 
For small frequency, w ~ w0 andf ~f0 , it is true that 
(8.17) 
The (w/w0f term of Eq. (8.15) is therefore much smaller than 1, and hence Eq. (8.15) becomes 
II G(jw) II~ Jr = 1 
(8.18) 
In decibels, the magnitude is approximately 

8.1 
Review of Bode Plots 
271 
Fig. 8.6 Magnitude asymptotes 
for the single real pole transfer 
function. 
II G(jro) llctB 
OdB 
0 dB +---..;;,.;;;;;;,... ____ 
....,...__ 
-20dB 
-40dB 
-20 dB/decade (ff' 
--60dB+------+-----i------+---------i 
O.lfo 
fo 
lOfo 
f 
~ G(jw) ~dB"' OdB 
(8.19) 
Thus, as illustrated in Fig. 8.6, at low frequency II G(jro) llctB is asymptotic to 0 dB. 
At high frequency, ro :$ ro0 and f :$ f 0• In this case, it is true that 
(8.20) 
We can then say that 
(8.21) 
Hence, Eq. (8.15) now becomes 
(!)-1 
~G(jw)ll"' m fo 
(8.22) 
This expression coincides with Eq. (8.5), with n = -1. So at high frequency, II G(jro) lldB has slope -20 dB 
per decade, as illustrated in Fig. 8.6. Thus, the asymptotes of II G(jro) II are equal to 1 at low frequency, 
and (f!f0t 1 at high frequency. The asymptotes intersect atf0. The actual magnitude tends toward these 
asymptotes at very low frequency and very high frequency. In the vicinity of the comer frequency f0, the 
actual curve deviates somewhat from the asymptotes. 
The deviation of the exact curve from the asymptotes can be found by simply evaluating 
Eq. (8.15). At the comer frequency f= f0, Eq. (8.15) becomes 
1 
12 
(8.23) 
In decibels, the magnitude is 
~ G(jw0) II dB = - 20 log 10 ( J 
1 + ( ~~) 
2 
) "' - 3 dB 
(8.24) 
So the actual curve deviates from the asymptotes by -3 dB at the comer frequency, as illustrated in 
Fig. 8.7. Similar arguments show that the actual curve deviates from the asymptotes by -1 dB atf=fof2 

272 
Converter Transfer Functions 
II G(jw) llctB 
Fig. 8.7 Deviation of the actual curve from 
the asymptotes, real pole. 
o 
dB i-7"";;~~::::::---,l·::: .. :::::::::I 3 dB 
! 
.... ..:+!dB 
fo 
j .... t 
-lOdB 
2fo 
-20dB 
-20 dB/decade 
-30dB +----~~~+------~-1 
f 
and atf= 2/0. 
The phase of G(jw) is 
LG(jw) = tan- 1 (Im(GUw))) 
Re(GUw)) 
(8.25) 
Insertion of the real and imaginary parts ofEq. (8.14) into Eq. (8.25) leads to 
LG(jw) =- tan- 1 ( : 0 ) 
(8.26) 
This function is plotted in Fig. 8.8. It tends to 0° at low frequency, and to -90° at high frequency. At the 
comer frequency f = / 0, the phase is -45". 
Since the high-frequency and low-frequency phase asymptotes do not intersect, we need a third 
asymptote to approximate the phase in the vicinity of the comer frequency f0• One way to do this is illus-
Fig. 8.8 Exact phase 
plot, single real pole. 
L.G(jw) 
00 
............. oo asymptote 
-15° 
-30° 
-450 
-60° 
-75° 
-90° -1--'---'-................... '-i---'--'---'-'-........,_,+-__,__,_..__,_u....u.+-.......o:;;::::::.a-~ 
0.01/0 
O.Ifo 
fo 
!Ofo 
100!0 
f 

Fig. 8.9 
One choice for 
the midfrequency phase 
asymptote, 
which 
cor-
rectly predicts the actual 
slope at f = f0. 
L..G(jw) 
8.1 
Review of Bode Plots 
273 
-30' 
-45' 
-60' 
-75' 
-90' +---'--'-~.L.LW+-_.._-'--'-'-'-'-'-'+--'--'-~ ........ f-......;;;=-~ 
0.01/0 
0.1/0 
fo 
fb = 4.81/0 
100/0 
f 
trated in Fig. 8.9, where the slope of the asymptote is chosen to be identical to the slope of the actual 
curve atf=f0. It can be shown that, with this choice, the asymptote intersection frequencies fa andfb are 
given by 
fa= foe-nf2"' 411 
fi, = foenf2"' 4.81 fo 
A simpler choice, which better approximates the actual curve, is 
(8.27) 
(8.28) 
This asymptote is compared to the actual curve in Fig. 8.10. The pole causes the phase to change over a 
frequency span of approximately two decades, centered at the comer frequency. The slope of the asymp-
tote in this frequency span is -45' per decade. At the break frequencies fa andfb, the actual phase devi-
ates from the asymptotes by tan-1(0.1) = 5.7'. 
The magnitude and phase asymptotes for the single-pole response are summarized in Fig. 8.11. 
It is good practice to consistently express single-pole transfer functions in the normalized form 
of Eq. (8.12). Both terms in the denominator of Eq. (8.12) are dimensionless, and the coefficient of s0 is 
unity. Equation (8.12) is easy to interpret, because of its normalized form. At low frequencies, where the 
(s/w0) term is small in magnitude, the transfer function is approximately equal to 1. At high frequencies, 
where the (s/w0) term has magnitude much greater than 1, the transfer function is approximately (s/w0t 1. 
This leads to a magnitude of (jlfot 1• The comer frequency is f0 = wof2n. So the transfer function is writ-
ten directly in terms of its salient features, that is, its asymptotes and its comer frequency. 

274 
Converter Transfer Functions 
LG(jw) 
-Is· 
-30. 
-45. 
-45·----
: ....... ... 
-6o· 
\ ·· .. · ..... 
-75. 
-----.....__ __ _ 
-90. -+----'--'--'--'-'--'-'-'+----'---'--'--'-'U...U.+---'---'---''--'-'--'--'-"l-....;;;:::z:::,.,_"""'"' 
O.OIJ0 
O.IJ0 
fo 
100/0 
f 
Fig. 8.10 
A simpler choice for the midfrequency phase asymptote, which better approximates the curve over the 
entire frequency range. 
II G(jw) llctB 
OdB 
:·:::··:::::::::J3dB 
l 
_____ __+1 dB 
fo 
i ----, 
2fo 
-20 dB/decade 
-45"/decade 
-4s·---, 
fo 
-9o· 
Fig. 8.11 
Summary of the magnitude and phase Bode plot for the single real pole. 

Fig. 8.12 Summary 
of the 
magnitude and phase Bode plot 
for the single real zero. 
II GUro) llcta 
8.1.2 
Single Zero Response 
OdB 
8.1 
Rt<View of Bode Plots 
275 
+20 dB/decade 
+90' 
A single zero response contains a root in the numerator of the transfer function, and can be written in the 
following normalized form: 
G(s) = (t + L) 
COo 
(8.29) 
This transfer function has magnitude 
(8.30) 
At low frequency,f <!0 = roJ2rc, the transfer function magnitude tends to 1 ~ 0 dB. At high frequency, 
f » f0, the transfer function magnitude tends to iflfo). As illustrated in Fig. 8.12, the high-frequency 
asymptote has slope +20 dB/decade. 
The phase is given by 
LGUro) = tan- 1 ( : 0 ) 
(8.31) 
With the exception of a minus sign, the phase is identical to Eq. (8.26). Hence, suitable asymptotes are as 
illustrated in Fig. 8.12. The phase tends to 0' at low frequency, and to +90' at high frequency. Over the 
intervalfoflO <f < 10f0, the phase asymptote has a slope of +45'/decade. 

276 
Converter Transfer Functions 
Fig. 8.13 Summary of the 
magnitude and phase Bode 
plot for the real RHP zero. 
II G(jffi) "dB 
8.1.3 
Right Half-Plane Zero 
+20 dB/decade 
2fo 
_o_dB ___ -r==---v.f:. -~~;:_;~:: 
-90" 
Right half-plane zeroes are often encountered in the small-signal transfer functions of switching convert-
ers. These terms have the following normalized form: 
(8.32) 
The root of Eq. (8.32) is positive, and hence lies in the right half of the complex s-plane. The right half-
plane zero is also sometimes called a nonminimum phase zero. Its normalized form, Eq. (8.32), resem-
bles the normalized form of the (left half-plane) zero ofEq. (8.29), with the exception of a minus sign in 
the coefficient of s. The minus sign causes a phase reversal at high frequency. 
The transfer function has magnitude 
(8.33) 
This expression is identical to Eq. (8.30). Hence, it is impossible to distinguish a right half-plane zero 
from a left half-plane zero by the magnitude alone. The phase is given by 
(8.34) 
This coincides with the expression for the phase of the single pole, Eq. (8.26). So the right half-plane 
zero exhibits the magnitude response of the left half-plane zero, but the phase response of the pole. Mag-
nitude and phase asymptotes are summarized in Fig. 8.13. 

8.1 
Review of Bode Plots 
277 
Fig. 8.14 Inversion of the fre-
quency axis: summary of the 
magnitude and phase Bode plots 
for the inverted real pole. 
8.1.4 
Frequency Inversion 
II G(jro) llcts 
L.G(jw) 
+90' 
3dBJ:::::::::··:::·! 
1dBL.... 
r 
r···
1 
1o 
0.5/0 
+20 dB/decade 
-45'/decade 
+45' ···, 
fo 
OdB 
0' 
lOfo 
Two other forms arise, from inversion of the frequency axis. The inverted pole has the transfer function 
G(s)=-( -1 -) 
1 
ffio 
+-y 
(8.35) 
As illustrated in Fig. 8.14, the inverted pole has a high-frequency gain of 1, and a low frequency asymp-
tote having a + 20 dB/decade slope. This form is useful for describing the gain of high-pass filters, and of 
other transfer functions where it is desired to emphasize the high frequency gain, with attenuation of low 
frequencies. Equation (8.35) is equivalent to 
{ Jo) 
G(s)=-( -) 
1 +..L 
ffio 
However, Eq. (8.35) more directly emphasizes that the high frequency gain is 1. 
The inverted zero has the form 
G(s) = ( 1 + ~0 ) 
(8.36) 
(8.37) 
As illustrated in Fig. 8.15, the inverted zero has a high-frequency gain asymptote equal to 1, and a low-
frequency asymptote having a slope equal to-20 dB/decade. An example of the use of this type of trans-

278 
Converter Transfer Functions 
II G(jw) llctB 
-20 dB/decade 
O.Sfo 
ldBL_ i 
r-----
Fig. 8.15 
Inversion of the fre-
quency axis: summary of the 
magnitude and phase Bode plot 
for the inverted real zero. 
3 dB 1::::::::: __ :::"'---: i --=~.....-::-.::::_ _ 
_:::__0 =dB=--
fer function is the proportional-plus-integral controller, discussed in connection with feedback loop 
design in the next chapter. Equation (8.37) is equivalent to 
(1 + _L) 
G(s)=~ 
( Dio) 
(8.38) 
However, Eq. (8.37) is the preferred form when it is desired to emphasize the value of the high-frequency 
gain asymptote. 
The use of frequency inversion is illustrated by example in the next section. 
8.1.5 
Combinations 
The Bode diagram of a transfer function containing several pole, zero, and gain terms, can be constructed 
by simple addition. At any given frequency, the magnitude (in decibels) of the composite transfer func-
tion is equal to the sum of the decibel magnitudes of the individual terms. Likewise, at a given frequency 
the phase of the composite transfer function is equal to the sum of the phases of the individual terms. 
For example, suppose that we have already constructed the Bode diagrams of two complex-val-
ued functions of w, G1(w) and Giw). These functions have magnitudes R1(w) and Riw), and phases 
81(w) and 8iw), respectively. It is desired to construct the Bode diagram of the product G3(w) = 
G1(w)G2(w). Let Giw) have magnitude R3(w), and phase 83(w). To find this magnitude and phase, we 
can express G1(w), Giw), and G3(w) in polar form: 

8.1 
Review of Bode Plots 
279 
G1(w) = R1(w) ei8 tCwl 
G2(w) = R2(w) ei82Cwl 
(8.39) 
G3(w) = R3(w) ei83Cwl 
The product G3(w) can then be expressed as 
(8.40) 
Simplification leads to 
(8.41) 
Hence, the composite phase is 
(8.42) 
The total magnitude is 
(8.43) 
When expressed in decibels, Eq. (8.43) becomes 
(8.44) 
So the composite phase is the sum of the individual phases, and when expressed in decibels, the compos-
ite magnitude is the sum of the individual magnitudes. The composite magnitude slope, in dB per 
decade, is therefore also the sum of the individual slopes in dB per decade. 
II Gil 
40dB 
20 dB 
OdB 
-20dB 
--40 dB 
-60dB 
II Gil 
OdB 
!1 
100Hz 
-20 dB/decade 
L ::. ;;:~, 
'j2,~,'-: ~~,{~: . --~ dB/~'~'. 
-45"/decade 
···... 
·· .. 
··... 
·····..... 
···· ... . 
··········1----·--····--·--------·····:::-.... ,j .......... .-::: ... ·· 
-90"/decade 
10f2 
lOft 
1kHz 
20kHz 
-45" /decade 
LG 
+------f----------+------t-------+------"i----+ -180" 
1Hz 
10Hz 
100Hz 
I kHz 
10kHz 
100kHz 
f 
Fig. 8.16 
Construction of magnitude and phase asymptotes for the transfer function of Eq.(8.45). Dashed line; 

280 
Converter Transfer Functions 
For example, consider construction of the Bode plot of the following transfer function: 
(8.45) 
where G0 = 40 ~ 32 dB,/1 = W/2n = 100 Hz,j2 = Wi2n = 2 kHz. This transfer function contains three 
terms: the gain G0, and the poles at frequenciesf1 and/2• The asymptotes for each of these terms are illus-
trated in Fig. 8.16. The gain G0 is a positive real number, and therefore contributes zero phase shift with 
the gain 32 dB. The poles at 100Hz and 2kHz each contribute asymptotes as in Fig. 8.11. 
At frequencies less than 100Hz, the G0 term contributes a gain magnitude of 32 dB, while the 
two poles each contribute magnitude asymptotes of 0 dB. So the low-frequency composite magnitude 
asymptote is 32 dB + 0 dB+ 0 dB= 32 dB. For frequencies between 100Hz and 2kHz, the G0 gain 
again contributes 32 dB, and the pole at 2 kHz continues to contribute a 0 dB magnitude asymptote. 
However, the pole at 100Hz now contributes a magnitude asymptote that decreases with a -20 dB per 
decade slope. The composite magnitude asymptote therefore also decreases with a -20 dB per decade 
slope, as illustrated in Fig. 8.16, For frequencies greater than 2kHz, the poles at 100Hz and 2kHz each 
contribute decreasing asymptotes having slopes of -20 dB/decade. The composite asymptote therefore 
decreases with a slope of -20 dB/decade -20 dB/decade= -40 dB/decade, as illustrated. 
The composite phase asymptote is also constructed in Fig. 8.16. Below 10Hz, all terms con-
tribute 0' asymptotes. For frequencies betweenfllO =10Hz, andfz/10 =200Hz, the pole atf1 contrib-
utes a decreasing phase asymptote having a slope of -45'/decade. Between 200Hz and 10/1 = 1 kHz, 
both poles contribute decreasing asymptotes with -45'/decade slopes; the composite slope is therefore 
-90'/decade. Between 1kHz and 10/2 =20kHz, the pole at/1 contributes a constant -90' phase asymp-
tote, while the pole atf2 contributes a decreasing asymptote with -45' /decade slope. The composite slope 
is then -45'/decade. For frequencies greater than 20kHz, both poles contribute constant -90' asymp-
totes, leading to a composite phase asymptote of -180'. 
As a second example, con-
sider the transfer function A(s) rep-
resented by the magnitude and 
phase asymptotes of Fig. 8.17. Let 
us write the transfer function that 
corresponds to these asymptotes. 
The de asymptote is A0. At comer 
II All 
LA 
0' 
10/1 
/ 2 /10 
+45'/dec 
0' 
f 1 /10 
lOfz 
frequency /p the asymptote slope 
increases from 0 dB/decade to +20 
dB/decade. Hence, there must be a 
zero at frequency / 1• At frequency 
/ 2, the asymptote slope decreases 
from +20 dB/decade to 0 dB/ 
decade. Therefore the transfer func-
Fig. 8.17 Magnitude and phase asymptotes of example transfer 
function A(s). 
tion contains a pole at frequency / 2• 
So we can express the transfer function as 
(8.46) 

8.1 
Review of Bode Plots 
281 
where ffi 1 and ffi2 are equal to 2nf1 and 2nf2, respectively. 
We can use Eq. (8.46) to derive analytical expressions for the asymptotes. For f <fp and letting 
s = jffi, we can see that the (s/ffi1) and (s/ffi2) terms each have magnitude less than 1. The asymptote is 
derived by neglecting these terms. Hence, the low-frequency magnitude asymptote is 
(8.47) 
Forf1 <f <f2, the numerator term (s/ffi 1) has magnitude greater than 1, while the denominator term (s/ffi2) 
has magnitude less than 1. The asymptote is derived by neglecting the smaller terms: 
-A II~Ljrn_A JQ__A j_ 
-
0 
1 
-
0 (!)I -
0 fi 
(8.48) 
This is the expression for the midfrequency magnitude asymptote of A(s). For f> f2, the (s/ffi 1) and (s/ffi2) 
terms each have magnitude greater than 1. The expression for the high-frequency asymptote is therefore: 
A (1+~1) 
-A II~Ljrn_A Ulz_A h. 
o(/+~z) 
-
o~~~ II . - owl- o 
fi 
s=)W 
2 S=]W 
(8.49) 
We can conclude that the high-frequency gain is 
(8.50) 
Thus, we can derive analytical expressions for the asymptotes. 
The transfer function A(s) can also be written in a second form, using inverted poles and zeroes. 
Suppose that A(s) represents the transfer function of a high-frequency amplifier, whose de gain is not 
important. We are then interested in expressing A(s) directly in terms of the high-frequency gain A=. We 
can view the transfer function as having an inverted pole at frequency f2, which introduces attenuation at 
frequencies less thanf2. In addition, there is an inverted zero atf= f 1. So A(s) could also be written 
(8.51) 
It can be verified that Eqs. (8.51) and (8.46) are equivalent. 

282 
Converter Transfer Functions 
8.1.6 
Quadratic Pole Response: Resonance 
L 
+ 
c 
R 
Consider next the transfer function G(s) of the two-pole 
low-pass filter of Fig. 8.i8. The buck converter contains 
a filter of this type. When manipulated into canonical 
form, the models of the boost and buck-boost also con-
tain similar filters. One can show that the transfer func-
tion of this network is 
Fig. 8.18 
Two-pole low-pass filter example. 
(8.52) 
This transfer function contains a second-order denominator polynomial, and is of the form 
(8.53) 
with a1 = UR and ~ = LC. 
To construct the Bode plot of this transfer function, we might try to factor the denominator into 
its two roots: 
(8.54) 
Use of the quadratic formula leads to the following expressions for the roots: 
(8.55) 
s2 = -- 1+ 
1--
al[ Maz] 
2az 
a~ 
(8.56) 
If 4a2 :::;; a 12, then the roots are real. Each real pole then exhibits a Bode diagram as derived in 
Section 8.1.1, and the composite Bode diagram can be constructed as described in Section 8.1.5 (but a 
better approach is described in Section 8.1.7). 
If 4a2 > a12, then the roots (8.55) and (8.56) are complex. In Section 8.1.1, the assumption was 
made that ro0 is real; hence, the results of that section cannot be applied to this case. We need to do some 
additional work, to determine the magnitude and phase for the case when the roots are complex. 
The transfer functions of Eqs. (8.52) and (8.53) can be written in the following standard nor-
malized form: 
G(s) = 
1 
2 
1 + 2~ L + (L) 
Wo 
Wo 
(8.57) 
If the coefficients a1 and az are real and positive, then the parameters 16 and ro0 are also real and positive. 
The parameter ro0 is again the angular comer frequency, and we can define fo = ro0/2n. The parameter 16 is 

8.1 
Review of Bode Plots 
283 
called the damping factor: s controls the shape of the transfer function in the vicinity off= f 0. An alter-
native standard normalized form is 
where 
G(s)-
1 
-1+-s-+(_§_)2 
Qwo 
Wo 
-
1 
Q- 2s 
(8.58) 
(8.59) 
The parameter Q is called the quality factor of the circuit, and is a measure of the dissipation in the sys-
tem. A more general definition of Q, for sinusoidal excitation of a passive element or network, is 
2 
(peak stored energy) 
Q = n (energy dissipated per cycle) 
(8.60) 
For a second-order passive system, Eqs. (8.59) and (8.60) are equivalent. We will see that the Q-factor 
has a very simple interpretation in the magnitude Bode diagrams of second-order transfer functions. 
Analytical expressions for the parameters Q and w0 can be found by equating like powers of s in 
the original transfer function, Eq. (8.52), and in the normalized form, Eq. (8.58). The result is 
Wo 
1 
fo = 2n = 2n/LC 
Q-R rc 
- v "'[ 
The roots s 1 and s2 of Eqs. (8.55) and (8.56) are real when Q::::; 0.5, and are complex when Q > 0.5. 
The magnitude of G is 
II G(jw) II= ---r=:=(1=_=( 
w=)2
1~)2 +=1=(=w=)2 
w0 
Q2 
CD0 
Asymptotes of II G II are illustrated in Fig. 8.19. At low frequencies, (w/w0) ~ 1, and hence 
II G 11--7 1 for w « w0 
II G(jw) llcts 
0 dB 
OdB 
-20 dB 
(ff 
-40dB 
-40 dB/decade 
-60dB 
O.lfo 
fo 
10f0 
f 
Fig. 8.19 
Magnitude asymptotes for the two-pole transfer function. 
(8.61) 
(8.62) 
(8.63) 

284 
Converter Transfer Functions 
At high frequencies where (ffi/ffi0) ~ 1, the (ffi/ffi0)4 term 
11 G 11 
dominates the expression inside the radical of Eq. (8.62). 
Hence, the high-frequency asymptote is 
_o_dB_==----4: 
(8.64) 
This expression coincides with Eq. (8.5), with n = -2. 
Therefore, the high-frequency asymptote has slope -40 dB/ 
decade. The asymptotes intersect at f = f0, and are indepen-
dent of Q. 
The parameter Q affects the deviation of the actual 
curve from the asymptotes, in the neighborhood of the cor-
Fig. 8.20 Important features of the magni-
tude Bode plot, for the two-pole transfer 
function. 
ner frequency f0• The exact magnitude at/= fo is found by substitution of ffi = ffio into Eq. (8.62): 
(8.65) 
So the exact transfer function has magnitude Q at the comer frequency f 0• In decibels, Eq. (8.65) is 
(8.66) 
So if, for example, Q = 2 => 6 dB, then the actual curve deviates from the asymptotes by 6 dB at the cor-
ner frequency f = f0. Salient features of the magnitude Bode plot of the second-order ·transfer function are 
summarized in Fig. 8.20. 
The phase of G is 
LG(jw) =- tan- 1 
(8.67) 
The phase tends too· at low frequency, and to -180• at high frequency. At/= f 0, the phase is -90·. As 
illustrated in Fig. 8.21, increasing the value of Q causes a sharper phase change between the o· and 
-180• asymptotes. We again need a midfrequency asymptote, to approximate the phase transition in the 
Increasing Q 
Fig. 8.21 
Phase plot, second-order poles. LG 
-90° 
Increasing Q causes a sharper phase change. 
-180° -1-----~-1----.::::==-~ 
0.1 
10 
fifo 

Fig. 8.22 One choice for the midfrequency 
phase asymptote of the two-pole response, 
which correctly predicts the actual slope at 
f=fo· 
Fig. 8.23 A simpler choice for the 
midfrequency phase asymptote, which 
better approximates the curve over the 
entire frequency range and is consistent 
with the asymptote used for real poles. 
8.1 
Review of Bode Plots 
285 
oo 
f~ 
0" ·························\\ 
L.G 
-90° 
-180°4---------------~----+---------~ 
0.1 
10 
fifo 
oo 
L.G 
-90° 
-180° -l-------~1----....:P~-~ 
0.1 
10 
fifo 
vicinity of the comer frequency f 0, as illustrated in Fig. 8.22. As in the case of the real single pole, we 
could choose the slope of this asymptote to be identical to the slope of the actual curve atf = f 0• It can be 
shown that this choice leads to the following asymptote break frequencies: 
J.=(enl2phfo 
1 
.fb = (ent2)zo fo 
A better choice, which is consistent with the approximation (8.28) used for the real single pole, is 
fa = w- 112Q fo 
.fb = 10112Q fo 
(8.68) 
(8.69) 
With this choice, the midfrequency asymptote has slope -180Q degrees per decade. The phase asymp-
totes are summarized in Fig. 8.23. With Q = 0.5, the phase changes from o· to -180. over a frequency 
span of approximately two decades, centered at the comer frequency f 0• Increasing the Q causes this fre-
quency span to decrease rapidly. 
Second-order response magnitude and phase curves are plotted in Figs. 8.24 and 8.25. 

286 
Converter Transfer Functions 
Fig. 8.24 Exact magnitude curves, two-
pole response, for several values of Q. 
Fig. 8.25 Exact phase curves, two-pole 
response, for several values of Q. 
II Gilds 
LG 
·---··············-·····r·····--·--------
10 dB +--+--+-+-+-+11-i-+-\\-----+---l 
........... j ......... ! 
... g;~:.[. 
i 
:Q=l 
........... 1Q·;;;;fi'"'f" 
··········-~······· . 
0.3 
0.5 
0.7 
2 
3 
fifo 
-135° +----i--i!--i!-+!-i!'-i-i! !H!-l\1--\-~~-+--+-*i'-i-if-i-'1 
-1800 ~:_::::_::::_::::.j_r_::::~J_:1l~-.j_t.j_tg~_;_1LI-.. _ .. -= ... ==i 
.. ·t==· ~~~~ 
0.1 
1 
fifo 
10 

8.1 
Review of Bode Plots 
287 
8.1.7 
The Low-Q Approximation 
As mentioned in Section 8.1.6, when the roots of second-order denominator polynomial of Eq. (8.53) are 
real, then we can factor the denominator, and construct the Bode diagram using the asymptotes for real 
poles. We would then use the following normalized form: 
(8.70) 
This is a particularly desirable approach when the comer frequencies w1 and w2 are well separated in 
value. 
The difficulty in this procedure lies in the complexity of the quadratic formula used to find the 
corner frequencies. Expressing the corner frequencies w1 and w2 in terms of the circuit elements R, L, C, 
etc., invariably leads to complicated and unilluminating expressions, especially when the circuit contains 
many elements. Even in the case of the simple circuit of Fig. 8.18, whose transfer function is given by 
Eq. (8.52), the conventional quadratic formula leads to the following complicated formula for the corner 
frequencies: 
(8.71) 
This equation yields essentially no insight regarding how the corner frequencies depend on the element 
values. For example, it can be shown that when the comer frequencies are well separated in value, they 
can be expressed with high accuracy by the much simpler relations 
(1) 
_ R 
Ol _ 1 
t-y;, 
2- RC 
(8.72) 
In this case, w1 is essentially independent of the value of C, and w2 is essentially independent of L, yet 
Eq. (8.71) apparently predicts that both corner frequencies are dependent on all element values. The sim-
ple expressions of Eq. (8.72) are far preferable to Eq. (8.71), and can be easily derived using the low-Q 
approximation [2]. 
Let us assume that the transfer function has been expressed in the standard normalized form of 
Eq. (8.58), reproduced below: 
G(s)-
1 · 
- 1 + _s_ + (_s__)2 
QOlo 
Olo 
(8.73) 
For Q :<::; 0.5, let us use the quadratic formula to write the real roots of the denominator polynomial of 
Eq. (8.73) as 
(8.74) 
(8.75) 

288 
Converter Transfer Functions 
F(Q) 
0.75 
Fig. 8.26 
F(Q) vs. Q, as given by 
Eq. (8.77). The approximation F(Q) "" 1 is 
within 10% of the exact value for Q < 3. 
0.5 
······················································-········································· 
0.25 
0 
0 
0.1 
0.2 
0.3 
0.4 
0.5 
Q 
The comer frequency w2 can be expressed 
(8.76) 
where F(Q) is defined as [2]: 
F(Q) =-! ( 
1 + J 1 - 4Q 2 ) 
(8.77) 
Note that, when Q ~ 0.5, then 4Q2 ~ 1 and F(Q) is approximately equal to 1. We then obtain 
Wz""~ forQ~-! 
(8.78) 
The function F(Q) is plotted in Fig. 8.26. It can be seen that F(Q) approaches 1 very rapidly as Q 
decreases below 0.5. 
To derive a similar approximation for WI' we can multiply and divide Eq. (8.74) by F(Q), 
Eq. (8.77). Upon simplification of the numerator, we obtain 
(8.79) 
Again, F(Q) tends to 1 for small Q. Hence, w1 can be approximated as 
(8.80) 
Magnitude asymptotes for the low-Q case are summarized in Fig. 8.27. For Q < 0.5, the two 
poles at w0 split into real poles. One real pole occurs at comer frequency w1 < w0, while the other occurs 
at corner frequency w2 > w0• The corner frequencies are easily approximated, using Eqs. (8.78) and 
(8.80). 
For the filter circuit of Fig. 8.18, the parameters Q and w0 are given by Eq. (8.61). For the case 
when Q ~ 0.5, we can derive the following analytical expressions for the comer frequencies, using 
Eqs. (8.78) and (8.80): 

Fig. 8.27 Magnitude asymptotes predicted 
by the low-Q approximation. Real poles occur 
at frequencies QJ0 andfrJQ. 
II G llcts 
OdB 
8.1 
Review of Bode Plots 
289 
(8.81) 
So the low-Q approximation allows us to derive simple design-oriented analytical expressions for the 
comer frequencies. 
8.1.8 
Approximate Roots of an Arbitrary-Degree Polynomial 
The low-Q approximation can be generalized, to find approximate analytical expressions for the roots of 
the n'"-order polynomial 
(8.82) 
It is desired to factor the polynomial P(s) into the form 
(8.83) 
In a real circuit, the coefficients al' ... ,an are real, while the time constants "tp ... , "tn may be either real or 
complex. Very often, some or all of the time constants are well separated in value, and depend in a very 
simple way on the circuit element values. In such cases, simple approximate analytical expressions for 
the time constants can be derived. 
The time constants Tp ... , "tn can be related to the original coefficients al' ... , an by multiplying 
out Eq. (8.83). The result is 
a I = 1: I + 1:2 + • •. + 1:, 
a2 = 1:1(1:2 + ··· + 1:,) + 1:2(1:3 + ··· + 1:,) + ··· 
a3 = 1:11:z(1:3 + ··· + 1:,) + 1:z1:3(1:4 + ··· + 1:,) + ··· 
(8.84) 
General solution of this system of equations amounts to exact factoring of the arbitrary degree polyno-
mial, a hopeless task. Nonetheless, Eq. (8.84) does suggest a way to approximate the roots. 
Suppose that all of the time constants 1:1' ... , "tn are real and well separated in value. We can fur-
ther assume, without loss of generality, that the time constants are arranged in decreasing order of magni-

290 
Converter Transfer Functions 
tude: 
(8.85) 
When the inequalities of Eq. (8.85) are satisfied, then the expressions for a" ... , an of Eq. (8.84) are each 
dominated by their first terms: 
a1 "''t1 
Gz"' 't1't2 
a3 "''t1'tz't3 
These expressions can now be solved for the time constants, with the result 
Hence, if 
then the polynomial P(s) given by Eq. (8.82) has the approximate factorization 
(8.86) 
(8.87) 
(8.88) 
(8.89) 
Note that if the original coefficients in Eq. (8.82) are simple functions of the circuit elements, then the 
approximate roots given by Eq. (8.89) are similar simple functions of the circuit elements. So approxi-
mate analytical expressions for the roots can be obtained. Numerical values are substituted into 
Eq. (8.88) to justify the approximation. 
In the case where two of the roots are not well separated, then one of the inequalities of 
Eq. (8.88) is violated. We can then leave the corresponding terms in quadratic form. For example, sup-
pose that inequality k is not satisfied: 
(8.90) 
Then an approximate factorization is 

8.1 
Review of Bode Plots 
291 
( 
) ( 
a2 ) 
( 
ak 
ak+ 1 2) 
( 
an 
) 
P(s)"' 1+a1 s 1+-s ··· 1+--s +--s ··· 1+--s 
ai 
ak-1 
ak-1 
an-i 
(8.91) 
The conditions for accuracy of this approximation are 
(8.92) 
Complex conjugate roots can be approximated in this manner. 
When the first inequality ofEq. (8.88) is violated, that is, 
(8.93) 
then the first two roots should be left in quadratic form: 
(8.94) 
This approximation is justified provided that 
(8.95) 
If none of the above approximations is justified, then there are three or more roots that are close in mag-
nitude. One must then resort to cubic or higher-order forms. 
As an example, consider the damped EMI filter illustrated in Fig. 8.28. Filters such as this are 
typically placed at the power input of a converter, to attenuate the switching harmonics present in the 
converter input current. By circuit analysis, on can show that this filter exhibits the following transfer 
function: 
L +L 
i (s) 
1 +s-1--2 
G(s)=-
8 -= 
R 
ic(s) 
1 
Li + L2 
2L C 
3 LIL2C 
+s--R-+s 
I +s -R-
(8.96) 
This transfer function contains a third-order denominator, with the following coefficients: 
Converter 
c 
Fig. 8.28 
Input EMI filter example. 

292 
Converter Transfer Functions 
L1 +Lz 
a1=-R-
a2=L1C 
L 1L2C 
a3=-R-
(8.97) 
It is desired to factor the denominator, to obtain analytical expressions for the poles. The correct way to 
do this depends on the numerical values of R, L" L2, and C. When the roots are real and well separated, 
then Eq. (8.89) predicts that the denominator can be factored as follows: 
( 1 + s L1; Lz) ( 1 + sRC L 1~IL2 ) ( 1 + s ~z) 
(8.98) 
According to Eq. (8.88), this approximation is justified provided that 
(8.99) 
These inequalities cannot be satisfied unless L1 ~ L2. When L1 ~ L2, then Eq. (8.99) can be further sim-
plified to 
!:J_~ RC~ L2 
R 
R 
The approximate factorization, Eq. (8.98), can then be further simplified to 
(8.100) 
(8.101) 
Thus, in this case the transfer function contains three well separated real poles. Equations (8.98) and 
(8.101) represent approximate analytical factorizations of the denominator of Eq. (8.96). Although 
numerical values must be substituted into Eqs. (8.99) or (8.100) to justify the approximation, we can 
nonetheless express Eqs. (8.98) and (8.101) as analytical functions of L1, ~. R, and C. Equations (8.98) 
and (8.101) are design-oriented, because they yield insight into how the element values can be chosen 
such that given specified pole frequencies are obtained. 
When the second inequality of Eq. (8.99) is violated, 
(8.102) 
then the second and third roots should be left in quadratic form: 
( 1 
+s L 1 ; L2 ) ( 1 
+ sRC L 1 ~1 L2 + s2 L diL2 C) 
(8.103) 
This expression follows from Eq. (8.91), with k = 2. Equation (8.92) predicts that this approximation is 
justified provided that 

8.2 Analysis of Converter Transfer Functions 
293 
Ll +L2 ~ RC-L_l_ ~ LdiL2 RC 
(8.104) 
R 
L 1 +L2 
L 1 +L2 
In application ofEq. (8.92), we take a0 to be equal to 1. The inequalities of Eq. (8.104) can be simplified 
to obtain 
L 
and 
J! ~Rc 
(8.105) 
Note that it is no longer required that RC ~ Lz!R. Equation (8.105) implies that factorization (8.103) can 
be further simplified to 
( 1 + s ~1 ) ( 1 + sRC + s2L2C) 
(8.106) 
Thus, for this case, the transfer function contains a low-frequency pole that is well separated from a high-
frequency quadratic pole pair. Again, the factored result (8.106) is expressed as an analytical function of 
the element values, and consequently is design-oriented. 
In the case where the first inequality ofEq. (8.99) is violated: 
Ll +L2 :f;> RC_L_l_ ~ L2 
R 
L 1 +L2 
R 
(8.107) 
then the first and second roots should be left in quadratic form: 
(8.108) 
This expression follows directly from Eq. (8.94). Equation (8.95) predicts that this approximation is jus-
tified provided that 
that is, 
L 
and 
RC~ i 
(8.109) 
(8.110) 
For this case, the transfer function contains a low-frequency quadratic pole pair that is well separated 
from a high-frequency real pole. If none of the above approximations are justified, then all three of the 
roots are similar in magnitude. We must then finq other means of dealing with the original cubic polyno-
mial. Design of input filters, including the filter of Fig. 8.28, is covered in Chapter 10. 
8.2 
ANALYSIS OF CONVERTER TRANSFER FUNCTIONS 
Let us next derive analytical expressions for the poles, zeroes, and asymptote gains in the transfer func-
tions of the basic converters. 

294 
Converter Transfer Functions 
+ 
C v(s) 
R 
Fig. 8.29 Buck-boost converter equivalent circuit derived in Section 7.2. 
8.2.1 
Example: Transfer Functions of the Buck-Boost Converter 
The small-signal equivalent circuit model of the buck-boost converter is derived in Section 7.2, with the 
result [Fig. 7.16(b)] repeated in Fig. 8.29. Let us derive and plot the control-to-output and line-to-output 
transfer functions for this circuit. 
The converter contains two independent ac inputs: the control input d(s) and the line input ilgCs). 
The ac output voltage variations v(s) can be expressed as the superposition of terms arising from these 
two inputs: 
(8.111) 
Hence, the transfer functions Gvj,s) and Gv/s) can be defined as 
v(s) I 
v(s) I 
Gvf,s) = -,-
and Gvg(s) = -;;---( ) 
d(s) _ 
vg s 
vg<s)=O 
d(s)=O 
(8.112) 
To find the line-to-output transfer function GvgCs), we set the d sources to zero as in Fig. 8.30(a). We can 
then push the vgCs) source and the inductor through the transformers, to obtain the circuit of Fig. 8.30(b). 
The transfer function GvgCs) is found using the voltage divider formula: 
(a) 
1 :D 
D': 1 
+ 
c v(s) 
R 
(b) 
+ 
c v(s) 
R 
Fig. 8.30 Manipulation of buck-boost equivalent circuit to find the line-to-output transfer function GvgCs): 
(a) set d sources to zero; (b) push inductor and i/8 source through transformers. 

8.2 
Analysis of Converter Transfer Functions 
295 
v(s) I 
G,is) = v (s) . 
g 
d(s)=O 
We next expand the parallel combination, and express as a rational fraction: 
G (s) = (- D) ( ~) 
vg 
D' 
sL 
( 
R 
) 
D' 2 + 1 +sRC 
(8.113) 
(8.114) 
We aren't done yet-the next step is to manipulate the expression into normalized form, such that the 
coefficients of s0 in the numerator and denominator polynomials are equal to one. This can be accom-
plished by dividing the numerator and denominator by R: 
G ( )- v(s) I 
-(-12_) 
1 
"8 s- v (s) . 
-
D' 1 +s-L-+sz LC 
g 
d(s)=O 
D'l R 
D'2 
(8.115) 
Thus, the line-to-output transfer function contains a de gain Ggo and a quadratic pole pair: 
(8.116) 
Analytical expressions for the salient features of the line-to-output transfer function are found by equat-
ing like terms in Eqs. (8.115) and (8.116). The de gain is 
G -
D 
go--D' 
By equating the coefficients of s2 in the denominators of Eqs. (8.115) and (8.116), we obtain 
Hence, the angular comer frequency is 
D' 
Olo = .;rc 
By equating coefficients of sin the denominators of Eqs. (8.115) and (8.116), we obtain 
Elimination of w0 using Eq. (8.119) and solution for Q leads to 
(8.117) 
(8.118) 
(8.119) 
(8.120) 

296 
Converter Transfer Functions 
(a) 
+ 
Id(s) 
c v(s) 
R 
(b) 
+ 
c 
v(s) 
R 
Fig. 8.31 
Manipulation of buck-boost equivalent circuit to find the control-to-output transfer function Gwfs): 
(a) set v8 source to zero; (b) push inductor and voltage source through transformer. 
Q -D'R fC 
-
vr 
(8.121) 
Equations (8.117), (8.119), and (8.121) are the desired results in the analysis of the line-to-output trans-
fer function. These expressions are useful not only in analysis situations, where it is desired to find 
numerical values of the salient features G gO• w0, and Q, but also in design situations, where it is desired to 
select numerical values for R, L, and C such that given values of the salient features are obtained. 
Derivation of the control-to-output transfer function Gvis) is complicated by the presence in 
Fig. 8.29 of three generators that depend on d(s). One good way to find Gvis) is to manipulate the cir-
cuit model as in the derivation of the canonical model, Fig. 7.60. Another approach, used here, employs 
the principle of superposition. First, ·we set the v8 source to zero. This shorts the input to the l:D _!rans-
former, and we are left with the circuit illustrated in Fig. 8.31(a). Next, we push the inductor and d volt-
age source through the D':l transformer, as in Fig. 8.31(b). 
Figure 8.31(b) contains a J-dependent voltage source and a J-dependent current source. The 
transfer function Gvis) can therefore be expressed as a superposition of terms arising from these two 
sources. When the current source is set to zero (i.e., open-circuited), the circuit of Fig. 8.32(a) is 
obtained. The output v(s) can then be expressed as 
v(s) -(-V
8-V) 
(Ru~) 
d(s) -
D' 
.4_ + (R II _l_) 
D'z 
sC 
(8.122) 
When the voltage source is set to zero (i.e., short-circuited), Fig. 8.3l(b) reduces to the circuit illustrated 
in Fig. 8.32(b). The output v(s) can then be expressed as 
~(s) =I (_g,_ II R II _l_) 
d(s) 
D'2 
sC 
(8.123) 
The transfer function Gvis) is the sum ofEqs. (8.122) and (8.123): 

8.2 Analysis of Converter Transfer Functions 
297 
(a) 
+ 
V8 - V , 
c 
v(s) 
R 
Fig. 8.32 Solution of the model of Fig. 
--rr-d(s) 
8.32(b) by superposition: (a) current 
source set to zero; (b) voltage source set 
to zero. 
(b) 
+ 
Id(s) 
c 
v(s) 
R 
(. V
8-V) 
(RIIst) 
(sL 
1) 
Gvis)= ---u- .4...+(R _L) +I D' 2 11RII sC 
(8.124) 
D'2 
II sC 
By algebraic manipulation, one can reduce this expression to 
(1-s 
Ll 
) 
D' V -V 
v(s) I 
( V8 - v) 
( 8 
) 
G is)=-,-
= ---u-
v 
d(s) v (s)=O 
(1 + s___l,_ + s2LC) 
8 
D' 2R· 
D' 2 
(8.125) 
This equation is of the form 
(8.126) 
The denominators ofEq. (8.125) and (8.115) are identical, and hence Gvis) and Gvis) share the same m0 
and Q, given by Eqs. (8.119) and (8.121). The de gain is 
(8.127) 
The angular frequency of the zero is found by equating coefficients of s in the numerators of Eqs. (8.125) 
and (8.126). One obtains 
(RHP) 
(8.128) 
This zero lies in the right half-plane. Equations (8.127) and (8.128) have been simplified by use of the de 
relationships 

298 
Converter Transfer Functions 
(8.129) 
Equations (8.119), (8.121), (8.127), and (8.128) constitute the results of the analysis of the control-to-
output transfer function: analytical expressions for the salient features w0, Q, G dO' and wz. These expres-
sions can be used to choose the element values such that given desired values of the salient features are 
obtained. 
Having found analytical expressions for the salient features of the transfer functions, we can 
now plug in numerical values and construct the Bode plot. Suppose that we are given the following val-
ues: 
D=0.6 
R= lOQ 
vg = 30V 
L= 160J.!H 
C= 160 J.!F 
(8.130) 
We can evaluate Eqs. (8.117), (8.119), (8.121), (8.127), and (8.128), to determine numerical values of the 
salient features of the transfer functions. The results are: 
I G gO I = g. = 1.5 => 3.5 dB 
I vi 
I Gdo I= DD' = 187.5 V => 45.5 dBV 
fr = Wo = ____Q'___ = 400 Hz 
0 
2n 
2n/LC 
,(C 
Q=DRy L =4=> 12dB 
w 
D'zR 
h = 2~ = 2nDL = 2.65 kHz 
(8.131) 
The Bode plot of the magnitude and phase of Gvd is constructed in Fig. 8.33. The transfer function con-
tains a de gain of 45.5 dBV, resonant poles at 400Hz having a Q of 4 => 12 dB, and a right half-plane 
zero at 2.65 kHz. The resonant poles contribute -180' to the high-frequency phase asymptote, while the 
right half-plane zero contributes -90'. In addition, the inverting characteristic of the buck-boost con-
verter leads to a 180' phase reversal, not included in Fig. 8.33. 
The Bode plot of the magnitude and phase of the line-to-output transfer function Gvg is con-
structed in Fig. 8.34. This transfer function contains the same resonant poles at 400 Hz, but is missing 
the right half-plane zero. The de gain Ggo is equal to the conversion ratio M(D) of the converter. Again, 
the 180' phase reversal, caused by the inverting characteristic of the buck-boost converter, is not included 
in Fig. 8.34. 

8.2 
Analysis of Converter Transfer Functions 
299 
80dBV 
II Gvd II 
II Gvd II 
L Gvd 
60dBV Gd0=187V 
=} 45.5 dBV 
40dBV 
20dBV 
w-t/2Q fo 
00 
300Hz 
OdBV 
00 
L. Gvd 
!, 110 
-20dBV 
260Hz 
-90° 
-40dBV 
10f, 
-180° 
26kHz 
-270° 
-270° 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
1 MHz 
f 
Fig. 8.33 
Bode plot of the control-to-output transfer function Gvd' buck-boost converter example. Phase reversal 
owing to output voltage inversion is not included. 
-180° 
,_ _________ -+ -180° 
4-----t---------+------+------+ -270° 
10kHz 
100kHz 
Fig. 8.34 
Bode plot of the line-to-output transfer function Gvg' buck-boost converter example. Phase reversal 
owing to output voltage reversal is not included. 

300 
Converter Transfer Functions 
Table 8.2 Salient features of the small-signal CCM transfer functions of some basic de-de converters 
Converter 
Ggo 
GdO 
Wo 
Q 
Buck 
D 
v 
1 
Rjf 
75 
.fLE 
Boost 
1 
v 
D' 
D'Rff 
D' 
D' 
.fLE 
Buck-boost 
D 
v 
D' 
D'Rff 
-D' 
DD' 
.fLE 
8.2.2 
Transfer Functions of Some Basic CCM Converters 
The salient features of the line-to-output and control-to-output transfer functions of the basic buck, 
boost, and buck-boost converters are summarized in Table 8.2. In each case, the control-to-output trans-
fer function is of the form 
GvJ...s) = GdO ( 
) 
1 + _s_ + (_§_)2 
Qwo 
Wo 
(8.132) 
and the line-to-output transfer function is of the form 
(8.133) 
The boost and buck-boost converters exhibit control-to-output transfer functions containing two poles 
and a right half-plane zero. The buck converter GvgCs) exhibits two poles but no zero. The line-to-output 
transfer functions of all three ideal converters contain two poles and no zeroes. 
These results can be easily adapted to transformer-isolated versions of the buck, boost, and 
buck-boost converters. The transformer has negligible effect on the transfer functions GvgCs) and Gvis), 
other than introduction of a turns ratio. For example, when the transformer of the bridge topology is 
driven symmetrically, its magnetizing inductance does not contribute dynamics to the converter small-
signal transfer functions. Likewise, when the transformer magnetizing inductance of the forward con-
verter is reset by the input voltage v8, as in Fig. 6.23 or 6.28, then it also contributes negligible dynamics. 
In all transformer-isolated converters based on the buck, boost, and buck-boost converters, the line-to-
output transfer function Gv/s) should be multiplied by the transformer turns ratio; the transfer functions 
(8.132) and (8.133) and the parameters listed in Table 8.2 can otherwise be directly applied. 
8.2.3 
Physical Origins of the Right Half-Plane Zero in Converters 
Figure 8.35 contains a block diagram that illustrates the behavior of the right half-plane zero. At low fre-
quencies, the gain (s/mz) has negligible magnitude, and hence uout "' uin' At high frequencies, where the 

8.2 Analysis of Converter Transfer Functions 
301 
Fig. 8.35 
Block diagram having a right half-plane 
zero transfer function, as in Eq. (8.32), with w0 = (.1)2• 
U;n(s) 
magnitude of the gain (s/W2) is much greater than 1, uout"'- (siW 2)u;n· The negative sign causes a phase 
reversal at high frequency. The implication for the transient response is that the output initially tends in 
the opposite direction of the final value. 
We have seen that the control-to-output transfer functions of the boost and buck-boost convert-
ers, Fig. 8.36, exhibit RHP zeroes. Typical transient response waveforms for a step change in duty cycle 
are illustrated in Fig. 8.37. For this example, the converter initially operates in equilibrium, at d = 0.4 
and d = 0.6. Equilibrium inductor current iL(t), diode current iv(t), and output voltage v(t) waveforms are 
illustrated. The average diode current is 
(8.134) 
By capacitor charge balance, this average diode current is equal to the de load current when the converter 
operates in equilibrium. At timet= fp the duty cycle is increased to 0.6. In consequence, d decreases to 
0.4. The average diode current, given by Eq. (8.134), therefore decreases, and the output capacitor begins 
to discharge. The output voltage magnitude initially decreases as illustrated. 
(a) 
L 
+ 
c 
R 
v 
(b) 
iv(t) 
2 
+ 
iL(t) 
c 
R 
vg 
v 
L 
Fig. 8.36 Two basic converters whose CCM control-to-output transfer functions exhibit RHP zeroes: (a) boost, 
(b) buck-boost. 

302 
Converter Transfer Functions 
Fig. 8.37 
Waveforms of the converters 
of Fig. 8.36, for a step response in duty 
cycle. The average diode current and out-
put voltage initially decrease, as predicted 
by the RHP zero. Eventually, the inductor 
current increases, causing the average 
diode current and the output voltage to 
increase. 
I v(t) I 
! 
d = 0.4 ' d = 0.6 
~_______. 
! 
The increased duty cycle causes the inductor current to slowly increase, and hence the average 
diode current eventually exceeds its original d = 0.4 equilibrium value. The output voltage eventually 
increases in magnitude, to the new equilibrium value corresponding to d = 0.6. 
The presence of a right half-plane zero tends to destabilize wide-bandwidth feedback loops, 
because during a transient the output initially changes in the wrong direction. The phase margin test for 
feedback loop stability is discussed in the next chapter; when a RHP zero is present, it is difficult to 
obtain an adequate phase margin in conventional single-loop feedback systems having wide bandwidth. 
Prediction of the right half-plane zero, and the consequent explanation of why the feedback loops con-
trolling CCM boost and buck-boost converters tend to oscillate, was one of the early successes of aver-
aged converter modeling. 
8.3 
GRAPHICAL CONSTRUCTION OF IMPEDANCES AND TRANSFER FUNCTIONS 
Often, we can draw approximate Bode diagrams by inspection, without large amounts of messy algebra 
and the inevitable associated algebra mistakes. A great deal of insight can be gained into the operation of 
the circuit using this method. It becomes clear which components dominate the circuit response at vari-
ous frequencies, and so suitable approximations become obvious. Analytical expressions for the approx-
imate corner frequencies and asymptotes can be obtained directly. Impedances and transfer functions of 
quite complicated networks can be constructed. Thus insight can be gained, so that the design engineer 

8.3 
Graphical Construction of Impedances and Transfer Functions 
303 
can modify the circuit to obtain a desired frequency response. 
The graphical construction method, also known as "doing algebra on the graph," involves use of 
a few simple rules for combining the magnitude Bode plots of impedances and transfer functions. 
8.3.1 
Series Impedances: Addition of Asymptotes 
A series connection represents the addition of impedances. If the Bode 
diagrams of the individual impedance magnitudes are known, then the 
asymptotes of the series combination are found by simply taking the 
largest of the individual impedance asymptotes. In many cases, the 
result is exact. In other cases, such as when the individual asymptotes 
have the same slope, then the result is an approximation; nonetheless, 
the accuracy of the approximation can be quite good. 
Consider the series-connected R-C network of Fig. 8.38. It is 
desired to construct the magnitude asymptotes of the total series imped-
ance Z(s), where 
Z(s) = R + _l__ 
sC 
(8.135) 
Fig. 8.38 Series R-C network 
example. 
Let us first sketch the magnitudes of the individual impedances. The 10 Q resistor has an impedance 
magnitude of 10 Q => 20 dBQ. This value is independent of frequency, and is given in Fig. 8.39. The 
capacitor has an impedance magnitude of 1/wC. This quantity varies inversely with w, and hence its mag-
nitude Bode plot is a line with slope -20 dB/decade. The line passes through 1 Q => 0 dBQ at the angu-
lar frequency w where 
wlc=lQ 
(8.136) 
that is, at 
())-~~~-
1 
- (1 Q)C- (1 Q)(l0-6 F) 
106 rad/sec 
(8.137) 
80dBQ 
lOkQ 
60dBQ 
1 kQ 
40dBQ 
lOOQ 
20dBQ 
lOQ 
OdBQ 
lQ 
-20dBQ 
0.1 Q 
100Hz 
1kHz 
10kHz 
100kHz 
lMHz 
Fig. 8.39 Impedance magnitudes of the individual elements in the network of Fig. 8.38. 

304 
Converter Transfer Functions 
80dBQ 
liZ II 
10kQ 
60dBQ 
1 kQ 
40dBQ 
100Q 
20dBQ 
R 
""r""'··""· ... -... ------'~--+ 10 Q 
Jo 
·· ... 
znkc =16kHz··· ... ··········· ..... (l)lC 
·-... 
OdBQ 
lQ 
-ZOdBQ~-----~-------r-------+-------4 0.1 Q 
1 MHz 
100Hz 
1kHz 
10kHz 
100kHz 
Fig. 8.40 Construction of the composite asymptotes of /1 Z //. The asymptotes of the series combination can be 
approximated by simply selecting the larger of the individual resistor and capacitor asymptotes. 
In tenus offrequency f, this occurs at 
106 
f=.!&..=-= 159kHz 
2n 
2n 
(8.138) 
So the capacitor impedance magnitude is a line with slope -20 dB/dec, and which passes through 0 dBQ 
at 159 kHz, as shown in Fig. 8.39. It should be noted that, for simplicity, the asymptotes in Fig. 8.39 
have been labeled R and 1/ffiC. But to draw the Bode plot, we must actually plot dBQ; for example, 
20 log10 (Ril Q) and 20 log10 ((1/ffiC)/1 Q). 
Let us now construct the magnitude of Z(s), given by Eq. (8.135). The magnitude of Z can be 
approximated as follows: 
IIZ(jw) II= IIR + j~C ~ ~ {~ 
we 
for R » 1/wC 
(8.139) 
for R « 1/wC 
The asymptotes of the series combination are simply the larger of the individual resistor and capacitor 
asymptotes, as illustrated by the heavy lines in Fig. 8.40. For this example, these are in fact the exact 
asymptotes of II Z 1/. In the limiting case of zero frequency (de), then the capacitor tends to an open cir-
cuit. The series combination is then dominated by the capacitor, and the exact function tends asymptoti-
cally to the capacitor impedance magnitude. In the limiting case of infinite frequency, then the capacitor 
tends to a short circuit, and the total impedance becomes simply R. So the Rand 1/ffiC lines are the exact 
asymptotes for this example. 
The comer frequency f0, where the asymptotes intersect, can now be easily deduced. At angular 
frequency ffi0 = 2nf0, the two asymptotes are equal in value: 
(8.140) 
Solution for ffi0 and/0 leads to: 

8.3 
Graphical Construction of Impedances and Transfer Functions 
305 
ro - _l_ -
1 
105 rad/sec 
0 - RC- (10 Q)(l0-6 F) 
(8.141) 
fo = ~~ = 2nkc =16kHz 
So if we can write analytical expressions for the asymptotes, then we can equate the expressions to find 
analytical expressions for the comer frequencies where the asymptotes intersect. 
The deviation of the exact curve from the asymptotes follows all of the usual rules. The slope of 
the asymptotes changes by +20 dB/decade at the comer frequency fo (i.e., from -20 dBQ/decade to 
0 dBQ/decade ), and hence there is a zero at f = f0. So the exact curve deviates from the asymptotes by 
+3 dBQ atf= f 0, and by +1 dBQ atf= 2f0 and atf= fof2. 
8.3.2 
Series Resonant Circuit Example 
As a second example, let us construct the magnitude asymptotes 
for the series R-L-C circuit of Fig. 8.41. The series impedance Z(s) is 
Z(s) = R + sL+ sb 
(8.142) 
The magnitudes of the individual resistor, inductor, and capacitor asymp-
totes are plotted in Fig. 8.42, for the values 
R=1ill 
L= 1mH 
C=0.1 j.lF 
(8.143) 
The series impedance Z(s) is dominated by the capacitor at low frequency, 
by the resistor at mid frequencies, and by the inductor at high frequencies, 
as illustrated by the bold line in Fig. 8.42. The impedance Z(s) contains a 
Z(s) 
--.. 
Fig. 8.41 
Series R-L-C 
network example. 
zero at angular frequency ffip where the capacitor and resistor asymptotes intersect. By equating the 
expressions for the resistor and capacitor asymptotes, we can find ffi1: 
Fig. 8.42 Graphical 
con-
struction of II Z II of the series 
R-L-C network of Fig. 8.41, 
for the element values speci-
fied by Eq. (8.143). 
100dBQ 
80dBQ 
60dBQ 
40dBQ 
20dBQ 
OdBQ 
100Hz 
1kHz 
(8.144) 
100kQ 
10kQ 
1 kQ 
lOOQ 
lOQ 
1Q 
10kHz 
100kHz 
1MHz 

306 
Converter Transfer Functions 
lOOdBQ 
IIZII 
lOOkQ 
80dBQ 
lOkQ 
60dBQ 
1 kQ 
40dBQ 
IOOQ 
20dBQ 
R 
.. ··········· 
·······---------------·-····::-~~::::: ........................................... :::·.···;::··············--
... ·········(;;~·· 
(J)i~········· ... 
OdBQ+-~----~------~--------4--==----4 
·-.. 
IOQ 
1Q 
100Hz 
1kHz 
10kHz 
100kHz 
1 MHz 
Fig. 8.43 Graphical construction of impedance asymptotes for the series R-L-C network example, with R 
decreased to 10 Q. 
A second zero occurs at angular frequency w2, where the inductor and resistor asymptotes intersect. 
Upon equating the expressions for the resistor and inductor asymptotes at w2, we obtain the following: 
(8.145) 
So simple expressions for all important features of the magnitude Bode plot of Z(s) can be obtained 
directly. It should be noted that Eqs. (8.144) and (8.145) are approximate, rather than exact, expressions 
for the comer frequencies w1 and w2• Equations (8.144) and (8.145) coincide with the results obtained 
via the low-Q approximation of Section 8.1.7. 
Next, suppose that the value of R is decreased to 10 Q. As R is reduced in value, the approxi-
mate comer frequencies w1 and w2 move closer together until, at R = 100 Q, they are both 100 krad/sec. 
Reducing R further in value causes the asymptotes to become independent of the value of R, as illustrated 
in Fig. 8.43 for R = 10 Q. The II Z II asymptotes now switch directly from wL to 1/wC. 
So now there are two zeroes at w = w0. At comer frequency w0, the inductor and capacitor 
asymptotes are equal in value. Hence, 
Solution for the angular comer frequency w0 leads to 
(!) __ 
1_ 
0- .;rc 
(8.146) 
(8.147) 
At w = w0, the inductor and capacitor impedances both have magnitude R0, called the characteristic 
impedance. 
Since there are two zeroes at w = w0, there is a possibility that the two poles could be complex 
conjugates, and that peaking could occur in the vicinity of w = w0• So let us investigate what the actual 
curve does at w = w0• The actual value of the series impedance Z(jw0) is 
(8.148) 

8.3 Graphical Construction of Impedances and Transfer Functions 
307 
lOOdBQ 
lOOkQ 
SOdBQ 
lOkQ 
60dBQ 
1 kQ 
40dBQ 
lOOQ 
20dBQ 
10 Q 
OdBQ 
lQ 
100Hz 
l kHz 
10kHz 
100kHz 
lMHz 
Fig. 8.44 
Actual impedance magnitude (solid line) for the series resonant R-L-C example. The inductor and 
capacitor impedances cancel out atf = f0, and hence Z(jm0) = R. 
Substitution ofEq. (8.146) into Eq. (8.148) leads to 
R 
Z(jm0) = R + jR0 + --!!- = R + }R0 - }R0 = R 
J 
(8.149) 
At w = m0, the inductor and capacitor impedances are equal in magnitude but opposite in phase. Hence, 
they exactly cancel out in the series impedance, and we are left with Z(jm0) = R, as illustrated in 
Fig. 8.44. The actual curve in the vicinity of the resonance at w = w0 can deviate significantly from the 
asymptotes, because its value is determined by R rather than mL or 1/mC. 
We know from Section 8.1.6 that the deviation of the actual curve from the asymptotes at m = 
m0 is equal to Q. From Fig. 8.44, one can see that 
or, 
Q- Ro 
-R 
Equations (8.146) to (8.151) are exact results for the series resonant circuit. 
(8.150) 
(8.151) 
The practice of adding asymptotes by simply selecting the larger asymptote can be applied to 
transfer functions as well as impedances. For example, suppose that we have already constructed the 
magnitude asymptotes of two transfer functions, G1 and G2, and we wish to find the asymptotes of G = 
G1 + G2. At each frequency, the asymptote for G can be approximated by simply selecting the larger of 
the asymptotes for G1 and G2: 
(8.152) 
Corner frequencies can be found by equating expressions for asymptotes as illustrated in the preceding 
examples. In the next chapter, we will see that this approach yields a simple and powerful method for 
determining the closed-loop transfer functions of feedback systems. 

308 
Converter Transfer Functions 
8.3.3 
Parallel Impedances: Inverse Addition of Asymptotes 
A parallel combination represents inverse addition of impedances: 
(8.153) 
If the asymptotes of the individual impedances 2 1, 22, ..• , are known, then the asymptotes of the parallel 
combination Zpar can be found by simply selecting the smallest individual impedance asymptote. This is 
true because the smallest impedance will have the largest inverse, and will dominate the inverse sum. As 
in the case of the series impedances, this procedure will often yield the exact asymptotes of Zpar" 
Let us construct the magnitude asymptotes for the parallel 
R-L-C network of Fig. 8.45, using the following element values: 
R= lOQ 
L= lmH 
C=O.l ).LF 
Z(s) 
(8.154) --+ 
R 
L 
c 
Impedance magnitudes of the individual elements are illustrated in Fig. 8.45 Parallel R-L-C network 
Fig. 8.46. The asymptotes for the total parallel impedance Z are example. 
approximated by simply selecting the smallest individual element 
impedance, as shown by the heavy line in Fig. 8.46. So the parallel impedance is dominated by the 
inductor at low frequency, by the resistor at mid frequencies, and by the capacitor at high frequency. 
Approximate expressions for the angular comer frequencies are again found by equating asymptotes: 
R 
R = w1L ==> w1 = L 
R=-1-
==> w =_L 
w2C 
2 
RC 
(8.155) 
at w = w2, 
These expressions could have been obtained by conventional analysis, combined with the low-Q approx-
imation of Section 8.1.7. 
Fig. 8.46 Construction of 
the composite asymptotes of 
II Z II. for the parallel R-L-C 
example. The asymptotes of 
the parallel combination can 
be approximated by simply 
selecting the smallest of the 
individual resistor, inductor, 
and capacitor asymptotes. 
80dBQ 
·· ... ·· .. 
_L······ .... 
60dBQ 
we 
·· .. 
40dBQ 
20dBQ 
R 
OdBQ 
-20dBQ 
100Hz 
1kHz 
··· .. ·· .. ···. 
. .. -······ 
... -·· 
.. -·· 
.. ·········wL 
·::."?:: ......... 
... -····· 
.. ··· 
·· ... 
... ··· 
·· .. 
1/Z// 
10kHz 
100kHz 
lOkQ 
..--· 
1 kQ 
lOOQ 
lOQ 
lQ 
0.1 Q 
1 MHz 

Fig. 8.47 Graphical construc-
tion of impedance asymptotes 
for the parallel R-L--C example, 
with R increased to 1 k.Q. 
8.3 
Graphical Construction of Impedances and Transfer Functions 
309 
80dBQ 
10k.Q 
60dBQ 
1 kQ 
40dBQ 
lOOQ 
20dBQ 
10Q 
OdBQ 
1Q 
-20 dBQ +------+------+-------+-----+ 0.1 Q 
100Hz 
1kHz 
10kHz 
100kHz 
1 MHz 
8.3.4 
Parallel Resonant Circuit Example 
Figure 8.47 illustrates what happens when the value of R in the parallel R-L--C network is increased to 
1 kQ. The asymptotes for II Z II then become independent of R, and change directly from roL to 1/roC at 
angular frequency ro0. The corner frequency ro0 is now the frequency where the inductor and capacitor 
asymptotes have equal value: 
(8.156) 
which implies that 
(8.157) 
At ro = ro0, the slope of the asymptotes of II Z II changes from +20 dB/decade to -20 dB/decade, and 
hence there are two poles. We should investigate whether peaking occurs, by determining the exact value 
of II Z II at ro = ro0, as follows: 
(8.158) 
ZUm0)=RIIimoLII-.-1-= 1 
1 1 
JOloC 
- + -- + jw C 
R 
jmoL 
o 
Substitution of Eq. (8.156) into (8.158) yields 
(8.159) 
So at ro = ro0, the impedances of the inductor and capacitor again cancel out, and we are left with 
ZUro0) = R. The values of L and C determine the values of the asymptotes, but R determines the value of 
the actual curve at ro = ro0. 
The actual curve is illustrated in 8.48. The deviation of the actual curve from the asymptotes at 
ro = ro0 is 

310 
Converter Transfer Functions 
Fig. 8.48 Actual 
impedance 
magnitude (solid line) for the 
parallel R-L-C example. The 
inductor and capacitor imped-
ances cancel out at f = f0, and 
hence Z(jW0) = R. 
80dBQ 
·· .. 
60dBQ 
40dBQ 
20dBQ 
OdBQ 
· ... 
····· .... ··· ... 
-··· 
. .. -· 
10kQ 
1 kQ 
lOOQ 
10Q 
1Q 
-20dBQ ~-------r------~~------;-------~ 0.1 Q 
1MHz 
100Hz 
1kHz 
10kHz 
100kHz 
I Q Ids= f R fctsQ -I Ro lctsQ 
(8.160) 
or, 
Q= :0 
(8.161) 
Equations (8.156) to (8.161) are exact results for the parallel resonant circuit. 
The graphical construction method for impedance magnitudes is well known, and reactance 
paper can be purchased commercially. As illustrated in Fig. 8.49, the magnitudes of the impedances of 
various inductances, capacitances, and resistances are plotted on semilogarithmic axes. Asymptotes for 
the impedances of R-L-C networks can be sketched directly on these axes, and numerical values of cor-
ner frequencies can then be graphically determined. 
SOdBQ 
10kQ 
60dBQ 
I kQ 
40dBQ 
100Q 
20dBQ 
10Q 
OdBQ 
IQ 
-20dBQ 
100mQ 
-40dBQ 
lOmQ 
-60 dBQ P=---~~'""'----..f-"'"""-----i--=='"""-----+-="-""'------J- I mQ 
10Hz 
100Hz 
I kHz 
10kHz 
100kHz 
I MHz 
Fig. 8.49 
"Reactance paper": an aid for graphical construction of impedances, with the magnitudes of various 
inductive, capacitive, and resistive impedances preplotted. 

8.3 
Graphical Construction of Impedances and Transfer Functions 
311 
(a) 
H(s) 
~ 
+ 
c 
vz(s) 
R 
zout 
...._,_...., 
z, 
~ 
(b) 
(c) 
L 
L 
c 
R 
zout 
zin 
c 
R 
-
-
Fig. 8.50 Two-pole low-pass filter based on voltage divider circuit: (a) transfer function H(s), (b) determination 
of Zour• by setting independent sources to zero, (c) determination of Zin(s). 
8.3.5 
Voltage Divider Transfer Functions: Division of Asymptotes 
Usually, "we can express transfer functions in terms of impedances-for example, as the ratio of two 
impedances. If we can construct these impedances as described in the previous sections, then we can 
divide to construct the transfer function. In this section, construction of the transfer function H(s) of the 
two-pole R-L-C low-pass filter (Fig. 8.50) is discussed in detail. A filter of this form appears in the 
canonical model for two-pole converters, and the results of this section are applied in the converter exam-
ples of the next section. 
The familiar voltage divider formula shows that the transfer function of this circuit can be 
expressed as the ratio of impedances ~/Zin' where Zin = Z1 + ~ is the network input impedance: 
(8.162) 
For this example, Z1(s) = sL, and ~(s) is the parallel combination of Rand 1/sC. Hence, we can find the 
transfer function asymptotes by constructing the asymptotes of~ and of the series combination repre-
sented by Zin• and then dividing. Another approach, which is easier to apply in this example, is to multi-
ply the numerator and denominator of Eq. (8.162) by Z1: 

312 
Converter Transfer Functions 
(b) 
Fig. 8.51 
Graphical construction of Hand Zout of 
the voltage divider circuit: (a) output impedance 
zout; (b) transfer function H. 
(8.163) 
where zout = Z1 II Z2 is the output impedance of the voltage divider. So another way to construct the volt-
age divider transfer function is to first construct the asymptotes for Z1 and for the parallel combination 
represented by Zout' and then divide. This method is useful when the parallel combination Z1 II Z2 is eas-
ier to construct than the series combination Z1 + Z2• It often gives a different approximate result, which 
may be more (or sometimes less) accurate than the result obtained using Z;n· 
The output impedance Zout in Fig. 8.50(b) is 
ZoJs) = R II s~ II sL 
(8.164) 
The impedance of the parallel R-L-C network is constructed in Section 8.3.3, and is illustrated in 
Fig. 8.5l(a) for the high-Q case. 
According to Eq. (8.163), the voltage divider transfer function magnitude is II H II = II Zout III 
II zl II. This quantity is constructed in Fig. 8.5l(b). For(!)< Wo, the asymptote of II zout II coincides with 
II zl 1/: both are equal to wL. Hence, the ratio is II zout /Ill/ zl II= 1. For(!)> Wo, the asymptote of II zout II is 
llwC, while II zl II is equal to wL. The ratio then becomes II zout /Ill/ zl II = llw2LC, and hence the high-
1 
WC···· ... 
.. ··· 
Fig. 8.52 Effect of increasing L on the output 
impedance asymptotes, corner frequency, and 
Q-factor. 

8.4 Graphical Construction of Converter Transfer Functions 
313 
+ 
I d(t) 
R 
v(t) 
Fig. 8.53 
Small-signal model of the buck converter, with input impedance Z;n(s) and output impedance Z0" 1(s) 
explicitly defined. 
frequency asymptote has a -40 dB/decade slope. At (J) = (J)o, II zout II has exact value R, while II zl II has 
exact value Ro. The ratio is then II H(jwo) II= II zout(jwo) IIIII Zl(jwo) II= R!Ro = Q. So the filter transfer 
function H has the same w0 and Q as the impedance Zour 
It now becomes obvious how variations in element values affect the salient features of the trans-
fer function and output impedance. For example, the effect of increasing Lis illustrated in Fig. 8.52. This 
causes the angular resonant frequency w0 to be reduced, and also reduces the Q-factor. 
8.4 
GRAPHICAL CONSTRUCTION OF CONVERTER TRANSFER FUNCTIONS 
The small-signal equivalent circuit model of the buck converter, derived in Chapter 7, is reproduced in 
Fig. 8.53. Let us construct the transfer functions and terminal impedances of this converter, using the 
graphical approach of the previous section. 
The output impedance Zou/s) is found with the d(s) and vgCs) sources set to zero; the circuit of 
Fig. 8.54(a) is then obtained. This model coincides with the parallel R-L--C circuit analyzed in Sections 
8.3.3 and 8.3.4. As illustrated in Fig. 8.54(b), the output impedance is dominated by the inductor at low 
frequency, and by the capacitor at high frequency. At the resonant frequency f0, given by 
fr -
1 
0 - 2n./LC 
(8.165) 
the output impedance is equal to the load resistance R. The Q-factor of the circuit is equal to 
(a) 
L 
(b) 
l 
······· ... we 
wL 
..... 
·•········ '"< :::····· ·:r~=:::': 
fo 
c 
R 
Fig. 8.54 
Construction of buck converter output impedance Zou/s): (a) circuit model; (b) impedance asymptotes. 

314 
Converter Transfer Functions 
(a) 
L 
c 
R 
(b) 
1 
wL 
'?~,I: : :,, :,,; ~ :::~ 
.... ··········· 
fo 
··· ......... . 
·············· 
2n~LC 
... ··· 
VLL 
···. 
····· ... 
where 
Fig. 8.55 
Construction of the input impedance 
Z;11(s) for the buck converter: (a) circuit model; 
(b) the individual resistor, inductor, and capacitor 
impedance magnitudes; (c) construction of the 
impedance magnitudes II Z1 II and II Z2 II; (d) con-
struction of II zout II; (e) final result II zin 11. 
(d) 
R 
D2 
II zin II 
(8.166) 
(8.167) 
Thus, the circuit is lightly damped (high Q) at light load, where the value of R is large. 
The converter input impedance Z;n(s) is also found with the d(s) and vgCs) sources set to zero, as 
illustrated in Fig. 8.55(a). The input impedance is referred to the primary side of the 1 :D transformer, and 
is equal to 
(8.168) 
where 

8.4 
Graphical Construction of Converter Transfer Functions 
315 
Z 1(s) = sL 
(8.169) 
and 
Z2(s)=Ril sb 
(8.170) 
We begin construction of the impedance asymptotes corresponding to Eqs. (8.168) to (8.170) by con-
structing the individual resistor, capacitor, and inductor impedances as in Fig. 8.55(b). The impedances 
in Fig. 8.55 are constructed for the case R > R0. As illustrated in Fig. 8.55(c), II 2 1 II coincides with the 
inductor reactance wL. The impedance II Z2 II is asymptotic to resistance R at low frequencies, and to the 
capacitor reactance 1/wC at high frequency. The resistor and capacitor asymptotes intersect at comer fre-
quency f 1, given by 
j' __ 
1_ 
JI- 2nRC 
(8.171) 
According to Eq. (8.168), the input impedance Z;n(s) is equal to the series combination of Z1(s) and ~(s), 
divided by the square of the turns ratio D. The asymptotes for the series combination [Z1(s) + Zz(s)] are 
found by selecting the larger of the II 2 1 II and II ~ II asymptotes. The II Z1 II and II ~ II asymptotes inter-
sect at frequency f0, given by Eq. (8.165). It can be seen from Fig. 8.55(c) that the series combination is 
dominated by~ for f <f0, and by Z1 for f> f0• Upon scaling the [Z1(s) + ~(s)] asymptotes by the factor 
l/D2, the input impedance asymptotes of Fig. 8.55(e) are obtained. 
The zeroes of Z;n(s), at frequency f0, have the same Q-factor as the poles of Z0ut(s) [Eq. (8.166)]. 
One way to see that this is true is to note that the output impedance can be expressed as 
(8.172) 
Hence, we can relate Z0u1(s) to Zin(s) as follows: 
(8.173) 
The impedances II zl II, II Zzll, and II zout II are illustrated in Fig. 8.55(d). At the resonant frequency f = fo, 
impedance 2 1 has magnitude R0 and impedance 22 has magnitude approximately equal to R0• The output 
impedance Zout has magnitude R. Hence, Eq. (8.173) predicts that the input impedance has the magnitude 
li z. ~,_LRoRo atf= ~" 
mU 
Dz 
R 
Jo 
(8.174) 
Atf = f0, the asymptotes of the input impedance have magnitude R0/IY. The deviation from the asymp-
totes is therefore equal to Q = R!R0, as illustrated in Fig. 8.55(e). 
The control-to-output transfer function Gvis) is found with the vgCs) source set to zero, as in 
Fig. 8.56(a). This circuit coincides with the voltage divider analyzed in Section 8.3.5. Hence, Gvis) can 
be expressed as 
(8.175) 

316 
Converter Transfer Functions 
Fig. 8.56 Construction of the control-to-output 
transfer function Gvd(s) for the buck converter: 
(a) circuit model; (b) relevant impedance asymptotes; 
(c) transfer function II Gvis) 11. 
(b) 
(c) 
(a) 
L 
+ 
R 
v(t) 
The quantities II Zout II and II Z1 II are constructed in Fig. 8.56(b ). According to Eq. (8.175), we can con-
struct II Gvis) II by finding the ratio of II zout II and II Z1 II, and then scaling the result by vg. For J < J0, 
II zout II and II Z1 II are both equal to wL and hence II zout IIIII Z1 II is equal to 1. As illustrated in Fig. 
8.56(c), the low-frequency asymptote of II Gvis) II has value vg. For!> J0, II zout II has asymptote 1/wC, 
and II Z1 II is equal to wL. Hence, II zout IIIII Z1 II has asymptote llw2LC, and the high-frequency asymp-
tote of II Gvis) II is equal to V/w2LC. The Q-factor of the two poles at(_= f 0 is again equal to RIR0• 
The line-to-output transfer function Gv/s) is found with the d(s) sources set to zero, as in Fig. 
8.57(a). This circuit contains the same voltage divider as in Fig. 8.56, and additionally contains the 1 :D 
transformer. The transfer function GvgCs) can be expressed as 
Fig. 8.57 The line-to-output transfer 
function Gv8(s) for the buck converter: 
(a) circuit model; (b) magnitude asymp-
totes. 
(a) 
1 :D 
L 
+ 
v(t) 

8.5 Measurement of AC Transfer Functions and Impedances 
317 
Network Analyzer 
Injection source 
Measured inJ>uts 
Data 
v: 
0. 
Data bus 
Magnitude 
Frequency 
1~1 I 17.3 dB I 
to computer 
0 
u 
o, 
ox 
oy 
Output 
Input 
Input 
!_~ 
-e-~ 
+ 
-
+ 
-
I 
I 
- 134.7' 
4 4 
vx 
-!-
Fig. 8.58 
Key features and functions of a ne.twork analyzer: sinusoidal source of controllable amplitude and fre-
quency, two inputs, and determination of relative magnitude and phase of the input components at the injection fre-
quency. 
(8.176) 
This expression is similar to Eq. (8.175), except for the scaling factor of D. Therefore, the line-to-output 
transfer function of Fig. 8.57(b) has the same shape as the control-to-output transfer function Gvd(s). 
8.5 
MEASUREMENT OF AC TRANSFER FUNCTIONS AND IMPEDANCES 
It is good engineering practice to measure the transfer functions of prototype converters and converter 
systems. Such an exercise can verify that the system has been correctly modeled and designed. Also, it is 
often useful to characterize individual circuit elements through measurement of their terminal imped-
ances. 
Small-signal ac magnitude and phase measurements can be made using an instrument known as 
a network analyzer, or frequency response analyzer. The key inputs and outputs of a basic network ana-
lyzer are illustrated in Fig. 8.58. The network analyzer provides a sinusoidal output voltage v, of con-
trollable amplitude and frequency. This signal can be injected into the system to be measured, at any 
desired location. The network analyzer also has two (or more) inputs, vx and vy. The return electrodes of 
v2, vy, and vx are internally connected to earth ground. The network analyzer performs the function of a 
narrowband tracking voltmeter: it measures the components of vx and vy at the injection frequency, and 
displays the magnitude and phase of the quantity il/vx. The narrowband tracking voltmeter feature is 
essential for switching converter measurements; otherwise, switching ripple and noise corrupt the 
desired sinusoidal signals and make accurate measurements impossible [3]. Modern network analyzers 
can automatically sweep the frequency of the injection source v, to generate magnitude and phase Bode 
plots of the transfer function V/vx. 
A typical test setup for measuring the transfer function of an amplifier is illustrated in 
Fig. 8.59. A potentiometer, connected between a de supply voltage V cc and ground, is used to bias the 

318 
Converter Transfer Functions 
Injection source 
v, 
v. 
Mttxn"iwde 
f~rrlfjU:IlCY 
'0' 
0' 
o, 
Output 
---o---1-
DC 
blocking == 
c 
DC 
bias 
adju t 
apacitor 
Vee 
> 
__ ...... 
...--
Fig. 8.59 Measurement of a transfer function. 
Network Analyzer 
Measured inJJUis 
"· 
v, 
'"~'"' 
/tlf/111 
;:; 
0. 
..: 
-
-
1.1-
G(s) 
Device 
under test 
1 
0 " 
-6 
~ 
Data 
Duwbu.'' 
I t.l I -4,7 dB I 
10 comp111er 
-
L'!:-
v, I -162.8' I 
amplifier input to attain the correct quiescent operating point. The injection source voltage 02 is coupled 
to the amplifier input terminals via a de blocking capacitor. This blocking capacitor prevents the injection 
voltage source from upsetting the de bias. The network analyzer inputs vx and vy are connected to the 
input and output terminals of the amplifier. Hence, the measured transfer function is 
Oy(s) = G(s) 
v)s) 
(8.177) 
Note that the blocking capacitance, bias potentiometer, and vz amplitude have no effect on the measured 
transfer function 
An impedance 
Z(s) = ~(s) 
t(s) 
(8.178) 
can be measured by treating the impedance as a transfer function from current to voltage. For example, 
measurement of the output impedance of an amplifier is illustrated in Fig. 8.60. The quiescent operating 
condition is again established by a potentiometer which biases the amplifier input. The injection source 
vz is coupled to the amplifier output through a de blocking capacitor. The injection source voltage vz 
excites a cun·ent lout in impedance z,. This current flows into the output of the amplifier, and excites a 

8.5 
Measurement of AC Transfer Functions and Impedances 
319 
DC 
bias 
adjust 
Device 
under test 
0 
G(s) 
,8 ~ 
;;. 
Voltage ___ ,, ------ , 
probe 
·-----
+ -
+ -
Fig. 8.60 Measurement of the output impedance of a circuit. 
voltage across the amplifier output impedance: 
DC blocking 
capacitor 
z,. 
(8.179) 
A cmTent probe is used to measure 1our The current probe produces a voltage proportional to 1uut; this 
voltage is connected to the network analyzer input vx. A voltage probe is used to measure the amplifier 
output voltage vy. The network analyzer displays the transfer function v/vx, which is proportional to Zour 
Note that the value of Zs and the amplitude of v2 do not affect the measurement of Z0111• 
In power applications, it is sometimes necessary to measure impedances that are very small in 
magnitude. Grounding problems[4] cause the test setup of Fig. 8.60 to fail in such cases. The reason is 
illustrated in Fig. 8.61(a). Since the return connections of the injection source v2 and the analyzer input vy 
are both connected to earth ground, the injected current l0111 can return to the source through the return 
connections of either the injection source or the voltage probe. In practice, 1ow divides between the two 
paths according to their relative impedances. Hence, a significant current (1 - k) l0111 flows through the 
return connection of the voltage probe. If the voltage probe return connection has some total contact and 
wiring impedance Zprobe• then the current induces a voltage drop (1- k)toutzprobe in the voltage probe wir-
ing, as illustrated in Fig. 8.6l(a). Hence, the network analyzer does not correctly measure the voltage 
drop across the impedance Z. If the internal ground connections of the network analyzer have negligible 
impedance, then the network analyzer will display the following impedance: 
(8.180) 
Here, Zrz is the impedance of the injection source return connection. So to obtain an accurate measure-
ment, the following condition must be satisfied: 
II z II» II ( zpmbeiiZcz) II 
(8.181) 

320 
Converter Transfer Functions 
(a) 
Impedance 
under test 
Z(s) 
(1 - k) lout 
Injection 
source 
return 
connection 
Network Analyzer 
r-:----,--~~j~~~~~:-~::~~~-----------1 
! source 
! 
v, 
1. 
I 
! 
1 
}---------------------------------------------------! 
'
j 
Measured 
inputs 
Voltage 
probe 
----< -_-:_~~~ ·' 
! 
(b) 
Voltage 
... ···· 
probe 
.... ···· 
return 
connection 
Impedance 
under test 
Z(s) 
0 
Voltage 
pro be 
----< -:-~~~~ ) 
Voltage 
probe 
.... ····· 
return 
connection 
+ 
+ 
. 
(1- k) iout zprobe 
Injection 
source 
return 
connection 
+ 
i 
j 
I 
! 
i 
i 
_____________________________________________________ j 
Network Analyzer 
r·----------~~j~~~~~:-~-~:~~~----------
i Rsource 
' 
! 
-: 
r--"=~---~ 
~----------------_,t--------o + 
' 
vx 
I 
ov 
i 
I 
I 
I 
+ 
L ____________________________________________________ _ 
Fig. 8.61 
Measurement of a small impedance Z(s): (a) current flowing in the return connection of the voltage 
probe induces a voltage drop that corrupts the measurement; (b) an improved experiment, incorporating isolation of 
the injection source. 

8.6 Summary of Key Points 
321 
A typical lower limit on II Z II is a few tens or hundreds of milliohms. 
An improved test setup for measurement of small impedances is illustrated in Fig. 8.6l(b). An 
isolation transformer is inserted between the injection source and the de blocking capacitor. The return 
connections of the voltage probe and injection source are no longer in parallel, and the injected current 
iout must now return entirely through the injection source return connection. An added benefit is that the 
transformer turns ratio n can be increased, to better match the injection source impedance to the imped-
ance under test. Note that the impedances of the transformer, of the blocking capacitor, and of the probe 
and injection source return connections, do not affect the measurement. Much smaller impedances can 
therefore be measured using this improved approach. 
8.6 
SUMMARY OF KEY POINTS 
1. 
The magnitude Bode diagrams of functions which vary as (j!f0)" have slopes equal to 20n dB per decade, 
and pass through 0 dB at f = f0. 
2. 
It is good practice to express transfer functions in normalized pole-zero form; this form directly exposes 
expressions for the salient features of the response, that is, the corner frequencies, reference gain, etc. 
3. 
The right half-plane zero exhibits the magnitude response of the left half-plane zero, but the phase 
response of the pole. 
4. 
Poles and zeroes can be expressed in frequency-inverted form, when it is desirable to refer the gain to a 
high-frequency asymptote. 
5. 
A two-pole response can be written in the standard normalized form ofEq. (8.58). When Q > 0.5, the poles 
are complex conjugates. The magnitude response then exhibits peaking in the vicinity of the corner fre-
quency, with an. exact value of Q at f = j 0. High Q also causes the phase to change sharply near the corner 
frequency. 
6. 
When Q is less than 0.5, the two pole response can be plotted as two real poles. The low-Q approximation 
predicts that the two poles occur at frequencies j 0! Q and QJ0. These frequencies are within 10% of the 
exact values for Q :S 0.3. 
7. 
The low-Q approximation can be extended to find approximate roots of an arbitrary degree polynomial. 
Approximate analytical expressions for the salient features can be derived. Numerical values are used to 
justify the approximations. 
8. 
Salient features of the transfer functions of the buck, boost, and buck-boost converters are tabulated in 
Section 8.2.2. The line-to-output transfer functions of these converters contain two poles. Their control-to-
output transfer functions contain two poles, and may additionally contain a right half-plane zero. 
9. 
Approximate magnitude asymptotes of impedances and transfer functions can be easily derived by graphi-
cal construction. This approach is a useful supplement to conventional analysis, because it yields physical 
insight into the circuit behavior, and because it exposes suitable approximations. Several examples, includ-
ing the impedances of basic series and parallel resonant circuits and the transfer function H(s) of the volt-
age divider circuit, are worked in Section 8.3. The input impedance, output impedance, and transfer 
functions of the buck converter are constructed in Section 8.4, and physical origins of the asymptotes, cor-
ner frequencies, and Q-factor are found. 
10. 
Measurement of transfer functions and impedances using a network analyzer is discussed in Section 8.5. 
Careful attention to ground connections is important when measuring small impedances. 

322 
Converter Transfer Functions 
REFERENCES 
[1] 
R.D. MIDDLEBROOK, "Low Entropy Expressions: The Key to Design-Oriented Analysis," IEEE Frontiers 
in Education Conference, 1991 Proceedings, pp. 399-403, Sept. 1991. 
[2] 
R. D. MIDDLEBROOK, "Methods of Design-Oriented Analysis: The Quadratic Equation Revisited," IEEE 
Frontiers in Education Conference, 1992 Proceedings, pp. 95-102, Nov. 1991. 
[3] 
F. BARZEGAR, S. CUK, and R. D. MIDDLEBROOK, "Using Small Computers to Model and Measure Magni-
tude and Phase of Regulator Transfer Functions and Loop Gain," Proceedings of Powercon 8, April 1981. 
Also in Advances in Switched-Mode Power Conversion, Irvine: Teslaco, Vol. 1, pp. 251-278, 1981. 
[4] 
H. W. OTI, Noise Reduction Techniques in Electronic Systems, 2nd edit., New York: John Wiley & Sons, 
1988, Chapter 3. 
PROBLEMS 
8.1 
Express the gains represented by the asymptotes of Figs. 8.62(a) to (c) in factored pole-zero form. You 
may assume that all poles and zeroes have negative real parts. 
(a) 
+20 dB/decade 
-20 dB/decade 
(b) 
jl 
-20 dB/decade 
-20 dB/decade 
(c) 
Fig. 8.62 
Gain asymptotes for Problem 8.1. 
8.2 
Express the gains represented by the asymptotes of Figs. 8.63(a) to (c) in factored pole-zero form. You 
may assume that all poles and zeroes have negative real parts. 
8.3 
Derive analytical expressions for the low-frequency asymptotes of the magnitude Bode plots shown in 
Fig. 8.63(a) to (c). 
8.4 
Derive analytical expressions for the three magnitude asymptotes of Fig. 8.16. 

Problems 
323 
(a) 
(b) 
-40 dB/decade 
+20 dB/decade 
(c) 
-40 dB/decade 
Q 
Fig. 8.63 
Gain asymptotes for Problems 8.2 and 8.3. 
8.5 
An experimentally measured transfer function. Figure 8.64 contains experimentally measured magni-
tude and phase data for the gain function A(s) of a certain amplifier. The object of this problem is to find 
an expression for A(s). Overlay asymptotes as appropriate on the magnitude and phase data, and hence 
deduce numerical values for the gain asymptotes and corner frequencies of A(s). Your magnitude and 
40dB 
30dB 
20 dB 
10 dB 
----·::::r.::::~:::GWl:n 
·········-~------~---~---~--~-~-~-~ 
OdB 
' 
'. 
. 
''" 
:::::::::j::·:::~:::;:·:~::~·~:l:~ ::::::::::1::::::[:::;: :~::~:~:l:[ fSKj::·j·::~::[·[·J:[ ·:::::·:·:l::·:::["::l"::~::[·~:l.[ ::.::::.::1·:· .:~:::l::·[::~:~:l:[ 
-450 
............................................ ········i······f··+ili ··········i······f··++-H+ ········+··+·+++if 
:::::::::;:::::r:::;:::;::[:;:;:: ::::::::::;::::::;:::;:::;::[:;:;:; ::::::::::;::::::::::;::::::;:r:;:;~:::::;:::;:::;::;:;:;:; ::::::::::r::::;:::;:::;::;:;:;:; 
-90° 
······ 
··::::::::r.::T::r:r:n:n : ... ::::l::::::[:::!:::U:U:[ ::::::::::!::::J:'is:h:!:[ ::::::::::L ... :. .. : ... u.:.t: 
......... ,. ..... , ... , .. ~ ~~;.~ .. ::::::::j::::::[:::j:::U:h:l ::::.:::::j::::::[ ::j:::[::[:[:j:[ ::::::::::j:::::I:TfrffiK:·::;:·::::[:::j::f::[:[:j:[ 
[:::J:::::J:tJ::.:[L[Ll]Ttin·[[ 
::J::::J:::J[:::.f:r[:rfr[~.I~ffi::l JJ[JJJ[][JJJ[f:::[i§ 
~:f§:f:iJ:f:J::.:~:~§t~::.;~::;:j·:.~rtm:t :::: 
10Hz 
100Hz 
1kHz 
lOkHz 
100kHz 
1 MHz 
Fig. 8.64 
Experimentally-measured magnitude and phase data, Problem 8.5. 

324 
Converter Transfer Functions 
phase asymptotes must, of course, follow all of the rules: magnitude slopes must be multiples of ±20 dB 
per decade, phase slopes for real poles must be multiples of ±45" per decade, etc. The phase and magni-
tude asymptotes must be consistent with each other. 
It is suggested that you start by guessing A(s) based on the magnitude data. Then construct the 
phase asymptotes for your guess, and compare them with the given data. If there are discrepancies, then 
modify your guess accordingly and redo your magnitude and phase asymptotes. You should turn in: (1) 
your analytical expression for A(s ), with numerical values given, and (2) a copy of Fig. 8.64, with your 
magnitude and phase asymptotes superimposed and with all break frequencies and slopes clearly 
labeled. 
8.6 
An experimentally-measured impedance. Figure 8.65 contains experimentally measured magnitude and 
phase data for the driving-point impedance Z(s) of a passive network. The object of this problem is the 
find an expression for Z(s). Overlay asymptotes as appropriate on the magnitude and phase data, and 
hence deduce numerical values for the salient features ofthe impedance function. You should turn in: (1) 
your analytical expression for Z(s ), with numerical values given, and (2) a copy of Fig. 8.65, with your 
magnitude and phase asymptotes superimposed and with all salient features and asymptote slopes 
clearly labeled. 
Fig. 8.65 
Impedance magni-
tude and phase data, Problem 
8.6. 
20dBQ 
10dBQ 
OdBQ 
-10dBQ 
:::::::::::::::: :··::::: 
: 11 z11 ::r::;::;::;:r:;:r :::::::::r::~:::p::;:n:~ :::::::::;:::::;:::;:::r·; .. ;:r;: 
........ f .... f ... f .. j::Pft :::;;::;:::::f:::;::p:;:n :::::::::;:::::j: .. ; .. :n::f:n: 
. . . .. .. . 
:~:j:f ... :::::)(:' ...... 
:::::::::~:::::~:::~::]::~:~:~:! :::::::::j:::::f·~::J:j:J:! :::/:;:::::J:::J:::~:J::~:!l: 
. . ...... . . 
·l~'"f: ........ 
. ::::::::!:::::!:::!::J::!:!:!·!:::::::::j:::::!:::J::J::;:j:j:1:::::::::J:::::l:::l:::!:l::!:!l: 
. . . . .. .. 
. .......... ,.-::: 
:~:: :·:~ .(:: .:·[~::[·~l::!~[:i·[ ::: ~:::.~1.: :~~~: :~j~: l~~j. l~l.! ~ 
:::~~j~ ~~~:j:~~j~ ~~~.j~~t:! j~ 
45° 
:~:~~~~ :~[~ ~~~ :[~: :[~~ j::[ ~[:[ ~f :: ::.: :~.j: :~.:[~~·l· :j~.j:j.~ ~·:: ~:.:: l~:·:: j .. : j·::[ ~ l::[ :il~ 
oo 
.::~~:l::~::i:::J::j::vj:[ :::::::::~:::::J:::j:::[:j::[:[j: 
-450 
~ 
... -.... ++~ 
... f~ 
.. ,f~ 
. 
.;.~.H~·H~ 
... ~ 
.... ~ 
.. i~~..:~ 
.. ~:..:+·H~+f~ ... -.... ~ 
. .;.-..... ~; 
.... ~; 
.. +++~f.H~. 
:::::::::}:::::~:::~::;::nf~ :::::::::r:::r:::rn:J:J:~ :::::::::;:::::J:::;:::n:nJ: 
~~~~++M+~~-+~~~---+-+~~~ -90° 
10Hz 
100Hz 
1kHz 
10kHz 
8.7 
In Section 7.2.9, the small-signal ac model of a nonideal flyback converter is derived, with the result 
illustrated in Fig. 
7.27. Construct a Bode plot of the magnitude and phase of the converter output 
impedance Zout(s). Give both analytical expressions and numerical values for all important features in 
your plot. Note: Z0 Js) includes the load resistance R. The element values are: D = 0.4, ri = 0.2, R = 6 Q, 
L = 600 /(H, c = 100 f!F, ROll = 5 Q. 
8.8 
For the nonideal flyback converter modeled in Section 7.2.9: 
(a) 
Derive analytical expressions for the control-to-output and line-to-output transfer functions 
GvJs) and Gv/s). Express your results in standard normalized form. 
(b) 
Derive analytical expressions for the salient features of these transfer functions. 
(c) 
Construct the magnitude and phase Bode plots of the control-to-output transfer function, using 

Problems 
325 
the following values: n = 2, Vg = 48 V, D = 0.3, R = 5 Q, L = 250 JLH, C = 100 JLF, Ron = 1.2 Q. 
Label the numerical values of the constant asymptotes, all corner frequencies, the Q-factor, and 
asymptote slopes. 
8.9 
Magnitude Bode diagram of an R-L--C filter circuit. For the filter circuit of Fig. 8.66, construct the Bode 
plots for the magnitudes of the Thevenin-equivalent output impedance Zout and the transfer function H(s) 
= vz!v1• Plot your results on semilog graph paper. Give approximate analytical expressions and numeri-
cal values for the important corner frequencies and asymptotes. Do all of the elements significantly 
affect Zout and H? 
. 
R1 
Ll 
lOQ 
lOmH 
+ 
R3 
zour 
vl 
+-
vz 
Rz 
1 kQ 
lOOQ 
Fig. 8.66 
Filter circuit of Problem 8.9. 
8.10 
Operational amplifier filter circuit. The op amp circuit shown in Fig. 8.67 is a practical realization of 
what is known as a PID controller, and is sometimes used to modify the loop gain of feedback circuits to 
improve their performance. Using semilog graph paper, sketch the Bode diagram of the magnitude of the 
transfer function v2(s)/v1(s) of the circuit shown. Label all corner frequencies, flat asymptote gains, and 
asymptote slopes, as appropriate, giving both analytical expressions and numerical values. You may 
assume that the op amp is ideal. 
+ 
Fig. 8.67 
Op-amp PID controller circuit, Problem 8.10. 
8.11 
Phase asymptotes. Construct the phase asymptotes for the transfer function v2(s)/v1(s) of Problem 8.10. 
Label all break frequencies, flat asymptotes, and asymptote slopes. 
8.12 
Construct the Bode diagram for the magnitude of the output impedance Zout of the network shown in Fig. 
8.68. Give suitable analytical expressions for each asymptote, corner frequency, and Q-factor, as appro-
priate. Justify any approximations that you use. 
The component values are: 
L1 =100 JLH 
c1 = woo JLF 
R1 =5Q 
L2 = 16mH 
C2 = 10 JLF 
R2 =50 Q 

326 
Converter Transfer Functions 
Fig. 8.68 
Filter network of Problem 8.12. 
8.13 
The two section input filter in the circuit of Fig. 8.69 should be designed such that its output impedance 
Zoudv = 0 meets certain input filter design criteria, and hence it is desirable to construct the Bode plot 
forth~ magnitude of z,.. Although this filter contains six reactive elements, II z, II can nonetheless be con-
structed in a relatively straightforward manner using graphical construction techniques. The element val-
ues are: 
L1 =32 mH 
~ = 400 ttH 
L:J = 800 ttH 
L4 = 1 ttH 
C1 = 32 ttF 
C2 = 6.8 ttF 
R1 = lOQ 
R2 = 1 Q 
(a) 
Construct II Z,. II using the "algebra on the graph" method. Give simple approximate analytical 
expressions for all asymptotes and corner frequencies. 
(b) 
It is desired that II Z,. II be approximately equal to 5 Qat 500Hz and 2.5 Q at 1 kHz. Suggest a 
simple way to accomplish this by changing the value of one component. 
Ll 
L:J 
Fig. 8.69 
Input filter circuit of Problem 8.13. 
z,. --
8.14 
Construct the Bode plot of the magnitude of the output impedance of the filter illustrated in Fig. 
Fig. 8.70. Give approximate analytical expressions for each corner frequency. No credit will be given 
for computer-generated plots. 
8.15 
A certain open-loop buck-boost converter contains an input filter. Its small-signal ac model is shown in 
Fig. 8.71, and the element values are specified below. Construct the Bode plot for the magnitude of the 
converter output impedance II Z0" 1(s) 11. Label the values of all important corner frequencies and asymp-
totes. 
D=0.6 
R=6Q 
C = 0.33 ttF 
L=25 ttH 
L1= 150 ttH 
C1= 16 ttF 
Cb= 2200 ttF 
R1= 1 Q 

28V + 
Fig. 8.70 
Rl 
!Q 
Lz 
5mH 
Input filter circuit of Problem 8.14. 
L 
Problems 
327 
CJ 
Cs 
zout 
100 JlF 
1 JlF 
c 
R 
zout(s) 
Fig. 8.71 
Small-signal model of a buck-boost converter with input filter, Problem 8.15. 
8.16 
The small-signal equations of the Watkins-Johnson converter operating in continuous conduction mode 
are: 
L d~~) =- Dv(t) + (2Vg- V)d(t) + (D- D')v g(t) 
C d~~) = Di(t)- fi~) 
i gCt) = (D- D')i(t) + 2/d(t) 
(a) 
Derive analytical expressions for the line-to-output transfer function Gv8(s) and the control-to-
output transfer function Gvis). 
(b) 
Derive analytical expressions for the salient features (de gains, corner frequencies, and Q-fac-
tors) of the transfer functions Gv8(s) and Gvjs). Express your results as functions of V8, D, R, L, 
and C. 
(c) 
The converter operates at V8 = 28 V, D = 0.25, R = 28 Q, C = 100 /lF, L = 400 !lF. Sketch the 
Bode diagram of the magnitude and phase of Gvjs). Label salient features. 
8.17 
The element values in the buck converter of Fig. 
7.68 are: 
V8 = 12ov 
R= lOQ 
L= 550 /lH 
D=0.6 
R8 =2Q 
C= 100 /lF 
(a) 
Determine an analytical expression for the control-to-output transfer function GvgCs) of this con-
verter. 
(b) 
Find analytical expressions for the salient features of Gv8(s). 
(c) 
Construct magnitude and phase asymptotes for Gvg· Label the numerical values of all slopes and 

328 
Converter Transfer Functions 
other important features. 
8.18 
Loss mechanisms in capacitors, such as dielectric loss and contact and foil resistance, can be modeled 
electrically using an equivalent series resistance ( esr). Capacitors whose dielectric materials exhibit a 
high dielectric constant, such as electrolytic capacitors, tantalum capacitors, and some types of multi-
layer ceramic capacitors, typically exhibit relatively high esr. 
A buck converter contains a 1.6 mH inductor, and operates with a quiescent duty cycle of 0.5. Its 
output capacitor can be modeled as a 16 JIF capacitor in series with a 0.2 Q esr. The load resistance is 
10 D. The converter operates in continuous conduction mode. The quiescent input voltage is Vg = 120 V. 
(a) 
Determine an analytical expression for the control-to-output transfer function GvgCs) of this con-
verter. 
(b) 
Find analytical expressions for the salient features of GvgCs). 
(c) 
Construct magnitude and phase asymptotes for Gvg· Label the numerical values of all slopes and 
other important features. 
8.19 
The LCC resonant inverter circuit contains the following transfer function: 
(a) 
When C1 is sufficiently large, this transfer function can be expressed as an inverted pole and a 
quadratic pole pair. Derive analytical expressions for the corner frequencies and Q-factor in this 
case, and sketch typical magnitude asymptotes. Determine analytical conditions for validity of 
your approximation. 
(b) 
When C2 is sufficiently large, the transfer function can be also expressed as an inverted pole and 
a quadratic pole pair. Derive analytical expressions for the corner frequencies and Q-factor in 
this case, and sketch typical magnitude asymptotes. Determine analytical conditions for validity 
of your approximation in this case. 
(c) 
When C1 = C2 and when the quadratic poles have sufficiently high Q, then the transfer function 
can again be expressed as an inverted pole and a quadratic pole pair. Derive analytical expres-
sions for the corner frequencies and Q-factor in this case, and sketch typical magnitude asymp-
totes. Determine analytical conditions for validity of your approximation in this case. 
8.20 
A two-section L-C filter has the following transfer function: 
The element values are: 
R=50mQ 
c1 = 680 JIF 
L1 = 500 JIH 
c2 = 4.7 JIF 
L2 =50 JIH 
(a) 
Factor G(s) into approximate real and quadratic poles, as appropriate. Give analytical expres-
sions for the salient features. Justify your approximation using the numerical element values. 
(b) 
Construct the magnitude and phase asymptotes of G(s). 
(c) 
It is desired to reduce the Q to 2, without significantly changing the corner frequencies or other 
features of the response. It is possible to do this by changing only two element values. Specify 
how to accomplish this. 
8.21 
The boost converter of Fig. 8. 72 operates in the continuous conduction mode, with quiescent duty cycle 

Problems 
329 
D = 0.6. On semi-log axes, construct the magnitude and phase Bode plots of 
(a) 
the control-to-output transfer function Gvis), 
(b) 
the line-to-output transfer function Gv8(s), 
(c) 
the output impedance zout(s), and 
(d) 
the input impedance Z;n(s). 
On each plot, label the corner frequencies and asymptotes. 
Fig. 8.72 
Boost 
converter 
of 
Problem 8.21. 
Boost converter 
r··············L"···············································1 
+ 
v 
R 
12 Q 
8.22 
The forward converter of Fig. 8.73 operates in the continuous conduction mode, with the quiescent val-
ues V8 = 380 V and V = 28 V. The transformer turns ratio is n/n3 = 4.5. On semi-log axes, construct the 
magnitude and phase Bode plots of 
(a) 
the control-to-output transfer function Gvis), and 
(b) 
the line-to-output transfer function Gv8(s). 
On each plot, label the corner frequencies and asymptotes. Hint: other than introduction of the turns 
ratio n/n3, the transformer does not significantly affect the small-signal behavior of the forward con-
verter. 
nl 
nl 
L 
+ 
R 
v(t) 
7Q 
vg(t) + 
-
J, =150kHz 
d 
Fig. 8.73 
Forward converter of Problem 8.22. 
8.23 
The boost converter of Fig. 8.74 operates in the continuous conduction mode, with the following quies-
cent values: V8 = 120 V, V = 300 V. It is desired to control the converter input current waveform, and 
hence it is necessary to determine the small-signal transfer function 

330 
Converter Transfer Functions 
(a) 
Derive an analytical expression for G;/s). Express all poles and zeroes in normalized standard 
form, and give analytical expressions for the corner frequencies, Q-factor, and de gain. 
(b) 
On semi-log axes, construct the Bode plot for the magnitude and phase of GJs). 
Fig. 8. 7 4 
Boost 
converter 
of 
Problem 8.23. 
f.= 100kHz 
·' 
+ 
v 
R 
120Q 
8.24 
The buck-boost converter of Fig. 8.75 operates in the continuous conduction mode, with the following 
quiescent values: Vg = 48 V, V = -24 V. On semi-log axes, construct the magnitude and phase Bode plots 
of: 
(a) 
the control-to-output transfer function Gvis), and 
(b) 
the output impedance Z0 .,1(s). 
On each plot, label the corner frequencies and asymptotes as appropriate. 
Fig. 8.75 
Buck-boost converter 
of Problem 8.24. 
R 
5Q 
+ 
v 

9 
Controller Design 
9.1 
INTRODUCTION 
In all switching converters, the output voltage v(t) is a function of the input line voltage v /t), the duty 
cycle d(t), and the load current i100it), as well as the converter circuit element values. In a de-de con-
verter application, it is desired to obtain a constant output voltage v(t) = V, in spite of disturbances in v /t) 
and itoait), and in spite of variations in the converter circuit element values. The sources of these distur-
bances and variations are many, and a typical situation is illustrated in Fig. 9.1. The input voltage v/t) of 
an off-line power supply may typically contain periodic variations at the second harmonic of the ac 
power system frequency (100Hz or 120Hz), produced by a rectifier circuit. The magnitude ofv/t) may 
also vary when neighboring power system loads are switched on or off. The load current itoait) may con-
tain variations of significant amplitude, and a typical power supply specification is that the output voltage 
must remain within a specified range (for example, 3.3 V ± 0.05 V) when the load current takes a step 
change from, for example, full rated load current to 50% of the rated current, and vice versa. The values 
of the circuit elements are constructed to a certain tolerance, and so in high-volume manufacturing of a 
converter, converters are constructed whose output voltages lie in some distribution. It is desired that 
essentially all of this distribution fall within the specified range; however, this is not practical to achieve 
without the use of negative feedback. Similar considerations apply to inverter applications, except that 
the output voltage is ac. 
So we cannot expect to simply set the de-de converter duty cycle to a single value, and obtain a 
given constant output voltage under all conditions. The idea behind the use of negative feedback is to 
build a circuit that automatically adjusts the duty cycle as necessary, to obtain the desired output voltage 
with high accuracy, regardless of disturbances in v/t) or i100it) or variations in component values. This is 

332 
Controller Design 
(a) 
Switching converter 
Load 
r·······················-····················-·-····--------------··---····i 
.-----~--
~,_~-+~-, 
v(t) 
t .••••.•...•.....................•••....••............••...••••.......... .! 
o(t)L ~ o(t) 
LU_L/ 
tfl's Ts 
t 
(b) 
Switching converter 
v(t) = f(v8 , itoad' d) 
vgU) 
...::;.::::..._--1~ } Disturbances 
v(t) 
~oatlt) 
d(t) 
} Control input 
Fig. 9.1 The output voltage of a typical switching converter is a function of the line input voltage v 8, the duty cycle 
d, and the load current i1oad: (a) open-loop buck converter; (b) functional diagram illustrating dependence ofv on the 
independent quantities v 8, d, and itood' 
a useful thing to do whenever there are variations and unknowns that otherwise prevent the system from 
attaining the desired performance. 
A block diagram of a feedback system is shown in Fig. 9.2. The output voltage v(t) is measured, 
using a "sensor" with gain H(s). In a de voltage regulator or dc-ac inverter, the sensor circuit is usually a 
voltage divider, comprised of precision resistors. The sensor output signal H(s)v(s) is compared with a 
reference input voltage vrefs). The objective is to make H(s)v(s) equal to vrej.s), so that v(s) accurately 
follows v ref.s) regardless of disturbances or component variations in the compensator, pulse-width modu-
lator, gate driver, or converter power stage. 
The difference between the reference input vrej.s) and the sensor output H(s)v(s) is called the 
error signal v.(s). If the feedback system works perfectly, then v,.j.s) = H(s)v(s), and hence the error sig-
nal is zero. In practice, the error signal is usually nonzero but nonetheless small. Obtaining a small error 
is one of the objectives in adding a compensator network G/s) as shown in Fig. 9.2. Note that the output 
voltage v(s) is equal to the error signal v.(s), multiplied by the gains of the compensator, pulse-width 
modulator, and converter power stage. If the compensator gain G/s) is large enough in magnitude, then a 
small error signal can produce the required output voltage v(t) = V for a de regulator (Q: how should H 
and vre1then be chosen?). So a large compensator gain leads to a small error, and therefore the output fol-
lows the reference input with good accuracy. This is the key idea behind feedback systems. 
The averaged small-signal converter models derived in Chapter 7 are used in the following sec-
tions to find the effects of feedback on the small-signal transfer functions of the regulator. The loop gain 
T(s) is defined as the product of the small-signal gains in the forward and feedback paths of the feedback 

(a) 
(b) 
Power 
input 
Transistor 
gate driver 
Switching converter 
Load 
9.1 
Introduction 
333 
1.....--r-----' 
Sensor 
gain 
Reference 
input 
vref 
Switching converter 
vg(t) 
v(t) = f( v g' iload' d) 
iloait) 
} Disturbances 
v(t) 
d(t) 
} Control input 
Fig. 9.2 
Feedback loop for regulation of the output voltage: (a) buck converter, with feedback loop block diagram; 
(b) functional block diagram of the feedback system. 
loop. It is found that the transfer function from a disturbance to the output is multiplied by the factor 
1/(1 + T(s)). Hence, when the loop gain Tis large in magnitude, then the influence of disturbances on the 
output voltage is small. A large loop gain also causes the output voltage v(s) to be nearly equal to 
v,e/s)/H(s), with very little dependence on the gains in the forward path of the feedback loop. So the 
loop gain magnitude II T II is a measure of how well the feedback system works. All of these gains can be 
easily constructed using the algebra-on-the-graph method; this allows easy evaluation of important 
closed-loop performance measures, such as the output voltage ripple resulting from 120Hz rectification 
ripple in v/t) or the closed-loop output impedance. 
Stability is another important issue in feedback systems. Adding a feedback loop can cause an 
otherwise well-behaved circuit to exhibit oscillations, ringing and overshoot, and other undesirable 
behavior. An in-depth treatment of stability is beyond the scope of this book; however, the simple phase 
margin criterion for assessing stability is used here. When the phase margin of the loop gain Tis positive, 
then the feedback system is stable. Moreover, increasing the phase margin causes the system transient 
response to be better behaved, with less overshoot and ringing. The relation between phase margin and 
closed-loop response is quantified in Section 9.4. 
An example is given in Section 9.5, in which a compensator network is designed for a de regu-

334 
Controller Design 
lator system. The compensator network is designed to attain adequate phase margin and good rejection 
of expected disturbances. Lead compensators and P-D controllers are used to improve the phase margin 
and extend the bandwidth of the feedback loop. This leads to better rejection of high-frequency distur-
bances. Lag compensators and P-I controllers are used to increase the low-frequency loop gain. This 
leads to better rejection of low-frequency disturbances and very small steady-state error. More compli-
cated compensators can achieve the advantages of both approaches. 
Injection methods for experimental measurement of loop gain are introduced in Section 9.6. 
The use of voltage or current injection solves the problem of establishing the correct quiescent operating 
point in high-gain systems. Conditions for obtaining an accurate measurement are exposed. The injection 
method also allows measurement of the loop gains of unstable systems. 
9.2 
EFFECT OF NEGATIVE FEEDBACK ON THE 
NETWORK TRANSFER FUNCTIONS 
We have seen how to derive the small-signal ac transfer functions of a switching converter. For example, 
the equivalent circuit model of the buck converter can be written as in Fig. 9.3. This equivalent circuit 
contains three independent inputs: the control input variations J, the power input voltage variations Og, 
and the load current variations iload· The output voltage variation 0 can therefore be expressed as a linear 
combination of the three independent inputs, as follows: 
(9.1) 
where 
G 
-
v(s) I 
vis)- d(s) o,=o 
i load= 0 
converter control-to-output transfer function 
(9.la) 
converter line-to-output transfer function 
(9.lb) 
converter output impedance 
(9.lc) 
The Bode diagrams of these quantities are constructed in Chapter 8. Equation (9 .1) describes how distur-
e(s)d(s) 
+ 
O(s) 
R 
Fig. 9.3 
Small-signal converter model, which represents variations in v8, d, and itoad· 

9.2 
Effect of Negative Feedback on the Network Transfer Functions 
335 
bances vg and itoad propagate to the output v, through the transfer function GvgCs) and the output imped-
ance Z0Js). If the disturbances v8 and itoad are known to have some maximum worst-case amplitude, 
then Eq. (9.1) can be used to compute the resulting worst-case open-loop variation in v. 
As described previously, the feedback loop of Fig. 9.2 can be used to reduce the influences of vg 
and i1oad on the output v. To analyze this system, let us perturb and linearize its averaged signals about 
their quiescent operating points. Both the power stage and the control block diagram are perturbed and 
linearized: 
v,efJl = v,ef + o rePl 
ve(t) = ve + 0 ,(t) 
etc. 
(9.2) 
In a de regulator system, the reference input is constant, so v,eft) = 0. In a switching amplifier or dc-ac 
inverter, the reference input may contain an ac variation. In Fig. 9.4(a), the converter model of Fig. 9.3 is 
combined with the perturbed and linearized control circuit block diagram. This is equivalent to the 
reduced block diagram of Fig. 9.4(b), in which the converter model has been replaced by blocks repre-
senting Eq. (9.1). 
Solution of Fig. 9.4(b) for the output voltage variation v yields 
which can be written in the form 
with 
A 
A 
1 
T 
A 
G,g 
• 
Zout 
V = V ref 7[ 1 + T + V g 1 + T- ltoad 1 + T 
T(s) = H(s)Gc(s)GvJs)IV M ="loop gain" 
(9.3) 
(9.4) 
Equation (9.4) is a general result. The loop gain T(s) is defined in general as the product of the gains 
around the forward and feedback paths of the loop. This equation shows how the addition of a feedback 
loop modifies the transfer functions and performance of the system, as described in detail below. 
9.2.1 
Feedback Reduces the Transfer Functions from 
Disturbances to the Output 
The transfer function from vg to v in the open-loop buck converter of Fig. 9.3 is Gvg(s), as given in Eq. 
(9.1). When feedback is added, this transfer function becomes 
v(s) I 
- G,g(s) 
v g(s) orero - 1 + T(s) 
itoad::O 
(9.5) 
from Eq. (9.4). So this transfer function is reduced via feedback by the factor 11(1 + T(s)). If the loop 
gain T(s) is large in magnitude, then the reduction can be substantial. Hence, the output voltage variation 
v resulting from a given v 8 variation is attenuated by the feedback loop. 

336 
Controller Design 
(a) 
e(s)d(s) 
Compensator 
H(s)v(s) 
(b) 
H(s)v(s) 
d(s) 
Pulse-width 
modulator 
gain 
gain 
+ 
v(s) 
R 
iloais) Loa_d ~urrent 
vanatwn 
Fig. 9.4 
Voltage regulator system small-signal model: (a) with converter equivalent circuit; (b) complete block 
diagram. 

9.3 
Construction of the Important Quantities 11( 1 + T) and Tl( 1 + T) and the Closed-Loop Transfer Functions 
337 
Equation (9.4) also predicts that the converter output impedance is reduced, from Zou/s) to 
(9.6) 
So the feedback loop also reduces the converter output impedance by a factor of 11(1 + T(s)), and the 
influence of load current variations on the output voltage is reduced. 
9.2.2 
Feedback Causes the Transfer Function from the 
Reference Input to the Output to be Insensitive to 
Variations in the Gains in the Forward Path of the Loop 
According to Eq. (9.4), the closed-loop transfer function from vref to vis 
v(s) I 
_ ~1~ __]J!)_ 
v re/s) :g=O - H(s) 1 + T(s) 
1 load=O 
(9.7) 
If the loop gain is large in magnitude, that is, II T II » 1, then (1 + n "'T and T/(1 + n "'TIT= 1. The 
transfer function then becomes 
v(s) -
1 
V re/s)- H(s) 
(9.8) 
which is independent of G/s), V M' and Gvis). So provided that the loop gain is large in magnitude, then 
variations in G/s), V M' and Gvis) have negligible effect on the output voltage. Of course, in the de regu-
lator application, vref is constant and vref = 0. But Eq. (9.8) applies equally well to the de values. For 
example, if the system is linear, then we can write 
(9.9) 
So to make the de output voltage V accurately follow the de reference Vref' we need only ensure that the 
de sensor gain H(O) and de reference Vref are well-known and accurate, and that T(O) is large. Precision 
resistors are normally used to realize H, but components with tightly-controlled values need not be used 
in Gc, the pulse-width modulator, or the power stage. The sensitivity of the output voltage to the gains in 
the forward path is reduced, while the sensitivity of v to the feedback gain Hand the reference input v ref 
is increased. 
9.3 
CONSTRUCTION OF THE IMPORTANT QUANTITIES 1/(1 + D AND 
T/(1 + D AND THE CLOSED-LOOP TRANSFER FUNCTIONS 
The transfer functions in Eqs. (9.4) to (9.9) can be easily constructed using the algebra-on-the-graph 
method [4]. Let us assume that we have analyzed the blocks in our feedback system, and have plotted the 
Bode diagram of II T(s) 11. To use a concrete example, suppose that the result is given in Fig. 9.5, for 
which T(s) is 

338 
Controller Design 
80dB 
II Til 
60dB 
I To lcts 
40dB 
20dB 
OdB 
-20dB 
Crossover 
frequency 
-40dB ~------~r--------+------~-r------~~----~~ 
1Hz 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
f 
Fig. 9.5 Magnitude of the loop gain example, Eq. (9.10). 
(1 + ..l...) 
T(s) = T0 
w, 
(1+-s +(-s )2)(1+-L) 
Qwp1. 
wpt 
Wpz 
(9.10) 
This example appears somewhat complicated. But the loop gains of practical voltage regulators are often 
even more complex, and may contain four, five, or more poles. Evaluation of Eqs. (9.5) to (9.7), to deter-
mine the closed-loop transfer functions, requires quite a bit of work. The loop gain T must be added to 1, 
and the resulting numerator and denominator must be refactored. Using this approach, it is difficult to 
obtain physical insight into the relationship between the closed-loop transfer functions and the loop gain. 
In consequence, design of the feedback loop to meet specifications is difficult. 
Using the algebra-on-the-graph method, the closed-loop transfer functions can be constructed 
by inspection, and hence the relation between these transfer functions and the loop gain becomes obvi-
ous. Let us first investigate how to plot II T/(1 + T) 11. It can be seen from Fig. 9.5 that there is a frequency 
fc, called the "crossover frequency," where II T II = 1. At frequencies less than fc, II T II > 1; indeed, 
II T II ~ 1 for f ~ fc. Hence, at low frequency, ( 1 + T) "' T, and T/( 1 + T) "' TIT= 1. At frequencies greater 
thanfc, II T II< 1, and II T II ~ 1 for J~ fc. So at high frequency, (1 + T)"' 1 and T/(1 + T)"' Til = T. So 
we have 
T I 1 
1+T"'\r 
for II T II » 1 
for II T II « 1 
(9.11) 
The asymptotes corresponding to Eq. (9.11) are relatively easy to construct. The low-frequency asymp-
tote, for f <fc, is 1 or 0 dB. The high-frequency asymptotes, for f> fc, follow T. The result is shown in 
Fig. 9.6. 
So at low frequency, where II T II is large, the reference-to-output transfer function is 
O(s) 
1 
T(s) 
1 
0 "/s) = H(s) 1 + T(s) "'H(s) 
(9.12) 

9.3 
Construction of the Important Quantities II( I + T) and Tl( 1 + T) and the Closed-Loop Transfer Functions 
339 
80 dB 
60dB 
40dB 
fp1 
II Til 
20dB 
0 dB 
-20dB 
Ill ~T II 
-40 dB 
1Hz 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
f 
Fig. 9.6 
Graphical construction of the asymptotes of II T/(1 + T) 11. Exact curves are omitted. 
This is the desired behavior, and the feedback loop works well at frequencies where II T II is large. At high 
frequency (j::'P JJ where II T II is small, the reference-to-output transfer function is 
(9.13) 
This is not the desired behavior; in fact, this is the gain with the feedback connection removed (H-+ 0). 
At high frequencies, the feedback loop is unable to reject the disturbance because the bandwidth ofT is 
limited. The reference-to-output transfer function can be constructed on the graph by multiplying the 
T/(1 + T) asymptotes of Fig. 9.6 by 1/H. 
We can plot the asymptotes of \111(1 + T) \1 using similar arguments. At low frequencies where 
II T II ::'9 1, then (1 + T) "'T, and hence 11(1 + T)"' liT. At high frequencies where II T II < 1, then (1 + T) 
"' 1 and 11(1 + T) "' 1. So we have 
for~ T II» 1 
for II T ll.,g;:: 1 
The asymptotes for the T(s) example of Fig. 9.5 are plotted in Fig. 9. 7. 
At low frequencies where II T II is large, the disturbance transfer function from vg to vis 
(9.14) 
(9.15) 
Again, GvgCs) is the original transfer function, with no feedback. The closed-loop transfer function has 
magnitude reduced by the factor 1111 T 11. So if, for example, we want to reduce this transfer function by a 
factor of 20 at 120Hz, then we need a loop gain II T II of at least 20 ==} 26 dB at 120Hz. The disturbance 
transfer function from v 8 to v can be constructed on the graph, by multiplying the asymptotes of Fig. 9. 7 
by the asymptotes for GvgCs). 
Similar arguments apply to the output impedance. The closed-loop output impedance at low fre-

340 
Controller Design 
80dB 
60dB 
I To lcts 
40dB 
II Til 
20dB 
- 20 dB/decade 
OdB 
-20dB 
- 40 dB/decade 
-40dB 
LlTII 
-I To lcts 
-60dB 
-SOdB~------~~-------+--------~--------~--------4 
I Hz 
10Hz 
100Hz 
I kHz 
lOkHz 
100kHz 
f 
Fig. 9.7 Graphical construction of II 1/(1 + n II. 
quencies is 
(9.16) 
The output impedance is also reduced in magnitude by a factor of 1111 T II at frequencies below the cross-
over frequency. 
At high frequencies if> f) where II T II is small, then 11(1 + T) "" I, and 
(9.17) 
This is the same as the original disturbance transfer function and output impedance. So the feedback loop 
has essentially no effect on the disturbance transfer functions at frequencies above the crossover fre-
quency. 
9.4 
STABILITY 
It is well known that adding a feedback loop can cause an otherwise stable system to become unstable. 
Even though the transfer functions of the original converter, Eq. (9.1), as well as of the loop gain T(s), 
contain no right half-plane poles, it is possible for the closed-loop transfer functions of Eq. (9.4) to con-
tain right half-plane poles. The feedback loop then fails to regulate the system at the desired quiescent 
operating point, and oscillations are usually observed. It is important to avoid this situation. And even 
when the feedback system is stable, it is possible for the transient response to exhibit undesirable ringing 

9.4 
Stability 
341 
and overshoot. The stability problem is discussed in this section, and a method for ensuring that the feed-
back system is stable and well-behaved is explained. 
When feedback destabilizes the system, the denominator (I + T(s)) terms in Eq. (9.4) contain 
roots in the right half-plane (i.e., with positive real parts). If T(s) is a rational fraction, that is, the ratio 
N(s)/D(s) of two polynomial functions N(s) and D(s), then we can write 
N(s) 
T(s) 
D(s) 
N(s) 
1 + T(s) = 1 
N(s) = N(s) + D(s) 
+ D(s) 
1 
l 
D(s) 
1 + T(s) = 1 
N(s) = N(s) + D(s) 
+ D(s) 
(9.18) 
So T(s)/(1 + T(s)) and ll(l+T(s)) contain the same poles, given by the roots of the polynomial 
(N(s) + D(s)). A brute-force test for stability is to evaluate (N(s) + D(s)), and factor the result to see 
whether any of the roots have positive real parts. However, for all but very simple loop gains, this 
involves a great deal of work. A simpler method is given by the Nyquist stability theorem, in which the 
number of right half-plane roots of (N(s) + D(s)) can be determined by testing T(s) [1,2]. This theorem is 
not discussed here. However, a special case of the theorem known as the phase margin test is sufficient 
for designing most voltage regulators, and is discussed in this section. 
9.4.1 
The Phase Margin Test 
The crossover frequency fc is defined as the frequency where the magnitude of the loop gain is unity: 
II T(J2nfc) II= 1 ~ 0 dB 
(9.19) 
60dB 
II Til 
II Til 
LT 
20dB 
LT 
o· 
-20dB 
-40 dB 
------------------------------------··· ---------···--·-·············J~": ............................................. . 
-180" 
-270" 
1Hz 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
f 
Fig. 9.8 
Magnitude and phase of the loop gain of a stable system. The phase margin <flm is positive. 

342 
Controller Design 
60dB 
II Til 
II Til 
LT 
40dB 
20dB 
LT 
OdB 
o· 
-20dB 
-90' 
-40dB 
-180' 
-270' 
1Hz 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
f 
Fig. 9.9 Magnitude and phase of the loop gain of an unstable system. The phase margin (jlm is negative. 
To compute the phase margin (jl111, the phase of the loop gain Tis evaluated at the crossover frequency, 
and 180" is added. Hence, 
<Jlm = 180' + L. r(j2nfc) 
(9.20) 
If there is exactly one crossover frequency, and if the loop gain T(s) contains no right half-plane poles, 
then the quantities 11(1 + T) and T/(1 + T) contain no right half-plane poles when the phase margin 
defined in Eq. (9.20) is positive. Thus, using a simple test on T(s), we can determine the stability of 
T/(1 + T) and 11(1 + T). This is an easy-to-use design tool-we simple ensure that the phase of Tis 
greater than -180" at the crossover frequency. 
When there are multiple crossover frequencies, the phase margin test may be ambiguous. Also, 
when T contains right half-plane poles (i.e., the original open-loop system is unstable), then the phase 
margin test cannot be used. In either case, the more general Nyquist stability theorem must be employed. 
The loop gain of a typical stable system is shown in Fig. 9.8. It can be seen that 
LT(j2nfc) = -112". Hence, (jlm = 180"- 112" = +68". Since the phase margin is positive, T/(1 + T) and 
11(1 + T) contain no right half-plane poles, and the feedback system is stable. 
The loop gain of an unstable system is sketched in Fig. 9.9. For this example, 
LT(j2nfc) = -230". The phase margin is (jlm = 180"- 230" =-50". The negative phase margin implies that 
Tl(l + T) and 11( 1 + T) each contain at least one right half-plane pole. 
9.4.2 
The Relationship Between Phase Margin and Closed-Loop Damping Factor 
How much phase margin is necessary? Is a worst-case phase margin of 1" satisfactory? Of course, good 
designs should have adequate design margins, but there is another important reason why additional phase 
margin is needed. A small phase margin (in T) causes the closed-loop transfer functions T/(1 + T) and 
11(1 + T) to exhibit resonant poles with high Q in the vicinity of the crossover frequency. The system 
transient response exhibits overshoot and ringing. As the phase margin is reduced these characteristics 

9.4 
Stability 
343 
40dB 
II Til 
L.T 
20dB 
OdB 
-20dB 
-40dB 
o· 
L.T 
-90' 
-90' 
<pm 
+-------+----~---___,f------+--------+ -270' 
f 
Fig. 9.10 Magnitude and phase asymptotes for the loop gain T of Eq. (9.21). 
become worse (higher Q, longer ringing) until, for <pm ::; 0', the system becomes unstable. 
Let us consider a loop gain T(s) which is well-approximated, in the vicinity of the crossover fre-
quency, by the following function: 
(9.21) 
Magnitude and phase asymptotes are plotted in Fig. 9.1 0. This function is a good approximation near the 
crossover frequency for many common loop gains, in which II T II approaches unity gain with a 
-20 dB/decade slope, with an additional pole at frequency f2 = w2/2n. Any additional poles and zeroes 
are assumed to be sufficiently far above or below the crossover frequency, such that they have negligible 
effect on the syst~JTI transfer functions near the crossover frequency. 
Note that, as j 2 --+ co, the phase margin <flm approaches 90'. As j 2 --+ 0, <pm --+ 0'. So as j 2 is 
reduced, the phase margin is also reduced. Let's investigate how this affects the closed-loop response via 
T/(1 + T). We can write 
T(s) 
1 
1 
1 + T(s) = 1 + 1 = 1 
s 
s 2 
T(s) 
+ Wo + WoW2 
(9.22) 
using Eq. (9.21). By putting this into the standard normalized quadratic form, one obtains 
T(s) 
1 + T(s) 
(9.23) 
where 

344 
Controller Design 
40dB 
II Til 
fo 
7 
Fig. 
9.11 
Construction of 20dB 
magnitude asymptotes of the 
closed-loop transfer function 
OdB 
Ill~ T II 
T/(1 + 1), for the low-Q case. 
-20dB 
-40dB 
- 40 dB/decade 
f 
So the closed-loop response contains quadratic poles atfc, the geometric mean off0 and/2. These poles 
have a low Q-factor whenf0 « / 2. In this case, we can use the low-Q approximation to estimate their fre-
quencies: 
(9.24) 
Magnitude asymptotes are plotted in Fig. 9.11 for this case. It can be seen that these asymptotes conform 
to the rules of Section 9.3 for constructing T/(1 + T) by the algebra-on-the-graph method. 
Next consider the high-Q case. When the pole frequency / 2 is reduced, reducing the phase mar-
gin, then the Q-factor given by Eq. (9.23) is increased. For Q > 0.5, resonant poles occur at frequency fc· 
The magnitude Bode plot for the casef2 <!0 is given in Fig. 9.12. The frequency fc continues to be the 
geometric mean of/2 andf0, andfc now coincides with the crossover (unity-gain) frequency of the II T II 
asymptotes. The exact value of the closed-loop gain T/(1 + T) at frequency fc is equal to Q = folfc· As 
shown in Fig. 9.12, this is identical to the value of the low-frequency -20 dB/decade asymptote (/0/f), 
evaluated at frequency fc· It can be seen that the Q-factor becomes very large as the pole frequency f 2 is 
reduced. 
The asymptotes of Fig. 9.12 also follow the algebra-on-the-graph rules of Section 9.3, but the 
deviation of the exact curve from the asymptotes is not predicted by the algebra-on-the-graph method. 
60dB 
fo 
II Til 
7 
40dB 
Fig. 
9.12 
Construction of 
- 20 dB/decade 
magnitude asymptotes of the 
20dB 
closed-loop 
transfer function 
Tl( 1 + T), for the high-Q case. 
OdB 
-20dB 
L~rll 
····... 
Q = fo/.fc 
+----------==;:...._----».:" .............. :·:.-.of ....................................... .. 
fc=W 
fo 
t 
- 40 dB/decade 
-40dB 
f 

9.4 
Stability 
345 
20dB 
Q 
15 dB 
lOdB 
\ 
~ 
5 dB 
OdB 
-5 dB 
-lOdB 
-15 dB 
~ 
~~ 
Q=l=*OdB 
1 +-..........._ 
~ 
cp = 52° 
m 
Q 0.5 =* 6 dB 
f' 
""' 
cp = 76° 
m 
\ 
\ 
-20dB 
oo 
100 
20° 
30° 
40° 
50° 
60° 
70° 
80° 
goo 
<pm 
Fig. 9.13 Relationship between loop-gain phase margin (jl"' and closed-loop peaking factor Q. 
These two poles with Q-factor appear in both T/(1 + T) and 1/(1 + T). We need an easy way to predict the 
Q-factor. We can obtain such a relationship by finding the frequency at which the magnitude of T is 
exactly equal to unity. We then evaluate the exact phase of Tat this frequency, and compute the phase 
margin. This phase margin is a function of the ratiof0/f2, or Q2. We can then solve to find Q as a function 
of the phase margin. The result is 
(9.25) 
This function is plotted in Fig. 9.13, with Q expressed in dB. It can be seen that obtaining real poles 
(Q < 0.5) requires a phase margin of at least 76°. To obtain Q = 1, a phase margin of 52" is needed. The 
system with a phase margin of 1° exhibits a closed-loop response with very high Q! With a small phase 
margin, T(jw) is very nearly equal to -1 in the vicinity of the crossover frequency. The denominator 
(1 + T) then becomes very small, causing the closed-loop transfer functions to exhibit a peaked response 
at frequencies near. the crossover frequency fc· 
Figure 9.13 is the result for the simple loop gain defined by Eq. (9.21). However, this loop gain 
is a good approximation for many other loop gains that are encountered in practice, in which II T II 
approaches unity gain with a -20 dB/decade slope, with an additional pole at frequency j2• If all other 
poles and zeroes of T(s) are sufficiently far above or below the crossover frequency, then they have negli-
gible effect on the system transfer functions near the crossover frequency, and Fig. 9.13 gives a good 
approximation for the relationship between <pm and Q. 
Another common case is the one in which II T II approaches unity gain with a -40 dB/decade 
slope, with an additional zero at frequency j2• As j2 is increased, the phase margin is decreased and Q is 
increased. It can be shown that the relation between <pm and Q is exactly the same, Eq. (9.25). 
A case where Fig. 9.13 fails is when the loop gain T(s) three or more poles at or near the cross-

346 
Controller Design 
over frequency. The closed-loop response then also contains three or more poles near the crossover fre-
quency, and these poles cannot be completely characterized by a single Q-factor. Additional work is 
required to find the behavior of the exact Tl(l + D and 11(1 + D near the crossover frequency, but none-
theless it can be said that a small phase margin leads to a peaked closed-loop response. 
9.4.3 
Transient Response vs. Damping Factor 
One can solve for the unit-step response of the T/(1 + D transfer function, by multiplying Eq. (9.23) by 
lis and then taking the inverse Laplace transform. The result for Q > 0.5 is 
(9.26) 
For Q < 0.5, the result is 
(9.27) 
with 
These equations are plotted in Fig. 9.14 for various values of Q. 
According to Eq. (9.23), when f2 > 4f0, the Q-factor is less than 0.5, and the closed-loop 
2 
O(t) 
1.5 
0.5 
0 
0 
5 
10 
15 
Wet, radians 
Fig. 9.14 Unit-step response of the second-order system, Eqs. (9.26) and (9.27), for various values of Q. 

9.5 
Regulator Design 
347 
response contains a low-frequency and a high-frequency real pole. The transient response in this case, 
Eq. (9.27), contains decaying-exponential functions of time, of the form 
Ae(pole)t 
(9.28) 
This is called the "overdamped" case. With very low Q, the low-frequency pole leads to a slow step 
response. 
Forf2 = 4f0, the Q-factor is equal to 0.5. The closed-loop response contains two real poles at fre-
quency 2f0. This is called the "critically damped" case. The transient response is faster than in the over-
damped case, because the lowest-frequency pole is at a higher frequency. This is the fastest response that 
does not exhibit overshoot. At uv = n radians (t = 1/2f), the voltage has reached 82% of its final value. 
At W} = 2n radians (t = 1/f), the voltage has reached 98.6% of its final value. 
For f 2 < 4f0, the Q-factor is greater than 0.5. The closed-loop response contains complex poles, 
and the transient response exhibits sinusoidal-type waveforms with decaying amplitude, Eq. (9.26). The 
rise time of the step response is faster than in the critically-damped case, but the waveforms exhibit over-
shoot. The peak value of v(t) is 
peak v(t) = 1 + e-n 1V4Q2 - 1 
(9.29) 
This is called the "underdamped" case. A Q-factor of 1leads to an overshoot of 16.3%, while a Q-factor 
of 2leads to a 44.4% overshoot. Large Q-factors lead to overshoots approaching 100%. 
The exact transient response of the feedback loop may differ from the plots of Fig. 9.14, 
because of additional poles and zeroes in T, and because of differences in initial conditions. Nonetheless, 
Fig. 9.14 illustrates how high-Q poles lead to overshoot and ringing. In most power applications, over-
shoot is unacceptable. For example, in a 3.3 V computer power supply, the voltage must not be allowed 
to overshoot to 5 or 6 volts when the supply is turned on-this would likely destroy all of the integrated 
circuits in the computer! So the Q-factor must be sufficiently low, often 0.5 or less, corresponding to a 
phase margin of at least 76°. 
9.5 
REGULATOR DESIGN 
Let's now consider how to design a regulator system, to meet specifications or design goals regarding 
rejection of disturbances, transient response, and stability. Typical de regulator designs are defined using 
specifications such as the following: 
1. Effect of load current variations on the output voltage regulation. The output voltage must remain within a 
specified range when the load current varies in a prescribed way. This amounts to a limit on the maximum 
magnitude of the closed-loop output impedance of Eq. (9.6), repeated below 
(9.30) 
If, over some frequency range, the open-loop output impedance Zout has magnitude that exceeds the limit, 
then the loop gain T must be sufficiently large in magnitude over the same frequency range, such that the 
magnitude of the closed-loop output impedance given in Eq. (9.30) is less than the given limit. 
2. 
Effect of input voltage variations (for example, at the second harmonic of the ac line frequency) on the out-
put voltage regulation. Specific maximum limits are usually placed on the amplitude of variations in the 

348 
Controller Design 
output voltage at the second harmonic of the ac line frequency (120Hz or 100Hz). If we know the magni-
tude of the rectification voltage ripple which appears at the converter input (as 08 ), then we can calculate 
the resulting output voltage ripple (in v) using the closed loop line-to-output transfer function of Eq. (9.5), 
repeated below 
v(s) I 
- Gvg(s) 
Og(s) vrero -1+T(s) 
itoad= 0 
(9.31) 
The output voltage ripple can be reduced by increasing the magnitude of the loop gain at the ripple fre-
quency. In a typical good design, II T II is 20 dB or more at 120 Hz, so that the transfer function of Eq. 
(9.31) is at least an order of magnitude smaller than the open-loop line-to-output transfer function II Gvg 11. 
3. 
Transient response time. When a specified large disturbance occurs, such as a large step change in load 
current or input voltage, the output voltage may undergo a transient. During this transient, the output volt-
age typically deviates from its specified allowable range. Eventually, the feedback loop operates to return 
the output voltage within tolerance. The time required to do so is the transient response time; typically, the 
response time can be shortened by increasing the feedback loop crossover frequency. 
4. 
Overshoot and ringing. As discussed in Section 9.4.3, the amount of overshoot and ringing allowed in the 
transient response may be limited. Such a specification implies that the phase margin must be sufficiently 
large. 
Each of these requirements imposes constraints on the loop gain T(s). Therefore, the design of the con-
trol system involves modifying the loop gain. As illustrated in Fig. 9.2, a compensator network is added 
for this purpose. Several well-known strategies for design of the compensator transfer function G/s) are 
discussed below. 
9.5.1 
Lead (PD) compensator 
This type of compensator transfer function is used to improve the phase margin. A zero is added to the 
loop gain, at a frequency fz sufficiently far below the crossover frequency fc, such that the phase margin 
of T(s) is increased by the desired amount. The lead compensator is also called a proportional-plus-
derivative, or PD, controller-at high frequencies, the zero causes the compensator to differentiate the 
error signal. It often finds application in systems originally containing a two-pole response. By use of 
this type of compensator, the bandwidth of the feedback loop (i.e., the crossover frequency f) can be 
Fig. 9.15 
Magnitude and phase asymptotes 
of the P D compensator transfer function G c of 
Eq. (9.32). 
II Gcll 
0' 
L. Gc 
GcO 
fp 
fc 
=JfzJ;, 
f/10 
10fz 
f 

Maximum 
900 
phase lead 
Fig. 
9.16 Maximum 
phase lead 8 vs. fre-
quency ratio f/f, for the 
lead compensator. 
45° 
extended while maintaining an acceptable phase margin. 
9.5 
Regulator Design 
349 
10 
100 
1000 
A side effect of the zero is that it causes the compensator gain to increase with frequency, with a 
+20 dB/decade slope. So steps must be taken to ensure that II T II remains equal to unity at the desired 
crossover frequency. Also, since the gain of any practical amplifier must tend to zero at high frequency, 
the compensator transfer function GJs) must contain high frequency poles. These poles also have the 
beneficial effect of attenuating high-frequency noise. Of particular concern are the switching frequency 
harmonics present in the output voltage and feedback signals. If the compensator gain at the switching 
frequency is too great, then these switching harmonics are amplified by the compensator, and can disrupt 
the operation of the pulse-width modulator (see Section 7.6). So the compensator network should contain 
poles at a frequency less than the switching frequency. These considerations typically restrict the cross-
over frequency fc to be less than approximately 10% of the converter switching frequency fs· In addition, 
the circuit designer must take care not to exceed the gain-bandwidth limits of available operational 
amplifiers. 
The transfer function of the lead compensator therefore contains a low-frequency zero and sev-
eral high-frequency poles. A simplified example containing a single high-frequency pole is given in Eq. 
(9.32) and illustrated in Fig. 9.15. 
(9.32) 
The maximum phase occurs at a frequency fCJ!max given by the geometrical mean of the pole and zero fre-
quencies: 
(9.33) 
To obtain the maximum improvement in phase margin, we should design our compensator so that the 
frequency fCJ!max coincides with the loop gain crossover frequency J; .. The value of the phase at this fre-
quency can be shown to be 

350 
Controller Design 
60dB 
To 
40dB 
II Til 
TOG cO 
II Til 
LT 
20dB 
Compensated gain 
OdB 
.............................................................................. fz ......... . 
-20dB 
1 
o· 
""""""''""- i.~es 
Original phase asymptotes 
LT 
-40dB 
-90' 
+----~-----+----------+-----+ -270' 
f 
Fig. 9.17 Compensation of a loop gain containing two poles, using a lead (PD) compensator. The phase margin 'Pm 
is impmved. 
This equation is plotted in Fig. 9 .16. Equation (9 .34) can be inverted to obtain 
.{p 
1+sin(e) 
~z= 1-sin(e) 
(9.34) 
(9.35) 
where e = LG/fcpmox). Equations (9.34) and (9.32) imply that, to optimally obtain a compensator phase 
lead of e at frequency fc, the pole and zero frequencies should be chosen as follows: 
fz=fc 
1-sin(e) 
1+sin(e) 
(9.36) 
.{p=fc 
1+sin(e) 
1-sin(e) 
When it is desired to avoid changing the crossover frequency, the magnitude of the compensator 
gain is chosen to be unity at the loop gain crossover frequency fc· This requires that G cO be chosen 
according to the following formula: 
(9.37) 
It can be seen that G cO is less than unity, and therefore the lead compensator reduces the de gain of the 

9.5 Regulator Design 
351 
feedback loop. Other choices of Gco can be selected when it is desired to shift the crossover frequency fc; 
for example, increasing the value of G co causes the crossover frequency to increase. If the frequencies fp 
and.fz are chosen as in Eq. (9.36), thenfq>max of Eq. (9.32) will coincide with the new crossover frequency 
fc· 
The Bode diagram of a typical loop gain T(s) containing two poles is illustrated in Fig. 9.17. 
The phase margin of the original T(s) is small, since the crossover frequency fc is substantially greater 
than the pole frequency fo- The result of adding a lead compensator is also illustrated. The lead compen-
sator of this example is designed to maintain the same crossover frequency but improve the phase mar-
gin. 
9.5.2 
Lag (P[) Compensator 
This type of compensator is used to increase the low-frequency loop gain, such that the output is better 
regulated at de and at frequencies well below the loop crossover frequency. As given in Eq. (9.38) and 
illustrated in Fig. 9.18, an inverted zero is added to the loop gain, at frequency k 
G/s) = c""( 1 + ~L) 
(9.38) 
If fL is sufficiently lower than the loop crossover frequency fc, then the phase margin is unchanged. This 
type of compensator is also called a proportional-plus-integral, or PI, controller-at low frequencies, the 
inverted zero causes the compensator to integrate the error signal. 
To the extent that the compensator gain can be made arbitrarily large at de, the de loop gain T(O) 
becomes arbitrarily large. This causes the de component of the error signal to approach zero. In conse-
quence, the steady-state' output voltage is perfectly regulated, and the disturbance-to-output transfer 
functions approach zero at de. Such behavior is easily obtained in practice, with the compensator of Eq. 
(9 .38) realized using a conventional operational amplifier. 
Although the PI compensator is useful in nearly all types of feedback systems, it is an espe-
cially simple and effective approach for systems originally containing a single pole. For the example of 
Fig. 9.19, the original uncompensated loop gain is of the form 
Fig. 9.18 Magnitude and phase asymptotes 
of the PI compensator transfer function G c of 
Eq. (9.38). 
LGC 
-90° 
fL/10 
Gc= 
fL 
lOfL 
00 
f 

352 
Controller Design 
40dB 
II Til 
20dB 
OdB 
-20dB 
90' 
LTU 
-40 dB +---...::.....--~==~=,~ 
o· 
lQjL 
t--~---""~--___;;;;;-.;;,___---+-----t -90' 
---~--~------------------------------------ --------------------------------------~-~~~----J--~-~------------------------
-180' 
1Hz 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
f 
Fig. 9.19 Compensation of a loop gain containing a single pole, using a lag (P[) compensator. The loop gain 
magnitude is increased. 
T 
T(s)=--"0-
u 
( 1 + uio) 
(9.39) 
The compensator transfer function of Eq. (9.38) is used, so that the compensated loop gain is 
T(s) = Tu(s)GJs). Magnitude and phase asymptotes of T(s) are also illustrated in Fig. 9.19. The compen-
sator high-frequency gain Gc= is chosen to obtain the desired crossover frequency fc· If we approximate 
the compensated loop gain by its high-frequency asymptote, then at high frequencies we can write 
II T ~ ~ TuoGc= 
(i) 
(9.40) 
At the crossover frequency f = fc, the loop gain has unity magnitude. Equation (9.40) predicts that the 
crossover frequency is 
(9.41) 
Hence, to obtain a desired crossover frequency fc, we should choose the compensator gain Gc= as fol-
lows: 
(9.42) 
The comer frequency fL is then chosen to be sufficiently less thanfc, such that an adequate phase margin 
is maintained. 
Magnitude asymptotes of the quantity 11(1 + T(s)) are constructed in Fig. 9.20. At frequencies 

9.5 
Regulator Design 
353 
40dB 
20dB 
II Til ~" 
OdB 
························ ····························· 
-20 dB 
-40dB 
1Hz 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
f 
Fig. 9.20 
Construction of 1111(1 + n II for the PI-compensated example of Fig. 9.19. 
less thanfv the PI compensator improves the rejection of disturbances. At de, where the magnitude of Gc 
approaches infinity, the magnitude of 1/(1 + n tends to zero. Hence, the closed-loop disturbance-to-out-
put transfer functions, such as Eqs. (9.30) and (9.31), tend to zero at de. 
9.5.3 
Combined (P/D) Compensator 
The advantages of the lead and lag compensators can be combined, to obtain both wide bandwidth and 
zero steady-state error. At low frequencies, the compensator integrates the error signal, leading to large 
low-frequency loop gain and accurate regulation of the low-frequency components of the output voltage. 
At high frequency (in the vicinity of the crossover frequency), the compensator introduces phase lead 
into the loop gain, improving the phase margin. Such a compensator is sometimes called a PID control-
ler. 
40 dB 
II Cell 
20dB 
OdB 
-20dB 
90' 
-40dB 
0' 
-90' 
-180' 
f 
Fig. 9.21 
Magnitude and phase asymptotes ofthe combined (PID) compensator transfer function Gc ofEq. (9.43). 

354 
Controller Design 
A typical Bode diagram of a practical version of this compensator is illustrated in Fig. 9 .21. The 
compensator has transfer function 
(9.43) 
The inverted zero at frequency JL functions in the same manner as the PI compensator. The zero at fre-
quency fz adds phase lead in the vicinity of the crossover frequency, as in the PD compensator. The high-
frequency poles at frequenciesfP 1 and.t;,2 must be present in practical compensators, to cause the gain to 
roll off at high frequencies and to prevent the switching ripple from disrupting the operation of the pulse-
width modulator. The loop gain crossover frequency fc is chosen to be greater thanfL andfz, but less than 
.t;,l andfp2' 
9.5.4 
Design Example 
To illustrate the design of PI and PD compensators, let us consider the design of a combined PID com-
pensator for the de-de buck converter system of Fig. 9.22. The input voltage vgCt) for this system has 
nominal value 28 V. It is desired to supply a regulated 15 V to a 5 A load. The load is modeled here with 
a 3 Q resistor. An accurate 5 V reference is available. 
The first step is to select the feedback gain H(s). The gain His chosen such that the regulator 
produces a regulated 15 V de output. Let us assume that we will succeed in designing a good feedback 
system, which causes the output voltage to accurately follow the reference voltage. This is accomplished 
via a large loop gain T, which leads to a small error voltage: ve"' 0. Hence, Hv"' vref So we should choose 
H- V,,t - _2__ -1 
- v - 15-3 
The quiescent duty cycle is given by the steady-state solution of the converter: 
Transistor 
gate driver 
Fig. 9.22 
Design example. 
L 
50~-tH 
!,=100kHz 
v(t) 
R 
3Q 
Sensor 
gain 
L---,----l 
(9.44) 

Compensator 
H(s) v(s) 
H-l 
-3 
d(s) 
Fig. 9.23 
System small-signal ac model, design example. 
D- .X_ -li- 0 536 
- V8 - 2s- · 
9.5 
Regulator Design 
355 
+ 
v(s) 
R 
(9.45) 
The quiescent value of the control voltage, Vc, must satisfy Eq. (7 .173). Hence, 
(9.46) 
Thus, the quiescent conditions of the system are known. It remains to design the compensator gain Gc(s). 
A small-signal ac model ofthe regulator system is illustrated in Fig. 9.23. The buck converter ac 
model is represented in canonical form. Disturbances in the input voltage and in the load current are 
modeled. For generality, reference voltage variations vrefare included in the diagram; in a de voltage reg-
ulator, these variations are normally zero. 
The open-loop converter transfer functions are discussed in the previous chapters. The open-
loop control-to-output transfer function is 
(9.47) 
The open-loop control-to-output transfer function contains two poles, and can be written in the following 
normalized form: 

356 
Controller Design 
60dBV 
II Gvd II 
40dBV 
20dBV 
LGvd 
OdBV r-----~------------------~ 
10-I/ZQo fo =900Hz 
o· 
-20dBV 
-90' 
-40 dBV 
----------------------------------------------------------
10 I/2Qo fo = 1.1 kHz 
-270' 
I Hz 
10Hz 
100Hz 
I kHz 
lOkHz 
100kHz 
f 
Fig. 9.24 
Converter small-signal control-to-output transfer function Gvd• design example. 
(9.48) 
By equating like coefficients in Eqs. (9.47) and (9.48), one finds that the de gain, comer frequency, and 
Q-factor are given by 
Gdo=~=28 V 
fr_Wo_ 
1-1kHz 
0 - 2n - 2n.fLE -
(9.49) 
Qo = 
R If= 9.5 => 19.5 dB 
In practice, parasitic loss elements, such as the capacitor equivalent series resistance (esr), would cause a 
lower Q-factor to be observed. Figure 9.24 contains a Bode diagram of Gvis). 
The open-loop line-to-output transfer function is 
(9.50) 
This transfer function contains the same poles as in Gvis), and can be written in the normalized form 
(9.51) 
with Ggo =D. The open-loop output impedance of the buck converter is 
(9.52) 

9.5 Regulator Design 
357 
1 (s) Load current 
load 
variation 
~--------------------------------------- ---------
vgCs) I 
ac line 
variation 
v(s) 
Converter power stage 
Fig. 9.25 
System block diagram, design example. 
Use of these equations to represent the converter in block-diagram form leads to the complete system 
block diagram of Fig. 9.25. The loop gain of the system is 
(9.53) 
Substitution of Eq. (9.48) into (9.53) leads to 
T(s) = G/s)H(s) V 
1 
VM 
D (l + _s + (Llz) 
QoC.Oo 
C.Oo 
(9.54) 
40dB 
II Tu II 
20 dB 
Tuo 
2.33 =} 7.4 dB 
OdB 
......................................................... . 
-20dB 
[ 
-40dB 
10-2Q fo =900Hz 
0' 
-90' 
................................................................................. P:..,--------t -180' 
[ 
102Q fo = 1.1 kHz 
+-------t-----+------1-------+------J. -270' 
1Hz 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
f 
Fig. 9.26 
Uncompensated loop gain Tu, design example. 

358 
Controller Design 
40dB 
II Gcll 
fc 
II Gcll 
20dB 
OdB .......................................................................... fz ......... =m; ........................... . 
-20 dB 
90° 
-90' 
-180' 
I Hz 
lOHz 
lOOHz 
I kHz 
lOkHz 
100kHz 
f 
Fig. 9.27 
PD compensator transfer function G," design example. 
The closed-loop disturbance-to-output transfer functions are given by Eqs. (9.5) and (9.6). 
The uncompensated loop gain T"(s), with unity compensator gain, is sketched in Fig. 9.26. With 
Gc(s) = 1, Eq. (9.54) can be written 
where the de gain is 
Tuo = /!l = 2.33 => 7.4 dB 
M 
(9.55) 
(9.56) 
The uncompensated loop gain has a crossover frequency of approximately 1.8 kHz, with a phase margin 
of less than five degrees. 
Let us design a compensator, to attain a crossover frequency of fc = 5 kHz, or one twentieth of 
the switching frequency. From Fig. 9.26, the uncompensated loop gain has a magnitude at 5 kHz of 
approximately Tuo ifolfY = 0.093 => -20.6 dB. So to obtain unity loop gain at 5 kHz, our compensator 
should have a 5 kHz gain of +20.6 dB. In addition, the compensator should improve the phase margin, 
since the phase of the uncompensated loop gain is nearly -180° at 5 kHz. So a lead (PD) compensator is 
needed. Let us (somewhat arbitrarily) choose to design for a phase margin of 52°. According to Fig. 9.13, 
this choice leads to closed-loop poles having a Q-factor of 1. The unit step response, Fig. 9.14, then 
exhibits a peak overshoot of 16%. Evaluation of Eq. (9.36), with.fc =5kHz and 8 = 52°, leads to the fol-
lowing compensator pole and zero frequencies: 
fz =(5kHz) 
JP =(5kHz) 
1 -sin (52°) = 1.7 kHz 
1 +sin (52°) 
1 +sin (52o) = 14 5 kH 
1 -sin (52°) 
· 
z 
(9.57) 
To obtain a compensator gain of 20.6 dB=> 10.7 at 5kHz, the low-frequency compensator gain must be 

9.5 Regulator Design 
359 
40dB 
L.T 
II Til 
II T II 
T0 = 8.6 => 18.7 dB 
20 dB r-------------..£..---1~-'-
OdB 
········································· ······················· 
-20dB 
0' 
~OdB }-----~-----==~--
o· 
L.T 
170Hz 
-90' 
-180' 
+------+-------t-------.........,f--------+--------+ -270' 
I Hz 
lOHz 
lOOHz 
I kHz 
10kHz 
100kHz 
f 
Fig. 9.28 
The compensated loop gain ofEq. (9.59). 
G = (1£)
2 _l_ fT = 3 7 => 11 3 dB 
dl 
fo 
Tuo V fp 
. 
. 
(9.58) 
A Bode diagram of the PD compensator magnitude and phase is sketched in Fig. 9.27. 
With this PD controller, the loop gain becomes 
( 1 + ~,) 
(9.59) 
The compensated loop gain is sketched in Fig. 9.28. It can be seen that the phase of T(s) is approximately 
equal to 52' over the frequency range of 1.4 kHz to 17 kHz. Hence variations in component values, 
which cause the crossover frequency to deviate somewhat from 5 kHz, should have little impact on the 
phase margin. In addition, it can be seen from Fig. 9.28 that the loop gain has a de magnitude of T,,0Gco 
==} 18.7 dB. 
Asymptotes of the quantity 11( 1 + D are constructed in Fig. 9.29. This quantity has a de asymp-
tote of -18.7 dB. Therefore, at frequencies less than 1kHz, the feedback loop attenuates output voltage 
disturbances by 18.7 dB. For example, suppose that the input voltage vgCt) contains a 100Hz variation of 
amplitude 1 V. With no feedback loop, this disturbance would propagate to the output according to the 
open-loop transfer function GvgCs), given in Eq. (9.51). At 100Hz, this transfer function has a gain essen-
tially equal to the de asymptote D = 0.536. Therefore, with no feedback loop, a 100 Hz variation of 
amplitude 0.536 V would be observed at the output. In the presence of feedback, the closed-loop line-to-
output transfer function of Eq. (9.5) is obtained; for our example, this attenuates the 100Hz variation by 
an additional factor of 18.7 dB==} 8.6. The 100Hz output voltage variation now has magnitude 0.536/8.6 
= 0.062 V. 
The low-frequency regulation can be further improved by addition of an inverted zero, as dis-
cussed in Section 9.5.2. A PID controller, as in Section 9.5.3, is then obtained. The compensator transfer 

360 
Controller Design 
I Hz 
10Hz 
100Hz 
I kHz 
10kHz 
IOO kHz 
f 
Fig. 9.29 
Construction of 1111(1 + 7) II for the PD-compensated design example of Fig. 9.28. 
function becomes 
(9.60) 
The Bode diagram of this compensator gain is illustrated in Fig. 9.30. The pole and zero frequenciesf: 
andfP are unchanged, and are given by Eq. (9.57). The midband gain Gem is chosen to be the same as the 
previous Gco• Eq. (9.58). Hence, for frequencies greater than fv the magnitude of the loop gain is 
40 dB 
II Gcll 
20dB 
OdB 
.... fz ................................................. . 
-20dB 
90° 
-40dB 
fp/10 
L. G c 
- 90° 
90° /decade 
+--"----';;.::...-=:p"""~fz 110 
fL/10 
00 
-90° 
-180° 
I Hz 
10Hz 
100Hz 
I kHz 
10kHz 
100kHz 
f 
Fig. 9.30 
PID compensator transfer function, Eq. (9.60). 

9.5 Regulator Design 
361 
60dB 
40dB 
20dB 
OdB 
-20dB 
-40dB 
-60dB 
~OdB~------~--------~--------r--------+------~ 
1Hz 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
f 
Fig. 9.31 Construction of II T II and 1111(1 + 7) II with the P/D-compensator of Fig. 9.30. 
unchanged by the inverted zero. The loop continues to exhibit a crossover frequency of 5 kHz. 
So that the inverted zero does not significantly degrade the phase margin, let us (somewhat arbi-
trarily) choose A to be one-tenth of the crossover frequency, or 500 Hz. The inverted zero will then 
increase the loop gain at frequencies below 500Hz, improving the low-frequency regulation of the out-
put voltage. The loop gain of Fig. 9.31 is obtained. The magnitude of the quantity 11(1 + D is also con-
structed. It can be seen that the inverted zero at 500Hz causes the magnitude of 11(1 + T) at 100Hz to be 
reduced by a factor of approximately (100 Hz)/(500 Hz) = 115. The total attenuation of 11(1 + D at 
100Hz is -32.7dB. A 1 V, 100Hz variation in vgCt) would now induce a 12 mV variation in v(t). Further 
improvements could be obtained by increasing A; however, this would require redesign of the PD portion 
of the compensator to maintain an adequate phase margin. 
The line-to-output transfer function is constructed in Fig. 9.32. Both the open-loop transfer 
function GvgCs), Eq. (9.51), and the closed-loop transfer function GvgCs)/(1 + T(s)), are constructed using 
the algebra-on-the-graph method. The two transfer functions coincide at frequencies greater than the 
crossover frequency. At frequencies less than the crossover frequency fc, the closed-loop transfer func-
tion is reduced by a factor of T(s). It can be seen that the poles of GvgCs) are cancelled by zeroes of 
11(1 + n. Hence the closed-loop line-to-output transfer function is approximately 
G.g(s) 
D 
1 
(1 +T(s))- TuoGcm (1 + ~L)(1 + ~,)(1 + ~J 
(9.61) 
So the algebra-on-the-graph method allows simple approximate disturbance-to-output closed-loop trans-
fer functions to be written. Armed with such an analytical expression, the system designer can easily 
compute the output disturbances, and can gain the insight required to shape the loop gain T(s) such that 
system specifications are met. Computer simulations can then be used to judge whether the specifications 
are met under all operating conditions, and over expected ranges of component parameter values. Results 
of computer simulations of the design example described in this section can be found in Appendix B, 
Section B.2.2. 

362 
Controller Design 
II :g II 
20dB 
OdB 
-20dB 
Open-loop II Gv8 II 
-40dB 
-60dB 
-80dB 
Closed-loop Ill ~vgT I 
-100dB 
1Hz 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
f 
Fig. 9.32 Comparison of open-loop line-to-output transfer function Gvg and closed-loop line-to-output transfer 
function ofEq. (9.61). 
9.6 
MEASUREMENT OF LOOP GAINS 
It is good engineering practice to measure the loop gains of prototype feedback systems. The objective of 
such an exercise is to verify that the system has been correctly modeled. If so, then provided that a good 
controller design has been implemented, then the system behavior will meet expectations regarding tran-
sient overshoot (and phase margin), rejection of disturbances, de output voltage regulation, etc. Unfortu-
nately, there are reasons why practical system prototypes are likely to differ from theoretical models. 
Phenomena may occur that were not accounted for in the original model, and that significantly influence 
the system behavior. Noise and electromagnetic interference (EMI) can be present, which cause the sys-
tem transfer functions to deviate in unexpected ways. 
So let us consider the measurement of the loop gain T(s) of the feedback system of Fig. 9.33. 
Block 1 
v.(s) 
A 
I 
+ 
I 
I 
I 
I 
I 
i vxCs) 
I 
I 
I 
I 
I 
I 
I 
-
Block2 
t ............................... .: 
Fig. 9.33 It is desired to determine the loop gain T(s) experimentally, by making measurements at point A. 

9.6 Measurement of Loop Gains 
363 
Block 1 
Block 2 
de bias 
+ 
t .•..•.•.•..•.•.•.•....•...•...••..•......•.•..•....•...•. .l 
Fig. 9.34 Measurement of loop gain by breaking the loop. 
We will make measurements at some point A, where two blocks of the network are connected electri-
cally. In Fig. 9.33, the output port of block 1 is represented by a Thevenin-equivalent network, composed 
of the dependent voltage source G 10 e and output impedance Z1. Block 1 is loaded by the input impedance 
Z2 of block 2. The remainder of the feedback system is represented by a block diagram as shown. The 
loop gain of the system is 
(9.62) 
Measurement of this loop gain presents several challenges not present in other frequency response mea-
surements. 
In principle, one could break the loop at point A, and attempt to measure T(s) using the transfer 
function measurement method of the previous chapter. As illustrated in Fig. 9.34, a de supply voltage 
V cc and potentiometer would be used, to establish a de bias in the voltage v x' such that all of the elements 
of the network operate at the correct quiescent point. Ac voltage variations in vz(t) are coupled into the 
injection point via a de blocking capacitor. Any other independent ac inputs to the system are disabled. A 
network analyzer is used to measure the relative magnitudes and phases of the ac components of the volt-
ages vyCt) and vx(t): 
(9.63) 
The measured gain Tm(s) differs from the actual gain T(s) because, by breaking the connection 
between blocks 1 and 2 at the measurement point, we have removed the loading of block 2 on block 1. 
Solution of Fig. 9.34 for the measured gain T m(s) leads to 
Equations (9.62) and (9.64) can be combined to express Tm(s) in terms of T(s): 
Tm(s) = T(s) (1 + 21(s)) 
Z2(s) 
(9.64) 
(9.65) 

364 
Controller Design 
Hence, 
(9.66) 
So to obtain an accurate measurement, we need to find an injection point where loading is negligible over 
the range of frequencies to be measured. 
Other difficulties are encountered when using the method of Fig. 9.34. The most serious prob-
lem is adjustment of the de bias using a potentiometer. The de loop gain is typically very large, especially 
when a PI controller is used. A small change in the de component of v)t) can therefore lead to very large 
changes in the de biases of some elements in the system. So it is difficult to establish the correct de con-
ditions in the circuit. The de gains may drift during the experiment, making the problem even worse, and 
saturation of the error amplifier is a common complaint. Also, we have seen that the gains of the con-
verter can be a function of the quiescent operating point; significant deviation from the correct operating 
point can cause the measured gain to differ from the loop gain of actual operating conditions. 
9.6.1 
Voltage Injection 
An approach that avoids the de biasing problem [3] is illustrated in Fig. 9.35. The voltage source vit) is 
injected between blocks 1 and 2, without breaking the feedback loop. Ac variations in vit) again excite 
variations in the. feedback system, but de bias conditions are determined by the circuit. Indeed, if vit) 
contains no de component, then the biasing circuits of the system itself establish the quiescent operating 
point. Hence, the loop gain measurement is made at the actual system operating point. 
The injection source is modeled in Fig. 9.35 by a Thevenin equivalent network, containing an 
independent voltage source with source impedance Zs(s). The magnitudes of vz and Zs are irrelevant in 
the determination of the loop gain. However, the injection of vz does disrupt the loading of block 2 on 
block 1. Hence, a suitable injection point must be found, where the loading effect is negligible. 
To measure the loop gain by voltage injection, we connect a network analyzer to measure the 
transfer function from vx to vy' The system independent ac inputs are set to zero, and the network ana-
lyzer sweeps the injection voltage i'/t) over the intended frequency range. The measured gain is 
(9.67) 
Fig. 9.35 Measurement of loop gain by voltage injection. 

9.6 Measurement of Loop Gains 
365 
Let us solve Fig. 9.35, to compare the measured gain TJs) with the actual loop gain T(s) given by (9.62). 
The error signal is 
v _(s) =- H(s)G2(s)v xCs) 
(9.68) 
The voltage vy can be written 
(9.69) 
where l(s)Z1(s) is the voltage drop across the source impedance Z1• Substitution of Eq. (9.68) into (9.69) 
leads to 
(9.70) 
But l(s) is 
·c ) v xCs) 
l s =--
Zz(S) 
(9.71) 
Therefore, Eq. (9.70) becomes 
(9.72) 
Substitution of Eq. (9.72) into (9.67) leads to the following expression for the measured gain TJs): 
(9.73) 
Equations (9.62) and (9.73) can be combined to determine the measured gain Tv(s) in terms of the actual 
loop gain T(s): 
T (s) = T(s) (1 + Zt(s)) + Zt(s) 
v 
Z2(s) 
Z2(s) 
(9.74) 
Thus, TJs) can be expressed as the sum of two terms. The first term is proportional to the actual loop 
gain T(s), and is approximately equal to T(s) whenever II Z1 II < II Z2 11. The second term is not propor-
tional to T(s), and limits the minimum T(s) that can be measured with the voltage injection technique. If 
Z/Z2 is much smaller in magnitude than T(s), then the second term can be ignored, and TJs)"' T(s). At 
frequencies where T(s) is smaller in magnitude than Z1/Z2, the measured data must be discarded. Thus, 
T/s) "'T(s) 
(9.75) 
provided 
and 

366 
Controller Design 
Block 1 
Block2 
····················------------········ 
Fig. 9.36 Voltage injection example. 
I+ 
+ 
v)s) 
500.Q 
+ 
·······················-------········ 
(ii) ~ T(s) II~ ~ ~~~~~ ~ 
Again, note that the value of the injection source impedance Zs is irrelevant. 
As an example, consider voltage injection at the output of an operational amplifier, having a 
50 .Q output impedance, which drives a 500 .Q effective load. The system in the ¥icinity of the injection 
point is illustrated in Fig. 9.36. So Z1(s) =50 .Q and Z2(s) = 500 .Q. The ratio Z/Zz is 0.1, or -20 dB. Let 
us further suppose that the actual loop gain T(s) contains poles at 10Hz and 100kHz, with a de gain of 
80 dB. The actual loop gain magnitude is illustrated in Fig. 9.37. 
Voltage injection would result in measurement of Tv(s) given in Eq. (9.74). Note that 
( 
Z1(s)) 
1 + Zz(s) = 1.1 => 0.83 dB 
(9.76) 
Hence, for large II T II, the measured II Tv II deviates from the actual loop gain by less than 1 dB. However, 
at high frequency where II T II is less than -20 dB, the measured gain differs significantly. Apparently, 
100dB 
80dB 
60dB 
40dB 
20dB 
OdB 
.............. 11 ~~ 11~-20dB ...................................................... . 
-20dB r-----~~----~------------------------~~---
~OdB,_------~~-------r--------+--------+~~--~~ 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
1MHz 
f 
Fig. 9.37 Comparison of measured loop gain Tv and actual loop gain T, voltage injection example. The measured 
gain deviates at high frequency. 

9.6 Measurement of Loop Gains 
367 
TJs) contains two high-frequency zeroes that are not present in T(s). Depending on the Q-factor of these 
zeroes, the phase of Tv at the crossover frequency could be influenced. To ensure that the phase margin is 
correctly measured, it is important that Z1/Z2 be sufficiently small in magnitude. 
9.6.2 
Current Injection 
The results of the preceding paragraphs can also be obtained in dual form, where the loop gain is mea-
sured by current injection [3]. As illustrated in Fig. 9.38, we can model block 1 and the analyzer injection 
source by their Norton equivalents, and use current probes to measure ix and iy. The gain measured by 
current injection is 
(9.77) 
It can be shown that 
(9.78) 
Hence, 
T;(s) ~ T(s) provided 
(i) II Z2(s) II« II Z 1(s) II· and 
(9.79) 
(ii) II T(s) II ~ II ~~i~~ II 
So to obtain an accurate measurement of the loop gain by current injection, we must find a point in the 
network where block 2 has sufficiently small input impedance. Again, note that the injection source 
impedance Zs does not affect the measurement. In fact, we can realize iz by use of a Thevenin-equivalent 
source, as illustrated in Fig. 9.39. The network analyzer injection source is represented by voltage source 
Fig. 9.38 Measurement of loop gain by current injection. 

368 
Controller Design 
Fig. 9.39 Current injection using Thevenin-equivalent source. 
..... £""')f-s)----}~~z-(-s)--tx .... ~-s) ..... 
cb 
02 and output resistance R,. A series capacitor, Cb, is inserted to avoid disrupting the de bias at the injec-
tion point. 
9.6.3 
Measurement of Unstable Systems 
When the prototype feedback system is unstable, we are even more eager to measure the loop gain-to 
find out what went wrong. But measurements cannot be made while the system oscillates. We need to 
stabilize the system, yet measure the original unstable loop gain. It is possible to do this by recognizing 
that the injection source impedance Zs does not influence the measured loop gain [3]. As illustrated in 
Fig. 9.40, we can even add additional resistance Rext' effectively increasing the source impedance Zs. The 
measured loop gain TJs) is unaffected. 
Adding series impedance generally lowers the loop gain of a system, leading to a lower cross-
over frequency and a more positive phase margin. Hence, it is usually possible to add a resistor Rext that 
is sufficiently large to stabilize the system. The gain Tv(s), Eq. (9.67), continues to be approximately 
equal to the original unstable loop gain, according to Eq. (9.75). To avoid disturbing the de bias condi-
tions, it may be necessary to bypass Rext with inductor Lexr If the inductance value is sufficiently large, 
then it will not influence the stability of the modified system. 
Block 1 
+ 
Block2 
Fig. 9.40 Measurement of an unstable loop gain by voltage injection. 

9. 7 Summary of Key Points 
369 
9.7 
SUMMARY OF KEY POINTS 
1. 
Negative feedback causes the system output to closely follow the reference input, according to the gain 
l!H(s). The influence on the output ofdisturbances and variation of gains in the forward path is reduced. 
2. 
The loop gain T(s) is equal to the products of the gains in the forward and feedback paths. The loop gain is 
a measure of how well the feedback system works: a large loop gain leads to better regulation of the out-
put. The crossover frequency fc is the frequency at which the loop gain T has unity magnitude, and is a 
measure of the bandwidth of the control system. 
3. 
The introduction of feedback causes the transfer functions from disturbances to the output to be multiplied 
by the factor 11(1 + T(s)). At frequencies where Tis large in magnitude (i.e., below the crossover fre-
quency), this factor is approximately equal to l!T(s). Hence, the influence of low-frequency disturbances 
on the output is reduced by a factor of l!T(s). At frequencies where Tis small in magnitude (i.e., above the 
crossover frequency), the factor is approximately equal to 1. The feedback loop then has no effect. Closed-
loop disturbance-to-output transfer functions, such as the line-to-output transfer function or the output 
impedance, can easily be constructed using the algebra-on-the-graph method. 
4. 
Stability can be assessed using the phase margin test. The phase of T is evaluated at the crossover fre-
quency, and the stability of the important closed-loop quantities T/(1 + T) and l/(1 +Dis then deduced. 
Inadequate phase margin leads to ringing and overshoot in the system transient response, and peaking in 
the closed-loop transfer functions. 
5. 
Compensators are added in the forward paths of feedback loops to shape the loop gain, such that desired 
performance is obtained. Lead compensators, or PD controllers, are added to improve the phase margin 
and extend the control system bandwidth. PI controllers are used to increase the low-frequency loop gain, 
to improve the rejection of low-frequency disturbances and reduce the steady-state error. 
6. 
Loop gains can be experimentally measured by use of voltage or current injection. This approach avoids 
the problem of establishing the correct quiescent operating conditions in the system, a common difficulty 
in systems having a large de loop gain. An injection point must be found where interstage loading is not 
significant. Unstable loop gains can also be measured. 
REFERENCES 
[1] 
B. Kuo, Automatic Control Systems, New York: Prentice-Hall, Inc. 
[2] 
J. D' Azzo and C. HOUPIS, Linear Control System Analysis and Design: Conventional and Modern, New 
York: McGraw-Hill, 1995. 
[3] 
R. D. MIDDLEBROOK, "Measurement of Loop Gain in Feedback Systems," International Journal of Elec-
tronics, Vol. 38, No.4, pp. 485-512, 1975. 
[4] 
R. D. MIDDLEBROOK, "Design-Oriented Analysis of Feedback Amplifiers," Proceedings National Elec-
tronics Conference, Vol. XX, October 1964, pp. 234-238. 
PROBLEMS 
9.1 
Derive both forms ofEq. (9.25). 
9.2 
The flyback converter system of Fig. 9.41 contains a feedback loop for regulation of the main output 
voltage v1. An auxiliary output produces voltage v2• The de input voltage v8 lies in the range 280 V ~ v8 ~ 
380 V. The compensator network has transfer function 

370 
Controller Design 
where Gcoo = 0.05, andf1 = C.0/21t =400Hz. 
(a) 
What is the steady-state value of the error voltage v .(t)? Explain your reasoning. 
(b) 
Determine the steady-state value of the main output voltage v1• 
(c) 
Estimate the steady-state value of the auxiliary output voltage v2• 
Fig. 
9.41 
Flyback 
converter 
system 
of 
Problem 9.2. 
+ 
Isolated 
transistor 
gate driver 
H(s) = 0.2 
Reference 
input 
v,f= 3 V 
9.3 
In the boost converter system of Fig. 9.42, all elements are ideal. The compensator has gain 
Gc(s) = 250/s. 
Fig. 9.42 Boost converter 
system of Problem 9.3. 
Boost converter 
;·········································-·······················-~ 
. 
. 
. 
L 
. 
~ 
~ 
....---;-----' 
Compensator 
v 
Reference 
ref 
input 
5 V 
(a) 
Construct the Bode plot of the loop gain T(s) magnitude and phase. Label values of all comer 
frequencies and Q-factors, as appropriate. 
(b) 
Determine the crossover frequency and phase margin. 

Problems 
371 
(c) 
Construct the Bode diagram of the magnitude of 11(1 + 7), using the algebra-on-the-graph 
method. Label values of all corner frequencies and Q-factors, as appropriate. 
(d) 
Construct the Bode diagram of the magnitude of the closed-loop line-to-output transferfunction. 
Label values of all corner frequencies and Q-factors, as appropriate. 
9.4 
A certain inverter system has the following loop gain 
(1+-L) 
T(s) = T0 
w, 
( 1 + ~I)( 1 + ~2 )( 1 + ~3) 
and the following open-loop line-to-output transfer function 
where 
T0 = 100 
w2 = 1000 rad/sec 
w, = 4000 rad/ sec 
ffi 1 = 500 radlsec 
W 3 = 24000 rad/sec 
ego= o.5 
The gain of the feedback connection is H(s) = 0.1. 
(a) 
Sketch the magnitude and phase asymptotes of the loop gain T(s). Determine numerical values 
of the crossover frequency in Hz and phase margin in degrees. 
(b) 
Construct the magnitude asymptotes of the closed-loop line-to-output transfer function. Label 
important features. 
(c) 
Construct the magnitude asymptotes ofthe closed-loop transfer function from the reference volt-
age to the output voltage. Label important features. 
9.5 
The forward converter system of Fig. 9.43(a) is constructed with the element values shown. The quies-
cent value of the input voltage is Vg = 380 V. The transformer has turns ratio n/n3 = 4.5. The duty cycle 
produced by the pulse-width modulator is restricted to the range 0 s d(t) s 0.5. Within this range, d(t) 
follows the control voltage vc<t) according to 
with VM=3 V. 
d(t) = 1 vJt) 
2 VM 
(a) 
Determine the quiescent values of: the duty cycleD, the output voltage V, and the control voltage 
vc. 
(b) 
The op-amp circuit and feedback connection can be modeled using the block diagram illustrated 
in Fig. 9.43(b), with H(s) = R/(R1 + R2). Determine the transfer functions Gc(s) and G/s). 
(c) 
Sketch a block diagram which models the small-signal ac variations of the complete system, and 
determine the transfer function of each block. Hint: the transformer magnetizing inductance has 
negligible influence on the converter dynamics, and can be ignored. The small-signal models of 
the forward and buck converters are similar. 
(d) 
Construct a Bode plot of the loop gain magnitude and phase. What is the crossover frequency? 
What is the phase margin? 
(e) 
Construct the Bode plot of the closed-loop line-to-output transfer function magnitude 

372 
Controller Design 
(a) 
(b) 
Isolated 
transistor 
gate driver 
nl : nt : n3 
L 
rn:v 
!, =!50 kHz 
R3 
H(s) 
GJs) 
+ 
R 
v(t) 
7Q 
":" 
Rt 
81.8kQ 
R2 
18.2 kQ 
Fig. 9.43 
Forward converter system of Problem 9.5: (a) system diagram, (b) modeling the op amp cir-
cuit using a block diagram. 
Label important features. What is the gain at 120 Hz? At what frequency do disturbances in v g have the 
greatest influence on the output voltage? 
9.6 
In the voltage regulator system of Fig. 9.43, described in Problem 9.5, the input voltage vgCt) contains a 
120Hz variation of peak amplitude 10 V. 
(a) 
What is the amplitude of the resulting 120 Hz variation in v(t)? 
(b) 
Modify the compensator network such that the 120 Hz output voltage variation has peak ampli-
tude less than 25 mV. Your modification should leave the de output voltage unchanged, and 
should result in a crossover frequency no greater than 10 kHz. 
9.7 
Design of a boost converter with current feedback and a PI compensator. In some applications, it is 
desired to control the converter input terminal current waveform. The boost converter system of Fig. 
9.44 contains a feedback loop which causes the converter input current igCt) to be proportional to a refer-
ence voltage v,ejt). The feedback connection is a current sense circuit having gain H(s) = 0.2 volts per 
ampere. A conventional pulse width modulator circuit (Fig. 7.63) is employed, having a sawtooth wave-

Problems 
373 
Reference 
input 
vref 
Fig. 9.44 Boost converter system with current feedback, Problem 9.7. 
form with peak-peak amplitude of V M = 3 V. The quiescent values of the inputs are: V8 = 120 V, 
Vref = 2 V. All elements are ideal. 
(a) 
Determine the quiescent values D, V, and /8• 
(b) 
Determine the small-signal transfer function 
(c) 
Sketch the magnitude and phase asymptotes of the uncompensated (Gc(s) = 1) loop gain. 
(d) 
It is desired to obtain a loop gain magnitude of at least 35 dB at 120 Hz, while maintaining a 
phase margin of at least 72'. The crossover frequency should be no greater thanh/10 = 10kHz. 
Design a PI compensator that accomplishes this. Sketch the magnitude and phase asymptotes of 
the resulting loop gain, and label important features. 
(e) 
For your design of part (d), sketch the magnitude of the closed-loop transfer function 
Label important features. 
9.8 
Design of a buck regulator to meet closed-loop output impedance specifications. The buck converter 
with control system illustrated inFig. 9.45 is to be designed to meet the following specifications. The 
closed-loop output impedance should be less than 0.2 Q over the entire frequency range 0 to 20kHz. To 
ensure that the transient response is well-behaved, the poles of the closed-loop transfer functions, in the 
vicinity of the crossover frequency, should have Q-factors no greater than unity. The quiescent load cur-
rent I LOAD can vary from 5 A to 50 A, and the above specifications must be met for every value of I LOAD 
in this range. For simplicity, you may assume that the input voltage vg does not vary. The loop gain 
crossover frequency fc may be chosen to be no greater thanf,/10, or 10kHz. You may also assume that 
all elements are ideal. The pulse-width modulator circuit obeys Eq. (7.173). 
(a) 
What is the intended de output voltage V? Over what range does the effective load resistance 
RLOAD vary? 

374 
Controller Design 
Transistor 
gate driver 
L 
!, =100kHz 
Fig. 9.45 
Buck regulator system, Problem 9.8. 
+ 
iload 
Hv 
(b) 
Construct the magnitude asymptotes of the open-loop output impedance Z0u1(s). Over what 
range of frequencies is the output impedance specification not met? Hence, deduce how large the 
minimum loop gain T(s) must be in magnitude, such that the closed-loop output impedance 
meets the specification. Choose a suitable crossover frequency fc. 
(c) 
Design a compensator network Gc(s) such that all specifications are met. Additionally, the de 
loop gain T(s) should be at least 20 dB. Specify the following: 
(i) 
Your choice for the transfer function GJs) 
(ii) 
The worst-case closed-loop Q 
(iii) Bode plots of the loop gain T(s) and the closed-loop output impedance, for load cur-
rents of 5 A and 50 A. What effect does variation of RwAD have on the closed-loop 
behavior of your design? 
(d) 
Design a circuit using resistors, capacitors, and an op amp to realize your compensator transfer 
function Gc(s). 
9.9 
Design of a buck-boost voltage regulator. The buck-boost converter of Fig. 9.46 operates in the continu-
ous conduction mode, with the element values shown. The nominal input voltage is V8 = 48 V, and it is 
desired to regulate the output voltage at -15 V. Design the best compensator that you can, which has 
high crossover frequency (but no greater than 10% of the switching frequency), large loop gain over the 
bandwidth of the feedback loop, and phase margin of at least 52°. 
Fig. 
9.46 Buck-boost 
voltage regulator system, 
Problem 9.9. 
Transistor 
gate driver 
!, =200kHz 
+ 
v 
Hv 

Problems 
375 
(a) 
Specify the required value of H. Sketch Bode plots of the uncompensated loop gain magnitude 
and phase, as well as the magnitude and phase of your proposed compensator transfer function 
Gc(s). Label the important features of your plots. 
(b) 
Construct Bode diagrams of the magnitude and phase of your compensated loop gain T(s), and 
also of the magnitude of the quantities Tl( 1 + D and l/(1 + D. 
(c) 
Discuss your design. What prevents you from further increasing the crossover frequency? How 
large is the loop gain at 120Hz? Can you obtain more loop gain at 120Hz? 
9.10 
The loop gain of a certain feedback system is measured, using voltage injection at a point in the forward 
path of the loop as illustrated in Fig. 9.47(a). The data in Fig. 9.47(b) is obtained. What is T(s)? Specify 
T(s) in factored pole-zero form, and give numerical values for all important features. Over what range of 
frequencies does the measurement give valid results? 
(a) 
+ 
;········································ 
+ 
v,(s) 
10kQ 
2nF 
(b) 
60dB -
II T, II 
40dB 
20dB 
OdB 
-20dB 
-
__/\ 
\ 
~ 
"' 1/ 
-
v 
-
LT, 
90' -
0' 
-90' 
( 
- \ 
) 
\~ 
v 
-ISO' -
lOOHz 
I kHz 
lOkHz 
100kHz 
IMHz 
f 
Fig. 9.47 
Experimental measurement of loop gain, Problem 9.10: (a) measurement via voltage injec-
tion, (b) measured data. 

10 
Input Filter Design 
10.1 
INTRODUCTION 
10.1.1 
Conducted EMI 
It is nearly always required that a filter be added at the power input of a switching converter. By attenuat-
ing the switching harmonics that are present in the converter input current waveform, the input filter 
allows compliance with regulations that limit conducted electromagnetic interference (EMI). The input 
filter can also protect the converter and its load from transients that appear in the input voltage vgCt). 
thereby improving the system reliability. 
A simple buck converter example is illustrated in Fig. 10.1. The converter injects the pulsating 
current igCt) of Fig. lO.l(b) into the power source vg(t). The Fourier series of ig(t) contains harmonics at 
multiples of the switching frequency fs, as follows: 
(a) 
(b) 
L 
ig(t) 
+ 
2 
c 
v 
R 
0 
0 
0 
DTS 
T, 
Fig. 10.1 
Buck converter example: (a) circuit of power stage, (b) pulsating input current waveform. 

378 
Input Filter Design 
(b) 
Input filter 
: ..............•••............... J 
-
0 
0 
igCt) -
L 
+ 
2 
c 
v 
R 
-
i;n(t) 
0 
Fig. 10.2 
Addition of a simple L-C low-pass filter to the power input terminals of the buck converter: (a) circuit, 
(b) input current waveforms. 
(10.1) 
In practice, the magnitudes of the higher-order harmonics can also be significantly affected by the cur-
rent spike caused by diode reverse recovery, and also by the finite slopes of the switching transitions. The 
large high-frequency current harmonics of igCt) can interfere with television and radio reception, and can 
disrupt the operation of nearby electronic equipment. In consequence, regulations and standards exist 
that limit the amplitudes of the harmonic currents injected by a switching converter into its power source 
[1-8]. As an example, if the de inductor current i of Fig. 10.2 has a magnitude of several Amperes, then 
the fundamental component (n = 1) has an rms amplitude in the vicinity of one Ampere. Regulations may 
require attenuation of this current to a value typically in the range 10 p,A to 100 p,A. 
To meet limits on conducted EMI, it is necessary to add an input filter to the converter. Figure 
10.2 illustrates a simple single-section L-C low-pass filter, added to the input of the converter of Fig. 
10.1. This filter attenuates the current harmonics produced by the switching converter, and thereby 
smooths the current waveform drawn from the power source. If the filter has transfer function 
H(s) = i;,/ig, then the input current Fourier series becomes 
i;11(t) = H(O)DI + k~I ~ H(kjw) ~ 'f:t sin ( knD) cos ( kwt + LH(kjw)) 
(10.2) 
In other words, the amplitude of each current harmonic at angular frequency kro is attenuated by the filter 
transfer function at the harmonic frequency, II H(kjro) Jl. Typical requirements effectively limit the current 
harmonics to have amplitudes less than 100 p,A, and hence input filters are often required to attenuate the 
current amplitudes by 80 dB or more. 
To improve the reliability of the system, input filters are sometimes required to operate nor-
mally when transients or periodic disturbances are applied to the power input. Such conducted suscepti-
bility specifications force the designer to damp the input filter resonances, so that input disturbances do 
not excite excessive currents or voltages within the filter or converter. 

10.1 
Introduction 
379 
(a) 
Converter model 
r·----------------------------------------------------------------------------z:-----------------------1 
+ 
c 
R 
i_ _______________________________________________ t·=--------------------------------------------------J 
d 
(b) 
+ 
c 
R 
!_ ___________________________________ _! 
i_ _______________________________________________ t·=--------------------------------------------------J 
d 
Fig. 10.3 
Small-signal equivalent circuit models of the buck converter: (a) basic converter model, (b) with addition 
of input filter. 
10.1.2 
The Input Filter Design Problem 
The situation faced by the design engineer is typically as follows. A switching regulator has 
been designed, which meets performance specifications. The regulator was properly designed as dis-
cussed in Chapter 9, using a small-signal model of the converter power stage such as the equivalent cir-
cuit of Fig. 10.3(a). In consequence, the transient response is well damped and sufficiently fast, with 
adequate phase margin at all expected operating points. The output impedance is sufficiently small over a 
wide frequency range. The line-to-output transfer function GvgCs), or audiosusceptibility, is sufficiently 
small, so that the output voltage remains regulated in spite of variations in vgCt). 
Having developed a good design that meets the above goals regarding dynamic response, the 
problem of conducted EMI is then addressed. A low-pass filter having attenuation sufficient to meet con-
ducted EMI specifications is constructed and added to the converter input. A new problem then arises: 
the input filter changes the dynamics of the converter. The transient response is modified, and the control 
system may even become unstable. The output impedance may become large over some frequency range, 
possibly exhibiting resonances. The audiosusceptibility may be degraded. 
The problem is that the input filter affects the dynamics of the converter, often in a manner that 
degrades regulator performance. For example, when a single-section L-C input filter is added to a buck 
converter as in Fig. 10.2(a), the small-signal equivalent circuit model is modified as shown in Fig. 
10.3(b). The input filter elements affect all transfer functions of the converter, including the control-to-

380 
Input Filter Design 
Fig. 
10.4 Control-to-out-
put transfer functions pre-
dicted by 
the equivalent 
circuit models of Fig. 10.3. 
Dashed lines: without input 
filter [Fig. 10.3(a)]. Solid 
lines: with input filter [Fig. 
10.3(b)]. 
40dBV 
II Gvdll 
3o dBvr---1_1 a_.d_ll'""""'"· 
20dBV 
lOdBV 
L Gvd 
OdBVt---.....,..::;:, 
-------------------~ 
-lOdBV 
100Hz 
1kHz 
f 
o· 
'\\ ... 
~------------------ -180" 
-360" 
output transfer function G.is), the line-to-output transfer function Gv/s), and the converter output 
impedance Zout(s). Moreover, the influence of the input filter on these transfer functions can be quite 
severe. 
As ari illustration, let's examine how the control-to-output transfer function G.is) of the buck 
converter of Fig. 10.1 is altered when a simple L-C input filter is added as in Fig. 10.2. For this example, 
the element values are chosen to be: D = 0.5, L = 100 JlH, C = 100 JlF, R = 3 Q, L1= 330 JlH, C1= 470 JlF. 
Figure 10.4 contains the Bode plot of the magnitude and phase of the control-to-output transfer function 
Gvd(s). The dashed lines are the magnitude and phase before the input filter was added, generated by 
solution of the model of Fig. 10.3(a). The complex poles of the converter output filter cause the phase to 
approach- 180" at high frequency. Usually, this is the model used to design the regulator feedback loop 
and to evaluate the phase margin (see Chapter 9). The solid lines of Fig. 10.4 show the magnitude and 
phase after addition of the input filter, generated by solution of the model of Fig. 10 .3(b ). The magnitude 
exhibits a "glitch" at the resonant frequency of the input filter, and an additional- 360" of phase shift is 
introduced into the phase. It can be shown that G.is) now contains an additional complex pole pair and 
a complex right half-plane zero pair, associated with the input filter dynamics. If the crossover frequency 
of the regulator feedback loop is near to or greater than the resonant frequency of the input filter, then the 
loop phase margin will become negative and instability will result. Such behavior is typical; conse-
quently, input filters are notorious for destabilizing switching regulator systems. 
This chapter shows how to mitigate the stability problem, by introducing damping into the input 
filter and by designing the input filter such that its output impedance is sufficiently small [9-21]. The 
result of these measures is that the effect of the input filter on the control-to-output transfer function 
becomes negligible, and hence the converter dynamics are much better behaved. Although analysis of the 
fourth-order system of Fig. 10.3(b) is potentially quite complex, the approach used here simplifies the 
problem through use of impedance inequalities involving the converter input impedance and the filter 
output impedance [9 ,10]. These inequalities are based on Middlebrook's extra element theorem of 
Appendix C. This approach allows the engineer to gain the insight needed to effectively design the input 
filter. Optimization of the damping networks of input filters, and design of multiple-section filters, is also 
discussed. 

10.2 
Effect of an Input Filter on Converter Transfer Functions 
381 
---- H(s)---,.. 
Input 
filter 
Converter 
Fig. 10.5 Addition of an input filter to a switching voltage regulator system. 
10.2 
EFFECT OF AN INPUT FILTER ON CONVERTER TRANSFER FUNCTIONS 
The control-to-output transfer function Gvd(s) is defined as follows: 
G ( ) _ v(s) I 
d s -
A 
v 
d(s) v (s)-0 
g 
-
(10.3) 
The control-to-output transfer functions of basic CCM converters with no input filters are listed in Sec-
tion 8.2.2. 
Addition of an input filter to a switching regulator leads to the system illustrated in Fig. 10.5. To 
determine the cont~ol-to-output transfer function in the presence of the input filter, we set vgCs) to zero 
and solve for v(s)ld(s) according to Eq. (10.3). The input filter can then be represented simply by its out-
put impedance Z0(s) as illustrated in Fig. 10.6. Thus, the input filter can be treated as an extra element 
having impedance Z0(s). In Appendix C, Section C.4.3, Middlebrook's extra element theorem is 
employed to determine how addition of the input filter modifies the control-to~output transfer function. It 
is found that the modified control-to-output transfer function can be expressed as follows [9]: 
(10.4) 
Converter 
Fig. 10.6 Determination of the control-to-output transfer 
Z0 (s) 
function Gvis) for the system of Fig. 10.5. 

382 
Input Filter Design 
Table 10.1 
Input filter design criteria for basic converters 
Converter 
ZJs) 
Buck 
Boost 
Buck-boost 
where 
R ( 1 
+s-Jt + s 2Lc) 
D 2 
( 1 +sRC) 
Ze(s) 
sL 
Dz 
sL 
sL 
Dz 
(10.5) 
is the original control-to-output transfer function with no input filter. The quantity Zv(s) is equal to the 
converter input impedance Z;(s) under the condition that d(s) is equal to zero: 
(10.6) 
The quantity ZN(s) is equal to the converter input impedance Z;(s) under the condition that the feedback 
controller of Fig. 10.5 operates ideally; in other words, the controller varies d(s) as necessary to maintain 
v(s) equal to zero: 
ZN(s) = Z;(s) lv(s)-•0 
null 
(10.7) 
In terms of the canonical circuit model parameters described in Section 7.5, ZN(s) can be shown to be 
(10.8) 
Expressions for ZN(s) and Zv(s) for the basic buck, boost, and buck-boost converters are listed in Table 
10.1. 
10.2.1 
Discussion 
Equation (10.4) relates the power stage control-to-output transfer function Gvis) to the output imped-
ance Z0 (s) of the input filter, and also to the quantities ZN(s) and Zv(s) measured at the power input port 
of the converter. The quantity Zv(s) coincides with the open-loop input impedance of the converter. 
As described above, the quantity ZN(s) is equal to the input port impedance of the converter 

(a) 
(b) 
10.2 
Effect of an Input Filter on Converter Transfer Functions 
383 
Closed-loop 
(i/t)) T, 
r····~q!tf:l.f!.~ .. r.e.s.f!!f:l!f!! .... ] 
r---~---+-, 
r-~--+~' 
: ........................................... : 
Quiescent 
operating 
point 
v 
R 
Fig. 10.7 Power input port characteristics of an ideal switching voltage regulator: (a) equivalent circuit model, 
including dependent power sink, (b) constant power characteristic of input port. 
power stage, under the conditions that d(s) is varied as necessary to null v(s) to zero. This is, in fact, the 
function performed by an ideal controller: it varies the duty cycle as necessary to maintain zero error of 
the output voltage. Therefore, ZN(s) coincides with the impedance that would be measured at the con-
verter power input terminals, if an ideal feedback loop perfectly regulated the converter output voltage. 
Of course, Eq. (10.4) is valid in general, regardless of whether a control system is present. 
Figure 10.7 illustrates the large-signal behavior of a feedback loop that perfectly regulates the 
converter output voltage. Regardless of the applied input voltage vgCt), the output voltage is maintained 
equal to the desired value V. The load power is therefore constant, and equal to Ptoad = V 2/R. In the ideal-
ized case of a lossless converter, the power flowing into the converter input terminals will also be equal to 
Ptoad• regardless of the value of v gCt). Hence, the power input terminal of the converter obeys the equation 
(10.9) 
This characteristic is illustrated in Fig. 10.7(b), and is represented in Fig. 10.7(a) by the dependent power 
sink symbol. The properties of power sources and power sinks are discussed in detail in Chapter 11. 
Figure 10.7(b) also illustrates linearization of the constant input power characteristic, about a 
quiescent operating point. The resulting line has negative slope; therefore, the incremental (small signal) 
input resistance of the ideal voltage regulator is negative. For example, increasing the voltage ( v gCt) )T, 

384 
Input Filter Design 
causes the current ( ig(t) >r, to decrease, such that the power remains constant. This incremental resistance 
has the value [9,14]: 
R 
- Mz 
(10.10) 
where R is the output load resistance, and M is the conversion ratio V/Vg. For each of the converters listed 
in Table 10.1, the de asymptote of ZN(s) coincides with the negative incremental resistance given by the 
equation above. 
Practical control systems exhibit a limited bandwidth, determined by the crossover frequency fc 
of the feedback loop. Therefore, we would expect the closed-loop regulator input impedance to be 
approximately equal to ZJs) at low frequency (j < fc) where the loop gain is large and the regulator 
works well. At frequencies above the bandwidth of the regulator (j ~ fc), we expect the converter input 
impedance to follow the open-loop value Zv(s). For closed-loop conditions, it can be shown that the reg-
ulator input impedance Z;(s) is, in fact, described by the following equation: 
1 
1 
T(s) 
1 
1 
-- = ----- + -----
ZJs) 
ZN(s) 1 + T(s) 
Z 0 (s) 1 + T(s) 
(10.11) 
where T(s) is the controller loop gain. Thus, the regulator input impedance follows the negative resis-
tance of ZN(s) at low frequency where the magnitude of the loop gain is large [and hence T/(1 + n"' 1, 
1/(1 + n "'0], and reverts to the (positive) open-loop impedance Zv(s) at high frequency where II T II is 
small [i.e., where T/(1 + D "'0, 1/(1 + D"' 1]. 
When an undamped or lightly damped input filter is connected to the regulator input port, the 
input filter can interact with the negative resistance characteristic of ZN to form a negative resistance 
oscillator. This further explains why addition of an input filter tends to lead to instabilities. 
10.2.2 
Impedance Inequalities 
Equation (10.4) reveals that addition of the input filter causes the control-to-output transfer function to be 
modified by the factor 
(1 + Z0(S)) 
Z0(s) 
called the correction factor. When the following inequalities are satisfied, 
II Zo II~ II ZN II· and 
IIZall ~liZ oil 
(10.12) 
(10.13) 
then the correction factor has a magnitude of approximately unity, and the input filter does not substan-
tially alter the control-to-output transfer function [9,10]. These inequalities limit the maximum allowable 
output impedance of the input filter, and constitute useful filter design criteria. One can sketch the Bode 
plots of II ZN(jw) II and II ZD(jw) II, and compare with the Bode plot of II Z0(jffi) 11. This allows the engineer 
to gain the insight necessary to design an input filter that satisfies Eq. (10.13). 

10.3 
Buck Converter Example 
385 
A similar analysis shows that the converter output impedance is not substantially affected by the 
input filter when the following inequalities are satisfied: 
II zo II« II z, II· anct 
IIZall « IIZDII 
(10.14) 
where Z0 (s) is again as given in Table 10.1. The quantity Ze(s) is equal to the converter input impedance 
Zi(s) under the conditions that the converter output is shorted: 
(10.15) 
Expressions for Z/s) for basic converters are also listed in Table 10.1. 
Similar impedance inequalities can be derived for the case of current-programmed converters 
[12,13], or converters operating in the discontinuous conduction mode. In [12], impedance inequalities 
nearly identical to the above equations were shown to guarantee that the input filter does not degrade 
transient response and stability in the current-programmed case. Feedforward of the converter input volt-
age was suggested in [16]. 
10.3 
BUCK CONVERTER EXAMPLE 
Let us again consider the example of a simple buck converter with L-C input filter, as illustrated in Fig. 
10.8(a). Upon replacing the converter with its small-signal model, we obtain the equivalent circuit of Fig. 
10.8(b). Let's evaluate Eq. (10.4) for this example, to find how the input filter modifies the control-to-
output transfer function of the converter. 
10.3.1 
Effect of Undamped Input Filter 
The quantities ZN(s) and Z0 (s) can be read from Table 10.1, or can be derived using Eqs. (10.6) and 
(10.7) as further described in Appendix C. The quantity Z0 (s) is given by Eq. (10.6). Upon setting d(s) to 
zero, the converter small signal model reduces to the circuit of Fig. 10.9(a). It can be seen that Z0 (s) is 
equal to the input impedance of the R-L-C filter, divided by the square of the turns ratio: 
(10.16) 
Construction of asymptotes for this impedance is treated in Section 8.4, with the results for the numerical 
values of this example given in Fig. 10.10. The load resistance dominates the impedance at low fre-
quency, leading to a de asymptote of RID2 = 12 Q. For the high-Q case shown, II Z0 (jw) II follows the 
output capacitor asymptote, reflected through the square of the effective turns ratio, at intermediate fre-
quencies. A series resonance occurs at the output filter resonant frequency f 0, given by 
f-
1 
Jo- 2n..rLC 
(10.17) 
For the element values listed in Fig. l0.8(a), the resonant frequency is fo = 1.6 kHz. The values of the 
asymptotes at the resonant frequency f0 are given by the characteristic impedance R0 , referred to the 

386 
Input Filter Design 
(a) 
Input filter 
Converter 
~--······i;:···················: 
r---~ 
~~-+--~~ 
:·················-······--······--·····---·····--····-·--·····--····: 
L 
+ 
R 
v 
470 !!F 
100 !!F 
3Q 
···············•••t·································' 
D = 0.5 
(b) 
Input filter 
Converter model 
r··------------i;·----------------1 
r·-------------------------------------------------------------------------------------------------------1 
~.-+-----_,--,----. 
+ 
l r 
c 
R 
100 !!F 
3Q 
!_ ___________________________________ _! 
L 
_______________________________________________ f _____________________________________________________ J 
d 
Fig. 10.8 Buck converter example: (a) converter circuit, (b) small-signal model. 
(a) 
r··------------------------~--;--;·-----------------------£-----------------r:-----------------------1 
+ 
c 
R 
(b) 
r-·----------------------------------------------------------r-=·a·----i·----------------------~ 
! 
null 
! 
~------~-+---r----~ 
+ 
+ 
vtest 
v -+0 
s null 
c 
R 
L__ _____________________________________________ r=·-------------------------------------------------j 
d 
Fig. 10.9 
Determination of the quantities ZN(s) and Z0 (s) for the circuit of Fig. 10.8(b): (a) determination of 
Z0 (s), (b) determination of ZN(s). 

10.3 
Buck Converter Example 
387 
40dBQ 
30dBQ 4 = 12 Q 
II ZD II 
D 
20 dBQ 1--=-----........,js;:::-----+----:::J""":::;:_- II ZN II 
!OdBQ 
.:::::.::::.·::.r~ ~:~r = t 
= 3 ~ 9.5 dB 
OdBQ+-----~~--~~~~----~~~~~~~ 
100 Hz 
I kHz 
10 kHz 
f 
Fig. 10.10 Construction of II ZN(jw) II and II Z0 (jw) II, buck converter example. 
transformer primary: 
(10.18) 
For the element values given in Fig. lO.S(a), this expression is equal to 4 .Q. The Q-factor is given by 
Q=..K.=R fi: 
R0 
V L 
(10.19) 
This expression yields a numerical value of Q = 3. The value of II Z0 (jro) II at the resonant frequency 
1.6 kHz is therefore equal to (4 Q)/(3) = 1.33 Q. At high frequency, II Z0 (jro) II follows the reflected 
inductor asymptote. 
The quantity ZN(s) is given by Eq. (10.7). This impedance is equal to the converter input imped-
ance Z/s), under the conditions that d(s) is varied to maintain the output voltage v(s) at zero. Figure 
10.9(b) illustrates the derivation of an expression for ZN(s). A test current source z1eJs) is injected at the 
converter input port. The impedance ZN(s) can be viewed as the transfer function from ttesis) to v1ejs): 
Z ( ) _ o,e,,(s) I 
N S -
• 
l tesls) o~o 
null 
(10.20) 
The null condition v(s) ;;;;u 0 greatly simplifies analysis of the circuit of Fig. 1 0.9(b ). Since the voltage 
v(s) is zero, the currents through the capacitor and load impedances are also zero. This further implies 
that the inductor current l(s) and transformer winding currents are zero, and hence the voltage across the 
inductor is also zero. Finally, the voltage O,(s), equal to the output voltage plus the inductor voltage, is 
zero. 
Since the currents in the windings of the transformer model are zero, the current itesis) is equal 
to the independent source current Jd(s): 
(10.21) 
Because O,(s) is equal to zero, the voltage applied to the secondary of the transformer model is equal to 
the independent source voltage- Vi(s). Upon dividing by the turns ratio D, we obtain v1esrCs): 

388 
Input Filter Design 
Fig~ 10.11 
Determination of the filter output impedance Z0(s). 
(10.22) 
Insertion of Eqs. (10.21) and (10.22) into Eq. (10.20) leads to the following result: 
(10.23) 
The steady-state relationship I= DV/R has been used to simplify the above result. This equation coin-
cides with the expression listed in Table 10.1. The Bode diagram of II ZJjw) II is constructed in Fig. 
10.10; this plot coincides with the de asymptote of II Zv(jW) 11. 
Next, let us construct the Bode diagram of the filter output impedance Z0(s). When the indepen-
dent source v 
gCs) is set to zero, the input filter network reduces to the circuit of Fig. 10.11. It can be seen 
that ZJs) is given by the parallel combination of the inductor L1and the capacitor Ci 
Zo(s) = sL tii-c
1 
s t 
(10.24) 
Construction of the Bode diagram of this parallel resonant circuit is discussed in Section 8.3.4. As illus-
trated in Fig. 10.12, the magnitude II Z0(jW) II is dominated by the inductor impedance at low frequency, 
and by the capacitor impedance at high frequency. The inductor and capacitor asymptotes intersect at the 
filter resonant frequency: 
Fig. 10.12 Magnitude plot of the output 
impedance of the input filter of Fig. 10.11. 
Since the filter is not damped, the Q-factor is 
very large. 
40dB.Q 
30 dB.Q 
20 dB.Q 
10 dB.Q 
0 dB.Q 
-lOdB.Q 
lOOHz 
· ········· Rot= j!i!; = 0.84 Q 
1 
wet 
f 
I kHz 

10.3 Buck Converter Example 
389 
40dBQ 
30dBQ 
IOdBQ 
OdBQ 
-!OdBQ 
-20dBQ+-----~~~~~~~----~~~~~~~ 
100Hz 
I kHz 
10kHz 
f 
Fig. 10.13 Impedance design criteria II Z,/Joo) II and II Z0 Uoo) II from Fig. 10.10, with the filter output impedance 
II Z0Uoo) II of Fig. 10.12 superimposed. The design criteria of Eq. (10.13) are not satisfied at the input filter reso-
nance. 
(10.25) 
For the given values, the input filter resonant frequency is ft = 400 Hz. This filter has characteristic 
impedance 
(10.26) 
equal to 0.84 Q. Since the input filter is undamped, its Q-factor is ideally infinite. In practice, parasitic 
elements such as inductor loss and capacitor equivalent series resistance limit the value of Qf' Nonethe-
less, the impedance II ZaCjw) II is very large in the vicinity of the filter resonant frequency ft· 
The Bode plot of the filter output impedance II Z0 (jffi) II is overlaid on the II ZJ.jw) II and 
II ZD(jw) II plots in Fig. 10.13, for the element values listed in Fig. 10.8(a). We can now determine 
whether the impedance inequalities (10.13) are satisfied. Note the design-oriented nature of Fig. 10.13: 
since analytical expressions are given for each impedance asymptote, the designer can easily adjust the 
component values to satisfy Eq. (10.13). For example, the values of L1and C1should be chosen to ensure 
that the asymptotes of II Z0(jffi) II lie below the worst-case value of R/D2, as well as the other asymptotes 
of II ZD(jw) 11. 
. 
It should also be apparent that it is a bad idea to choose the input and output filter resonant fre-
quencies fo and ft to be equal, because it would then be more difficult to satisfy the inequalities of Eq. 
(10.13). Instead, the resonant frequenciesf0 and.ftshould be well separated in value. 
Since the input filter is undamped, it is impossible to satisfy the impedance inequalities (10.13) 
in the vicinity of the input filter resonant frequency ft· Regardless of the choice of element values, the 
input filter changes the control-to-output transfer function Gvis) in the vicinity of frequency ft· Figures 
10.14 and 10.15 illustrate the resulting correction factor [Eq. (10.12)] and the modified control-to-output 
transfer function [Eq. (10.4)], respectively. At frequencies well below the input filter resonant frequency, 
impedance inequalities (10.13) are well satisfied. The correction factor tends to the value l.L0°, and the 

390 
Input Filter Design 
lOdB 
OdB-1-------
-lOdB 
o· 
f.--,-~-~~"----======~--------+- 360" 
100Hz 
1kHz 
10kHz 
f 
Fig. 10.14 Magnitude of the correction factor, Eq. (10.12), for the buck converter example of Fig. 10.8. 
II Gvd II 40 dBV 
30dBV.,__I_I G_vd_l_l = 
20dBV 
lOdBV 
L Gvd 
0 dBVt----=.:--:;:---------------••• 
.... ,,, 
'• ·----------------- - 180" 
o· 
-lOdBV 
-360" 
100Hz 
1kHz 
f 
Fig. 10.15 Effect of the undamped input filter on the control-to-output transfer function of the buck converter 
example. Dashed lines: without input filter. Solid lines: with undamped input filter. 
control-to-output transfer function Gv~(s) is essentially unchanged. In the vicinity of the resonant fre-
quency if· the correction factor contains a pair of complex poles, and also a pair of right half-plane com-
plex zeroes. These cause a "glitch" in the magnitude plot of the correction factor, and they contribute 
360° of lag to the phase of the correction factor. The glitch and its phase lag can be seen in the Bode plot 
of Gvis). At high frequency, the correction factor tends to a value of approximately lL- 360°; conse-
quently, the high-frequency magnitude of Gvd is unchanged. However, when the- 360° contributed by 
the correction factor is added to the- 180° contributed at high frequency by the two poles of the original 
Gvd(s), a high-frequency phase asymptote of- 540° is obtained. If the crossover frequency of the con-
verter feedback loop is placed near to or greater than the input filter resonant frequency if. then a negative 

10.3 Buck Converter Example 
391 
phase margin is inevitable. This explains why addition of an input filter often leads to instabilities and 
oscillations in switching regulators. 
10.3.2 
Damping the Input Filter 
Let's damp the resonance of the input filter, so that impedance inequalities (10.13) are satisfied at all fre-
quencies. 
One approach to damping the filter is to add resistor R1in parallel with capacitor C1as illustrated 
in Fig. 10.16(a). The output impedance of this network is identical to the parallel resonant impedance 
analyzed in Section 8.3.4. The maximum value of the output impedance occurs at the resonant frequency 
fr. and is equal in value to the resistance R1. Hence, to satisfy impedance inequalities (10.13), we should 
choose R1 to be much less than the II ZN(jw) II and II ZD(jw) II asymptotes. The condition R1 < II ZN(jw) II 
can be expressed as: 
(10.27) 
Unfortunately, this raises a new problem: the power dissipation in Rf" The de input voltage Vg is applied 
across resistor R1, and therefore R1 dissipates power equal to V~IR1 . Equation (10.27) implies that this 
power loss is greater than the load power! Therefore, the circuit of Fig. 10.16(a) is not a practical solu-
tion. 
One solution to the power loss problem is to place R1 in parallel with L1 as illustrated in Fig. 
10.16(b). The value of Rr in Fig. 10.16(b) is also chosen according to Eq. (10.27). Since the de voltage 
across inductor L1 is zero, there is now no de power loss in resistor R1. The problem with this circuit is 
that its transfer function contains a high-frequency zero. Addition of Rr degrades the slope of the high-
frequency asymptote, from- 40 dB/decade to- 20 dB/decade. The circuit of Fig. 10.16(b) is effectively 
a single-pole R-C low-pass filter, with no attenuation provided by inductor Lf" 
One practical solution is illustrated in Fig. 10.17 [10]. De blocking capacitor Cb is added in 
series with resistor Rr Since no de current can flow through resistor R1, its de power loss is eliminated. 
The value of Cb is chosen to be very large such that, at the filter resonant frequency fr. the impedance of 
the RrCb branch is dominated by resistor R1. When Cb is sufficiently large, then the output impedance of 
this network reduces to the output impedances of the filters of Fig. 10.16. The impedance asymptotes for 
the case of large Cb are illustrated in Fig. 10.17(b). 
(a) 
(b) 
Rf 
Lf 
c:-J 
0 
0 I 
cf 
Rf 
C1T 
0 
0 
~------------------~----0 
Fig. 10.16 Two attempts to damp the input filter: (a) addition of damping resistance Rf across Cf, (b) addition ol 
damping resistance Rf in parallel with Lf" 

392 
Input Filter Design 
(a) 
(b) 
CJI 
o---------------~----=r=~ __ c_b~o 
Fig. 10.17 
A practical method to damping the input filter, including damping resistance Rr and de blocking 
capacitor Cb: (a) circuit, (b) output impedance asymptotes. 
40dBQ 
30dBQ 
IIZ0 II 
12Q 
20 dBQ r-----.._j,~---+---~:;..._-11 ZN II 
!OdBQ 
.. :.::.:::::.::r~ ~-~ ..... Rol D" 
OdBQ 
-10 dBQ 
-20dBi2+-----~~~~~~~----~~~~~~~ 
100Hz 
I kHz 
10kHz 
f 
Fig. 10.18 
Impedance design criteria II ZN(jw) II and II ZD(jw) II from Fig. 10.1 0, with the filter output impedance 
II Z0 (jW) II of Fig. 10.17(b) superimposed. The design criteria of Eq. (10.13) are well satisfied. 
The low-frequency asymptotes of II ZN(jw) II and II ZD(jw) II in Fig. 10.10 are equal to 
RJD2 = 12 Q. The choice Rf = 1 Q therefore satisfies impedance inequalities (10.13) very well. The 
choice Cb = 4700 p,F leads to 112nftCb = 0.084 Q, which is much smaller than Rf' The resulting magni-
tude II Z0(jW) II is compared with II ZN(jw) II and II ZD(jw) II in Fig. 10.18. It can be seen that the chosen 
values of R1and Cb lead to adequate damping, and impedance inequalities (10.13) are now well satisfied. 
Figure 10.19 illustrates how addition of the damped input filter modifies the magnitude and 
phase of the control-to-output transfer function. There is now very little change in Gvis), and we would 
expect that the performance of the converter feedback loop is unaffected by the input filter. 
10.4 
DESIGN OF A DAMPED INPUT FILTER 
As illustrated by the example of the previous section, design of an input filter requires not only that the 
filter impedance asymptotes satisfy impedance inequalities, but also that the filter be adequately damped. 
Damping of the input filter is also necessary to prevent transients and disturbances in v gCt) from exciting 
filter resonances. Other design constraints include attaining the desired filter attenuation, and minimizing 

10.4 Design of a Damped Input Filter 
393 
40dBV 
II Gvdll. 
II Gvd II 
L Gvd 
30dBV 
20dBV 
Fig. 
10.19 Effect of the 
damped input filter on the 
lOdBV 
control-to-output 
transfer 
function of the buck converter 
L Gvd 
example. Dashed lines: with-
OdBV 
-------------
o· 
out input filter. Solid lines: 
with damped input filter. 
-lOdBV 
-90" 
.1----~---~ 
.......... --~--=:::===,j. -180" 
100Hz 
I kHz 
lOkHz 
f 
the size of the reactive elements. Although a large number of classical filter design techniques are well 
known, these techniques do not address the problems of limiting the maximum output impedance and 
damping filter resonances. 
The value of the blocking capacitor Cb used to damp the input filter in Section 10.3.2 is ten 
times larger than the value of Cf' and hence its size and cost are of practical concern. Optimization of an 
input filter design therefore includes minimization of the size of the elements used in the damping net-
works. 
Several practical approaches to damping the single-section L-C low-pass filter are illustrated in 
Fig. 10.20 [10,11,17]. Figure 10.20(a) contains the RrCb damping branch considered in the previous 
section. In Fig: .10.20(b), the damping resistor R1 is placed in parallel with the filter inductor L1, and a 
high-frequency blocking inductor Lb is placed in series with Rf" Inductor Lb causes the filter transfer 
function to roll off with a high-frequency slope of- 40 dB/decade. In Fig. 10.20(c), the damping resistor 
R1 is placed in series with the filter inductor L1, and the de current is bypassed by inductor Lb. In each 
case, it is desired to obtain a given amount of damping [i.e., to cause the peak value of the filter output 
impedance to be no greater than a given value that satisfies the impedance inequalities (10.13)], while 
minimizing the value of Cb or Lb. This problem can be formulated in an alternate but equivalent form: for 
a given choice of Cb or Lb, find the value of R1 that minimizes the peak output impedance [10]. The solu-
tions to this optimization problem, for the three filter networks of Fig. 21, are summarized in this section. 
In each case, the quantities R01and.tjare defined by Eqs. (10.25) and (10.26). 
Consider the filter of Fig. 10.20(b), with fixed values of L1, c1, and Lb. Figure 10.21 contains 
Bode plots of the filter output impedance II Z0(jw) II for several values of damping resistance Rf" For the 
limiting case R1 = oo, the circuit reduces to the original undamped filter with infinite Q1. In the limiting 
case R1= 0, the filter is also undamped, but the resonant frequency is increased because Lb becomes con-
nected in parallel with L1. Between these two extremes, there must exist an optimum value of R1 that 
causes the peak filter output impedance to be minimized. It can be shown [ 10 ,17] that all magnitude plots 
must pass through a common point, and therefore the optimum attains its peak at this point. This fact has 
been used to derive the design equations of optimally-damped L-C filter sections. 

394 
(a) 
(b) 
(c) 
IIZoll 
Rof 
Input Filter Design 
30dB 
20dB 
10 dB 
0 dB 
-10 dB 
-20 dB 
-30 dB 
Original undamped 
filter (Q f = =) '--... 
. 
II 
I 
1. I 
Suboptlma dampmg 
(Qf= SQopt) 
---::... 
I I I 
'I 
Optimal damping 
f-(Qopt = 0.93) 
/v~ 
l&~ 
/ 
~ 
v y '/ 
;::::~ 
v / 
-
v 
/ 
0.1 
~\ 
+ 
+ 
+ 
Fig. 10.20 
Several practical approaches to damping 
the single-section input filter: (a) RrCb parallel 
damping, (b) Rf-Lb parallel damping, (c) RrLb series 
damping. 
Undamped 
~ter(Q1 = 0) 
'IS 
I . I ld 
. 
uboptlmal ampmg 
r-
(Q =0.2Q0 1 ) 
~ 
\ 
Fig. 
10.21 
Comparison of 
output impedance curves for 
optimal parallel RrLb damping 
with undamped and several 
suboptimal designs. For this 
example, n = Lh/L = 0.516 
v " ~ 
~ 
~--- 1'-o..., 
10 
f 
To 

10.4 
Design of a Damped Input Filter 
395 
10.4.1 
RrCb Parallel Damping 
Optimization of the filter network of Fig. 10.20(a) and Section 10.3.2 was described in [10]. The high-
frequency attenuation of this filter is not affected by the choice of Cb, and the high-frequency asymptote 
is identical to that of the original undamped filter. The sole tradeoff in design of the damping elements 
for this filter is in the size of the blocking capacitor cb vs. the damping achieved. 
For this filter, let us define the quantity n as the ratio of the blocking capacitance C b to the filter 
capacitance ci 
n= cb 
Cr 
For the optimum design, the peak filter output impedance occurs at the frequency 
The value of the peak output impedance for the optimum design is 
II 
II _ j 2( 2 + n) 
zo mm-ROf 
n 
The value of damping resistance that leads to optimum damping is described by 
( 2 + n )( 4 + 3n) 
2n 2(4+n) 
The above equations allow choice of the damping values R1and Cb. 
(10.28) 
(10.29) 
(10.30) 
(10.31) 
For example, let's redesign the damping network of Section 10.3.2, to achieve the same peak 
output impedance \1 Z0(jW) llmm = 1 Q, while minimizing the value of the blocking capacitance C b· From 
Section 10.3.2, the other parameter values are R01 = 0.84 Q, C1= 470 JlF, and 0= 330 JlH. First, we solve 
Eq. (10.30) to find the required value of n: 
(10.32) 
Evaluation of this expression with the given numerical values leads to n = 2.5. The blocking capacitor is 
therefore required to have a value of nC1= 1200 flF. This is one-quarter of the value employed in Section 
10.3.2. The value of R1is then found by evaluation ofEq. (10.31), leading to 
( 2 + n )( 4 + 3n) 
2n 2(4+n) 
=0.67 Q 
(10.33) 
The output impedance of this filter design is compared with the output impedances of the original 
undamped filter of Section 10.3.1, and of the suboptimal design of Section 10.3.2, in Fig. 10.22. It can be 

396 
Input Filter Design 
20dBQ 
10dBQ 
OdBQ 
-10dBQ 
-20dBQ 
-30dBQ+-----~~~~~~~----~~--~~~~ 
100Hz 
1 kHz 
10kHz 
f 
Fig. 10.22 Comparison of the output impedances of the design with optimal parallel RrCb damping, the subopti-
mal design of Section 10.3.2, and the original undamped filter. 
seen that the optimally damped filter does indeed achieve the desired peak output impedance of 1 Q, at 
the slightly lower peak frequency given by Eq. (10.29) 
The RrCb parallel damping approach finds significant application in de--de converters. Since a 
series resistor is placed in series with Cb, Cb can be realized using capacitor types having substantial 
equivalent series resistance, such as electrolytic and tantalum types. However, in some applications, the 
RrLb approaches of the next subsections can lead to smaller designs. Also, the large blocking capacitor 
value may be undesirable in applications having an ac input. 
10.4.2 RrLb Parallel Damping 
Figure 10.20(b) illustrates the placement of damping resistor R1in parallel with inductor Lr Inductor Lb 
causes the filter to exhibit a two-pole attenuation characteristic at high frequency. To allow R1 to damp the 
filter, inductor Lb should have an impedance magnitude that is sufficiently smaller than R1at the filter res-
onant frequency~· Optimization of this damping network is described in [ 17]. 
With this approach, inductor Lb can be physically much smaller than Lr Since R1 is typically 
much greater than the de resistance of Lf' essentially none of the de current flows through Lb. Further-
more, R1 could be realized as the equivalent series resistance of Lb at the filter resonant frequency~· 
Hence, this is a very simple, low-cost approach to damping the input filter. 
The disadvantage of this approach is the fact that the high-frequency attenuation of the filter is 
degraded: the high-frequency asymptote of the filter transfer function is increased from llm2LF1 to 
llm2(L111Lb)Cr Furthermore, since the need for damping limits the maximum value of Lb, significant loss 
of high-frequency attenuation is unavoidable. To compensate, the value of L1 must be increased. There-
fore, a tradeoff occurs between damping and degradation of high-frequency attenuation, as illustrated in 
Fig. 10.23. For example, limiting the degradation of high-frequency attenuation to 6 dB leads to an opti-
mum peak filter output impedance II Z0 llnun of J6 times the original characteristic impedance R01. Addi-
tional damping leads to further degradation of the high-frequency attenuation. 
The optimally damped design (i.e., the choice of R1 that minimizes the peak output impedance 

10.4 Design of a Damped Input Filter 
397 
30dB 
~egradation of HF ~ 
Iter attenuation 
1 
20dB 
"' "' I' 
Fig. 10.23 Performance attained via optimal 
10 dB 
design procedure, parallel RrLb circuit of 
10.20(b). Optimum peak filter output imped-
,.....v 
/ 
/ 
ance II Z0 llmm and increase of filter high-fre-
quency gain, vs. n = Lb/L. 
o dB 
/ 
,/ 
-IOdB 
0.1 
II Z0 II for a given choice of Lb) is described by the following equations: 
where 
n( 3 + 4n )( 1 + 2n) 
2( 1 + 4n) 
The peak filter output impedance occurs at frequency 
and has the value 
• 
!, fT+2Il 
Jm = f V --z;z-
" v 
,....... 
The attenuation of the filter high-frequency asymptote is degraded by the factor 
~-" 
1111 
v 
~ z~mm 
/ v 
Rof 
--r---r-
10 
(10.34) 
(10.35) 
(10.36) 
(10.37) 
(10.38) 
So, given an undamped LrC1 filter having comer frequency ft. and characteristic impedance R01, and 
given a requirement for the maximum allowable output impedance II Z0 llmm' one can solve Eq. (10.37) 
for the required value of n. One can then determine the required numerical values of Lb and Rf" 

398 
Input Filter Design 
10.4.3 RrLb Series Damping 
Figure 10.20(c) illustrates the placement of damping resistor R1 in series with inductor Lf" Inductor Lb 
provides a de bypass to avoid significant power dissipation in Rf" To allow R1 to damp the filter, inductor 
Lb should have an impedance magnitude that is sufficiently greater than R1 at the filter resonant fre-
quency. 
Although this circuit is theoretically equivalent to the parallel damping RrLb case of Section 
10.4.2, several differences are observed in practical designs. Both inductors must carry the full de cur-
rent, and hence both have significant size. The filter high-frequency attenuation is not affected by the 
choice of Lb, and the high-frequency asymptote is identical to that of the original undamped filter. The 
tradeoff in design of this filter does not involve high-frequency attenuation; rather, the issue is damping 
vs. bypass inductor size. 
Design equations similar to those of the previous sections can be derived for this case. The opti-
mum peak filter output impedance occurs at frequency 
2+n 
2( 1 + n) 
!,11 = Jj 
and has the value 
liZ II 
=R J2(1 +n)(2+n) 
o mm 
Of 
n 
The value of damping resistance that leads to optimum damping is described by 
2( 1 + n )( 4 + n) 
(2 + n)(4 + 3n) 
(10.39) 
(10.40) 
(10.41) 
For this case, the peak output impedance cannot be reduced below J2 ROJ via damping. None-
theless, it is possible to further reduce the filter output impedance by redesign of L1 and c1, to reduce the 
value of R0!" 
10.4.4 
Cascading Filter Sections 
A cascade connection of multiple L-C filter sections can achieve a given high-frequency attenuation with 
less volume and weight than a single-section L-C filter. The increased cutoff frequency of the multiple-
section filter allows use of smaller inductance and capacitance values. Damping of each L-C section is 
usually required, which implies that damping of each section should be optimized. Unfortunately, the 
results of the previous sections are restricted to single-section filters. Interactions between cascaded L-C 
sections can lead to additional resonances and increased filter output impedance. 
It is nonetheless possible to design cascaded filter sections such that interaction between L-C 
sections is negligible. In the approach described below, the filter output impedance is approximately 
equal to the output impedance of the last section, and resonances caused by interactions between stages 
are avoided. Although the resulting filter may not be "optimal" in any sense, insight can be gained that 
allows intelligent design of multiple-section filters with economical damping of each section. 

10.4 Design of a Damped Input Filter 
399 
Additional 
filter 
section 
z a --
Existing 
filter 
Fig. 10.24 Addition of a filter section at the input of an existing filter. 
Consider the addition of a filter section to the input of an existing filter, as in Fig. 10.24. Let us 
assume that the existing filter has been correctly designed to meet the output impedance design criteria of 
Eq. (10.13): under the conditions ZJs) = 0 and vgCs) = 0, II Z0 II is sufficiently small. It is desired to add a 
damped filter section that does not significantly increase II Z0 11. 
Middlebrook's extra element theorem of Appendix C can again be invoked, to express how 
addition of the filter section modifies Z0(s): 
( 1 + z.(s) ) 
ZNl(s) 
(1D.42) 
where 
(10.43) 
is the impedance at the input port of the existing filter, with its output port short-circuited. Note that, in 
this particular case, nulling vtes/s) is the same as shorting the filter output port because the short-circuit 
current flows through the itest source. The quantity 
Zm(s) = Zil(s) I· ( 
)-0 
1 test 8 -
(10.44) 
is the impedance at the input port of the existing filter, with its output port open-circuited. Hence, the 
additional filter section does not significantly alter Z0 provided that 
! z. II ~II ZN1 ~ and 
!2.11 ~11 2m~ 
(10.45) 
Bode plots of the quantities Zm and Zm can be constructed either analytically or by computer simula-
tion, to obtain limits of za. When II za II satisfies Eq. (10.45), then the "correction factor" 
(1 + Z)Zm)l(l + Z)Zm) is approximately equal to 1, and the modified Z0 is approximately equal to the 
original Z0 • 
To satisfy the design criteria (10.45), it is advantageous to select the resonant frequencies of Za 
to differ from the resonant frequencies of Zm· In other words, we should stagger-tune the filter sections. 
This minimizes the interactions between filter sections, and can allow use of smaller reactive element 
values. 

400 
Input Filter Design 
'---------------------~-~-~~!-~~--=---------------_J ______________ ~=~~~~-~--~------------------' 
Fig. 10.25 Two-section input filter example, employing RrLb parallel damping in each section. 
10.41.5 
Example: 1\vo Stage Input Filter 
As an example, let us consider the design of a two-stage filter using ~--Lb parallel damping in each sec-
tion as illustrated in Fig. 10.25 [17]. It is desired to achieve the same attenuation as the single-section fil-
ters designed in Sections 10.3.2 and 10.4.1, and to filter the input current of the same buck converter 
example of Fig. 10.8. These filters exhibit an attenuation of 80 dB at 250kHz, and satisfy the design ine-
qualities of Eq. (10.13) with the II ZN II and II ZD II impedances of Fig. 10.10. Hence, let's design the filter 
of Fig. 10.25 to attain 80 dB of attenuation at 250 kHz. 
As described in the previous section and below, it is advantageous to stagger-tune the filter sec-
tions so that interaction between filter sections is reduced. We will find that the cutoff frequency of filter 
section 1 should be chosen to be smaller than the cutoff frequency of section 2. In consequence, the 
attenuation of section 1 will be greater than that of section 2. Let us (somewhat arbitrarily) design to 
obtain 45 dB of attenuation from section 1, and 35 dB of attenuation from section 2 (so that the total is 
the specified 80 dB). Let us also select n1 = n2 = n = Lb!Lr = 0.5 for each section; as illustrated in Fig. 
10.23, this choice leads to a good compromise between damping of the filter resonance and degradation 
of high frequency filter attenuation. Equation (10.38) and Fig. 10.23 predict that the RrLb damping net-
work will degrade the high frequency attenuation by a factor of (1 + lin)= 3, or 9.5 dB. Hence, the sec-
tion 1 undamped resonant frequency Jj1 should be chosen to yield 45 dB + 9.5 dB = 54.5 dB =? 533 of 
attenuation at 250kHz. Since section 1 exhibits a two-pole(- 40 dB/decade) roll-off at high frequencies, 
Jfl should be chosen as follows: 
+ _ (250kHz) _ lO 8 kH 
Jf! -
1533 
-
. 
z 
(10.46) 
Note that this frequency is well above the 1.6 kHz resonant frequency j 0 of the buck converter output fil-
ter. Consequently, the output impedance II Z0 II can be as large as 3 Q, and still be well below the 
II ZN(jw) II and II ZD(jw) II plots of Fig. 10.10. 
Solution of Eq. (10.37) for the required section 1 characteristic impedance that leads to a peak 
output impedance of 3 Q with n = 0.5 leads to 

10.4 Design of a Damped Input Filter 
401 
3 Q 
=2.12Q 
J 2(0.5)( 1 + 2(0.5)) 
The filter inductance and capacitance values are therefore 
R0/1 
L 1 = -2 + = 31.2 ~-tH 
1!;11 
C1 = 2 / R = 6.9 ~-tF 
7t /1 0/1 
The section 1 damping network inductance is 
The section 1 damping resistance is found from Eq. (10.34): 
n( 3 + 4n )( 1 + 2n) = 1.9Q 
2( 1 + 4n) 
(10.47) 
(10.48) 
(10.49) 
(10.50) 
The peak output impedance will occur at the frequency given by Eq. (10.36), 15.3 kHz. The quantities 
II ZNl(jro) II and II ZDI(jro) II for filter section 1 can now be constructed analytically or plotted by computer 
simulation. II ZNl(jro) II is the section 1 input impedance Z,1 with the output of section 1 shorted, and is 
given by the parallel combination of the sL1 and the (R 1 + sn1L1) branches. II ZDI(jro) II is the section 1 
input impedance z,1 with the output of section 1 open-circuited, and is given by the series combination of 
ZNl(s) with the capacitor impedance 1/sC1• Figure 10.26 contains plots of II ZNl(jro) II and II ZDI(jro) II for 
filter section 1, generated using Spice. 
One way to approach design of filter section 2 is as follows. To avoid significantly modifying 
the overall filter output impedance Z0 , the section 2 output impedance II ZaUro) II must be sufficiently less 
than II ZNl(jro) II and II ZDI(jro) 11. It can be seen from Fig. 10.26 that, with respect to II ZDI(jro) II, this is 
most difficult to accomplish when the peak frequencies of sections I and 2 coincide. It is most difficult to 
satisfy the II ZNl(jro) II design criterion when the peak frequency of sections 2 is lower than the peak fre-
quency of section 1. Therefore, the best choice is to stagger-tune the filter sections, with the resonant fre-
quency of section l being lower than the peak frequency of section 2. This implies that section l will 
produce more high-frequency attenuation than section 2. For this reason, we have chosen to achieve 
45 dB of attenuation with section 1, and 35 dB of attenuation from section 2. 
The section 2 undamped resonant frequency fn should be chosen in the same manner used in 
Eq. (10.46) for section 1. We have chosen to select n2 = n = Lb/Lf= 0.5 for section 2; this again means 
that the RrLb damping network will degrade the high frequency attenuation by a factor of (1 + 1/n) = 3, 
or 9.5 dB. Hence, the section 2 undamped resonant frequency !12 should be chosen to yield 35 dB + 9.5 
dB = 44.5 dB :=} 169 of attenuation at 250 kHz. Since section 2 exhibits a two-pole (- 40 dB/decade) 
roll-off at high frequencies,f12 should be chosen as follows: 
J: - (250 kHz) 
19.25 kHz 
f2-
fi69 
(10.51) 
The output impedance of section 2 will peak at the frequency 27.2 kHz, as given by Eq. (10.36). Hence, 
the peak frequencies of sections l and 2 differ by almost a factor of 2. 

402 
Input Filter Design 
-~ N
1zL
1
11 
I'. 
20dBQ 
~ 
v 
/ 
IIZN0-V 
7 
F' 
OdBQ 
v 
v~ 
-v"' 
-20dBQ 
-
~::: 
NI 
K 
/ 
-
'\V 
90" 
45" 
o· 
I 1\ 
I \ 
-
I 
zm v 
M 
-45" 
-
-90" 
1kHz 
10kHz 
v ~ 
v 
/ 
'\ 
'\ 
II z" II 
~'--.. ....., 
......... !'-.. 
...-::::F= 
LZa 
1\ 
I' 
100kHz 
1 MHz 
Fig. 10.26 
Bode plot of ZN1 and Zm for filter section 1. Also shown is the Bode plot for the output impedance Za 
of filter section 2. 
Figure 10.26 shows that, at 27.2 kHz, II ZDI(jw) II has a magnitude of roughly 3 dBQ, and that 
II ZNl(jw) II is approximately 7 dBQ. Hence, let us design section 2 to have a peak output impedance of 
0 dBQ ==} 1 Q. Solution of Eq. (10.37) for the required section 2 characteristic impedance leads to 
The section 2 element values are therefore 
lQ 
=0.71Q 
J 2(0.5)( 1 + 2(0.5)) 
n( 3 + 4n )( 1 + 2n) 
=0.65 Q 
2( 1 + 4n) 
(10.52) 
(10.53) 
A Bode plot of the resulting Za is overlaid on Fig. 10.26. It can be seen that II Za(jw) II is less than, but 
very close to, II ZDI(jw) II between the peak frequencies of 15kHz and 27kHz. The impedance inequali-
ties (10.45) are satisfied somewhat better below 15 kHz, and are satisfied very well at high frequency. 
The resulting filter output impedance II Z0(jW) II is plotted in Fig. 10.27, for section 1 alone and 
for the complete cascaded two-section filter. It can be seen that the peak output impedance is approxi-

30dBQ 
20dBQ 
~ 
\ 
I 
10dBQ 
v 
OdBQ 
/... 
-:::.······ 
-10 dBQ 
-20dBQ 
1kHz 
/ ,/ 
r; 
/ ~ 
.. ······ 
10.5 Summary of Key Points 
403 
VIIZvll 
I!L1
11 
v 
Cascaded 
sections 1 and 2 
IIZoll 
... ·····'"\' 
I 
.. 
•• .. Section 1 
.. 
'(:.alone 
/ 
.. 
/ 
... 
····· 
I' ' ~", 
10kHz 
100kHz 
Fig. 10.27 Comparison of the impedance design criteria II Zt!Jw) II and 11 Z0Uw) 11. Eq. (10.13), with the filter 
output impedance II Z0UW) 11. Solid line: II Z0UW) II of cascaded design. Dashed line: II Z0UW) II of section l alone. 
mately 10 dBQ, or roughly 3 Q. The impedance design criteria (10.13) are also shown, and it can be seen 
that the filter meets these design criteria. Note the absence of resonances in II Z0(jW) 11. 
The effect of stage 2 on II Z0 (jW) II is very small above 40kHz [where inequalities (10.45) are 
very well satisfied], and has moderate-to-small effect at lower frequencies. It is interesting that, above 
approximately 12kHz, the addition of stage 2 actually decreases II Z0(jW) 11. The reason for this can be 
seen from Fig. C.8 of Appendix C: when the phase difference between L.Za(jw) and LZm(jw) is not too 
large(::; 90.), then the 11(1 + Z/Zm) term decreases the magnitude of the resulting II Z0(jW) 11. As can be 
seen from the phase plot of Fig. 10.26, this is indeed what happens. So allowing II Za(jw) II to be similar 
in magnitude to II Zm(jW) II above 12kHz was an acceptable design choice. 
The resulting filter transfer function is illustrated in Fig. 10.28. It can be seen that it does indeed 
attain the goal of 80 dB attenuation at 250 kHz. 
Figure 10.29 compares the single stage design of Section 10.4.1 to the two-stage design of this 
section. Both designs attain 80 dB attenuation at 250 kHz, and both designs meet the impedance design 
criteria of Eq. (10.13). However, the single-stage approach requires much larger filter elements. 
10.5 
SUMMARY OF KEY POINTS 
1. 
Switching converters usually require input filters, to reduce conducted electromagnetic interference and 
possibly also to meet requirements concerning conducted susceptibility. 
2. 
Addition of an input filter to a converter alters the control-to-output and other transfer functions of the con-
verter. Design of the converter control system must account for the effects of the input filter. 
3. 
If the input filter is not damped, then it typically introduces complex poles and RHP zeroes into the con-
verter control-to-output transfer function, at the resonant frequencies of the input filter. If these resonant 
frequencies are lower than the crossover frequency of the controller loop gain, then the phase margin will 
become negative and the regulator will be unstable. 

404 
Input Filter Design 
20dB 
IIHII 
OdB 
-20dB 
-40dB 
-60dB 
-80dB 
-100 dB 
-120 dB 
1kHz 
r'\. 
10kHz 
r-.. 
1\ 
\ 
\ 
-SO dB-
at 250kHz 
100kHz 
f 
Fig. 10.28 Input filter transfer function, cascaded two-section design. 
(a) 
(b) 
R2 
0.65Q 
1\ 
' 
1MHz 
Fig. 10.29 Comparison of single-section (a) and two section (b) input filter designs. Both designs meet the design 
criteria (10.13), and both exhibit 80 dB of attenuation at 250kHz. 

References 
405 
4. 
The input filter can be designed so that it does not significantly change the converter control-to-output and 
other transfer functions. Impedance inequalities (1 0.13) give simple design criteria that guarantee this. To 
meet these design criteria. the resonances of the input filter must be sufficiently damped. 
5. 
Optimization of the damping networks of single-section filters can yield significant savings in filter ele-
ment size. Equations for optimizing three different filter sections are listed. 
6. 
Substantial savings in filter element size can be realized via cascading filter sections. The design of nonin-
teracting cascaded filter sections can be achieved by an approach similar to the original input filter design 
method. Impedance inequalities ( 10.45) give design criteria that guarantee that interactions are not sub-
stantial. 
REFERENCES 
[1] 
M. NAVE, Power Line Filter Design for Switched Mode Power Supplies, New York: Van Nostrand Rein-
hold, 1991. 
[2] 
Design Guide for Electromagnetic Interference (EM/) Reduction in Power Supplies, MIL-HDBK-241B, 
U.S. Department of Defense, April 1 1981. 
[3] 
C. MARSHAM, The Guide to the EMC Directive 891336/EEC, New York: IEEE Press, 1992. 
[4] 
P. DEGAUQUE and J. HAMELIN, Electromagnetic Compatibility, Oxford: Oxford University Press, 1993. 
[5] 
R. REDL, "Power Electronics and Electromagnetic Compatibility," IEEE Power Electronics Specialists 
Conference, 1996 Record, pp. 15-21. 
[6] 
P.R. WILLCOCK, J. A. FERREIRA, J.D. VANWYK, "An Experimental Approach to Investigate the Genera-
tion and Propagation of Conducted EMI in Converters," IEEE Power Electronics Specialists Conference, 
1998 Record, pp. 1140-1146. 
[7] 
L. ROSSETTO, S. Buso and G. SPIAZZI, "Conducted EMI Issues in a 600W Single-Phase Boost PFC 
Design," IEEE Transactions on Industry Applications, Vol. 36, No.2, pp. 578-585, March/April2000. 
[8] 
F. Dos REIS, J. SEBASTIAN and J. UCEDA, "Determination of EMI Emissions in Power Factor Preregula-
tors by Design," IEEE Power Electronics Specialists Conference, 1994 Record, pp. 1117-1126. 
[9] 
R. D. MIDDLEBROOK, "Input Filter Considerations in Design and Application of Switching Regulators," 
IEEE Industry Applications Society Annual Meeting, 1976 Record, pp. 366-382. 
[10] 
R. D. MIDDLEBROOK, "Design Techniques for Preventing Input Filter Oscillations in Switched-Mode Reg-
ulators," Proceedings of Powercon 5, pp. A3.1-A3.16, May 1978. 
[11] 
T. PHELPS and W. TATE, "Optimizing Passive Input Filter Design," Proceedings of Powercon 6, pp. Gl.l-
Gl.lO, May 1979. 
[12] 
Y. JANG and R. ERICKSON, "Physical Origins of Input Filter Oscillations in Current Programmed Convert-
ers," IEEE Transactions on Power Electronics, Vol7, No.4, pp. 725-733, October 1992. 
[13] 
S. ERICH and W. POLIVKA, "Input Filter Design for Current-Programmed Regulators," IEEE Applied 
Power Electronics Conference, 1990 Proceedings, pp. 781-791, March 1990. 

406 
Input Filter Design 
[14] 
N. SOKAL, "System Oscillations Caused by Negative Input Resistance at the Power Input Port of a Switch-
ing Mode Regulator, Amplifier, De/De Converter, or Dc/Ac Inverter," IEEE Power Electronics Specialists 
Conference, 1973 Record, pp. 138-140. 
[15] 
A. KISLOVSKI, R. REDL, and N. SOKAL, Dynamic Analysis of Switching-Mode De/De Converters, New 
York: Van Nostrand Reinhold, Chapter 10, 1991. 
[16] 
S. KELKAR and F. LEE, "A Novel Input Filter Compensation Scheme for Switching Regulators," IEEE 
Power Electronics Specialists Conference, 1982 Record, pp. 260-271. 
[17] 
R. ERICKSON, "Optimal Single-Resistor Damping of Input Filters," IEEE Applied Power Electronics Con-
ference, 1999 Proceedings, pp. 1073-1097, March 1999. 
[18] 
M. FLOREZ-LIZARRAGA and A. F. WITULSKI, "Input Filter Design for Multiple-Module De Power Sys-
tems," IEEE Transactions on Power Electronics, Vol11, No. 3, pp. 472-479, May 1996. 
[19] 
V. VLATKOVIC, D. BOROJEVIC and F. LEE, "Input Filter Design for Power Factor Correction Circuits," 
IEEE Transactions on Power Electronics, Volll, No.1, pp. 199-205, January 1996. 
[20] 
F. YUAN, D. Y. CHEN, Y. Wu andY. CHEN, "A Procedure for Designing EMI Filters for Ac Line Applica-
tions," IEEE Transactions on Power Electronics, Volll, No.1, pp. 170-181, January 1996. 
[21] 
G. SPIAZZI and J. PO MILlO, "Interaction Between EMI Filter and Power Factor Preregulators with Average 
Current Control: Analysis and Design Considerations," IEEE Transactions on Industrial Electronics, 
Vol. 46, No. 3, pp. 577-584, June 1999. 
PROBLEMS 
10.1 
It is required to design an input filter for the fiyback converter of Fig. 10.30. The maximum allowed 
amplitude of switching harmonics of i;11(t) is 10 IJ.A rms. Calculate the required attenuation of the filter at 
the switching frequency. 
Input 
filter 
n 
r v=o.3 
J L_j !,=200kHz 
Fig. 10.30 
Flyback converter, Problems 10.1, 10.4, 10.6, 10.8, and 10.10. 
R 
5Q 
+ 
v 
10.2 
In the boost converter of Fig. 10.31, the input filter is designed so that the maximum amplitude of 
switching harmonics of i;11(t) is not greater than 10 IJ.A rms. Find the required attenuation of the filter at 
the switching frequency. 
10.3 
Derive the expressions for ZN and ZD in Table 10.1. 

Input 
filter 
L 
11 r D=o.6 
J 
LJ .t; =200kHz 
Fig. 10.31 
Boost converter, Problems 10.2, 10.5, 10.7, and 10.9. 
+ 
v 
Problems 
407 
R 
12Q 
10.4 
The input filter for the flyback converter of Fig. 10.30 is designed using a single LrC1section. The filter 
is damped using a resistor R1in series with a very large blocking capacitor Cb. 
(a) 
Sketch a small-signal model of the flyback converter. Derive expressions for ZN(s) and Z0 (s) 
using your model. Sketch the magnitude Bode plots of ZN and Z0 , and label all salient features. 
(b) 
Design the input filter, i.e., select the values of Lf' c1, and R1, so that: (i) the filter attenuation at 
the switching frequency is at least 100 dB, and (ii) the magnitude of the filter output impedance 
Z0(s) satisfies the conditions II Zjjw) II< 0.311 Z0 (jw) II, II Z0(jW) II< 0.311 Z~w) II, for all fre-
quencies. 
(c) 
Use Spice simulations to verify that the filter designed in part (b) meets the specifications. 
(d) 
Using Spice simulations, plot the converter control-to-output magnitude and phase responses 
without the input filter, and with the filter designed in part (b). Comment on the changes intro-
duced by the filter. 
10.5 
It is required to design the input filter for the boost converter of Fig. 10.31 using a single LrC1 section. 
The filter is damped using a resistor R1in series with a very large blocking capacitor Cb. 
(a) 
Sketch the magnitude Bode plots of ZN(s) and Z0 (s) for the boost converter, and label all salient 
features. 
(b) 
Design the input filter, i.e., select the values of L1, C1, and Rf, so that: (i) the filter attenuation at 
the switching frequency is at least 80 dB, and (ii) the magnitude of the filter output impedance 
Z0(s) satisfies the conditions II Zjjw) II< 0.211 Z0 (jw) 11. II Z0(jW) II< 0.211 ZN(jw) 11. for all fre-
quencies. 
(c) 
Use Spice simulations to verify that the filter designed in part (b) meets the specifications. 
(d) 
Using Spice simulations, plot the converter control-to-output magnitude and phase responses 
without the input filter, and with the filter designed in part (b). Comment on the changes in the 
control-to-output responses introduced by the filter. 
10.6 
Repeat the filter design of Problem 10.4 using the optimum filter damping approach described in Section 
10.4.1. Find the values of L1, C1, R1, and Cb. 
10.7 
Repeat the filter design of Problem 10.5 using the optimum filter damping approach of Section 10.4.1. 
Find the values of Lf' Cf' R1, and Cb. 
10.8 
Repeat the filter design of Problem 10.4 using the optimum RrLb parallel damping approach described 
in Section 10.4.2. Find the values of L1, c1, R1, and Lb. 
10.9 
Repeat the filter design of Problem 10.5 using the optimum RrLb parallel damping approach described 
in Section 10.4.2. Find the values of Lf' c1, R1, and Lb. 

408 
Input Filter Design 
10.10 
It is required to design the input filter for the flyback converter of Fig. 10.30 using two filter sections. 
Each filter section is damped using a resistor in series with a blocking capacitor. 
(a) 
Design the input filter, i.e., select values of all circuit parameters, so that (i) the filter attenuation 
at the switching frequency is at least 100 dB, and (ii) the magnitude of the filter output imped-
ance Z0 (s) satisfies the conditions II Z0(jW) II< 0.311 ZD(jw) II, II Z0(jW) II< 0.311 ZN(jw) II, for all 
frequencies. 
(b) 
Use Spice simulations to verify that the filter designed in part (a) meets the specifications. 
(c) 
Using Spice simulations, plot the converter control-to-output magnitude and phase responses 
without the input filter, and with the filter designed in part (b). Comment on the changes intro-
duced by the filter. 

11 
AC and DC Equivalent Circuit 
Modeling of the Discontinuous 
Conduction Mode 
So far, we have derived equivalent circuit models for de-de pulse-width modulation (PWM) converters 
operating in the continuous conduction mode. As illustrated in Fig. 11.1, the basic de conversion prop-
erty is modeled by an effective de transformer, having a turns ratio equal to the conversion ratio M(D). 
This model predicts that the converter has a voltage-source output characteristic, such that the output 
voltage is essentially independent of the load current or load resistance R. We have also seen how to 
refine this model, to predict losses and efficiency, converter dynamics, and small-signal ac transfer func-
tions. We found that the transfer functions of the buck converter contain two low-frequency poles, owing 
to the converter filter inductor and capacitor. The control-to-output transfer functions of the boost and 
buck-boost converters additionally contain a right half-plane zero. Finally, we have seen how to utilize 
these results in the design of converter control systems. 
What are the basic de and small-signal ac equivalent circuits of converters operating in the dis-
continuous conduction mode (DCM)? It was found in Chapter 5 that, in DCM, the output voltage 
becomes load-dependent: the conversion ratio M(D, K) is a function of the dimensionless parameter 
K = 2L/RTs, which in turn is a function of the load resistance R. So the converter no longer has a voltage-
source output characteristic, and hence the de transformer model is less appropriate. In this chapter, the 
averaged switch modeling [1-8] approach is employed, to derive equivalent circuits of the DCM switch 
network. 
In Section 11.1, it is shown that the loss-free resistor model [9-11] is the averaged switch model 
of the DCM switch network. This equivalent circuit represents the steady-state and large-signal dynamic 
characteristics of the DCM switch network, in a clear and simple manner. In the discontinuous conduc-
tion mode, the average transistor voltage and current obey Ohm's law, and hence the transistor is mod-
eled by an effective resistor Re. The average diode voltage and current obey a power source 
characteristic, with power equal to the power effectively dissipated in Re. Therefore, the diode is modeled 
with a dependent power source. 

410 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
DC 
AC 
1 :M(D) 
+ 
+ 
CCM 
Vg 
R 
V 
v(s) 
R 
DCM 
r··-------------------1 
r··----------------------------------------------------------------------------------1 
vg u· ? 
o r  
' 
: "''{]! 
' 
i 
g 
-
I 
! 
: 
: 
-
' 
,_ ____________________ J 
' 
!--. - - - - '  
[_ ___________________________________________________________________________________ _] 
R 
Fig. 11.1 The objective of this chapter is the derivation of large-signal de and small-signal ac equivalent circuit 
models for converters operating in the discontinuous conduction mode. 
Since most converters operate in discontinuous conduction mode at some operating points, 
small-signal ac DCM models are needed, to prove that the control systems of such converters are cor-
rectly designed. In Section 11.2, a small-signal model of the DCM switch network is derived by linear-
ization of the loss-free resistor model. The transfer functions of DCM converters are quite different from 
their respective CCM transfer functions. The basic DCM buck, boost, and buck-boost converters essen-
tially exhibit simple single-pole transfer functions [12, 13], in which the second pole and the RHP zero 
(in the case of boost and buck-boost converters) are at high frequencies. So the basic converters operating 
in DCM are easy to control; for this reason, converters are sometimes purposely operated in DCM for all 
loads. The transfer functions of higher order converters such as the DCM Cuk or SEPIC are considerably 
more complicated; but again, one pole is shifted to high frequency, where it has negligible practical 
effect. This chapter concludes, in Section 11.3, with a discussion of a more detailed analysis used to pre-
dict high-frequency dynamics of DCM converters. The more detailed analysis predicts that the high-fre-
quency pole of DCM converters occurs at frequencies near or exceeding the switching frequency [2-6]. 
The RHP zero, in the case of DCM buck-boost and boost converters, also occurs at high frequencies. 
This is why, in practice, the high-frequency dynamics can usually be neglected in DCM. 
11.1 
DCMAVERAGED SWITCH MODEL 
Consider the buck-boost convet:ter of Fig. 11.2. Let us follow the averaged switch modeling approach of 
Section 7 .4, to derive an equivalent circuit that models the averaged terminal waveforms of the switch 
network. The general two-switch network and its terminal quantities v1(t), i1(t), vz(t), and i2(t) are defined 
as illustrated in Fig. 11.2, consistent with Fig. 7 .39(a). The inductor and switch network voltage and cur-
rent waveforms are illustrated in Fig. 11.3, for DCM operation. 
The inductor current is equal to zero at the beginning of each switching period. During the first 
subinterval, while the transistor conducts, the inductor current increases with a slope of v gCt)IL. At the 

11.1 
DCM Averaged Switch Model 
411 
Switch network 
.----llil-+f'..,'''''''''''''''''''''''''''''''''.-'''_---+-, ........ i2_~-----. 
+ 
+ 
C R 
+ 
L 
+ 
v 
Fig. 11.2 
Buck-boost converter example, with switch network terminal quantities identified. 
end of the first subinterval, the inductor current iL(t) attains the peak value given by 
(11.1) 
During the second subinterval, while the diode conducts, the inductor current decreases with a slope 
equal to v(t)IL. The second subinterval ends when the diode becomes reverse-biased, at time 
t = (di + d2)Ts. The inductor current then remains at zero for the balance of the switching period. The 
inductor voltage is zero during the third subinterval. 
A DCM averaged switch model can be derived with reference to the waveforms of Fig. 11.3. 
Following the approach of Section 7.4.2, let us find the average values of the switch network terminal 
waveforms vI (t), v2(t), i I (t), and iit) in terms of the converter state variables (inductor currents and 
capacitor voltages), the input voltage vgCt), and the subinterval lengths d1 and d2• 
The average switch network input voltage (vi(t))I:,' or the average transistor voltage, is found by 
averaging the vI (t) waveform of Fig. 11.3: 
Use of the identity d3(t) = 1 - di (t)- d2(t) yields 
Similar analysis leads to the following expression for the average diode voltage: 
( v2(t)) T, = d 1(t)( ( vg(t)) T,- ( v(t)) T,) + d2(t)·0 + d 3(t)(- ( v(t)) T,) 
= d 1(tl( vg(t)) T,- ( 1 - d2(t) )(v(t)) T, 
(11.2) 
(11.3) 
( 11.4) 
The average switch network input current (ii(t))T, is found by integrating the ii(t) waveform of Fig. 11.3 
over one switching period: 

412 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
i2(1) 
0 
v 
ipk 
(it(t))r l 
········-···-----~--~---·····---~--
(v1(t))r 
•••••••••••• ••••••• J ............ .......... . 
0 
ipk 
Area q2 1 
(i2(1))r 
l 
················-~-- --
···· ·~---···--· ···r········· .. f············· 
Fig. 11.3 Inductor and switch network 
voltage and current waveforms. 
( 11.5) 
The integral q1 is equal to the area under the i1(t) wave-
form during the first subinterval. This area is easily eval-
uated using the triangle area formula: 
(11.6) 
Substitution of Eqs. (11.1) and (11.6) into Eq. (11.5) 
gives: 
(11.7) 
Note that (i1(t))Ts is not equal to d1(iL(t))Ts" Since the 
inductor current ripple is not small, it is necessary to 
sketch the actual input current waveform, including the 
large switching ripple, and then correctly compute the 
average as in Eqs. (11.5) to ( 11.7). 
The average diode current (ilt))Ts is found in a manner 
similar to that used above for (i1(t))Ts: 
(11.8) 
The integral q2 is equal to the area under the ilt) wave-
form during the second subinterval. This area is evalu-
ated using the triangle area formula: 
(11.9) 
Substitution of Eqs. (11.1) and (11.9) into Eq. (11.8) 
leads to: 
(11.10) 
Equations (11.3), (11.4), (11.7) and (11.10) constitute 
the averaged terminal equations of the switch network in 
the DCM buck-boost converter. In these equations, it 
remains to express the subinterval length d2 in terms of 
the switch duty cycle d1 = d, and the converter averaged 
waveforms. One approach to finding the subinterval 
length d2 is by solving the inductor current waveform. In 
the buck-boost converter, the diode switches off when 
the inductor current reaches zero, at the end of the sec-

11.1 
DCM Averaged Switch Model 
413 
ond subinterval. As a result, iL(T,) = iL(O) = 0. There is no net change in inductor current over one com-
plete switching period, and no net volt-seconds are applied to the inductor over any complete switching 
period that starts at the time when the transistor is turned on. Therefore, the average inductor voltage 
computed over this period is zero, 
(11.11) 
even when the converter is not in equilibrium. This equation can be used to find the length of the second 
subinterval: 
(11.12) 
Substitution ofEq. (11.12) into Eqs. (11.3), (11.4), (11.7) and (11.10), allows us to obtain simple expres-
sions for the averaged terminal waveforms of the switch network in the discontinuous conduction mode: 
(11.13) 
(11.14) 
(11.15) 
(11.16) 
Let us next construct an equivalent circuit corresponding to the averaged switch network equations 
(11.15) and (11.16). The switch network input port is modeled by Eq. (11.15). This equation states that 
the average input current (i1(t))r, is proportional to the applied input voltage (v1(t))r,. In other words, the 
low-frequency components of the switch network input port obey Ohm's law: 
(11.17) 
where the effective resistance Re is 
(11.18) 
An equivalent circuit is illustrated in Fig. 11.4. During the first subinterval, the slope of the input current 
waveform i1(t) is proportional to the input voltage (vgCt))Ts = (v1(t))Ts' as illustrated in Fig. 11.3. As a 
result, the peak current ipk' the total charge ql' and the average input current (i1(t))r,.' are also proportional 
to (v 1(t))r,. Of course, there is no physical resistor inside the converter. Indeed, if the converter elements 
are ideal, then no heat is generated inside the converter. Rather, the power apparently consumed by Re is 
transferred to the switch network output port. 

414 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
Fig. 
11.4 Equivalent circuit that models the 
average waveforms of the switch input (transistor) 
port. 
+ 
The switch network output (diode) port is modeled by Eq. (11.16), or 
(11.19) 
Note that (v1(t))\!Re is the average power (p(t))T, apparently consumed by the effective resistor Rid1). 
Equation (11.19) states that this power flows out of the switch network output port. So the switch net-
work consumes no net power-its average input and output powers are equal. 
Equation ( 11.19) can also be derived by consideration of the inductor stored energy. During the 
first subinterval, the inductor current increases from 0 to ipk' In the process, the inductor stores the fol-
lowing energy: 
(11.20) 
Here, ipk has been expressed in terms of (v1(t))T, using Eqs. (11.1) and (11.13). This energy is transferred 
from the source v8, through the switch network input terminals (i.e., through the transistor), to the induc-
tor. During the second subinterval, the inductor releases all of its stored energy through the switch net-
work output terminals (i.e., through the diode), to the output. The average output power can therefore be 
expressed as the energy transferred per cycle, divided by the switching period: 
(11.21) 
This power is transferred to the load, and hence 
(11.22) 
This result coincides with Eq. (11.19). 
The average power (p(t))T, is independent of the load characteristics, and is determined solely 
by the effective resistance Re and the applied switch network input terminal voltage or current. In other 
words, the switch network output port behaves as a source of power, equal to the power apparently con-
sumed by the effective resistance Re. This behavior is represented schematically by the dependent power 
source symbol illustrated in Fig. 11.5. In any lossless two-port network, when the voltage and current at 
one port are independent of the characteristics of the external network connected to the second port, then 
the second port must exhibit a dependent power source characteristic [10]. This situation arises in anum-

11.1 
DCM Averaged Switch Model 
415 
i(t) 
(a) 
i(t) 
(b) 
v(t)i(t) = p(t) 
+ 
p(t) 
v(t) 
v(t) 
Fig. 11.5 The dependent power source: (a) schematic symbol, (b) i-v characteristic. 
ber of common power-processing applications, including switch networks operating in the discontinuous 
conduction mode. 
The power source characteristic illustrated in Fig. ll.S(b) is symmetrical with respect to voltage 
and current; in consequence, the power source exhibits several unique properties. Similar to the voltage 
source, the ideal power source must not be short-circuited; otherwise, infinite current occurs. And similar 
to the current source, the ideal power source must not be open-circuited, to avoid infinite terminal volt-
age. The power source must be connected to a load capable of absorbing the power p(t), and the operat-
ing point is defined by the intersection of the load and power source i-v characteristics. 
As illustrated in Fig. 11.6(a), series- and parallel-connected power sources can be combined 
(a) 
(b) 
Fig. 11.6 
Circuit manipulations of power source elements: (a) combination of series- and parallel- connected 
power sources into a single equivalent power source, (b) invariance of the power source to reflection through an ideal 
transformer of arbitrary turns ratio. 

416 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
(a) 
il (t) ,------------ -------------------, iit) 
+ 
+ 
( vz(t)) T 
s 
Fig. 11.7 (a) the general two-switch network, and (b) the corresponding averaged switch model in the discontinu-
ous conduction mode: the average transistor waveforms obey Ohm's law, while the average diode waveforms behave 
as a dependent power source. 
into a single power source, equal to the sum of the powers of the individual sources. Fig. 11.6(b) illus-
trates how reflection of a power source through a transformer, having an arbitrary turns ratio, leaves the 
power source unchanged. Power sources are also invariant to duality transformations. 
The averaged large-signal model of the general two-switch network in DCM is illustrated in 
Fig. 11.7(b). The input port behaves effectively as resistance Re. The instantaneous power apparently 
consumed by Re is transferred to the output port, and the output port behaves as a dependent power 
source. This lossless two-port network is called the lossjree resistor model (LFR) [9]. The loss-free 
resistor represents the basic power conversion properties of DCM switch networks [11]. It can be shown 
that the loss-free resistor models the averaged properties of DCM switch networks not only in the buck-
boost converter, but also in other PWM converters. 
When the switch network of the DCM buck-boost converter is replaced by the averaged model 
of Fig. 11.7(b), the converter equivalent circuit of Fig. 11.8 is obtained. Upon setting all averaged wave-
forms to their quiescent values, and letting the inductor and capacitor become a short-circuit and an 
open-circuit, respectively, we obtain the de model of Fig. 11.9. 
Systems containing power sources or loss-free resistors can usually be easily solved, by equat-
ing average source and load powers. For example, in the de network of Fig. 11.9, the power flowing into 
the converter input terminals is 
(11.23) 
+ 
( vz(t)) T 
s 
+ 
+ 
+ c 
R 
Fig. 11.8 Replacement of the switch network of the DCM buck-boost converter with the loss-free resistor model. 

11.1 
DCM Averaged Switch Model 
417 
Fig. 11.9 
De network example containing 
a loss-free resistor model. 
The power flowing into the load resistor is 
p 
.----------.-.. 
The loss-free resistor model states that these two powers must be equal: 
Solution for the voltage conversion ratio M = V/V8 yields 
+ 
R 
v 
(11.24) 
( 11.25) 
(11.26) 
Equation (11.26) is a general result, valid for any converter that can be modeled by a loss-free resistor 
and that drives a resistive load. Other arguments must be used to determine the polarity of V/V8. In the 
buck-boost converter shown in Fig. 11.2, the diode polarity indicates that V!Vg must be negative. The 
steady-state value of Re is 
(11.27) 
where D is the quiescent transistor duty cycle. Substitution of Eq. ( 11.27) into ( 11.26) leads to 
(11.28) 
with K = 2L!RTs. This equation coincides with the previous steady-state result given in Table 5.2. 
Similar arguments apply when the waveforms contain ac components. For example, consider 
the network of Fig. 11.10, in which the voltages and currents are periodic functions of time. The rms val-
il (t) 
iz(t) 
+ 
Fig. 
11.10 
Ac network example 
p(t) 
containing a loss-free resistor model. 
Re 
.....----.... 
c 
R 
v(t) 

418 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
ues of the waveforms can be determined by simply equating the average source and load powers. The 
average power flowing into the converter input port is 
(11.29) 
where Pav is the average power consumed by the effective resistance Re. No average power is consumed 
by capacitor C, and hence the average power Pav must flow entirely into the load resistor R: 
p = v;ms 
av 
R 
(11.30) 
Upon equating Eqs. (11.29) and (11.30), we obtain 
(11.31) 
Thus, the rms terminal voltages obey the same relationship as in the de case. 
Averaged equivalent circuits of the DCM buck, boost, and buck-boost converters, as well as the 
DCM Cuk and SEPIC converters, are listed in Fig. 11.11. In each case, the averaged transistor wave-
forms obey Ohm's law, and are modeled by an effective resistance Re. The averaged diode waveforms 
follow a power source characteristic, equal to the power effectively dissipated in Re. For the buck, boost, 
and buck-boost converters, Re is given by 
(11.32) 
For the Cuk and SEPIC converters, Re is given by 
(11.33) 
Here, dis the transistor duty cycle. 
Steady-state conditions in the converters of Fig. 11.11 are found by letting the inductors and 
capacitors become short-circuits and open-circuits, respectively, and then solving the resulting de circuits 
with d(t) = D. The buck-boost, Cuk, and SEPIC then reduce to the circuit of Fig. 1 1.9. The buck and 
boost converters reduce to the circuits of Fig. 11.12. Equilibrium conversion ratios M = V!Vg of these 
converters are summarized in Table 11.1, as functions of Re(D). It can be shown that these converters 
operate in the discontinuous conduction mode whenever the load current I is less than the critical current 
/crit: 
I > I cril for CCM 
I < I ceil for DCM 
For all of these converters, Icrit is given by 
1-D 
vg 
I ceil= ---y;-- R/D) 
(11.34) 
(11.35) 

11.1 
DCM Averaged Switch Model 
419 
Buck 
+ 
Boost 
+ 
Buck-boost 
+ 
c 
Cuk 
+ 
SEPIC 
+ 
R 
Fig. 11.11 
Averaged large-signal equivalent circuits of five basic converters operating in the discontinuous con-
duction mode. 

420 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
(a) 
+ 
R 
v 
(b) 
.---------r----i<4 ~~-----, + 
R 
v 
Fig. 11.12 
De equivalent circuits representing the buck (a) and boost (b) converters operating in DCM. 
Table 11.1 
CCM and DCM conversion ratios of basic converters 
Converter 
M,CCM 
M,DCM 
Buck 
D 
2 
1 +-/1 +4R)R 
Boost 
1 
1 + -/1 +4R/Re 
1-D 
2 
Buck-boost, Cuk 
-D 
-VI 
1-D 
Re 
SEPIC 
D 
VI 
1-D 
11.2 
SMALL-SIGNAL AC MODELING OF THE DCM SWITCH NETWORK 
The next step is construction of a small-signal equivalent circuit model for converters operating in the 
discontinuous conduction mode. In the large-signal ac equivalent circuits. of Fig. 11.11, the averaged 
switch networks are nonlinear. Hence, construction of a small-signal ac model involves perturbation and 
linearization of the loss-free resistor network. The signals in the large-signal averaged DCM switch net-
work model of Fig. 11.13(a) are perturbed about a quiescent operating point, as follows: 

11.2 
Small-Signal AC Modeling of the DCM Switch Network 
421 
(a) 
(i1(t))T 
(izCt))T 
s 
s 
+ 
(p(t)) T 
+ 
s 
.......------.. 
(vi(t))T 
R.(d) 
(vz<t))T 
s 
s 
r 
d(t) 
(b) 
+ 
+ 
Fig. 11.13 
Averaged models of the general two-switch network in a converter operating in DCM: (a) large-signal 
model, (b) small-signal model. 
d(t) = D + J(t) 
(vi(t))r =VI+ iW) 
s 
(ii(t))r =II +i1(t) 
s 
( V2(t)) Ts = V2 + Vit) 
(iit))r =12 +iit) 
s 
(11.36) 
Here, D is the quiescent value of the transistor duty cycle, V1 is the quiescent value of the applied average 
transistor voltage (v1(t))r,• etc. The quantities d(t), v1(t), etc., are small ac variations about the respective 
quiescent values. It is desired to linearize the average switch network terminal equations ( 11.15) and 
(11.16). 
Equations (11.15) and (11.16) express the average terminal currents (i1 (t))rs and (i2(t))Ts as func-
tions of the transistor duty cycle d(t) = d1(t) and the average terminal voltages (v1(t))Ts and (vz(t))Ts. Upon 
perturbation and linearization of these equations, we will therefore find that i1(t) and iz(t) are expressed 
as linear functions of d(t), v1(t), and v2(t). So the small-signal switch network equations can be written in 
the following form: 
(11.37) 
These equations describe the two-port equivalent circuit of Fig. 11.13(b ). 

422 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
The parameters rl' jl' and g 1 can be found by Taylor expansion of Eq. (11.15), as described in 
Section 7.2.7. The average transistor current (i1(t))T.,' Eq. (11.15), can be expressed in the following form: 
(11.38) 
Let us expand this expression in a three-dimensional Taylor series, about the quiescent operating point 
(Vp V2, D): 
(11.39) 
+ higher-order nonlinear terms 
For simplicity of notation, the angle brackets denoting average values are dropped in the above equation. 
The de terms on both sides of Eq. (11.39) must be equal: 
(11.40) 
As usual, we linearize the equation by discarding the higher-order nonlinear terms. The remaining first-
order linear ac terms on both sides of Eq. ( 11.39) are equated: 
where 
1 
RJD) 
1 _ a.t;( vl, v2, d) I 
__ ____\'L aR/dl I 
1 -
ad 
d = D-
R;(D) 
ad 
d = D 
2V1 
DRJD) 
(ll.41) 
(11.42) 
( 11.43) 
(11.44) 
Thus, the small-signal input resistance r1 is equal to the effective resistance Re, evaluated at the quiescent 
operating point. This term describes how variations in (v1(t))r, affect (i1(t))r,• via Re(D). The small-signal 

11.2 
Small-Signal AC Modeling of the DCM Switch Network 
423 
parameter g1 is equal to zero, since the average transistor current (i1(t))Ts is independent of the average 
diode voltage (v2(t))T.. The small-signal gain j 1 describes how duty cycle variations, which affect the 
value of R.(d), lead t~ variations in (i1(t))r,-
In a similar manner, (i2(t))rs from Eq. (11.16) can be expressed as 
(11.45) 
Expansion of the functionfz(vp v2, d) in a three-dimensional Taylor series about the quiescent operating 
point leads to 
( 11.46) 
+ higher-order nonlinear terms 
By equating the de terms on both sides ofEq. (11.46), we obtain 
(11.47) 
The higher-order nonlinear terms are discarded, leaving the following first-order linear ac terms: 
(11.48) 
with 
(11.49) 
(11.50) 
j _ ilfz(Vt, Vz,d) I 
--~ 
dRe(d) I 
2 -
dd 
d = D-
R;(D) V2 
dd 
d = D 
(11.51) 
2V1 
DMReCD) 
The output resistance r2 describes how variations in (vz(t))rs influence (i2(t))r,- As illustrated in Fig. 11.14, 

424 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
Fig. 11.14 The small-signal output resistance 
r2 is determined by the slope of the power 
source characteristic at the quiescent operating 
point. 
Table 11.2 Small-signal DCM switch model parameters 
Switch network 
gl 
jl 
rl 
General 
2V1 
two-switch, 
0 
Re 
Fig. 11.7(a) 
DR. 
Buck, 
1 
2(1-M)V1 
R. 
Fig. 11.16( a) 
R. 
DR. 
Boost, 
1 
2MV1 
(M -1)2 R 
Fig. 11.16(b) 
(M -1)2 R. 
D(M -1)R. 
M2 
· e 
g2 
2 
MRe 
2-M 
MR. 
2M-1 
(M -1)2 R. 
Load 
characteristic 
1 R 
(v2(t))T 
s 
j2 
r2 
2V1 
M2Re 
DMR. 
2(1-M)V1 
M2Re 
DMR. 
2V1 
(M -1)2R. 
D(M -1)R. 
r2 is determined by the slope of the power source characteristic, evaluated at the quiescent operating 
point. For a linear resistive load, r2 = R. For any type of load, it is true that r2 = M2R.(D). The parameters 
j 2 and g2 describe how variations in the duty cycle d(t) and in the average transistor voltage (v1(t))Ts 
(which influence the average power (p(t))Ts) lead to variations in the average diode current (i2(t))Ts. Values 
of the small-signal parameters in the DCM switch model of Fig. 11.13(b) are summarized in the top row 
of Table 11.2. 
A small-signal model of the DCM buck-boost converter is obtained by replacing the transistor 
and diode of the converter with the switch model of Fig. 11.13(b). The result is illustrated in Fig. 11.15. 
This equivalent circuit can now be solved using conventional linear circuit analysis techniques, to deter-
mine the transfer functions and other small-signal quantities of interest. 
The same small-signal switch model can be employed to model other DCM converters, by sim-
ply replacing the transistor and diode with ports 1 and 2, ,respectively, of the two-port model of 
Fig. 11.13(b ). An alternative approach, which yields more convenient results in the analysis of the buck 
and boost converters, is to define the switch network as illustrated in Figs. 11.16(a) and 11.16(b), respec-
tively. These switch networks can also be modeled using the two-port small-signal equivalent circuit of 
Fig. 11.16(c); however, new expressions for the parameters rl'jl' gl' etc., must be derived. These expres-
sions are again found by linearizing the equations of the averaged switch network terminal currents. 

11.2 
Small-Signal AC Modeling of the DCM Switch Network 
425 
Switch network small-signal ac model 
il 
r··-----------------------------------------------------------------------------------------------------------------------------------------------------~ i2 
+ 
+ 
i) 
+ 
g 
-
c 
R 
L--------------------------------·-------------·----------------------------------------------·------------------------------------------------------_1 
L 
Fig. 11.15 
Small-signal ac model of the DCM buck-boost converter obtained by insertion of the switch network 
two-port small-signal model into the original converter circuit. 
(a) 
(b) 
(c) 
+ 
+ 
Fig. 11.16 
A convenient way to model the switch networks of DCM buck and boost converters: (a) defined termi-
nal quantities of the DCM buck switch network, (b) defined terminal quantities of the boost switch network, (c) two-
port small-signal ac model. The model parameters are given in Table 11.2. 
Table 11.2 lists the small-signal parameters for the buck switch network of Fig. 11.16(a) (middle row) 
and for the boost switch network of Fig. 11.16(b) (bottom row). Insertion of the small-signal two-port 
model into the DCM buck and boost converters leads to the equivalent circuits of Fig. 11.17. 
The small-signal equivalent circuit models of Fig. 11.15 and Fig. 11.17 contain two dynamic 
elements: capacitor C and inductor L. Control-to-output transfer functions obtained by solving these 
equivalent circuit models have two poles. It has been shown [2-6] that one of the poles, due to the capac-
itor C, appears at a low frequency, while the other pole (and a RHP zero in the case of boost and buck-

426 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
(a) 
• 
DCM buck switch network small-signal ac model 
• 
j I 
;----------------------------------------------------------------------------------------------------------------------------------] 12 
+ 
+ 
+ 
R 
DCM boost switch network small-signal ac model 
• 
it r·-------------------------------------------------------------------------------------------------------------------1 l2 
+ 
+ 
+ 
R 
1...·--------·-·--····-------------···-·--------·-···-------·-----------------·----------------·-----------··-------------' 
Fig. 11.17 Small-signal ac models of (a) the DCM buck converter, and (b) the DCM boost converter, obtained by 
replacing the switch networks defined in Fig. 11.16(a) and (b) with the small-signal switch model of Fig. 11.16(c). 
boost converters) due to the inductor L, occurs at much higher frequency, close to the converter switching 
frequency. Therefore, in practice, the DCM buck, boost, and buck-boost converters exhibit essentially 
single-pole transfer functions, which are negligibly influenced by the inductor dynamics. 
The small-signal equivalent circuit models have been derived in this section from the large-sig-
nal averaged switch network equations (11.15) and (11.16). These equations are based on Eq. (11.11), 
which states that the average inductor voltage, and therefore its small-signal ac voltage, is zero. This con-
tradicts predictions of the resulting small-signal models in Figs. 11.15 and 11.17. As a result, we expect 
that the models derived in this section can be used to predict low-frequency dynamics, while predictions 
of the high-frequency dynamics due to the inductor L are of questionable validity. Equivalent circuit 
models that give more accurate predictions of high-frequency dynamics of DCM converters are dis-
cussed in Section 11.3. 
A simple approximate way to determine the low-frequency small-signal transfer functions of 
the buck, boost, and buck-boost converters is to let the inductance L tend to zero. If L is shorted in the 
equivalent circuits of Figs. 11.15 and 11.17, the model in all three cases reduces to Fig. 11.18. This cir-
DCM switch network small-signal ac model 
r·---------------------------------------------------------------------------------------------------------------------------------·----------------------1 
+ 
c 
R 
v 
Fig. 11.18 Low-frequency ac model obtained by letting L approach zero. The buck, boost, or buck-boost convert-
ers can be modeled, by employing the appropriate parameters from Table 11.2. 

11.2 
Small-Signal AC Modeling of the DCM Switch Network 
421 
cuit is relatively easy to solve. 
The control-to-output transfer function Gvis) is found by letting vg = 0 in Fig. 11.18. Solution 
for v then leads to 
with 
Gdo = J2(RIIr2) 
(,\) =--'-
p 
(RIIr2)C 
( 11.52) 
(11.53) 
The line-to-output transfer function Gv/s) is found by letting d = 0 in Fig. 11.18. One then obtains 
(11.54) 
with 
( 11.55) 
Expressions for Gdo• G80, and WP are listed in Table 11.3, for the DCM buck, boost, and buck-boost con-
verters with resistive loads [12,13]. 
The ac modeling approach described in this section is both general and useful. The transistor 
and diode of a DCM converter can be simply replaced by the two-port network of Fig. 11.13(b ), leading 
to the small-signal ac model. Alternatively, the switch network can be defined as in Fig. 11.16(a) or 
11.16(b), and then modeled by the same two-port network, Fig. 11.16(c). The small-signal converter 
model can then be solved via conventional circuit analysis techniques, to obtain the small-signal transfer 
functions of the converter. 
Table 11.3 
Salient features of DCM converter small-signal transfer functions 
Converter 
Gdo 
Ggo 
(,\)p 
Buck 
2V 1-M 
M 
2-M 
D2-M 
(1-M)RC 
Boost 
2V M-1 
M 
2M -1 
D2M-1 
(M-l)RC 
Buck-boost 
v 
M 
2 
75 
RC 

428 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
11.2.1 
Example: Control-to-Output Frequency Response 
of a DCM Boost Converter 
As a simple numerical example, let us find the small-signal control-to-output transfer function of a DCM 
boost converter having the following element and parameter values: 
R= 12Q 
L=5J.tH 
C =470J.tF 
j, =100kHz 
(11.56) 
The output voltage is regulated to be V = 36 V. It is desired to determine Gvis) at the operating point 
where the load current is I= 3 A and the de input voltage is V8 = 24 V. 
The effective resistance Re(D) is found by solution of the de equivalent circuit of Fig. 11.12(b ). 
~ince the load current I and the input and output voltages V and V8 are known, the power source value P 
IS 
P = I ( V - V8) = ( 3 A) ( 36 V - 24 V) = 36 W 
The effective resistance is therefore 
v2 
2 
R ------"-- (24 V) - 16 Q 
,- P -
36W -
The steady-state duty cycleD can now be found using Eq. (11.32): 
D=fll:i = 
2(5 J.tH) 
(16 Q)(lO J.tS) = 0·25 
The expressions given in Table 11.3 for G dO and WP of the boost converter can now be evaluated: 
( (36V) 
1) 
G - 2V M- 1 - 2(36 V) 
(24V)-
72 V ~ 37 dBV 
dO- D 2M - 1 -
(0.25) ( (36 V) 
) 
2 (24 V) - 1 
(2 (36 V) _ 1) 
w 
(24 V) 
t, 
P 
2M - 1 
= 112Hz 
· P = 2n = 2n(M- 1)RC 
( (36 V) 
) 
2n (24 V)- 1 (12 Q)(470 J.tF) 
( 11.57) 
( 11.58) 
(11.59) 
(11.60) 
A Bode diagram of the control-to-output transfer function is constructed in Fig. 11.19. The solid lines 
illustrate the magnitude and phase predicted by the approximate single-pole model of Fig. 11.18. The 
dashed lines are the predictions of the more accurate model discussed in Section 11.3, which include a 
second pole atf2 =64kHz and a RHP zero atfz = 127kHz, arising from the inductor dynamics. Since the 
switching frequency is 100 kHz, the accuracy of the model at these frequencies cannot be guaranteed. 
Nonetheless, in practice, the lagging phase asymptotes arising from the inductor dynamics can be 

11.2 
Small-Signal AC Modeling of the DCM Switch Network 
429 
60dBV 
II Gvd II 
40dBV 
Gdo => 37 dBV 
II Gvd II 
20dBV 
OdBV 
0" 
-20dBV 
-40dBV 
--.,.---=,.....------+ -90" 
···· ... 
-180' 
4--------+-----+-----r-------+ -270' 
10Hz 
100Hz 
1kHz 
lOkHz 
100kHz 
f 
Fig. 11.19 
Magnitude and phase of the control-to-output transfer function, DCM boost example. Solid lines: func-
tion and its asymptotes, approximate single-pole response predicted by the model of Fig. 11.18. Dashed lines: more 
accurate response that includes high-frequency inductor dynamics. 
observed beginning atj2/10 = 6.4 kHz. 
11.2.2 
Example: Control-to-Output Frequency Responses 
of a CCM/DCM SEPIC 
As another example, consider the SEPIC of Fig. 11.20. According to Eq. (11.34), this converter operates 
in CCM if 
(11.61) 
where R.(D) is given by Eq. ( 11.33 ). Upon neglecting losses in the converter, one finds that the CCM 
conversion ratio is 
(11.62) 
When Eqs. (11.33) and (11.62) are substituted into Eq. (11.61), the condition for operation in CCM 
becomes: 
(11.63) 
The converter control-to-output frequency responses are generated using Spice ac simulations. Details of 

430 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
(a) 
~ 
ill Ql 
D = 0.4 
f, =100kHz 
Fig. 11.20 SEPIC example. 
80dBV 
60dBV 
40dBV 
20dBV 
OdBV 
R =40Q 
-20dBV 
-40dBV 
200i!F 
+ 
R 
v 
load 
-90" 
-180" 
+--------<c------+---~---+------+ -270" 
5Hz 
50Hz 
500Hz 
5kHz 
50 kHz 
f 
Fig. 11.21 
Magnitude and phase of the control-to-output transfer function obtained by simulation of the SEPIC 
example shown in Fig. 11.20, for two values of the load resistance: R = SOQ when the converter operates in DCM 
(solid lines), and R = 40Q for which the converter operates in CCM (dashed lines). 
the simulation setup are described in Appendix B, Section B.2.1. Figure 11.21 shows magnitude and 
phase responses of the control-to-output transfer function obtained for two different values of the load 
resistance: R = 40 Q, for which the converter operates in CCM, and R = 50 Q, for which the converter 
operates in DCM. For these two operating points, the quiescent (de) voltages and currents in the circuit 
are nearly the same. Nevertheless, the frequency responses are qualitatively very different in the two 
operating modes. In CCM, the converter exhibits a fourth-order response with two pairs of high-Q com-
plex-conjugate poles and a pair of complex-conjugate zeros. Another RHP (right-half plane) zero can be 
observed at frequencies approaching 50 kHz. In DCM, there is a dominant low-frequency pole followed 

11.3 High-Frequency Dynamics of Converters in DCM 
431 
by a pair of complex-conjugate poles and a pair of complex-conjugate zeros. The frequencies of the com-
plex poles and zeros are very close in value. A high-frequency pole and a RHP zero contribute additional 
phase lag at higher frequencies. 
11.3 
HIGH-FREQUENCY DYNAMICS OF CONVERTERS IN DCM 
As discussed in Section 11.2, transfer functions of converters operating in discontinuous conduction 
mode exhibit a dominant low-frequency pole. A pole and possibly a zero caused by inductor dynamics, 
are pushed to high frequencies. To correctly model the high-frequency dynamics ofDCM converters, one 
must account for the fact that the ac voltage across the inductor is not zero. Equation ( 11.12) is employed 
in Section 11.1 to greatly simplify the equations of the DCM averaged switch model. Although this 
model gives good results at low frequencies, it cannot accurately predict high frequency inductor dynam-
ics because it implies that the ac inductor voltage is zero. 
A more accurate approach is employed in this section. The subinterval length d2 is found by 
averaging the inductor current waveform iL(t) of Fig. 11.3 [4-6]: 
(11.64) 
Solution for dit) yields: 
( 11.65) 
Equation (11.65), together with Eqs. (11.3), (11.4), (11.7), and (11.10), constitutes a large-signal aver-
aged model in DCM that can be used to investigate steady-state behavior, as well as low-frequency and 
high-frequency dynamics. Unfortunately, the model equations are more involved, and do not allow elim-
ination of all converter voltages and currents in terms of the switch network average terminal waveforms. 
Let us use this model to find predictions for the high-frequency pole caused by the inductor 
dynamics of DCM converters. Consider the buck-boost converter of Fig. 11.2 having the DCM wave-
forms shown in Fig. 11.3. The average transistor voltage (v1(t))7;· and the average diode current (i2(t))T, 
are selected as the switch network dependent variables. Substitution of Eq. (11.65) into Eq. (11.3) yields 
(11.66) 
The averaged switch voltage (v1(t))7;· in Eq. (11.66) is a nonlinear function of the switch duty cycle, the 
average inductor current, and the average input and output voltages: 
(11.67) 
A small-signal ac model can be obtained by Taylor expansion of Eq. (11.67). The small-signal ac compo-
nent v1 of the average switch voltage can be found as: 

432 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
+ 
+ 
+ 
C 
R 
L 
Fig. 11.22 A small -signal ac model of the DCM bock -boost converter. 
( 11.68) 
where the small-signal model parameters kg, kv, rp andf1 are computed as partial derivatives ofy1 evalu-
ated at the quiescent operating point. In particular, 
( 11.69) 
Substitution of Eq. (11.65) into Eq. (11.10) yields 
(11.70) 
The small-signal ac component 12 of the average diode current can be found as: 
(11.71) 
where the small-signal model parameters gg, h2, andj2 are computed as partial derivatives ofy2 evaluated 
at the quiescent operating point. Figure 11.22 shows the small-signal ac model of the buck-boost con-
verter, where the transistor and the diode switch are replaced by the sources specified by Eqs. ( 11.68) and 
(11.71), respectively. It can be shown that this model predicts essentially the same low-frequency 
dynamics as the model derived in Section 11.2. 
To find the control-to-output transfer function, we set Og = 0. At high frequencies, the small-sig-
nal ac component of the capacitor voltage is very small, 0 "' 0. Therefore, the contribution of the depen-
dent source kvO can be neglected at high frequencies. Then, from the equivalent circuit model of 
Fig. 11.22, we have 
(11.72) 
Equation (11.72) can be solved for the control-to-inductor current transfer function at high frequencies: 

11.3 
High-Frequency Dynamics of Converters in DCM 
433 
(11.73) 
where the pole frequency f2 is given by 
(11.74) 
To simplify the expression for the pole frequency f 2, we use the steady-state relationship that follows 
from Eq. (11.12): 
(11.75) 
Also, recall that the steady-state equivalent resistance Re(D) can be written as 
(11.76) 
where fs is the switching frequency. Upon substitution of Eqs. (11.69), (11.75) and (11.76) into 
Eq. (11.74) we get: 
, _ __£_ 
12- nDz 
(11.77) 
This is an expression for the frequency f2 of the high-frequency pole that is caused by the inductor 
dynamics of the DCM buck-boost converter. It can be shown that Eq. (11.77) is a general result for the 
high-frequency pole, valid for all basic converters operating in DCM. Since 0 < D2 < 1, Eq. (11.77) 
implies that the high-frequency pole is always greater than approximately one third of the switching fre-
quency. 
Table 11.4 summarizes the expressions for the high-frequency pole ffi2 and the RHP zero (l)z 
caused by the inductor dynamics in control-to-output transfer functions Gvis) of basic DCM converters 
[6]. The high-frequency pole and the RHP zero occur at frequencies close to or exceeding the switching 
frequency fs. This is why, in practice, the high-frequency inductor dynamics can usually be neglected. 
Table 11.4 High-frequency pole and RHP zero of the DCM converter control-to-output transfer function GvJs) 
Converter 
High-frequency pole w2 
RHP zero w, 
Buck 
2M f.. 
none 
D(l-M) 
Boost 
2(M- 1)/, 
2fs 
D 
D 
Buck-boost 
21Mifs 
2!, 
-D-
D 

434 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
11.4 
SUMMARY OF KEY POINTS 
1. 
In the discontinuous conduction mode, the average transistor voltage and cunent are proportional, and 
hence obey Ohm's law. An averaged equivalent circuit can be obtained by replacing the transistor with an 
effective resistor R_(d). The average diode voltage and cunent obey a power source characteristic, with 
power equal to the power effectively dissipated by Re. In the averaged equivalent circuit, the diode is 
replaced with a dependent power source. 
2. 
The two-port lossless network consisting of an effective resistor and power source, which results from 
averaging the transistor and diode waveforms of DCM converters, is called a loss-free resistor. This net-
work models the basic power-processing functions of DCM converters, much in the same way that the 
ideal de transformer models the basic functions of CCM converters. 
3. 
The large-signal averaged model can be solved under equilibrium conditions to determine the quiescent 
values of the converter currents and voltages. Average power arguments can often be used. 
4. 
A small-signal ac model for the DCM switch network can be derived by perturbing and linearizing the 
loss-free resistor network. The result has the form of a two-port y-parameter model. The model describes 
the small-signal variations in the transistor and diode currents, as functions of variations in the duty cycle 
and in the transistor and diode ac voltage variations. 
5. 
To simplify the ac analysis of the DCM buck and boost converters, it is convenient to define two other 
forms of the small-signal switch model, corresponding to the switch networks of Figs. 11.16(a) and 
11.16(b ). These models are also y-parameter two-port models, but have different parameter values. 
6. 
The inductor dynamics of the DCM buck, boost, and buck-boost converters occur at high frequency, above 
or just below the switching frequency. Hence, in most cases the high frequency inductor dynamics can be 
ignored. In the small-signal ac model, the inductance L is set to zero, and the remaining model is solved 
relatively easily for the low-frequency converter dynamics. The DCM buck, boost, and buck-boost con-
verters exhibit transfer functions containing essentially a single low-frequency dominant pole. 
7. 
To obtain a more accurate model of the inductor dynamics in DCM, it is necessary to write the equations 
of the averaged inductor waveforms in a way that does not assume that the average inductor voltage is 
zero. 
REFERENCES 
[1] 
V. VORPERIAN, R. TYMERSKI, and F. C. LEE, "Equivalent Circuit Models for Resonant and PWM 
Switches," IEEE Transactions on Power Electronics, Vol. 4, No.2, pp. 205-214, Apri\1989. 
[2] 
V. VORPERIAN, "Simplified Analysis of PWM Converters Using the Model of the PWM Switch," parts I 
and II, IEEE Transactions on Aerospace and Electronic Systems, Vol. 26, No.3, May 1990, pp. 490-505. 
[3] 
D. MAKSIMOVIC and S. CUK, "A Unified Analysis of PWM Converters in Discontinuous Modes," IEEE 
Transactions on Power Electronics, Vol. 6, No.3, pp. 476-490, July 1991. 
[4] 
J. SUN, D. M. MITCHELL, M. GREUEL, P. T. KREIN, and R. M. BASS, "Averaged Modelling of PWM Con-
verters in Discontinuous Conduction Mode: a Reexamination," IEEE Power Electronics Specialists Con-
ference, 1998 Record, pp. 615-622, June 1998. 
[5] 
S. BEN-Y AAKOV and D. ADAR, "Average Models as Tools for Studying Dynamics of Switch Mode 
DC-DC Converters," IEEE Power Electronics Specialists Conference, 1994 Record, pp. 1369-1376, June 
1994. 

Problems 
435 
[6] 
J. SUN, D. M. MITCHELL, M. GREUEL, P. T. KREIN, and R. M. BASS, "Average Models for PWM Convert-
ers in Discontinuous Conduction Mode," Proceedings of the 1998 International High Frequency Power 
Coversion Conference (HFPC'98), pp. 61-72, November 1998. 
[7] 
A. WITULSKI and R. ERICKSON, "Extension of State-Space Averaging to Resonant Switches -and 
Beyond," IEEE Transactions on Power Electronics, Vol. 5, No. 1, pp. 98-109, January 1990. 
[8] 
S. FREELAND and R. D. MIDDLEBROOK, "A Unified Analysis of Converters with Resonant Switches," 
IEEE Power Electronics Specialists Conference, 1987 Record, pp. 20-30, June 1987. 
[9] 
S. SINGER, "Realization of Loss-Free Resistive Elements," IEEE Transactions on Circuits and Systems, 
Vol. CAS-36, No. 12, January 1990. 
[10] 
S. SINGER and R.W. ERICKSON, "Power-Source Element and Its Properties," lEE Proceedings-Circuits 
Devices and Systems, Vol. 141, No.3, pp. 220-226, June 1994. 
[11] 
S. SINGER and R. ERICKSON, "Canonical Modeling of Power Processing Circuits Based on the POPI Con-
cept," IEEE Transactions on Power Electronics, Vol. 7, No. 1, January 1992. 
[12] 
S. CUK and R. D. MIDDLEBROOK, "A General Unified Approach to Modeling Switching De-to-De Con-
verters in Discontinuous Conduction Mode," IEEE Power Electronics Specialists Conference, 1977 
Record, pp. 36-57. 
[13] 
S. CUK, "Modeling, Analysis, and Design of Switching Converters," Ph.D. Thesis, California Institute of 
Technology, November 1976. 
PROBLEMS 
11.1 
Averaged switch modeling of a flyback converter. The converter of Fig. 11.23 operates in the discontinu-
ous conduction mode. The two-winding inductor has a 1:n turns ratio and negligible leakage inductance, 
and can be modeled as an ideal transformer in parallel with primary-side magnetizing inductance LP. 
(a) 
Sketch the transistor and diode voltage and current waveforms, and derive expressions for their 
average values. 
(b) 
Sketch an averaged model for the converter that includes a loss-free resistor network, and give 
an expression for R.(d). 
(c) 
Solve your model to determine the voltage ratio VIV8 in the discontinuous conduction mode. 
(d) 
Over what range of load current/ is your answer of part (c) valid? Express the DCM boundary in 
the form I< lcrilD, Re, V8, n). 
(e) 
Derive an expression for the small-signal control-to-output transfer function Gvd(s). You may 
neglect inductor dynamics. 
11.2 
Averaged switch modeling of a nonisolated Watkins-Johnson converter. The converter of Fig. 11.24 
operates in the discontinuous conduction mode. The two-winding inductor has a 1:1 turns ratio and neg-
ligible leakage inductance, and can be modeled as an ideal transformer in parallel with magnetizing 
inductance L. 
(a) 
Sketch the transistor and diode voltage and current waveforms, and derive expressions for their 
average values. 
(b) 
Sketch an averaged model for the converter that includes a loss-free resistor network, and give 
an expression for Re(d). 

436 
AC and DC Equivalent Circuit Modeling of the Discontinuous Conduction Mode 
+ 
c 
R 
v 
+ 
Fig. 11.23 
Fly back converter, Problem 11.1. 
+ 
+ 
c 
R 
v 
Fig. 11.24 Watkins-Johnson converter, Problem 11.2. 
(c) 
Solve your model to determine the converter conversion ratio M(D) = VNg in the discontinuous 
conduction mode. Over what range of load currents is your expression valid? 
11.3 
Sketch the steady-state output characteristics of the buck-boost converter: plot the output voltage V vs. 
the load current/, for several values of duty cycle D. Include both CCM and DCM operation, and clearly 
label the boundary between modes. 
11.4 
In the network of Fig. 11.25, the power source waveform p(t) is given by 
p(t) = 1000 cos2 377! 
The circuit operates in steady state. Determine the rms resistor voltage VR,rms· 
11.5 
Verify the expressions for G dO and wp given in Table 11.3. 
11.6 
A certain buck converter operates with an input voltage of Vg = 28 V and an output voltage of V = 15 V. 
The load resistance is R =lOQ. Other element and parameter values are: L = 8~-tH, C = 220~-tF, 
fs =150kHz. 
(a) 
Determine the value of Re. 
(b) 
Determine the quiescent duty cycle D. 
(c) 
Sketch a Bode plot of the control-to-output transfer function Gvd(s). Label the values of all 
salient features. You may neglect inductor dynamics. 
11.7 
Using the approach of Section 11.3, determine the control-to-output transfer function Gvd(s) of a boost 
converter. Do not make the approximation L"' 0. 

p(t) 
Fig. 11.25 
Network with a power source, Problem 11.4. 
Cz 
300 i!F 
R 
20Q 
Problems 
437 
+ 
(a) 
Derive analytical expressions for the de gain G dO and the RHP zero frequency w2, as functions of 
M, Re, D, Vg, L, C, and R. 
(b) 
With the assumption that C is sufficiently large and that L is sufficiently small, the poles of 
Gvis) can be factored using the low-Q approximation. Do so, and express the two poles as func-
tions of M, D, L, C, and R. Show that the low-frequency pole matches the expression in 
Table 11.3, and that the high-frequency pole is given by the expression in Table 11.4. 

12 
Current Programmed Control 
So far, we have discussed duty ratio control of PWM converters, in which the converter output is con-
trolled by direct choice of the duty ratio d(t). We have therefore developed expressions and small-signal 
transfer functions that relate the converter waveforms and output voltage to the duty ratio. 
Another control scheme, which finds wide application, is current programmed control [1-13], 
in which the converter output is controlled by choice of the peak transistor switch current peak(i,(t)). The 
control input signal is a current ic(t), and a simple control network switches the transistor on and off, such 
that the peak transistor current follows iJt). The transistor duty cycle d(t) is not directly controlled, but 
depends on iJt) as well as on the converter inductor currents, capacitor voltages, and power input volt-
age. Converters controlled via current programming are said to operate in the current programmed mode 
(CPM). 
The block diagram of a simple current programmed controller is illustrated in Fig. 12.1. Control 
signal iJt) and switch current i,(t) waveforms are given in Fig. 12.2. A clock pulse at the Set input of a 
latch initiates the switching period, causing the latch output Q to be high and turning on the transistor. 
While the transistor conducts, its current i,(t) is equal to the inductor current iL(t); this current increases 
with some positive slope m1 that depends on the value of inductance and the converter voltages. In more 
complicated converters, i,(t) may follow the sum of several inductor currents. Eventually, the switch cur-
rent i,(t) becomes equal to the control signal ic(t). At this point, the controller turns the transistor switch 
off, and the inductor current decreases for the remainder of the switching period. The controller must 
measure the switch current (.(t) with some current sensor circuit, and compare i,(t) to i/t) using an ana-
log comparator. In practice, voltages proportional to i,(t) and i,(t) are compared, with constant of propor-
tionality Rr When i,(t) :2: iJt), the comparator resets the latch, turning the transistor off for the remainder 
of the switching period. 
As usual, a feedback loop can be constructed for regulation of the output voltage. The output 
voltage v(t) is compared to a reference voltage v,ef' to generate an error signal. This error signal is applied 

440 
Current Programmed Control 
Measure 
switch 
current 
Control 
input 
is(t) 
Analog 
comparator 
LL 
0 
T, 
c 
Latch 
Current-programmed controller 
+ 
v(t) 
Conventional output voltage controller 
R 
r---------------------------------------------------------------------------------1 
I 
~~ I 
L----+-1 
I 
! 
j 
[ __________________________________________________________________________________ : 
Fig. 12.1 
Current-programmed control of a buck converter. The peak transistor current replaces the duty cycle as 
the control input. 
Fig. 12.2 
Switch current i,(t) and 
control input iJt) waveforms, for the 
current-programmed system ofFig. 
12.1. 
0 
Transistor : 
status: 1 
t 
Clock turns 
transistor on 
on 
Control signal 
ic(t) 
current 
is(t) 
dTs 
t 
Comparator turns 
transistor off 
off 

12.1 
Oscillation forD> 0.5 
441 
to the input of a compensation network, and the output of the compensator drives the control signal 
ic(t)Rr To design such a feedback system, we need to model how variations in the control signal Vt) and 
in the line input voltage v lt) affect the output voltage v(t). 
The chief advantage of the current programmed mode is its simpler dynamics. To first order, the 
small-signal control-to-output transfer function v(s)!ic(s) contains one less pole than v(s)fd(s). Actually, 
this pole is moved to a high frequency, near the converter switching frequency. Nonetheless, simple 
robust wide-bandwidth output voltage control can usually be obtained, without the use of compensator 
lead networks. It is true that the current programmed controller requires a circuit for measurement of the 
switch current i/t); however, in practice such a circuit is also required in duty ratio controlled systems, 
for protection of the transistor against excessive currents during transients and fault conditions. Current 
programmed control makes use of the available current sensor information during normal operation of 
the converter, to obtain simpler system dynamics. Transistor failures due to excessive switch current can 
then be prevented simply by limiting the maximum value of ic(t). This ensures that the transistor will tum 
off whenever the switch current becomes too large, on a cycle-by-cycle basis. 
An added benefit is the reduction or elimination of transformer saturation problems in full-
bridge or push-pull isolated converters. In these converters, small voltage imbalances induce a de bias in 
the transformer magnetizing current; if sufficiently large, this de bias can saturate the transformer. The de 
current bias increases or decreases the transistor switch currents. In response, the current programmed 
controller alters the transistor duty cycles, such that transformer volt-second balance tends to be main-
tained. Current-programmed full-bridge isolated buck converters should be operated without a capacitor 
in series with the transformer primary winding; this capacitor tends to destabilize the system. For the 
same reason, current-programmed control of half-bridge isolated buck converters is generally avoided. 
A disadvantage of current programmed control is its susceptibility to noise in the i,(t) or iJt) 
signals. This noise can prematurely reset the latch, disrupting the operation of the controller. In particu-
lar, a small amount of filtering of the sensed switch current waveform is necessary, to remove the tum-on 
current spike caused by the diode stored charge. Addition of an artificial ramp to the current-programmed 
controller, as discussed in Section 12.1, can also improve the noise immunity of the circuit. 
Commercial integrated circuits that implement current programmed control are widely avail-
able, and operation of converters in the current programmed mode is quite popular. In this chapter, con-
verters operating in the current programmed mode are modeled. In Section 12.1, the stability of the 
current programmed controller and its inner switch-current-sensing loop is examined. It is found that this 
controller is unstable whenever converter steady-state duty cycleD is greater than 0.5. The current pro-
grammed controller can be stabilized by addition of an artificial ramp signal to the sensed switch current 
waveform. In Section 12.2, the system small-signal transfer functions are described, using a simple first-
order model. The averaged terminal waveforms of the switch network can be described by a simple cur-
rent source, in conjunction with a power source element. Perturbation and linearization leads to a simple 
small-signal model. Although this first-order model yields a great deal of insight into the control-to-out-
put transfer function and converter output impedance, it does not predict the line-to-output transfer func-
tion Gv/s) of current-programmed buck converters. Hence, the model is refined in Section 12.3. Section 
12.4 extends the modeling of current programmed converters to the discontinuous conduction mode. 
12.1 
OSCILLATION FORD> 0.5 
The current programmed controller of Fig. 12.1 is unstable whenever the steady-state duty cycle is 
greater than 0.5. To avoid this stability problem, the control scheme is usually modified, by addition of an 
artificial ramp to the sensed switch current waveform. In this section, the stability of the current pro-
grammed controller, with its inner switch-current-sensing loop, is analyzed. The effects of the addition of 

442 
Current Programmed Control 
Fig. 12.3 Inductor current waveform of 
a current-programmed converter operating 
in the continuous conduction mode. 
the artificial ramp are explained, using a simple first-order discrete-time analysis. Effects of the artificial 
ramp on controller noise susceptibility is also discussed. 
Figure 12.3 illustrates a generic inductor current waveform of a switching converter operating 
in the continuous conduction mode. The inductor current changes with a slope rn1 during the first sub-
interval, and a slope - rn2 during the second subinterval. For the basic nonisolated converters, the slopes 
rn 1 and- rn2 are given by 
Buck converter 
v8 -v 
v 
rnl =-L~ -rnz=-r 
Boost converter 
vg- v 
-rnz=-L~ 
Buck-boost converter 
- rnz =I 
(12.1) 
With knowledge of the slopes rn1 and- rn2, we can determine the general relationships between iL(O), ic, 
iL(T,), and dT,. 
During the first subinterval, the inductor current iL(t) increases with slope rnl' until iL(t) reaches 
the control signal ic. Hence, 
(12.2) 
Solution for the duty cycle d leads to 
(12.3) 
In a similar manner, for the second subinterval we can write 
i L(T,) = i L(dT,)- rn2d'T, 
( 12.4) 
= iL(O) + rn 1dT,- rn2d'T, 
In steady-state, iL(O) = iJT,), d = D, rn1 = M1, and rn2 = M2. Insertion of these relationships into Eq. (12.4) 
yields 

12.1 
Oscillation forD> 0.5 
443 
[L(O) 
······ ! ··········· ! ··········· r LCTs) ·················si"eiidy-:.siaie·············· 
' 
waveform 
Fig. 12.4 Effect of initial pertur-
bation iL (0) on inductor current 
waveform. 
ml. 
! 
lw ··················r···········r····················· 
i dT ! !! 
0 
(D+d) Ts DTs 
(12.5) 
Or, 
(12.6) 
Steady-state Eq. (12.6) coincides with the requirement for steady-state volt-second balance on the induc-
tor. 
Consider now a small perturbation in iL(O): 
iL(O) =lw+ iL(O) 
(12.7) 
lw is a steady-state value of iL(O), which satisfies Eqs. (12.4) and (12.5), while iL(O) is a small perturba-
tion such that 
(12.8) 
It is desired to assess the stability of the current-programmed controller, by determining whether this 
small perturbation eventually decays to zero. To do so, let us solve for the perturbation after n switching 
periods, iL(nT3), and determine whether iL(nT.) tends to zero for large n. 
The steady-state and perturbed inductor current waveforms are illustrated in Fig. 12.4. For clar-
ity, the size of the inductor current perturbation iL(O) is exaggerated. It is assumed that the converter 
operates near steady-state, such that the slopes m1 and m2 are essentially unchanged. Figure 12.4 is 
drawn for a positive iL(O); the quantity drs is then negative. Since the slopes of the steady-state and per-
turbed waveforms are essentially equal over the interval 0 < t < (D + d)Ts, the difference between the 
waveforms is equal to iL(O) for this entire interval. Likewise, the difference between the two waveforms 
is a constant iL(T,) over the interval DTs < t < Ts, since both waveforms then have the slope - m2. Note 
that iL(T) is a negative quantity, as sketched in Fig. 12.4. Hence, we can solve for iL(T3) in terms of iL(O), 
by considering only the interval (D + d)Ts < t < DTs as illustrated in Fig. 12.5. 
Fig. 12.5 Expanded view of the steady-state and 
perturbed inductor current waveforms, near the peak 
of iL(t). 
Perturbed 
waveform 

444 
Current Programmed Control 
From Fig. 12.5, we can use the steady-state waveform to express iL(O) as the slope ml' multi-
plied by the interval length - dT,. Hence, 
(12.9) 
Likewise, we can use the perturbed waveform to express iL(T) as the slope- m2, multiplied by the inter-
vallength - dTs: 
(12.10) 
Elimination of the intermediate variable J from Eqs. (12.9) and (12.10) leads to 
iPs> = i L(O) (- =~) 
(12.11) 
If the converter operating point is sufficiently close to the quiescent operating point, then mz!m1 is given 
approximately by Eq. (12.6). Equation (12.11) then becomes 
o (T ) _ o (O) ( D ) 
1Ls- 1 L 
-D' 
(12.12) 
A similar analysis can be performed during the next switching period, to show that 
i L(2T) = [ L(T,) (- g.) = i L(O) (- g) 2 
(12.13) 
After n switching periods, the perturbation becomes 
[ L(nT,.) = [ 
L((n- l)Ts) (-g.)= [ 
L(O) (-g. r 
(12.14) 
Note that, as n tends to infinity, the perturbation iL(nT,) tends to zero provided that the characteristic 
value- DID' has magnitude less than one. Conversely, the perturbation iL(nTs) becomes large in magni-
tude when the characteristic value a=- DID' has magnitude greater than one: 
when I-g I< 1 
when I-g I> 1 
Therefore, for stable operation of the current programmed controller, we need I a I =DID'< 1, or 
D<0.5 
(12.15) 
(12.16) 
As an example, consider the operation of the boost converter with the steady-state terminal volt-
ages V8 = 20 V, V = 50 V. Since VIV8 = liD', the boost converter should operate with D = 0.6. We there-
fore expect the current programmed controller to be unstable. The characteristic value will be 

12.1 
Oscillation forD> 0.5 
445 
Fig. 12.6 Unstable oscillation forD= 0.6. 
a=- g. = (- ~:~) =- 1.5 
(12.17) 
As given by Eq. (12.14), a perturbation in the inductor current will increase by a factor of- 1.5 over 
every switching period. As illustrated in Fig. 12.6, the perturbation grows to- 1.5zL(O) after one switch-
ing period, to+ 2.25iL(O) after two switching periods, and to- 3.375zL(O) after three switching periods. 
For the particular initial conditions illustrated in Fig. 12.6, this growing oscillation saturates the current 
programmed controller after three switching periods. The transistor remains on for the entire duration of 
the fourth switching period. The inductor current and controller waveforms may eventually become 
oscillatory and periodic in nature, with period equal to an integral number of switching periods. Alterna-
tively, the waveforms may become chaotic. In either event, the controller does not operate as intended. 
Figure 12.7 illustrates the inductor current waveforms when the output voltage is decreased to V 
= 30 V. The boost converter then operates with D = 113, and the characteristic value becomes 
_ 
D -( 113)-
a - - D' -
- 213 - - 0.5 
(12.18) 
Perturbations now decrease in magnitude by a factor of 0.5 over each switching period. A disturbance in 
the inductor current becomes small in magnitude after a few switching periods. 
The instability for D > 0.5 is a well-known problem of current programmed control, which is 
not dependent on the converter topology. The controller can be rendered stable for all duty cycles by 
addition of an artificial ramp to the sensed switch current waveform, as illustrated in Fig. 12.8. This arti-
T, 
2T, 
3T, 
4T, 
Fig. 12.7 A stable transient with D = 1/3. 

446 
Current Programmed Control 
(a) 
+ 
c 
v(t) 
R 
: _________________________________________________________________ ! 
r------------------------~------ ---------- --------------------------------------------------------------------------------------: 
! Measure t/t) 
! 
switch 
Control 
input 
Current-programmed controller 
Fig. 12.8 Stabilization of the current programmed controller by addition of an artificial ramp to the measured 
switch current waveform: (a) block diagram, (b) artificial ramp waveform. 
ficial ramp has the qualitative effect of reducing the gain of the inner switch-current-sensing discrete 
feedback loop. The artificial ramp has slope rna as shown. The controller now switches the transistor off 
when 
(12.19) 
where ia(t) is the artificial ramp waveform. Therefore, the transistor is switched off when the inductor 
current iL(t) is given by 
(12.20) 
Figure 12.9 illustrates the analog comparison of the inductor current waveform iL(t) with the quantity 
[ic- ia(t)]. 

12.1 
Oscillation forD> 0.5 
447 
Fig. 12.9 
Addition of artificial ramp: 
the transistor is now switched off when 
iL(t) = ic- ia(t). 
fLO 
•····•••·•••••·•······•·•·•·•••••••··••·•·•·••••••··•··•·••·•··•··•····•· 
0 
dT, 
T, 
We can again determine the stability of the current programmed controller by analyzing the 
change in a perturbation of the inductor current waveform over a complete switching period. Figure 
12.10 illustrates steady-state and perturbed inductor current waveforms, in the presence of the artificial 
ramp. Again, the magnitude of the perturbation iL(O) is exaggerated. The perturbed waveform is sketched 
for a positive value of iL(O); this causes d, and usually also iL(T,), to be negative. If the perturbed wave-
forms are sufficiently close to the quiescent operating point, then the slopes m1 and m2 are essentially 
unchanged, and the relationship between iL(O) and iL(T,) can be determined solely by consideration of the 
interval (D + d)T, < t < DT,. The perturbations iL(O) and iL(T,) are expressed in terms of the slopes ml' m2, 
and rna, and the interval length- dT,, as follows: 
(12.21) 
(12.22) 
Elimination of d yields 
• (T) 
• (0) ( mz- rna) 
lL 
·' =lL 
-mi+ma 
(12.23) 
A similar analysis can be applied to the n'h switching period, leading to 
(12.24) 
The evolution of inductor current perturbations are now determined by the characteristic value 

448 
Current Programmed Control 
For large n, the perturbation magnitude tends to 
when J aJ < 1 
whenJ aJ > 1 
(12.25) 
(12.26) 
Therefore, for stability of the current programmed controller, we need to choose the slope of the artificial 
ramp ma such that the characteristic value a has magnitude less than one. The artificial ramp gives us an 
additional degree of freedom, which we can use to stabilize the system for duty cycles greater than 0.5. 
Note that increasing the value of ma causes the numerator of Eq. (12.25) to decrease, while the denomi-
nator increases. Therefore, the characteristic value a attains magnitude less than one for sufficiently large 
In the conventional voltage regulator application, the output voltage v(t) is well regulated by the 
converter control system, while the input voltage v/t) is unknown. Equation (12.1) then predicts that the 
value of the slope m2 is constant and known with a high degree of accuracy, for the buck and buck-boost 
converters. Therefore, let us use Eq. (12.6) to eliminate the slope m1 from Eq. (12.25), and thereby 
express the characteristic value a as a function of the known slope m2 and the steady-state duty cycle D: 
(12.27) 
One common choice of artificial ramp slope is 
(12.28) 
It can be verified, by substitution of Eq. (12.28) into (12.27), that this choice leads to a=- 1 at D = 1, 
and to I a I < 1 for 0 ~ D < 1. This is the minimum value of ma that leads to stability for all duty cycles. 
We will see in Section 12.3 that this choice of ma has the added benefit of causing the ideal line-to-output 
transfer function Gv/s) of the buck converter to become zero. 
Another common choice of ma is 
(12.29) 
This causes the characteristic value a to become zero for all D. As a result, iL(T,) is zero for any iL(O) that 
does not saturate the controller. The system removes any error after one switching period T,. This behav-
ior is known as deadbeat control, or finite settling time. 
It should be noted that the above stability analysis employs a quasi-static approximation, in 
which the slopes m1 and m2 of the perturbed inductor current waveforms are assumed to be identical to 
the steady-state case. In the most general case, the stability and transient response of a complete system 
employing current programmed control must be assessed using a system-wide discrete time or sampled-
data analysis. Nonetheless, in practice the above arguments are found to be sufficient for selection of the 
artificial ramp slope ma. 
Current-programmed controller circuits exhibit significant sensitivity to noise. The reason for 
this is illustrated in Fig. 12.11(a), in which the control signal f/t) is perturbed by a small amount of noise 

Fig. 12.11 
When noise perturbs a 
controller signal such as ic, a perturba-
tion in the duty cycle results: (a) with 
no artificial ramp and small inductor 
current ripple, the perturbation d is 
large; (b) an artificial ramp reduces the 
controller gain, thereby reducing the 
perturbation d. 
12.2 
A Simple First-Order Model 
449 
Perturbed 
waveform 
ic ... :::t!,~::::::::::::::::::: .................................. :::::: ............... :::: ...... ~ 
T 
~ 
0 
0 
l~: 
!JT, l 
!~] 
Perturbed 
DT, (D + d)T, 
T, 
T, 
Steady-state 
waveform 
represented by ic. It can be seen that, when there is no artificial ramp and when the inductor current rip-
ple is small, then a small perturbation in ic leads to a large perturbation in the duty cycle: the controller 
has high gain. When noise is present in the controller circuit, then significant jitter in the duty cycle 
waveforms may be observed. A solution is to reduce the gain of the controller by introduction of an arti-
ficial ramp. As illustrated in Fig. 12.11(b), the same perturbation in ic now leads to a reduced variation in 
the duty cycle. When the layout and grounding of the controller circuit introduce significant noise into 
the duty cycle waveform, it may be necessary to add an artificial ramp whose amplitude is substantially 
greater than the inductor current ripple. 
12.2 
A SIMPLE FIRST-ORDER MODEL 
Once the current programmed controller has been constructed, and stabilized using an artificial ramp, 
then it is desired to design a feedback loop for regulation of the output voltage. As usual, this voltage 
feedback loop must be designed to meet specifications regarding line disturbance rejection, transient 
response, output impedance, etc. A block diagram of a typical system is illustrated in Fig. 12.12, contain-
ing an inner current programmed controller, with an outer voltage feedback loop. 
To design the outer voltage feedback loop, an ac equivalent circuit model of the switching con-
verter operating in the current programmed mode is needed. In Chapter 7, averaging was employed to 
develop small-signal ac equivalent circuit models for converters operating with duty ratio control. These 
models predict the circuit behavior in terms of variations d in the duty cycle. If we could find the rela-
tionship between the control signal iJt) and the duty cycle d(t) for the current programmed controller, 
then we could adapt the models of Chapter 7, to apply to the current programmed mode as well. In gen-
eral, the duty cycle depends not only on ic(t), but also on the converter voltages and currents; hence, the 
current programmed controller incorporates multiple effective feedback loops as indicated in Fig. 12.12. 

450 
Current Programmed Control 
Switching converter 
d(t) 
Converter 
voltages and 
currents 
+ 
R 
v(t) 
Fig. 12.12 
Block diagram of a converter system incorporating current programmed control. 
In this section, the averaging approach is extended, as described above, to treat current pro-
grammed converters. A simple first-order approximation is employed, in which it is assumed that the cur-
rent programmed controller operates ideally, and hence causes the average inductor current ( iL(t) >rs to be 
identical to the control ic(t). This approximation is justified whenever the inductor current ripple and arti-
ficial ramp have negligible magnitudes. The inductor current then is no longer an independent state of the 
system, and no longer contributes a pole to the converter small-signal transfer functions. 
This first-order model is derived in Section 12.2.1, using a simple algebraic approach. In Sec-
tion 12.2.2, a simple physical interpretation is obtained via the averaged switch modeling technique. A 
more accurate, but more complicated, model is described in Section 12.3. 
12.2.1 
Simple Model via Algebraic Approach: Buck-Boost Example 
The power stage of a simple buck-boost converter operating in the continuous conduction mode is illus-
trated in Fig. 12.13(a), and its inductor current waveform is given in Fig. 12.13(b). The small-signal aver-
aged equations for this converter, under duty cycle control, were derived in Section 7.2. The result, 
Eq. (7.43), is reproduced below: 
L diJ;t) = Dvg(t) + D'v(t) + ( V8 - v)J(t) 
c dv(t) =- D'i - v(t) +I d'(t) 
dt 
L 
R 
L 
i g{t) = Dz L +I Ld(t) 
The Laplace transforms of these equations, with initial conditions set to zero, are 
(12.30) 

12.2 
A Simple First-Order Model 
451 
(a) 
+ 
c 
R 
v(t) 
(b) 
0 
dT, 
T, 
Fig. 12.13 
Buck-boost converter example: (a) power stage, (b) inductor current waveform. 
sLl L(s) = Dvg(s) + D'v(s) + ( vg- v)d(s) 
sC\i(s) =- D'! L(s)- v~) +I Ld(s) 
i 8(s) = Di L(s) +I Ld(s) 
(12.31) 
We now make the assumption that the inductor current iL(s) is identical to the programmed control cur-
rent ic(s). This is valid to the extent that the controller is stable, and that the magnitudes of the inductor 
current ripple and artificial ramp waveform are sufficiently small: 
(12.32) 
This approximation, in conjunction with the inductor current equation of (12.31), can now be used to find 
the relationship between the control current ic(s) and the duty cycle d(s), as follows: 
(12.33) 
Solution for d(s) yields 
(12.34) 
This small-signal expression describes how the current programmed controller varies the duty cycle, in 
response to a given control input variation ic(s). It can be seen that d(s) depends not only on iJs), but also 
on the converter output voltage and input voltage variations. Equation (12.34) can now be substituted 
into the second and third lines of Eq. (12.31), thereby eliminating d(s). One obtains 

452 
Current Programmed Control 
(b) 
~-----------------------------------------------------------------------------------------------------------------! 
I D' 
D ( 1 _ sLD ) [ 
R 
Jf 
0 
! D'R vg 
D'zR 
c 
D 
! ; 
! ' 
~----------------------------------------------------------------------------------------------------------------j 
Node 
f 
sCv 
c 
v 
R 
R 
Fig. 12.14 
Construction of CPM CCM buck-boost converter equivalent circuit: (a) input port model, correspond-
ing to Eq. (12.38); (b) output port model, corresponding to Eq. (12.37). 
(12.35) 
These equations can be simplified by collecting terms, and by use of the steady-state relationships 
(12.36) 
Equation (12.35) then becomes 
(12.37) 
(12.38) 
These are the basic ac small-signal equations for the simplified first-order model of the current-pro-
grammed buck-boost converter. These equations can now be used to construct small-signal ac circuit 
models that represent the behavior of the converter input and output ports. In Eq. (12.37), the quantity 
sCO(s) is the output capacitor current. The i/s) term is represented in Fig. 12.14(b) by an independent 

12.2 
A Simple First-Order Model 
453 
+ 
R 
Fig. 12.15 Two-port equivalent circuit used to model the current-programmed CCM buck, boost, and buck-boost 
converters. 
current source, while the vgCs) term is represented by a dependent current source. v(s)IR is the current 
through the load resistor, and v(s)DIR is the current through an effective ac resistor of value RID. 
Equation (12.38) describes the current i8(s) drawn by the converter input port, out of the source 
v8(s). The i/s) term is again represented in Fig. 12.14(a) by an independent current source, and the v(s) 
term is represented by a dependent current source. The quantity- V/s)D2/D'R is modeled by an effective 
ac resistor having the negative value- D'R!D2• 
Figures 12.14(a) and (b) can now be combined into the small-signal two-port model of Fig. 
12.15. The current programmed buck and boost converters can also be modeled by a two-port equivalent 
circuit, of the same form. Table 12.llists the model parameters for the basic buck, boost, and buck-boost 
converters. 
The two-port equivalent circuit can now be solved, to find the converter transfer functions and 
output impedance. The control-to-output transfer function is found by setting v8 to zero. Solution for the 
output voltage then leads to the transfer function Gv/s): 
v(s) I 
( 
1 ) 
G,/s) = i/s) o -o = f2 rzll R II sC 
g-
(12.39) 
Substitution of the model parameters for the buck-boost converter yields 
(12.40) 
Table 12.1 
Current programmed mode small-signal equivalent circuit parameters, simple model 
Converter 
g, 
!, 
r, 
g2 
fz 
rz 
Buck 
D 
D( 1 + s;) 
R 
0 
R. 
-[J2 
Boost 
0 
1 
D'( 1-_4_) 
R 
D'R 
D' 2R 
Buck-boost 
D 
D(1+ t~) 
D'R 
Dz 
-D'( 1_ sDL) 
R 
-R. 
-[)2 
- D'R 
D'zR 
I5 

454 
Current Programmed Control 
It can be seen that this transfer function contains only one pole; the pole due to the inductor has been lost. 
The de gain is now directly dependent on the load resistance R. In addition, the transfer function contains 
a right half-plane zero whose comer frequency is unchanged from the duty-cycle-controlled case. In gen-
eral, introduction of current programming alters the transfer function poles and de gain, but not the 
zeroes. 
The line-to-output transfer function Gv8(s) is found by setting the control input ic to zero, and 
then solving for the output voltage. The result is 
(12.41) 
Substitution of the parameters for the buck-boost converter leads to 
D 2 
1 
G (s)-
vg 
-- 1 - D 2 ( 
RC ) 
1+s 1+D 
(12.42) 
Again, the inductor pole is lost. The output impedance is 
(12.43) 
For the buck-boost converter, one obtains 
Z (s)--R_ 
1 
our 
-
1 + D ( 
RC ) 
l+s 1+D 
(12.44) 
12.2.2 
Averaged Switch Modeling 
Additional physical insight into the properties of current programmed converters can be obtained by use 
of the averaged switch modeling approach developed in Section 7 .4. Consider the buck converter of Fig. 
12.16. We can define the terminal voltages and currents of the switch network as shown. When the buck 
converter operates in the continuous conduction mode, the switch network average terminal waveforms 
are related as follows: 
L 
+ 
c 
R 
v(t) 
Switch network 
~--------···················------------~ 
Fig. 12.16 
Averaged switch modeling of a current-programmed converter: CCM buck example. 

12.2 A Simple First-Order Model 
455 
We again invoke the approximation in which the inductor current exactly follows the control current. In 
terms of the switch network terminal current i2, we can therefore write 
(12.46) 
The duty cycle d(t) can now be eliminated from Eq. (12.45), as follows: 
(12.47) 
This equation can be written in the alternative form 
(12.48) 
Equations (12.46) and (12.48) are the desired result, which describes the average terminal relations of the 
CCM current-programmed buck switch network. Equation (12.46) states that the average terminal cur-
rent (iit))rs is equal to the control current (ic(t) )r,. Equation (12.48) states that the input port of the 
switch network consumes average power (p(t) )To equal to the average power flowing out of the switch 
output port. The averaged equivalent circuit of Fig. 12.17 is obtained. 
Figure 12.17 describes the behavior of the current programmed buck converter switch network, 
in a simple and straightforward manner. The switch network output port behaves as a current source of 
value (i/t))Ts' The input port follows a power sink characteristic, drawing power from the source vg equal 
to the power supplied by the ic current source. Properties of the power source and power sink elements 
are described in Chapters 11 and 18. 
Similar arguments lead to the averaged switch models of the current programmed boost and 
buck-boost converters, illustrated in Fig. 12.18. In both cases, the switch network averaged terminal 
waveforms can be represented by a current source of value (i/t))r,, in conjunction with a dependent 
power source or power sink. 
A small-signal ac model of the current-programmed buck converter can now be constructed by 
perturbation and linearization of the switch network averaged terminal waveforms. Let 
·······················--·--·-- ------------···················; 
L 
(il(t))T, 
(iz(t))T, 
(iL(t))T, 
+ 
+ 
+ 
(vgCt))T, 
(vl(t))T, 
(ic(t))T 
(vz(t))T, 
c 
R 
(v(t))T, 
s 
Fig. 12.17 
Averaged model of CPM buck converter. 

456 
Current Programmed Control 
(a) 
L 
;·······-········-···--··-----····································: 
+ 
c 
(v(t))r 
s 
R 
(b) 
Averaged switch network 
+ 
+ 
c 
R 
(v(t))T 
s 
Fig. 12.18 
Averaged models of CPM boost (a) and CPM buck-boost (b) converters, derived via averaged switch 
modeling. 
(vl(t)Jr, = V1 +v1(t) 
(il(t)Jr =/1 +z 1(t) 
s 
( v2(t)) r, = V2 + v2(t) 
(i2(t))T, = lz + t2(t) 
(i/t))T, = lc + l/t) 
(12.49) 
Perturbation and linearization of the ( i/t) >r:, current source of Fig. 12.17 simply leads to a current source 
of value ic(t). Perturbation of the power source characteristic, Eq. (12.48), leads to 
(12.50) 
Upon equating the de terms on both sides of this equation, we obtain 
(12.51) 
The linear small-signal ac terms of Eq. (12.50) are 

12.2 
A Simple First-Order Model 
457 
, ............................................................................................ i 
r---'--+---J 
L 
+ 
c 
R 
L.. ..... ~~-~~-c_h._'!~t.:!.?.!.~.S.I1l.(l_!!_:S.i2'!.~l .. ~~ .. l1l.?.~(!_l .... _ ... 
Fig. 12.19 
Small-signal model of the CCM CPM buck converter, derived by perturbation and linearization of the 
switch network in Fig. 12.17. 
(12.52) 
Solution for the small-signal switch network input current z1(t) yields 
The small-signal ac model of Fig. 12.19 can now be 
constructed. The switch network output port is again a 
current source, of value lc(t). The switch network input 
port model is obtained by linearization of the power 
sink characteristic, as given by Eq. (12.53). The input 
port current 11(t) is composed of three terms. The lc(t) 
term is modeled by an independent current source, the 
v2(t) term is modeled by a dependent current source, 
and the v1(t) term is modeled by an effective ac resistor 
having the negative value - V/11• As illustrated in Fig. 
12.20, this incremental resistance is determined by the 
slope of the power sink input port characteristic, evalu-
ated at the quiescent operating point. The power sink 
leads to a negative incremental resistance because an 
increase in (v1(t)\s causes a decrease in (i1(t))T,' such 
that constant (p(t) >r,, is maintained. 
The equivalent circuit of Fig. 12.19 can now 
be simplified by use of the de relations V2 = DV1, 
12 = Vz!R, 11 = D/2, 12 = !c. Equation (12.53) then 
becomes 
Power source 
characteristic 
(vl(t))T (il(t))T = (p(t))T 
s 
s 
s 
Quiescent 
operating 
point 
(12.53) 
Fig. 12.20 Origin of the input port negative 
incremental resistance r 1: the slope of the power 
sink characteristic, evaluated at the quiescent oper-
ating point. 
(12.54) 
Finally, we can eliminate the quantities v1 and v2 in favor of the converter terminal voltages vg and v, as 
follows. The quantity v1 is simply equal to v8• The quantity v2 is equal to the output voltage v plus the 
voltage across the inductor, sLI/s). Hence, 

458 
Current Programmed Control 
R 
- Dz 
L 
+ 
c 
R 
Fig. 12.21 
Simplification of the CPM buck converter model of Fig. 12.19, with dependent source expressed in 
terms of the output voltage variations. 
(12.55) 
With these substitutions, Eq. (12.54) becomes 
(12.56) 
The equivalent circuit of Fig. 12.21 is now obtained. It can be verified that this equivalent circuit coin-
cides with the model of Fig. 12.15 and the buck converter parameters of Table 12.1. 
The approximate small-signal properties of the current programmed buck converter can now be 
explained. Since the inductor is in series with the current source !c, the inductor does not contribute to the 
control-to-output transfer function. The control-to-output transfer function is determined simply by the 
relation 
G (s) = v(s) I 
= (R 11...1..) 
vc 
i (s) 
sC 
c 
Vg= 0 
(12.57) 
So current programming transforms the output characteristic of the buck converter into a current source. 
The power sink input characteristic of the current programmed buck converter leads to a negative incre-
mental input resistance, as described above. Finally, Fig. 12.21 predicts that the buck converter line-to-
output transfer function is zero: 
G (s) = v(s) I 
= 0 
vg 
vgCs) • -0 
'c-
(12.58) 
Disturbances in v8 do not influence the output voltage, since the inductor current depends only on ic. The 
current programmed controller adjusts the duty cycle as necessary to maintain constant inductor current, 
regardless of variations in v8 • The more accurate models of Section 12.3 predict that Gv/s) is not zero, 
but is nonetheless small in magnitude. 
Similar arguments lead to the boost converter small-signal equivalent circuit of Fig. 12.22. Der-
ivation of this equivalent circuit is left as a homework problem. In the case of the boost converter, the 
switch network input port behaves as a current source, of value ic, while the output port is a dependent 
power source, equal to the power apparently consumed by the current source ic. In the small-signal 
model, the current source [c appears in series with the inductor L, and hence the converter transfer func-
tions cannot contain poles arising from the inductor. The switch network power source output character-
istic leads to an ac resistance of value r2 = R. The line-to-output transfer function Gv8(s) is nonzero in the 

12.3 
A More Accurate Model 
459 
+ 
R 
c 
R 
Fig. 12.22 Small-signal model of the CCM CPM boost converter, derived via averaged switch modeling and 
the approximation iL"' ic. 
boost converter, since the magnitude of the power source depends directly on the value of vg. The con-
trol-to-output transfer function Gvc(s) contains a right half-plane zero, identical to the right half-plane 
zero of the duty-cycle-controlled boost converter. 
12.3 
A MORE ACCURATE MODEL 
The simple models discussed in the previous section yield much insight into the low-frequency behavior 
of current-programmed converters. Unfortunately, they do not always describe everything that we need 
to know. For example, the simple model of the buck converter predicts that the line-to-output transfer 
function Gv/s) is zero. While it is true that this transfer function is usually small in magnitude, the trans-
fer function is not equal to zero. To predict the effect of input voltage disturbances on the output voltage, 
we need to compute the actual Gv8(s). 
In this section, a more accurate analysis is performed which docs not rely on the approximation 
( iL(t) )r, "' ic(t). The analytical approach of [5,6] is combined with the controller model of [7]. A func-
tional block diagram of the current programmed controller is constructed, which accounts for the pres-
ence of the artificial ramp and for the inductor current ripple. This block diagram is appended to the 
averaged converter models derived in Chapter 7, leading to a complete converter CPM model. Models 
for the CPM buck, boost, and buck-boost converters are listed, and the buck converter model is analyzed 
in detail. 
12.3.1 
Current Programmed Controller Model 
Rather than using the approximation ( iL(t) >r, = (i/t) )r,, let us derive a more accurate expression relating 
the average inductor current ( iL(t) >r, to the control input i/t). The inductor current waveform is illus-
trated in Fig. 12.23. It can be seen that the peak value of iL(t) differs from ic(t), by the magnitude of the 
artificial ramp waveform at time t = dT,, that is, by m"dT,. The peak and average values of the inductor 
current waveform differ by the average value of the inductor current ripple. Under transient conditions, 
in which iL(O) is not equal to iL(T,), the magnitudes of the inductor current ripples during the dT, and d'T, 
subintervals arc m1dT,f2 and m2d'TJ2, respectively. Hence, the average value of the inductor current rip-
ple is d(m 1dTJ2) + d'(m2d'TJ2). We can express the average inductor current as 
(12.59) 

460 
Current Programmed Control 
Fig. 12.23 
Accurate determination of 
the relationship between the average 
inductor current (iL(t))T, and ic. 
This is the more accurate relationship which is employed in this section. 
A small-signal current programmed controller model is found by perturbation and linearization 
of Eq. (12.59). Let 
(iL(t))T =fL+lL(t) 
s 
(i/tl)T = fc + lc(t) 
s 
d(t) = D + d(t) 
m1(t)=M 1 +m 1(t) 
mit) = M 2 + m2(t) 
(12.60) 
Note that it is necessary to perturb the slopes m1 and m2, since the inductor current slope depends on the 
converter voltages according to Eq. (12.1). For the basic buck, boost, and buck-boost converters, the 
slope variations are given by 
Buck converter 
, 
vg- v , 
v 
m1=-L-
m2=I 
Boost converter 
v-v 
' 
g 
mz=-L-
Buck-boost converter 
' 
v 
m2=-r 
It is assumed that m" does not vary: fit"= Ma. Substitution of Eq. (12.60) into Eq. (12.59) leads to 
(12.61) 
(I L + i L(t)) = (I c + i c(t)) -MaT,( D + J(t)) - ~' ( M 1 + m 1 (t) )( D + d(t)) 2 -
~' ( M 2 + m 2(t) )( D'- d(t)) 2 
( 12·62) 
The first-order ac terms are 
(12.63) 
With use of the equilibrium relationship DM1 = D'M2, Eq. (12.63) can be further simplified: 

12.3 A More Accurate Model 
461 
Table 12.2 Current programmed controller gains for basic converters 
Converter 
Fg 
Fv 
Buck 
D 2T, 
(1-2D)r, 
2L 
2L 
Boost 
(2D- 1 )r, 
D' 2T, 
2L 
----zr 
Buck-boost 
D 2T, 
D' 2T, 
2L 
-----zr 
o 
o 
, 
D 2T, , 
D' 2T, , 
1 L(t) = 1 /t)- M J,d(t)- - 2-m 1(t)- - 2-
m2(t) 
(12.64) 
Finally, solution for d(t) yields 
(12.65) 
This is the actual relationship that the current programmed controller follows, to determine d(t) as a func-
tion of !Jt), iL(t), ml(t), and mz(t). Since the quantities ml(t), and m2(t) depend on vgCt) and v(t), according 
to Eq. (12.61), we can express Eq. (12.65) in the following form: 
(12.66) 
where F'" = 1/MaT,. Expressions for the gains Fg and Fv, for the basic buck, boost, and buck-boost con-
verters, are listed in Table 12.2. A functional block diagram of the current programmed controller, corre-
sponding to Eq. (12.66), is constructed in Fig. 12.24. 
Current programmed converter models can now be obtained, by combining the controller block 
Fig. 12.24 Functional block diagram of the current 
programmed controller. 

462 
Current Programmed Control 
diagram of Fig. 12.24 with the averaged converter models derived in Chapter 7. Figure 12.25 illustrates 
the CPM converter models obtained by combination of Fig. 12.24 with the buck, boost, and buck-boost 
models of Fig. 7.17. For each converter, the current programmed controller contains effective feedback 
of the inductor current iL(t) and the output voltage v(t), as well as effective feedforward of the input volt-
age vg(t). 
12.3.2 
Solution of the CPM Transfer Functions 
Next, let us solve the models of Fig. 12.25, to determine more accurate expressions for the control-to-
output and line-to-output transfer functions of current-programmed buck, boost, and buck-boost convert-
ers. As discussed in Chapter 8, the converter output voltage v can be expressed as a function of the duty-
cycled and input voltage v8 variations, using the transfer functions Gvis) and Gv8(s): 
(12.67) 
In a similar manner, the inductor current variation i can be expressed as a function of the duty-cycle d 
and input voltage v8 variations, by defining the transfer functions G;is) and G;/s): 
(12.68) 
where the transfer functions G;is) and G;gCs) are given by: 
(a) Buck 
\id(t) 
L 
+ 
v(t) R 
Fig. 12.25 More accurate models of current-programmed converters: (a) buck, (b) boost, (c) buck-boost. 

12.3 
A More Accurate Model 
463 
(b) Boost 
+ 
v(t) 
R 
(c) Buck-boost 
+ 
c 
v(t) 
R 
Fig. 12.25 
Continued. 

464 
Current Programmed Control 
I 
; 
! 
: _______________________________________________________________ .: 
Fig. 12.26 Block diagram that models the current-programmed converters of Fig. 12.25. 
G (s) = i ~(s) I 
'd 
d(s) . 
vg<s)=O 
(12.69) 
G (s) = i L(s) I 
'g 
0 (s) . 
g 
d(.l)=O 
Figure 12.26 illustrates replacement of the converter circuit models of Fig. 12.25 with block diagrams 
that correspond to Eqs. (12.67) and (12.68). 
The control-to-output and line-to-output transfer functions can now be found, by manipulation 
of the block diagram of Fig. 12.26, or by algebraic elimination of d and iL from Eqs. (12.66), (12.67), and 
(12.68), and solution for v. Substitution of Eq. (12.68) into Eq. (12.66) and solution for dleads to 
(12.70) 
By substituting this expression into Eq. (12.67), one obtains 
(12.71) 
Solution of this equation for v leads to the desired result: 
(12.72) 
Therefore, the current-programmed control-to-output transfer function is 

12.3 A More Accurate Model 
465 
The current-programmed line-to-output transfer function is 
v(s) I 
Gvg-cpn,(s) = 0 (s) 
g 
iJs)=O 
Gvg- F,FgGvd + F,( Gv8G;d- G;8Gvd) 
1 + F,( G;d + FPvd) 
(12.73) 
(12.74) 
Equations (12.73) and (12.74) are general expressions for the important transfer functions of single-
inductor current-programmed converters operating in the continuous conduction mode. 
12.3.3 
Discussion 
The controller model of Eq. (12.66) and Fig. 12.24 accounts for the differences between iL and ic that 
arise by two mechanisms: the inductor current ripple and the artificial ramp. The inductor current ripple 
causes the peak and average values of the inductor current to differ; this leads to a deviation between the 
average inductor current and ic. Since the magnitude of the inductor current ripple is a function of the 
converter input and capacitor voltages, this mechanism introduces 08 and 0 dependencies into the control-
ler small-signal block diagram. Thus, the F8 and Fv gain blocks of Fig. 12.24 model the small-signal 
effects of the inductor current ripple. For operation deep in continuous conduction mode (2LIRT, » 1), 
the inductor current ripple is small. The F8 and Fv gain blocks can then be ignored, and the inductor cur-
rent ripple has negligible effect on the current programmed controller gain. 
The artificial ramp also causes the average inductor current to differ from ic. This is modeled by 
the gain block F,, which depends inversely on the artificial ramp slope Ma. With no artificial ramp, 
Ma = 0 and Fm tends to infinity. The current-programmed control systems of Fig. 12.25 then effectively 
have infinite loop gain. Since the duty cycled is finite, the signal at the input to the Fm block (d/F'") must 
tend to zero. The block diagram then predicts that 
(12.75) 
In the case of negligible inductor current ripple (Fg -+ 0 and Fv-+ 0), this equation further reduces to 
(12.76) 
This coincides with the simple approximation employed in Section 12.2. Hence, the transfer functions 
predicted in this section reduce to the results of Section 12.2 when there is no artificial ramp and negligi-
ble inductor current ripple. In the limit when Fm-+ =, F8 -+ 0, and Fv-+ 0, the control-to-output transfer 
function (12.73) reduces to 
lim Gvc(s) = GGvd 
Fm -too 
id 
(12.77) 
Fg-'>0 
Fv---"0 
and the line-to-output transfer function reduces to 

466 
Current Programmed Control 
(12.78) 
It can be verified that Eqs. (12.77) and (12.78) are equivalent to the transfer functions derived in Section 
12.2. 
When an artificial ramp is present, then the gain F"' is reduced to a finite value. The current-pro-
grammed controller no longer perfectly regulates the inductor current iv and the terms on the right-hand 
side of Eq. (12.75) do not add to zero. In the extreme case of a very large artificial ramp (large Ma and 
hence small Fm), the current-programmed controller degenerates to duty-cycle control. The artificial 
ramp and analog comparator of Fig. 12.8 then function as a pulse-width modulator similar to Fig. 7.63, 
with small-signal gain F111• For small F m and for Fg -+ 0, Fv ·-+ 0, the control-to-output transfer function 
(12.73) reduces to 
lim Gjs) = Fn,Gvd(s) 
smallF111 
Fv---"0 
Fg->0 
which coincides with conventional duty cycle control. Likewise, Eq. (12.74) reduces to 
lim~ Gvg-cpm(s) = Gvg 
Fm--" 
Fg->0 
Fv---"10 
which is the line-to-output transfer function for conventional duty cycle control. 
12.3.4 
Current-Programmed Transfer Functions of the CCM Buck Converter 
(12.79) 
(12.80) 
The control-to-output transfer function Gvis) and line-to-output transfer function GvgCs) of the CCM 
buck converter with duty cycle control are tabulated in Chapter 8, by analysis of the equivalent circuit 
model in Fig. 7.17(a). The results are: 
G (s)-Y_1_ 
vd 
- D den(s) 
(12.81) 
(12.82) 
where the denominator polynomial is 
den(s) = 1 + s i + s2LC 
(12.83) 
The inductor current transfer functions Giis) and GigCs) defined by Eqs. (12.68) and (12.69) are also 
found by solution of the equivalent circuit model in Fig. 7.17(a), with the following results: 
V (1 +sRC) 
G;is) = DR 
den(s) 
(12.84) 

12.3 A More Accurate Model 
467 
D ( 1 + sRC) 
(12.85) 
G,g(s) = R 
den(s) 
where den(s) is again given by Eq. (12.83). 
With no artificial ramp and negligible ripple, the control-to-output transfer function reduces to 
the ideal expression (12.77). Substitution ofEqs. (12.81) and (12.84) yields 
I. 
G ( ) 
G,is) 
R 
Jm 
vcs =-o 
c)=-~ 
RC 
Fm--?oo 
ids 
+s 
(12.86) 
Fg ->0 
Fv---tO 
Under the same conditions, the line-to-output transfer function reduces to the ideal expression (12.78). 
Substitution of Eqs. (12.81) to (12.85) leads to 
G,g(s)G,Js)- G,Js)G,g(s) 
F,~,j~= G,g·cpm(s) = 
G,J.I) 
= 0 
Fg---tD 
Fv ----tO 
(12.87) 
Equations (12.86) and (12.87) coincide with the expressions derived in Section 12.2 for the CCM buck 
converter. 
For arbitrary F m' Fv, and Fg, the control-to-output transfer function is given by Eq. ( 12.73). Sub-
stitution of Eqs. (12.81) to (12.85) into Eq. (12.73) yields 
G,/s) = 
F"Pvd 
1 + Fm[ G1d + F,G,d] 
F ( V 
1 
) 
"' 75 den(s) 
1 + F [( V 1 + sRC) + F ( V 
1 )j 
Simplification leads to 
"' DR den(s) 
" 75 den(s) 
v 
Fm75 
Gvc(s) = 
F V 
den(s) + DR ( 1 + sRC) + FmF,tJ 
Finally, the control-to-output transfer function can be written in the following normalized form: 
where 
(12.88) 
(12.89) 
(12.90) 
(12.91) 
(12.92) 

468 
Current Programmed Control 
(12.93) 
In the above equations, the salient features Gco• we, and Qc are expressed as the duty-ratio-control value, 
multiplied by a factor that accounts for the effects of current-programmed control. 
It can be seen from Eq. (12.93) that current programming tends to reduce the Q-factor of the 
poles. For large Fm, Qc varies as Fm-112; consequently, the poles become real and well-separated in mag-
nitude. The low-Q approximation of Section 8.1.7 then predicts that the low-frequency pole becomes 
(12.94) 
For large F m and small Fv, this expression can be further approximated as 
(12.95) 
which coincides with the low-frequency pole predicted by the simple model of Section 12.2. The low-Q 
approximation also predicts that the high-frequency pole becomes 
we = _l__ ( 1 
RCFn,V) 
Qc 
RC 
+ DL 
For large F m' this expression can be further approximated as 
(12.96) 
(12.97) 
The high-frequency pole is typically predicted to lie ncar to or greater than the switching frequency fs. It 
should be pointed out that the converter switching and modulator sampling processes lead to discrete-
time phenomena that affect the high-frequency behavior of the converter, and that are not predicted by 
the continuous-time averaged analysis employed here. Hence, the averaged model is valid only at fre-
quencies sufficiently less than one-half of the switching frequency. 
For arbitrary F m' Fv, and F8, the current-programmed line-to-output transfer function Gvg-cpm(s) 
is given by Eq. (12.74). This equation is most easily evaluated by first finding the ideal transfer function, 
Eq. (12.78), and then using the result to simplify Eq. (12.74). In the case of the buck converter, Eq. 
(12.87) shows that the quantity (GvgGid- GvdG;8 ) is equal to zero. Hence, Eq. (12.74) becomes 
(12.98) 
Substitution ofEqs. (12.81) to (12.85) into Eq. (12.98) yields 

12.3 A More Accurate Model 
469 
__12_- F F .l' -
1-
G 
( ) = 
den(s) 
"' g D den(s) 
vg-cpm S 
( 
) 
1 + F ...Y_ 1 + sRC + F .l' _1_ 
m DR den(s) 
v D den(s) 
(12.99) 
Simplification leads to 
(D-FmF8 15) 
Gvg-cpm(s) = 
F V 
V 
den(s) + DR ( 1 + sRC) + FnFv 75 
(12.100) 
Finally, the current-programmed line-to-output transfer function can be written in the following normal-
ized form: 
(12.101) 
where 
(1 __ 
F,FsV) 
(1 __ 
M 2 ) 
D2 
2Ma 
G 0 = D..,...--'----.!...._""' = D ..,...-~--~-""' 
g 
(1 
FmV 
FmFvV) 
(1 
FnY 
FnFvV) 
+DR+ 
D 
+DR+ 
D 
(12.102) 
The quantities Qc and We are given by Eqs. (12.92) and (12.93). 
Equation (12.102) shows how current programming reduces the de gain of the buck converter 
line-to-output transfer function. For duty cycle control (Fm-+ 0), G80 is equal to D. Nonzero values ofF m 
reduce the numerator and increase the denominator of Eq. (12.102), which tends to reduce G80. We have 
already seen that, in the ideal case (Fm -+ =, F8 -+ 0, Fv-+ 0), G80 becomes zero. Equation (12.102) 
reveals that nonideal current -programmed buck converters can also exhibit zero G 80, if the artificial ramp 
slope Ma is chosen equal to 0.5M2• The current programmed controller then prevents input line voltage 
variations from reaching the output. The mechanism that leads to this result is the effective feedforward 
of v8, inherent in the current programmed controller via the F/'8 term in Eq. (12.66). It can be seen from 
Fig. 12.26 that, when F8FmGvis) = Gv8(s), then the feedforward path from vg through F8 induces varia-
tions in the output v that exactly cancel the v8-induced variations in the direct forward path of the con-
verter through Gv/s). This cancellation occurs in the buck converter when Ma = 0.5M2• 
12.3.5 
Results for Basic Converters 
The transfer functions of the basic buck, boost, and buck-boost converters with current-programmed con-
trol are summarized in Tables 12.3 to 12.5. Control-to-output and line-to-output transfer functions for 
both the simple model of Section 12.2 and the more accurate model derived in this section are listed. For 
completeness, the transfer functions for duty cycle control are included. In each case, the salient features 
are expressed as the corresponding quantity with duty cycle control, multiplied by a factor that accounts 
for current-programmed control. 

470 
Current Programmed Control 
Table 12.3 
Summary ofresults for the CPM buck converter 
Simple model 
_Q_= __ 
R_ 
i, 
1 + sRC 
_Q_- 0 
v g-
__ 
1_V1 
F,V 
F,,FVV 
w,- 1LC 
+ DR + 
D 
Duty cycle controlled gains 
G (s)-J:'.-1-
vd 
- D den(s) 
Gvg(s) = D de~(s) 
den(s) = 1 + s -J? + s 2LC 
Table 12.4 
Summary of results for the CPM boost converter 
Simple model 
Duty cycle controlled gains 
(1-s _L__) 
v 
D'R 
D'zR 
-.---=2 ( 
) 
z, 
1+sR2C 
(1-s _L__) 
D' 2R 
G,is) = ff 
den(s) 
1 
1 
G,gCs) = 75' den(s) 
More accurate model 
G (s)-L 1+sRC 
id 
-DR den(s) 
G (s)-12 1 +sRC 
ig 
- R den(s) 
( 1 + s RC) 
G (s)- _ll'_ 
2 
id 
- D'zR 
den(s) 
1 
( 1 + sRC) 
G,gCs) = D' 2R 
den(s) 

Table 12.5 
Summary of results for the CPM buck-boost converter 
Simple model 
v 
D'R (I -s ffiR) 
~=- (1 +D) (1 +s_B{;_) 
1 +D 
More accurate model 
( 1 + s ) 
v 
co; 
v = G,g-cpm(s) = Ggo 
s 
( s )2 
g 
1+-Q +w 
/Uc 
c 
Duty cycle controlled gains 
(1 s DL ) 
lVI -
D'2R 
Gw/s) =- DD' 
den(s) 
_ 
D 
1 
G,is)- -yy den(s) 
12.3 A More Accurate Model 
471 
D (1 +sRC) 
G(,(s) = D' 2R 
den(s) 
The two poles of the line-to-output transfer functions Gvg-cpm and control-to-output transfer 
functions Gvc of all three converters typically exhibit low Q-factors in CPM. The low-Q approximation 
can be applied, as in Eqs. (12.94) to (12.97), to find the low-frequency pole. The line-to-output transfer 
functions of the boost and buck-boost converters exhibit two poles and one zero, with substantial de 
gain. 
12.3.6 
Quantitative Effects of Current-Programmed Control 
on the Converter Transfer Functions 
The frequency responses of a CCM buck converter, operating with current-programmed control and with 
duty cycle control, are compared in Appendix B, Section B.3.2. The buck converter of Fig. B.25 was 
simulated as described in Appendix B, and the resulting plots are reproduced here. 
The magnitude and phase of the control-to-output transfer functions are illustrated in Fig. 
12.27. It can be seen that, for duty cycle control, the transfer function Gvis) exhibits a resonant two-pole 
response. The substantial damping introduced by current-programmed control leads to essentially a sin-
gle-pole response in the current-programmed control-to-output transfer function Gvc(s). A second pole 
appears in the vicinity of 100 kHz, which is near the 200 kHz switching frequency. Because of this effec-
tive single-pole response, it is relatively easy to design a controller that exhibits a well-behaved response, 

472 
Current Programmed Control 
40dB 
II Gil 
L.G 
OdB 
-20dB 
-40dB 
0" 
-60dB 
-90" 
.J.------+-------i----..::::=------t-180" 
lOHz 
lOOHz 
I kHz 
10kHz 
100kHz 
f 
Fig. 12.27 Comparison of CPM control with duty-cycle control, for the control-to-output frequency response of 
the buck converter example. 
20dB 
Duty cycle control 
d(t) = constant 
OdB~----------------
-20dB 
-40 dB]:-------
-60 dB 
Current programmed mode 
v/t) = constant 
-80 dB 
-IOOdB+---------+---------+---------4---------~ 
lOHz 
lOOHz 
1kHz 
lOkHz 
100kHz 
f 
Fig. 12.28 Comparison of CPM control with duty-cycle control, for the line-to-output frequency response of the 
buck converter example. 
having ample phase margin over a wide range of operating points. Proportional-plus-integral (PI) con-
trollers are commonly used in current-programmed regulators. 
The line-to-output transfer functions of the same example are compared in Fig. 12.28. The line-
to-output transfer function GvgCs) for duty-cycle control is characterized by a de asymptote approxi-
mately equal to the duty cycleD= 0.676. Resonant poles occur at the corner frequency of the L-C filter. 
The line-to-output transfer function Gvg·cpm(s) with current-programmed control is significantly reduced, 
and exhibits more than 30 dB of additional attenuation over the frequencies of interest. It should again be 

20 dBQ t-----
Il Zaut II 
OdBQ 
-20dBQ 
Current programmed mode 
v/t) = constant 
Duty cycle control 
d(t) = constant 
12.4 Discontinuous Conduction Mode 
473 
-40 dBQ +----->--------+-----+------+ 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
f 
Fig. 12.29 
Comparison of CPM control with duty-cycle control, for the output impedance of the buck converter 
example. 
noted that the transfer function Gvg-cpm(s) in Fig. 12.28 cannot be predicted by the simple models of Sec-
tion 12.2; the more accurate model of Section 12.3 must be employed. 
The effect of current-programmed control on the converter output impedance is illustrated in 
Fig. 12.29. The output impedance plotted in the figure includes the load resistance of 10 Q. For duty~ 
cycle control, the de asymptote of the output impedance is dominated by the inductor winding resistance 
of 0.05 Q. The inductor becomes significant in the vicinity of 200 Hz. Above the resonant frequency of 
the output filter, the output impedance is dominated by the output filter capacitor. For current-pro-
grammed control, the simple model of Section 12.2 predicts that the inductor branch of the circuit is 
driven by a current source; this effectively removes the influence of the inductor on the output imped-
ance. The plot of Fig. 12.29 was generated using the more accurate model of this section; nonetheless, 
the output impedance is accurately predicted by the simple model. The de asymptote is dominated by the 
load resistance, and the high-frequency asymptote follows the impedance of the output filter capacitor. It 
can be seen that current programming substantially increases the converter output impedance. 
12.4 
DISCONTINUOUS CONDUCTION MODE 
Current-programmed converters operating in the discontinuous conduction mode can be described using 
the averaged switch modeling approaches of Sections 12.3 and 11.1. It is found in this section that the 
average transistor voltage and current follow a power sink characteristic, while the average diode voltage 
and current obey a power source characteristic. Perturbation and linearization of these characteristics 
leads to a small-signal equivalent circuit that models CPM DCM converters. The basic DCM CPM buck, 
boost, and buck-boost converters essentially exhibit single-pole transfer functions: the second pole and 
the right half-plane zero appear at frequencies near to or greater than the switching frequency, owing to 
the small value of L in DCM. 
A DCM CPM buck-boost converter example is analyzed here. However, Eqs. (12.103) to 
(12.120) are written in general form, and apply equally well to DCM CPM buck and boost converters. 
The schematic of a buck-boost converter is illustrated in Fig. 12.30. The terminal waveforms of the 
switch network are defined as shown: v1(t) and i1(t) are the transistor waveforms, while vz(t) and iz(t) are 

474 
Current Programmed Control 
Switch network 
r~--·-----------------------------------1 
Fig. 
12.30 
Current-programmed DCM 
buck-boost converter example. 
~~---++!~ 
.-r~~----------, 
v1(t) I 
+ 
' 
+ 
C R 
v(t) 
the diode waveforms. Figure 12.31 illustrates typical DCM waveforms, for current-programmed control 
with an artificial ramp having slope- ma. The inductor current is zero at the beginning of each switching 
period. By solution of the transistor conduction subinterval, the programmed current ipk can be related to 
the transistor duty cycle d1 by: 
ic=ipk+mad1T, 
= (m 1 +ma)d1T, 
(12.103) 
Solution for d1 leads to 
(12.104) 
The average transistor current is found by integrating the i1(t) waveform of Fig. 12.31 over one switching 
period: 
(12.105) 
The total area q 1 is equal to one-half of the peak current ipk' multiplied by the subinterval length d1 T,. 
Hence, 
(12.106) 
Elimination of ipk and d1, to express the average transistor current as a function of ic, leads to 
(12.107) 
Finally, Eq. (12.107) can be rearranged to obtain the averaged switch network input port relationship: 
(12.108) 

12.4 Discontinuous Conduction Mode 
475 
Thus, the average transistor waveforms obey a power sink 
characteristic. When ma = 0, then the average power 
il.(t) 
(p(t))Ts is a function only of L, ic, and.fs. The presence of 
the artificial ramp causes (p(t) >r, to additionally depend 
on the converter voltages, via m1• 
ic 
The power sink characteristic can also be 
explained via inductor energy arguments. During the first 
subinterval, the inductor current increases from 0 to ipk' In 
the process, the inductor stores the following energy: 
W 
1L.z 
= 2 lpk 
(12.109) 
The energy W is transferred from the power input vg, 
through the· switch network input port, to the inductor, 
once per switching period. This energy transfer process 
accounts for the power flow 
0 
( Vz(l)) T 
ipk 
(il(t))T : 
l 
.t
. 
• 
The switch network input port, that is, the transistor ter-
minals, can therefore be modeled by a power sink ele-
ment, as in Fig. 12.32. 
The average switch network output port current, 
that is, the average diode current, is 
... ~ ........... 
h··~ ····················r······· ... f .......... . 
(12.111) 
By inspection of Fig. 12.31, the area q2 is given by 
(12.112) 
The duty cycle d2 is determined by the time required for 
the inductor current to return to zero, during the second 
subinterval. By arguments similar to those used to derive 
Eq. (11.12), the duty cycle d2 can be found as follows: 
ipk 
Area q2 1 
(i2(1))T, 
t 
. 
...................... ··--~- ·· · ·· · 
· ··~··········-r .. ··········· 
~T, 
----T, 
Fig. 12.31 
example. 
Waveforms, CPM DCM buck- boost 
(12.113) 
Substitution of Eqs. (12.113), (12.112), and (12.110) into Eq. (12.111) yields 
(12.114) 
The output port of the averaged switch network is therefore described by the relationship 

476 
Current Programmed Control 
(it(t))r 
s 
(izCt)) T 
s 
+ 
(vt(t))r 
( vz(t)) r, 
+ 
s 
(vg(t)Jr, 
+ 
+ 
(v(t)) T 
c 
R 
s 
Fig. 12.32 CPM DCM buck-boost converter model, derived via averaged switch modeling. 
(12.115) 
In the averaged model, the diode can be replaced by a power source of value (p(t) >r,• equal to the power 
apparently consumed at the switch network input port. During the second subinterval, the inductor 
releases all of its stored energy through the diode, to the converter output. This results in an average 
power flow of value (p(t) >r,-
A CPM DCM buck-boost averaged model is therefore as given in Fig. 12.32. In this model, the 
transistor is simply replaced by a power sink of value (p(t))r,, while the diode is replaced by a power 
source also of value (p(t) >r,-
The steady-state equivalent circuit model of the CPM DCM buck-boost converter is obtained by 
letting the inductor and capacitor tend to short- and open-circuits, respectively. The model of Fig. 12.33 
is obtained. The steady-state output voltage V can now be determined by equating the de load power to 
the converter average power (p(t) >r,- For a resistive load, one obtains 
(12.116) 
where the steady state value of (p(t) )r, is given by 
(12.117) 
and where lc is the steady-state value of the control input ic(t). Solution for Vyields the following result 
Fig. 12.33 Steady-state model of the CPM DCM 
buck-boost converter. 
R 
+ 
v 

12.4 Discontinuous Conduction Mode 
477 
(a) 
+ 
Fig. 12.34 
Averaged models 
hCt))Ts 
c 
R 
(vCt))r s 
of current-programmed DCM 
converters: (a) buck, (b) boost. 
(b) 
L 
+ 
h(t))T, 
c 
R 
(v(tl)r, 
RLJ; 
(12.118) 
for the case of a resistive load. 
Averaged models of the DCM CPM buck, boost, and other converters can be found in a similar 
manner. In each case, the average transistor waveforms are shown to follow a power sink characteristic, 
while the average diode waveforms follow a power source characteristic. The resulting equivalent cir-
cuits of the CPM DCM buck and boost converters are illustrated in Fig. 12.34. In each case, the average 
power is given by 
Table 12.6 
Steady-state DCM current-programmed characteristics of basic converters 
Converter 
Buck 
Boost 
Buck-boost 
M 
Depends on load characteristic: 
pload= p 
Stability range when rna = 0 
(1c-~maTs) 
O~D~ 1 
2M 
(1c-~maTs) 
O~D~ 1 
2(M-1) 

478 
Current Programmed Control 
(a) 
+ 
+ 
JJ, 
J,l, 
R 
---------------------------------------------------------·············-···········-···········-······-----------------------J 
(b) 
+ 
R 
(c) 
i I 
;·--------------------------------------------------------·-------------------------------------------------------------~ j 2 
+ 
JJ, 
+ 
+ 
' 
L------L------~--~ 
•• 
c 
R 
L ............ ------------------------------------------------------------------------------------------------------------------1 
L 
i, 
Fig. 12.35 Small-signal models of DCM CPM converters, derived by perturbation and linearization of Figs. 
12.32 and 12.34: (a) buck, (b) boost, (c) buck-boost. 
(12.119) 
~ Li~(t)f, 
(pCt))Ts = ( 1 + :: )2 
with m1 defined as in Eq. (12.1). 
Steady-state characteristics of the DCM CPM buck, boost, and buck-boost converters are sum-
marized in Table 12.6. In each case, the de load power is Pzoad = VI and Pis given by Eq. (12.117). The 
conditions for operation of a current programmed converter in the discontinuous conduction mode can be 
expressed as follows: 
(12.120) 
III > II critl 
for CCM 
I I I < I I critl 
for DCM 
where I is the de load current. The critical load current at the CCM-DCM boundary, Icrit' is expressed as 
a function of Ic and the voltage conversion ratio M = V/V8 in Table 12.6. 
In the discontinuous conduction mode, the inductor current is zero at the beginning and end of 

12.4 Discontinuous Conduction Mode 
419 
Table 12.7 Current programmed DCM small-signal equivalent circuit parameters: input port 
Converter 
g, 
J, 
( 1 rna) 
2!1 
1 ( M2 } -ml 
R 1-M ( 1 + ::) 
[c 
Buck 
R 
-i(M~1) 
2]_ 
[c 
Boost 
Buck-boost 
0 
(1 +:a) 
-R 
1 
M2 ( 1_ 
:~) 
Table 12.8 Current programmed DCM small-signal equivalent circuit parameters: output port 
Converter 
g2 
!2 
r2 
Buck 
l M ( :~ (2-M)-M} 
2]_ 
R(l-MJ(l+::) 
R ( 1=M) 
( 1 + 
:~) 
[c 
(1-2M+::} 
Boost 
i(M~l) 
2!.1. 
R(MMl) 
I c 
Buck-boost 
2M (::) 
2!.1. 
R 
R (1 + ::) 
[c 
each switching period. As a result, the current programmed controller does not exhibit the type of insta-
bility described in Section 12.1. The current programmed controllers of DCM boost and buck-boost con-
verters are stable for all duty cycles with no artificial ramp. However, the CPM DCM buck converter 
exhibits a different type of low-frequency instability when M > 2/3 and rna= 0, that arises because the de 
output characteristic is nonlinear and can exhibit two equilibrium points when the converter drives a 
resistive load. The stability range can be extended to 0 ~ D ~ 1 by addition of an artificial ramp having 
slope rna > 0.086 rn2, or by addition of output voltage feedback. 
Small-signal models of DCM CPM converters can be derived by perturbation and linearization 
of the averaged models of Figs. 12.32 and 12.34. The results are given in Fig. 12.35. Parameters of the 
small-signal models are listed in Tables 12.7 and 12.8. 
The CPM DCM small-signal models of Fig. 12.35 are quite similar to the respective small-sig-
nal models of DCM duty-ratio controlled converters illustrated in Figs. 11.15 and 11.17. The sole differ-
ences are the parameter expressions of Tables 12.7 and 12.8. Transfer functions can be determined in a 

480 
Current Programmed Control 
+ 
R v 
Fig. 12.36 Simplified small-signal model obtained by letting L become zero in Fig. 12.35 (a), (b), or (c). 
similar manner. In particular, a simple approximate way to determine the low-frequency small-signal 
transfer functions of the CPM DCM buck, boost, and buck-boost converters is to simply let the induc-
tance L tend to zero in the equivalent circuits of Fig. 12.35. This approximation is justified for frequen-
cies sufficiently less than the converter switching frequency, because in the discontinuous conduction 
mode the value of L is small, and hence the pole and any RHP zero associated with L occur at frequen-
cies near to or greater than the switching frequency. For all three converters, the equivalent circuit of Fig. 
12.36 is obtained. 
Figure 12.36 predicts that the control-to-output transfer function GvJs) is 
A I 
G 
G (s)= ~ 
=--dJ_ 
vc 
i c • - 0 
1 + ,.~ 
Vg-
UJP 
(12.121) 
with 
Gco = fz(Rllrz) 
(J) =--~-
p 
(RIIr2)C 
The line-to-output transfer function is predicted to be 
(12.122) 
with 
If desired, more accurate expressions which account for inductor dynamics can be derived by solution of 
the models of Fig. 12.35. 
12.5 
SUMMARY OF KEY POINTS 
1. 
In current-programmed control, the peak switch current i/t) follows the control input Vt). This widely 
used control scheme has the advantage of a simpler control-to-output transfer function. The line-to-output 
transfer functions of current-programmed buck converters are also reduced. 

References 
481 
2. 
The basic current-programmed controller is unstable when D > 0.5, regardless of the converter topology. 
The controller can be stabilized by addition of an artificial ramp having slope ma. When ma > 0.5m2, then 
the controller is stable for all duty cycles. 
3. 
The behavior of current-programmed converters can be modeled in a simple and intuitive manner by the 
first-order approximation (iL(t)\:,"' i/t). The averaged terminal waveforms ofthe switch network can then 
be modeled simply by a current source of value ic, in conjunction with a power sink or power source ele-
ment. Perturbation and linearization of these elements leads to the small-signal model. Alternatively, the 
small-signal converter equations derived in Chapter 7 can be adapted to cover the current programmed 
mode, using the simple approximation iL(t)"' ic(t). 
4. 
The simple model predicts that one pole is eliminated from the converter line-to-output and control-to-out-
put transfer functions. Current programming does not alter the transfer function zeroes. The de gains 
become load-dependent. 
5. 
The more accurate model of Section 12.3 correctly accounts for the difference between the average induc-
tor current ( iL(t) )r,. and the control input ic(t). This model predicts the nonzero line-to-output transfer func-
tion Gv/s) of the buck converter. The current-programmed controller behavior is modeled by a block 
diagram, which is appended to the small-signal converter models derived in Chapter 7. Analysis of the 
·resulting multiloop feedback system then !~ads to the relevant transfer functions. 
6. 
The more accurate model predicts that the inductor pole occurs at the crossover frequency fc of the effec-
tive current feedback loop gain ~(s). The frequency fc typically occurs in the vicinity of the converter 
switching frequency fs. The more accurate model also predicts that the line-to-output transfer function 
Gvg(s) of the buck converter is nulled when ma = 0.5m2. 
7. 
Current programmed converters operating in the discontinuous conduction mode are modeled in Section 
12.4. The averaged transistor waveforms can be modeled by a power sink, while the averaged diode wave-
forms are modeled by a power source. The power is controlled by ic(t). Perturbation and linearization of 
these averaged models, as usual, leads to small-signal equivalent circuits. 
REFERENCES 
[1] 
C. DEISCH, "Simple Switching Control Method Changes Power Converter into a Current Source," IEEE 
Power Electronics Specialists Conference, 1978 Record, pp. 300-306. 
[2] 
A. CAPEL, G. FERRANTE, D. 0' SULLIVAN, and A. WEINBERG, "Application of the Injected Current Model 
for the Dynamic Analysis of Switching Regulators with the New Concept of LC3 Modulator," IEEE Power 
Electronics Specialists Conference, 1978 Record, pp. 135-147. 
[3] 
S. Hsu, A. BROWN, L. RENSINK, and R. D. MIDDLEBROOK, "Modeling and Analysis of Switching De-to-
De Converters in Constant-Frequency Current Programmed Mode," IEEE Power Electronics Specialists 
Conference, 1979 Record, pp. 284-301. 
[4] 
F. C. LEE and R. A. CARTER, "Investigations of Stability and Dynamic Performances of Switching Regula-
tors Employing Current-Injected Control," IEEE Power Electronics Specialists Conference, 1981 Record, 
pp. 3-16. 
[5] 
R. D. MIDDLEBROOK, 'Topics in Multiple-Loop Regulators and Current-Mode Programming," IEEE 
Power Electronics Specialists Conference, 1985 Record, pp. 716-732. 
[6] 
R. D. MIDDLEBROOK, "Modeling Current Programmed Buck and Boost Regulators," IEEE Transactions 
on Power Electronics, Vol. 4, No. 1, January 1989, pp. 36-52. 

482 
Current Programmed Control 
[7] 
G. VERGHESE, C. BRUZOS, and K. MAHABIR, "Averaged and Sampled-Data Models for Current Mode 
Control: A Reexamination," IEEE Power Electronics Specialists Conference, 1989 Record, pp. 484-491. 
[8] 
D. M. MITCHELL, De-De Switching Regulator Analysis, New York: McGraw-Hill, 1988, Chapter 6. 
[9] 
A. KISLOVSKI, R. REDL, and N. SOKAL, Dynamic Analysis of Switching-Mode DC/DC Converters, New 
York: Van Nostrand Reinhold, 1994. 
[10] 
A. BROWN and R. D. MIDDLEBROOK, "Sampled-Data Modeling of Switching Regulators," IEEE Power 
Electronics Specialists Conference, 1981 Record, pp. 716-732. 
[11] 
R. RIDLEY, "A New Continuous-Time Model for Current-Mode Control," IEEE Transactions on Power 
Electronics, Vol. 6, No.2, Apri11991, pp. 271-280. 
[12] 
F. D. TAN and R. D. MIDDLEBROOK, "Unified Modeling and Measurement of Current-Programmed Con-
verters," IEEE Power Electronics Specialists Conference, 1993 Record, pp. 380-387. 
[13] 
R. TYMERSKI, "Sampled-Data Modeling of Switched Circuits, Revisited," IEEE Power Electronics Spe-
cialists Conference, 1993 Record, pp. 395-401. 
[14] 
W. TANG, F. C. LEE, R. B. RIDLEY and I. COHEN, "Charge Control: Modeling, Analysis and Design," 
IEEE Power Electronics Specialists Conference, 1992 Record, pp. 503-511. 
[15] 
K. SMEDLEY and S. CUK, "One-Cycle Control of Switching Converters," IEEE Power Electronics Special-
ists Conference, 1991 Record, pp. 888-896. 
PROBLEMS 
12.1 
A nonideal buck converter operates in the continuous conduction mode, with the values Vg = 10 V,f2 = 
100kHz, L = 4 fLH, C = 75 fLF, and R = 0.25 Q. The desired full-load output is 5 Vat 20 A. The power 
stage contains the following loss elements: MOSFET on-resistance Ron = 0.1 Q, Schottky diode forward 
voltage drop VD = 0.5 V, inductor winding resistance RL = 0.03 Q. 
(a) 
Steady-state analysis: determine the converter steady-state duty cycle D, the inductor current 
ripple slopes m1 and m2, and the dimensionless parameter K = 2L/RT,. 
(b) 
Determine the small-signal equations for this converter, for duty cycle control. 
A current-programmed controller is now implemented for this converter. An artificial ramp is used, hav-
ing a fixed slope Ma = 0.5M2, where M2 is the steady-state slope m2 obtained with an output of 5 Vat 20 
A. 
(c) 
Over what range of D is the current programmed controller stable? Is it stable at rated output? 
Note that the nonidealities affect the stability boundary. 
(d) 
Determine the control-to-output transfer function Gvc(s), using the simple approximation 
(iL(t))r, "'ic(t). Give analytical expressions for the corner frequency and de gain. Sketch the 
Bode plot of Gvc(s). 
12.2 
Use the averaged switch modeling approach to model the CCM boost converter with current-pro-
grammed control: 
(a) 
Define the switch network terminal quantities as in Fig. 7.46(a). With the assumption that 
(iL(t))r,"' ic(t), determine expressions for the average values of the switch network terminal 
waveforms, and hence derive the equivalent circuit of Fig. 12.18(a). 

Problems 
483 
(b) 
Perturb and linearize your model of part (a), to obtain the equivalent circuit of Fig. 12.22. 
(c) 
Solve your model of part (b), to derive expressions for the control-to-output transfer function 
Gvc(s) and the line-to-output transfer function Gvg(s). Express your results in standard normal-
ized form, and give analytical expressions for the corner frequencies and de gains. 
12.3 
Use the averaged switch modeling approach to model the CCM Cuk converter with current-programmed 
control. A Cuk converter is diagrammed in Fig. 2.20. 
(a) 
It is desired to model the switch network with an ic current source and a dependent power source 
or sink, using the approach of Section 12.2.2. How should the switch network terminal voltages 
and currents be defined? 
(b) 
Sketch the switch network terminal voltage and current waveforms. With the assumption that 
(i1(t))J:,- (iit)\, "'ic(t) (where i 1 and i2 are the inductor currents defined in Fig. 2.20), deter-
mine expressions for the average values of the switch network terminal waveforms, and hence 
derive an equivalent circuit similar to the equivalent circuits of Fig. 12.18. 
(c) 
Perturb and linearize your model of part (b), to obtain a small signal equivalent circuit similar to 
the model of Fig. 12.19. It is not necessary to solve your model. 
12.4 
The full-bridge converter of Fig. 6.19(a) operates with Vg = 320 V, and supplies 1000 W to a 42 V resis-
tive load. Losses can be neglected, the duty cycle is 0.7, and the switching period T, defined in Fig. 6.20 
is 10 11sec. L =50 11H and C = 100 11F. A current-programmed controller is employed, whose waveforms 
are referred to the secondary side of the transformer. In the following calculations, you may neglect the 
transformer magnetizing current. 
(a) 
What is the minimum artificial ramp slope m0 that will stabilize the controller at the given oper-
ating point? Express your result in terms of m2. 
(b) 
An artificial ramp having the slope m" = m2 is employed. Sketch the Bode plot of the current 
loop gain T;(s ), and label numerical values of the corner frequencies and de gains. It is not neces-
sary tore-derive the analytical expression for 'f;. Determine the crossover frequency fc· 
(c) 
For m0 = m2, sketch the Bode plots of the control-to-output transfer function Gvc(s) and line-to-
output transfer function GvgCs), and label numerical values of the corner frequencies and de 
gains. It is not necessary tore-derive analytical expressions for these transfer functions. 
12.5 
In a CCM current-programmed buck converter, it is desired to minimize the line-to-output transfer func-
tion Gvg(s) via the choice ma = 0.5m2. However, because of component tolerances, the value of induc-
tance L can vary by ±10% from its nominal value of 100 11H. Hence, m" is fixed in value while m2 varies, 
and ma = 0.5m2 is obtained only at the nominal value of L. The switching frequency is I 00 kHz, the out-
put voltage is 15 V, the load current varies over the range 2 to 4 A, and the input voltage varies over the 
range 22 to 32 V. You may neglect losses. Determine the worst-case (maximum) value of the line-to-out-
put de gain Gvg(O). 
12.6 
The nonideal flyback converter of Fig. 7.18 employs current-programmed control, with artificial ramp 
having slope ma. MOSFET Q1 exhibits on-resistance Ron· All current programmed controller waveforms 
are referred to the transformer primary side. 
(a) 
Derive a block diagram which models the current-programmed controller, of form similar to Fig. 
12.24. Give analytical expressions for the gains in your block diagram. 
(b) 
Combine your result of part (a) with the converter small-signal model. Derive a new expression 
for the control-to-output transfer function Gvc(s). 
12.7 
A buck converter operates with current-programmed control. The element values are: 
vg = 12ov 
R= lOQ 
L = 550 11H 
D=0.6 
f, =100kHz 
C=lOO!lF 

484 
Current Programmed Control 
An artificial ramp is employed, having slope 0.15 A!Jl.sec. 
(a) 
Construct the magnitude and phase asymptotes of the control-to-output transfer function Gvis) 
for duty-cycle control. On the same plot, construct the magnitude and phase asymptotes of the 
control-to-output transfer function Gvc(s) for current-programmed control. Compare. 
(b) 
Construct the magnitude asymptotes of the line-to-output transfer function Gv8(s) for duty-cycle 
control. On the same plot, construct the magnitude asymptotes of the line-to-output transfer 
function Gvg·cpm(s) for current-programmed control. Compare. 
12.8 
A buck-boost converter operates in the discontinuous conduction mode. Its current-programmed control-
ler has no compensating artificial ramp: rna = 0. 
(a) 
Derive an expression for the control-to-output transfer function Gvc(s), using the approximation 
L"' 0. Give analytical expressions for the corner frequency and de gain. 
(b) 
Repeat part (a), with the inductor included. Show that, provided the inductor is sufficiently 
small, then the inductor merely adds a high-frequency pole and zero to Gvc(s), and the low-fre-
quency pole derived in part (a) is essentially unchanged. 
(c) 
At the CCM-DCM boundary, what is the minimum value of the RHP zero frequency? 
12.9 
A current-programmed boost converter interfaces a 3 V battery to a small portable 5 V load. The con-
verter operates in the discontinuous conduction mode, with constant transistor on-time t0 n and variable 
off-time; the switching frequency can therefore vary and is used as the control variable. There is no arti-
ficial ramp, and the peak transistor current ic is equal to a fixed value Ic; in practice, Ic is chosen to mini-
mize the total loss. 
12.:1.0 
(a) 
Sketch the transistor and diode voltage and current waveforms. Determine expressions for the 
waveform average values, and hence derive a large-signal averaged equivalent circuit for this 
converter. 
(b) 
Perturb and linearize your model of part (a), to obtain a small-signal equivalent circuit. Note that 
the switching frequency!, should be perturbed. 
(c) 
Solve your model of part (b), to derive an expression for the low-frequency control-to-output 
transfer function GvJs) = v(s)ll,(s). Express your results in standard normalized form, and give 
analytical expressions for the corner frequencies and de gains. You may assume that Lis small. 
A current-programmed boost converter is employed in a low-harmonic rectifier system, in which the 
input voltage is a rectified sinusoid: v 8(t) = V M I sin(Wt) 1. The de output voltage is v(t) = V > V M· The 
capacitance Cis large, such that the output voltage contains negligible ac variations. It is desired to con-
trol the converter such that the input current i8(t) is proportional to vgCt): igCt) = vgCt)!Re, where Re is a 
constant, called the "emulated resistance." The averaged boost converter model of Fig. 12.18(a) suggests 
that this can be accomplished by simply letting ic(t) be proportional to vgCt), according to ic(t) = vgCt)!Re. 
You may make the simplifying assumption that the converter always operates in the continuous conduc-
tion mode. 
(a) 
Solve the model of Fig. 12.18(a), subject to the assumptions listed above, to determine the 
power (p(t) )r,.· Find the average value of (p(t) )Ts' averaged over one cycle of the ac input v8(t). 
(b) 
An artificial ramp is necessary to stabilize the current-programmed controller at some operating 
points. What is the minimum value of rna that ensures stability at all operating points along the 
input rectified sinusoid? Express your result as a function of V and L. Show your work. 
(c) 
The artificial ramp and inductor current ripple cause the average input current to differ from ic(t). 
Derive an algebraic expression for ( igCt) )Ts' as a function of ic(t) and other quantities such as rn0 , 
v gCt). V, L, and Ts. For this part, you may assume that the inductor dynamics are negligible. Show 
your work. 
(d) 
Substitute v8(t) = VM I sin(Wt) I and ic(t) = vgCt)/Re, into your result of part (c), to determine an 
expression for igCt). How does igCt) differ from a rectified sinusoid? 

Switch network 
i,(t) 
+ 
& 
1------;S 
Analog 
comparator 
Problems 
485 
+ 
v(t) 
R 
Charge controller 
Control 
input 
Fig. 12.37 
Buck converter with charge controller, Problem 12.11. 
12.11 
Figure 12.37 shows a buck converter with a charge controller [14]. Operation of the charge controller is 
similar to operation of the current-programmed controller. At the beginning of each switching period, at 
time t = 0, a short clock pulse sets the SR latch. The logic high signal at the Q output of the latch turns 
the power MOSFET on. At the same time, the logic low signal at the Q output of the latch turns the 
switch S, off. Current KJ, proportional to the power MOSFET current charges the capacitor C,. At 
t = dT,, the capacitor voltage vqCt) reaches the control input voltage R1ic, the comparator output goes 
high and resets the latch. The logic low signal at the Q output of the latch turns the power MOSFET off. 
At the same time, the logic high signal at the Q output of the latch turns the switch S, on, which quickly 
discharges the capacitor C, to zero. 
In this problem, the converter and controller parameters are: V8 = 24 V, f, = liT, = 100 kHz, 
L = 60 ftH, C = 100 ftF, R = 3 Q, K,T/C, = R1= 1 Q. You can assume that the converter operates in con-
tinuous conduction mode. 
(a) 
Find expressions for the average values of the switch network terminal waveforms, and hence 
derive a large-signal averaged switch model of the buck switch network with charge control. The 
control input to the model is the control current ic. The averaged switch model should consist of 
a current source and a power source. The switch duty cycle d should not appear in the model. 
(b) 
Using the averaged switch model derived in part (a), find an expression for the quiescent output 
voltage Vas a function of V8, Ic, and R. Given Ic = 2 A, find numerical values for V, Ii' 12, and the 
duty cycle D. For this quiescent operating point, sketch the waveforms i 1 (t), i2(t), and v qCt) dur-
ing one switching period. 
(c) 
Perturb and linearize the averaged switch model from part (a) to derive a small-signal averaged 
switch model for the buck switch network with charge control. Find analytical expressions for 

486 
Current Programmed Control 
all parameter values in terms of the converter parameters and the quiescent operating conditions. 
Sketch the complete small-signal model of the buck converter with the charge controller. 
(d) 
Solve the model obtained in part (c) to find the control-to-output transfer function Gv/s) = V!ic. 
At the quiescent operating point found in part (b), construct the Bode plot for the magnitude of 
Gvc and label all salient features of the magnitude response. 
(e) 
Comment on advantages charge control may have compared to duty-cycle control or current-
programmed control. 
12.12 
Figure 12.38 shows a buck converter with a one-cycle controller [15]. Operation of the one-cycle con-
troller is similar to operation of the current-programmed controller. At the beginning of each switching 
period, at time t = 0, a short clock pulse sets the SR latch. The logic high signal at the Q output of the 
latch turns the power MOSFET on. At the same time, the logic low signal at the Q output of the latch 
turns the switch S8 off. Current G,.vit) proportional to the voltage vit) charges the capacitor C8• At 
t = dT,., the capacitor voltage v,(t) reaches the control input voltage v c' the comparator output goes high 
and resets the latch. The logic low signal at the Q output of the latch turns the power MOSFET off. At 
the same time, the logic high signal at the Q output of the latch turns the switch S8 on, which quickly 
discharges the capacitor C8 to zero. 
In this problem, the converter and controller parameters are: Vg = 24 V, fs = l!Ts = 100 kHz, 
L = 60 J.!H, C = 100 J.!F, R = 3 Q, G8T/Cs = 1. You can assume that the converter operates in the continu-
ous conduction mode. 
(a) 
Find expressions for the average values of the switch network terminal waveforms, and hence 
derive a large-signal averaged switch model of the buck switch network with one-cycle control. 
The control input to the model is the control voltage v c· The switch duty cycle d should not 
appear in the model 
Switch network 
i2(t) 
+ 
+ 
v2(t) 
·----- -------- ............................ .. 
1-t:..,_T_, -'-'--1 S 
Analog 
comparator 
R 
+ 
v(t) 
One-cycle controller 
Control 
input 
Fig. 12.38 Buck converter with one-cycle controller, Problem 12.12. 

Problems 
487 
(b) 
Using the averaged switch model derived in part (a), find an expression for the quiescent output 
voltage Vas a function of Vc. Given Vc = 10 V, find the numerical values for V, 11' 12, and the duty 
cycle D. For this quiescent operating point, sketch the waveforms i1(t), iit), and v/t) during one 
switching period. 
(c) 
Perturb and linearize the averaged switch model from part (a) to derive a small-signal averaged 
switch model for the buck switch network with one-cycle control. Find analytical expressions 
for all parameter values in terms of the converter parameters and the quiescent operating condi-
tions. Sketch the complete small-signal model of the buck converter with the one-cycle control-
ler. 
(d) 
Solve the model obtained in part (c) to find the control-to-output transfer function Gvc(s) = V!vc, 
and the line-to-output transfer function GvgCs) = v!vg. For the quiescent operating point found in 
part (b), sketch the magnitude Bode plots of these transfer functions, and label all salient fea-
tures. 
(e) 
Comment on advantages one-cycle control may have compared to duty-cycle control. 

Part III 
Magnetics 

13 
Basic Magnetics Theory 
Magnetics are an integral part of every switching converter. Often, the design of the magnetic devices 
cannot be isolated from the converter design. The power electronics engineer must not only model and 
design the converter, but must model and design the magnetics as well. Modeling and design of magnet-
ics for switching converters is the topic of Part III of this book. 
In this chapter, basic magnetics theory is reviewed, including magnetic circuits, inductor model-
ing, and transformer modeling [1-5]. Loss mechanisms in magnetic devices are described. Winding eddy 
currents and the proximity effect, a significant loss mechanism in high-current high-frequency windings, 
are explained in detail [6-11]. Inductor design is introduced in Chapter 14, and transformer design is cov-
ered in Chapter 15. 
13.1 
REVIEW OF BASIC MAGNETICS 
13.1.1 
Basic Relationships 
The basic magnetic quantities are illustrated in Fig. 13.1. Also illustrated are the analogous, and perhaps 
more familiar, electrical quantities. The magnetomotive force tif, or scalar potential, between two points 
x 1 and x2 is given by the integral of the magnetic field H along a path connecting the points: 
(13.1) 
where dl is a vector length element pointing in the direction of the path. The dot product yields the com-

492 
Basic Magnetics Theory 
Magnetic quantities 
,._ Length e _
, 
Magnetic field H 
XI 
X2 
Total flux <I> 
Flux density B { 
+........_ MMF ,...--
:j" = HC 
SurfaceS 
tlh areaAc 
Electrical quamities 
,,._ Length f _
, 
Electric field E 
Total current I 
Current density J { 
SurfaceS 
th area Ac 
Fig. 13.1 
Comparison of magnetic field H, MMF <I>, flux :Ji, and flux density B, with the analogous electrical quan-
tities E, V, /, and 1. 
ponent of H in the direction of the path. If the magnetic field is of uniform strength H passing through an 
element of length e as illustrated, then Eq. (13.1) reduces to 
(13.2) 
This is analogous to the electric field of uniform strength £, which induces a voltage V = Ee between two 
points separated by distance e. 
Figure 13.1 also illustrates a total magnetic flux <I> passing through a surface S having area A c. 
The total flux <I> is equal to the integral of the normal component of the flux density B over the surface 
<f>= I 8-dA 
(13.3) 
StlrfaceS 
where dA is a vector area element having direction normal to the surface. For a uniform flux density of 
magnitude B as illustrated, the integral reduces to 
(13.4) 
Flux density B is analogous to the electrical current density ] , and flux ([I is analogous to the electric cur-
rent/. If a uniform current density of magnitude J passes through a surface of area Ac, then the total cur-
rent is I= lAc. 
Faraday's law relates the voltage induced in a winding to the total flux passing through the inte-
rior of the winding. Figure 13.2 illustrates flux $(t) passing through the interior of a loop of wire. The 
loop encloses cross-sectional area Ac. According to Faraday's law, the flux induces a voltage v(t) in the 
wire, given by 
v(t) = d!?) 
(13.5) 
where the polarities of v(t) and $(t) are defined according to the right-hand rule, as in Fig. 13.2. For a 

13.1 
Review of Basic Magnetics 
493 
Fig. 13.2 The voltage v(t) induced in a loop of wire is 
related by Faraday's law to the derivative of the total flux <l>(t) 
passing through the interior of the loop. 
Flux <l>(t) 
uniform flux distribution, we can express v(t) in terms of the flux density B(t) by substitution of Eq. 
(13.4): 
() =A dB(t) 
v t 
c 
dt 
(13.6) 
Thus, the voltage induced in a winding is related to the flux <1> and flux density B passing through the 
interior of the winding. 
Lenz's law states that the voltage v(t) induced by the changing flux <P(t) in Fig. 13.2 is of the 
polarity that tends to drive a current through the loop to counteract the flux change. For example, con-
sider the shorted loop of Fig. 13.3. The changing flux <P(t) passing through the interior of the loop 
induces a voltage v(t) around the loop. This voltage, divided by the impedance of the loop conductor, 
leads to a current i(t) as illustrated. The current i(t) induces a flux <1>' (t), which tends to oppose the 
changes in <P(t). Lenz's law is invoked later in this chapter, to provide a qualitative understanding of eddy 
current phenomena. 
Ampere's law relates the current in a winding to the magnetomotive force :7 and magnetic field 
H. The net MMF around a closed path of length em is equal to the total current passing through the inte-
rior of the path. For example, Fig. 13.4 illustrates a magnetic core, in which a wire carrying current i(t) 
passes through the window in the center of the core. Let us consider the closed path illustrated, which 
follows the magnetic field lines around the interior of the core. Ampere's law states that 
~ 
H ·df = total current passing through interior of path 
(13.7) 
closed path 
The total current passing through the interior of the path is equal to the total current passing through the 
Fig. 13.3 Illustration of Lenz's law in a shorted loop of wire. The flux 
<l>(t) induces current i(t), which in turn generates flux <.l>'(t) that tends to 
oppose changes in <.l>(t). 
Shorted 
loop 

494 
Basic Magnetics Theory 
Fig. 13.4 The net MMF around a closed 
path is related by Ampere's law to the total 
current passing through the interior of the 
path. 
i(t) 
!"-
!"-
H 
~ 
1'\ 
1--
'\ 
Magnetic path 
length t,. 
window in the center of the core, or i(t). If the magnetic field is uniform and of magnitude H(t), then the 
integral is H(t)€ 111 • So for the example of Fig. 13.4, Eq. (13.7) reduces to 
.7(t) = H(t)e,., = i(t) 
(13.8) 
Thus, the magnetic field strength H(t) is related to the winding current i(t). We can view winding currents 
as sources of MMF. Equation (13.8) states that the MMF around the core, :IJ(t) = H(t)€,., is equal to the 
winding current MMF i(t). The total MMF around the closed loop, accounting for both MMFs, is zero. 
The relationship between B and H, or equivalently between ct> and .<17, is determined by the core 
material characteristics. Figure 13.5(a) illustrates the characteristics of free space, or air: 
(13.9) 
The quantity flo is the permeability of free space, and is equal to 4n · 10-7 Henries per meter in MKS 
units. Figure 13.5(b) illustrates the B-H characteristic of a typical iron alloy under high-level sinusoidal 
steady-state excitation. The characteristic is highly nonlinear, and exhibits both hysteresis and saturation. 
The exact shape of the characteristic is dependent on the excitation, and is difficult to predict for arbitrary 
waveforms. 
For purposes of analysis, the core material characteristic of Fig. 13.5(b) is usually modeled by 
the linear or piecewise-linear characteristics of Fig. 13.6. In Fig. 13.6(a), hysteresis and saturation are 
ignored. The B-H characteristic is then given by 
(a) 
B 
(b) 
B 
H 
Fig. 13.5 
B- H characteristics: (a) of free space or air, (b) of a typical magnetic core material. 

13.1 
Review of Basic Magnetics 
495 
(a) 
B 
(b) 
B 
H 
H 
Fig. 13.6 
Approximation of the B-H characteristics of a magnetic core material: (a) by neglecting both hysteresis 
and saturation, (b) by neglecting hysteresis. 
(13.10) 
The core material permeability Jl can be expressed as the product of the relative permeability Jl, and of 
Jlo· Typical values of Jl, lie in the range 103 to 105. 
The piecewise-linear model of Fig. 13.6(b) accounts for saturation but not hysteresis. The core 
material saturates when the magnitude of the flux density B exceeds the saturation flux density Bsar For 
I B I < Bsat' the characteristic follows Eq. (13.10). When I B I > Bsat' the model predicts that the core 
reverts to free space, with a characteristic having a much smaller slope approximately equal to Jlo· 
Square-loop materials exhibit this type of abrupt-saturation characteristic, and additionally have a very 
large relative permeability Jl,. Soft materials exhibit a less abrupt saturation characteristic, in which Jl 
gradually decreases asH is increased. Typical values of Bsat are 1 to 2 Tesla for iron laminations and sili-
con steel, 0.5 to 1 Tesla for powdered iron and molypermalloy materials, and 0.25 to 0.5 Tesla for ferrite 
materials. 
Unit systems for magnetic quantities are summarized in Table 13.1. The MKS system is used 
throughout this book. The unrationalized cgs system also continues to find some use. Conversions 
between these systems are listed. 
Figure 13.7 summarizes the relationships between the basic electrical and magnetic quantities 
of a magnetic device. The winding voltage v(t) is related to the core flux and flux density via Faraday's 
Table 13.1 
Units for magnetic quantities 
Quantity 
MKS 
Core material equation 
B 
Tesla 
H 
Ampere/meter 
Weber 
Unrationalized cgs 
Gauss 
Oersted 
Maxwell 
Conversions 
1 A/m = 4n · 10-3 Oe 
1 Wb= 108 Mx 
1 T = 1 Wb/m2 

496 
Basic Magnetics Theory 
Fig. 13.7 Summary ofthe steps in determina-
tion of the terminal electrical i-v characteristics 
of a magnetic element. 
Faraday's law 
v(t) ~--------. 
Terminal 
characteristics 
i(t) ~--------. 
Ampere's law 
B(t), <f>(t) I 
Core 
characteristics 
H(t), :ff(t) 
law. The winding current i(t) is related to the magnetic field strength via Ampere's law. The core material 
characteristics relate B and H. 
We can now determine the electrical terminal characteristics of the simple inductor of Fig. 
13.8(a). A winding of n turns is placed on a core having permeability p.. Faraday's law states that the flux 
<t>(t) inside the core induces a voltage vturn(t) in each tum of the winding, given by 
(13.11) 
Since the same flux <f>(t) passes through each tum of the winding, the total winding voltage is 
dr:IJ(t) 
v(t) = nv,u,(t) = n ~ 
(13.12) 
Equation (13.12) can be expressed in terms of the average flux density B(t) by substitution ofEq. (13.4): 
Fig. 13.8 
Inductor example: (a) inductor 
geometry, (b) application of Ampere's law. 
v(t) = nA dB(t) 
c dt 
(a) 
i(t) 
+ 
II 
v(t) turns 
-
(b) 
i(t) 
II 
turns 
I 
'\.. 
'\.. 
<I> 
1'\ 
core 
H 
"\ 
'\ 
(13.13) 
"\ 
1- Core area 
A,. 
~ 
~ 
"\ 
I"\ 
I-"' v 
"\ 
Core 
permeability 
ll 
Magnetic 
path 
length em 

13.1 
Review of Basic Magnetics 
497 
where the average flux density B(t) is <P(t)/Ac. 
The use of Ampere's law is illustrated in Fig. 13.8(b). A closed path is chosen which follows an 
average magnetic field line around the interior of the core. The length of this path is called the mean 
magnetic path length em. If the magnetic field strength H(t) is uniform, then Ampere's law states that Hem 
is equal to the total current passing through the interior of the path, that is, the net current passing 
through the window in the center of the core. Since there are n turns of wire passing through the window, 
each carrying current i(t), the net current passing through the window is ni(t). Hence, Ampere's law 
states that 
H(t)e, = ni(t) 
(13.14) 
Let us model the core material characteristics by neglecting hysteresis but accounting for satu-
ration, as follows: 
{
Bsat 
B= 
JlH 
-Bsat 
for H :2: B,a/Jl 
for I HI< B,a/Jl 
for H :-:;- B,a/Jl 
(13.15) 
The B-H characteristic saturated slope Jlo is much smaller than Jl, and is ignored here. A characteristic 
similar to Fig. 13.6(b) is obtained. The current magnitude !,.at at the onset of saturation can be found by 
substitution of H = Bsa/11 into Eq. (13.14). The result is 
I - B'",€"' 
sat-
Jln 
(13.16) 
We can now eliminate Band H from Eqs. (13.13) to (13.15), and solve for the electrical terminal charac-
teristics. For I I I< !sat' B = J1H. Equation (13.13) then becomes 
dH(t) 
v(t)= 11nA --
,.., 
c 
dt 
Substitution ofEq. (13.14) into Eq. (13.17) to eliminate H(t) then leads to 
which is of the form 
with 
v(t) = Jln 2Ac di(t) 
em 
dt 
v(t) = L di(t) 
dt 
(13.17) 
(13.18) 
(13.19) 
(13.20) 
So the device behaves as an inductor for Ill < Isar When I I I >!sat' then the flux density B(t) = Bsat is con-
stant. Faraday's law states that the terminal voltage is then 

498 
Basic Magnetics Theory 
dB 
v(t) = nAc d;"' = 0 
(13.21) 
When the core saturates, the magnetic device behavior approaches a short circuit. The device behaves as 
an inductor only when the winding current magnitude is less than Isar Practical inductors exhibit some 
small residual inductance due to their nonzero saturated permeabilities; nonetheless, in saturation the 
inductor impedance is greatly reduced, and large inductor currents may result. 
13.1.2 
Magnetic Circuits 
Figure 13 .9(a) illustrates uniform flux and. magnetic field inside a element having permeability JJ , length 
€, and cross-sectional area Ac . The MMF between the two ends of the element is 
(13.22) 
Since H = B/fl and B = <1>/Ac, we can express :If as 
(13.23) 
This equation is of the form 
(13.24) 
with 
(13.25) 
Equation (1324) resembles Ohm's law. This equation states that the magnetic flux through an element is 
proportional to the MMF across the element. The constant of proportionality, or the reluctance fll, is 
analogous to the resistance R of an electrical conductor. Indeed, we can construct a lumped-element 
magnetic circuit model that corresponds to Eq, (13.24), as in Fig. 13.9(b). In this magnetic circuit model, 
voltage and current are replaced by MMF and flux, while the element characteristic, Eq. (13.24), is rep-
resented by the analog of a resistor, having reluctance fll. 
(a) 
Complicated magnetic structures, composed of multiple windings and multiple heterogeneous 
.- Lengthe-. 
+ -
MMF fl -- -
Area 
p~, ~ lJ 
:f~" P"moabm~" 
H 
.~= _e_ 
flA c 
(b) 
+- :;; -- -
Fig. 13.9 An element containing magnetic flux (a), and its equivalent magnetic circuit (b). 

13.1 
Review of Basic Magnetics 
499 
(a) 
Node 
(b) 
Node 
c[:J, = c[:J2 + c[:J3 
I 
1 
c[:J, 
c[:J3 
c[:Jl 
c[:J3 
--+ 
--+ 
1"''~1 
c[:J2 
Fig. 13.10 
Kirchoff's current law, applied to magnetic circuits: the net flux entering a node must be zero: (a) phys-
ical element, in which three legs of a core meet at a node; (b) magnetic circuit model. 
elements such as cores and air gaps, can be represented using equivalent magnetic circuits. These mag-
netic circuits can then be solved using conventional circuit analysis, to determine the various fluxes, 
MMFs, and terminal voltages and currents. Kirchoff's laws apply to magnetic circuits, and follow 
directly from Maxwell's equations. The analog of Kirchoff's current law holds because the divergence of 
B is zero, and hence magnetic flux lines are continuous and cannot end. Therefore, any flux line that 
enters a node must leave the node. As illustrated in Fig. 13.10, the total flux entering a node must be zero. 
The analog of Kirchoff's voltage law follows from Ampere's law, Eq. (13.7). The left-hand-side integral 
in Eq. (13.7) is the sum of the MMFs across the reluctances around the closed path. The right-hand-side 
of Eq. (13.7) states that currents in windings are sources of MMF. Ann-turn winding carrying current i(t) 
can be modeled as an MMF source, analogous to a voltage source, of value ni(t). When these MMF 
sources are included, the total MMF around a closed path is zero. 
Consider the inductor with air gap of Fig. 13.ll(a). A closed path following the magnetic field 
lines is illustrated. This path passes through the core, of permeability Jl and length ec, and across the air 
gap, of permeability Jlo and length eg. The cross-sectional areas of the core and air gap are approximately 
equal. Application of Ampere's law for this path leads to 
(13.26) 
where :'ic and f'i8 are the MMFs across the core and air gap, respectively. The core and air gap character-
istics can be modeled by reluctances as in Fig. 13.9 and Eq. (13.25); the core reluctance &lc and air gap 
reluctance .Oll8 are given by 
(a) 
i(t) 
+ 
v (t) 
n 
turns 
-
" 
Core 
permeability 1-1 
c[:J 
!"-. 
' 
p 
~ r 
" 
f.-
~~ 
f-
f-~ 
r---r--
" 
Cross-sectional 
areaAc 
Air gap 
eg 
Magnetic path 
length em 
(b) 
+ 
[ifc 
iflc 
ni(t) 
~ 
Fig. 13.11 
Inductor with air gap example: (a) physical geometry, (b) magnetic circuit model. 
+ 
&l ·g 
$ g 

500 
Basic Magnetics Theory 
(13.27) 
A magnetic circuit corresponding to Eqs. (13.26) and (13.27) is given in Fig. 13.ll(b). The winding is a 
source of MMF, of value ni. The core and air gap reluctances are effectively in series. The solution of the 
magnetic circuit is 
The flux ll>(t) passes through the winding, and so we can use Faraday's law to write 
Use of Eq. (13.28) to eliminate ll>(t) yields 
Therefore, the inductance L is 
(t) -
dcf>(t) 
v -n dt 
The air gap increases the total reluctance of the magnetic circuit, and decreases the inductance. 
(13.28) 
(13.29) 
(13.30) 
(13.31) 
Air gaps are employed in practical inductors for two reasons. With no air gap (Pilg = 0), the 
inductance is directly proportional to the core permeability p.. This quantity is dependent on temperature 
and operating point, and is difficult to control. Hence, it may be difficult to construct an inductor having 
a well-controlled value of L. Addition of an air gap having a reluctance Pllg greater than Pile causes the 
value of Lin Eq. (13.31) to be insensitive to variations in p.. 
Addition of an air gap also allows the inductor to operate at higher values of winding current i(t) 
without saturation. The total flux II> is plotted vs. the winding MMF ni in Fig. 13.12. Since II> is propor-
tional to B, and when the core is not saturated ni is proportional to the magnetic field strength H in the 
Fig. 13.12 Effect of air gap on the magnetic circuit cf> vs. ni 
characteristics. The air gap increases the current !sat at the 
onset of core saturation. 

13.2 
Transformer Modeling 
501 
core, Fig. 13.12 has the same shape as the core B-H characteristic. When the core is not saturated, <I> is 
related toni according to the linear relationship of Eq. (13.28). When the core saturates, <I> is equal to 
(13 .32) 
The winding current !sat at the onset of saturation is found by substitution of Eq. (13 .32) into (13.28): 
I 
=BsatAc(@ +ui>) 
sat 
n 
.:nc 
Ol'g 
(13.33) 
The <I>-ni characteristics are plotted in Fig. 13.12 for two cases: (a) air gap present, and (b) no air gap 
(.928 = 0). It can be seen thatlsat is increased by addition of an air gap. Thus, the air gap allows increase of 
the saturation current, at the expense of decreased inductance. 
13.2 
TRANSFORMER MODELING 
Consider next the two-winding transformer of Fig. 13.13. The core has cross-sectional area Ac, mean 
magnetic path length em, and permeability Jl. An equivalent magnetic circuit is given in Fig. 13.14. The 
core reluctance is 
(13.34) 
Since there are two windings in this example, it is necessary to determine the relative polarities of the 
MMF generators. Ampere's law states that 
Fig. 13.13 A two-winding transformer. 
Fig. 13.14 Magnetic circuit that models the 
two-winding transformer of Fig. 13.13. 
+ 
(t) 
-
il (t) 
nl 
turns 
• 
I'\ 
I 
'\. 
(13.35) 
<I> 
'\ 
• 
iit) 
+ 
n2 
vi 
turns 
t) 
-
Core 
'\ 

502 
Basic Magnetics Theory 
The MMF generators are additive, because the currents i1 and i2 pass in the same direction through the 
core window. Solution of Fig. 13.14 yields 
(13.36) 
This expression could also be obtained by substitution of :lfc =<I>&? into Eq. (13.35). 
13.2.1 
The Ideal Transformer 
In the ideal transformer, the core reluctance iJl approaches zero. The causes the core MMF Pic = <l>.Jl to 
also approach zero. Equation (13.35) then becomes 
Also, by Faraday's law, we have 
Note that <I> is the same in both equations above: the same total 
flux links both windings. Elimination of <I> leads to 
(13.39) 
Equations (13.37) and (13.39) are the equations of the ideal trans-
former: 
(13.40) 
The ideal transformer symbol of Fig. 13.15 is defined by Eq. 
(13.40). 
13.2.2 
The Magnetizing Inductance 
(13.37) 
(13.38) 
r------------------------
1 
nl: nz 
---.--+--, 
r--+--+---
+ 
+ 
Fig. 13.15 
Ideal transformer symbol. 
For the actual case in which the core reluctance &? is nonzero, we have 
(13.41) 
Elimination of <I> yields 
(13.42) 

13.2 
Transformer Modeling 
503 
+ 
+ 
Ideal 
i 
t _________________________ j 
Fig. 13.16 Transformer model including magnetizing inductance. 
This equation is of the form 
(13.43) 
where 
(13.44) 
are the magnetizing inductance and magnetizing current, referred to the primary winding. An equivalent 
circuit is illustrated in Fig. 13.16. 
Figure 13.16 coincides with the transformer model introduced in Chapter 6. The magnetizing 
inductance models the magnetization of the core material. It is a real, physical inductor, which exhibits 
saturation and hysteresis. All physical transformers must contain a magnetizing inductance. For example, 
suppose that we disconnect the secondary winding. We are then left with a single winding on a magnetic 
core-an inductor. Indeed, the equivalent circuit of Fig. 13.16 predicts this behavior, via the magnetizing 
inductance. The magnetizing current causes the ratio of the winding currents to differ from the turns 
ratio. 
The transformer saturates when the core flux density B(t) exceeds the saturation flux density 
Bsar When the transformer saturates, the magnetizing current iM(t) becomes large, the impedance of the 
magnetizing inductance becomes small, and the transformer windings become short circuits. It should be 
noted that large winding currents i 1(t) and iit) do not necessarily cause saturation: if these currents obey 
Eq. (13.37), then the magnetizing current is zero and there is no net magnetization of the core. Rather, 
saturation of a transformer is a function of the applied volt-seconds. The magnetizing current is given by 
(13.45) 
Alternatively, Eq. (13.45) can be expressed in terms of the core flux density B(t) as 
(13.46) 
The flux density and magnetizing current will become large enough to saturate the core when the applied 
volt-seconds A1 is too large, where A1 is defined for a periodic ac voltage waveform as 

504 
Basic Magnetics Theory 
(13.47) 
The limits are chosen such that the integral is taken over the positive portion of the applied periodic volt-
age waveform. 
To fix a saturating transformer, the flux density should be decreased by increasing the number of 
turns, or by increasing the core cross-sectional area A c. Adding an air gap has no effect on saturation of 
conventional transformers, since it does not modify Eq. (13.46). An air gap simply makes the transformer 
less ideal, by decreasing LM and increasing iM(t) without changing B(t). Saturation mechanisms in trans-
formers differ from those of inductors, because transformer saturation is determined by the applied wind-
ing voltage waveforms, rather than the applied winding currents. 
13.2.3 Leakage Inductances 
In practice, there is some flux which links one winding but not the other, by "leaking" into the air or by 
some other mechanism. As illustrated in Fig. 13.17, this flux leads to leakage inductance, i.e., additional 
effective inductances that are in series with the windings. A topologically equivalent structure is illus-
trated in Fig. 13.17(b ), in which the leakage fluxes <Pn and <Pn are shown explicitly as separate induc-
tors. 
(a) 
C_<l>M ~ 
i, (t) 
'\ 
(t) <Pn {J 
\... 
../ 
" 
(b) 
-
~c~ 
<Pn 
c...cpM ~ 
i, (t) 
I 
1'\ 
+ 
"' 
v ,(t) 
"' 
-
\.. 
../ 
' 
'\ 
i2(t) 
!""' 
~ <Pn 
J 
'\ 
'\ 
'\ 
+ 
(t) 
v2 
-JJ 
I 
<Pn 
iit) 
+ 
(t) 
v2 
Fig. 13.17 Leakage flux in a two-winding transformer: (a) transformer geometry, (b) an equivalent system. 

13.2 
Transformer Modeling 
505 
~--------------------------~ 
~ 
....... ---+--. 
.--+--.J 
+ 
[_ ______ !.~=-~! ________ _! 
Fig. 13.18 Two-winding transformer equivalent circuit, including magnetizing inductance referred to primary, and 
primary and secondary leakage inductances. 
Figure 13.18 illustrates a transformer electrical equivalent circuit model, including series induc-
tors Ln and L12 which model the leakage inductances. These leakage inductances cause the terminal volt-
age ratio vit)lv1(t) to differ from the ideal turns ratio nz!n1. In general, the terminal equations of a two-
winding transformer can be written 
(13.48) 
The quantity L12 is called the mutual inductance, and is given by 
(13.49) 
The quantities Lll and L22 are called the primary and secondary self-inductances, given by 
(13.50) 
Note that Eq. (13.48) does not explicitly identify the physical turns ratio n2/n 1. Rather, Eq. 
(13.48) expresses the transformer behavior as a function of electrical quantities alone. Equation (13.48) 
can be used, however, to define the effective turns ratio 
and the coupling coefficient 
_rr:;; 
n,- V L;"; 
(13.51) 
(13.52) 
The coupling coefficient k lies in the range 0 ::; k::; 1, and is a measure of the degree of magnetic coupling 
between the primary and secondary windings. In a transformer with perfect coupling, the leakage induc-
tances L11 and L12 are zero. The coupling coefficient k is then equal to 1. Construction of low-voltage 
transformers having coupling coefficients in excess of 0.99 is quite feasible. When the coupling coeffi-
cient is close to 1, then the effective turns ratione is approximately equal to the physical turns ratio n2Jn1• 

506 
Basic Magnetics Theory 
13.3 
LOSS MECHANISMS IN MAGNETIC DEVICES 
13.3.1 
Core Loss 
Energy is required to effect a change in the magnetization of a core material. Not all of this energy is 
recoverable in electrical form; a fraction is lost as heat. This power loss can be observed electrically as 
hysteresis of the B-H loop. 
Consider an n-tum inductor excited by periodic waveforms v(t) and i(t) having frequency f The 
net energy that flows into the inductor over one cycle is 
W = J v(t)i(t)dt 
(13.53) 
one cycle 
We can relate this expression to the core B-H characteristic: substitute B(t) for v(t) using Faraday's law, 
Eq. (13.13), and substitute H(t) for i(t) using Ampere's law, i.e. Eq. (13.14): 
w =I ( A dB(t) )(H(t)C"')d 
n c dt 
n 
t 
one cycle 
(13.54) 
= (Acem) J H dB 
one cycle 
The term A cern is the volume of the core, while the integral is the area of the B-H loop: 
(energy lost per cycle)= (core volume)(area of B-H loop) 
(13.55) 
The hysteresis power loss PH is equal to the energy lost per cycle, multiplied by the excitation 
frequency f: 
PH= (J)(Acem) f H dB 
(13.56) 
one cycle 
To the extent that the size of the hysteresis loop is independent of frequency, hysteresis loss increases 
directly with operating frequency. 
Magnetic core materials are iron alloys that, unfor-
tunately, are also good electrical conductors. As a result, ac 
magnetic fields can cause electrical eddy currents to flow 
within the core material itself. An example is illustrated in 
Fig. 13.19. The ac flux cfl(t) passes through the core. This 
induces eddy currents i(t) which, according to Lenz's law, 
flow in paths that oppose the time-varying flux cfl(t). These 
eddy currents cause FR losses in the resistance of the core 
Fig. 13.19 Eddy currents in an iron core. 
material. The eddy current losses are especially significant 
in high-frequency applications. 
According to Faraday's law, the ac flux cfl(t) induces voltage in the core, which drives the cur-
rent around the paths illustrated in Fig. 13.19. Since the induced voltage is proportional to the derivative 
of the flux, the voltage magnitude increases directly with the excitation frequency f If the impedance of 

13.3 
Loss Mechanisms in Magnetic Devices 
507 
the core material is purely resistive and independent of frequency, then the magnitude of the induced 
eddy currents also increases directly withf This implies that the PReddy current losses should increase 
asf2• In power ferrite materials, the core material impedance magnitude actually decreases with increas-
ing! Over the useful frequency range, the eddy current losses typically increase faster thanf2• 
There is a basic tradeoff between saturation flux density and core loss. Use of a high operating 
flux density leads to reduced size, weight, and cost. Silicon steel and similar materials exhibit saturation 
flux densities of 1.5 to 2 T. Unfortunately, these core materials exhibit high core loss. In particular, the 
low resistivity of these materials leads to high eddy current loss. Hence, these materials are suitable for 
filter inductor and low-frequency transformer applications. The core material is produced in laminations 
or thin ribbons, to reduce the eddy current magnitude. Other ferrous alloys may contain molybdenum, 
cobalt, or other elements, and exhibit somewhat lower core loss as well as somewhat lower saturation 
flux densities. 
Iron alloys are also employed in powdered cores, containing ferromagnetic particles of suffi-
ciently small diameter such that eddy currents are small. These particles are bound together using an 
insulating medium. Powdered iron and molybdenum permalloy powder cores exhibit typical saturation 
flux densities of 0.6 to 0.8 T, with core losses significantly lower than laminated ferrous alloy materials. 
The insulating medium behaves effectively as a distributed air gap, and hence these cores have relatively 
low permeability. Powder cores find application as transformers at frequencies of several kHz, and as fil-
ter inductors in high frequency (100kHz) switching converters. 
Amorphous alloys exhibit low hysteresis loss. Core conductivity and eddy current losses are 
somewhat lower than ferrous alloys, but higher than ferrites. Saturation flux densities in the range 0.6 to 
1.5 T are obtained. 
Ferrite cores are ceramic materials hav-
ing low saturation flux density, 0.25 to 0.5 T. 
Their resistivities are much higher than other 
materials, and hence eddy current losses are 
much smaller. Manganese-zinc ferrite cores find 
widespread use as inductors and transformers in 
converters having switching frequencies of 10 
kHz to 1 MHz. Nickel-zinc ferrite materials can 
be employed at yet higher frequencies. 
Figure 13.20 contains typical total core 
loss data, for a certain ferrite material. Power loss 
density, in Watts per cubic centimeter of core 
material, is plotted as a function of sinusoidal 
excitation frequency f and peak ac flux density 
llB. At a given frequency, the core loss Pfe can be 
approximated by an empirical function of the 
form 
(13.57) 
0.1 
L v 
0.01 
0.01 
I 
I 
I 
I 
I 
I 
I 
J•o 
1-4. 
.o· 
I 
~I 
"''f 
I 
I I 
1/ 
I & 
/ 
11 
I~ 
"'i 
I 
II 
I I 
I /, 
I 
1/ L~ 
1/ 1/ 1/ 
0.1 
llB, Tesla 
!I 
0.3 
The parameters K,e and ~ are determined by fit-
F' 
13 20 T · 1 
1 
d t c 
h' h f 
1• 
1g. 
. 
yp1ca core oss a a tOr a 1g - requency 
ting Eq. (13.57) to the manufacturer's published 
power ferrite material. Power loss density is plotted vs. 
data. Typical values of ~ for ferrite materials 
peak ac flux density !>..B, for sinusoidal excitation. 
operating in their intended range of llB and f lie 
in the range 2.6 to 2.8. The constant of proportionality Kfe increases rapidly with excitation frequency f 
The dependence of Kfe on f can also be approximated by empirical formulae that are fitted to the manu-

508 
Basic Magnetics Theory 
facturer's published data; a fourth-order polynomial or a function of the form Kfeof~ are sometimes 
employed for this purpose. 
13.3.2 
Low-Frequency Copper Loss 
Significant loss also occurs in the resistance of the copper windings. This is also 
a major determinant of the size of a magnetic device: if copper loss and winding 
resistance were irrelevant, then inductor and transformer elements could be 
made arbitrarily small by use of many small turns of small wire. 
Figure 13.21 contains an equivalent circuit of a winding, in which ele-
ment R models the winding resistance. The copper loss of the winding is 
(13.58) 
where Irms is the rms value of i(t). The de resistance of the winding conductor 
can be expressed as 
e 
R=p Ab 
w 
(13.59) 
i(t) 
R 
Fig. 13.21 WindiJJg 
equivalent circuit that 
models copper loss. 
where Aw is the wire bare cross-sectional area, and lb is the length of the wire. The resistivity p is equal to 
1.724 ·10-6 Q-cm for soft-annealed copper at room temperature. This resistivity increases to 
2.3 ·10-6 Q-cm at 100°C. 
13.4 
EDDY CURRENTS IN WINDING CONDUCTORS 
Eddy currents also cause power losses in winding conductors. This can lead to copper losses significantly 
in excess of the value predicted by Eqs. (13.58) and (13.59). The specific conductor eddy current mecha-
nisms are called the skin effect and the proximity effect. These mechanisms are most pronounced in high-
current conductors of multi-layer windings, particularly in high-frequency converters. 
13.4.1 
Introduction to the Skin and Proximity Effects 
Figure 13.22(a) illustrates a current i(t) flowing through a solitary conductor. This current induces mag-
netic flux <P(t), whose flux lines follow circular paths around the current as shown. According to Lenz's 
law, the ac flux in the conductor induces eddy currents, which flow in a manner that tends to oppose the 
ac flux <P(t). Figure 13.22(b) illustrates the paths of the eddy currents. It can be seen that the eddy cur-
rents tend to reduce the net current density in the center of the conductor, and increase the net current 
density near the surface of the conductor. 
The current distribution within the conductor can be found by solution of Maxwell's equations. 
For a sinusoidal current i(t) of frequency f, the result is that the current density is greatest at the surface of 
the conductor. The current density is an exponentially decaying function of distance into the conductor, 
with characteristic length 8 known as the penetration depth or skin depth. The penetration depth is given 
by 

13.4 Eddy Currents in Winding Conductors 
509 
(a) 
(b) 
Fig. 13.22 The skin effect: (a) current i(t) induces flux <l>(t), which in turn induces eddy currents in conductor; 
(b) the eddy currents tend to oppose the current i(t) in the center of the wire, and increase the current on the surface 
of the wire. 
8- ~ 
-y rq.tf 
(13.60) 
For a copper conductor, the permeability Jl is equal to Jlo, and the resistivity p is given in Section 13.3.2. 
At 100'C, the penetration depth of a copper conductor is 
O= /Jcm 
(13.61) 
withfexpressed in Hz. The penetration depth of copper conductors is plotted in Fig. 13.23, as a function 
of frequency f For comparison, the wire diameters d of standard American Wire Gauge (AWG) conduc-
tors are also listed. It can be seen that d/o = 1 for AWG #40 at approximately 500kHz, while dlo = 1 for 
Penetration 
depth o, em 
0.1 
0.01 
0.001 
10kHz 
- ........... 
1--. r-: :::::-- ..... 
t:.! . ..Oo·c 
~ 
100kHz 
Frequency 
:::::::::: 
Fig. 13.23 
Penetration depth 8, as a function of frequency J, for copper wire. 
Wire diameter 
#20AWG 
---
----
#30AWG 
---
f:::::: 
--
:::--
-
#40AWG 
--
1MHz 

510 
Basic Magnetics Theory 
AWG #22 at approximately 10kHz. 
The skin effect causes the resistance and copper loss of solitary large-diameter wires to increase 
at high frequency. High-frequency currents do not penetrate to the center of the conductor. The current 
crowds at the surface of the wire, the inside of the wire is not utilized, and the effective wire cross-sec-
tional area is reduced. However, the skin effect alone is not sufficient to explain the increased high-fre-
quency copper losses observed in multiple-layer transformer windings. 
A conductor that carries a high-frequency current i(t) 
induces copper loss in a adjacent conductor by a phenomenon 
known as the proximity effect. Figure 13.24 illustrates two copper 
foil conductors that are placed in close proximity to each other. 
Conductor 1 carries a high-frequency sinusoidal current i(t), whose 
penetration depth 8 is much smaller than the thickness h of conduc-
tors 1 or 2. Conductor 2 is open-circuited, so that it carries a net 
current of zero. However, it is possible for eddy currents to be 
induced in conductor 2 by the current i(t) flowing in conductor 1. 
The current i(t) flowing in conductor 1 generates a flux 
<l>(t) in the space between conductors 1 and 2; this flux attempts to 
penetrate conductor 2. By Lenz's law, a current is induced on the 
adjacent (left) side of conductor 2, which tends to oppose the flux 
<l>(t). If the conductors are closely spaced, and if h » 8, then the 
induced current will be equal and opposite to the current i(t), as 
illustrated in Fig. 13.24. 
Since conductor 2 is open-circuited, the net current in con-
ductor 2 must be zero. Therefore, a current+ i(t) flows on the right-
side surface of conductor 2. So the current flowing in conductor 1 
induces a current that circulates on the surfaces of conductor 2. 
-i 
Fig. 13.24 The proximity effec1 
in adjacent copper foil conductors. 
Conductor 1 carries current i(t). 
Conductor 2 is open-circuited. 
Figure 13.25 illustrates the proximity effect in a simple transformer winding. The primary 
winding consists of three series-connected turns of copper foil, having thickness h » 8, and carrying net 
current i(t). The secondary winding is identical; to the extent that the magnetizing current is small, the 
secondary turns carry net current - i(t). The windings are surrounded by a magnetic core material that 
encloses the mutual flux of the transformer. 
The high-frequency sinusoidal current i(t) flows on the right surface of primary layer 1, adjacent 
to layer 2. This induces a copper loss in layer 1, which can be calculated as follows. Let Rdc be the de 
resistance of layer 1, given by Eq. (13.59), and let I be the rms value of i(t). The skin effect causes the 
copper loss in layer 1 to be equal to the loss in a conductor of thickness 8 with uniform current density. 
This reduction of the conductor thickness from h to 8 effectively increases the resistance by the same fac-
tor. Hence, layer 1 can be viewed as having an "ac resistance" given by 
(13.62) 
The copper loss in layer 1 is 
(13.63) 
The proximity effect causes a current to be induced in the adjacent (left-side) surface of primary 
layer 2, which tends to oppose the flux generated by the current of layer 1. If the conductors are closely 
spaced, and if h » 8, then the induced current will be equal and opposite to the current i(t), as illustrated 

(a) 
(b) 
Core 
Current 
density 
J 
@ 
@ 
@ 
C'1 
(<) 
..... 
..... 
..... 
~ 
~ 
~ 
.3 
:3 
s 
>--l 
Primary winding 
Primary winding 
13.4 
Eddy Currents in Winding Conductors 
511 
-i 
-i 
-i 
@ 
@ 
@ 
(<) 
C'1 
..... 
..... 
..... 
~ 
~ 
~ 
:3 
.3 
s 
>--l 
_____.. 
Secondary winding 
Secondary winding 
Fig. 13.25 
A simple transformer example illustrating the proximity effect: (a) core and winding geometry, 
(b) distribution of currents on surfaces of conductors. 
in Fig. 13.25. Hence, current- i(t) flows on the left surface of the second layer. Since layers 1 and 2 are 
connected in series, they must both conduct the same net current i(t). As a result, a current + 2i(t) must 
flow on the right-side surface of layer 2. 
The current flowing on the left surface of layer 2 has the same magnitude as the current of layer 
1, and hence the copper loss is the same: P1• The current flowing on the right surface of layer 2 has rms 
magnitude 2/; hence, it induces copper loss (2/)2Rac = 4P1• The total copper loss in primary layer 2 is 
therefore 
(13.64) 
The copper loss in the second layer is five times as large as the copper loss in the first layer! 
The current 2i(t) flowing on the right surface of layer 2 induces a flux 2<1>(t) as illustrated in Fig. 
13.25. This causes an opposing current- 2i(t) to flow on the adjacent (left) surface of primary layer 3. 
Since layer 3 must also conduct net current i(t), a current+ 3i(t) flows on the right surface of layer 3. The 
total copper loss in layer 3 is 

512 
Basic Magnetics Theory 
(13.65) 
Likewise, the copper loss in layer m of a multiple-layer winding can be written 
(13.66) 
It can be seen that the copper loss compounds very quickly in a multiple-layer winding. 
The total copper loss in the three-layer primary winding is P1 + 5P1 + l3P1, or 19P1• More gen-
erally, if the winding contains a total of M layers, then the total copper loss is 
P=l2(%Rdc) n%l [(m-1) 2 +m2] 
=l2(%Rdc) ~(2M 2 + 1) 
(13.67) 
If a de or low-frequency ac current of rms amplitude I were applied to theM-layer winding, its copper 
loss would be Pdc = PMRdc· Hence, the proximity effect increases the copper loss by the factor 
(13.68) 
This expression is valid for a foil winding having h ~ 8. 
As illustrated in Fig. 13.25, the currents in the secondary winding are symmetrical, and hence 
the secondary winding has the same conduction loss. 
The example above, and the associated equations, are limited to h ~ 8 and to the winding 
geometry shown. The equations do not quantify the behavior for h - 8, nor for round conductors, nor are 
the equations sufficiently general to cover the more complicated winding geometries often encountered 
in the magnetic devices of switching converters. Optimum designs may, in fact, occur with conductor 
thicknesses in the vicinity of one penetration depth. The discussions of the following sections allow com-
putation of proximity losses in more general circumstances. 
13.4.2 
Leakage Flux in Windings 
As described above, an externally-applied magnetic field will induce eddy currents to flow in a conduc-
tor, and thereby induce copper loss. To understand how magnetic fields are oriented in windings, let us 
consider the simple two-winding transformer illustrated in Fig. 13.26. In this example, the core has large 
permeability fJ ~ fJo· The primary winding consists of eight turns of wire arranged in two layers, and 
each turn carries current i(t) in the direction indicated. The secondary winding is identical to the primary 
winding, except that the current polarity is reversed. 
Flux lines for typical operation of this transformer are sketched in Fig. 13.26(b ). As described in 
Section 13.2, a relatively large mutual flux is present, which magnetizes the core. In addition, leakage 
flux is present, which does not completely link both windings. Because of the symmetry of the winding 
geometry in Fig. 13.26, the leakage flux runs approximately vertically through the windings. 
To determine the magnitude of the leakage flux, we can apply Ampere's Law. Consider the 
closed path taken by one of the leakage flux lines, as illustrated in Fig. 13.27. Since the core has large 
permeability, we can assume that the MMF induced in the core by this flux is negligible, and that the 

(a) 
y t 
Primary Secondary 
winding 
winding 
~~ 
® ® 
® ® 
® ® 
® ® 
1--::-t-
X 
0 
0 
0 
0 
0 
0 
0 
0 
Core 
!-! » 1-lo 
13.4 Eddy Currents in Winding Conductors 
513 
(b) 
r,::=:=:::::=:::::=:::::=:::::;;-! 
Leakage flux 
® ® 
® ® 
® ® 
® ® 
0 
0 
0 
0 
0 
0 
0 
0 
Mutual 
flux 
<f>M 
Fig. 13.26 Two-winding transformer example: (a) core and winding geometry, (b) typical flux distribution. 
total MMF around the path is dominated by the MMF iY(x) across the core window. Hence, Ampere's 
Law states that the net current enclosed by the path is equal to the MMF across the air gap: 
Enclosed current= .¥(x) = H(x)Cw 
(13.69) 
where ew is the height of the window as shown in Fig. 13.27. The net current enclosed by the path 
depends on the number of primary and secondary conductors enclosed by the path, and is therefore a 
function of the horizontal position x. The first layer of the primary winding consists of 4 turns, each car-
rying current i(t). So when the path encloses only the first layer of the primary winding, then the enclosed 
current is 4i(t) as shown in Fig. 13.28. Likewise, when the path encloses both layers of the primary wind-
ing, then the enclosed current is 8i(t). When the path encloses the entire primary, plus layer 2 of the sec-
ondary winding, then the net enclosed current is 8i(t)- 4i(t) = 4i(t). The MMF iY(x) across the core 
window is zero outside the winding, and rises to a maximum of 8i(t) at the interface between the primary 
and secondary windings. Since H(x) = iY(x)lfw, the magnetic field intensity H(x) is proportional to the 
sketch of Fig. 13.28. 
Fig. 13.27 
Analysis of leakage flux using Ampere's Law, 
for the transformer of Fig. 13.26. 
Leakage path 
® 
Enclosed 
current 
H(x) 
---:-+ 
X 
-\ 
:¥(x) 
I 
+ 
j 

514 
Basic Magnetics Theory 
Fig. 13.28 MMF diagram for the transformer winding example 
of Figs. 13.26 and 13.27. 
i¥(x) 
8i 
4i 
0 
Primary 
winding 
§ 
§ 
" 
" 
... 
... 
N 
® 
® 
® 
® 
® 
® 
® 
® 
Secondary 
winding 
§ 
t-< 
~ 
" 
" 
... 
.., 
N 
0 
0 
0 
0 
0 
0 
0 
0 
X 
It should be noted that the shape of the i¥(x) curve in the vicinity of the winding conductors 
depends on the distribution of the current within the conductors. Since this distribution is not yet known, 
the 21(x) curve of Fig. 13.28 is arbitrarily drawn as straight line segments. 
In general, the magnetic fields that surround conductors and lead to eddy currents must be 
determined using finite element analysis or other similar methods. However, in a large class of coaxial 
solenoidal winding geometries, the magnetic field lines are nearly parallel to the winding layers. As 
shown below, we can then obtain an analytical solution for the proximity losses. 
13.4.3 
Foil Windings and Layers 
The winding symmetry described in the previous section allows simplification of the analysis. For the 
purposes of determining leakage inductance and winding eddy currents, a layer consisting of n1 turns of 
round wire carrying current i(t) can be approximately modeled as an effective single tum of foil, which 
carries current nei(t). The steps in the transformation of a layer of round conductors into a foil conductor 
are formalized in Fig. 13.29 [6, 8-11]. The round conductors are replaced by square conductors having 
the same copper cross-sectional area, Fig. 13 .29(b ). The thickness h of the square conductors is therefore 
Fig. 13.29 Approximating a layer of round 
conductors as an effective foil conductor. 
(a) 
d:r:o 
0 
0 
0 
0 0 
(b) 
h 6 
D 
D 
D 
D 
D 
(c) 

13.4 
Eddy Currents in Winding Conductors 
515 
equal to the bare copper wire diameter, multiplied by the factor Jrt74 : 
h-
(JF; d 
-v 4 
(13.70) 
These square conductors are then joined together, into a foil layer [Fig. 13.29(c)]. Finally, the width of 
the foil is increased, such that it spans the width of the core window [Fig. 13 .29( d)]. Since this stretching 
process increases the conductor cross-sectional area, a compensating factor 11 must be introduced such 
that the correct de conductor resistance is predicted. This factor, sometimes called the conductor spacing 
factor or the winding porosity, is defined as the ratio of the actual layer copper area [Fig. 13.29(a)] to the 
area of the effective foil conductor of Fig. 13.29(d). The porosity effectively increases the resistivity p of 
the conductor, and thereby increases its skin depth: 
~·-JL 
u - !lT 
(13.71) 
If a layer of width ew contains nc turns of round wire having diameter d, then the winding porosity 11 is 
given by 
(13.72) 
A typical value of 11 for round conductors that span the width of the winding bobbin is 0.8. In the follow-
ing analysis, the factor <pis given by h/8 for foil conductors, and by the ratio of the effective foil conduc-
tor thickness h to the effective skin depth 8' for round conductors as follows: 
13.4.4 
Power Loss in a Layer 
m- h-
fYf (JF;d 
"'-;y-v•l V 4 8 
In this section, the average power loss P in a uniform layer of 
thickness h is determined. As illustrated in Fig. 13.30, the mag-
netic field strengths on the left and right sides of the conductor are 
denoted H(O) and H(d), respectively. It is assumed that the compo-
nent of magnetic field normal to the conductor surface is zero. 
These magnetic fields are driven by the magnetomotive forces 
:J'7(0) and fff(h), respectively. Sinusoidal waveforms are assumed, 
and rms magnitudes are employed. It is further assumed here that 
H(O) and H(h) are in phase; the effect of a phase shift is treated in 
[10]. 
With these assumptions, Maxwell's equations are solved 
to find the current density distribution in the layer. The power loss 
density is then computed, and is integrated over the volume of the 
layer to find the total copper loss in the layer [10]. The result is 
(13.74) 
(13.73) 
-
'"""'"r--""" 
H(O) 
H(h) 
.......... f---.""" 
-i 
:ff(x) ]· 
! 
! :!J(h) 
-·~ 
0 
h 
Fig. 13.30 The power loss is deter-
mined for a uniform layer. Uniform 
tangential magnetic fields H(O) and 
H(h) are applied to the layer surfaces. 

516 
Basic Magnetics Theory 
where n1 is the number of turns in the layer, and Rdc is the de resistance of the layer. The functions G 1 ( <p) 
and Gi<p) are 
G ( ) = sinh (2qJ) +sin (2qJ) 
1 (jJ 
cosh (2qJ)- cos (2qJ) 
G ( ) =sinh (qJ) cos (qJ) +cosh (qJ) sin (qJ) 
2 (jJ 
cosh (2qJ)- cos (2qJ) 
If the winding carries current of rms magnitude I, then we can write 
Let us further express i!J(h) in terms of the winding current /, as 
.Jf(h) = mn1I 
The quantity m is therefore the ratio of the MMF i!J(h) to the layer ampere-turns n1I. Then, 
:Y(O) 
m-1 
:7(h) = ----m-
The power dissipated in the layer, Eq. (13.74), can then be written 
where 
We can conclude that the proximity effect increases the copper loss in the layer by the factor 
12~ = qJQ'(qJ, m) 
de 
(13.75) 
(13.76) 
(13.77) 
(13.78) 
(13.79) 
(13.80) 
(13.81) 
Equation (13.81), in conjunction with the definitions (13.80), (13.77), (13.75), and (13.73), can be plot-
ted using a computer spreadsheet or small computer program. The result is illustrated in Fig. 13.31, for 
several values of m. 
It is illuminating to express the layer copper loss Pin terms of the de power loss P dclq> = 1 that 
would be obtained in a foil conductor having a thickness <p == 1. This loss is found by dividing Eq. (13.81) 
by the effective thickness ratio <p: 
Pd"'~= 1 = Q'(qJ, m) 
(13.82) 
Equation (13.82) is plotted in Fig. 13.32. Large copper loss is obtained for small <p simply because the 
layer is thin and hence the de resistance of the layer is large. For large m and large <p, the proximity effect 
leads to large power loss; Eq. (13.66) predicts that Q'(<p, m) is asymptotic to m2 + (m- 1)2 for large <p. 
Between these extremes, there is a value of <p which minimizes the layer copper loss. 

13.4 Eddy Currents in Winding Conductors 
517 
100 
111=1512 108 6 5 
4 
3 
10 
0.1 
10 
Fig. 13.31 Increase of layer copper loss due to the proximity effect, as a function of q> and MMF ratio m, for sinu-
soidal excitation. 
100 
Ill = 15 12 10 
8 
// /// 
Ill v // /" 
10 
///1 WL/ 
~ /// v 
/ 
~ / 
./ ...-
~ 
...... / 
~ 
0.1 
0.1 
6 
5 
4 
3 
2 
1.5 
m =0.5 
10 
Fig. 13.32 
Layer copper loss, relative to the de loss in a layer having effective thickness of one penetration depth. 

518 
Basic Magnetics Theory 
Fig. 13.33 Conventional two-winding 
transformer example. Each winding 
consists of M layers. 
Primary layers 
13.4.5 
Example: Power Loss in a Transformer Winding 
Secondary layers 
X 
Let us again consider the proximity loss in a conventional transformer, in which the primary and second-
ary windings each consist of M layers. The normalized MMF diagram is illustrated in Fig. 13.33. As 
given by Eq. (13.81), the proximity effect increases the copper loss in each layer by the factor <pQ'(<p, m). 
The total increase in primary winding copper loss Ppri is found by summation over all of the primary lay-
ers: 
(13.83} 
Owing to the symmetry of the windings in this example, the secondary winding copper loss is increased 
by the same factor. Upon substituting Eq. (13.80) and collecting terms, we obtain 
(13.84) 
The summation can be expressed in closed form with the help of the identities 
(13.85) 
Use of these identities to simplify Eq. (13.84) leads to 
(13.86) 
This expression is plotted in Fig. 13.34, for several values of M. For large <p, G1(<p) tends to 1, while 

13.4 Eddy Currents in Winding Conductors 
519 
100 
Number of/ayers M = 15 12 10 8 7 
6 
5 
4 
3 
II II. L 
IIIII / 
/ 
IIIII! I/ 
/ 
2 
:;; ///; I v 
v 
vif//1 / 
/ / 
v~-' 
/ 
1.5 
10 
'/ 
I 
/ 
/ 
v: 
'I 
I 
v 
II 
I I I 
I 
/ 
/ 
0.5 
jl. [j, 1/ I I v 
/ 
/ 
~'h~ VII / 
/ v 
~ 
~~ 
~v 
~v ~ 
v / 
0.1 
10 
Fig. 13.34 Increased total winding copper loss in the two-winding transformer example, as a function of <p and 
number of layers M, for sinusoidal excitation. 
100 
Number of layers M = 15 
// 
//// 
///// 
10 
h w~ 
~ 
// 
// 
~ /------
0.1 
0. 1 
12 
10 
7 
6 
5 
4 
3 
2 
1.5 
0.5 
10 
Fig. 13.35 Transformer example winding total copper loss, relative to the winding de loss for layers having effec-
tive thicknesses of one penetration depth. 

520 
Basic Magnetics Theory 
G2(<p) tends to 0. It can be verified that FR then tends to the value predicted by Eq. (13.68). 
We can again express the total primary power loss in terms of the de power loss that would be 
obtained using a conductor in which <p = 1. This loss is found by dividing Eq. (13.86) by <p: 
(13.87) 
This expression is plotted in Fig. 13.35, for several values of M. Depending on the number of layers, the 
minimum copper loss for sinusoidal excitation is obtained for <p near to, or somewhat less than, unity. 
13.4.6 
Interleaving the Windings 
One way to reduce the copper losses due to the proximity effect is to interleave the windings. Figure 
13.36 illustrates the MMF diagram for a simple transformer in which the primary and secondary layers 
are alternated, with net layer current of magnitude i. It can be seen that each layer operates with iY = 0 on 
one side, and ,'ffi =ion the other. Hence, each layer operates effectively with m = 1. Note that Eq. (13.74) 
is symmetric with respect to iY(O) and :¥(h); hence, the copper losses of the interleaved secondary and 
primary layers are identical. The proximity losses of the entire winding can therefore be determined 
directly from Fig. 13.34 and 13.35, with M = 1. It can be shown that the minimum copper loss for this 
case (with sinusoidal currents) occurs with <p = n/2, although the copper loss is nearly constant for any 
<p ~ ll, and is approximately equal to the de copper loss obtained when <p = 1. It should be apparent that 
interleaving can lead to significant improvements in copper loss when the winding contains several lay-
ers. 
Partial interleaving can lead to a partial improvement in proximity loss. Figure 13.37 illustrates 
a transformer having three primary layers and four secondary layers. If the total current carried by each 
primary layer is i(t), then each secondary layer should carry current 0.75i(t). The maximum MMF again 
occurs in the spaces between the primary and secondary windings, but has value 1.5i(t). 
To determine the value form in a given layer, we can solve Eq. (13.78) form: 
.Y:(h) 
m = .Y:(h)- .Y:(O) 
(13.88) 
pri 
sec 
pri 
sec 
pri 
sec 
lj~lj~lj~ 
~fxfl i 
! . 
i i i 1 
1 ! 
. i 
: 
3i ! 
: 
1 
! 
Zi 
1 
1 
1 
i 
~~~! ~ ~ 
X 
Fig. 13.36 MMF diagram for a simple transformer with interleaved windings. Each layer operates with m = 1. 

13.4 
Eddy Currents in Winding Conductors 
521 
MMF 
.¥(x) 
1.5 i 
Secondary 
Primary 
Secondary 
0.5 i 
0~~~~--~-+--+-~~--~-+--+-~~--~--~ 
-0.5 i 
X 
-i 
-1.5 i 
Fig. 13.37 
A partially interleaved two-winding transformer, illustrating fractional values of m. The MMF dia-
gram is constructed for the low-frequency limit. 
The above expression is valid in general, and Eq. (13.74) is symmetrical in :¥(0) and .OJ(h). However, 
when F(O) is greater in magnitude than .¥(h), it is convenient to interchange the roles of .'¥(0) and :¥(h), 
so that the plots of Figs. 13.31 and 13.32 can be employed. 
In the leftmost secondary layer of Fig. 13.37, the layer carries current - 0.75i. The MMF 
changes from 0 to- 0.75i. The value of m for this layer is found by evaluation of Eq. (13.88): 
ni == _ .'l'(h)_ 
== 
- 0.75i 
== 1 
.'/<(h)- .Y.(O) 
- 0.75i- 0 
(13.89) 
The loss in this layer, relative to the de loss of this secondary layer, can be determined using the plots of 
Figs. 13.31 and 13.32 with m = 1. For the next secondary layer, we obtain 
.J:(h) 
- l.5i 
== 2 
m== .Y.(h)-.'7(0) 
-1.5i-(-0.75i) 
(13.90) 
Hence the loss in this layer can be determined using the plots of Figs. 13.31 and 13.32 with m = 2.The 
next layer is a primary-winding layer. Its value of m can be expressed as 
m == .Ji(O)- .Ji(h) 
.¥(0) 
-l.5i 
1.5 
(13.91) 
- 1.5i- (- 0.5i) 
The loss in this layer, relative to the de loss of this primary layer, can be determined using the plots of 
Figs. 13.31 and 13.32 with m = 1.5. The center layer has an m of 
m == .Ji(h)- .Ji(O) 
.Ji(h) 
0.5i 
== 0.5 
0.5i- (- 0.5i) 
(13.92) 
The loss in this layer, relative to the de loss of this primary layer, can be determined using the plots of 
Figs. 13.31 and 13.32 with m = 0.5. The remaining layers are symmetrical to the corresponding layers 
described above, and have identical copper losses. The total loss in the winding is found by summing the 
losses described above for each layer. 

522 
Basic Magnetics Theory 
Interleaving windings can significantly reduce the proximity loss when the primary and second-
ary currents are in phase. However, in some cases such as the transformers of the fly back and SEPIC con-
verters, the winding currents are out of phase. Interleaving then does little to reduce the MMFs and 
magnetic fields in the vicinity of the windings, and hence the proximity loss is essentially unchanged. It 
should also be noted that Eqs. (13.74) to (13.82) assume that the winding currents are in phase. General 
expressions for out-of-phase currents, as well as analysis of a flyback example, are given in [10]. 
The above procedure can be used to determine the high-frequency copper losses of more com-
plicated multiple-winding magnetic devices. The MMF diagrams are constructed, and then the power 
loss in each layer is evaluated using Eq. (13.81). These losses are summed, to find the total copper loss. 
The losses induced in electrostatic shields can also be determined. Several additional examples are given 
in [10]. 
It can be concluded that, for sinusoidal currents, there is an optimal conductor thickness in the 
vicinity of q> = 1 that leads to minimum copper loss. It is highly advantageous to minimize the number of 
layers, and to interleave the windings. The amount of copper in the vicinity of the high-MMF portions of 
windings should be kept to a minimum. Core geometries that maximize the width ew of the layers, while 
minimizing the overall number of layers, lead to reduced proximity loss. 
Use of Litz wire is another means of increasing the conductor area while maintaining low prox-
imity losses. Tens, hundreds, or more strands of small-gauge insulated copper wire are bundled together, 
and are externally connected in parallel. These strands are twisted, or transposed, such that each strand 
passes equally through each position inside and on the surface of the bundle. This prevents the circula-
tion of high-frequency currents between strands. To be effective, the diameter of the strands should be 
sufficiently less than one skin depth. Also, it should be pointed out that the Litz wire bundle itself is com-
posed of multiple layers. The disadvantages of Litz wire are its increased cost, and its reduced fill factor. 
13.4.7 
PWM Waveform Harmonics 
The pulse-width-modulated waveforms encountered in switching converters contain significant harmon-
ics, which can lead to increased proximity losses. The effect of harmonics on the losses in a layer can be 
determined via field harmonic analysis [10], in which the MMF waveforms i¥(0,t) and i¥(d,t) of Eq. 
(13.74) are expressed in Fourier series. The power loss of each individual harmonic is computed as in 
Section 13.4.4, and the losses are summed to find the total loss in a layer. For example, the PWM wave-
form of Fig. 13.38 can be represented by the following Fourier series: 
where 
III k 
f 1. =~.-P- sin (jnD) 
]1': 
(13.93) 
with w = 2n/Ts. This waveform contains a de component 10 = Dlpk' plus harmonics of rms magnitude Ij 
proportional to 1/j. The transformer winding current waveforms of most switching converters follow this 
Fourier series, or a similar series. 
Effects of waveforms harmonics on proximity losses are discussed in [8-1 0]. The de component 
of the winding currents does not lead to proximity loss, and should not be included in proximity loss cal-
culations. Failure to remove the de component can lead to significantly pessimistic estimates of copper 

13.4 Eddy Currents in Winding Conductors 
523 
i(t) 
-
Fig. 13.38 Pulse-width modulated winding current waveform. 
0 
loss. The skin depth 8 is smaller for high frequency harmonics than for the fundamental, and hence the 
waveform harmonics exhibit an increased effective <p. Let <p 1 be given by Eq. (13.73), in which 8 is found 
by evaluation of Eq. (13.60) at the fundamental frequency. Since the penetration depth 8 varies as the 
inverse square-root of frequency, the effective value of <p for harmonic j is 
(13.94) 
In a multiple-layer winding excited by a current waveform whose fundamental component has <p = <p1 
close to 1, harmonics can significantly increase the total copper loss. This occurs because, form > 1, 
Q'(cp, m) is a rapidly increasing function of (jl in the vicinity of 1. When <p1 is sufficiently greater than 1, 
then Q'(cp, m) is nearly constant, and harmonics have less influence on the total copper loss. 
For example, suppose that the two-winding transformer of Fig. 13.33 is employed in a converter 
such as the forward converter, in which a winding current waveform i(t) can be well approximated by the 
Fourier series of Eq. (13.93). The winding contains M layers, and has de resistance Rdc. The copper loss 
induced by the de component is 
(13.95) 
The copper loss Pj ascribable to harmonic j is found by evaluation of Eq. (13.86) with <p = <p/ 
(13.96) 
The total copper loss in the winding is the sum of losses arising from all components of the harmonic 
series: 
Pc, 
D 
2<p 1 ~ sin 2 (jnD) [a (" l 2 (Mz l)(a (" l 20 (" l)j 
Dl~kRdc= +Dnz/;'t 
jiJ 
tVl<i't +3 
-
tVJ<i't-
zvJ<i't 
(13.97) 
In Eq. (13.97), the copper loss is expressed relative to the loss D!pk2Rdc predicted by a low-frequency 
analysis. This expression can be evaluated by use of a computer program or computer spreadsheet. 
To explicitly quantify the effects of harmonics, we can define the harmonic loss factor F H as 
(13.98) 
with Pj given by Eq. (13.96). The total winding copper loss is then given by 

524 
Basic Magnetics Theory 
Fig. 
13.39 Increased proximity losses 
induced by PWM waveform harmonics, 
forward converter example: (a) at D = 0.1, 
(b) at D = 0.3, (c) at D = 0.5. 
100 
10 
100 
10 
I 
1-10 
0=0.1 == 
/ o / 
~ 
/ 
/ 
/ 
::-..; 
// >~~ 
~ 
/////v- ~ 
#$/~.~ 
I 
~--=--:::- -
Mz0.5 
0.1 
10 
<Pa 
0=0.3-
M a ~ 
/ 
//b= ~ 
///// 4_..- ~ 
////.// J 
~ 
#~./~ 
M ~ 
~ 
~0.5 
0.1 
10 
0.1 
10 

13.5 Several Types of Magnetic Devices, Their B-H Loops, and Core vs. Copper Loss 
525 
with FR given by Eq. (13.86). The harmonic factor F His a function not only of the winding geometry, but 
also of the harmonic spectrum of the winding current waveform. The harmonic factor F H is plotted in 
Fig. 13.39 for several values of D, for the simple transformer example. The total harmonic distortion 
(THD) of the example current waveforms are: 48% forD= 0.5, 76% forD= 0.3, and 191% forD= 0.1. 
The waveform THD is defined as 
(13.100) 
It can be seen that harmonics significantly increase the proximity loss of a multilayer winding when <p 1 is 
close to 1. For sufficiently small <pl' the proximity effect can be neglected, and F H tends to the value 
1 + (THDf For large <p1, the harmonics also increase the proximity loss; however, the increase is less 
dramatic than for <p1 near l because the fundamental component proximity loss is large. It can be con-
cluded that, when the current waveform contains high THD and when the winding contains several lay-
ers or more, then proximity losses can be kept low only by choosing <p 1 much less than 1. Interleaving the 
windings allows a larger value of <p1 to be employed. 
13.5 
SEVERAL TYPES OF MAGNETIC DEVICES, THEIR B-H LOOPS, AND 
CORE VS. COPPER LOSS 
A variety of magnetic elements are commonly used in power applications, which employ the properties 
of magnetic core materials and windings in different ways. As a result, quite a few factors constrain the 
design of a magnetic device. The maximum flux density must not saturate the core. The peak ac flux den-
sity should also be sufficiently small, such that core losses are acceptably low. The wire size should be 
sufficiently small, to fit the required number of turns in the core window. Subject to this constraint, the 
wire cross-sectional area should be as large as possible, to minimize the winding de resistance and cop-
per loss. But if the wire is too thick, then unacceptable copper losses occur owing to the proximity effect. 
An air gap is needed when the device stores significant energy. But an air gap is undesirable in trans-
former applications. It should be apparent that, for a given magnetic device, some of these constraints are 
active while others are not significant. 
Thus, design of a magnetic element involves not only obtaining the desired inductance or turns 
ratio, but also ensuring that the core material does not saturate and that the total power loss is not too 
large. Several common power applications of magnetics are discussed in this section, which illustrate the 
factors governing the choice of core material, maximum flux density, and design approach. 
13.5.1 
Filter Inductor 
A filter inductor employed in a CCM buck converter is illustrated in Fig. 13.40(a). In this application, the 
value of inductance L is usually chosen such that the inductor current ripple peak magnitude 11i is a small 
fraction of the full-load inductor current de component I, as illustrated in Fig. 13.40(b ). As illustrated in 
Fig. 13.41, an air gap is employed that is sufficiently large to prevent saturation of the core by the peak 
current I+ 11i. 

526 
Basic Magnetics Theory 
(a) 
L 
(b) 
i(t: t=T::J-J"', 
' 
' t 
i 
i 
' 
' 
' 
' 
\ 
l 
' 
' 
: 
: 
. 
0 
T s 
Fig. 13.40 
Filter inductor employed in a CCM buck converter: (a) circuit schematic, (b) inductor current wave-
form. 
(a) 
i(t) 
+ 
v 
n 
(t) 
turns 
-
"' 
Core reluctance &lc 
<l> 
:'\. 
J 
"' r 
" 
r-
f-~ 
~ 
Air gap 
reluctance 
,q{g 
(b) 
+ 
ni(t) 
Fig. 13.41 
Filter inductor: (a) structure, (b) magnetic circuit model. 
The core magnetic field strength Hc(t) is related to the winding current i(t) according to 
(13.101) 
where ec is the magnetic path length of the core. Since HJt) is proportional to i(t), Hc(t) can be expressed 
as a large de component Hco and a small superimposed ac ripple Mic, where 
(13.102) 
A sketch of B(t) vs. HJt) for this application is given in Fig. 13.42. This device operates with the minor 
B-H loop illustrated. The size of the minor loop, and hence the core loss, depends on the magnitude of 
the inductor current ripple !:li. The copper loss depends on the rms inductor current ripple, essentially 

13.5 Several Types of Magnetic Devices, Their B-H Loops, and Core vs. Copper Loss 
527 
Fig. 13.42 Filter inductor minor 8-H loop. 
B 
Bsat 
x:~~~~~~~~op, ---t---£.;-'-r=:::::::::::::!: 1'18 
+! !+1'1H 
I . 
c 
B-H loop, 
large excitation 
equal to the de component I. Typically, the core loss can be ignored, and the design is driven by the cop-
per loss. The maximum flux density is limited by saturation of the core. Proximity losses are negligible. 
Although a high-frequency ferrite material can be employed in this application, other materials having 
higher core losses and greater saturation flux density lead to a physically smaller device. Design of a fil-
ter inductor in which the maximum flux density is a specified value is considered in the next chapter. 
13.5.2 
AC Inductor 
An ac inductor employed in a resonant converter is illustrated in Fig. 13.43. In this application, the high-
frequency current variations are large. In consequence, the B(t)-H(t) loop illustrated in Fig. 13.44 is 
large. Core loss and proximity loss are usually significant in this application. The maximum flux density 
(a) 
L 
...... ~L 
..... 
-vuuMll 
(b) 
i(t) 
Fig. 13.43 Ac inductor, resonant converter example: (a) resonant tank circuit, (b) inductor current waveform. 
B 
Bsat 
Fig. 13.44 Operational 8-H loop of an ac inductor. 
Core B-H loop 

528 
Basic Magnetics Theory 
is limited by core loss rather than saturation. Both core loss and copper loss must be accounted for in the 
design of this element, and the peak ac flux density M is a design variable that is typically chosen to 
minimize the total loss. A high-frequency material having low core loss, such as ferrite, is normally 
employed. Design of magnetics such as this, in which the ac flux density is a design variable that is cho-
sen in a optimal manner, is considered in Chapter 15. 
13.5.3 
Transformer 
Figure 13.45 illustrates a conventional transformer employed in a switching converter. Magnetization of 
the core is modeled by the magnetizing inductance LM. The magnetizing current iM(t) is related to the 
core magnetic field H(t) according to Ampere's law 
H(t) = ntt) 
m 
(13.103) 
However, iM(t) is not a direct function of the winding currents i1 (t) or iz(t). Rather, the magnetizing cur-
rent is dependent on the applied winding voltage waveform v1(t). Specifically, the maximum ac flux den-
sity is directly proportional to the applied volt-seconds A.1. A typical B-H loop for this application is 
illustrated in Fig. 13.46. 
(a) 
(b) 
Fig. 13.45 
Conventional transformer: (a) equivalent circuit, (b) typical primary voltage and magnetizing current 
waveforms. 
B 
Fig. 13.46 
Operational B-H loop of a conventional transformer. 
B-H loop,Jor __ 
.J..__, 
operation as 
conventional __ 
+h~'---+-----+ 
transformer 

13.5 Several Types of Magnetic Devices, Their B-H Loops, and Core vs. Copper Loss 
529 
In the transformer application, core loss and proximity losses are usually significant. Typically 
the maximum flux density is limited by core loss rather than by saturation. A high-frequency material 
having low core loss is employed. Both core and copper losses must be accounted for in the design of the 
transformer. The design must also incorporate multiple windings. Transformer design with flux density 
optimized for minimum total loss is described in Chapter 15. 
13.5.4 
Coupled Inductor 
A coupled inductor is a filter inductor having multiple windings. Figure 13.47(a) illustrates coupled 
inductors in a two-output forward converter. The inductors can be wound on the same core, because the 
winding voltage waveforms are proportional. The inductors of the SEPIC and Cuk converters, as well as 
of multiple-output buck-derived converters and some other converters, can be coupled. The inductor cur-
rent ripples can be controlled by control of the winding leakage inductances [12,13]. De currents flow in 
each winding as illustrated in Fig. 13.47(b), and the net magnetization of the core is proportional to the 
sum of the winding ampere-turns: 
(13.104) 
As in the case of the single-winding filter inductor, the size of the minor B-H loop is proportional to the 
total current ripple (Fig. 13.48). Small ripple implies small core loss, as well as small proximity loss. An 
air gap is employed, and the maximum flux density is typically limited by saturation. 
(a) 
+ 
Fig. 13.47 Coupling the output filter inductors 
of a two-output forward converter: (a) schematic, 
(b) typical inductor current waveforms. 
+ 
(b) 

530 
Basic Magnetics Theory 
Fig. 13.48 Coupled inductor minor B-H loop. 
13.5.5 
Flyback Transformer 
Minor B-H loop, 
coupled inductor 
B 
As discussed in Chapter 6, the flyback transformer functions as an inductor with two windings. The pri-
mary winding is used during the transistor conduction interval, and the secondary is used during the 
diode conduction interval. A flyback converter is illustrated in Fig. l3.49(a), with the flyback transformer 
modeled as a magnetizing inductance in parallel with an ideal transformer. The magnetizing current iM(t) 
is proportional to the core magnetic field strength H/t). Typical DCM waveforms are given in Fig. 
13.49(b). 
Since the flyback transformer stores energy, an air gap is needed. Core loss depends on the mag-
nitude of the ac component of the magnetizing current. The B-H loop for discontinuous conduction 
mode operation is illustrated in Fig. 13.50. When the converter is designed to operate in DCM, the core 
loss is significant. The peak ac flux density fill is then chosen to maintain an acceptably low core loss. 
For CCM operation, core loss is less significant, and the maximum flux density may be limited only by 
saturation of the core. In either case, winding proximity losses are typically quite significant. Unfortu-
nately, interleaving the windings has little impact on the proximity loss because the primary and second-
ary winding currents are out of phase. 
(a) 
i! 
+ I 
LM 
L ......... L... 
... -.... -... -.... -l 
........... L... 
... -.. ,!-. -----L----l 
Fig. 13.49 Flyback transformer: (a) converter schematic, with transformer equivalent circuit, (b) DCM current 
waveforms. 

13.6 Summary of Key Points 
531 
B 
Fig. 13.50 Operational B-H loop of a DCM flyback transformer. 
13.6 
1. 
2. 
3. 
4. 
5. 
6. 
SUMMARY OF KEY POINTS 
Magnetic devices can be modeled using lumped-element magnetic circuits, in a manner similar to that 
commonly used to model electrical circuits. The magnetic analogs of electrical voltage V, current /, and 
resistance R, are magnetomotive force (MMF) :Y, flux<!>, and reluctance iJl respectively. 
Faraday's law relates the voltage induced in a loop of wire to the derivative of flux passing through the 
interior of the loop. 
Ampere's law relates the total MMF around a loop to the total current passing through the center of the 
loop. Ampere's law implies that winding currents are sources of MMF, and that when these sources are 
included, then the net MMF around a closed path is equal to zero. 
Magnetic core materials exhibit hysteresis and saturation. A core material saturates when the flux density 
Breaches the saturation flux density Bsat· 
Air gaps are employed in inductors to prevent saturation when a given maximum current flows in the 
winding, and to stabilize the value of inductance. The inductor with air gap can be analyzed using a simple 
magnetic equivalent circuit, containing core and air gap reluctances and a source representing the winding 
MMF. 
Conventional transformers can be modeled using sources representing the MMFs of each winding, and the 
core MMF. The core reluctance approaches zero in an ideal transformer. Nonzero core reluctance leads to 
an electrical transformer model containing a magnetizing inductance, effectively in parallel with the ideal 
transformer. Flux that does not link both windings, or "leakage flux," can be modeled using series induc-
tors. 
7. 
The conventional transformer saturates when the applied winding volt-seconds are too large. Addition of 
an air gap has no effect on saturation. Saturation can be prevented by increasing the core cross-sectional 
area, or by increasing the number of primary turns. 
8. 
Magnetic materials exhibit core Joss, due to hysteresis of the B-H loop and to induced eddy currents flow-
ing in the core material. In available core materials, there is a tradeoff between high saturation flux density 
Bsat and high core loss Pfe· Laminated iron alloy cores exhibit the highest B'"' but also the highest Pfe' 
while ferrite cores exhibit the lowest Pfe but also the lowest Bsat. Between these two extremes are pow-
dered iron alloy and amorphous alloy materials. 
9. 
The skin and proximity effects lead to eddy currents in winding conductors, which increase the copper Joss 
P cu in high-current high-frequency magnetic devices. When a conductor has thickness approaching or 

532 
Basic Magnetics Theory 
larger than the penetration depth o, magnetic fields in the vicinity of the conductor induce eddy currents in 
the conductor. According to Lenz's law, these eddy currents flow in paths that tend to oppose the applied 
magnetic fields. 
10. 
The magnetic field strengths in the vicinity of the winding conductors can be determined by use of MMF 
diagrams. These diagrams are constructed by application of Ampere's law, following the closed paths of 
the magnetic field lines which pass near the winding conductors. Multiple-layer noninterleaved windings 
can exhibit high maximum MMFs, with resulting high eddy currents and high copper loss. 
11. 
An expression for the copper loss in a layer, as a function of the magnetic field strengths or MMFs sur-
rounding the layer, is given in Section 13.4.4. This expression can be used in conjunction with the MMF 
diagram, to compute the copper loss in each layer of a winding. The results can then be summed, yielding 
the total winding copper loss. When the effective layer thickness is near to or greater than one skin depth, 
the copper losses of multiple-layer noninterleaved windings are greatly increased. 
12. 
Pulse-width-modulated winding currents contain significant total harmonic distortion, which can lead to a 
further increase of copper loss. The increase in proximity loss caused by current harmonics is most pro-
nounced in multiple-layer non-interleaved windings, with an effective layer thickness near one skin depth. 
REFERENCES 
[1] 
MIT STAFF, Magnetic Circuits and Transformers, Cambridge: The MIT Press, 1943. 
[2] 
J. K. WATSON, Applications of Magnetism, New York: John Wiley & Sons, 1980. 
[3] 
R. P. SEVERNS and G. E. BLOOM, Modern De-to-De Switchmode Power Converter Circuits, New York: 
Van Nostrand Reinhold, 1985. 
[4] 
A. DAUHAJRE and R. D. MIDDLEBROOK, "Modeling and Estimation of Leakage Phenomena in Magnetic 
Circuits," IEEE Power Electronics Specialists Conference, 1986 Record, pp. 213-226. 
[5] 
S. EL-HAMAMSY and E. CHANG, "Magnetics Modeling for Computer-Aided Design of Power Electronics 
Circuits," IEEE Power Electronics Specialists Conference, 1989 Record, pp. 635-645. 
[6] 
P. L. DOWELL, "Effects of Eddy Currents in Transformer Windings," Proceedings of the lEE, Vol. 113, No. 
8, August 1966, pp. 1387-1394. 
[7] 
M. P. PERRY, "Multiple Layer Series Connected Winding Design for Minimum Loss," IEEE Transactions 
on Power Apparatus and Systems, Vol. PAS-98, No.1, Jan./Feb. 1979, pp. 116-123. 
[8] 
P. S. VENKATRAMAN, "Winding Eddy Current Losses in Switch Mode Power Transformers Due to Rect-
angular Wave Currents," Proceedings of Powercon 11, 1984, pp. A1.1 - A1.11. 
[9] 
B. CARSTEN, "High Frequency Conductor Losses in Switchmode Magnetics," High Frequency Power 
Converter Conference, 1986 Record, pp. 155-176. 
[10] 
J.P. V ANDELAC and P. ZIOGAS, "A Novel Approach for Minimizing High Frequency Transformer Copper 
Losses," IEEE Power Electronics Specialists Conference, 1987 Record, pp. 355-367. 
[11] 
A.M. URLING, V. A. NIEMELA, G. R. SKUTT, and T. G. WILSON, "Characterizing High-Frequency Effects 
in Transformer Windings-A Guide to Several Significant Articles," IEEE Applied Power Electronics 
Conference, 1989 Record, pp. 373-385. 

Problems 
533 
[12] 
S. CUK and R. D. MIDDLEBROOK, "Coupled-Inductor and Other Extensions of a New Optimum Topology 
Switching De-to-De Converter," IEEE Industry Applications Society Annual Meeting, 1977 Proceedings, 
pp. 1110-1122. 
[13] 
S. CUK and Z. ZHANG, "Coupled-Inductor Analysis and Design," IEEE Power Electronics Specialists 
Conference, 1986 Record, pp. 655-665. 
PROBLEMS 
13.1 
The core illustrated in Fig. 13.51(a) is 1 em thick. All legs are 1 em wide, except for the right-hand side 
vertical leg, which is 0.5 em wide. You may neglect nonuniformities in the flux distribution caused by 
turning corners. 
(a) 
3em 
3em 
i, 
~r ................... T.0 
................. 1 
~ 
n, turns --t-
s! 
i 0.5 em 
-'---
i 
~! 
i 
terri 
!1+-
i 
i 
i. ... J£m ........ i. ... ) .. 9!! ........ 11 
!em 
! 
Core relative permeability ll, = 1000 
n1 = 10 
Fig. 13.51 Problem 13.1 
(b) 
i, 
i2 
1 turns -
~-~ 
..___ 
n 
(a) 
Determine the magnetic circuit model of this device, and label the values of all reluctances in 
your model. 
(b) 
Determine the inductance of the winding. 
A second winding is added to the same core, as shown in Fig. 13.51(b). 
(c) 
Modify your model of part (a) to include this winding. 
(d) 
The electrical equations for this circuit may be written in the form 
Use superposition to determine analytical expressions and numerical values for L1i' L 12, and Lz2• 
13.2 
Two windings are placed as illustrated in Fig. 13.52(a) on a core of uniform cross-sectional area 
Ac = 1 cm2. Each winding has 50 turns. The relative permeability of the core is J.l., = 104. 
(a) 
Sketch an equivalent magnetic circuit, and determine numerical values for each reluctance. 
(b) 
Determine the self-inductance of each winding. 
(c) 
Determine the inductance L+ obtained when the windings are connected in series as in Fig. 
13.52(b). 
(d) 
Determine the inductance C obtained when the windings are connected in anti-series as in Fig. 
13.52(c). 

534 
Basic Magnetics Theory 
(a) 
i[ • 
+ i2. 
r--
v2_4 -
-
Fig. 13.52 Problem 13.2. 
Scm 
Scm 
13.3 
All three legs of the magnetic device illustrated in Fig. 13.53 are of uniform cross-sectional area Ac-
Legs 1 and 2 each have magnetic path length 3t, while leg 3 has magnetic path length e. Both windings 
have n turns. The core has permeability f1 > f1o· 
i[ 
( 
-
-
Leg 
I 
Fig. 13.53 Magnetic core for Problem 13.3. 
Leg 
3 
cr--
Leg 
2 
i2 
-
(a) 
Sketch a magnetic equivalent circuit, and give analytical expressions for all element values. 
A voltage source is connected to winding 1, such that v1(t) is a square wave of peak value Vmax and 
period Ts. Winding 2 is open-circuited. 
(b) 
Sketch i1(t) and label its peak value. 
(c) 
Find the flux <p2(t) in leg 2. Sketch <p2(t) and label its peak value. 
(d) 
Sketch vz(t) and label its peak value. 
13.4 
The magnetic device illustrated in Fig. 13.54(a) consists of two windings, which can replace the two 
inductors in a Cuk, SEPIC, or other similar converter. For this problem, all three legs have the same uni-
form cross-sectional area A c. The legs have gaps of lengths gl' g2, and g3, respectively. The core perme-
ability f.( is very large. You may neglect fringing flux. Legs 1 and 2 have windings containing n1 and n2 
turns, respectively. 
(a) 
Derive a magnetic circuit model for this device, and give analytical expressions for each reluc-
tance in your model. Label the polarities of the MMF generators. 
(b) 
Write the electrical terminal equations of this device in the matrix form 

Problems 
535 
(a) 
(b) 
R 
v 
+ 
Fig. 13.54 
Magnetic core and converter for Problem 13.4. 
and derive analytical expressions for L11 , L12, and Lzz-
(c) 
Derive an electrical circuit model for this device, and give analytical expressions for the turns 
ratio and each inductance in your model, in terms of the turns and reluctances of part (a). 
This single magnetic device is to be used to realize the two inductors of the Cuk converter, as in Fig. 
13.54(b). 
(d) 
(e) 
Sketch the voltage waveforms v1(t) and v2(t), making the linear ripple approximation as appro-
priate. You may assume that the converter operates in the continuous conduction mode. 
The voltage waveforms of part (d) are applied to your model of parts (b) and (c). Solve your 
model to determine the slopes of the inductor current ripples during intervals DT, and D' Ts. 
Sketch the steady-state inductor current waveforms i1(t) and iz(t), and label all slopes. 
(f) 
By skillful choice of n/n2 and the air gap lengths, it is possible to make the inductor current rip-
ple /';.i in either i1(t) or iz(t) go to zero. Determine the conditions on n/n2, gl' g2, and g3 that 
cause the current ripple in iz(t) to become zero. Sketch the resulting i1(t) and i2(t), and label all 
slopes. 
It is possible to couple the inductors in this manner, and cause one of the inductor current ripples to go to 
zero, in any converter in which the inductor voltage waveforms are proportional. 
13.5 
Over its usable operating range, a certain permanent magnet material has the B-H characteristics illus-
trated by the solid line in Fig. 13.55. The magnet has length em= 0.5 em, and cross-sectional area 4 cm2. 
Bm = 1 T. Derive an equivalent magnetic circuit model for the magnet, and label the numerical values of 
the elements. 
Fig. 
13.55 
B-H characteristic of the permanent 
magnet material for Problem 13.5. 
•' 
I 
B 
H 

536 
Basic Magnetics Theory 
13.6 
The two-transistor forward converter of Fig. 6.27 operates with V8 = 300 V, V = 28 V, switching fre-
quency fs = 100 kHz, and turns ratio n = 0.25. The de load power is 250 W. The transformer uses an 
EC41 ferrite core; relevant data for this core is listed in Appendix D. The core loss is given by Fig. 13.20. 
The primary winding consists of 44 turns of #21 AWG wire, and the secondary winding is composed of 
11 turns of #15 AWG wire. Data regarding the American wire gauge is also listed in Appendix D. 
(a) 
Estimate the core loss of this transformer 
(b) 
Determine the copper loss of this transformer. You may neglect proximity losses. 
13.7 
The two-transistor forward converter of Fig. 6.27 operates in CCM with V8 = 300 V, V = 28 V, switching 
frequency fs =100kHz, and turns ration= 0.25. The de load power is 250 W. The transformer uses an 
EC41 ferrite core; relevant data for this core is listed in Appendix D. This core has window height 
ew = 2. 78 em. The primary winding consists of 44 turns of #24 AWG wire, and the secondary winding is 
composed of 11 turns of #14 AWG wire. Each winding comprises one layer. Data regarding the Ameri-
can wire gauge is also listed in Appendix D. The winding operates at room temperature. 
(a) 
Determine the primary and secondary copper losses induced by the de components of the wind-
ing currents. 
(b) 
Determine the primary and secondary copper losses induced by the fundamental components of 
the winding currents. 
(c) 
Determine the primary and secondary copper losses induced by the second harmonic compo-
nents of the winding currents. 
13.8 
The winding currents of the transformer in a high-voltage inverter are essentially sinusoidal, with negli-
gible harmonics and no de components. The primary winding consists of one layer containing 10 turns 
of round copper wire. The secondary winding consists of 250 turns of round copper wire, arranged in ten 
layers. The operating frequency isf= 50 kHz, and the winding porosity is 0.8. Determine the primary 
and secondary wire diameters and wire gauges that minimize the total copper loss. 
13.9 
A certain three-winding transformer contains one primary and two secondaries. The operating frequency 
is 40kHz. The primary winding contains a total of 60 turns of #26AWG, arranged in three layers. The 
secondary windings each consist of five turns of copper foil, one tum per layer. The foil thickness is 
0.25 rnm. The primary layers have porosity 0.8, while the secondary layer porosity is 1. The primary 
winding carries a sinusoidal current having rms value /, while each secondary carries rms current 6/. The 
windings are not interleaved: the primary winding is closest to the center leg of the core, followed by 
secondary winding #1, followed by secondary winding #2. 
(a) 
Sketch an MMF diagram illustrating the magnetic fields in the vicinity of each winding layer. 
(b) 
Determine the increased copper loss, due to the proximity effect, in each layer. 
(c) 
Determine the ratio of copper loss to de copper loss, FR, for the entire transformer windings. 
(d) 
In this application, it is not feasible to interleave the primary winding with the other windings. 
However, changing the conductor size is permissible. Discuss how the windings could be better 
optimized. 
13.10 
A transformer winding contains a four-layer primary winding, and two two-layer secondary windings. 
Each layer of the primary winding carries total current I. Each layer of secondary winding # 1 carries 
total current 1.5/. Each layer of secondary winding #2 carries total current 0.5/. All currents are sinusoi-
dal. The effective relative conductor thickness is cp = 2. The windings are partially interleaved, in the fol-
lowing order: two primary layers, followed by both layers of secondary #1, followed by both layers of 
secondary #2, and finally the two remaining primary layers. 
(a) 
Sketch an MMF diagram for this winding arrangement. 
(b) 
Determine the increased copper loss, due to the proximity effect, for each layer. 
(c) 
Determine the increase in total transformer copper loss, due to the proximity effect. 

13.11 
13.12 
Problems 
537 
A single-output forward converter contains a transformer having a noninterleaved secondary winding 
with four layers. The converter operates at D = 0.3 in CCM, with a secondary winding current waveform 
similar to Fig. 13.38. 
(a) 
Estimate the value of q>1 that minimizes the secondary winding copper losses. 
(b) 
Determine the resulting secondary copper loss, relative to I,m/ Rdc. 
A schematic diagram and waveforms of the isolated SEPIC, operating in CCM, are given in Figs. 6.37 
and 6.38. 
(a) 
Do you expect the SEPIC transformer to contain an air gap? Why or why not? 
(b) 
Sketch the SEPIC transformer B-H loop, for CCM operation. 
(c) 
For CCM operation, do you expect core loss to be significant? Explain your reasoning. 
(d) 
For CCM operation, do you expect winding proximity losses to be significant? Explain your rea-
soning. 

14 
Inductor Design 
This chapter treats the design of magnetic elements such as filter inductors, using the Kg method. With 
this method, the maximum flux density Bmax is specified in advance, and the element is designed to attain 
a given copper loss. 
The design of a basic filter inductor is discussed in Sections 14.1 and 14.1.5. In the filter induc-
tor application, it is necessary to obtain the required inductance, avoid saturation, and obtain an accept-
able low de winding resistance and copper loss. The geometrical constant Kg is a measure of the effective 
magnetic size of a core, when de copper loss and winding resistance are the dominant constraints [1,2]. 
Design of a filter inductor involves selection of a core having a Kg sufficiently large for the application, 
then computing the required air gap, turns, and wire size. A simple step-by-step filter inductor design 
procedure is given. Values of Kg for common ferrite core shapes are tabulated in Appendix D. 
Extension of the Kg method to multiple-winding elements is covered in Section 14.3. In applica-
tions requiring multiple windings, it is necessary to optimize the wire sizes of the windings so that the 
overall copper loss is minimized. It is also necessary to write an equation that relates the peak flux den-
sity to the applied waveforms or to the desired winding inductance. Again, a simple step-by-step trans-
former design approach is given. 
The goal of the K8 approach of this chapter is the design of a magnetic device having a given 
copper loss. Core loss is not specifically addressed in the Kg approach, and Bmax is a given fixed value. In 
the next chapter, the flux density is treated as a design variable to be optimized. This allows the overall 
loss (i.e., core loss plus copper loss) to be minimized. 
14.1 
FILTER INDUCTOR DESIGN CONSTRAINTS 
A filter inductor employed in a CCM buck converter is illustrated in Fig. 14.l(a). In this application, the 
value of inductance Lis usually chosen such that the inductor current ripple peak magnitude l'!.i is a small 
fraction of the full-load inductor current de component I, as illustrated in Fig. 14.l(b). As illustrated in 
Fig. 14.2, an air gap is employed that is sufficiently large to prevent saturation of the core by the peak 

540 
Inductor Design 
(a) 
L 
i(t) 
(b) 
Fig. 14.1 
Filter inductor employed in a CCM buck converter: (a) circuit schematic, (b) inductor current wave-
form. 
(a) 
i(t) 
+ 
n 
(t) 
turns 
v 
-
"' 
Core reluctance &lc 
<I> 
" 
I 
' r 
"" 
-
-~ 
"" 
Air gap 
reluctance 
fJlg 
Fig. 14.2 Filter inductor: (a) structure, (b) magnetic circuit model. 
current I+ 11i. 
(b) 
ni(t) 
Let us consider the design of the filter inductor illustrated in 
Figs. 14.1 and 14.2. It is assumed that the core and proximity losses are 
negligible, so that the inductor losses are dominated by the low-frequency 
copper losses. The inductor can therefore be modeled by the equivalent 
circuit of Fig. 14.3, in which R represents the de resistance of the wind-
ing. It is desired to obtain a given inductance L and given winding resis-
tance R. The inductor should not saturate when a given worst-case peak 
current !max is applied. Note that specification of R is equivalent to speci-
fication of the copper loss Pcu' since 
+ 
L 
i(t) 
R 
(14.1) 
Fig. 
14.3 Filter inductor 
The influence of inductor winding resistance on converter efficiency and 
output voltage is modeled in Chapter 3. 
equivalent circuit. 

14.1 
Filter Inductor Design Constraints 
541 
(a) 
+ 
v(t) 
i(t) 
" 
n 
turns 
" 
Q:> 
1'\ 
f 
~~ 
=~ 
" 
/ Cross-sectional 
areaAc 
Air gap 
eg 
Fig. 14.4 
Filter inductor: (a) assumed geometry, (b) magnetic circuit. 
(b) 
ni(t) 
It is assumed that the inductor geometry is topologically equivalent to Fig. 14.4(a). An equiva-
lent magnetic circuit is illustrated in Fig. 14.4(b). The core reluctance .Ullc and air gap reluctance .dflg are 
(14.2) 
where ec is the core magnetic path length, Ac is the core cross-sectional area, 11-c is the core permeability, 
and eg is the air gap length. It is assumed that the core and air gap have the same cross-sectional areas. 
Solution of Fig. 14.4(b) yields 
(14.3) 
Usually, &lc < &l8 , and hence Eq. (14.3) can be approximated as 
(14.4) 
The air gap dominates the inductor properties. Four design constraints now can be identified. 
14.1.1 
Maximum Flux Density 
Given a peak winding current !max' it is desired to operate the core flux density at a maximum value Bmax· 
The value of Bmax is chosen to be less than the worst-case saturation flux density Bm, of the core material. 
Substitution of Q:> = BAc into Eq. (14.4) leads to 
Upon letting I= !max and B = Bmax' we obtain 
eg 
nl max= BmaxAc /l?g = Bmax llo 
This is the first design constraint. The turns ration and the air gap length C8 are unknowns. 
(14.5) 
(14.6) 

542 
Inductor Design 
14.1.2 
Inductance 
The given inductance value L must be obtained. The inductance is equal to 
(14.7) 
This is the second design constraint. The turns ration, core area Ac, and gap length £8 are unknown. 
14.1.3 
Winding Area 
As illustrated in Fig. 14.5, the winding must fit through the window, i.e., the hole in the center of the 
core. The· cross-sectional area of the conductor, or bare area, is Aw If the winding has n turns, then the 
area of copper conductor in the window is 
(14.8) 
If the core has window area WA, then we can express the area available for the winding conductors as 
(14.9) 
where K11 is the window utilization factor, or fill factor. Hence, the third design constraint can be 
expressed as 
(14.10) 
The fill factor K11 is the fraction of the core window area that is filled with copper. K11 must lie 
between zero and one. As discussed in [1], there are several mechanism that cause K11 to be Jess than 
unity. Round wire does not pack perfectly; this reduces K11 by a factor of 0.7 to 0.55, depending on the 
winding technique. The wire has insulation; the ratio of wire conductor area to total wire area varies from 
approximately 0.95 to 0.65, depending on the wire size and type of insulation. The bobbin uses some of 
the window area. Insulation may be required between windings and/or winding layers. Typical values of 
K11 for cores with winding bobbins are: 0.5 for a simple low-voltage inductor, 0.25 to 0.3 for an off-line 
transformer, 0.05 to 0.2 for a high-voltage transformer supplying several kV, and 0.65 for a low-voltage 
foil transformer or inductor. 
Wire bare area 
Aw -
Core 
--
Fig. 14.5 The winding must fit in the core window area. 
1--1- Core window 
area WA 

14.1.4 
Winding Resistance 
The resistance of the winding is 
e 
R=p-b 
Aw 
14.1 
Filter Inductor Design Constraints 
543 
(14.11) 
where p is the resistivity of the conductor material, eb is the length of the wire, and Aw is the wire bare 
area. The resistivity of copper at room temperature is 1.724 · 10-6 Q-cm. The length of the wire compris-
ing an n-tum winding can be expressed as 
eb = n(MLT) 
(14.12) 
where (MLT) is the mean-length-per-tum of the winding. The mean-length-per-tum is a function of the 
core geometry. Substitution of Eq. (14.12) into (14.11) leads to 
This is the fourth constraint. 
n(MLT) 
R=p-A-
w 
14.1.5 
The Core Geometrical Constant Kg 
(14.13) 
The four constraints, Eqs. (14.6), (14.7), (14.10), and (14.13), involve the quantities Ac, WA, and MLT, 
which are functions of the core geometry, the quantities /max' Bmax' flo, L, Ku, R, and p, which are given 
specifications or other known quantities, and n, e8 , and Aw, which are unknowns. Elimination of the 
unknowns n, e8 , and Aw leads to the following equation: 
(14.14) 
The quantities on the right side of this equation are specifications or other known quantities. The left side 
of the equation is a function of the core geometry alone. It is necessary to choose a core whose geometry 
satisfies Eq. (14.14). 
The quantity 
(14.15) 
is called the core geometrical constant. It is a figure-of-merit that describes the effective electrical size of 
magnetic cores, in applications where copper loss and maximum flux density are specified. Tables are 
included in Appendix D that list the values of K8 for several standard families of ferrite cores. Kg has 
dimensions of length to the fifth power. 
Equation (14.14) reveals how the specifications affect the core size. Increasing the inductance or 
peak current requires an increase in core size. Increasing the peak flux density allows a decrease in core 
size, and hence it is advantageous to use a core material that exhibits a high saturation flux density. 
Allowing a larger winding resistance R, and hence larger copper loss, leads to a smaller core. Of course, 

544 
Inductor Design 
the increased copper loss and smaller core size will lead to a higher temperature rise, which may be 
unacceptable. The fill factor Ku also influences the core size. 
Equation (14.15) reveals how core geometry affects the core capabilities. An inductor capable 
of meeting increased electrical requirements can be obtained by increasing either the core area Ac, or the 
window area WA. Increase of the core area requires additional iron core material. Increase of the window 
area implies that additional copper winding material is employed. We can trade iron for copper, or vice 
versa, by changing the core geometry in a way that maintains the K8 ofEq. (14.15). 
14.2 
A STEP-BY-STEP PROCEDURE 
The procedure developed in Section 14.1 is summarized below. This simple filter inductor design proce-
dure should be regarded as a first-pass approach. Numerous issues have been neglected, including 
detailed insulation requirements, conductor eddy current losses, temperature rise, roundoff of number of 
turns, etc. 
The following quantities are specified, using the units noted: 
Wire resistivity 
p 
(Q-cm) 
Peak winding current 
/max 
(A) 
Inductance 
L 
(H) 
Winding resistance 
R 
(Q) 
Winding fill factor 
Ku 
Maximum operating flux density 
Bmax 
(T) 
The core dimensions are expressed in em: 
Core cross-sectional area 
Ac 
(cm2) 
Core window area 
WA 
(cm2) 
Mean length per turn 
MLT 
(em) 
The use of centimeters rather than meters requires that appropriate factors be added to the design equa-
tions. 
1. 
Determine core size 
(14.16) 
Choose a core which is large enough to satisfy this inequality. Note the values of Ac, WA, and MLT for 
this core. The resistivity p of copper wire is 1.724 · 10--{5 Q-cm at room temperature, and 2.3 · 10--{5 Q-cm 
at 100'C. 
2. 
Determine air gap length 
(14.17) 
with Ac expressed in cm2. llo = 4n · 10-7 Him. The air gap length is given in meters. The value expressed 
in Eq. (14.17) is approximate, and neglects fringing flux and other nonidealities. 

14.3 
Multiple-Winding Magnetics Design via the K8 Method 
545 
Core manufacturers sell gapped cores. Rather than specifying the air gap length, the equivalent 
quantity AL is used. AL is equal to the inductance, in mH, obtained with a winding of 1000 turns. When 
AL is specified, it is the core manufacturer's responsibility to obtain the correct gap length. Equation 
( 14.17) can be modified to yield the required Av as follows: 
(mH/1000 turns) 
where Ac is given in cm2, Lis given in Henries, and Bmax is given in Tesla. 
3. 
Determine number of turns 
4. 
Evaluate wire size 
(14.18) 
(14.19) 
(14.20) 
Select wire with bare copper area less than or equal to this value. An American Wire Gauge table is 
included in Appendix D. 
As a check, the winding resistance can be computed: 
R = pn ~LT) (Q) 
(14.21) 
14.3 
MULTIPLE-WINDING MAGNETICS DESIGN VIA THE K8 METHOD 
The K8 method can be extended to the case of multiple-winding magnetics, such as the transformers and 
coupled inductors described in Sections 13.5.3 to 13.5.5. The desired turns ratios, as well as the desired 
winding voltage and current waveforms, are specified. In the case of a coupled inductor or fly back trans-
former, the magnetizing inductance is also specified. It is desired to select a core size, number of turns 
for each winding, and wire sizes. It is also assumed that the maximum flux density Bmax is given. 
With the Kg method, a desired copper loss is attained. In the multiple-winding case, each wind-
ing contributes some copper loss, and it is necessary to allocate the available window area among the 
various windings. In Section 14.3.1 below, it is found that total copper loss is minimized if the window 
area is divided between the windings according to their apparent powers. This result is employed in the 
following sections, in which an optimized Kg method for coupled inductor design is developed. 
14.3.1 
Window Area Allocation 
The first issue to settle in design of a multiple-winding magnetic device is the allocation of the window 
area Aw among the various windings. It is desired to design a device having k windings with turns ratios 
n1 : n2 : ... : nk. These windings must conduct rms currents / 1, !2, ... , Ik respectively. It should be noted that 
the windings are effectively in parallel: the winding voltages are ideally related by the turns ratios 

546 
Inductor Design 
rms current 
/I 
II 
: nk 
rms current 
/2 
rms current 
lk 
Fig. 14.6 
It is desired to optimally allocate the window area of a k-winding magnetic element to minimize low-
frequency copper losses, with given rms winding currents and turns ratios. 
(14.22) 
However, the winding rms currents are determined by the loads, and in general are not related to the turns 
ratios. The device is represented schematically in Fig. 14.6. 
The relevant geometrical parameters are summarized in Fig. 14.7(a).lt is necessary to allocate a 
portion of the total window area WA to each winding, as illustrated in Fig. 14.7(b). Let aj be the fraction 
of the window area allocated to windingj, where 
Fig. 
14.7 
Basic core topology, 
including window area WA enclosed by 
core (a). The window is allocated to 
the various windings to minimize low-
frequency copper loss (b). 
O<aj<l 
a 1 +a2 + ··· +ak= 1 
(a) 
(b) 
(14.23) 
Window area WA 
Core mean length 
per turn (MLT) 
Wire resistivity p 
Fill factor Ku 
Total window 
area WA 

14.3 Multiple-Winding Magnetics Design via the Kg Method 
547 
The low-frequency copper loss PcuJ in windingj depends on the de resistance Rj of windingj, as follows: 
(14.24) 
The resistance of winding j is 
(14.25) 
where pis the wire resistivity, ej is the length of the wire used for windingj, andAwJ is the cross-sectional 
area of the wire used for windingj. These quantities can be expressed as 
(14.26) 
(14.27) 
where (MLT) is the winding mean-length-per-tum, and Ku is the winding fill factor. Substitution of these 
expressions into Eq. (14.25) leads to 
(14.28) 
The copper loss of windingj is therefore 
n]iJP(MLT) 
pcu,j= 
W K a. 
A 
u 
J 
(14.29) 
The total copper loss of the k windings is 
p(MLT) 
k (n]IJ) 
Pcu,tot = Pcu,! + pcu,2 + • · · + pcu,k = ---w-x- ~I ~ 
A 
u J-
J 
(14.30) 
It is desired to choose the ajs such that the total copper loss Pcu,tot is minimized. Let us consider what 
happens when we vary one of the as, say al' between 0 and 1. 
When a 1 = 0, then we allocate zero area to winding 1. In consequence, the resistance of winding 
1 tends to infinity. The copper loss of winding 1 also tends to infinity. On the other hand, the other wind-
ings are given maximum area, and hence their copper losses can be reduced. Nonetheless, the total cop-
per loss tends to infinity. 
When a 1 = 1, then we allocate all of the window area to winding 1, and none to the other wind-
ings. Hence, the resistance of winding 1, as well as its low-frequency copper loss, are minimized. But the 
copper losses of the remaining windings tend to infinity. 
As illustrated in Fig. 14.8, there must be an optimum value of a 1 that lies between these two 
extremes, where the total copper loss is minimized. Let us compute the optimum values of a" ~ 
.... , ak 
using the method of Lagrange multipliers. It is desired to minimize Eq. (14.30), subject to the constraint 
of Eq. (14.23). Hence, we define the function 

548 
Inductor Design 
Copper 
loss 
0 
Fig. 14.8 Variation of copper losses with 0:1. 
where 
k 
g(a 1, a 2, ... , ak) = 1- L aj 
j=l 
(14.31) 
(14.32) 
is the constraint that must equal zero, and ~ is the Lagrange multiplier. The optimum point is the solution 
of the system of equations 
The solution is 
df(al, Uz, ... , ak,~) 0 
da 1 
()j(al, a.z, ... , ak,~) 0 
da2 
(14.33) 
(14.34) 
(14.35) 
This is the optimal choice for the as, and the resulting minimum value of Pcu tor 
According to Eq. (14.22), the winding voltages are proportional to 'the turns ratios. Hence, we 
can express the ams in the alternate form 

14.3 
Multiple-Winding Magnetics Design via the Kg Method 
549 
by multiplying and dividing Eq. (14.35) by the quantity Vmlnm .It is irrelevant whether rms or peak volt-
ages are used. Equation (14.36) is the desired result. It states that the window area should be allocated to 
the various windings in proportion to their apparent powers. The numerator ofEq. (14.36) is the apparent 
power of winding m, equal to the product of the rms current and the voltage. The denominator is the sum 
of the apparent powers of all windings. 
As an example, consider the PWM full-bridge transformer having a center-tapped secondary, as 
illustrated in Fig. 14.9. This can be viewed as a three-winding transformer, having a single primary-side 
winding of n1 turns, and two secondary-side windings, each of n2 turns. The winding current waveforms 
i1(t), iit), and i3(t) are illustrated in Fig. 14.10. Their rms values are 
_1_ rzT, ii(t)dt = nz I m 
2T, ] 0 
n 1 
1 12T, 
2T 
i~(t)dt = i Iv' 1 + D 
s 
0 
Substitution of these expressions into Eq. (14.35) yields 
a -
1 
1-(1+)1tD} 
If the design is to be optimized at the operating point D = 0.75, then one obtains 
a 1 = 0.396 
a 2 = 0.302 
a 3 = 0.302 
(14.37) 
(14.38) 
(14.39) 
(14.40) 
(14.41) 
So approximately 40% of the window area should be allocated to the primary winding, and 30% should 
n1 turns { 
iit) 
Fig. 14.9 PWM full-bridge transformer example. 

550 
Inductor Design 
Fig. 14.10 
Transformer waveforms, 
PWM full-bridge converter example. 
1 
I 
0 
0 
0.5I 
0.5I 
0 
0 
0.5I 
r 
..--------'' 
I 
0.5I 
0 
DT, 
T, 
T, +DT, 
2T8 t 
be allocated to each half of the center-tapped secondary. The total copper loss at this optimal design point 
is found from evaluation ofEq. (14.34): 
p(MLT) ( 3 
) 2 
pcu,tot=wy-
~ n/i 
A 
u 
J- I 
(14.42) 
p(MLT)n 2 12 ( 
) 
= 
WK
2 
1+2D+2./D(l+D) 
A 
u 
14.3.2 
Coupled Inductor Design Constraints 
Let us now consider how to design a k-winding coupled inductor, as discussed in Section 13.5.4 and 
illustrated in Fig. 14.11. It is desired that the magnetizing inductance be a specified value LM, referred to 
winding 1. It is also desired that the numbers of turns for the other windings be chosen according to 
desired turns ratios. When the magnetizing current iM(t) reaches its maximum value IM max' the coupled 
inductor should operate with a given maximum flux density Bmax· With rms currents Ip f2, ... , Ik applied to 
the respective windings, the total copper loss should be a desired value Pcu given by Eq. (14.34). Hence, 
the design procedure involves selecting the core size and number of primary turns so that the desired 
magnetizing inductance, the desired flux density, and the desired total copper loss are achieved. Other 
quantities, such as air gap length, secondary turns, and wire sizes, can then be selected. The derivation 
follows the derivation for the single winding case (Section 14.1), and incorporates the window area opti-
mization of Section 14.3.1. 
The magnetizing current iM(t) can be expressed in terms of the winding currents i 1(t), iit), ... , 
ik(t) by solution of Fig. 14.11(a) (or by use of Ampere's Law), as follows: 
(14.43) 
By solution of the magnetic circuit model of Fig. 14.11(b), we can write 

14.3 Multiple-Winding Magnetics Design via the Kg Method 
551 
(a) 
n, 
nz 
(b) 
iz(t) 
.'Jflc 
R, 
Rz 
n1iM(t) 
~ 
iYlg 
ik(t) 
Fig. 14.11 
A k-winding magnetic device, with specified turns ratios and waveforms: (a) electrical circuit model, 
(b) a magnetic circuit model. 
n 1 i M(t) == B(t)A c'ifl 8 
(14.44) 
This equation is analogous to Eq. (14.4), and assumes that the reluctance Plig of the air gap is much larger 
than the reluctance PI( of the core. As usual, the total flux <I>(t) is equal to B(t)Ac. Leakage inductances 
are ignored. 
To avoid saturation of the core, the instantaneous flux density B(t) must be less than the satura-
tion flux density of the core material, Bsar Let us define IM max as the maximum value of the magnetizing 
current iM(t). According to Eq. (14.44), this will lead to a ~aximum flux density Bmax given by 
eg 
nllM,max==BmaxAc.iflg==Bmax llo 
(14.45) 
For a value of IM,max given by the circuit application, we should use Eq. (14.45) to choose the turns n1 and 
gap length eg such that the maximum flux density Bmax is less than the saturation density Bmt' Equation 
(14.45) is similar to Eq. (14.6), but accounts for the magnetizations produced by multiple winding cur-
rents. 
The magnetizing inductance Lw referred to winding 1, is equal to 
(14.46) 
This equation is analogous to Eq. (14.7). 
As shown in Section 14.3.1, the total copper loss is minimized when the core window area WA is 
allocated to the various windings according to Eq. (14.35) or (14.36). The total copper loss is then given 
by Eq. (14.34). Equation (14.34) can be expressed in the form 
p(MLT)n~ !~or 
pcu == 
W K 
A 
u 
(14.47) 

552 
Inductor Design 
where 
(14.48) 
is the sum of the rms winding currents, referred to winding 1. 
We can now eliminate the unknown quantities eg and n1 from Eqs. (14.45), (14.46), and (14.47). 
Equation (14.47) then becomes 
(14.49) 
We can now rearrange this equation, by grouping terms that involve the core geometry on the left-hand 
side, and specifications on the right-hand side: 
A;wA _ pL~I;o,I~,max 
(MLT)-
s;,axKuPcu 
(14.50) 
The left-hand side of the equation can be recognized as the same K8 term defined in Eq. (14.15). There-
fore, to design a coupled inductor that meets the requirements of operating with a given maximum flux 
density Bmax' given primary magnetizing inductance LM, and with a given total copper loss Pcu' we must 
select a core that satisfies 
(14.51) 
Once such a core is found, then the winding 1 turns and gap length can be selected to satisfy Eqs. (14.45) 
and (14.46). The turns of windings 2 through k are selected according to the desired turns ratios. The 
window area is allocated among the windings according to Eq. (14.35), and the wire gauges are chosen 
using Eq. (14.27). 
The procedure above is applicable to design of coupled inductors. The results are applicable to 
design of ftyback and SEPIC transformers as well, although it should be noted that the procedure does 
not account for the effects of core or proximity loss. It also can be extended to design of other devices, 
such as conventional transformers-doing so is left as a homework problem. 
14.3.3 
Design Procedure 
The following quantities are specified, using the units noted: 
Wire effective resistivity 
p 
(Q-cm) 
Total rms winding currents, referred to winding l 
(A) 
Peak magnetizing current, referred to winding 1 
(A) 
Desired turns ratios 

14.3 Multiple-Winding Magnetics Design via the Kg Method 
553 
Magnetizing inductance, referred to winding 1 
LM 
(H) 
Allowed total copper loss 
pcu 
(W) 
Winding fill factor 
Ku 
Maximum operating flux density 
Bmax 
(T) 
The core dimensions are expressed in em: 
Core cross-sectional area 
Ac 
(cm2) 
Core window area 
WA 
(cm2) 
Mean length per turn 
MLT 
(em) 
The use of centimeters rather than meters requires that appropriate factors be added to the design equa-
tions. 
1. 
Determine core size 
(14.52) 
Choose a core which is large enough to satisfy this inequality. Note the values of Ac, WA' and MLT for 
this core. The resistivity p of copper wire is 1.724 · w-6 Q-cm at room temperature, and 2.3 · 10-6 Q-cm 
at IOO'C. 
2. 
Determine air gap length 
(m) 
(14.53) 
Here, Bmax is expressed in Tesla, Ac is expressed in cm2, and egis expressed in meters. The permeability 
of free space is flo = 4n · 1 o- 7 Him. This value is approximate, and neglects fringing flux and other non-
idealities. 
3. 
Determine number of winding 1 turns 
Here, Bmax is expressed in Tesla and Ac is expressed in cm2. 
4. 
Determine number of secondary turns 
Use the desired turns ratios: 
(14.54) 
(14.55) 

554 
Inductor Design 
5. 
Evaluate fraction of window area allocated to each winding 
(14.56) 
6. 
Evaluate wire sizes 
(14.57) 
Select wire with bare copper area less than or equal to these values. An American Wire Gauge table is 
included in Appendix D. 
14.4 
EXAMPLES 
14.4.1 
Coupled Inductor for a Two-Output Forward Converter 
As a first example, let us consider the design of coupled inductors for the two-output forward converter 
illustrated in Fig. 14.12. This element can be viewed as two filter inductors that are wound on the same 
core. The turns ratio is chosen to be the same as the ratio of the output voltages. The magnetizing induc-
tance performs the function of filtering the switching harmonics for both outputs, and the magnetizing 
current is equal to the sum of the reflected winding currents. 
At the nominal full-load operating point, the converter operates in the continuous conduction 
mode with a duty cycle of D = 0.35. The switching frequency is 200kHz. At this operating point, it is 
desired that the ripple in the magnetizing current have a peak magnitude equal to 20% of the de compo-
nent of magnetizing current. 
The de component of the magnetizing current I M is 
IM = !1 + n2 /2 
nl 
= (4 A)+~~ (2 A) 
=4.86A 
The magnetizing current ripple lliM can be expressed as 
(14.58) 

(a) 
+ 
-1 
(b) 
14.4 Examples 
555 
f 
Output 1 
28V 
4A 
+ 
Output 2 
v2 
12 V 
2A 
Fig. 14.12 Two-output forward converter example: (a) circuit schematic, (b) coupled inductor model inserted into 
converter secondary-side circuit, (c) magnetizing current and voltage waveforms of coupled inductor, referred to 
winding 1. 
(14.59) 
Since we want D.iM to be equal to 20% of lw we should choose LM as follows: 
L 
_ V1D'T, 
M-
2/'..iM 
_ (28 V)(l- 0.35)(5 J.!S) 
(14.60) 
-
2( 4.86 A)(20%) 
=47 J.!H 
The peak magnetizing current, referred to winding 1, is therefore 
fM,max=/M +/'..iM =5.83 A 
(14.61) 
Since the current ripples of the winding currents are small compared to the respective de components, the 

556 
Inductor Design 
rms values of the winding currents are approximately equal to the de components: / 1 = 4 A, /2 = 2 A. 
Therefore, the sum of the rms winding currents, referred to winding 1, is 
(14.62) 
For this design, it is decided to allow 0.75 W of copper loss, and to operate the core at a maximum flux 
density of 0.25 Tesla. A fill factor of 0.4 is assumed. The required Kg is found by evaluation of Eq. 
(14.52), as follows: 
K :2: (1.724 · 10- 6 Q- cm)(47 J.1H) 2(4.86 A) 2(5.83 A) 2 108 
8 
(0.25 T) 2(0.75 W)(0.4) 
(14.63) 
= 16. 10- 3 cm5 
A ferrite PQ 20116 core is selected, which has a Kg of 22.4 ·1 0 - 3 cm5. From Appendix D, the geometri-
cal parameters for this core are: Ac = 0.62 cm2, WA = 0.256 cm2, and MLT = 4.4 em. 
The air gap is found by evaluation ofEq. (14.53) as follows: 
L !2 
£ = llo : 
M,max 104 
g 
BmaxAc 
= (4n · 10- 7Him)(47J.1H)(5.83 A) 2 104 
(0.25 T) 2(0.62 cm 2) 
=0.52mm 
(14.64) 
In practice, a slightly longer air gap would be necessary, to allow for the effects of fringing flux and other 
nonidealities. The winding 1 turns are found by evaluation of Eq. ( 14.54 ): 
L I 
nl = M M,max 104 
BmaxAc 
= (47 J.!H)(5.83 A) 104 
(0.25 T)(0.62 cm2) 
= 17.6 turns 
The winding 2 turns are chosen according to the desired turns ratio: 
n2 = ( :~) n 1 
= u~) (17.6) 
= 7.54 turns 
(14.65) 
(14.66) 
The numbers of turns are rounded off to n1 = 17 turns, n2 = 7 turns (18:8 would be another possible 
choice). The window area WA is allocated to the windings according to the fractions from Eq. (14.56): 
n 111 
(17)(4A) 
a 1 = -- = 
= 0.8235 
nlltot 
(17)(4.86A) 
CXz = nzl 2 = 
(7)(2 A) 
= 0.1695 
n/101 
(17)(4.86A) 
(14.67) 

14.4 
Examples 
557 
The wire sizes can therefore be chosen as follows: 
a 1 K u WA 
(0.8235)(0.4)(0.256 em2) 
_ 3 
2 
Awl:S:---= 
=4.96·10 
em 
n 1 
(17) 
useAWG#21 
(14.68) 
a 2K.,WA 
(0.1695)(0.4)(0.256em2) 
_ 3 
2 
Aw2:S:---= 
=2.48 ·10 em 
n2 
(7) 
useAWG#24 
14.4.2 
CCM Flyback Transformer 
As a second example, let us design the flyback transformer for the converter illustrated in Fig. 14.13. 
This converter operates with an input voltage of 200 V, and produces an full-load output of 20 V at SA. 
The switching frequency is 150 kHz. Under these operating conditions, it is desired that the converter 
operate in the continuous conduction mode, with a magnetizing current ripple equal to 20% of the de 
component of magnetizing current. The duty cycle is chosen to beD= 0.4, and the turns ratio is n2/n 1 = 
0.15. A copper loss of 1.5 W is allowed, not including proximity effect losses. To allow room for isola-
tion between the primary and secondary windings, a fill factor of Ku = 0.3 is assumed. A maximum flux 
density of Bmax = 0.25 Tis used; this value is less than the worst-case saturation flux density Bsat of the 
ferrite core material. 
By solution of the converter using capacitor charge balance, the de component of the magnetiz-
ing current can be found to be 
Hence, the magnetizing current ripple should be 
and the maximum value of the magnetizing current is 
To obtain this ripple, the magnetizing inductance should be 
V8 DT, 
LM = 2!1iM 
= 1.07 mH 
The rms value of the primary winding current is found using Eq. (A.6) of Appendix A, as follows: 
1 + 1 (!1iM) 2 = 0.796 A 
3 
IM 
(14.69) 
(14.70) 
(14.71) 
(14.72) 
(14.73) 

558 
Inductor Design 
Fig. 
14.13 Flyback 
transformer 
design example: (a) converter sche-
matic, (b) typical waveforms. 
(a) 
(b) 
Transformer model 
c 
+ 
0 L-----------------------
il (t) 
QL----.1-..--------L-+ 
:~:: r---r::s-. 
,~l:;,-..____1 ___.F 
The rms value of the secondary winding current is found in a similar manner: 
i+l("'-iM)z =6.50A 
3 
IM 
+ 
R 
v 
(14.74) 
Note that /2 is not simply equal to the turns ratio multiplied by / 1. The total rms winding current is equal 
to: 
(14.75) 

14.4 Examples 
559 
We can now determine the necessary core size. Evaluation ofEq. (14.52) yields 
(14.76) 
= 0.049 em5 
The smallest EE core listed in Appendix D that satisfies this inequality is the EE30, which has 
Kg= 0.0857 cm5. The dimensions of this core are 
Ac 
1.09 em2 
WA 
0.476 em2 
MLT 6.6em 
em 
5.77 em 
The air gap length egis chosen according to Eq. (14.53): 
=0.44mm 
The number of winding 1 turns is chosen according to Eq. (14.54), as follows: 
_ LMIM,max 104 
nl- BmaxAc 
= ( 1.07 · 10- 3 H)( 1.5 A) 104 
(0.25 T)( 1.09 em2) 
= 58.7 turns 
Since an integral number of turns is required, we round off this value to 
To obtain the desired turns ratio, n2 should be chosen as follows: 
We again round this value off, to 
n 2 = (:~) nl 
= ( 0.15) 59 
= 8.81 
(14.77) 
(14.78) 
(14.79) 
(14.80) 
(14.81) 

560 
Inductor Design 
(14.82) 
The fractions of the window area allocated to windings 1 and 2 are selected in accordance with Eq. 
(14.56): 
[ 1 
(0.796A) 
a 1 =-= 
=0.45 
Ito, 
( 1.77 A) 
n2 [ 2 
(9)(6.5 A) 
<Xz=--= 
=055 
nJw, 
(59)(1.77 A) 
· 
The wire gauges should therefore be 
Aw1 :,; a 1 ~uWA = 1.09 · 10- 3 cm2 
-use #28 AWG 
I 
Aw2 :,; <Xz~~WA = 8.88 · 10- 3 cm2 
-use#l9 AWG 
(14.83) 
(14.84) 
The above American Wire Gauges are selected using the wire gauge table given at the end of Appendix 
D. 
The above design does not account for core loss or copper loss caused by the proximity effect. 
Let us compute the core loss for this design. Figure Fig. 14.14 contains a sketch of the B-H loop for this 
design. The flux density B(t) can be expressed as a de component (determined by the de value of the 
magnetizing current I M ), plus an ac variation of peak amplitude /:;B that is determined by the current rip-
ple b.iM. The maximum value of B(t) is labeled Bmax; this value is determined by the sum of the de com-
ponent and the ac ripple component. The core material saturates when the applied B(t) exceeds B,a1; 
hence, to avoid saturation, Bmax should be less than Bsat' The core loss is determined by the amplitude of 
the ac variations in B(t), i.e., by /:;B. 
The ac component /:;B is determined using Faraday's law, as follows. Solution of Faraday's law 
for the derivative of B(t) leads to 
(14.85) 
As illustrated in Fig. 14.15, the voltage applied during the first subinterval is vM(t) = Vg. This causes the 
Fig. 
14.14 B-H loop for the flyback transformer design 
example. 
B(t) 
Bmax 
B-H loop, 
large excitation 
HJt) 

14.4 Examples 
561 
Fig. 14.15 
Variation of flux density B(t), fiyback transformer 
example. 
0 L------r----------------+ 
,~:r:;,-1'--------~~ 
flux density to increase with slope 
(14.86) 
Over the first subinterval 0 < t < DTs, the flux density B(t) changes by the net amount 2t'lB. This net 
change is equal to the slope given by Eq. (14.86), multiplied by the interval length DTs: 
(14.87) 
Upon solving for t'lB and expressing Ac in cm2 , we obtain 
(14.88) 
For the fly back transformer example, the peak ac flux density is found to be 
(zoov)(o.4)(6.67 f.i.s) 
4 
till= 
10 
2(59)( 1.09 cm2) 
(14.89) 
=0.041 T 
To determine the core loss, we next examine the data provided by the manufacturer for the given 
core material. A typical plot of core loss is illustrated in Fig. 14.16. For the values of M and switching 
frequency of the flyback transformer design, this plot indicates that 0.078 W will be lost in every cm3 of 
the core material. Of course, this value neglects the effects of harmonics on core loss. The total core loss 
P1e will therefore be equal to this loss density, multiplied by the volume of the core: 
Pfe = ( 0.078 W/cm3 )(Ace..) 
=(oms W/cm3 )( 1.09 cm2)(5.77 em) 
=0.49W 
(14.90) 
This core loss is somewhat less than the copper loss of 1.5 W, and neglecting the core loss is often war-
ranted in designs that operate in the continuous conduction mode and that employ ferrite core materials. 

562 
Inductor Design 
Fig. 14.16 
Determination of core loss density for the 
fly back transformer design example. 
0.1 
14.5 
SUMMARY OF KEY POINTS 
0.04-
W/cm3 
0.01 
0.01 
.;; 
0>2. 
""I 
I 
1/ 
I 
I 
I 
1/ 
I I 
I 
f.;:j /$11 
( 
~ l:d:i 
'J /~I 
1/ 
I f& I! 
I I 
~~~ 
I 
l 
I 
I 
I 
,: 
I 
1/ : / 
I 
v I 
0.1 
0.3 
0.041 
!lll, Tesla 
1. 
A variety of magnetic devices are commonly used in switching converters. These devices differ in their 
core flux density variations, as well as in the magnitudes of the ac winding currents. When the flux density 
variations are small, core loss can be neglected. Alternatively, a low-frequency material can be used, hav-
ing higher saturation flux density. 
2. 
The core geometrical constant K8 is a measure of the magnetic size of a core, for applications in which 
copper loss is dominant. In the K8 design method, flux density and total copper loss are specified. Design 
procedures for single-winding filter inductors and for conventional multiple-winding transformers are 
derived. 
REFERENCES 
[1) 
C. W. T. McLYMAN, Transformer and Inductor Design Handbook, Second edition, New York: Marcel 
Dekker, 1988. 
[2) 
S. CUK, "Basics of Switched-Mode Power Conversion: Topologies, Magnetics, and Control," in Advances 
in Switched-Mode Power Conversion, Vol. 2, Irvine: Teslaco, pp. 292-305, 1983. 
[3) 
T. G. WILSON JR., T. G. WILSON, and H. A. OWEN, "Coupling of Magnetic Design Choices to DC-to-DC 
Converter Electrical Performance," IEEE Applied Power Electronics Conference, 1994 Record, pp. 340-
347. 
[4) 
S. CUK and R. D. MIDDLEBROOK, "Coupled-Inductor and Other Extensions of a New Optimum Topology 
Switching DC-to-DC Converter," IEEE Industry Applications Society Annual Meeting, 1977 Proceedings, 
pp. 1110-1122. 

Problems 
563 
[5] 
S. CUK and Z. ZHANG, "Coupled-Inductor Analysis and Design," IEEE Power Electronics Specialists 
Conference, 1986 Record, pp. 655-665. 
[6] 
E. HNATEK, Design of Solid-State Power Supplies, Second edition, New York: Van Nostrand Reinhold, 
1981, Chapter 4. 
PROBLEMS 
14.1 
A simple buck converter operates with a 50 kHz switching frequency and a de input voltage of V8 = 40 V. 
The output voltage is V = 20 V. The load resistance is R ;:>: 4 Q. 
(a) 
Determine the value of the output filter inductance L such that the peak-to-average inductor cur-
rent ripple !:li is 10% of the de component /. 
(b) 
Determine the peak steady-state inductor current /max' 
(c) 
Design an inductor which has the values of Land /max from parts (a) and (b). Use a ferrite EE 
core, with Bmax = 0.25 T. Choose a value of winding resistance such that the inductor copper loss 
is less than or equal to 1 W at room temperature. Assume K. = 0.5. Specify: core size, gap 
length, wire size (AWG), and number of turns. 
14.2 
A boost converter operates at the following quiescent point: V8 = 28 V, V = 48 V, P1oad = 150 W, 
fs = 100 kHz. Design the inductor for this converter. Choose the inductance value such that the peak cur-
rent ripple is 10% of the de inductor current. Use a peak flux density of 0.225 T, and assume a fill factor 
of 0.5. Allow copper loss equal to 0.5% of the load power, at room temperature. Use a ferrite PQ core. 
Specify: core size, air gap length, wire gauge, and number of turns. 
14.3 
Extension of the K8 approach to design of two-winding transformers. It is desired to design a trans-
former having a turns ratio of 1 :n. The transformer stores negligible energy, no air gap is required, and 
the ratio of the winding currents i2(t)/i1 (t) is essentially equal to the turns ratio n. The applied primary 
volt-seconds A.1 are defined for a typical PWM voltage waveform v1(t) in Fig. 13.45(b); these volt-sec-
onds should cause the maximum flux density to be equal to a specified value Bmax = !:ill. You may 
assume that the flux density B(t) contains no de bias, as in Fig. 13.46. You should allocate half of the 
core window area to each winding. The total copper loss P cu is also specified. You may neglect proximity 
losses. 
(a) 
Derive a transformer design procedure, in which the following quantities are specified: total cop-
per loss P cu' maximum flux density Bmax' fill factor K., wire resistivity p, rms primary current / 1, 
applied primary volt-seconds Ap and turns ratio 1:n. Your procedure should yield the following 
data: required core geometrical constant K8 , primary and secondary turns n1 and n2, and primary 
and secondary wire areas Awl andAw2• 
(b) 
The voltage waveform applied to the transformer primary winding of the Cuk converter [Fig. 
6.41(c)] is equal to the converter input voltage V8 while the transistor conducts, and is equal to 
- vpt(1- D) while the diode conducts. This converter operates with a switching frequency of 
100kHz, and a transistor duty cycleD equal to 0.4. The de input voltage is V8 = 120 V, the de 
output voltage is V = 24 V, and the load power is 200 W. You may assume a fill factor of K. = 0.3. 
Use your procedure of part (a) to design a transformer for this application, in which 
B,= = 0.15 T, and Pcu = 0.25 W at lOOOC. Use a ferrite PQ core. Specify: core size, primary and 
secondary turns, and wire gauges. 
14.4 
Coupled inductor design. The two-output forward converter of Fig. 13.47(a) employs secondary-side 
coupled inductors. An air gap is employed. 
Design a coupled inductor for the following application: V1 = 5 V, V2 = 15 V, / 1 = 20 A, 12 = 4 A, 
D = 0.4. The magnetizing inductance should be equal to 8 /LH, referred to the 5 V winding. You may 
assume a fill factor K. of 0.5. Allow a total of 1 W of copper loss at 100°C, and use a peak flux density of 

564 
Inductor Design 
Bmax = 0.2 T. Use a ferrite EE core. Specify: core size, air gap length, number of turns and wire gauge for 
each winding. 
14.5 
Flyback transformer design. A flyback converter operates with a 160 Vdc input, and produces a 28 Vdc 
output. The maximum load current is 2 A. The transfomer turns ratio is 8:1. The switching frequency is 
100 kHz. The converter should be designed to operate in the discontinuous conduction mode at all load 
currents. The total copper loss should be less than 0.75 W. 
(a) 
Choose the value of transformer magnetizing inductance LM such that, at maximum load current, 
D3 = 0.1 (the duty cycle of subinterval 3, in which all semiconductors are off). Please indicate 
whether your value of LM is referred to the primary or secondary winding. What is the peak tran-
sistor current? The peak diode current? 
(b) 
Design a flyback transformer for this application. Use a ferrite pot core with Bmax = 0.25 Tesla, 
and with fill factor Ku = 0.4. Specify: core size, primary and secondary turns and wire sizes, and 
air gap length. 
(c) 
For your design of part (b), compute the copper losses in the primary and secondary windings. 
You may neglect proximity loss. 
(d) 
For your design of part (b), compute the core loss. Loss data for the core material is given by 
Fig. 13.20. Is the core loss less than the copper loss computed in Part (c)? 

15 
Transformer Design 
In the design methods of the previous chapter, copper loss Pcu and maximum flux density Bmax are speci-
fied, while core loss Pfe is not specifically addressed. This approach is appropriate for a number of appli-
cations, such as the filter inductor in which the dominant design constraints are copper loss and 
saturation flux density. However, in a substantial class of applications, the operating flux density is lim-
ited by core loss rather than saturation. For example, in a conventional high-frequency transformer, it is 
usually necessary to limit the core loss by operating at a reduced value of the peak ac flux density M. 
This chapter covers the general transformer design problem. It is desired to design a k-winding 
transformer as illustrated in Fig. 15.1. Both copper loss Pcu and core loss Pfe are modeled. As the operat-
ing flux density is increased (by decreasing the number of turns), the copper loss is decreased but the 
core loss is increased. We will determine the operating flux density that minimizes the total power loss 
ptot = pfe + pcu· 
It is possible to generalize the core geometrical constant Kg design method, derived in the previ-
ous chapter, to treat the design of magnetic devices when both copper loss and core loss are significant. 
This leads to the geometrical constant Kgfe' a measure of the effective magnetic size of core in a trans-
former design application. Several examples of transformer designs via the Kgfe method are given in this 
chapter. A similar procedure is also derived, for design of single-winding inductors in which core loss is 
significant. 
15.1 
TRANSFORMER DESIGN: BASIC CONSTRAINTS 
As in the case of the filter inductor design, we can write several basic constraining equations. These 
equations can then be combined into a single equation for selection of the core size. In the case of trans-
former design, the basic constraints describe the core loss, flux density, copper loss, and total power loss 

566 
Transformer Design 
nl 
n2 
il (t) 
+ 
i2(t) 
v1(t) 
Rl 
R2 
+ 
ik(t) 
vk(t) 
: nk 
Rk 
Fig. 15.1 
A k-winding transformer, in which both core loss and copper loss are significant. 
vs. flux density. The flux density is then chosen to optimize the total power loss. 
15.1.1 
Core Loss 
As described in Chapter 13, the total core loss P1e depends on the peak ac flux density till, the operating 
frequency f, and the volume of the core. At a given frequency, we can approximate the core loss by a 
function of the form 
(15.1) 
Again, Ac is the core cross-sectional area, em is the core mean magnetic path length, and hence A cern is the 
volume of the core. K1e is a constant of proportionality which depends on the operating frequency. The 
exponent 13 is determined from the core manufacturer's published data. Typically, the value of 13 for fer-
rite power materials is approximately 2.6; for other core materials, this exponent lies in the range 2 to 3. 
Equation (15.1) generally assumes that the applied waveforms are sinusoidal; effects of waveform har-
monic content are ignored here. 
15.1.2 
Flux Density 
An arbitrary periodic primary voltage waveform v1(t) is illustrated in Fig. 15.2. The volt-seconds applied 
during the positive portion of the waveform is denoted A.1: 
(15.2) 
These volt-seconds, or flux-linkages, cause the flux density to change from its negative peak to its posi-
tive peak value. Hence, from Faraday's law, the peak value of the ac component of the flux density is 

15.1 Transformer Design: Basic Constraints 
567 
Fig. 15.2 
An arbitrary transformer primary voltage waveforms, illustrating the volt-seconds applied during the 
positive portion of the cycle. 
(15.3) 
Note that, for a given applied voltage waveform and A.1, we can reduce !:ill by increasing the primary 
turns n1• This has the effect of decreasing the core loss according to Eq. (15.1). However, it also causes 
the copper loss to increase, since the new windings will be comprised of more turns of smaller wire. As a 
result, there is an optimal choice for !:ill, in which the total loss is minimized. In the next sections, we 
will determine the optimal !:ill. Having done so, we can then use Eq. (15.3) to determine the primary 
turns nl' as follows: 
A. 
n ---'-
'- 2f'illAc 
(15.4) 
It should also be noted that, in some converter topologies such as the forward converter with conven-
tional reset winding, the flux density B(t) and the magnetizing current iM(t) are not allowed to be nega-
tive. In consequence, the instantaneous flux density B(t) contains a de bias. Provided that the core does 
not approach saturation, this de bias does not significantly affect the core loss: core loss is determined by 
the ac component of B(t). Equations (15.2) to (15.4) continue to apply to this case, since !:ill is the peak 
value of the ac component of B(t). 
15.1.3 
Copper Loss 
As shown in Section 14.3.1, the total copper loss is minimized when the core window area WA is allo-
cated to the various windings according to their relative apparent powers. The total copper loss is then 
given by Eq. (14.34). This equation can be expressed in the form 
(15.5) 
where 

568 
Transformer Design 
(15.6) 
is the sum of the rms winding currents, referred to winding 1. Use ofEq. (15.4) to eliminate n1 from Eq. 
(15.5) leads to 
(15.7) 
The right-hand side of Eq. (15.7) is grouped into three terms. The first group contains specifications, 
while the second group is a function of the core geometry. The last term is a function of till, to be chosen 
to optimize the design. It can be seen that copper loss varies as the inverse square of till; increasing till 
reduces Pcu· 
The increased copper loss due to the proximity effect is not explicitly accounted for in this 
design procedure. In practice, the proximity loss must be estimated after the core and winding geome-
tries are known. However, the increased ac resistance due to proximity loss can be accounted for in the 
design procedure. The effective value of the wire resistivity p is increased by a factor equal to the esti-
mated ratio R0JRdc· When the core geometry is known, the engineer can attempt to implement the wind-
ings such that the estimated R0JRdc is obtained. Several design iterations may be needed. 
15.1.4 
Total power loss vs. till 
The total power loss P101 is found by adding Eqs. (15.1) and (15.7): 
The dependence of Pfe' Pcu' and P101 on till is sketched in Fig. 15.3. 
Power 
loss 
Optimum till 
Fig. 15.3 
Dependence of copper loss, core loss, and total loss on peak ac flux density. 
(15.8) 

15.1 
Transformer Design: Basic Constraints 
569 
15.1.5 
Optimum Flux Density 
Let us now choose the value of till that minimizes Eq. (15.8). At the optimum till, we can write 
(15.9) 
Note that the optimum does not necessarily occur where Pfe = Pcu· Rather, it occurs where 
(15.10) 
The derivatives of the core and copper losses with respect to till are given by 
(15.11) 
(15.12) 
Substitution of Eqs. (15.11) and (15.12) into Eq. (15.10), and solution for till, leads to the optimum flux 
density 
(15.13) 
The resulting total power loss is found by substitution ofEq. (15.13) into (15.1), (15.8), and (15.9). Sim-
plification of the resulting expression leads to 
p =[A e K j(~~ 2 ) rp/..fiiot (MLT)j(~~ 2 ) [(J!.)-(wh) 
(J!.)(~~2)) 
tot 
c m 
fe 
4K 
W A 2 
2 
+ 2 
u 
A 
c 
(15.14) 
This expression can be regrouped, as follows: 
( 15.15) 
The terms on the left side of Eq. (15.15) depend on the core geometry, while the terms on the right side 
depend on specifications regarding the application (p, !tot' A." Ku, Ptat) and the desired core material 
(Kfe' ~).The left side of Eq. (15.15) can be defined as the core geometrical constant Kgfe: 

570 
Transformer Design 
(15.16) 
Hence, to design a transformer, the right side of Eq. (15.15) is evaluated. A core is selected whose Kgfe 
exceeds this value: 
(15.17) 
The quantity Kgfe is similar to the geometrical constant Kg used in the previous chapter to design magnet-
ics when core loss is negligible. Kgfe is a measure of the magnetic size of a core, for applications in which 
core loss is significant. Unfortunately, Kgfe depends on p, and hence the choice of core material affects 
the value of Kgte· However, the P of most high-frequency ferrite materials lies in the narrow range 2.6 to 
2.8, and Kgfe varies by no more than ± 5% over this range. Appendix D lists the values of Kgfe for various 
standard ferrite cores, for the value P = 2.7. 
Once a core has been selected, then the values of Ac, WA, em, and MLT are known. The peak ac 
flux density till can then be evaluated using Eq. (15.13), and the primary turns n1 can be found using Eq. 
(15.4). The number of turns for the remaining windings can be computed using the desired turns ratios. 
The various window area allocations are found using Eq. (14.35). The wire sizes for the various windings 
can then be computed as discussed in the previous chapter, 
(15.18) 
where Aw,j is the wire area for winding j. 
15.2 
A STEP-BY-STEP TRANSFORMER DESIGN PROCEDURE 
The procedure developed in the previous sections is summarized below. As in the filter inductor design 
procedure of the previous chapter, this simple transformer design procedure should be regarded as a first-
pass approach. Numerous issues have been neglected, including detailed insulation requirements, con-
ductor eddy current losses, temperature rise, roundoff of number of turns, etc. 
The following quantities are specified, using the units noted: 
Wire effective resistivity 
Total rms winding currents, referred to primary 
Desired turns ratios 
Applied primary volt-seconds 
p 
A. 1 = J v1(t)dt 
positive 
portion 
of cycle 
(Q-cm) 
(A) 
(V-sec) 

Allowed total power dissipation 
Winding fill factor 
Core loss exponent 
Core loss coefficient 
15.2 
A Step-By-Step Transformer Design Procedure 
571 
(W) 
The core dimensions are expressed in em: 
Core cross-sectional area 
Core window area 
Mean length per turn 
Magnetic path length 
Peak ac flux density 
Wire areas 
11B 
(cm2) 
(cm2) 
(em) 
(em) 
(Tesla) 
(cm2) 
The use of centimeters rather than meters requires that appropriate factors be added to the design equa-
tions. 
15.2.1 
Procedure 
1. 
Detennine core size. 
(15.19) 
Choose a core that is large enough to satisfy this inequality. If necessary, it may be possible to use a 
smaller core by choosing a core material having lower loss, i.e., smaller Kfe· 
2. 
Evaluate peak ac flux density. 
(15.20) 
Check whether till is greater than the core material saturation flux density. If the core operates with a flux 
de bias, then the de bias plus till should not exceed the saturation flux density. Proceed to the next step if 
adequate margins exist to prevent saturation. Otherwise, (1) repeat the procedure using a core material 
having greater core loss, or (2) use the K8 design method, in which the maximum flux density is speci-
fied. 
3. 
Evaluate primary turns. 
n __ 
A_!_ 104 
1 - 2MAc 
(15.21) 

572 
Transformer Design 
4. 
Choose numbers of turns for other windings 
According to the desired turns ratios: 
n 2 = n1 ( ~~) 
n3 = n1 ( ~:) 
5. 
Evaluate fraction of window area allocated to each winding. 
6. 
Evaluate wire sizes. 
Choose wire gauges to satisfy these criteria 
(15.22) 
(15.23) 
(15.24) 
A winding geometry can now be determined, and copper losses due to the proximity effect can 
be evaluated. If these losses are significant, it may be desirable to further optimize the design by reiterat-
ing the above steps, accounting for proximity losses by increasing the effective wire resistivity to the 
value Pelf= PcuPcJPdc• where Pcu is the actual copper loss including proximity effects, and Pdc is the 
copper loss obtained when the proximity effect is negligible. 
If desired, the power losses and transformer model parameters can now be checked. For the 
simple model of Fig. 15.4, the following parameters are estimated: 
Magnetizing inductance, referred to winding 1: 
Peak ac magnetizing current, referred to winding 1: 

15.3 
Examples 
573 
Fig. 15.4 
Computed elements of simple transformer model. 
Winding resistances: 
The core loss, copper loss, and total power loss can be determined using Eqs. (15.1), (15.7), and (15.8), 
respectively. 
15.3 
EXAMPLES 
15.3.1 
Example 1: Single-Output Isolated Cuk Converter 
As an example, let us consider the design of a simple two-winding transformer for the Cuk converter of 
Fig. 15.5. This transformer is to be optimized at the operating point shown, corresponding to D = 0.5. 
The steady-state converter solution is Vel = V8 , Vc2 = V. The desired transformer turns ratio is 
- vcit) + 
n: I 
Fig. 15.5 
Isolated Cuk converter example. 
I 
20A 
+ 
v 
5V 

574 
Transformer Design 
Vc, 
_....Area 1..1 
.,/ 
-D'T, 
--vr. -
-nVa 
Fig. 
15.6 Waveforms, Cuk converter 
i1(t) 
/In 
transformer design example. 
-lg 
i2(1) 
I 
n = n/n2 = 5. The switching frequency is f. = 200 kHz, corresponding to Ts = 5 /lS. A ferrite pot core 
consisting of Magnetics, Inc. P-material is to be used; at 200 kHz, this material is described by the fol-
lowing parameters: Kfe = 24.7 Wff~cm3 , ~ = 2.6. A fill factor of Ku = 0.5 is assumed. Total power loss of 
P101 = 0.25 W is allowed. Copper wire, having a resistivity of p = 1.724 · 10-6 Q--cm, is to be used. 
Transformer waveforms are illustrated in Fig. 15.6. The applied primary volt-seconds are 
The primary rms current is 
A I = DT, vel = (0.5)(5 J.lSec) (25 V) 
= 62.5 V-J.lsec 
(15.25) 
(15.26) 
It is assumed that the rms magnetizing current is much smaller than the rms winding currents. Since the 
transformer contains only two windings, the secondary rms current is equal to 
(15.27) 
The total rms winding current, referred to the primary, is 
(15.28) 
The core size is evaluated using Eq. (15.19): 
K 
> (1.724·10- 6)(62.5-10- 6) 2(8) 2(24.7)(2126) 10s 
gfe -
4 (0.5)(0.25)(4 612 6) 
(15.29) 
= 0.00295 

15.3 Examples 
575 
The pot core data of Appendix D lists the 2213 pot core with Kgf'e = 0.0049 for~= 2.7. Evaluation ofEq. 
(15.16) shows that Kgfe = 0.0047 for this core, when ~ = 2.6. In any event, 2213 is the smallest standard 
pot core size having Kgfe::; 0.00295. The increased value of Kgfe should lead to lower total power loss. 
The peak ac flux density is found by evaluation of Eq. (15.20), using the geometrical data for the 2213 
pot core: 
(114.6) 
M3 = 108 (1.724·10- 6)(62.5·10- 6)\8) 2 
(4.42) 
1 
2 (0.5) 
(0.297)(0.635)\3.15) (2.6)(24.7) 
(15.30) 
= 0.0858 Tesla 
This flux density is considerably less than the saturation flux density of approximately 0.35 Testa. The 
primary turns are determined by evaluation of Eq. (15.21): 
4 
(62.5·10- 6 ) 
n 1 = 10 2(0.0858)(0.635) 
= 5.74 turns 
(15.31) 
The secondary turns are found by evaluation of Eq. (15.22). It is desired that the transformer have a 5:1 
turns ratio, and hence 
ni 
n2 = n = 1.15 turns 
(15.32) 
In practice, we might select n1 = 5 and n2 = 1. This would lead to a slightly higher M and slightly higher 
loss. 
The fraction of the window area allocated to windings 1 and 2 are determined using Eq. (15.23): 
(15.33) 
For this example, the window area is divided equally between the primary and secondary windings, since 
the ratio of their rms currents is equal to the turns ratio. We can now evaluate the primary and secondary 
wire areas, via Eq. (15.24): 
(0.5)(0.5)(0.297) 
-3 
2 
Awl= 
(5) 
= 14.8·10 
em 
(15.34) 
_ (0.5)(0.5)(0.297) _ 
2. 0_ 3 
2 
Aw2 -
(1) 
-74. 1 
em 
The wire gauge is selected using the wire table of Appendix D. AWG #16 has area 13.07 ·10-3 cm2, and 
is suitable for the primary winding. AWG #9 is suitable for the secondary winding, with area 
66.3 ·10-3 cm2. These are very large conductors, and one turn of AWG #9 is not a practical solution! We 
can also expect significant proximity losses, and significant leakage inductance. In practice, interleaved 
foil windings might be used. Alternatively, Litz wire or several parallel strands of smaller wire could be 
employed. 

576 
Transformer Design 
4226 
. 
/·~ 
0.1 
~ 
261~· 
0.08 
_g; 
·~ 
2616 
..., 
~ 
2213 
• 
0.06 ol 
8 
"' 
~ 
~ 
0.04 
0.02 
0 
25kHz 
50 kHz 
100kHz 
200kHz 
250kHz 
400kHz 
500kHz 
1000kHz 
Switching frequency 
Fig. 15.7 Variation of transformer size (bar chart) with switching frequency, Cuk converter example. Optimum 
peak ac flux density (data points) is also plotted. 
It is a worthwhile exercise to repeat the above design at several different switching frequencies, 
to determine how transformer size varies with switching frequency. As the switching frequency is 
increased, the core loss coefficient Kfe increases. Figure 15.7 illustrates th~ transformer pot core size, for 
various switching frequencies over the range 25 kHz to 1 MHz, for this Cuk converter example using P 
material with P101 < 0.25 W. Peak flux densities in Tesla are also plotted. For switching frequencies below 
250 kHz, increasing the frequency causes the core size to decrease. This occurs because of the decreased 
applied volt-seconds AT Over this range, the optimal M3 is essentially independent of switching fre-
quency; the M3 variations shown occur owing to quantization of core sizes. 
For switching frequencies greater than 250 kHz, increasing frequency causes greatly increased 
core loss. Maintaining P101 ~ 0.25 W then requires that M3 be reduced, and hence the core size is 
increased. The minimum transformer size for this example is apparently obtained at 250kHz. 
In practice, several matters complicate the dependence of transformer size on switching fre-
quency. Figure 15.7 ignores the winding geometry and copper losses due to winding eddy currents. 
Greater power losses can be allowed in larger cores. Use of a different core material may allow higher or 
lower switching frequencies. The same core material, used in a different application with different speci-
fications, may lead to a different optimal frequency. Nonetheless, examples have been reported in the lit-
erature [1-4] in which ferrite transformer size is minimized at frequencies ranging from several hundred 
kilohertz to several megahertz. More detailed design optimizations can be performed using computer 
optimization programs [5, 6]. 
15.3.2 Example 2: Multiple-Output Full-Bridge Buck Converter 
As a second example, let us consider the design of transformer T1 for the multiple-output full-bridge 
buck converter of Fig. 15.8. This converter has a 5 V and a 15 V output, with maximum loads as shown. 
The transformer is to be optimized at the full-load operating point shown, corresponding to D = 0.75. 
Waveforms are illustrated in Fig. 15.9. The converter switching frequency is!,= 150kHz. In the full-
bridge configuration, the transformer waveforms have fundamental frequency equal to one-half of the 
switching frequency, so the effective transformer frequency is 75 kHz. Upon accounting for losses 

Q, 
-I 
vg 
+ 
160V 
-I 
Q, 
Fig. 15.8 Multiple-output full-bridge isolated buck converter example. 
Fig. 
15.9 Transformer waveforms, 
full-bridge converter example. 
i2a(t) 
i3a(t) 
0 
lsv 
/1 5V 
Area A.1 
= V DT 
g 
.. 
~ 
~v 
DTS 
T, 
15.3 Examples 
577 
-V 
g 
0 
0 
+ 
5V 
+ 
!5V 
r==F. 
r==C. 
caused by diode forward voltage drops, one finds that the desired transformer turns ratios n1 :n2:n3 are 
110:5: 15. A ferrite EE consisting of Magnetics, Inc. P-material is to be used in this example; at 75 kHz, 
this material is described by the following parameters: Kfe = 7.6 Wtrf3cm3, ~ = 2.6. A fill factor of 
K11 = 0.25 is assumed in this isolated multiple-output application. Total power loss of P101 = 4 W, or 
approximately 0.5% of the load power, is allowed. Copper wire, having a resistivity of 
p = 1.724 · 10-{i Q-cm, is to be used. 
The applied primary volt-seconds are 

578 
Transformer Design 
A1 = DT,V8 = (0.75)(6.67 J.tsec )(160 V) = 800 V-J.tsec 
(15.35) 
The primary rms current is 
(15.36) 
The 5 V secondary windings carry nns current 
I 2 = ~ I sv .,! 1 + D = 66.1 A 
(15.37) 
The 15 V secondary windings carry rms current 
(15.38) 
The total rms winding current, referred to the primary, is 
windings 
(15.39) 
= 14.4 A 
The core size is evaluated using Eq. (15.19): 
K 
> (1.724·10- 6)(800·10- 6)2(14.4) 2(7.6)(212·6) 108 
gfe-
4(0.25)(4){46/26) 
(15.40) 
=0.00937 
The EE core data of Appendix D lists the EE40 core with Kgfe = 0.0118 for f3 = 2.7. Evaluation of Eq. 
(15.16) shows that Kgfe = 0.0108 for this core, when f3 = 2.6. In any event, EE40 is the smallest standard 
EE core size having Kgfe ~ 0.00937. The peak ac flux density is found by evaluation of Eq. (15.20), using 
the geometrical data for the EE40 core: 
(114.6) 
till= 108 (1.724·10- 6)(800·10- 6)2(14.4) 2 
(8.5) 
1 
2(0.25) 
(1.1)(1.27)\7.7) (2.6)(7.6) 
(15.41) 
= 0.23 Tesla 
This flux density is less than the saturation flux density of approximately 0.35 Tesla. The primary turns 
are determined by evaluation of Eq. (15.21): 
4 (800·10- 6) 
111 = 10 2(0.23)(1.27) 
= 13.7 turns 
(15.42) 
The secondary turns are found by evaluation of Eq. (15.22). It is desired that the transformer have a 
110:5: 15 turns ratio, and hence 

15.3 
Examples 
579 
5 
(15.43) 
n2 = TIO n 1 = 0.62 turns 
15 
(15.44) 
n3 = TIO n 1 = 1.87 turns 
In practice, we might select n1 == 22, n2 == 1, and n3 == 3. This would lead to a reduced till with reduced 
core loss and increased copper loss. Since the resulting till is suboptimal, the total power loss will be 
increased. According to Eq. (15.3), the peak ac flux density for the EE40 core will be 
(800·10- 6 ) 
4 
M = 2(22)(1.27) 10 = 0.143 Tesla 
(15.45) 
The resulting core and copper loss can be computed using Eqs. (15.1) and (15.7): 
Pfe = (7.6)(0.143) 26(1.27)(7.7) = 0.47 W 
(15.46) 
p = (1.724·10- 6)(800·10- 6 ) 2(14.4) 2 
(8.5) 
~1~ 
108 
cu 
4 (0.25) 
(1.1)(1.27) 2 (0.143) 2 
(15.47) 
=5.4 w 
Hence, the total power loss would be 
(15.48) 
Since this is 50% greater than the design goal of 4 W, it is necessary to increase the core size. The next 
larger EE core is the EE50 core, having Kgfe of 0.0284. The optimum ac flux density for this core, given 
by Eq. (15.3), is till= 0.14 T; operation at this flux density would require n1 = 12 and would lead to a 
total power loss of 2.3 W. With n1 = 22, calculations similar to Eqs. (15.45) to (15.48) lead to a peak flux 
density of till = 0.08 T. The resulting power losses would then be Pre = 0.23 W, Pcu = 3.89 W, 
plot= 4.12 W. 
With the EE50 core and n1 = 22, the fraction of the available window area allocated to the pri-
mary winding is given by Eq. (15.23) as 
a - -~- _u__ - 0 396 
1- /tot- 14.4- . 
(15.49) 
The fraction of the available window area allocated to each half of the 5 V secondary winding should be 
a= nzlz =-5_66.1 =0209 
2 
n1/ 101 
110 14.4 
· 
(15.50) 
The fraction of the available window area allocated to each half of the 15 V secondary winding should be 
(15.51) 
The primary wire area Awl' 5 V secondary wire areaAw2, and 15 V secondary wire areaAw3 are then given 

580 
Transformer Design 
by Eq. (15.24) as 
(0.396)(0.25)( 1.78) 
(22) 
=}AWG#19 
<XzKu WA 
(0.209)(0.25)(1.78) 
Awz = ~n-z~ 
(1) 
=}AWG#8 
a 3 K u W A 
(0.094)(0.25)( 1.78) 
Aw3=~n-3~ 
(3) 
=}AWG#16 
(15.52) 
It may be preferable to wind the 15 V outputs using two #19 wires in parallel; this would lead to the same 
area Aw3 but would be easier to wind. The 5 V windings could be wound using many turns of smaller par-
alleled wires, but it would probably be easier to use a flat copper foil winding. If insulation requirements 
allow, proximity losses could be minimized by interleaving several thin layers of foil with the primary 
winding. 
15.4 
AC INDUCTOR DESIGN 
The transformer design procedure of the previous sections can be adapted to handle the design of other 
magnetic devices in which both core loss and copper loss are significant. A procedure is outlined here for 
design of single-winding inductors whose waveforms contain significant high-frequency ac components 
(Fig. 15.10). An optimal value of till is found, which leads to minimum total core-plus-copper loss. The 
major difference is that we must design to obtain a given inductance, using a core with an air gap. The 
constraints and a step-by-step procedure are briefly outlined below. 
15.4.1 
Outline of Derivation 
As in the filter inductor design procedure of the previous chapter, the desired inductance L must be 
obtained, given by 
(15.53) 
The applied voltage waveform and the peak ac component of the flux density till are related according to 
(15.54) 
The copper loss is given by 
p = pn 2(MLT) 12 
cu 
K W 
u 
A 
(15.55) 
where I is the rms value of i(t). The core loss Pfe is given by Eq. (15.1). 

15.4 AC Inductor Design 
581 
(a) 
(b) 
Window area WA 
Core mean length 
i(l) 
+ 
per tum (MLT) 
Core area 
Ac 
v(t) 
L 
II 
turns 
Air gap 
eg 
Wire resistivity p 
Fill factor K,. 
(c) 
v(t) 
i(t) 
Fig. 15.10 Ac inductor, in which copper loss and core loss are significant: (a) definition of terminal quantities, 
(b) core geometry, (c) arbitrary terminal waveforms. 
The value of !:ill that minimizes the total power loss P10 1 = Pcu + P1e is found in a manner similar 
to the transformer design derivation. Equation (15.54) is used to eliminate n from the expression for Pcu· 
The optimal !:ill is then computed by setting the derivative of P101 to zero. The result is 
- [p),}J2 
(MLT) _1_ 1(Jlh) 
M-
2K 
W A3e 
RK 
u 
Ac mt.J
fe 
(15.56) 
which is essentially the same as Eq. (15.13). The total power loss P101 is evaluated at this value of !:ill, and 
the resulting expression is manipulated to find K gJe· The result is 
(15.57) 
where K gfe is defined as in Eq. (15.16). A core that satisfies this inequality is selected. 

582 
Transformer Design 
15.4.2 
Step-by-step AC Inductor Design Procedure 
The units of Section 15.2 are employed here. 
1. 
Determine core size. 
(15.58) 
Choose a core that is large enough to satisfy this inequality. If necessary, it may be possible to use a 
smaller core by choosing a core material having lower loss, that is, smaller Kte· 
2. 
Evaluate peak ac flux density. 
(15.59) 
3. 
Numberofturns. 
(15.60) 
4. 
Air gap length. 
" A n2 
e = _r_O_c_ lQ-4 
g 
L 
(15.61) 
with Ac specified in cm2 and eg expressed in meters. Alternatively, the air gap can be indirectly expressed 
viaAL (mH/1000 turns): 
(15.62) 
5. 
Check for saturation. 
If the inductor current contains a de component Ide• then the maximum total flux density Bmax is greater 
than the peak ac flux density till. The maximum total flux density, in Tesla, is given by 
Lldc 
4 
B,.ax=I'>B+-A 10 
n c 
(15.63) 
If Bmax is close to or greater than the saturation flux density Bsat' then the core may saturate. The filter 
inductor design procedure of the previous chapter should then be used, to operate at a lower flux density. 
6. 
Evaluate wire size. 
(15.64) 

15.5 Summary 
583 
A winding geometry can now be determined, and copper losses due to the proximity effect can be evalu-
ated. If these losses are significant, it may be desirable to further optimize the design by reiterating the 
above steps, accounting for proximity losses by increasing the effective wire resistivity to the value 
Peff= PcuPcJPdc' where Pcu is the actual copper loss including proximity effects, and Pdc is the copper 
loss predicted when the proximity effect is ignored. 
7. 
Check power loss. 
15.5 
1. 
2. 
3. 
SUMMARY 
p = pn(MLT) I 2 
cu 
Aw 
pfe = Kfe(MJ)P Acem 
ptot = pcu + pfe 
(15.65) 
In a multiple-winding transformer, the low-frequency copper losses are minimized when the available 
window area is allocated to the windings according to their apparent powers, or ampere-turns. 
As peak ac flux density is increased, core loss increases while copper losses decrease. There is an optimum 
flux density that leads to minimum total power loss. Provided that the core material is operated near its 
intended frequency, then the optimum flux density is less than the saturation flux density. Minimization of 
total loss then determines the choice of peak ac flux density. 
The core geometrical constant Kgfe is a measure of the magnetic size of a core, for applications in which 
core loss is significant. In the Kgfe design method, the peak flux density is optimized to yield minimum 
total loss, as opposed to the Kg design method where peak flux density is a given specification. 
REFERENCES 
[1] 
W. J. Gu and R. Lru, "A Study of Volume and Weight vs. Frequency for High-Frequency Transformers," 
IEEE Power Electronics Specialists Conference, 1993 Record, pp. 1123-1129. 
[2] 
K. D. T. NGO, R. P. ALLEY, A. J. YERMAN, R. J. CHARLES, and M. H. KUO, "Evaluation ofTrade-Offs in 
Transformer Design for Very-Low-Voltage Power Supply with Very High Efficiency and Power Density," 
IEEE Applied Power Electronics Conference, 1990 Record, pp. 344-353. 
[3] 
A. F. GOLDBERG and M. F. SCHLECHT, "The Relationship Between Size and Power Dissipation in a 1-
10MHz Transformer," IEEE Power Electronics Specialists Conference, 1989 Record, pp. 625-634. 
[4] 
K. D. T. NGO and R. S. LA!, "Effect of Height on Power Density in High-Frequency Transformers," IEEE 
Power Electronics Specialists Conference, 1991 Record, pp. 667-672. 
[5] 
R. B. RIDLEY and F. C. LEE, "Practical Nonlinear Design Optimization Tool for Power Converter Compo-
nents," IEEE Power Electronics Specialists Conference, 1987 Record, pp. 314-323. 
[6] 
R. C. WONG, H. A. OWEN, and T. G. WILSON, "Parametric Study of Minimum Converter Loss in an 
Energy-Storage De-to-De Converter," IEEE Power Electronics Specialists Conference, 1982 Record, pp. 
411-425. 

584 
Transformer Design 
PROBLEMS 
15.1 
Forward converter inductor and transformer design. The objective of this problem set is to design the 
magnetics (two inductors and one transformer) of the two-transistor, two-output forward converter 
shown in Fig. 15.11. The ferrite core material to be used for all three devices has a saturation flux density 
of approximately 0.3 Tat 120T. To provide a safety margin for your designs, you should use a maxi-
mum flux density Bmax that is no greater than 75% of this value. The core loss at 100kHz is described by 
Eq. (15.1), with the parameter values~= 2.6 and Kfe =50 WIT~ cm3. Calculate copper loss at lOOT. 
Steady-state converter analysis and design. You may assume 100% efficiency and ideallossless compo-
nents for this section. 
(a) 
Select the transformer turns ratios so that the desired output voltages are obtained when the duty 
cycle is D = 0.4. 
(b) 
Specify values of LI and L2 such that their current ripples !1ii and !1i2 are 10% of their respective 
full-load current de components II and I2. 
(c) 
Determine the peak and rms currents in each inductor and transformer winding. 
Inductor design. Allow copper loss of 1 W in LI and 0.4 Win L2. Assume a fill factor of Ku = 0.5. Use 
ferrite EE cores-tables of geometrical data for standard EE core sizes are given in Appendix D. Design 
the output filter inductors LI and L 2. For each inductor, specify: 
(i) 
EE core size 
(ii) 
Air gap length 
(iii) Number of turns 
(iv) 
AWG wire size 
Transformer design. Allow a total power loss of 1 W. Assume a fill factor of Ku = 0.35 (lower than for the 
filter inductors, to allow space for insulation between the windings). Use a ferrite EE core. You may 
neglect losses due to the skin and proximity effects, but you should include core and copper losses. 
Design the transformer, and specify the following: 
(i) 
EE core size 
(ii) 
Turns nl' n2, and n3 
fs= 100kHz 
vg 
+ 
n2 
325 v 
turns 
Fig. 15.11 
Two-output forward converter of Problem 15.1. 
+ 
VI 
+ 
5V 
30A 
15 v 
lA 

(iii) AWG wire size for the three windings 
Check your transformer design: 
(iv) 
Compute the maximum flux density. Will the core saturate? 
Problems 
585 
(v) 
Compute the core loss, the copper loss of each winding, and the total power loss 
15.2 
A single-transistor forward converter operates with an input voltage Vg = 160 V, and supplies two out-
puts: 24 Vat 2 A, and 15 Vat 6 A. The duty cycle is D = 0.4. The turns ratio between the primary wind-
ing and the reset winding is 1:1. The switching frequency is 100 kHz. The core material loss equation 
parameters are ~ = 2.7, Kfe =50. You may assume a fill factor of 0.25. Do not allow the core maximum 
flux density to exceed 0.3 T. 
Design a transformer for this application, having a total power loss no greater than 1.5 W at 
100°C. Neglect proximity losses. You may neglect the reset winding. Use a ferrite PQ core. Specify: core 
size, peak ac flux density, wire sizes, and number of turns for each winding. Compute the core and cop-
per losses for your design. 
15.3 
Flyback/SEPIC transformer design. The "transformer" of the fly back and SEPIC converters is an energy 
storage device, which might be more accurately described as a multiple-winding inductor. The magne-
tizing inductance LP functions as an energy-transferring inductor of the converter, and therefore the 
"transformer" normally contains an air gap. The converter may be designed to operate in either the con-
tinuous or discontinuous conduction mode. Core loss may be significant. It is also important to ensure 
that the peak current in the magnetizing inductance does not cause saturation. 
A fly back transformer is to be designed for the following two-output flyback converter application: 
Input: 
160 Vdc 
Output 1: 
5 Vdc at 10 A 
Output 2: 
15 Vdc at 1 A 
Switching frequency: 
100kHz 
Magnetizing inductance LP: 
1.33 mH, referred to primary 
Turns ratio: 
160:5:15 
Transformer power loss: 
Allow 1 W total 
(a) 
Does the converter operate in CCM or DCM? Referred to the primary winding, how large are (i) 
the magnetizing current ripple !!.i, (ii) the magnetizing current de component I, and (iii) the peak 
magnetizing current Ipk? 
(b) 
Determine (i) the rms winding currents, and (ii) the applied primary volt-seconds A1. Is A1 pro-
portional to Ipk? 
(c) 
Modify the transformer and ac inductor design procedures of this chapter, to derive a general 
procedure for designing flyback transformers that explicitly accounts for both core and copper 
loss, and that employs the optimum ac flux density that minimizes the total loss. 
(d) 
Give a general step-by-step design procedure, with all specifications and units clearly stated. 
(e) 
Design the flyback transformer for the converter of part (a), usinrf your step-by-step procedure of 
part (d). Use a ferrite EE core, with~= 2.7 and Kfe =50 Wff cm3. Specify: core size, air gap 
length, turns, and wire sizes for all windings. 
(0 
For your final design of part (e), what are (i) the core loss, (ii) the total copper loss, and (iii) the 
peak flux density? 

586 
Transformer Design 
15.4 
Over the intended range of operating frequencies, the frequency dependence of the core-loss coefficient 
Kfe of a certain ferrite core material can be approximated using a monotonically increasing fourth·order 
polynomial of the form 
where KfeO• a!' a2, a3, a4, andf0 are constants. In a typical converter transformer application, the applied 
primary volt-seconds /.. 1 varies directly with the switching period T, = l!f It is desired to choose the opti-
mum switching frequency such that Kgfe' and therefore the transformer size, are minimized. 
(a) 
Show that the optimum switching frequency is a root of the polynomial 
( ~-1) (!) 
(~-2) (!)2 
(~-3) (!)3 
(~-4) (!)4 
1 +a I -~-
To + az -~-
To 
+ a3 -~-
To 
+ a4 -~-
To 
Next, a core material is chosen whose core loss parameters are 
~=2.7 
Kjeo= 7.6 
f0= 100kHz 
a 1 =- 1.3 
a2 = 5.3 
a3 =- 0.5 
a4 = 0.075 
The polynomial fits the manufacturer's published data over the range 10kHz <J < 1 MHz. 
(b) 
Sketch Kfe vs. f 
(c) 
Determine the value off that minimizes KgJe· 
(d) 
Sketch KgJ/J)IK8fe(lOO kHz), over the range 100kHz <;,j<;, 1 MHz. How sensitive is the trans-
former size to the choice of switching frequency? 
15.5 
Transformer design to attain a given temperature rise. The temperature rise t'J.T of the center leg of a fer-
rite core is directly proportional to the total power loss P101 of a transformer: t'J.T = R,, P101 , where R,, is 
the thermal resistance of the transformer under given environmental conditions. You may assume that 
this temperature rise has minimal dependence on the distribution of losses within the transformer. It is 
desired to modify the Kgfe transformer design method, such that temperature rise t'J.T replaces total power 
loss P101 as a specification. You may neglect the dependence of the wire resistivity p on temperature. 
(a) 
Modify then-winding transformer Kgfe design method, as necessary. Define a new core geomet-
rical constant K,, that includes R,,. 
(b) 
Thermal resistances of ferrite EC cores are listed in Section D.3 of Appendix D. Tabulate K,, for 
these cores, using ~ = 2. 7. 
(c) 
A 750 W single-output full-bridge isolated buck de-de converter operates with converter switch-
ing frequency J, = 200 kHz, de input voltage Vg = 400 V, and de output voltage V = 48 V. The 
turns ratio is 6:1. The core loss equation parameters at 100 kHz are Kfe = 10 W/TI'lcm3 and 
0 = 2.7. Assume a fill factor of Ku = 0.3. You may neglect proximity losses. Use your design pro-
cedure of parts (a) and (b) to design a transformer for this application, in which the temperature 
rise is limited to 20'C. Specify: EC core size, primary and secondary turns, wire sizes, and peak 
ac flux density. 

Part IV 
Modern Rectifiers 
and Power System Harmonics 

16 
Power and Harmonics 
in Nonsinusoidal Systems 
Rectification used to be a much simpler topic. A textbook could cover the topic simply by discussing the 
various circuits, such as the peak-detection and inductor-input rectifiers, the phase-controlled bridge, 
polyphase transformer connections, and perhaps multiplier circuits. But recently, rectifiers have become 
much more sophisticated, and are now systems rather than mere circuits. They often include pulse-width 
modulated converters such as the boost converter, with control systems that regulate the ac input current 
waveform. So modern rectifier technology now incorporates many of the de-de converter fundamentals. 
The reason for this is the undesirable ac line current harmonics, and low power factors, of con-
ventional peak-detection and phase-controlled rectifiers. The adverse effects of power system harmonics 
are well recognized. These effects include: unsafe neutral current magnitudes in three-phase systems, 
heating and reduction of life in transformers and induction motors, degradation of system voltage wave-
forms, unsafe currents in power-factor-correction capacitors, and malfunctioning of certain power sys-
tem protection elements. In a real sense, conventional rectifiers are harmonic polluters of the ac power 
distribution system. With the widespread deployment of electronic equipment in our society, rectifier 
harmonics have become a significant and measurable problem. Thus there is a need for high-quality rec-
tifiers, which operate with high power factor, high efficiency, and reduced generation of harmonics. Sev-
eral international standards now exist that specifically limit the magnitudes of harmonic currents, for 
both high-power equipment such as industrial motor drives, and low-power equipment such as electronic 
ballasts for fluorescent lamps and power supplies for office equipment. 
This chapter treats the flow of energy in power systems containing nonsinusoidal waveforms. 
Average power, rms values, and power factor are expressed in terms of the Fourier series of the voltage 
and current waveforms. Harmonic currents in three-phase systems are discussed, and present-day stan-
dards are listed. The following chapters treat harmonics and harmonic mitigation in conventional line-
commutated rectifiers, high-quality rectifier circuits and their models, and control of high-quality rectifi-
ers. 

590 
Power and Harmonics in Nonsinusoidal Systems 
i(t) 
+ 
Source 
v(t) 
SurfaceS 
Fig. 16.1 
Observe the transmission of energy through surface S. 
16.1 
AVERAGE POWER 
Load 
Let us consider the transmission of energy from a source to a load, through a given surface as in Fig. 
16.1. In the network of Fig. 16.1, the voltage waveform v(t) (not necessarily sinusoidal) is given by the 
source, and the current waveform is determined by the response of the load. In the more general case in 
which the source output impedance is significant, then v(t) and i(t) both depend on the characteristics of 
the source and load. Balanced three-phase systems may be treated in the same manner, on a per-phase 
basis, using a line current and line-to-neutral voltage. 
If v(t) and i(t) are periodic, then they may be expressed as Fourier series: 
v(t) = V0 + ,~1 V, cos (nwt- (jl,) 
i(t) = 10 + ,~1 I, cos (nwt- e,) 
(16.1) 
where the period of the ac line voltage waveform is defined as T = 2nlw. In general, the instantaneous 
power p(t) = v(t)i(t) can assume both positive and negative values at various points during the ac line 
cycle. Energy then flows in both directions between the source and load. It is of interest to determine the 
net energy transmitted to the load over one cycle, or 
wcycle = LT v(t)i(t)dt 
(16.2) 
This is directly related to the average power as follows: 
w 
r 
Pav = t' = + 
Jo v(t)i(t)dt 
(16.3) 
Let us investigate the relationship between the harmonic content of the voltage and current waveforms, 
and the average power. Substitution of the Fourier series, Eq. (16.1), into Eq. (16.3) yields 
(16.4) 
To evaluate this integral, we must multiply out the infinite series. It can be shown that the integrals of 

16.1 
Average Power 
591 
cross-product terms are zero, and the only contributions to the integral comes from the products of volt-
age and current harmonics of the same frequency: 
r(v,.cos(nwt-<p,.J)(Imcos(mwt-8m))dt = (VI 
O 
Jo 
_l!_'l. cos (m - 8 ) 
2 
't'n 
n 
if n.=m 
(16.5) 
if n=m 
The average power is therefore 
Pav = V0! 0 + i: V,2,1,. COS (<fl 11 - 8 ,.) 
n=l 
(16.6) 
So net energy is transmitted to the load only when the Fourier series of v(t) and i(t) contain terms at the 
same frequency. For example, if v(t) and i(t) both contain third harmonic, then net energy is transmitted 
at the third harmonic frequency, with average power equal to 
(16.7) 
Here, Vii2 is equal to the rms volt-amperes of the third harmonic current and voltage. The cos ( ¢3 - 83) 
term is a displacement term which accounts for the phase difference between the third harmonic voltage 
and current. 
Some examples of power flow in systems containing harmonics are illustrated in Figs. 16.2 to 
16.4. In example 1, Fig. 16.2, the voltage contains fundamental only, while the current contains third har-
(a) 
v(t) 
0.5 
0 
-0.5 
-1 
(b) 
p(t) = v(t)i(t) 
0.5 
0 
-0.5 
-1 
Fig. 16.2 
Voltage, current, and instantaneous power waveforms, example 1. The voltage contains only fundamen-
tal, and the current contains only third harmonic. The average power is zero. 

592 
Power and Harmonics in Nonsinusoidal Systems 
p(t) = v(t)i(t) 
Fig. 16.3 
Voltage, current, and instantaneous power waveforms, example 2. The voltage and current each contain 
only third harmonic, and are in phase. Net energy is transmitted at the third harmonic frequency. 
0.6 
p(t) = v(t)i(t) 
0.4 
0.2 
0.0 
-0.2 
Fig. 16.4 
Voltage, current, and instantaneous power waveforms, example 3. The voltage contains fundamental, 
third, and fifth harmonics. The current contains fundamental, fifth, and seventh harmonics. Net energy is transmitted 
at the fundamental and fifth harmonic frequencies. 

16.2 
Root-Mean-Square (RMS) Value of a Waveform 
593 
monic only. It can be seen that the instantaneous power waveform p(t) has a zero average value, and 
hence Pav is zero. Energy circulates between the source and load, but over one cycle the net energy trans-
ferred to the load is zero. In example 2, Fig. 16.3, the voltage and current each contain only third har-
monic. The average power is given by Eq. (16.7) in this case. 
In example 3, Fig. 16.4, the voltage waveform contains fundamental, third harmonic, and fifth 
harmonic, while the current contains fundamental, fifth harmonic, and seventh harmonic, as follows: 
v(t) = 1.2 cos (wt) + 0.33 cos (3wt) + 0.2 cos (5wt) 
(16.8) 
i(t) = 0.6 cos ( wt + 30°) + 0.1 cos (5wt + 45°) + 0.1 cos (7wt + 60°) 
Average power is transmitted at the fundamental and fifth harmonic frequencies, since only these fre-
quencies are present in both waveforms. The average power is found by evaluation of Eq. (16.6); all 
terms are zero except for the fundamental and fifth harmonic terms, as follows: 
P = (1.2)(0.6) 
(300) 
(0.2)(0.1) 
(450) = 0 32 
av 
2 
COS 
+ 
2 
COS 
. 
The instantaneous power and its average are illustrated in Fig. 16.4(b). 
16.2 
ROOT-MEAN-SQUARE(RMS)VALUEOF A WAVEFORM 
The rms value of a periodic waveform v(t) with period Tis defined as 
(rms value)= 
l_ ( v2(t)dt 
T Jo 
(16.9) 
(16.10) 
The rms value can also be expressed in terms of the Fourier components. Insertion of Eq. (16.1) into Eq. 
(16.10), and simplification using Eq. (16.5), yields 
J 
= 
y2 
(rms value)= 
v~ + ,~1 -2 
(16.11) 
Again, the integrals of the cross-product terms are zero. This expression holds when the waveform is a 
current: 
(16.12) 
Thus, the presence of harmonics in a waveform always increases its rms value. In particular, in the case 
where the voltage v(t) contains only fundamental while the current i(t) contains harmonics, then the har-
monics increase the rms value of the current while leaving the average power unchanged. This is undesir-
able, because the harmonics do not lead to net delivery of energy to the load, yet they increase the I,m/R 
losses in the system. 
In a practical system, series resistances always exist in the source, load, and/or transmission 
wires, which lead to unwanted power losses obeying the expression 
(16.13) 

594 
Power and Harmonics in Nonsinusoidal Systems 
Examples of such loss elements are the resistance of ac generator windings, the resistance of the wire 
connecting the source and load, the resistance of transformer windings, and the resistance of semicon-
ductor devices and magnetics windings in switching converters. Thus, it is desired to make the rms cur-
rent as small as possible, while transferring the required amount of energy and average power to the load. 
Shunt resistances usually also exist, which cause power loss according to the relation 
(rms voltage) 2 
Rs!zunt 
(16.14) 
Examples include the core losses in transformers and ac generators, and switching converter transistor 
switching loss. Therefore, it is desired to also make the rms voltage as small as possible while transfer-
ring the required average power to the load. 
16.3 
POWER FACTOR 
Power factor is a figure of merit that measures how effectively energy is transmitted between a source 
and load network. It is measured at a given surface as in Fig. 16.1, and is defined as 
ower factor= 
(average power) 
p 
(rms voltage) (rms current) 
(16.15) 
The power factor"always has a value between zero and one. The ideal case, unity power factor, occurs for 
a load that obeys Ohm's Law. In this case, the voltage and current waveforms have the same shape, con-
tain the same harmonic spectrum, and are in phase. For a given average power throughput, the rms cur-
rent and voltage are minimized at maximum (unity) power factor, that is, with a linear resistive load. In 
the case where the voltage contains no harmonics but the load is nonlinear and contains dynamics, then 
the power factor can be expressed as a product of two terms, one resulting from the phase shift of the 
fundamental component of the current, and the other resulting from the current harmonics. 
16.3.1 
Linear Resistive Load, Nonsinusoidal Voltage 
In this case, the current harmonics are in phase with, and proportional to, the voltage harmonics. As a 
result, all harmonics result in the net transfer of energy to the load. The current harmonic magnitudes and 
phases are 
The rms voltage is again 
and the rms current is 
e, = cp, 
I = V, 
" R 
so cos (6,- cp,) = 1 
J 
~ vz 
<rms voltage)= 
v& + ,~, --t 
(16.16) 
(16.17) 
(16.18) 

16.3 
Power Factor 
595 
= 
[2 
( 
) 
/ 2 
" 
__!_!_ 
-
rms current = 
0 + ,t-'1 2 -
(16.19) 
= * 
(rms voltage) 
By use ofEq. (16.6), the average power is 
Pav = V0l 0 + L V,2J, cos (qJ,- 8 11 ) 
II= I 
V2 
= vz 
= _Q_ + ~ ___!! 
R 
n~!2R 
(16.20) 
= * 
(rms vo1tage) 2 
Insertion of Eqs. (16.19) and (16.20) into Eq. (16.15) then shows that the power factor is unity. Thus, if 
the load is linear and purely resistive, then the power factor is unity regardless of the harmonic content of 
v(t). The harmonic content of the load current waveform i(t) is identical to that of v(t), and all harmonics 
result in the transfer of energy to the load. This raises the possibility that one could construct a power dis-
tribution system based on nonsinusoidal waveforms in which the energy is efficiently transferred to the 
load. 
16.3.2 
Nonlinear Dynamical Load, Sinusoidal Voltage 
If the voltage v(t) contains a fundamental component but no de component or harmonics, so that V0 = V2 
= V3 = ... = 0, then harmonics in i(t) do not result in transmission of net energy to the load. The average 
power expression, Eq. (16.6), becomes 
(16.21) 
However, the harmonics in i(t) do affect the value of the rms current: 
(16.22) 
Hence, as in example 1 (Fig. 16.2), harmonics cause the load to draw more rms current from the source, 
but not more average power. Increasing the current harmonics does not cause more energy to be trans-
ferred to the load, but does cause additional losses in series resistive elements Rseries· 
Also, the presence of load dynamics and reactive elements, which causes the phase of the fun-
damental components of the voltage and current to differ (81 -
<p1), also reduces the power factor. The 
cos (<p1 - 81) term in the average power Eq. (16.21) becomes less than unity. However, the rms value of 
the current, Eq. (16.22), does not depend on the phase. So shifting the phase of i(t) with respect to v(t) 
reduces the average power without changing the rms voltage or current, and hence the power factor is 
reduced. 
By substituting Eqs. (16.21) and (16.22) into (16.15), we can express the power factor for the 
sinusoidal voltage in the following form: 

596 
Power and Harmonics in Nonsinusoidal Systems 
(16.23) 
=(distortion factor) (displacement factor) 
So when the voltage contains no harmonics, then the power factor can be written as the product of two 
terms. The first, called the distortion factor, is the ratio of the rms fundamental component of the current 
to the total rms value of the current 
/1 
) 
J2 
= (rms fundamental current) 
L
~ 12 
(rrns current) 
/2 + 
_..!l 
0 
2 
n=l 
(16.24) 
The second term of Eq. (16.23) is called the displacement factor, and is the cosine of the angle between 
the fundamental components of the voltage and current waveforms. 
The Total Harmonic Distortion (THD) is defined as the ratio of the rms value of the waveform 
not including the fundamental, to the rms fundamental magnitude. When no de is present, this can be 
written: 
(THO) = -'-f%1--""7--'
1 "----
1 
(16.25) 
The total harmonic distortion and the distortion factor are closely related. Comparison of Eqs. (16.24) 
and (16.25), with !0 = 0, leads to 
(distortion factor)= V 
1 
2 
1 +(THO) 
(16.26) 
This equation is plotted in Fig. 16.5. The distortion factor of a waveform with a moderate amount of dis-
tortion is quite close to unity. For example, if the waveform contains third harmonic whose magnitude is 
Fig. 16.5 
Distortion factor vs. total 
harmonic distortion. 
100% 
THD 
~ 
0 
00 

16.3 Power Factor 
597 
Fig. 16.6 Conventional peak detection rectifier. 
100% 
~] 
~t: 80% 
~~ 
%~ 60% 
§ § 
.~:;: 40% 
t: <:) 
THD= 136% 
Dis ron ion factor= 59% 
o -
E t: 
'I> 
20% 
:il 
~ 
'I> 
~ 
0% 
3 
5 
7 
9 
I I 
13 
15 
17 
19 
Harmonic number 
Fig. 16.7 Typical ac line current spectrum of a peak detection rectifier. Harmonics 1 to 19 are shown. 
10% of the fundamental, the distortion factor is 99.5%. Increasing the third harmonic to 20% decreases 
the distortion factor to 98%, and a 33% harmonic magnitude yields a distortion factor of 95%. So the 
power factor is not significantly degraded by the presence of harmonics unless the harmonics are quite 
large in magnitude. 
An example of a case in which the distortion factor is much less than unity is the conventional 
peak detection rectifier of Fig. 16.6. In this circuit, the ac line current consists of short-duration current 
pulses occurring at the peak of the voltage waveform. The fundamental component of the line current is 
essentially in phase with the voltage, and the displacement factor is close to unity. However, the low-
order current harmonics are quite large, close in magnitude to that of the fundamental-a typical current 
spectrum is given in Fig. 16.7. The distortion factor of peak detection rectifiers is usually in the range 
55% to 65%. The resulting power factor is similar in value. 
In North America, the standard 120 V power outlet is protected by a 15 A circuit breaker. In 
consequence, the available load power quite limited. Derating the circuit breaker current by 20%, assum-
ing typical efficiencies for the de-de converter and peak detection rectifier, and with a .power factor of 
55%, one obtains the following estimate for the maximum available de load power: 
(ac voltage) (derated breaker current) (powerfactor) (rectifier efficiency) 
= (120 V) 
(80% of 15 A) 
(0.55) 
(0.98) 
(16.27) 
= 776W 
The less-than-unity efficiency of a de-de converter would further reduce the available de load power. 
Using a peak detection rectifier to supply a load power greater than this requires that the user install 
higher amperage and/or higher voltage service, which is inconvenient and costly. The use of a rectifier 

598 
Power and Harmonics in Nonsinusoidal Systems 
circuit having nearly unity power factor would allow a significant increase in available de load power: 
(ac voltage) (derated breaker current) (power factor) (rectifier efficiency) 
= (120 V) 
(80% of 15 A) 
(0.99) 
(0.93) 
(16.28) 
= 1325W 
or almost twice the available power of the peak detection rectifier. This alone can be a compelling reason 
to employ high quality rectifiers in commercial systems. 
16.4 
POWER PHASORS IN SINUSOIDAL SYSTEMS 
The apparent power is defined as the product of the rms voltage and rms current. Apparent power is eas-
ily measured-it is simply the product of the readings of a voltmeter and ammeter placed in the circuit at 
the given surface. Many power system elements, such as transformers, must be rated according to the 
apparent power that they are able to supply. The unit of apparent power is the volt-ampere, or VA. The 
power factor, defined in Eq. (16.15), is the ratio of average power to apparent power. 
In the case of sinusoidal voltage and current waveforms, we can additionally define the complex 
powerS and the reactive power Q. If the sinusoidal voltage v(t) and current i(t) can be represented by the 
phasors V and I, then the complex power is a phasor defined as 
S= VI* =P+ jQ 
(16.29) 
Here, I* is the complex conjugate of I, and j is the square root of- 1. The magnitude of S, or II S II, is 
equal to the apparent power, measured in VA. The real part of Sis the average power P, having units of 
watts. The imaginary part of Sis the reactive power Q, having units of reactive volt-amperes, or VARs. 
A phasor diagram illustrating S, P, and Q, is given in Fig. 16.8. The angle (rp 1 - 81) is the angle 
between the voltage phasor V and the current phasor I. (rp 1 - 81) is additionally the phase of the complex 
powerS. The power factor in the purely sinusoidal case is therefore 
Imaginary 
axis 
S= VI* 
Real axis 
Fig. 16.8 
Power phasor diagram, for a sinusoidal system, illustrating the voltage, current, and complex power 
phasors. 

16.5 Harmonic Currents in Three Phase Systems 
599 
power factor= II~ II =cos ( q> 1 - e 1) 
(16.30) 
It should be emphasized that this equation is valid only for systems in which the voltage and current are 
purely sinusoidal. The distortion factor of Eq. (16.24) then becomes unity, and the power factor is equal 
to the displacement factor as in Eq. (16.30). 
The reactive power Q does not lead to net transmission of energy between the source and load. 
When reactive power is present, the rms current and apparent power are greater than the minimum 
amount necessary to transmit the average power P. In an inductor, the current lags the voltage by 90', 
causing the displacement factor to be zero. The alternate storing and releasing of energy in an inductor 
leads to current flow and nonzero apparent power, but the average power P is zero. Just as resistors con-
sume real (average) power P, inductors can be viewed as consumers of reactive power Q. In a capacitor, 
the current leads to voltage by 90', again causing the displacement factor to be zero. Capacitors supply 
reactive power Q, and are commonly placed in the utility power distribution system near inductive loads. 
If the reactive power supplied by the capacitor is equal to the reactive power consumed by the inductor, 
then the net current (flowing from the source into the capacitor-inductive-load combination) will be in 
phase with the voltage, leading unity power factor and minimum rms current magnitude. 
It will be seen in the next chapter that phase-controlled rectifiers produce a nonsinusoidal cur-
rent waveform whose fundamental component lags the voltage. This lagging current does not arise from 
energy storage, but it does nonetheless lead to a reduced displacement factor, and to rms current and 
apparent power that are greater than the minimum amount necessary to transmit the average power. 
16.5 
HARMONIC CURRENTS IN THREE PHASE SYSTEMS 
The presence of harmonic currents can also lead to some special problems in three-phase systems. In a 
four-wire three-phase system, harmonic currents can lead to large currents in the neutral conductors, 
which may easily exceed the conductor rms current rating. Power factor correction capacitors may expe-
rience significantly increased rms currents, causing them to fail. In this section, these problems are exam-
ined, and the properties of harmonic current flow in three-phase systems are derived. 
16.5.1 
Harmonic Currents in Three-Phase 
Four-Wire Networks 
Let us consider the three-phase four-wire network of Fig. 16.9. In general, we can express the Fourier 
series of the line currents and line-neutral voltages as follows: 
ia(t)=lao+ L lakcos(kmt-8ak) 
k= 1 
ib(t)=lbO+ i; lhkcos(k(mt-120°)-ebk) 
k= 1 
(16.31) 
ic(t) = l cO+ i: l ck cos (k(mt + 120')- eck) 
k = 1 

600 
Power and Harmonics in Nonsinusoidal Systems 
Ideal 
3¢ 
source 
a 
b 
c 
i/t) 
iJt) 
Neutral connection 
Fig. 16.9 Current flow in a three-phase four-wire network. 
V aa(t) = Vm cos ( Wt) 
vb,.(t) = vm cos (wt - 120') 
vcn(t) = vm cos (wt + 120') 
The neutral current is therefore in = ia + ib + ic, or 
i,.(t) = f aO + f bO + f c0 + 
Nonlinear 
loads 
k~l l Iak cos (kwt- 8ak) +I bk cos (k(wt- 120')- 8bk) + Ick cos (k(wt + 120')- 8ck) 1 
(16.32) 
(16.33) 
When the load is unbalanced (even though the voltages are balanced and undistorted), we can say little 
else about the neutral and line currents. If the load is unbalanced and nonlinear, then the line and neutral 
currents may contain harmonics of any order, including even and triplen harmonics. 
Equation (16.33) is considerably simplified in the case where the loads are balanced. A bal-
anced nonlinear load is one in which Iak = lbk = lck = Ik and eak = ebk = eck = ek, for all k; that is, the har-
monics of the three phases all have equal amplitudes and phase shifts. In this case, Eq. (16.33) reduces to 
in(t) = 3/0 + L 
3/ k cos (kwt- 8 k) 
k = 3.6.9 .... 
(16.34) 
Hence, the fundamental and most of the harmonics cancel out, and do not appear in the neutral conduc-
tor. Thus, it is in the interests of the utility to balance their nonlinear loads as well as their harmonics. 
But not all of the harmonics cancel out of Eq. (16.34): the de and triplen (triple-n, or 3,6,9, ... ) 
harmonics add rather than cancel. The rms neutral current is 
in,rms=3 
Example 
/2 
I~+ L 
k 
k=3.6,9.-·· 2 
(16.35) 
A balanced nonlinear load produces line currents containing fundamental and 20% third har-
monic: ian(t) = / 1 cos(wt- 81) + 0.2/1 cos(3wt- 83). Find the rms neutral current, and compare its ampli-
tude to the rms line current amplitude. 

16.5 Harmonic Currents in Three Phase Systems 
601 
Solution: 
(16.36) 
So the neutral current magnitude is 60% of the line current magnitude! The triplen harmonics in the three 
phases add, such that 20% third harmonic leads to 60% third harmonic neutral current. Yet the presence 
of the third harmonic has very little effect on the rms value of the line current. Significant unexpected 
neutral current flows. 
16.5.2 
Harmonic Currents in Three-Phase 
Three-Wire Networks 
If there is no neutral connection to the wye-connected load, as in Fig. 16.10, then iJt) must be zero. If the 
load is balanced, then Eq. (16.34) still applies, and therefore the de and trip len harmonics of the load cur-
rents must be zero. Therefore, the line currents ia, ib, and ic cannot contain trip len or de harmonics. What 
happens is that a voltage is induced at the load neutral point n', containing. de and trip len harmonics, 
which eliminates the trip len and de load current harmonics. 
This result is true only when the load is balanced. With an unbalanced load, all harmonics can 
appear in the line currents, including triplen and de. In practice, the load is never exactly balanced, and 
some small amounts of third harmonic line currents are measured. 
With a delta-connected load as in Fig. 16.11, there is also no neutral connection, so the line cur-
rents cannot contain triplen or de components. But the loads are connected line-to-line, and are excited 
by undistorted sinusoidal voltages. Hence triplen harmonic and de currents do, in general, flow through 
the nonlinear loads. Therefore, these currents simply circulate around the delta. If the load is balanced, 
then again no trip len harmonics appear in the line currents. 
Ideal 
3¢ 
source 
a 
b 
Fig. 16.10 Current flow in a three-phase three-wire wye-connected network. 
Nonlinear 
loads 

602 
Power and Harmonics in Nonsinusoidal Systems 
Ideal 
3¢ 
source 
a 
b 
Delta-
connected 
nonlinear 
loads 
Fig. 16.11 
A balanced nonlinear delta-connected load may generate triplen current harmonics. These harmonics 
circulate around the delta, but do not flow through the lines if the load is balanced. 
16.5.3 
Harmonic Current Flow in Power Factor 
Correction Capacitors 
Harmonic currents tend to flow through shunt-connected power factor correction capacitors. To some 
extent, this is a good thing because the capacitors tend to low-pass filter the power system currents, and 
prevent nonlinear loads from polluting the entire power system. The flow of harmonic currents is then 
confined to the nonlinear load and local power factor correction capacitors, and voltage waveform distor-
tion is reduced. High-frequency harmonic currents tend to flow through shunt capacitors because the 
capacitor impedance decreases with frequency, while the inductive impedance of transmission lines 
increases with frequency. In this sense, power factor correction capacitors mitigate the effects of har-
monic currents arising from nonlinear loads in much the same way that they mitigate the effects of reac-
tive currents that arise from inductive loads. 
But the problem is that the power factor correction capacitors may not 
be rated to handle these harmonic currents, and hence there is a danger that the 
capacitors may overheat and fail when they are exposed to significant harmonic 
currents. The loss in capacitors is modeled using an equivalent series resistance 
(esr) as shown in Fig. 16.12. The esr models dielectric loss (hysteresis of the 
dielectric D-E loop), contact resistance, and foil and lead resistances. Power 
loss occurs, equal to irm/(esr). Dielectric materials are typically poor conduc-
tors of heat, so a moderate amount of power loss can cause a large temperature 
Fig. 16.12 Capacitor 
rise in the center of the capacitor. In consequence, the rms current must be lim-
equivalent 
circuit. 
ited to a safe value. 
Losses are modeled by 
Typical power factor correction capacitors are rated by voltage V, fre-
an 
equivalent series 
quency f, and reactive power in kVARs. These ratings are computed from the 
resistance (esr). 
capacitance C and safe rms current Irms' assuming undistorted sinusoidal wave-
forms, as follows: 
d 
I 
V 
/rms 
rate rms vo tage 
rms = 2nf C 
(16.37) 

16.6 AC Line Current Harmonic Standards 
/2 
rated reactive power= ~ 
2nfC 
603 
(16.38) 
In an undistorted system, the rms current, and hence also the capacitor esr loss, cannot increase unless 
the rms voltage is also increased. But high-frequency harmonics can lead to larger rms currents without 
an increased voltage. Any harmonics that flow result in increased rms current beyond the expected value 
predicted by Eq. (16.37). If the capacitor is not rated to handle additional power loss, then failure or pre-
mature aging can occur. 
16.6 
AC LINE CURRENT HARMONIC STANDARDS 
Besides the increased currents and reduced power factors of peak detection rectifiers, the harmonics 
themselves can be detrimental: if large enough in magnitude, they can pollute the power system. Har-
monic currents cause distortion of the voltage waveform via the power system series impedance. These 
voltage harmonics can interfere with the operation of nearby loads. As noted previously, increased cur-
rents in shunt capacitors, and increased losses in distribution transformers and ac machines, can lead to 
premature aging and failure of these devices. Odd triplen harmonics (triple-n: 3r<l, gth, 15th, etc.) lead to 
unexpectedly large neutral currents in three-phase systems. Harmonic currents can also excite system 
resonances some distance from their source, with results that are difficult to predict. For these reasons, a 
number of organizations have adopted standards that limit the magnitudes of the harmonic currents that a 
load is allowed to inject into the ac line. The US military was one of the early organizations to recognize 
these problems; the very strict 3% limit was initially adopted. The standards adopted by the IEC and 
IEEE are more recent, and are intended for conventional utility systems. A fourth example, not discussed 
here, is the telephone interference factor, which limits power distribution system harmonics in cases 
when telephone lines and power lines share the same poles. 
16.6.1 
International Electrotechnical Commission 
Standard 1000 
This international agency adopted a first draft of their IEC 555 standard in 1982. It has since undergone a 
number of revisions, and has been superceded by IEC 1000 [7]. This standard is now enforced in Europe, 
making it a de facto standard for commercial equipment intended to be sold worldwide. 
The IEC 1000-3-2 standard covers a number of different types of low power equipment, with 
differing harmonic limits. It specifically limits harmonics for equipment having an input current of up to 
16 A, connected to 50 or 60Hz, 220 V to 240 V single phase circuits (two or three wire), as well as 
380 V to 415 V three phase (three or four wire) circuits. In a city environment such as a large building, a 
large fraction of the total power system load can be nonlinear. For example, a major portion of the elec-
trical load in a building is comprised of fluorescent lights, which present a very nonlinear characteristic 
to the utility system. A modem office may also contain a large number of personal computers, printers, 
copiers, etc., each of which may employ peak detection rectifiers. Although each individual load is a neg-
ligible fraction of the total local load, these loads can collectively become significant. 
The IEC 1000-3-2 standard defines several categories of equipment, each of which is covered 
by a different set of harmonic limits. As an example, Table 16.1 shows the harmonic limits for Class A 
equipment, which includes low harmonic rectifiers for computer and other office equipment. 
The European norm EN 61000-3-2 defines similar limits. 

604 
Power and Harmonics in Nonsinusoidal Systems 
Table 16.1 
IEC 1000-3-2 Harmonic current limits, class A 
Odd harmonics 
Harmonic number 
Maximum current 
3 
2.30A 
5 
1.14A 
7 
0.77 A 
9 
0.40A 
11 
0.33A 
13 
0.21 A 
15:s;n:s;39 
0.15 A· (15/n) 
16.6.2 
IEEE/ ANSI Standard 519 
Even harmonics 
Harmonic number 
2 
4 
6 
8 ::;n::;4o 
Maximum current 
1.08A 
0.43A 
0.30A 
0.23 A·(8/n) 
In 1993, the IEEE published a revised draft standard limiting the amplitudes of current harmonics, IEEE 
Guide for Harmonic Control and Reactive Compensation of Static Power Converters. The harmonic lim-
its are based on the ratio of the fundamental component of the load current IL to the short circuit current 
at the point of common coupling (PCC) at the utility Isc· Stricter limits are imposed on large loads than 
on small loads. The limits are similar in magnitude to IEC 1000, and cover high voltage loads (of much 
higher power) not addressed by IEC 1000. Enforcement of this standard is presently up to the local utility 
company. 
The odd harmonic limits for general distribution systems at voltages of 120 V to 69 kV are 
listed in Table 16.2. The limits for even harmonics are 25% of the odd harmonic limits. Limits for gen-
eral distribution systems at 69.001 kV to 161 kV are 50% of the values listed in Table 16.2. De current 
components and half-wave rectifiers are not allowed. 
It is the responsibility of the power consumer to meet these current harmonic standards. Stan-
dard IEEE-519 also specifies maximum allowable voltage harmonics, listed in Table 16.3. It is the 
responsibility of the utility, or power supplier, to meet these limits. Both total harmonic distortion and 
maximum individual harmonic magnitudes are limited. 
Table 16.2 IEEE-519 Maximum odd harmonic current limits for general distribution systems, 120 V to 69 kV 
ISCIIL 
n< 11 
11:s;n<17 
17:s;n<23 
23::; n < 35 
35::; n 
THD 
<20 
4.0% 
2.0% 
1.5% 
0.6% 
0.3% 
5.0% 
20-50 
7.0% 
3.5% 
2.5% 
1.0% 
0.5% 
8.0% 
50-100 
10.0% 
4.5% 
4.0% 
1.5% 
0.7% 
12.0% 
100-1000 
12.0% 
5.5% 
5.0% 
2.0% 
1.0% 
15.0% 
> 1000 
15.0% 
7.0% 
6.0% 
2.5% 
1.4% 
20.0% 

Table 16.3 
IEEE-519 Voltage distortion limits 
Bus voltage at PCC 
69 kV and lower 
69.001 kV to 161 kV 
Above 161 kV 
BIBLIOGRAPHY 
Individual harmonics 
3.0% 
1.5% 
1.0% 
Bibliography 
605 
THD 
5.0% 
2.5% 
1.5% 
[1] 
J. ARRILLAGA, D. BRADLEY, and P. BODGER, Power System Harmonics, New York: John Wiley & Sons, 
1985. 
[2] 
R. SMITY and R. STRATFORD, "Power System Harmonics Effects from Adjustable-Speed Drives," IEEE 
Transactions on Industry Applications, Vol. IA-20, No.4, pp. 973-977, July/August 1984. 
[3] 
A. EMANUEL, "Powers in Nonsinusoidal Situations-A Review of Definitions and Physical Meaning," 
IEEE Transactions on Power Delivery, Vol. 5, No.3, pp. 1377-1389, July 1990. 
[4] 
N. MOHAN, T. UNDELAND, and W. ROBBINS, Power Electronics: Converters, Applications, and Design, 
Second edition, New York: John Wiley & Sons, 1995. 
[5] 
J. KASSAKIAN, M. SCHLECHT, and G. VERGESE, Principles of Power Electronics, Massachusetts: Addison-
Wesley, 1991. 
[6] 
R. GRETSCH, "Harmonic Distortion of the Mains Voltage by Switched-Mode Power Supplies-Assess-
ment of the Future Development and Possible Mitigation Measures," European Power Electronics Confer-
ence, 1989 Record, pp. 1255-1260. 
[7] 
IEC 1000-3-2, First Edition, Commission Electrotechnique Internationale, Geneva, 1995. 
PROBLEMS 
16.1 
Passive rectifier circuit. In the passive rectifier circuit of Fig. 16.13, Lis very large, such that the inductor 
current i(t) is essentially de. All components are ideal. 
v8(t) 
230Vrms 
50Hz 
sl 
Fig. 16.13 
Passive rectifier circuit of Problem 16.1 
(a) 
Determine the de output voltage, current, and power. 
+ 
v 
R 
40Q 

606 
Power and Harmonics in Nonsinusoidal Systems 
(b) 
Sketch the ac line current waveform igCt) and the rectifier output voltage waveform vR(t). 
(c) 
Determine the ac line current rms magnitude, fundamental rms magnitude, and third harmonic 
rrns magnitude. Does this rectifier network conform to the IEC-1 000 harmonic current limits? 
(d) 
Determine the power factor, measured at surfaces S 1 and S2• 
16.2 
The three-phase rectifier of Fig. 16.14 is connected to a balanced 60Hz 3¢ac 480 V (rms, line-line) sinu-
soidal source as shown. All elements are ideal. The inductance L is large, such that the current i(t) is 
essentially constant, with negligible 360Hz ripple. 
Balanced 
3¢ac 
480V 
<Pa 
ia(t) 
<Pb 
ib(t) 
ic(t) 
<Pc --+-' 
Fig. 16.14 Three-phase rectifier circuit of Problem 16.2 
(a) 
Sketch the waveform v it). 
(b) 
Determine the de output voltage V. 
(c) 
Sketch the line current waveforms iJt), ib(t), and ic(t). 
(d) 
Find the Fourier series of ia(t). 
L 
+ 
v 
R 
20Q 
(e) 
Find the distortion factor, displacement factor, power factor, and line current THD. 
16.3 
Harmonic pollution police. In the network of Fig. 16.15, voltage harmonics are observed at the indicated 
surface. The object of this problem is to decide whether to blame the source or the load for the observed 
harmonic pollution. Either the source element or the load element contains a nonlinearity that generates 
harmonics, while the other element is linear. 
--------------------------------------------1 
Source 
i(t) 
+ 
v(t) 
Surface 
s 
Fig. 16.15 
Single-phase power system of Problems 16.3 to 16.5 
r·--------------------1 
l 
' 
: 
I 
lz2 
I 
I Load 
'---------------------
(a) 
Consider first the case where the load is a passive linear impedance Zis), and hence its phase 
lies in the range - 90' :::; L.Z2Uw) :::; + 90' for all positive w. The source generates harmonics. 
Express the average power P in the form 
P= i; p" 
n=O 
where P11 is the average power transmitted to the load by harmonic number n. What can you say 
about the polarities of the P 11 s? 

Problems 
607 
(b) 
Consider next the case where the load is nonlinear, while the source is linear and can be modeled 
by a Thevenin-equivalent sinusoidal voltage source and linear impedance Z1 (s). Again express 
the average power P as a sum of average powers, as in part (a). What can you say about the 
polarities of the Pn sin this case? 
(c) 
The following Fourier series are measured: 
Harmonic 
v(t) 
number 
Magnitude 
Phase 
230V 
0' 
3 
20V 
180' 
5 
8V 
60' 
Who do you accuse? Explain your reasoning. 
Magnitude 
6A 
4A 
lA 
i(t) 
Phase 
-20' 
20' 
- 110' 
16.4 
For the network and waveforms of Problem 16.3, determine the power factor at the indicated surface, 
and the average power flowing to the load. Harmonics higher in frequency than the fifth harmonic are 
negligible in magnitude. 
16.5 
Repeat Problem 16.3(c), using the following Fourier series: 
Harmonic 
v(t) 
number 
Magnitude 
Phase 
I 
120V 
0' 
3 
4V 
60' 
5 
2V 
-160' 
Magnitude 
5A 
0.5A 
0.2A 
i(t) 
Phase 
25' 
40' 
-100' 
16.6 
A balanced three-phase wye-connected load is constructed using a 20 Q resistor in each phase. This load 
is connected to a balanced three-phase wye-connected voltage source, whose fundamental voltage com-
ponent is 380 Vrms line-to-line. In addition, each (line-to-neutral) voltage source produces third and 
fifth harmonics. Each harmonic has amplitude 20 Vrms, and is in phase with the (line-to-neutral) funda-
mental. 
(a) 
The source and load neutral points are connected, such that a four-wire system is obtained. Find 
the Fourier series of the line currents and the neutral current. 
(b) 
The neutral connection is broken, such that a three-wire system is obtained. Find the Fourier 
series of the line currents. Also find the Fourier series of the voltage between the source and load 
neutral points. 

17 
Line-Commutated Rectifiers 
Conventional diode peak-detection rectifiers are inexpensive, reliable, and in widespread use. Their 
shortcomings are the high harmonic content of their ac line currents, and their low power factors. In this 
chapter, the basic operation and ac line current waveforms of several of the most common single-phase 
and three-phase diode rectifiers are summarized. Also introduced are phase-controlled three-phase recti-
fiers and inverters, and passive harmonic mitigation techniques. Several of the many references in this 
area are listed at the end of this chapter [ 1-15]. 
Rigorous analytical design of line-commutated rectifier and filter circuits is unfeasible for all 
but the simplest of circuits. Typical peak-detection rectifiers are numerically ill-conditioned, because 
small changes in the de-side ripple voltage lead to large changes in the ac line current waveforms. There-
fore, the discussions of this chapter are confined to mostly qualitative arguments, with the objective of 
giving the reader some insight into the physical operation of rectifier/filter circuits. Waveforms, harmonic 
magnitudes, and power factors are best determined by measurement or computer simulation. 
17.1 
THE SINGLE-PHASE FULL-WAVE RECTIFIER 
A single-phase full-wave rectifier, with uncontrolled diode rectifiers, is shown in Fig. 17.1. The circuit 
includes a de-side L-C filter. There are two conventional uses for this circuit. In the traditional full-wave 
rectifier, the output capacitor is large in value, and the de output voltage v(t) has negligible ripple at the 
second harmonic of the ac line frequency. Inductor L is most often small or absent. Additional small 
inductance may be in series with the ac source v8(t). A second conventional use of this circuit is in the 
low-harmonic rectifiers discussed in the next chapter. In this case, the resistive load is replaced by a de-
de converter that is controlled such that its power input port obeys Ohm's law. For the purposes of under-
standing the rectifier waveforms, the converter can be modeled by an effective resistance R, as in the cir-

610 
Line-Commutated Rectifiers 
+ 
v(t) 
R 
Fig. 17.1 
Conventional single-phase full-wave rectifier, with de-side L-C filter. 
cuit of Fig. 17 .1. In this application, the L-C filter is required to filter the conducted electromagnetic 
interference (EMI) generated by the converter. The inductor and capacitor element values are typically 
small in value, and v(t) is approximately a rectified sinusoid. More generally, there may be several sec-
tions of L-C filter networks, connected to both the de and ac sides of the diode rectifier, which filter EMI, 
smooth the de output voltage, and reduce the ac line current harmonics. 
The presence of any filter degrades the ac current waveform of the rectifier. With no reactive 
elements (L = 0 and C = 0), the rectifier presents a purely resistive load to the ac input. The output volt-
age v(t) is then a rectified sinusoid, there are no ac line current harmonics, and the power factor is unity. 
Addition of reactive elements betWeen the rectifier diodes and the load leads in general to ac line current 
harmonics. Given that such a filter is necessary, one might ask what can be done to keep these harmonics 
as small as possible. In this section, the dependence of the ac line current total harmonic distortion on the 
filter parameters is described. 
The circuit of Fig. 17.1 generates odd harmonics of the ac line voltage in the ac line current. The 
de output voltage contains de and even harmonics of the ac line voltage. The circuit exhibits several 
modes of operation, depending on the relative values of L, C, and R. It is easiest to understand these 
modes by considering the limiting cases, as follows. 
17.1.1 
Continuous Conduction Mode 
When the inductor L is very large, then the inductor current iL(t) is essentially constant. This follows 
from the inductor definition vL(t) = LdiL(t)ldt. For a given applied inductor voltage waveform vL(t), the 
slope diL(t)/dt can be made arbitrarily small by making L sufficiently large. In the limiting case where L 
is infinite, the slope diL(t)ldt becomes zero, and the inductor current is constant de. To provide a path for 
the constant inductor to flow, at least two of the rectifier diodes must conduct at any given instant in time. 
For the circuit of Fig. 17.1, diodes D 1 and D3 conduct when the ac line voltage v 8(t) is positive, and D2 
and D4 conduct when vgCt) is negative. The ac line current waveform is therefore a square wave, with 
igCt) = iL(t) when vgCt) is positive, and igCt) =- iL(t) when vgCt) is negative. The diode conduction angle~. 
defined as the angle through which one of the diodes conducts, is equal to 180" in CCM. 
The rms value of a square wave is equal to its peak value Ipk' in this case the de load current. 
The fundamental component of a square wave is equal to 4IP/n. The square-wave contains odd harmon-
ics which vary as 1/n. The distortion factor is therefore 
distortion factor= I;· '"lS = 
4, = 90.0% 
rms 
nv2 
(17.1) 
The total harmonic distortion is 

17.1 
The Single-Phase Full-Wave Rectifier 
611 
THD==29% 
Fig. 17.2 Typical ac line current and voltage waveforms, continuous conduction mode.f0!JL = 5, Q = 0.25. 
THD= 
( 
1 
) 2 
. 
. 
-1 =48.3% 
distortiOn factor 
(17.2) 
So the limiting case of the large inductor leads to some significant harmonic distortion, although it is not 
as bad as the peak detection rectifier case. Since the square wave is in phase with the ac input voltage, the 
displacement factor is unity, and hence the power factor is equal to the distortion factor. 
Whenever the inductor is sufficiently large, the rectifier diodes conduct continuously (i.e., there 
is no time interval in which all four diodes are reverse-biased). This is called the continuous conduction 
mode (CCM). A typical ac line current waveform is plotted in Fig. 17.2 for a finite but large value of L. It 
can be seen that the ac line current is discontinuous at the ac line voltage zero crossing, as in the square-
wave limiting case. Some ringing is also present. This waveform contains a total harmonic distortion of 
approximately 29%. 
17.1.2 
Discontinuous Conduction Mode 
The opposite case occurs when the inductor is very small and the capacitor C is very large. This is the 
peak detector circuit. In the limit as L goes to zero and C goes to infinity, the ac line current approaches a 
string of delta (impulse) functions that coincide with the peaks of the sinusoidal input voltage waveform. 
It can be shown that, in this limiting case, the THD becomes infinite while the distortion factor and 
power factor become zero. Of course, in the practical case the current is not infinite; nonetheless, large 
THD with low power factor is quite possible. The diodes conduct for less than one-half of the ac line 
period, and hence~< 180° in DCM. 
Whenever the capacitor is large and the inductor is small, the rectifier tends to "peak detect," 
and the rectifier operates in the discontinuous conduction mode (DCM). There exist time intervals of 
nonzero length where all four rectifier diodes are reverse-biased. A typical set of waveforms is plotted in 
Fig. 17.3, where the capacitor is large but finite, and the inductor is small but nonzero. The ac line volt-
age and the value of the load resistance are the same as in Fig. 17 .2, yet the peak current is substantially 
larger. The THD for this waveform is 145%, and the distortion factor is 57%. 

612 
Line-Commutated Rectifiers 
THD= 145% 
Fig. 17.3 Typical ac line current and voltage waveforms, discontinuous conduction mode.f0/fL = 8.4. Q = 121. 
17.1.3 
Behavior When Cis Large 
A variety of authors have discussed the solution of passive rectifier circuits; several works are listed in 
the references [8-15]. Analysis of even the simple circuit of Fig. 17.1 is surprisingly complex. For the 
case when Cis infinite, it was shown in [8] that the rectifier waveshapes can be expressed as a function of 
a single dimensionless parameter Kv defined as 
(17.3) 
where TL = l!A is the ac line period. Equation (17 .3) is of the same form as Eq. (5.6), used to define the 
dimensionless parameter K which governs the DCM behavior of PWM converters. Figure 17.4 illustrates 
the behavior of the single-phase rectifier circuit of Fig. 17.1, as a function of KL and for infinite C [8]. 
When KL is greater than approximately 0.1, the rectifier operates in CCM, with waveforms similar to 
those in Fig. 17.2. 
The voltage conversion ratio M is defined as 
(17.4) 
where Vm is the peak value of the sinusoidal ac input voltage. In CCM, the output voltage is ideally inde-
pendent of load, with M = 2/n. Addition of ac-side inductance can cause the output voltage to exhibit a 
dependence on load current. The total harmonic distortion in CCM is nearly constant and equal to the 
value given by Eq. (17.2). 
Near the boundary between CCM and DCM, the fundamental component of the line current 
significantly lags the line voltage. The displacement factor reaches a minimum value slightly less than 
80%, and power factors between 70% and 80% are observed. 
For KL <ik'::: 0.1, the rectifier operates heavily in DCM, as a peak-detection rectifier. As KL is 
decreased, the displacement factor approaches unity, while the THD increases rapidly. The power factor 
is dominated by the distortion factor. The output voltage becomes dependent on the load, and hence the 
rectifier exhibits a small but nonzero output impedance. 
For KL less than approximately 0.05, the waveforms are unchanged when some or all of the 
inductance is shifted to the ac side of the diode bridge. Figure 17.4 therefore applies to rectifiers contain-

cos (<pi- 81), 
PF, M 
1.0 
0.9 
0.8 
0.7 
0.6 
0.5 
17.1 
The Single-Phase Full-Wave Rectifier 
613 
THD 
180° 
PF 
150% 
135° 
100% 
90° 
M 
r----=:::-----=t 50% 
45° 
THD 
DCM +----[:.___. CCM 
0.4 -
0 
0 
0 
0 
KL 
Fig. 17.4 
Diode conduction angle B. displacement factor, power factor, conversion ratio, and total harmonic distor-
tion of the rectifier circuit of Fig. 17.1, with infinite capacitance. 
ing both ac-side and de-side inductance, provided that the circuit operates sufficiently deeply in DCM. 
The parameter KL is computed according to Eq. (17.3), with L taken to be the total ac-side plus de-side 
inductance. A common example is the case where the circuit contains no physical discrete inductor; the 
performance is then determined by parasitic elements such as the capacitor equivalent series inductance, 
the inductance of the utility distribution wiring, and transformer leakage inductances. 
17 .1.4 
Minimizing THD When C is Small 
Let us now consider the performance of the second case, in which the inductor and capacitor are small 
and are intended solely to prevent load-generated EMI from reaching the ac line. In this case, de-side fil-
tering of the low-frequency even voltage harmonics of the ac line frequency is not necessary. The filter 
can be characterized by a comer frequency f0 , characteristic impedance R0, and Q-factor, where 
(17.5) 

614 
Line-Commutated Rectifiers 
To obtain good filtering of the EMI, the comer frequency fo should be selected to be sufficiently low. 
However, as can be seen from Eq. (I7.5), reducing the value ofj0 requires increasing the values of L 
and/or C. As described above, it is undesirable to choose either element value too large, because large 
distortion results. So fo should not be too low, and there is a limit to the amount of filtering that can be 
obtained without significantly distorting the ac line current waveform. 
How low canf0 be? Oncef0 is chosen, how should Land C be chosen such that THD is mini-
mized? We might expect that THD is increased when the phase of the filter input impedance - Z;(jw), 
evaluated at the second harmonic of the line frequency or 2fL, differs significantly from o·. When the 
zero crossings of the voltage and current waveforms do not coincide, then diode switching distorts the 
current waveform. To a lesser extent, input impedance phase shift at the higher-order even harmonic fre-
quencies of the ac line frequency should also affect the THD. The input impedance Z;(s) contains two 
zeroes at frequency f0, and a pole at frequency !p = f0/Q. To obtain small phase shift at low frequency,J0 
must be sufficiently large. In addition, Q must be neither too small nor too large: small Q causes the 
zeroes atf0 to introduce low-frequency phase shift, while large Q causes the pole at!p to occur at low fre-
quency. 
An approximate plot ofTHD vs. the choice ofj0 and Q is given in Fig. I7.5. It can be seen that 
there is an optimum choice for Q: minimum THD occurs when Q lies in the range 0.5 to I. A typical 
waveform is plotted for the choicef0/fL = 10, Q =I, in Fig. I7.6. The THD for this waveform is 3.6%, 
and the distortion factor is 99.97%. 
Small Q corresponds to CCM operation, with large L and small C. In the extreme case as 
Q -+ 0, the ac line current tends to a square wave with THD = 48%. Large Q corresponds to DCM opera-
tion, with small L and large C. In the extreme case as Q -+ oo, the ac line current tends to a string of delta 
functions with THD-+ oo, The optimum choice of Q leads to operation near the CCM-DCM boundary, 
such that the ac line current waveform contains neither step changes nor subintervals of zero current. 
In the case when the load resistance R varies over a wide range of values, it may be difficult to 
optimize the circuit such that low THD is always obtained. It can be seen that increasing f0/ft leads to 
low THD for a wider range of load resistance. For example, whenf0 = 5fv THD :o; 10% can be obtained 
only for Q between approximately 0.6 and 1.5, which is a 2.5: I range of load resistance variations. If the 
50 
10 
10 
folft 
THD=30%! 
THD=lO% 
THD=3% 
THD=l% 
THD=0.5% 
100 
Fig. 17.5 Approximate total harmonic distortion of the single-phase diode rectifier with de-side L-C filter. 

17.2 
The Three-Phase Bridge Rectifier 
615 
THD=3.6% 
Fig. 17.6 Typical ac line current and voltage waveforms, near the boundary between continuous and discontinu-
ous modes and with small de filter capacitor.f0ifL = 10, Q = 1. 
filter cutoff frequency f0 is increased to 20fv then THD :<::: 10% is obtained for Q between approximately 
0.15 and 7, or nearly a 50:1 range of resistance variations. In most cases, maximum harmonic limits are 
enforced only at full load, and hence it is possible to design with relatively low values off0/fL if desired. 
17.2 
THE THREE-PHASE BRIDGE RECTIFIER 
A basic full-wave three-phase uncontrolled rectifier with LC output filter is shown in Fig. 17 .7. Its behav-
ior is similar to the single-phase case, in that it exhibits both continuous and discontinuous conduction 
modes, depending on the values of L and C. The rectifier generates odd non-triplen harmonics in the ac 
line current. So the ac line current may contain 1st, 5th, 7th, I 1 th, 13th, etc. harmonics. The de output may 
contain de and even triplen harmonics: 0, 6, 12, 18, etc. 
In the basic circuit of Fig. 17.7, no more than two of the six diodes can conduct during each 
interval, and hence the line current waveforms must contain intervals of nonzero length during which the 
current is zero. Unlike the single-phase case, the ac line current waveform must contain distortion even 
when the filter elements are removed. 
17.2.1 
Continuous Conduction Mode 
In the continuous conduction mode, each ac line current is nonzero for 120 degrees out of each line half-
cycle. For the remaining 60 degrees, the current is zero. This mode occurs when the inductance L is suf-
ia(t) 
iL(t) 
L 
¢a 
+ 
D3 
3¢ 
¢b 
c 
v 
de load 
ac 
R 
¢c 
Fig. 17.7 Basic uncontrolled 30 bridge rectifier circuit, with de-side ~C filter. 

616 
Line-Commutated Rectifiers 
Fig. 17.8 Ac line current waveform ia(t), for the case 
when inductor L is large. The phase is drawn with respect 
to the zero crossing of the line-to-neutral voltage v an(t). 
ficiently large, as well as when the filter elements Land Care removed entirely. 
In the limit, when L is very large, then the current iL(t) is essentially constant. The current in 
phase a, iaCt), is then as shown in Fig. 17 .8. It can be shown that the Fourier series for this waveform is 
ia(t) = n= l.~.ll, n'h I L sin ( ~) sin ( ;n) sin ( ncot) 
(17.6) 
which is similar to the spectrum of the square wave of the single-phase case, but with the trip len harmon-
ics missing. The THD of this waveform is 31%, and the distortion factor is 3/n = 95.5%. As in the case of 
the square wave, the amplitude of the odd nontriplen n1h harmonic is (lin) times the fundamental ampli-
tude. So this waveform contains 20% fifth harmonic, 14% seventh harmonic, 9% eleventh harmonic, etc. 
It is interesting that, in comparison with the square-wave single-phase case, the missing 60° in the three-
phase case improves the THD and power factor, by removing the trip len harmonics. 
With a less-than-infinite value of inductance, the output ripple causes the ac line currents to be 
rounded, as in the typical waveform of Fig. 17.9. This waveform has a 31.9% THD, with a distortion fac-
tor that is not much different from the waveform of Fig. 17 .8. 
THD = 31.9% 
Fig. 17.9 Continuous conduction mode ac line-neutral voltages and phase a current, for a moderate value of 
inductance. 
17.2.2 
Discontinuous Conduction Mode 
If the inductance is further reduced, then the three-phase rectifier enters the discontinuous conduction 
mode. The rectifier then begins to peak-detect, and the current waveforms become narrow pulses of high 
amplitude, occurring near the peaks of the line-line voltages. The phase a line current ia(t) contains two 
positive and two negative pulses, at the positive and negative peaks of the line-line voltages vab(t) and 
v ac(t). As in the single-phase case, the total harmonic distortion becomes quite large in this case, and the 

17.3 
Phase Control 
617 
THD=99.3% 
Fig. 17.10 Discontinuous conduction mode ac line-neutral voltages and phase a current. 
power factor can be significantly degraded. 
A typical waveform is given in Fig. 17.1 0. This waveform has a THD of 99 .3%, and a distortion 
factor of 71%. This would be considered unacceptable in high-power applications, except perhaps at 
light load. 
17.3 
PHASE CONTROL 
There are a wide variety of schemes for controlling the de output of a 3¢ rectifier using thyristors [1,2]. 
The most common one is shown in Fig. 17.11, in which the six diodes of Fig. 17.7 are replaced by silicon 
controlled rectifiers (SCRs). Typical waveforms are given in Fig. 17.12, for large de-side filter induc-
tance. 
If Q 1 were an uncontrolled diode, it would conduct whenever the line-to-line voltage v ab or v ac is 
the largest in magnitude of the six line-line voltages vab' vbc• vca' vba' vcb' and vca· This occurs for 120' of 
each cycle, beginning at the point where vab = vcb· In Fig. 17.12, this occurs at wt = 60'. The output volt-
age of the controlled rectifier is controlled by delaying the firing of Q 1 by an angle a, such that Q 1 begins 
conducting at wt = 60' + a. This has the effect of reducing the de output voltage. 
There can be no de component of voltage across inductor L. Hence, in steady-state, the de com-
ponent of the rectifier output voltage vR(t) must equal the de load voltage V. But vR(t) is periodic, with 
period equal to six times the ac line period (or 60'). So the de component of vR(t) can be found by Fou-
rier analysis, and is equal to the average value of vR(t). Over one 60' interval, for example 
(60' +a):::; wt:::; (120' +a), vR(t) follows the line-line voltage vab(t) = 3Vm sin (wt + 30'). The average is 
therefore 
L 
3¢ 
ac 
¢c 
Fig. 17.11 Basic controlled 3¢ bridge rectifier circuit, with de-side L-C filter. 
+ 
v 
de load 
R 

618 
Line-Commutated Rectifiers 
Fig. 
17.12 Waveforms for the 
controlled rectifier of Fig. 17.11, 
with large de filter inductance. 
Upper thyristor: 
Lower thyristor: 
Q3 
: 
Ql 
: 
Q5 
: 
Qs 
: 
Ql 
Q2 
: 
Q2 
: 
Q3 
: 
Q6 
Q6 
: 
Q4 
Q4 
(17.7) 
where VL-L, rms is the rms line-to-line voltage. This equation is plotted in Fig. 17.13. It can be seen that, if 
it is necessary to reduce the de output voltage to values close to zero, then the delay angle a must be 
Fig. 17.13 Variation of the de output 
voltage V with delay angle a, for the 
phase-controlled circuit of Fig. 17 .11. 
_v_ 1.5 
V L-L,rms 
0 
30 
+---~ 
Rectification I Inversion 
60 
90 
120 
150 
180 
a, degrees 

17.3 
Phase Control 
619 
increased to close to 90'. With a small inductance, the controlled rectifier can also operate in discontinu-
ous conduction mode, with modified output voltage characteristics. 
17.3.1 
Inverter Mode 
If the de load is capable of supplying power, then it is possible for the direction of power flow to reverse. 
For example, consider the three-phase controlled rectifier circuit of Fig. 17.14. The resistive load is 
replaced by a voltage source and thevenin-equivalent resistance, capable of either supplying or consum-
ing power. The de load power is equal to Vlv which is positive (rectifier mode) when both V and IL are 
positive. The thyristor .is a unidirectional-current switch, which cannot conduct negative current, and 
hence IL must always be positive. However, it is possible to cause the output voltage V to be negative, by 
increasing the delay angle a. The de load power VIL then becomes a negative quantity (inverter mode), 
meaning that power flows from the de load into the 3¢ac system. 
Provided that the de-side filter inductance Lis sufficiently large, then Eq. (17.7) is valid even 
when the delay angle a is greater than 90'. It can be seen in Fig. 17.13 that the de output voltage V 
becomes negative for a> 90', and hence the power flow indeed reverses. Delay angles approaching 180' 
are possible, with the maximum angle limited by commutation of the thyristor devices. 
17.3.2 
Harmonics and Power Factor 
Let us next consider the harmonic content and power factor of the phase-controlled rectifier with large 
inductance. Comparison of the line current waveform of Fig. 17.12 with that of the uncontrolled rectifier 
(Fig. 17 .8) reveals that the waveshapes are identical. The only difference is the phase lag a present in the 
phase-controlled rectifier. This has the effect of shifting the fundamental component of current (and the 
harmonics as well) by angle a. The Fourier series is therefore 
(17.8) 
Hence the harmonic amplitudes are the same (the fifth harmonic amplitude is 20% of the fundamental, 
etc.), the THD is again 31%, and the distortion factor is again 95.5%. But there is phase lag in the funda-
mental component of current, which leads to a displacement factor of cos(a). The power factor is there-
fore 
3¢ 
ac 
¢c 
L 
Fig. 17.14 If the load is capable of supplying power, then the 3¢ bridge circuit functions as an inverter for V < 0 
and a:> 90'. 

620 
Line-Commutated Rectifiers 
Fig. 17.15 Fundamental component complex power diagram 
for the 311! bridge circuit operating in rectifier mode. 
Q 
II s II sin a 
II Sll cos a 
P 
power factor= 0.9551 cos (a) I 
( 17.9) 
which can be quite low when the de output voltage Vis low. 
It is at first somewhat puzzling that the introduction of phase control can cause the fundamental 
current to lag the voltage. Apparently, the rectifier consumes reactive power equal to 
Q=f3 la,rmsVL-L,rmssina=lL 3{1 VL-L,rmssina 
(17.10) 
We normally associate lagging current and the consumption of reactive power with inductive energy 
storage. But this is not what is happening in the rectifier; indeed, the inductor and capacitor can be 
removed entirely from the rectifier circuit, and a lagging fundamental current is still obtained by phase 
control. It is simply the delay of the switching of the rectifiers that causes the current to lag, and no 
energy storage is involved. So two mechanisms cause the phase-controlled rectifier to operate with low 
power factor: the lagging fundamental component of current, and the generation of current harmonics. 
Equation (17.10) can be further interpreted. Note that the de output power Pis equal to the de 
inductor current IL times the de output voltage V. By use of Eq. (17.7), this can be written 
312 
p =I L --n VL-L, rms cos a 
(17.11) 
Comparison of Eqs. (17.10) and (17.11) reveals that the rectifier fundamental volt-amperes can be 
expressed using the conventional concepts of complex powerS= P + jQ, where Pis the real (average) 
power consumed and Q is the fundamental reactive power consumed. The complex power phasor dia-
gram, treating the fundamental components only, is illustrated in Fig. 17.15. 
17.3.3 
Commutation 
Let's consider next what happens during the switching transitions. In the phase-controlled rectifier circuit 
of Fig. 17 .16, the de-side inductor Ld is large in value, such that its current ripple is negligible. Inductors 
La, Lb, and Lc are also present in the ac lines; these may be physical inductors of the rectifier circuit, or 
they may represent the source impedance of the power system, typically the leakage inductances of a 
nearby transformer. These inductors are relatively small in value. 
Consider the switching transition illustrated in Fig. 17.17. Thyristors Q3 and Q5 initially con-
duct. At time tel, thyristor Q1 is gated on, and the de current iL begins to shift from Q3 to Q1• The ac line 
currents ia(t) and ic(t) cannot be discontinuous, since inductors La and Lc are present in the lines. So dur-

17.3 Phase Control 
621 
Fig. 17.16 Controlled 30 rectifier circuit, with small ac-side inductances. 
ing the interval tc1 < t < tcz• thyristors Q1 and Q3 both conduct, and the voltage vac' is zero. Voltage is 
applied across inductors La and Lc, causing their currents to change; for successful commutation, suffi-
cient volt-seconds must be applied to cause the currents to change from iL to zero, and vice versa. Any 
stored charge that remains in thyristor Q3 when current i/t) reaches zero must also be removed, and 
hence ic(t) actually continues negative as discussed in Chapter 4. When the reverse recovery process of 
Q3 is complete, then Q3 is finally in the off-state, and the next subinterval begins with the conduction of 
thyristors Q1 and Q5• 
The commutation process described above has several effects on the converter behavior. First, it 
can be seen that the thyristor bridge de-side voltage v it) is reduced in value during the commutation 
interval. Hence, its average value ( v d) and the de output voltage V are reduced. The amount of reduction 
is dependent on the de load current: a larger de load current leads to a longer commutation interval, and 
hence to a greater reduction in ( v d). So the rectifier has an effective output resistance. Second, the maxi-
mum value of the delay angle a is limited to some value less than 180°. If a exceeds this limit, then 
insufficient volt-seconds are available to change inductor current ic(t) from iL to zero, leading to commu-
tation failure. Third, when the rectifier ac-side inductors are small or zero, so that La, Lb, and Lc represent 
Fig. 
17.17 
Switching transition waveforms, 
for the rectifier of Fig. 17 .16. 
:Q3: 
Qli 
Conducting 
Q3 
Ql 
Ql 
thyristors: 
~ 
Q6: 
Q5 
Q5 
Q5. 
Q6 
i.(t) 1 
iL 
0 
I' 
i/<) 1 
iL 
hl 
01 
'I 

622 
Line-Commutated Rectifiers 
Fig. 17.18 Notching of the ac line-line 
voltage waveforms during the commutation 
intervals. 
essentially only the power system source impedance, then commutation causes significant notching of 
the ac voltage waveforms (Fig. 17 .18) at the point of common coupling of the rectifier to the power sys-
tem. Other elements connected locally to the power system will experience voltage distortion. Limits for 
the areas of these notches are suggested in IEEE/ ANSI standard 519. 
17.4 
HARMONIC TRAP FILTERS 
Passive filters are often employed to reduce the current harmonics generated by rectifiers, such that har-
monic limits are met. The filter network is designed to pass the fundamental and to attenuate the signifi-
cant harmonics such as the fifth, seventh, and perhaps several higher-order odd nontriplen harmonics. 
Such filters are constructed using resonant tank circuits tuned to the harmonic frequencies. These net-
works are most commonly employed in balanced three-phase systems. A schematic diagram of one 
phase of the filter is given in Fig. 17.19. 
The ac power system is modeled by the thevenin-equivalent network containing voltage source 
vs and impedance Z/. Impedance Z/ is usually inductive in nature, although resonances may occur due to 
nearby power-factor-correction capacitors. In most filter networks, a series inductor L,' is employed; the 
filter is then called a harmonic trap filter. For purposes of analysis, the series inductor L/ can be lumped 
into Z,', as follows: 
Z,(s) = Z,'(s) + sL,' 
(17.12) 
The rectifier and its current harmonics are modeled by current source ir. Shunt impedances Z1, Z2, ... are 
ac source 
model 
Harmonic traps 
(series resonant networks) 
Fig. 17.19 A harmonic trap filter. One phase is illustrated, on a line-to-neutral basis. 
Rectifier 
model 

17.4 Harmonic Trap Filters 
623 
tuned such that they have low impedance at the harmonic frequencies, and hence the harmonic currents 
tend to flow through the shunt impedances rather than into the ac power system. 
The approximate algebra-on-the-graph method described in Chapter 8 is used here to construct 
the filter transfer function, in terms of impedance Zs and the shunt impedances Z1, Z2 , .... This approach 
yields a simple intuitive understanding of how the filter operates. Since the harmonic frequencies are 
close in value, the pole and zero frequencies of the filter are never well separated in value. So the approx-
imate algebra-on-the-graph method is, in general, not sufficiently accurate for the complete design of 
these filters, and the pole frequencies must be found by numerical methods. A typical design approach 
might involve estimating element values using the algebra-on-the-graph method, then refining the values 
using a computer simulation package. 
The filter transfer function H(s) is given by the current divider ratio 
(17.13) 
As discussed in Chapter 8, another way to write this transfer function is 
(17.14) 
So we can construct H(s) by first constructing the parallel combination Zs II Z1 II Z2 II ... , then dividing by 
the total line impedance Zs. It can be shown that, if Z,(s) contains no poles, then the numerator of H(s) is 
the product of the zeroes of the shunt impedances Z1, Z2, .... So this graphical method yields the exact 
zeroes of H(s), which coincide with the series resonances of the shunt impedances. But the poles of H(s), 
which arise from parallel resonances in the filter, require more work to compute. 
Let us first consider the simple case illustrated in Fig. 17 .20, where Z1 consists of a series reso-
nant circuit tuned to eliminate the fifth harmonic, and Zs is composed of a single inductor Ls. Construc-
tion of the impedance of a series resonant network is described in Chapter 8. The II Z1 II asymptotes 
follow the capacitor impedance magnitude l!wC1 at low frequency, and the inductor impedance magni-
tude wL1 at high frequency. At the resonant frequency, II Z1 II is equal to R1• The asymptotes for II Z1 II are 
constructed in Fig. 17.2l(a). 
Figure 17.2l(a) also illustrates the impedance magnitude II Zs II= wLs, as well as construction of 
Fig. 17.20 Simple harmonic trap filter example, contain-
ing a series resonant trap tuned to the fifth harmonic, and 
inductive line impedance. 
l Fifth-harmonic l 
! 
trapZ1 
1 
~--... ··-------------------·-· .. .l 
t i, 

624 
Line-Commutated Rectifiers 
(a) 
(b) 
Rot=~ 
Q _Rot 
t- Rt 
Rl 
_L_t_ 
Lt +L, 
Fig. 17.21 
Construction of approximate frequency response using the algebra-on-the-graph method: (a) imped-
ance asymptotes, (b) transfer function asymptotes II H 11. 
the approximate asymptotes for the parallel combination (Zs II Z1). Recall that, to construct the approxi-
mate asymptotes for the parallel combination, we simply select the smaller of the Z8 and Z1 asymptotes. 
The result is the shaded set of asymptotes shown in the figure: the parallel combination follows WL8 at 
low frequency, and II Z1 II at high frequency. Note that, in addition to the intended series resonance at fre-
quency / 1, a parallel resonance occurs at frequency fp· 
The filter transfer function II H(s) II is now constructed using Eq. (17.14). As illustrated in Fig. 
17.2l(b), II H(s) II= 1 at low frequencies where both the numerator and the denominator of Eq. (17.14) 
are equal to WL8 • The parallel resonance at frequency fp leads to resonant poles and peaking in II H(s) 11. 
The resonance at frequency f 1 leads to resonant zeroes and attenuation in II H(s) 11. At high frequency, the 
gain is L1/(L1 + L8 ). 
So if we want to attenuate fifth harmonic currents, we should choose the element values such 
that the series resonant frequency / 1 coincides with the fifth harmonic frequency. This frequency is sim-

17.4 Harmonic Trap Filters 
625 
(a) 
(b) 
(c) 
Fig. 17.22 
Construction of approximate frequency response for a harmonic trap filter that attenuates the fifth, 
seventh, and eleventh harmonics: (a) impedance asymptotes, (b) transfer function asymptotes. 
ply the resonant frequency of the shunt impedance 2 1, or 
(J)l 
1 
fi = 2n = 2n~ 
1 1 
(17.15) 

626 
Line-Commutated Rectifiers 
In addition, care must be exercised regarding the parallel resonance. Since no three-phase system is 
exactly balanced, small amounts of third harmonic currents always occur. These currents usually have 
negligible effect; however, the parallel resonance of the harmonic trap filter can increase their magni-
tudes significantly. Even worse, the Q-factor of the parallel resonance, QP, is greater than the series-reso-
nance Q-factor Q1• 
The filter circuit of Fig. 17.20 is simple enough that an exact analysis can be performed easily. 
The exact transfer function is 
(17.16) 
where 
The resonant zeroes do indeed appear at the series resonant frequency, while the parallel resonance and 
its associated resonant poles appear at frequency !p determined by the series combination of L1 and LP. 
To attenuate several harmonics-for example, the fifth, seventh, and eleventh-series resonant 
networks can be tuned to provide resonant zeroes at each. A circuit is given in Fig. 17.22(a), with the 
impedance asymptotes of Fig. 17.22(b). The resulting approximate II H(s) II is given in Fig. 17.22(c). It 
can be seen that, associated with each series resonance is a parallel resonance. Each parallel resonant fre-
quency should be chosen such that it is not significantly excited by harmonics present in the network. 
The filter transfer function can be given high-frequency single-pole rolloff by addition of a 
bypass resistor Rbp' as illustrated in Fig. 17.23(a). Typical impedance and transfer function asymptotes 
for this network are constructed in Fig. 17 .24. The bypass resistor allows some additional attenuation of 
the higher-order harmonics, without need for series resonant traps tuned to each harmonic. The network 
of Fig. 17.23(a) is sometimes called a "high pass" network, because it allows high-frequency currents to 
flow through the shunt branch. But it causes the overall filter transfer function H(s) to reject high fre-
quencies. A simple harmonic trap filter that contains series resonances that can be tuned to the fifth and 
Fig. 17.23 
Addition of bypass resistor Rbp to a 
series resonant network, to obtain a high-frequency 
rolloff characteristic: (a) basic circuit, (b) addition 
of blocking capacitor Cb to reduce power consump-
tion at the fundamental frequency. 
(a) 
(b) 

17.4 Harmonic Trap Filters 
627 
(a) 
(b) 
Fig. 17.24 
Construction of approximate frequency response for a harmonic trap filter containing bypass resistor: 
(a) impedance asymptotes, (b) transfer function asymptotes. 
seventh harmonics, with a single-pole rolloff to attenuate higher-order harmonics such as the eleventh 
and thirteenth, is illustrated in Fig. 17.25. 
Power loss in the bypass resistor can be an issue: since Rbp is not part of the resonant network, 
significant fundamental (50 Hz or 60 Hz) currents can flow through Rhp' The power loss can be reduced 
by addition of blocking capacitor Cb as illustrated in Fig. 17.23(b). This capacitor is chosen to increase 
the impedance of the Rbp -Cb leg at the fundamental frequency, but have negligible effect at the higher-
Fig. 17.25 A harmonic trap filter containing series 
resonances tuned to the fifth and seventh harmonics, 
and high-frequency roll off characteristic. 
Rs 
R? 
Ls 
L? 
cb 
Cs I 
c7 I 
Fifth-harmonic!! Seventh-harmonic 
trap 
! j trap with high-
! ! frequency rolloff 
:. ............................... : :. ....................................... : 

628 
Line-Commutated Rectifiers 
order harmonic frequencies. 
The harmonic trap filter network can also supply significant reactive power to the rectifier and 
power system. As given by Eq. (17.10), the rectifier fundamental current lags the voltage, and the recti-
fier consumes reactive power. As seen in Fig. 17 .22(a), the impedances of the series resonant tank net-
works are dominated by their capacitor asymptotes at low frequency. Hence, at the fundamental 
frequency, the filter impedance reduces to an equivalent capacitor, equal to the parallel combination of 
the tank capacitors. The current through this capacitance leads the ac line voltage, and hence as men-
tioned in the previous chapter, the capacitor is a source of reactive power. 
17.5 
TRANSFORMER CONNECTIONS 
A final conventional approach to reducing the input harmonics of three-phase rectifiers is the use of 
phase-shifting transformer circuits. With these schemes, the low-order harmonics, such as the fifth and 
seventh, can be eliminated. The remaining harmonics are smaller in magnitude, and also are easier to fil-
ter. 
The rectifier circuit of Fig. 17.7 is known as a six-pulse rectifier because the diode output volt-
age waveform contains six pulses per ac line period. The output voltage ripple has a fundamental fre-
quency that is six times the ac line frequency. As illustrated in Fig. 17 .8, the ac line current waveforms 
contain three steps: at any given instant, ia(t) is equal to either iL, 0, or- iL. The spectrum of the current 
waveform contains fundamental and odd nontriplen harmonics (1, 5, 7, 11, 13, ... ), whose amplitudes 
vary as lin. 
It is possible to shift the phase of the ac line voltage using three-phase transformer circuits. For 
example, in the delta-wye transformer circuit of Fig. 17 .26, the transformer primary windings are driven 
by the primary-side line-to-line voltages, while the transformer secondaries supply the secondary-side 
line-to-neutral voltages. In an ideal transformer, the secondary voltage is equal to the primary voltage 
multiplied by the turns ratio; hence, the phasor representing the secondary voltage is in phase with the 
Fig. 17.26 Three-phase delta-wye trans-
former connection: (a) circuit, (b) voltage 
phasor diagram. 
(a) 
(b) 
Primary voltages 
13: n 
a' 
a' 
b' 
Secondary voltages 

17.5 Transformer Connections 
629 
(a) 
a 
L 
3¢ac 
b 
source ---r+---, 
c 
(b) 
Wt 
360" 
Fig. 17.27 
Twelve-pulse rectifier: (a) circuit, (b) input phase a current waveforms. 
primary voltage phasor, and is scaled in magnitude by the turns ratio. So in the delta-wye transformer 
connection, the secondary line-to-neutral voltages are in phase with the primary line-to-line voltages. In 
a balanced three-phase system, the line-to-line voltages are shifted in phase by 30' with respect to the 
line-to-neutral voltages, and are increased in magnitude by a factor of J3 . Hence the secondary line-to-
neutral voltages lag the primary line-to-neutral voltages by 30'. The wye-delta connection is also com-
monly used; this circuit causes the secondary voltages to lead the primary voltages by 30'. Many other 
more complicated transformer circuits are known, such as the zig-zag, forked-wye, and extended-delta 
connections, which can lead to phase shifts of any desired amount. 
The 30' phase shift of the delta-wye transformer circuit is used to advantage in the twelve-pulse 
rectifier circuit of Fig. 17.27(a). This circuit consists of two bridge rectifier circuits driven by 3¢ voltages 

63() 
Line-Commutated Rectifiers 
that differ in phase by 30°. The bridge rectifier outputs are connected in series to the de filter inductor and 
load. The total rectifier output voltage v it) has a fundamental frequency that is twelve times the ac line 
frequency. The input phase a ac line current ia(t) is the sum of currents in three windings, and has the 
stepped waveshape illustrated in Fig. 17.27 (b). It can be shown that this waveform contains Fourier com-
ponents at the fundamental frequency and at the 11th, 13th, 23'd, 25th, ... harmonic frequencies, whose 
amplitudes vary as lin. Doing so is left as a homework problem. Thus, the twelve-pulse rectifier elimi-
nates the sth, 7th, 17th, 19th, ... harmonics. 
An eighteen-pulse rectifier can be constructed using three six -pulse bridge rectifiers, with trans-
former circuits that shift the applied voltages by 0°, + 20°, and -20°. A twenty-four pulse rectifier 
requires four six-pulse bridge rectifiers, fed by voltages shifted by 0°, + 15°,- IY, and 30°. If pis the 
pulse number, then the rectifier produces line current harmonics of number n = pk ± 1, where k = 0, 1, 2, 
3, .... If the de current ripple can be neglected, then the magnitudes of the remaining current harmonics 
vary as lin. The de-side harmonics are of number pk. 
So by use of polyphase transformer connections and rectifier circuits having high pulse number, 
quite good ac line current waveforms can be obtained. As the pulse number is increased, the current 
waveforms approaches a sinusoid, and contains a greater number of steps having smaller amplitude. The 
low-order harmonics can be eliminated, and the remaining high-frequency harmonics are easily filtered. 
17.6 
SUMMARY 
1. 
With a large de filter inductor, the single-phase full-wave rectifier produces a square-wave line current 
waveform, attaining a power factor of 90% and 48% THD. With smaller values of inductance, these fig-
ures are degraded. In the discontinuous conduction mode, THD greater than 100%, with power factors of 
55% to 65% are typical. When the capacitance is large, the power factor, THD, displacement factor, and 
conversion ratio can be expressed as a function of only the dimensionless parameter KL' 
2. 
In the three-phase case, the bridge rectifier with large de filter inductor produces a stepped waveform sim-
ilar to the square wave, but missing the triplen harmonics. This waveform has 31% THD, and leads to a 
power factor of 95.5%. Reduced de inductor values again lead to increased THD and reduced power factor, 
and as L tends to zero, the THD tends to infinity while the power factor tends to zero. In practice, the min-
imum effective series inductance is limited by the power system source inductance. 
3. 
With a large de inductor, phase control does not influence the distortion factor or THD, but does lead to a 
lagging fundamental current and decreased displacement factor. Phase-controlled rectifiers and inverters 
are consumers of reactive power. 
4. 
If the load is capable of supplying power, then the phase-controlled rectifier can become an inverter. The 
delay angle a is greater than 90°, and the output voltage polarity is reversed with respect to rectifier opera-
tion. The maximum delay angle is limited by commutation failure to a value less than 180°. 
5. 
Harmonic trap filters and multipulse-rectifier/polyphase transformer circuits find application in high-
power applications where their large size and weight are less of a consideration than their low cost. In the 
harmonic trap filter, series resonant tank circuits are tuned to the offending harmonic frequencies, and 
shunt the harmonic currents away from the utility power network. Parallel resonances may cause 
unwanted peaks in the filter transfer function. Operation of these filters may be understood using the alge-
bra-on-the-graph method, and computer simulations can be used to refine the accuracy of the analysis or 
design. Rectifiers of higher pulse number can also yield improved current waveforms, whose harmonics 
are of high frequency and small amplitude, and are easily filtered. 

References 
631 
REFERENCES 
[1] 
G.K. DUBEY, S.R. DORADLA, A. JOSHI, and R.M.K. SINHA, Thyristorized Power Controllers, New Delhi: 
Wiley Eastern, Ltd., 1986. 
[2] 
J. VITHAYATHIL, Power Electronics: Principles and Applications, New York: McGraw-Hill, 1995. 
[3] 
N. MOHAN, T. UNDELAND, and W. ROBBINS, Power Electronics: Converters, Applications, and Design, 
Second edition, New York: John Wiley & Sons, 1995. 
[4] 
J. PHIPPS, "Phase-Shifting Transformers and Passive Harmonic Filters: Interfacing for Power Electronic 
Motor Drive Controllers," M.S. Thesis, University of Colorado at Denver, 1993. 
[5] 
J. KASSAKIAN, M. SCHLECHT, and G. VERGESE, Principles of Power Electronics, Massachusetts: Addison-
Wesley, 1991. 
[6] 
J. ARRILLAGA, D. BRADLEY, and P. BODGER, Power System Harmonics, New York: John Wiley & Sons, 
1985. 
[7] 
A. DOMIJAN and E. EMBRIZ-SANTANDER, "A Summary and Evaluation of Recent Developments on Har-
monic Mitigation Techniques Useful to Adjustable-Speed Drives," IEEE Transactions on Energy Conver-
sion, Vol. 7, No.1, pp. 64-71, March 1992. 
[8] 
S. FREELAND, "I. A Unified Analysis of Converters with Resonant Switches, II. Input-Current Shaping for 
Single-Phase Ac-dc Power Converters," Ph.D. Thesis, California Institute of Technology, 1988, Chapter 
12. 
[9] 
F. C. SCHWARZ, "A Time-Domain Analysis of the Power Factor for Rectifier Systems with Over- and Sub-
critical Inductance," IEEE Transactions on Industrial Electronics and Control Instrumentation, Vol. 20, 
No.2, May 1973, pp. 61-68. 
[10] 
S. B. DEWAN, "Optimum Input and Output Filters for Single-Phase Rectifier Power Supply," IEEE Trans-
actions on Industry Applications, Vol. 17, No.3, May/June 1981, pp. 282-288. 
[11] 
A. KELLEY and W. F. YADUSKY, "Rectifier Design for Minimum Line-Current Harmonics and Maximum 
Power Factor," IEEE Transactions on Power Electronics, Vol. 7, No.2, April1992, pp. 332-341. 
[12] 
A. W. KELLEY and W. F. YADUSKY, "Phase-Controlled Rectifier Line-Current Harmonics and Power Fac-
tor as a Function of Firing Angle and Output Filter Inductance," IEEE Applied Power Electronics Confer-
ence, 1990 Proceedings, March 1990, pp. 588-597. 
[13] 
P. C. SEN, Thyristorized DC Drives, New York: Wiley Interscience, 1981. 
[14] 
S. DEWAN AND A. STRAUGHEN, Power Semiconductor Circuits, New York: John Wiley & Sons, 1975. 
[15] 
B. PELLY, Thyristor Phase-Controlled Converters and Cycloconverters: Operation, Control, and Perfor-
mance, New York: John Wiley & Sons, 1971. 

632 
Line-Commutated Rectifiers 
PROBLEMS 
17.1 
The half-controlled single-phase rectifier circuit of Fig. 17.28 contains a large inductor L, whose current 
iL(t) contains negligible ripple. The thyristor delay angle is a. 
i.(t) 
iL(t) 
L 
+ 
+ 
Dl 
vd(t) 
c 
v 
de load 
R 
D2 
Fig. 17.28 Half-controlled rectifier circuit of Problem 17.1. 
(a) 
Sketch the waveforms v it) and i.(t). Label the conduction intervals of each thyristor and diode. 
(b) 
Derive an expression for the de output voltage V, as a function of the rms line-line voltage and 
the delay angle. 
(c) 
Derive an expression for the power factor. 
(d) 
Over what range of a are your expressions of parts (b) and (c) valid? 
17.2 
The half-controlled rectifier circuit of Fig. 17.29 contains a large inductor L, whose current iL(t) contains 
negligible ripple. The thyristor delay angle is a. 
L 
¢c 
+ 
v 
de load 
R 
Fig. 17.29 Three-phase half-controlled rectifier circuit of Problem 17 .2. 
(a) 
Sketch the waveforms v d(t) and i.(t). Label the conduction intervals of each thyristor and diode. 
(b) 
Derive an expression for the de output voltage V, as a function of the rms line-line voltage and 
the delay angle. 
(c) 
Derive an expression for the power factor. 
(d) 
Over what range of a are your expressions of parts (b) and (c) valid? 
17.3 
A 3!il SCR bridge is connected directly to a resistive load, as illustrated in Fig. 17.30. This circuit oper-
ates in the continuous conduction mode for small delay angle a, and in the discontinuous conduction 
mode for sufficiently large a. 
+ 
v(t) 
¢c 
Fig. 17.30 Three-phase controlled rectifier circuit of Problem 17.3. 
de load 
R 

Problems 
633 
(a) 
Sketch the output voltage waveform v(t), for CCM operation and for DCM operation. Clearly 
label the conduction intervals of each SCR. 
(b) 
Under what conditions does the rectifier operate in CCM? in DCM? 
(c) 
Derive an expression for the de component of the output voltage in CCM. 
(d) 
Repeat part (c), for DCM operation. 
17.4 
A rectifier is connected to the 60 Hz utility system. It is desired to design a harmonic trap filter that has 
negligible attenuation or amplification of 60 Hz currents, but which attenuates both the fifth- and sev-
enth-harmonic currents by a factor of 10 (- 20 dB). The ac line inductance Ls is 500 JLH. 
(a) 
Select L5, the inductance of the fifth harmonic trap, equal to 500 JLH, and~. the inductance of 
the seventh harmonic trap, equal to 250 JLH. Compute first-pass values for the resistor and capac-
itor values of the fifth and seventh harmonic trap circuits, neglecting the effects of parallel reso-
nance. 
(b) 
Plot the frequency response of your filter. It is suggested that you do this using SPICE or a simi-
lar computer program. Does your filter meet the attenuation specifications? Are there significant 
parallel resonances? What is the gain or attenuation at the third harmonic frequency? 
(c) 
Modify your element values, to obtain the best design you can. You must choose Ls = 500 JLH, 
but you may change all other element values. Plot the frequency response of your improved fil-
ter. "Best" means that the 20 dB attenuations are obtained at the fifth and seventh harmonic fre-
quencies, that the gain at 60 Hz is essentially 0 dB, and that the Q-factors of parallel resonances 
are minimized. 
17.5 
A rectifier is connected to the 50 Hz utility system. It is desired to design a harmonic trap filter that has 
negligible attenuation or amplification of 50 Hz currents, but that attenuates the fifth-, seventh-, and 
eleventh-harmonic currents by a factor of 5 (- 14 dB). In addition, the filter must contain a single-pole 
response that attenuates the thirteenth and higher harmonics by a factor of 5nl13, where n is the har-
monic number. The ac line inductance Ls is 100 JLH. 
Design a harmonic trap filter that meets these specifications. Design the best filter you can, 
which meets the attenuation specifications, that has nearly unity (0 dB ± 1 dB) gain at 50 Hz, and that 
has minimum gains at the third and ninth harmonics. Plot the frequency response of your filter, and spec-
ify your circuit element values. 
17.6 
A single-phase rectifier operates from a 230 Vrms 50 Hz European single-phase source. The rectifier 
must supply a 1000 W de load, and must meet the IEC-1000 class A or class D harmonic current limits. 
The circuit of Fig. 17.1 is to be used. The de load voltage may have 100Hz ripple whose peak-to-peak 
amplitude is no greater than 5% of the de voltage component. 
(a) 
Estimate the minimum value of inductance that will meet these requirements. 
(b) 
Specify values of L and C that meet these requirements, and prove (by simulation) that your 
design is correct. 
17.7 
Figure 17.31 illustrates a twelve-pulse rectifier, containing six controlled (SCR) devices and six uncon-
trolled (diode) devices. The de filter inductance L is large, such that its current ripple is negligible. The 
SCRs operate with delay angle a. The SCR bridge is driven by a wye-wye connected three-phase trans-
former circuit, while the diode bridge is driven by a wye-delta connected three-phase transformer circuit. 
Since both transformer circuits have wye-connected primaries, they can be combined to realize the cir-
cuit with a single wye-connected primary. 
(a) 
Determine the rms magnitudes and phases of the line-to-line output voltages of the transformer 
secondaries val'bl' and va2'b2,, as a function of the applied line-line primary voltage vab· 
(b) 
Sketch the waveforms of the voltages vd1(t) and vd2(t). Label the conduction intervals of each 
thyristor and diode. 

634 
Line-Commutated Rectifiers 
3¢ac 
source 
I: 13 n 
+ 
de 
load 
Fig. 17.31 
Twelve-pulse rectifier circuit, with one controlled and one uncontrolled bridge, Problem 
17.7. 
(c) 
Derive an expression for the de component of the output voltage, as a function of the rms line-
line input voltage, the delay angle a, and the turns ration. 
(d) 
Over what range of a is your expression of part (c) valid? What output voltages can be produced 
by this rectifier? 
17.8 
For the twelve-pulse rectifier circuit of Fig. 17.27(a), determine the Fourier coefficients, for the funda-
mental through the thirteenth harmonic, ofthe primary-side currents ia1(t) and ia2(t), as well as for the ac 
line current ia(t). Express your results in terms of the turns ratio n and the de load current IL" You may 
assume that the de filter inductance L is large and that the transformers are ideal. 
17.9 
The single-phase controlled-bridge rectifier of Fig. 17.32 operates in the continuous conduction mode. It 
is desired to regulate the load voltage v(t) in the presence of slow variations in the amplitude of the sinu-
soidal input voltage vgCt). Hence, a controller must be designed that varies the delay angle a such that 
v(t) is kept constant, and it is of interest to derive a small-signal ac model for the de side of the rectifier 
circuit. 
Fig. 17.32 
Single-phase controlled rectifier, Problem 17.9. 
(a) 
Sketch v,(t) and vgCt), and label the delay angle a. 
+ 
v(t) 
de load 
R 
(b) 
Use the circuit averaging method to determine the small-signal transfer functions 
v(s) 
control-to-output transfer function 
&.(s) 
and 

il(s) 
line-to-output transfer function 
vg(s) 
as well as the steady-state relationship 
where 
a(t) =A + a(t) 
v(t) = v + v(t) 
vg(t) = ( Vg + vg(t)) sin (Wt) 
Problems 
635 
You may assume that the frequencies of the variations in a, v, and v g are much slower that the ac 
line frequency w, and that the inductor current ripple is small. 

18 
Pulse-Width Modulated Rectifiers 
To obtain low ac line current THD, the passive techniques described in the previous chapter rely on low-
frequency transformers and/or reactive elements. The large size and weight of these elements are objec-
tionable in many applications. This chapter covers active techniques that employ converters having 
switching frequencies much greater than the ac line frequency. The reactive elements and transformers of 
these converters are small, because their sizes depend on the converter switching frequency rather than 
the ac line frequency. 
Instead of making do with conventional diode rectifier circuits, and dealing after-the-fact with 
the resulting low-frequency harmonics, let us consider now how to build a rectifier that behaves as ide-
ally as possible, without generation of line current harmonics. In this chapter, the properties of the ideal 
rectifier are explored, and a model is described. The ideal rectifier presents an effective resistive load to 
the ac power line; hence, if the supplied ac voltage is sinusoidal, then the current drawn by the rectifier is 
also sinusoidal and is in phase with the voltage. Converters that approximate the properties of the ideal 
rectifier are sometimes called power factor corrected, because their input power factor is essentially 
unity [1]. 
The boost converter, as well as a variety of other converters, can be controlled such that a near-
ideal rectifier system is obtained. This is accomplished by control of a high-frequency switching con-
verter, such that the ac line current waveform follows the applied ac line voltage. Both single-phase and 
three-phase rectifiers can be constructed using PWM techniques. A typical de power supply system that 
is powered by the single-phase ac utility contains three major power-processing elements. First, a high-
frequency converter with a wide-bandwidth input-current controller functions as a near-ideal rectifier. 
Second, an energy-storage capacitor smooths the pulsating power at the rectifier output, and a low-band-
width controller causes the average input power to follow the power drawn by the load. Finally, a de-de 
converter provides a well-regulated de voltage to the load. In this chapter, single-phase rectifier systems 
are discussed, expressions for rms currents are derived, and various converter approaches are compared. 

638 
Pulse-Width Modulated Rectifiers 
The techniques developed in earlier chapters for modeling and analysis of de-de converters are 
extended in this chapter to treat the analysis, modeling, and control of low-harmonic rectifiers. The CCM 
models of Chapter 3 are used to compute the average losses and efficiency of CCM PWM converters 
operating as rectifiers. The results yield insight that is useful in power stage design. Several converter 
control schemes are known, including peak current programming, average current control, critical con-
duction mode control, and nonlinear carrier control. Ac modeling of the rectifier control system is also 
covered. 
18.1 
PROPERTIES OF THE IDEAL RECTIFIER 
It is desired that the ideal single-phase rectifier present a resistive load to the ac system. The ac line cur-
rent and voltage will then have the same waveshape and will be in phase. Unity power factor rectification 
is the result. Thus, the rectifier input current iac(t) should be proportional to the applied input voltage 
Vac(t): 
(18.1) 
where Re is the constant of proportionality. An equivalent circuit for the ac port of an ideal rectifier is 
therefore an effective resistance Re, as shown in Fig. 18.l(a). Re is also known as the emulated resistance. 
It should be noted that the presence of Re does not imply the generation of heat: the power apparently 
(a) 
(c) 
+ 
ac 
input 
(b) 
Ideal rectifier (LFR) 
i 
vcontrol 
2 
p(t) = V ac /Re 
~ 
+ 
t 
Vcontrol 
i(t) 
+ 
v(t) 
de 
output 
Fig. 18.1 
Development of the ideal rectifier equivalent circuit model: (a) input port resistor emulation; (b) the 
value of the emulated resistance, and hence the power throughput, is controllable; (c) output port power source char-
acteristic, and complete model. 

18.1 
Properties of the Ideal Rectifier 
639 
(a) 
(b) 
(c) 
i(t) 
i(t) 
i(t) 
v(t)i(t) = p(t) 
+ 
+ 
p(t) 
v(t) 
v(t) 
p(t) 
v(t) 
Fig. 18.2 The dependent power source: (a) power source schematic symbol, (b) power sink schematic symbol, 
(c) i-v characteristic. 
"consumed" by Re is actually transferred to the rectifier de output port. Re simply models how the ideal 
rectifier loads the ac power system. 
Output regulation is accomplished by variation of the effective resistance Re, and hence the 
value of Re must depend on a control signal vcontrol(t) as in Fig. 18.l(b). This allows variation of the recti-
fier power throughput, since the average power consumed by Re is 
v2 
p = 
ac,rms 
av 
Re(vcontrol) 
(18.2) 
Note that changing Re results in a time-varying system, with generation of harmonics. To avoid genera-
tion of significant amounts of harmonics and degradation of the power factor, variations in Re and in the 
control input must be slow with respect to the ac line frequency. 
To the extent that the rectifier is lossless and contains negligible internal energy storage, the 
instantaneous power flowing into Re must appear at the rectifier output port. Note that the instantaneous 
power throughput 
(18.3) 
is dependent only on V0 c(t) and the control input vcontrol(t), and is independent of the characteristics of the 
load connected to the output port. Hence, the output port must behave as a source of constant power, 
obeying the relationship 
v2 (t) 
v(t)i(t) = p(t) = R 
e 
(18.4) 
The dependent power source symbol of Fig. 18.2(a) is used to denote such an output characteristic. As 
illustrated in Fig. 18.l(c), the output port is modeled by a power source that is dependent on the instanta-
neous power flowing into Re. 
Thus, a two-port model for the ideal unity-power-factor single-phase rectifier is as shown in Fig. 
18.l(c) [2-4]. The two port model is also called a loss-free resistor (LFR) because (1) its input port obeys 
Ohm's law, and (2) power entering the input port is transferred directly to the output port without loss of 

640 
Pulse-Width Modulated Rectifiers 
energy. The defining equations of the LFR are: 
. ( ) _ 
vacCt) 
lac I -
( 
) 
Re vcontrot 
(18.5) 
v(t)i(t) = p(t) 
(18.6) 
(18.7) 
When the LFR output port is connected to a resistive load of valueR, the de output rms voltages and cur-
rents Vrms and Irnzs are related to the ac input rms voltages and currents Vac,rms and Iac,rms as follows: 
(18.8) 
(18.9) 
The properties of the power source and loss-free resistor network are discussed in Chapter 11. Regard-
less of the specific converter implementation, any single-phase rectifier having near-ideal properties can 
be modeled using the LFR two-port model. 
18.2 
REALIZATION OF A NEAR-IDEAL RECTIFIER 
Feedback can be employed to cause a converter that exhibits controlled de transformer characteristics to 
obey the LFR equations. In the single-phase case, the simplest and least expensive approach employs a 
full-wave diode rectifier network, cascaded by a de-de converter, as in Fig. 18.3. The de-de converter is 
represented by an ideal de transformer, as discussed in Chapter 3. A control network varies the duty 
cycle, as necessary to cause the converter input current igCt) to be proportional to the applied input volt-
de-de converter 
I : M(d(t)) 
i(t) 
+ 
v(t) 
c 
R 
Fig. 18.3 Synthesis of an ideal rectifier by varying the duty cycle of a PWM de-de converter. 

18.2 
Realization of a Near-Ideal Rectifier 
641 
age vgCt) as in Eq. (18.1). The effective turns ratio of the ideal transformer then varies with time. Ideal 
waveforms are illustrated in Fig. 18.4. If the applied input voltage v ac(t) is sinusoidal, 
(18.10) 
vaJt) 
then the rectified voltage v gCt) is 
(18.11) 
It is desired that the converter output voltage be a con-
stant de value v(t) = V. The converter conversion ratio 
· (t) 
1ac 
must therefore be 
(18.12) 
This expression neglects the converter dynamics. As can 
be seen from Fig. 18.4, the controller must cause the 
conversion ratio to vary between infinity (at the ac line 
voltage zero crossings) and some minimum value Mmin 
(at the peaks of the ac line voltage waveform). Mmin is 
given by 
M 
-
V 
min-v 
M 
(18.13) 
Any converter topology whose ideal conversion ratio 
can be varied between these limits can be employed in 
this application. 
To the extent that the de-de converter is ideal 
(i.e., if the losses can be neglected and there is negligible 
low-frequency energy storage), the instantaneous input 
and output powers are equal. Hence, the output current 
i(t) in Fig. 18.3 is given by 
(18.14) 
Substitution of Eq. (18.11) into Eq. (18.14) then leads to 
·c) 
v~ . \ ) 
l t = VRe sm Wt 
v2 
= 2V~e ( 1- cos (2wt)) 
(18.15) 
v(t)l '--___ 
v ____ _ 
M(t)l\lJVV 
Fig. 18.4 
Waveforms of the rectifier system of 
Fig. 18.3. 
Hence, the converter output current contains a de component and a component at the second harmonic of 
the ac line frequency. One of the functions of capacitor C in Fig. 18.3 is to filter out the second harmonic 
component of i(t), so that the load current (flowing through resistor R) is essentially equal to the de com-
ponent 

642 
Pulse-Width Modulated Rectifiers 
(18.16) 
where TL is the period of the applied ac line voltage. 
The average power is 
P= v~ 
2R, 
(18.17) 
The above equations are generally valid for PWM converters used as single-phase low-harmonic rectifi-
ers. 
18.2.1 
CCM Boost Converter 
A system based on the CCM boost converter is illustrated in Fig. 18.5 [1,5,6]. Ideally, the boost converter 
can produce any conversion ratio between one and infinity. Hence, the boost converter is capable of pro-
ducing the M(d(t)) given by Eq. (18.12), provided that V ~ V M· Further, the boost converter can produce 
very low THD, with better transistor utilization than other approaches. 
If the boost converter operates in continuous conduction mode, and if the inductor is small 
enough that its influence on the low-frequency components of the converter waveforms is negligible, 
then the duty ratio should follow M(d(t)) = 11(1- d(t)). This implies that the duty ratio should follow the 
function 
d(t) = 1- vg(t) 
v 
(18.18) 
This expression is true only in the continuous conduction mode. The boost converter operates in the con-
tinuous conduction mode provided that the inductor current ripple 
(18.19) 
Boost converter 
i g < t) 
r-------------------·-----·-------------------1 
i( t) 
+ 
+ 
c 
v(t) 
R 
Fig. 18.5 Rectifier system based on the boost converter. 

18.2 Realization of a Near-Ideal Rectifier 
643 
is greater than the average inductor current, or 
(18.20) 
Hence, the converter operates in CCM when 
(18.21) 
Substitution of Eq. (18.18) into (18.21) and solution for Re leads to 
Re < 
( 
) 
for CCM 
v8(t) 
T, 1--v 
2L 
(18.22) 
Since vg(t) varies according to Eq. (18.11), Eq. (18.22) may be satisfied at some points on the ac line 
cycle, and not at others. Since 0 :S: v gCt) :S: V M' we can conclude that the converter operates in CCM over 
the entire ac line cycle when 
R < 2L 
e 
Ts 
Equations (18.18) and (18.22) then hold for all t. The converter always operates in DCM when 
Re > 
( 
) 
T 1- VM 
s 
v 
2L 
(18.23) 
(18.24) 
For Re between these limits, the converter operates in DCM when v g(t) is near zero, and in CCM when 
v/t) approaches VM. 
The static input characteristics of the open-loop boost converter are sketched in Fig. 18.6. The 
input current igCt) is plotted vs. input voltage v 8(t), for various duty cycles d(t). In CCM, the input charac-
teristics of the boost converter are described by 
vgs) = 1 - d(t) 
inCCM 
To obtain a general plot, we can normalize the input current and input voltage as follows: 
Equation (18.25) then becomes 
v (t) 
m (t)=-8 -
g 
v 
(18.25) 
(18.26) 
(18.27) 
(18.28) 
This equation is independent of the input current igCt), and hence is represented by vertical lines in Fig. 

644 
Pulse-Width Modulated Rectifiers 
Fig. 18.6 
Static input characteristics 
of the boost converter. A typical linear 
resistive input characteristic is super-
imposed. 
18.6. 
s 
·-'" 
;..llh" 
N;::,. 
s 
-~ 
0.75 
0.5 
0.25 
0 
0 
00 
0 
II 
"<::! 
0.25 
0.5 
0.75 
N 
0 
II 
"<::! 
0 
II 
"<::! 
To derive the boost input characteristic for DCM operation, we can solve the steady-state equiv-
alent circuit model of Fig. 11.12(b) (reproduced in Fig. 18.7). Beware: the natural DCM effective resis-
tance of Chapter 11, Re = 2L/d2Ts, does not necessarily coincide with the emulated resistance Re = v/i8 
ofEq. (18.1). In this chapter, the quantity Re is defined according to Eq. (18.1). Solution of Fig. 18.7 for 
the input current igCt) leads to: 
The instantaneous power consumed by the effective resistor in the model of Fig. 18.7 is 
Substitution of Eq. (18.30) into Eq. (18.29) and simplification leads to 
Fig. 18.7 
Averaged equivalent circuit model of the boost 
converter operating in DCM, derived in Chapter 11. 
2L 
d 2T s 
p(t) 
V -vg(t) 
(18.29) 
(18.30) 
+ 
v 

18.2 
Realization of a Near-Ideal Rectifier 
645 
inDCM 
(18.31) 
Normalization of this equation according to Eqs. (18.26) and (18.27) yields 
(18.32) 
This equation describes the curved (DCM) portions of the Fig. 18.6 input characteristics, for low igCt). 
To express the CCM/DCM mode boundary as a function of vgCt) and igCt), Eqs. (18.1) and 
(18.22) can be combined, leading to 
forCCM 
(18.33) 
Normalization of this equation, according to Eqs. (18.26) and (18.27), results in 
forCCM 
(18.34) 
This equation describes a parabola having roots at mg = 0 and m8 = 1, with the maximum value jg = 0.25 
at mg = 0.5. The mode boundary equation is plotted as a dashed line in Fig. 18.6 
The complete input characteristics for the boost converter were plotted in Fig. 18.6 using Eqs. 
(18.28), (18.32), and (18.34). Figure 18.6 also illustrates the desired linear resistive input characteristic, 
Eq. (18.1). For the value of Re illustrated, the converter operates in DCM for vgCt) near zero, and in CCM 
for vgCt) near V M' The intersections of boost input characteristics with the desired linear input characteris-
tic illustrate how the controller must choose the duty cycle at various values of vgCt). 
Other converters capable of producing the M(d(t)) of Eq. (18.12) include the buck-boost, 
SEPIC, and Cuk converters. The boost, SEPIC, and Cuk converters share the desirable property of non-
pulsating input current, and hence require minimal input EM£ filtering. The SEPIC produces a non 
inverted output voltage. Isolated versions of these converters (see Chapter 6) are also sometimes 
employed [7-9]. Schemes involving the parallel resonant converter, as well as several types of quasi-res-
onant converters, are also documented in the literature [10-13]. 
The open-loop boost converter, when operated in discontinuous conduction mode, is also some-
times used as an approximation of an ideal rectifier. The DCM effective resistance 2L/d2(t)Ts of Fig. 18.7 
is then taken as an approximation of the desired emulated resistance of Eq. (18.1). The model differs 
from that of the ideal rectifier model of Fig. 18.1(c) in that the power source is connected between the 
input and output terminals. As a result, harmonics are present in the input current waveform. For exam-
ple, if v 8(t) is a rectified sinusoid, then the current through the effective resistance 2Lid2(t)T, will also be 
a rectified sinusoid. However, the input current ( i8(t) >r, is now equal to the sum of the current through Re 
and the current flowing through the power source element. Since the power source is a nonlinear ele-
ment, (igCt))r, contains harmonics. For large C, the output voltage is essentially constant. The input cur-
rent waveform is then given by Eq. (18.31). If Vis sufficiently large, then the term (1 - vgCt)IV) is 
approximately equal to one, and the harmonics in (igCt) )r, are small. The zero crossings of vgCt), p(t), and 
(igCt))r, coincide. So although the DCM boost converter generates some current harmonics, it is nonethe-
less possible to construct a low harmonic rectifier that meets harmonic limits. Again, this approach has 
the disadvantages of the increased peak currents of DCM, and the need for additional filtering of the 
high-frequency pulsating input currents. Computer simulation of a DCM boost rectifier is described in 
Appendix B, Section B.2.3. 

646 
Pulse-Width Modulated Rectifiers 
A similar approach is to operate the boost converter at the boundary between the continuous and 
discontinuous conduction modes. This approach is known as "critical conduction mode" operation. It 
eliminates the distortion mechanism described above, but requires variable switching-frequency control. 
This approach is quite popular at low power levels, and is described further in Section 18.3.3. 
Other converters not capable of producing the M(d(t)) of Eq. (18.12), such as the buck con-
verter, are sometimes employed as the de-de converter of Fig. 18.3. Distortion of the ac line current 
waveform must then occur. Nonetheless, at low power levels it may be possible to meet the applicable ac 
line current harmonic standards using such an approach. 
18.2.2 DCM Flyback Converter 
In Chapter 11, the loss-free resistor network is used to model converters operating in discontinuous con-
duction mode. This suggests that DCM converters can also be used as near-ideal rectifiers. Indeed, the 
buck-boost, ftyback, SEPIC, and Cuk converters, when operated in discontinuous conduction mode with-
out additional control, inherently behave as natural loss-free resistors. The DCM effective resistance R., 
found in Chapter 11 to be equal to 2UD2T8 , then coincides with the rectifier emulated resistance of 
Eq. (18.1). At low power levels, this can be an effective and low-cost approach. Inrush current limiting is 
also inherent in this approach, and isolation and scaling via a turns ratio are provided by the transformer. 
Disadvantages are the increased peak currents of DCM, and the need for additional filtering of the high-
frequency pulsating input currents. 
A simple low-harmonic rectifier system based on the transformer-isolated ftyback converter is 
illustrated in Fig. 18.8 [2]. The ac line voltage is connected through an input EMI filter to a bridge recti-
fier and a ftyback converter. The ftyback converter is operated at constant switching frequency fs and con-
stant duty cycle D. The converter is designed such that it operates in the discontinuous conduction mode 
under all conditions. The input EMI filter smooths the pulsating input current waveform, so that iac(t) is 
approximately sinusoidal. 
The ftyback converter is replaced by its averaged equivalent circuit in Fig. 18.9. As discussed in 
Chapter 11, the terminal waveforms of the ftyback converter have been averaged over the switching 
period Ts, resulting in the loss-free resistor model. This model illustrates how the DCM ftyback converter 
presents a resistive load to the ac input. It also illustrates how the power flow can be controlled, by varia-
-------------------, i 
Flyback converter 
,-·----·-·-;;-;-i-·---·-·-·---, 
i( t) 
~~ .. 
+--+~-r----~ 
EM/filter 
v(t) 
c 
R 
L----·-···------------·------
tv 
Fig. 18.8 Low-harmonic rectifier system incorporating a flyback converter that operates in the discontinuous con-
duction mode. 

18.2 
Realization of a Near-Ideal Rectifier 
647 
EM! filter 
Averaged model 
< i c t) > r---------------------------------------------1 
g 
r, i 
i ( i(t) >rs 
-------------------------------1 
.--+---;-' 
+ 
c 
R 
Fig. 18.9 Averaged equivalent circuit that models the system of Fig. 18.8. 
tion of D to control the value of the emulated resistance Re. 
To design this converter, one must select the value of inductance to be sufficiently small, such 
that the converter operates in DCM at all points on the ac sine wave, at maximum load. If we denote the 
lengths of the transistor conduction interval, diode conduction interval, and discontinuous interval as 
DTs, d2Ts, and d3Ts, respectively, then the converter operates in DCM provided that d3 is greater than 
zero. This implies that 
By volt-second balance on the transformer magnetizing inductance, we can express dit) as 
Substitution of Eq. (18.36) into Eq. (18.35) and solution forD yields 
D< 
1 
( 
vg(t)) 
1+~­
nV 
(18.35) 
(18.36) 
(18.37) 
During a given switching period, the converter will operate in DCM provided that the above inequality is 
satisfied. The worst case occurs when the rectified sinusoid v gCt) is equal to its peak value V M· The ine-
quality then becomes 
(18.38) 
If Eq. (18.38) is satisfied, then the converter operates in DCM at all points on the ac line sinusoid. 
In steady state, the de output voltage is given by Eq. (18.8). Upon substitution of the expression 
for Re and solution forD, this equation becomes 
(18.39) 
Insertion of this relationship into Eq. (18.38), and solution for L, yields 

648 
Pulse-Width Modulated Rectifiers 
(18.40) 
For variations in load R and peak ac input voltage V M• the worst case will occur at minimum R (maxi-
mum power) and minimum V M' Hence, the designer should choose L to satisfy 
L L 
-
RminT, 
< crit-min-
( 
V )2 
4 1+-n-
VM-min 
(18.41) 
If this equation is violated, then at maximum load power and minimum input voltage amplitude, the con-
vert will operate in CCM near the peak of the ac sinewave. This will lead to an input current waveform 
having substantial distortion. 
18.3 
CONTROL OF THE CURRENT WAVEFORM 
A wide variety of approaches are known for active control of the input current waveform to attain input 
resistor emulation [14-33]. Average current control [17,18], input voltage feedforward [17], current-pro-
grammed control [19-22], hysteretic control and critical conduction mode control [23-27], and nonlin-
ear carrier control [28-30] are briefly surveyed here. Other approaches include sliding-mode control 
[31], charge control [32], andASDTIC control [33]. 
18.3.1 
Average Current Control 
Average current control is a popular method of implementing control of the input current waveform in a 
low-harmonic rectifier. This approach works in both continuous and discontinuous conduction modes, 
and can produce high-quality current waveforms over a wide range of input voltages and load powers. 
The problems of crossover distortion, found in some competing schemes such as current programmed 
control, are largely avoided. Several popular integrated circuits are available that implement average cur-
rent control. 
Figure 18.10 illustrates average current control of the input current waveform (igCt))Ts in a boost 
converter. The input current igCt) flows through a shunt resistor. The voltage across this shunt resistor is 
amplified by an op amp circuit. This op amp circuit contains a low-pass filter characteristic that attenu-
ates the high-frequency switching harmonics. The output voltage va(t) of the op amp circuit is propor-
tional to the low-frequency average value of i/t): 
(18.42) 
This signal is compared to the reference voltage v /t), to produce an error signal that drives the compen-
sator network and pulse-width modulator as illustrated. If the feedback loop is well designed, then the 
error signal is small: 
(18.43) 

18.3 
Control of the Current Waveform 
649 
Boost converter 
i g c t) 
1------------------------------------------------1 i( t) 
+ 
+ 
c 
v(t) 
R 
V r(t) 
= kx vg(t) Vcontrol(t) 
Controller 
Fig. 18.11 
Average current control of a boost converter, to obtain a low-harmonic rectifier. 
The average current controller causes the sensed current i8(t) to follow the reference waveform v/t). 
To cause the input current to be proportional to the input voltage, the reference voltage v /f) is 
derived from the sensed input voltage waveform, as in Fig. 18.11. The current reference signal v/t) is 
derived from the sensed input voltage vgCt). and hence has a sinusoidal waveshape. Hence, the average 
current controller causes the average input current ig(t) to be proportional to the input voltage v 8(t). The 
multiplier illustrated in Fig. 18.11 allows adjustment of the constant of proportionality, so that the magni-
tude of the emulated resistance can be controlled via a control signal vcontrol(t). Let us assume that the 
multiplier terminal equations are 
Fig. 
18.10 Average current 
control of the input current in a 
boost converter. 
:······ 
Current! 
sense! 
circuit l 
Current v (t) 
reference 
r 
+ 
v(t) 

650 
Pulse-Width Modulated Rectifiers 
(iit))r, 
Ideal rectifier (LFR) 
(i(t))r, 
..----+;·_----_---...,------------------------------------------,_---_----_---_-----+-+--.-------. 
+ 
! 
+ 
(" ,(<)),, I R, 
L------~---------~~--~ 
; 
R 
c 
~------------------------------------------------------------------
R (t) = 
R, 
Vcontrol(t) 
e 
k X VCO/llrolt) 
Fig. 18.12 Model of the system of Fig. 18.5, based on the loss-free resistor model of Fig. 18.1(c), which predicts 
the low-frequency system waveforms. This model assumes that the feedback loop of Fig. 18.5 operates ideally. 
(18.44) 
Then the emulated resistance is 
(18.45) 
Here, Eqs. (18.44) and (18.42) have been used to eliminate vg and ig. Substitution of Eq. (18.43) leads to 
the result 
(18.46) 
Hence, if the feedback loop is well designed, then the system of Fig. 18.11 can be represented by the 
LFR model as in Fig. 18.12. The average current controller scheme of Fig. 18.11 and the model of Fig. 
18.12 are independent of the de-de converter topology, and can be applied to systems containing CCM 
boost, buck-boost, Cuk, SEPIC, and other topologies. 
Average power flow and the output voltage are regulated by variation of the emulated resistance 
Re, in average current control as well as in most other schemes. This is usually accomplished by use of a 
multiplier in the input voltage sensing path, as shown in Fig. 18.13. This control loop continually adjusts 
Re to maintain balance of the average rectifier power P av = V~. rm/ Re and the load power P1oad• such that 
the following relation is obeyed: 
(18.47) 
Average current control works quite well. Its only disadvantages are the need to sense the average input 
current, rather than the transistor current, and the need for a multiplier in the controller circuit. 
Most average current control implementations include provisions for feedforward of the input 
voltage amplitude. This allows disturbances in the ac input voltage amplitude to be canceled out by the 

18.3 
Control of the Current Waveform 
651 
+ 
C 
v(t) 
Compensator 
Fig. 18.13 Average current control incorporating a multiplier for regulation of the output voltage. 
controller, such that the de output voltage is unaffected. 
Combination of Eqs. (18.44), (18.46), and (18.47), and solution for vrefl(t) leads to 
(18.48) 
This equation shows how the reference voltage should be varied to maintain a given rectifier average 
power throughput Pav· Apparently, it is necessary to divide by the square of the rms input voltage ampli-
tude. A controller that implements Eq. (18.48) is illustrated in Fig. 18.14. The multiplier block of Fig. 
18.13 has been generalized to perform the function kvxy/z2• It is somewhat complicated to compute the 
rms value of a general ac waveform; however, the ac input voltage v8(t) normally is sinusoidal with neg" 
ligible harmonics. Hence, the peak value of v 8(t) is directly proportional to its rms value, and we can use 
the peak value V Min place of Vg,rms· So the controller of Fig. 18.14 produces the reference voltage 
(18.49) 
Comparison of Eqs. (18.48) and (18.49) leads to the conclusion that 
(18.50) 
So the average power throughput is directly controlled by vcontrol(t), and is independent of the input volt-
age vgU). 
Feedforward can cause the rectifier de output voltage to be less sensitive to variations in the ac 

652 
Pulse-Width Modulated Rectifiers 
Peak 
detector 
X 
multiplier 
VM y 
~--~ 
~------~ 
V control ( t) 
Compensator 
Fig. 18.14 Average current control incorporating input voltage feedforward. 
+ 
v(t) 
line voltage. A disadvantage is the ac line current distortion introduced by variations in the voltage pro-
duced by the peak detector. 
To aid in the design of the inner feedback loop that controls the ac line current waveshape, a 
converter model is needed that describes how the converter average input current depends on the duty 
cycle. We would prefer to apply the averaged small-signal modeling techniques of Chapter 7 here. The 
problem is that the variations in the duty cycle d(t), as well as in the ac input voltage v gCt) and current 
igCt), are not small. As a result, in general the small-signal assumptions are violated, and we are faced 
with the design of a control system that exhibits significant nonlinear time-varying behavior. 
When the rectifier operates near periodic steady state, the output voltage v(t) of a well-designed 
system exhibits small variations. So we can write 
(v(t))T = V + v(t) 
s 
(18.51) 
with 
(18.52) 
In other words, the small-signal assumption continues to be valid with respect to the rectifier output volt-
age. In the case of the boost converter, this allows us to linearize the converter input characteristics. 
Following the approach of Chapter 7, we can express the average inductor voltage of the boost 
converter as 

18.3 
Control of the Current Waveform 
653 
Fig. 
18.15 Linearized model describing the boost 
converter input characteristics, corresponding to Eq. 
(18.55) 
L 
d'(t)V 
(18.53) 
This equation contains the nonlinear term d'(t) ( v(t) \;.· Substitution of Eq. (18.51) into (18.53) yields 
(18.54) 
When Eq. (18.52) is satisfied, then the nonlinear term- d'(t)V(t) is much smaller in magnitude than the 
linear term- d'(t)V Therefore, we can discard the nonlinear term to obtain 
(18.55) 
This linear differential equation is valid even though igCt), vgCt), and d(t) contain large variations. 
An equivalent circuit corresponding to Eq. (18.55) is given in Fig. 18.15. The averaged control-
to-input-current transfer function is found by setting the independent inputs other than d(t) to zero, and 
then solving for ig; the model predicts that this transfer function is 
(18.56) 
where igCs) is the Laplace transform of (igCt) )r,. So the input characteristics of the boost rectifier can be 
linearized, even though the ac input variations are not small. 
Unfortunately, Eq. (18.52) is not sufficient to linearize the equations describing the input char-
acteristics of the buck-boost, SEPIC, Cuk, and most other single-phase rectifiers. The control system 
design engineer must then deal with a truly nonlinear time-varying dynamical system. 
One approach that is sometimes suggested employs the quasi-static approximation [34,35]. It is 
assumed that the ac line variations are much slower than the rectifier system dynamics, such that the rec-
tifier always operates near equilibrium. The quiescent operating point changes slowly along the input 
sinusoid; an equilibrium analysis can be performed to find expressions for the slowly-varying "equilib-
rium" duty ratio and converter voltages and currents. The small-signal de-de converter transfer functions 
derived in Chapters 7 and 8 are evaluated using this time-varying operating point. The converter poles, 
zeroes, and gains are found to vary along the ac input sinusoid. An average current controller is designed 
using these time-varying transfer functions, such that the current loop gain has a positive phase margin at 
all operating points. 
We expect that the quasi-static approximation should be valid if the rectifier system dynamics 
are sufficiently fast, and it is reasonable to anticipate that high-frequency PWM converters have dynam-

654 
Pulse-Width Modulated Rectifiers 
ics that are much faster than the ac line frequency. The problem is that no good condition on system 
parameters, which can justify the approximation, is known for the basic converter topologies. There is 
room for additional research in this area. 
It is well-understood in the field of control systems that, when the rectifier system dynamics are 
not sufficiently fast, the quasi-static approximation yields neither sufficient nor necessary conditions for 
stability of the resulting design. Time-varying "loop gains" that always have a positive phase margin may 
nonetheless be unstable, and a negative phase margin does not always imply instability. Such phenomena 
are sometimes observed in rectifier systems. Even worse, it is difficult to justify the use of the Laplace 
transform on rectifiers described by time-varying differential equations, unless the quasi-static approxi-
mation can be validated. 
18.3.2 
Current Programmed Control 
Another well-known approach to attaining input resistor emulation is the use of current-programmed 
control. As illustrated in Fig. 18.16, the programmed current ic(t) is made proportional to the ac input 
voltage. This causes the average inductor current, and hence also (igCt) )r,.• to approximately follow vgCt). 
As in average current control, a multiplier is used to adjust the emulated resistance and average power 
flow; the control signal vcontrol(t) is typically used to stabilize the de output voltage magnitude. Several 
rectifier control ICs are commercially available, which implement current-programmed control. 
As discussed in Chapter 12, several mechanisms cause the average inductor current and hence 
also (igCt))Ts to differ from the programmed iJt). These mechanisms introduce crossover distortion and 
line current harmonics. An artificial ramp having sufficiently large slope rna is necessary to stabilize the 
Boost converter 
I 
! Multiplier 
I 
Vt) 
Comparator 
Latch 
' 
= kx vgCt) Vcontrol(t) 
!_ ____________________________________________________________________________________________________________________________________________ _: 
Current-programmed controller 
Fig. 18.16 Current-programmed control of a boost rectifier. 
R 

18.3 
Control of the Current Waveform 
655 
current-programmed boost converter when it operates in CCM with d(t) > 0.5. The addition of this ramp 
causes (igCt))r, to differ from ic(t). Additional deviation is introduced by the inductor current ripple. Both 
mechanisms are most pronounced when the inductor current is small, near the zero-crossings of the ac 
line waveforms. 
The static input characteristics, that is, the average input current vs. the input voltage, of the cur-
rent-programmed boost converter are given by 
inDCM 
(18.57) 
inCCM 
The converter operates in the continuous conduction mode when 
/· ( )) 
T,V v8(t) (1- vgCt)) 
\ 18 t 
T, > 2L v 
v 
(18.58) 
In terms of the control current iJt), the condition for operation in CCM can be expressed 
i (t) > T,V (maL+ vgCt)) (1- vgCt)) 
c 
L 
V 
V 
V 
(18.59) 
In the conventional current-programmed rectifier control scheme, the control current ic(t) is simply pro-
portional to the ac input voltage: 
(18.60) 
where Re is the emulated resistance that would be obtained if the average input current exactly followed 
the reference current ic(t). The static input characteristics given by Eqs. (18.57) to (18.60) are plotted in 
Fig. 18.17. The average input current (igCt))r, is plotted as a function of the applied input voltage vgCt), for 
several values of emulated resistance Re. The region near the CCM-DCM boundary is shown. The 
curves are plotted for a fixed artificial ramp having slope 
(18.61) 
This is the minimum value of artificial ramp that stabilizes the boost current-programmed controller at 
all static operating points. Decreasing rna below this value leads to instability at operating points in the 
continuous conduction mode at low vgCt)IV. 
To obtain resistor emulation, it is desired that the static input characteristics be linear and pass 
through the origin. It can be seen from Fig. 18.17 that this is not the case: the curves are reasonably linear 
in the continuous conduction mode, but exhibit significant curvature as the CCM-DCM boundary is 
approached. The resulting average current waveforms are summarized in Fig. 18.8. 
To minimize the line current THD, it is apparent that the converter should be designed to oper-
ate deeply in the continuous conduction mode for most of the ac line cycle. This is accomplished with 
emulated resistances Re that are much smaller than Rbase == 2LIT,. In addition, the artificial ramp slope rna 

656 
Pulse-Width Modulated Rectifiers 
0.8 
~, 
r:J::.:2 :::.. 
h 
0.6 
Q 
'--' 
"" 
..:.::::..-
0.4 
-;::;-
'--' 
-~ 
0.2 
0 
0.0 
0.2 
0.4 
0.6 
0.8 
1.0 
vg(t) 
v 
Fig. 18.17 Static input characteristics of a current-programmed boost converter, with minimum stabilizing artifi-
cial ramp ofEq. (18.61). 
iit) 
1.0 
- v 
Peak ig 
ma- 2L 
0.8 
R 
_ 2L 
base- ---;y; 
0.6 
0.4 
0.2 
0.0 
(f)( 
Fig. 18.18 Input current waveshapes predicted by the static input characteristics of Fig. 18.17, compared with ll 
pure sinusoid. Curves are plotted for the case V M = 0.8V, with minimum stabilizing artificial ramp. 
should be no greater than otherwise necessary. In practice, THD of 5% to 10% can easily be obtained in 
rectifiers that function over a narrow range of rms input voltages and load currents. However, low THD 
cannot be obtained at all operating points in universal-input rectifiers; THD of 20% to 50% may be 
observed at maximum ac input voltage. This problem can be solved by biasing the current reference 
waveform. Design of current-programmed rectifiers is discussed in [19-22], and some strategies for 
solving this problem are addressed in [ 19]. 

18.3 
Control of the Current Waveform 
657 
(a) 
wt 
(b) 
.····· 
··· ... 
.... ··· 
····· ... 
······ ... 
····· ... 
Wt 
Fig. 18.19 Input current waveforms of two boost converters with hysteretic control: (a)± 10% regulation band, (b) 
critical conduction mode operation (± 100% regulation band). 
18.3.3 
Critical Conduction Mode and Hysteretic Control 
Another control scheme sometimes used in low-harmonic rectifiers, as well as in de-de converters and 
dc-ac inverters, is hysteretic control. Rather than operating at a fixed switching frequency and duty 
cycle, the hysteretic controller switches the transistor on and off as necessary to maintain a waveform 
within given limits. A special case of hysteretic control, called critical conduction mode control, is 
implemented in several commercially-available ICs, and is popular for low-harmonic rectifiers rated 
below several hundred Watts [23-25]. 
An example is the sinusoid of Fig. 18.19(a), in which the boost converter input current is con-
trolled to follow a sinusoidal reference with a ± 10% tolerance. The inductor current increases when the 
transistor is on, and decreases when the transistor is off. So this hysteretic controller switches the transis-
tor on whenever the input current falls below 90% of the reference input. The controller switches the 
transistor off whenever the input current exceeds 110% of the reference. Hysteretic controllers tend to 
have simple implementations. However, they have the disadvantages of variable switching frequency and 
reduced noise immunity. 
Another example of hysteretic control is the waveform of Fig. 18.19(b). The lower limit is cho-
sen to be zero, while the upper limit is twice the reference input. This controller operates the boost con-
verter at the boundary between the continuous and discontinuous conduction modes. An alternative 
control scheme that generates the same waveform simply operates the transistor with constant on-time: 
the transistor is switched on when the inductor current reaches zero, and is switched off after a fixed 

658 
Pulse-Width Modulated Rectifiers 
EM/filter 
r·M··----------------------~ 
'-r-+----, 
Boost converter 
i / t) r··----------------------------------------------1 i( t) 
+ 
+ 
c 
v(t) 
R 
L------------------------J 
I 
: 
r··---------------------------- -------------- __ .... ___________________ -.:-.... ---------.:-.:-.----·, .. ,.-.-::-.-.---.:-.:-.-.:-.:-.-_ ...... , .. ,_ ... -_.,. _________________________________ 1 
vco/ltro/t) i 
i 
i 
I 
I Multiplier 
l 
r 
,I 
I 
~------------~-~:.-~-~~:~-~~~!'!!.~!.~t!__ ________ ~:=~-~~~::~-----------------------~:~:: ________ __1 
Controller 
Fig. 18.20 A typical implementation of critical conduction mode control. 
interval of length ton· The resulting inductor current waveform will have a peak value that depends 
directly on the applied input voltage, and whose average value is one-half of its peak. With either control 
approach, the converter naturally exhibits loss-free-resistor or ideal rectifier behavior. The emulated 
resistance is 
R = 2L 
e 
ton 
(18.62) 
This scheme has the advantage of small inductor size and low-cost control ICs. Disadvantages are 
increased peak currents, variable switching frequency, and the need for additional input EMI filtering. 
A typical critical conduction mode controller is illustrated in Fig. 18.20. A zero-current detector 
senses when the inductor current is zero; this is typically accomplished by monitoring the voltage across 
the inductor. The zero-current detector sets a latch, turning on the transistor and initiating the switching 
period. The transistor current is also monitored, and is compared to a sinusoidal reference v/t) that is 
proportional to the applied input voltage vgCt). When the sensed current is equal to the reference, the latch 
is reset and the transistor is turned off. 
Since the switching frequency can vary, possibly over a wide range, it is important to carefully 
design the converter power stage. For a given power P, the required transistor on-time ton can be found by 
combining Eqs. (18.17) and (18.62), and solving for t0n: 
4LP 
to"=VZ 
M 
(18.63) 
Application of the principle of volt-second balance to inductor L of Fig. 18.20 leads to the following 
equation: 
(18.64) 
Hence, the transistor off-time is given by 

18.3 
Control of the Current Waveform 
659 
(18.65) 
The switching period Ts is equal to 
(18.66) 
Substitution of Eqs. (18.63) and (18.65) into Eq. (18.66) yields 
(18.67) 
The following expression for switching frequency is found by substitution of Eq. (18.11) into Eq. 
(18.67): 
1 
v~ ( 
vM I . 
I) 
fs = T, = 4LP 1-V 
sm (Wt) 
The maximum switching frequency occurs when sin (mt) equals zero: 
vz 
maxfs= 4L7> 
The minimum switching frequency occurs at the peak of the sine wave: 
(18.68) 
(18.69) 
(18.70) 
Equations (18.69) and (18.70) can be used to select the value of the inductance Land the output voltage 
V, so that the switching frequency varies over an acceptable range. 
18.3.4 
Nonlinear Carrier Control 
The nonlinear-carrier controller (NLC) is capable of attaining input resistor emulation in boost and other 
converters that operate in the continuous conduction mode. Implementation of the controller is quite sim-
ple, with no need for sensing of the input voltage or input current. There is also no need for a current loop 
error amplifier. The boost nonlinear-carrier charge controller is inherently stable and is free from the sta-
bility problems that require addition of an artificial ramp in current programmed controllers. 
A CCM boost rectifier system with nonlinear-carrier charge control is illustrated in Fig. 18.21, 
and waveforms are given in Fig. 18.22. The reasoning behind this approach is as follows. It is desirable 
to control the transistor switch current i,.(t). This pulsating current is much easier to sense than the contin-
uous converter input current-a simple current transformer can be used, as in Fig. 18.21. Further, it is 
desirable to control the integral of this current, or the charge, for two reasons: (1) integration of the wave-
form leads to improved noise immunity, and (2) the integral of the waveform is directly related to its 
average value, 

660 
Pulse-Width Modulated Rectifiers 
Boost converter 
R 
Fig. 18.21 
Nonlinear-carrier charge control of a boost converter. 
i.(t) 
Fig. 18.22 Transistor current i8(t), parabolic carrier voltage v /t), and integrator voltage v;(t) waveforms for the 
NLC-controlled boost rectifier of Fig. 18.21. 

I 8.3 
Control of the Current Waveform 
661 
1 ft+T, 
(i/t))T =T 
i,(T)dT 
S 
s 
I 
(18.71) 
In a fixed-frequency system, T,. is constant, and the integral over one switching period is proportional to 
the average value. Hence the average switch current can be controlled to be proportional to a reference 
signal by simply switching the transistor off when the integral of the switch current is equal to the refer-
ence. In the controller of Fig. 18.21, the switch current is(t) is scaled by the transformer turns ration, and 
then integrated by capacitor C;, such that 
-
1 fdTs i,(T) 
v/t) - C; Jo 
-n- d-r; 
for 0 < t < dT, 
(18.72) 
The integrator voltage v;(t) is reset to zero at the end of each switching period, and the integration process 
begins anew at the beginning of the next switching period. So at the instant that the transistor is switched 
off, the voltage v;(dTs) is proportional to the average switch current: 
(i,) T 
v/dT,) = cf 
n lJs 
for interval 0 < t < T, 
(18.73) 
How should the average switch current be controlled? To obtain input resistor emulation, it is 
desired that 
(18.74) 
It is further desired to avoid sensing either igCt) or vgCt). As with other schemes, we will sense the de out-
put voltage ( v(t) )T,, to construct a low-bandwidth feedback loop that balances the average input and out-
put powers. So let us determine the relationship between (i,(t))Ts and (v(t))r, implied by Eq. (18.74). If 
we assume that the boost converter operates in the continuous conduction mode, then we can write 
(18.75) 
and 
(18.76) 
Substitution of Eqs. (18.75) and (18.76) into Eq. (18.74) leads to 
(v(t))T 
( i,(t)) T = d(t) ( 1 - d(t)) R ( 
') 
s 
e V control 
(18.77) 
The controller of Fig. 18.21 implements this equation. 
The nonlinear carrier generator of Fig. 18.21 produces the parabolic waveform vc(t), given by 

662 
Pulse-Width M adulated Rectifiers 
vJt) = Vcontml ( J,) ( 1- J,) 
for 0:::; t:::; T, 
(18.78) 
vc(t + T,) = vc(t) 
This waveform is illustrated in Fig. 18.22. Note that Eq. (18.78) resembles Eq. (18.77), with d(t) 
replaced by (tiTs). The controller switches the transistor off at time t = dTs when the integrator voltage 
v;(t) is equal to the carrier waveform vc(t). Hence, it is true that 
v;(dT,) = vJdT,) = Vcoutrolfl d(t) ( 1- d(t)) 
(18.79) 
Substitution of Eq. (18.73) yields 
(i,(t))T 
-C.J 
s = V coutmlt) d(t) ( 1 - d(t)) 
n , s 
(18.80) 
This is of the same form as Eq. (18.77). Comparison of Eqs. (18.77) and (18.80) reveals that the emu-
lated resistance Re is given by 
(18.81) 
If the de output voltage and the control voltage have negligible ac variation, then Re is essentially con-
stant, and the ac line current will exhibit low harmonic distortion. So neither the input voltage nor the 
input current need be sensed, and input resistor emulation can be obtained in CCM boost converters by 
sensing only the switch current. 
A simple way to generate the parabolic carrier waveform uses two integrators, as illustrated in 
Fig. 18.23. The slowly varying control voltage vcontro/t) is integrated, to obtain a ramp waveform v/t) 
whose peak amplitude is proportional to vcontroz(t). The de component of this waveform is removed, and 
then integrated again. The output of the second integrator is the parabolic carrier v c(t), illustrated in Fig. 
18.22 and given by Eq. (18.78). Both integrators are reset to zero before the end of each switching period 
V control (f) 
: :············---·································· .. -··············: 
---+---!· j 
': 
': 
': 
': 
': 
': 
"'~-.. 
Integrator with reset 
Removal of de 
........ , component 
l 
r· .. ··········-··-------··············--·------············-·--····: 
... .11 i 
': 
': 
': \ .... 
. 
. 
'··········-------··············-·--·-············---------·········' 
Integrator with reset 
; Clock 
Fig. 18.23 
Generation of parabolic carrier waveform by double integration. 
vJt) 

18.4 Single-Phase Converter Systems Incorporating Ideal Rectifiers 
663 
by the clock generator. The amplitude of the parabolic carrier, and hence also the emulated resistance, 
can be controlled by variation ofvcontrJt). 
Equations (18.75) and (18.76) are valid only when the converter operates in the continuous con-
duction mode. In consequence, the ac line current waveform is distorted when the converter operates in 
DCM. Since this occurs near the zero crossings of the ac line voltage, crossover distortion is generated. 
Nonetheless, the harmonic distortion is less severe than in current-programmed schemes, and it is feasi-
ble to construct universal-input rectifiers that employ the NLC control approach. Total harmonic distor-
tion is analyzed and plotted in [28]. 
Nonlinear carrier control can be applied to current-programmed boost rectifiers, as well as to 
other rectifiers based on the buck-boost, SEPIC, Cuk, or other topologies, with either integral charge 
control or peak-current-programmed control [28,29]. In these cases, a different carrier waveform must be 
employed. A nonlinear-carrier controller in which the ac input voltage vit) is sensed, rather than the 
switch current i,(t), is described in [30]. 
18.4 
SINGLE-PHASE CONVERTER SYSTEMS INCORPORATING 
IDEAL RECTIFIERS 
An additional issue that arises in PWM rectifier systems is the control of power drawn from the ac line, 
the power delivered to the de load, and the energy stored in a bulk energy storage capacitor. 
18.4.1 
Energy Storage 
It is usually desired that the de output voltage of a converter system be regulated with high accuracy. In 
practice, this is easily accomplished using a high-gain wide-bandwidth feedback loop. A well-regulated 
de output voltage v(t) = Vis then obtained, which has negligible ac variations. For a given constant load 
characteristic, the load current I and the instantaneous load power Piaait) = P1oad' are also constant: 
Ptoad(t) = v(t)i(t) = VI 
(18.82) 
However, the instantaneous input power p ac(t) of a single-phase ideal rectifier is not constant: 
(18.83) 
If vit) is given by Eq. (18.11), and if i/t) follows Eq. (18.1), then the instantaneous input power 
becomes 
v2 
vz 
Pac(t) = / 
sin 2 ((J)t) = 2J: ( 1- cos (2(J)t)) 
e 
e 
(18.84) 
which varies with time. The instantaneous input power is zero at the zero crossings of the ac input volt-
age. Equations (18.82) and (18.84) are illustrated in Fig. 18.24(a). Note that the desired instantaneous 
load power Pioad(t) is not equal to the desired instantaneous rectifier input power Pac(t). Some element 
within the rectifier system must supply or consume the difference between these two instantaneous pow-
ers. 
Since the ideal rectifier does not consume or generate power, nor does it contain significant 
internal energy storage, it is necessary to add to the system a low-frequency energy storage element such 

664 
Pulse-Width Modulated Rectifiers 
Fig. 
18.24 Waveforms of a single-
phase ideal rectifier system: (a) pulsating 
ac input power Pac(t), and constant de 
load power Pload; (b) energy storage 
capacitor voltage v c(t). 
(a) 
(b) 
as an electrolytic capacitor. The difference between the instantaneous input and load powers flows 
through this capacitor. 
The waveforms of rectifier systems containing reactive elements can be determined by solution 
of the rectifier energy equation [36,37]. If the energy storage capacitor C is the only system element 
capable of significant low-frequency energy storage, then the power Pc(t) flowing into the capacitor is 
equal to the difference between the instantaneous input and output powers: 
(18.85) 
where Cis the capacitance, vc(t) is the capacitor voltage, and Ec(t) is the energy stored in the capacitor. 
Hence as illustrated in Fig. 18.24(b), whenp0c(t) > Ptaad(t) then energy flows into the capacitor,and vc(t) 
increases. Likewise, v cCt) decreases when p 0 Jt) < Ptoait). So the capacitor voltage v c(t) must be allowed 
to increase and decrease as necessary to store and release the required energy. In steady-state, the average 
values of p 0Jt) and Ptaait) must be equal, so that over one ac line cycle there is no net change in capaci-
tor stored energy. 
Where can the energy storage capacitor be placed? It is necessary to separate the energy storage 
capacitor from the regulated de output, so that the capacitor voltage is allowed to independently vary as 
illustrated in Fig. 18.24(b). A conventional means of accomplishing this isillustrated in Fig. 18.25. A 
second de-de converter is inserted, between the energy storage capacitor and the regulated de load. A 
wide-bandwidth feedback loop controls this converter, to attain a well-regulated de load voltage. The 
capacitor voltage vc(t) is allowed to vary. Thus, this system configuration is capable of (1) wide-band-
width control of the ac line current waveform, to attain unity power factor, (2) internal low-frequency 
energy storage, and (3) wide-bandwidth regulation of the de output voltage. It is also possible to integrate 
these functions into a single converter, provided that the required low-frequency independence of the 
input, output, and capacitor voltages is maintained [38]. 
The energy storage capacitor also allows the system to function in other situations in which the 
instantaneous input and output powers differ. For example, it is commonly required that the output volt-

18.4 Single-Phase Converter Systems Incorporating Ideal Rectifiers 
665 
De-de 
converter 
+ 
v(t) 
Fig. 18.25 Elements of a single-phase-ac to de power supply, in which the ac line current and de load voltage are 
independently regulated with high bandwidth. An internal independent energy storage capacitor is required. 
age remain regulated during ac line voltage failures of short duration. The hold-up time is the duration 
that the output voltage v(t) remains regulated after v ac(t) has become zero. A typical requirement is that 
the system continue to supply power to the load during one complete missing ac line cycle, that is, for 
20 msec in a 50 Hz system. During the hold-up time, the load power is supplied entirely by the energy 
storage capacitor. The value of capacitance should be chosen such that at the end of the hold-up time, the 
capacitor voltage v c(t) exceeds the minimum value that the de-de converter requires to produce the 
desired load voltage. 
The energy storage function could be performed by an element other than a capacitor, such as 
an inductor. However, use of an inductor is a poor choice, because of its high weight and cost. For exam-
ple, a 100 ~-tF 100 V electrolytic capacitor and a 100 ~-tH 100 A inductor can each store 1 Joule of energy. 
But the capacitor is considerably smaller, lighter, and less expensive. 
A problem introduced by the energy storage capacitor is the large inrush current observed dur-
ing the system tum-on transient. The capacitor voltage v c(t) is initially zero; substantial amounts of 
charge and energy are required to raise this voltage to its equilibrium value. The boost converter is not 
capable of limiting the magnitude of the resulting inrush current: even when d(t) = 0, a large current 
flows through the boost converter diode to the capacitor, as long as the converter output voltage is less 
than the input voltage. Some additional circuitry is required to limit the inrush current of the boost con-
verter. Converters having a buck-boost type conversion ratio are inherently capable of controlling the 
inrush current. This advantage comes at the cost of additional switch stress. 
It is also possible to design the ideal rectifier to operate correctly when connected to utility 
power systems anywhere in the world. Universal input rectifiers can operate with nominal ac rms voltage 
magnitudes as low as the 100 V encountered in a portion of Japan, or as high as the 260 V found in west-
em Australia, with ac line frequencies of either 50 Hz or 60 Hz. Regardless of the ac input voltage, the 
universal-input rectifier produces a constant nominal de output voltage Vc. 
Let us now consider in more detail the low-frequency energy storage process of the system of 
Fig. 18.25. Let us assume that the de-de converter contains a controller having bandwidth much greater 
than the ac line frequency, such that the load voltage contains negligible low-frequency variations. A 
low-frequency model of the de-de converter is then as illustrated in Fig. 18.26. The de-de converter pro-
duces constant voltage v(t) = V, modeled by a voltage source as shown. This causes the load to draw con-
stant current i(t) = I, leading to load power P!oait) = Pload· To the extent that converter losses can be 
neglected, the de-de converter input port draws power Pload• regardless of the value of v c(t). So the de-de 
converter input port can be modeled as a constant power sink, of value Pload' 
The model of Fig. 18.26 implies that the difference between the rectifier power Pac(t) and the 
load power Pload flows into the capacitor, as given by Eq. (18.85). The capacitor voltage increases when 
p ac(t) exceeds Pload' and decreases when p ac(t) is less than Pload' In steady state, the average values of 
PaJt) and Pload must be equal. But note that Pa/t) is determined by the magnitudes of V0 c(t) andRe, and 

666 
Pulse- Width Modulated Rectifiers 
[ ____________________________________________ _: 
Ideal rectifier (LFR) 
:_ ______________________ _! 
Energy storage 
capacitor 
Fig. 18.26 Low-frequency equivalent circuit of the system of Fig. 18.25. 
De-de 
converter 
not by the load. The system of Fig. 18.26 contains no mechanism to cause the average rectifier power and 
load power to be equal. In consequence, it is necessary to add an additional control system that adjusts Re 
as necessary, to cause the average rectifier output power and de-de converter input power to balance. The 
conventional way to accomplish this is simply to regulate the de component of v c(t). 
A complete system containing ideal rectification, energy storage, and wide-bandwidth output 
voltage regulation is illustrated in Fig. 18.27. This system incorporates the boost converter and controller 
of Fig. 18.5, as well as a generic de-de converter with output voltage feedback. In addition, the system 
contains a low-bandwidth feedback loop, which regulates the de component of the energy-storage capac-
itor voltage to be equal to a reference voltage vref2. This is accomplished by slow variations of vcontroz(t) 
andRe. This controller should have sufficiently small loop gain at the even harmonics of the ac line fre-
quency, so that variations in Re are much slower than the ac line frequency. 
Increasing the bandwidth of the energy storage capacitor voltage controller can lead to signifi-
cant ac line current harmonics. When this controller has wide bandwidth and high gain, then it varies 
R/t) quickly, distorting the ac line current waveform. In the extreme limit of perfect regulation of the 
Boost converter 
r-------------------------------
c 
Wide-bandwidth input current controller 
DC-DC 
Converter 
d(t) 
+ 
v(t) 
I 
v(t) 
I, 
Compensator 
_ 
and modulator 
'+-
,_ --------- -- --- ---- -- ------ -- --- ------ --------- --- _j 
Wide-bandwidth output voltage controller 
r·----------------------------------------------------------------------;-;~(1) -------------1 
! 
v,e 
! 
L-------+-------1 
Compensator 
~+ 
fl I 
l 
_______________________________________________________________________ _j 
Low-bandwidth energy-storage capacitor voltage controller 
Fig. 18.27 A complete de power supply system incorporating a near-ideal single-phase boost rectifier system, 
energy storage capacitor, and de-de converter. Wide-bandwidth feedback loops regulate the ac line current wave-
form and the de load voltage, and a slow feedback loop regulates the energy storage capacitor voltage. 

18.4 Single-Phase Converter Systems Incorporating Ideal Rectifiers 
667 
Fig. 18.28 
Ac line current waveform of the single-phase ideal rectifier with output voltage feedback, when it sup-
plies constant instantaneous power to a de load. The THD tends to infinity, and the power factor tends to zero. 
energy storage capacitor voltage v c(t) = V c• then the capacitor stored energy is constant, and the instanta-
neous input ac line power Pac(t) and load power P!oad(t) are equal. The controller prevents the energy-
storage capacitor from performing its low-frequency energy storage function. The ac line current then 
becomes 
(18.86) 
This waveform is sketched in Fig. 18.28. In this idealized limiting case, the ac line current tends to infin-
ity at the zero crossings of the ac line voltage waveform, such that the instantaneous· input power is con-
stant. It can be shown that the THD of this current waveform is infinite, and its distortion factor and 
power factor are zero. So the bandwidth of this controller should be limited. 
The energy storage capacitor voltage ripple can be found by integration of Eq. (18.85). Under 
steady-state conditions, where the average value of p ac(t) = Pload' integration of Eq. ( 18.85) yields 
Ec(t) = 1 
Cv~(t) = Ec(O) + J: (- Pload cos (2Wt) )dt 
(18.87) 
where w is the ac line frequency. Evaluation of the integral leads to 
(18.88) 
Therefore, the capacitor voltage waveform is 
Vc(t) = J 2E(:(t) = J 
v~(O)- d;C' sin (2wt) 
(18.89) 
It can be verified that the rms value of this waveform is Vc,rms = vc(O). Hence, Eq. (18.89) can be written 
1 -
Pload 
sin (2wt) 
wcv~.rms 
(18.90) 
This waveform is sketched in Fig. 18.24(b). The minimum and maximum values of the capacitor voltage 
occur when sin (2wt) is equal to 1 and -1, respectively. Therefore, the peak-to-peak capacitor voltage rip-

668 
Pulse-Width Modulated Rectifiers 
ple is 
1 + 
pload 
roCV~.rms 
1-
pload 
"'~ 
roCV~,rms 
roCV C,rms 
(18.91) 
The approximation is valid for P1oad/(roCV~,rm,) sufficiently less than one, a condition that is satisfied 
whenever the ac voltage ripple is sufficiently less than V c.nns. 
18.4.2 
Modeling the Outer Low-Bandwidth Control System 
As discussed above, the outer low-bandwidth controller, which varies the emulated resistance as neces-
sary to balance the average ac input and de load powers, is common to all near-ideal rectifier systems. 
For design of this controller, the rectifier can be modeled using the loss-free resistor (LFR) model. Per-
turbation and linearization of the LFR leads to a small-signal equivalent circuit that predicts the relevant 
small-signal transfer functions. Such a model is derived in this section [2,39,40]. 
It is desirable to stabilize the rectifier output voltage against variations in load power, ac line 
voltage, and component characteristics. Hence, a voltage feedback loop is necessary. As discussed in 
Section 18.4.1, this loop cannot attempt to remove the capacitor voltage ripple that occurs at the second 
harmonic of the ac line frequency, 2ro, since doing so would require that R.(t) change significantly at the 
second harmonic frequency. This would introduce significant distortion, phase shift, and power factor 
degradation into the ac line current waveform. In consequence this loop must have sufficiently small gain 
at frequency 2ro, and hence its bandwidth must be low. Therefore, for the purposes of designing the low-
bandwidth outer control loop, it is unnecessary to model the system high-frequency behavior. It can be 
assumed that any inner wide-bandwidth controller operates ideally at low frequencies, such that the ideal 
rectifier model of Fig. 18.29(a) adequately represents the low-frequency system behavior. 
A small-signal model is derived here that correctly predicts the control-to-output transfer func-
tion and output impedance of any rectifier system that can be modeled as a loss-free resistor. The model 
neglects the complicating effects of high-frequency switching ripple, and is valid for control variations at 
frequencies sufficiently less than the ac line frequency. Both resistive and de-de converter/regulator loads 
are treated. 
The steps in the derivation of the small-signal ac model are summarized in Fig. 18.29. Figure 
18.29(a) is the basic ideal rectifier model, in which the converter high frequency switching ripple is 
removed via averaging over the switching period T,, but waveform frequency components slower than 
the switching frequency are correctly modeled, including the 2ro second-harmonic and de components of 
output voltage. It is difficult to use this model in design of the feedback loop because it is highly nonlin-
ear and time-varying. 
If the ac input voltage v gCt) is 
vg(t) = .ff vg,rms I sin (rot) I 
(18.92) 
then the model of Fig. 18.29(a) predicts that the instantaneous output power (p(t) )T, is 
(18.93) 

(a) 
(b) 
(c) 
(d) 
ac 
input 
18.4 Single-Phase Converter Systems Incorporating Ideal Rectifiers 
669 
Ideal rectifier (LFR) 
( i2(t))y 
;-----------------------------------------------------------------r·--_--_---_-------t·-:-+-.'-----:+----, 
I 
~ 
i Re ( V control) 
I 
i 
V control 
c 
de 
output 
(v(t))y 
s 
(ilt))y 
r--------------------------------------------------------------------------------------------~ 
, 
+ 
I 
l 
I 
! 
v~,nns 
2 (2 t). 
---cos 
Ol 
Re 
v~,rms 
1--------------------------------------------------------------------------------------------J 
Rectifier output port 
( iit))y 
r--------------------------------------~ 
2L 
c 
+ 
1 I ! 
[ 
c 
( v(t))y 
2L 
I 
i 
L-------------------------------------1 
Rectifier output port 
r----------------------------------------------------------------------------------------: 
i 
I I g20g,rms 
c 
I 
L----------------------------------------------------------------------------------------J 
Rectifier output port 
( v(t))y 
s 
+ 
R 
Fig. 18.29 Steps in the derivation of low-frequency small-signal rectifier model: (a) large-signal LFR model, 
averaged over one switching period T,; (b) separation of power source into its constant and time-varying compo-
nents; (c) removal of second-harmonic components by averaging over one-half of the ac line period, T2L; (d) small-
signal model obtained by perturbation and linearization of Fig. 18.29(c). 

670 
Pulse-Width Modulated Rectifiers 
v(t) 
Fig. 18.30 Removal of components of v(t) at the harmonics of the ac line frequency, by averaging over one-half oJ 
the ac line period, T2L. 
The output power is comprised of a constant term v:. '"',/ Re, and a term that varies at the second har-
monic of the ac line frequency. These two terms are explicitly identified in Fig. 18.29(b). 
The second-harmonic variation in (p(t))Ts leads to time-varying system equations, and slow 
variations in vcontrol(t) lead to an output voltage spectrum containing components not only at the frequen-
cies present in v control(t), but also at the even harmonics of the ac line frequency and their sidebands, as 
well as at the switching frequency and its harmonics and sidebands. It is desired to model only the low-
frequency components excited by slow variations in vcontrol(t), the load, and the ac line voltage amplitude 
vg,rms· The even harmonics of the ac line frequency can be removed by averaging over one-half of the ac 
line period 
(18.94) 
Hence, we average over the switching period Ts to remove the switching harmonics, and then average 
again over one-half of the ac line period T2L to remove the even harmonics of the ac line frequency. The 
resulting model is valid for frequencies sufficiently less than the ac line frequency w. Averaging of the 
rectifier output voltage is illustrated in Fig. 18.30: averaging over T2L removes the ac line frequency har-
monics, leaving the underlying low-frequency variations. By averaging the model of Fig. 18.29(b) over 
T2L, we obtain the model of Fig. 18.29(c). This step removes the second-harmonic variation in the power 
source. 
The equivalent circuit of Fig. 18.29(c) is time-invariant, but nonlinear. We can now perturb and 
linearize as usual, to construct a small-signal ac model that describes how slow variations in vcontrot(t), 
vg,rms' and the load, affect the rectifier output waveforms. Let us assume that the averaged output voltage 
( v(t) \L, rectifier averaged output current ( iz(t) >r2L, rms line voltage amplitude v g,rms' and control voltage 
v control(t), can be represented as quiescent values plus small slow variations: 
with 
(vCtl)r2L = v + v(t) 
(iitl)TzL =lz+i2(t) 
V g,miS = vg,nns + v 
g,rms(f) 
V control f) = V control + V colltro/ f) 
(18.95) 

i8.4 Single-Phase Converter Systems incorporating ideal Rectifiers 
v » 1 v(t) 1 
I 2 » I i itl I 
vg.nn, » I vg.rn./t) I 
vcontrol >> 1 vcontroit) I 
In the averaged model of Fig. 18.29(c), (iit))r,L is given by 
671 
(18.96) 
(18.97) 
This equation resembles DCM buck-boost Eq. (11.45), and linearization proceeds in a similar manner. 
Expansion of Eq. (18.97) in a three-dimensional Taylor series about the quiescent operating point, and 
elimination of higher-order nonlinear terms, leads to 
where 
df( vg,rms• V, Vcontrol) 
j2 = -'---=-----'-
dvcontrol 
-
2 
vg,rms 
- R / V control) 
V 
vg,mls= vg,rms 
-
v~,nns 
dRe(vcontrol) I 
-- VR;(vcontroz) 
dvcontrol 
V control = V control 
v control = V control 
(18.98) 
(18.99) 
(18.100) 
(18.101) 
A small-signal equivalent circuit based on Eq. (18.98) is given in Fig. 18.29(d). Expressions for the 
parameters g2,j2, and r2 for several controllers are listed in Table 18.1. This model is valid for the condi-
tions of Eq. (18.96), with the additional assumption that the output voltage ripple is sufficiently small. 
Figure 18.29(d) is useful only for determining the various ac transfer functions; no information regarding 
de conditions can be inferred. The ac resistance r2 is derived from the slope of the average value of the 
power source output characteristic, evaluated at the quiescent operating point. The other coefficients, j 2 
and g2, are also derived from the slopes of the same characteristic, taken with respect to vcontrol(t) and 
v g,rms and evaluated at the quiescent operating point. The resistance R is the incremental resistance of the 
load, evaluated at the quiescent operating point. In the boost converter with hysteretic control, the tran-
sistor on-time ton replaces v control as the control input; likewise, the transistor duty cycle dis taken as the 

672 
Pulse-Width Modulated Rectifiers 
Table 18.1 
Small-signal model parameters for several types of rectifier control schemes 
Controller type 
g2 
j2 
rz 
Average current control with 
0 
pav 
vz 
feedforward, Fig. 18.14 
vvcontrol 
pav 
Current-programmed control, 
2Pav 
pav 
vz 
Fig. 18.16 
vvg,nns 
vvcontrol 
pav 
Nonlinear-carrier charge control 
2Pav 
pav 
y2 
of boost rectifier, Fig. 18.21 
vvg,nns 
vvcontrol 
2Pav 
Boost with critical conduction mode 
2Pav 
pav 
y2 
control, Fig. 18.20 
vvg,nns 
vvcontrol 
pav 
DCM buck-boost, flyback, SEPIC, 
2Pav 
2Pav 
y2 
or Cuk converters 
vvg,mts 
VD 
pav 
control input to the DCM buck-boost, flyback, SEPIC, and Cuk converters. Harmonics are ignored for 
the current-programmed and NLC controllers; the expressions given in Table 18.1 assume that the con-
verter operates in CCM with negligible harmonics. 
The control-to-output transfer function is 
(18.102) 
The line-to-output transfer function is 
(18.103) 
Thus, the small-signal transfer functions of the high quality rectifier contain a single pole, ascribable to 
the output filter capacitor operating in conjunction with the incremental load resistance R and r2, the 
effective output resistance of the power source. Although this model is based on the ideal rectifier, its 
form is similar to that of the de-de DCM buck-boost converter ac model of Chapter 11. This is natural, 
because the DCM buck-boost converter is itself a natural loss-free resistor. The major difference is that 
the rms value of the ac input voltage must be used, and that the second harmonic components of r2, j 2, 
and g2 must additionally be removed via averaging. Nonetheless, the equivalent circuit and ac transfer 
functions are of similar form. 
When the rectifier drives a regulated de-de converter as in Fig. 18.25, then the de-de converter 
presents a constant power load to the rectifier, as illustrated in Fig. 18.26. In equilibrium, the rectifier and 
de-de converter operate with the same average power Pav and the same de voltage V. The incremental 
resistance R of the constant power load is negative, and is given by 
(18.104) 
which is equal in magnitude but opposite in polarity to the rectifier incremental output resistance r2 , for 
all controllers except the NLC controller. The parallel combination r2 11 R then tends to an open circuit, 
and the control-to-output and line-to-output transfer functions become 

18.5 RMS Values of Rectifier Waveforms 
673 
v(s) 
}2 
(18.105) 
Ocantro~s):::: sC 
and 
(18.106) 
In the case of the NLC controller, the parallel combination r 2 11 R becomes equal to r 212, and Eqs. 
(18.102) and (18.103) continue to apply. 
18.5 
RMS VALUES OF RECTIFIER WAVEFORMS 
To correctly specify the power stage elements of a near-ideal rectifier, it is necessary to compute the root-
mean-square values of their currents. A typical waveform such as the transistor current of the boost con-
verter (Fig. 18.31) is pulse-width modulated, with both the duty cycle and the peak amplitude varying 
with the ac input voltage. When the switching frequency is much larger than the ac line frequency, then 
the rrns value can be well-approximated as a double integral. The square of the current is integrated first 
to find its average over a switching period, and the result is then integrated to find the average over the ac 
line period. 
Computation of the rms and average values of the waveforms of a PWM rectifier can be quite 
tedious, and this can impede the effective design of the power stage components. In this section, several 
approximations are developed, which allow relatively simple analytical expressions to be written for the 
rms and average values of the power stage currents, and which allow comparison of converter 
approaches [14,41]. The transistor current in the boost rectifier is found to be quite low. 
The rms value of the transistor current is defined as 
/Qnns= 
(18.107) 
where Tac is the period of the ac line waveform. The integral can be expressed as a sum of integrals over 
all of the switching periods contained in one ac line period: 
J Qrms = 
(18.108) 
l111 
~~~ 
Fig. 18.31 
Modulated transistor current waveform, boost rectifier. 

674 
Pulse-Width Modulated Rectifiers 
where Ts is the switching period. The quantity inside the parentheses is the value of i~ averaged over the 
nth switching period. The summation can be approximated by an integral in the case when Ts is much less 
than Tac· This approximation corresponds to taking the limit as Ts tends to zero, as follows: 
/ Qrms;::;: 
(18.109) 
So i~(t) is first averaged over one switching period. The result is then averaged over the ac line period, 
and the square root is taken of the result. 
18.5.1 
Boost Rectifier Example 
For the boost rectifier, the transistor current iQ(t) is equal to the input current when the transistor con-
ducts, and is zero when the transistor is off. Therefore, the average of i~(t) over one switching period is 
(18.110) 
If the input voltage is given by 
(18.111) 
then the input current will be 
iaJt) = ~M I sin Wt I 
e 
(18.112) 
where Re is the emulated resistance. With a constant output voltage V, the transistor duty cycle must obey 
the relationship 
_____I_ = _1_ 
V aJt) 
1 - d(t) 
(18.113) 
This assumes that the converter dynamics are fast compared to the ac line frequency. Substitution of Eq. 
(18.111) into (18.113) and solution for d(t) yields 
d(t) = 1 - V; I sin wt I 
(18.114) 
Substitution ofEqs. (18.112) and (18.114) into Eq. (18.110) yields the following expression 

18.5 RMS Values of Rectifier Waveforms 
675 
One can now plug this expression into Eq. (18.109): 
I Qnns= 
which can be further simplified to 
IQnns= 
This involves integration of powers of sin(oot) over a complete 
half-cycle. The integral can be evaluated with the help of the fol-
lowing formula: 
{ 
2 2-4·6···(n- 1) 
1 
n 
n 
1·3·5···n 
n l sin"(9)de = 
1·3·5 .. ·(n-1) 
2·4·6 .. ·n 
ifn is odd 
(18.118) 
ifn is even 
This type of integral commonly arises in rms calculations 
involving PWM rectifiers. The values of the integral for several 
choices of n are listed in Table 18.2. Evaluation of the integral in 
Eq. (18.117) using Eq. (18.118) leads to the following result: 
(18.119) 
It can be seen that the rms transistor current is minimized by 
choosing the output voltage V to be as small as possible. The 
best that can be done is to choose V = V M, which leads to 
I Qnns = 0.39 I ac rnrs 
Larger values of V lead to a larger rms transistor current. 
(18.116) 
(18.117) 
Table 18.2 Solution of the integral of 
Eq. (18.118), for several values of n 
n 
2 
3 
4 
5 
6 
!r r 
sin" (9)d9 
2 n 
1 2 
4 
31t 
3 8 
16 
151t 
15 
48 
(18.120) 
A similar analysis for the rms diode current leads to the following expression 
(18.121) 
The choice V = V M maximizes the rms diode current, with the result 

676 
Pulse-Width Modulated Rectifiers 
[ Dm1s = 0.92/ ac rms 
(18.122) 
Larger values of V lead to smaller rms diode current. 
Average currents can be computed in a similar way. The results are 
(18.123) 
Expressions for rms, average, and peak currents of the power stage components of the continuous con-
duction mode boost converter are summarized in Table 18.3. Expressions are also tabulated for ftyback 
and SEPIC topologies, operating in the continuous conduction mode. In the case of the ftyback converter, 
an L1-C1 input filter is also included. In all cases, the effects of switching ripple are neglected. 
18.5.2 
Comparison of Single-Phase Rectifier Topologies 
When isolation is not a rectifier requirement, and when it is acceptable that the de output voltage be mar-
ginally larger than the peak ac input voltage, then the boost converter is a very effective approach. For 
example, consider the design of a 1 kW rectifier operating from the 240 Vrms input line voltage. If the 
converter efficiency and power factor are both approximately unity, then the rms input current is 
lrms = (1000 W)/(240 V) = 4.2 A. The de output voltage is chosen to be 380 V, or slightly larger than the 
peak ac input voltage. By use of Eq. (18.119), the rms transistor current is found to be 2 A. This is quite 
a low value-less than half of the rms input current, which demonstrates how effectively the converter 
utilizes the power switch. The rms diode current is 3.6 A, and the transistor and diode blocking voltages 
are 380 V. With a 120 A ac input voltage, the transistor and diode rms currents increase to 6.6 A and 5.1 
A, respectively. 
The only real drawback of the boost converter is its inability to limit inrush currents. When the 
de. output voltage is less than the instantaneous input voltage, the control circuit of the boost rectifier 
loses control of the inductor current waveform. A very large inrush current occurs when the de output 
capacitor is initially charged. Additional circuitry must be employed to limit the magnitude of this cur-
rent. 
Buck-boost, SEPIC, and Cuk topologies can be used to solve the inrush current problem. Since 
these converters have a d/(1 - d) conversion ratio, their waveforms can be controlled when the output 
voltage is any positive value. But the price paid for this capability is increased component stresses. For 
the same 1 kW rectifier with 240 Vrms ac input and 380 V output, the transistor rms current and peak 
voltage of the nonisolated SEPIC are 5.5 A and 719 V. The rms diode current is 4.85 A. The semiconduc-
tor voltage stresses can be reduced by reducing the output voltage, at the expense of increased rms cur-
rents. With a 120 V ac input voltage, the transistor and diode rms currents increase to 9.8 A and 6.1 A, 
respectively. 
Isolation can also be obtained in the SEPIC and other topologies, as discussed in Chapter 6. The 
turns ratio of the isolation transformer can also be used to reduce the primary-side currents when the de 
output voltage is low. But the transformer winding rrns currents are higher than those of a de-de con-
verter, because of the pulsating (twice-line-frequency) power flow. For the 1 kW, 240 V ac input SEPIC 
example, with a 42 V 23.8 A de load, and a 4:1 transformer turns ratio, the rms transformer currents are 
5.5 A (primary) and 36.4 A (secondary). The rms transistor current is 6.9 A. At 120 V ac input voltage, 

18.5 RMS Values of Rectifier Waveforms 
677 
Table 18.3 
Summary of rectifier current stresses for several converter topologies 
rms 
Average 
Peak 
CCMboost 
Transistor 
J 
8 VM 
Iaerms 
1 - 3n V 
Iaenns 2~(1-~ v;) 
IaemJSI2 
Diode 
!« 
Ide 
v 
Ide 
2Idev 
M 
Inductor 
J ac rms 
212 
[ ac m1s -----,r-
IaemJSI2 
CCM fly back, with n: 1 isolation transformer and input filter 
Transistor, xfmr primary 
J 
8 VM 
IaemJS 
1 + 3n nV 
212 
J ac rms ----n 
Iaerms 12 (I+ ~V) 
Ll 
J ac rms 
212 
[acnns~ 
I aennsl2 
cl 
/ ac n11s JIW 
0 
laerms 12 max ( 1. ~V) 
Diode, xfmr secondary 
I Jl+JfJ.. nV 
de 
2 
3nVM 
Ide 
2/de ( 1 + ~~) 
CCM SEPIC, nonisolated 
Transistor 
J 
8 VM 
/aem>S 
1 + 3n V 
212 
/ ac m1s ----n 
laenns12(1+ V;) 
Ll 
/ ac rms 
212 
/ ac rms ----n-
/ acrmsl2 
cl 
/ ac nns ill 
0 
Iaenns 12 max ( 1, V;) 
L2 
VM .J3 
[acnns VM 
VM 12 
faerms V T 
12V 
/acrms V 
2 
Diode 
J3 
16 v 
Ide 
2+3nVM 
Ide 
21 de (I + J'M) 
CCM SEPIC, with n: I isolation transformer 
Transistor 
J 
8 VM 
IaernJS 
I+ 3n nV 
212 
/acrms ---n 
laem,12(1+ ~v) 
LI 
[ ac rms 
212 
J ac rms ----n-
I aermsl2 
Cp xfmr primary 
JIW 
Jacrms 
3 
0 
lac mrs 12 max (I, ~V) 
Diode, xfmr secondary 
I Jl+JfJ.. nV 
de 
2 
3nVM 
Ide 
2Ide(1+v~) 
· h · 
]] 
I aerms 
r;;2 V 
· 
I 
V 
. ( ) d 
J 
wit , m a cases, - 1-
= ,y.::V, ac mput vo tage = M sm Wt, c output vo tage = V. 
de 
M 

678 
Pulse-Width Modulated Rectifiers 
these currents increase to 7.7 A, 42.5 A, and ll.4 A, respectively. 
18.6 
MODELING LOSSES AND EFFICIENCY IN CCM HIGH-QUALITY RECTIFIERS 
As in the case of de-de converters, we would like to model the converter loss elements so that we can 
correctly specify the power stage components. The equivalent circuit approach used in the de-de case 
can be generalized to include ac-dc low harmonic rectifiers, although the resulting equations are more 
complicated because of the low-frequency ac modulation of the waveforms. 
A de-de boost converter and its steady-state equivalent circuit are illustrated in Fig. 18.32. 
When the converter operates in equilibrium, the modeJ.of Fig. 18.32(b) can be solved to determine the 
converter losses and efficiency. In the ac-dc case, the input voltage v /t) is a rectified sinusoid, and the 
controller varies the duty cycle d(t) to cause ig(t) to follow v/t) according to 
(18.124) 
The emulated resistance Re is chosen by the controller such that the desired de output voltage is obtained. 
Ac variations in d(t), v/t), and several other system waveforms are not small, and hence the small-signal 
approximation employed in Chapters 7 to 12 is not justified. We can continue to model the low-fre-
quency components of the converter via averaging, but the resulting equivalent circuits are, in general, 
time-varying and nonlinear. 
For the purposes of determining the rectifier efficiency, it is assumed that (1) the inductor is suf-
ficiently small, such that it has negligible influence on the ac-line-frequency components of the system 
waveforms, and (2) the capacitor is large, so that the output voltage v(t) is essentially equal to its equilib-
rium de value, with negligible low- or high-frequency ac variations. So in the ac-dc case, the model 
becomes as shown in Fig. 18.33. Low-frequency components ( < fs) of the controller waveforms are 
sketched in Fig. 18.34. 
(a) 
i(t) 
+ 
R 
v(t) 
(b) 
i(t) 
+ 
R 
v(t) 
Fig. 18.32 De-de boost converter, (a), and a steady-state equivalent circuit, (b), which models the inductor resis-
tance RL, MOSFET on-resistance Ron' and diode forward voltage drop VF. 

18.6 Modeling Losses and Efficiency in CCM High-Quality Rectifiers 
679 
(a) 
(b) 
Controller 
c 
(Large) 
i(t) =I 
R 
i(t) 
+ 
c 
v(t) 
R 
+ 
v(t) = V 
Fig. 18.33 Ac-dc boost rectifier, (a), and a low-frequency equivalent circuit, (b), that models converter losses and 
efficiency. 
To find the rectifier waveforms, losses, and efficiency, we must solve the circuit of Fig. 
18.33(b), under the conditions that the controller varies the duty cycle d(t) such that Eq. (18.124) is satis-
fied. This leads to time-varying circuit elements d(t)R011 and the d'(t): 1 transformer. The solution that fol-
lows involves the following steps: (1) solve for the d(t) waveform; (2) average iit) to find its de 
component, equal to the load current/; and (3) find other quantities of interest such as the rectifier effi-
ciency. 
The simplified boost converter circuit model of Fig. 18.35, in which only the MOSFET conduc-
tion loss is accounted for, is solved here. However, the results can be generalized directly to the circuit of 
Fig. 18.33(b); doing so is left as a homework problem. A similar procedure can also be followed to derive 
expressions for the losses and efficiencies of other rectifier topologies. 
18.6.1 
Expression for Controller Duty Cycle d(t) 
The controller varies the duty cycle d(t) such that Eq. (18.124) is satisfied. By solving the input-side loop 
of Fig. 18.35, we obtain 
(18.125) 
Substitute Eq. (18.124) into (18.125) to eliminate igCt): 
(18.126) 

680 
Pulse-Width Modulated Rectifiers 
vgCt) 
igCt) 
300 
10 
8 
200 
6 
4 
100 
2 
0 
0 
oo 
30° 
60° 
90° 
120° 
150° 
180° 
d(t) 
0.8 
0.6 
0.4 
0.2 
0 
oo 
30° 
60° 
90° 
120° 
150° 
180° 
6 
5 
4 
3 
2 
0 
oo 
30° 
60° 
90° 
120° 
150° 
180° 
Wt 
Fig. 18.34 
Typical low-frequency components of the boost rectifier waveforms. 
with 
vgCt) = V M I sin WI I 
(18.127) 
We can now solve for the duty cycle d(t). The result is 

18.6 Modeling Losses and Efficiency in CCM High-Quality Rectifiers 
681 
ig(t) 
d'(t): 1 
i(t) =I 
iit) 
+ 
vgCt) 
c 
(Large) 
R 
v(t) = V 
Fig. 18.35 
Simplified boost power stage low-frequency equivalent circuit, in which only the MOSFET on-resis-
tance is modeled. 
(18.128) 
This expression neglects the converter dynamics, an assumption that is justified when these dynamics are 
sufficiently faster than the ac line voltage variation. The expression also neglects operation in the discon-
tinuous conduction mode near the zero-crossing of the ac line voltage waveform. This is justified when 
the rectifier operates in the continuous conduction mode for most of the ac line cycle, because the power 
loss near the zero-crossing is negligible. 
18.6.2 
Expression for the DC Load Current 
By charge balance on output capacitor C, the de load current I is equal to the de component of the diode 
current id: 
Solution of Fig. 18.35 for id(t) yields 
v (t) 
iit) = d'(t)ig(t) = d'(t) _g_ 
Re 
From Eq. (18.128), d'(t) = 1- d(t) is given by 
so 
(1_Roo) 
. ( )- vM 
Re 
zd t --x-
R 
e V- V (f)--"!!. 
g 
R, 
(18.129) 
(18.130) 
(18.131) 
(18.132) 

682 
Pulse-Width Modulated Rectifiers 
Now substitute vgCt) = V M sin Wt, and integrate to find (iit) )Tac: 
(18.133) 
Again, Tac = 2nlw is the ac line period. Equation (18.133) can be rewritten as 
V2 ( 
R ) lTa!2 
sin2 (rot) 
l=_]._____M_ 1----"". 
dt 
Tac V Re 
Re 
0 
1 -a sin (rot) 
(18.134) 
where 
a= ( V; )( ~:') 
(18.135) 
By waveform symmetry, we need only integrate from 0 to TaJ4. Also, make the substitution 8 = wt: 
I = ~ 
1 - Ron ~ 
sm 
de 
z ( 
) Jrr1z 
. 2 (e) 
VRe 
Re 
0 1-asin(e) 
(18.136) 
Evaluation of this integral is tedious. It arises in not only the boost rectifier, but in a number of other 
high-quality rectifier topologies as well. The derivation is not given here, but involves the substitution 
z = tan(8/2), performing a partial fraction expansion of the resulting rational function of z, and integra-
tion of the results. The solution is: 
41"12 
sin 2 (e) 
__ 2 ( 
4sin- 1(a)+2cos- 1 (a)) 
n 
. ( ) de-F(a)--2-
-2a-n+ 
~ 
0 
1 -a Sill e 
a 1t 
V 1- a-
(18.137) 
This equation is somewhat complicated, but it is in closed form, and can easily be evaluated by computer 
spreadsheet. The quantity a, which is a measure of the loss resistance R011 relative to the emulated resis-
tance Re, is typically much smaller than 1. F(a) is plotted in Fig. 18.36. The function F(a) can be well-
approximated as follows: 
F(a)"' 1 + 0.862a + 0.78a 2 
(18.138) 
For I a I:::; 0.15, the F(a) predicted by this approximate expression is within 0.1% of the exact value. If the 
a2 term is omitted, then the accuracy drops to ± 2% over the same range of a. The rectifier efficiency ll 
calculated in the next section depends directly on F(a), and hence the accuracy of F(a) coincides with the 
accuracy of ll· 

18.6 Modeling Losses and Efficiency in CCM High-Quality Rectifiers 
683 
1.15 
1.1 
1.05 
F(a) 
0.95 
0.9 
0. 85 +-+-++-+-+-+-+--+-+-+-+--+-+-++-+-+--+-+-+-+-+-+-+-t-+-+-+-+--l 
-0.15 
-0.10 
-0.05 
0.00 
0.05 
0.10 
0.15 
a 
Fig. 18.36 Plot of the integral F(a) vs. a. 
18.6.3 
Solution for Converter Efficiency 11 
Now that we have found the de load current, we can calculate the converter efficiency 11· The average 
input power is 
(18.139) 
The average load power is 
P =Vl=(v)(v~ (1-R"")F(a)) 
our 
VR, 
R, 
2 
(18.140) 
where 
a = ( VV )( ~~') 
(18.141) 
Here, we have substituted Eq. (18.136) for I. The efficiency is therefore 
(18.142) 
by substitution of Eqs. (18.139) and (18.140). If desired, the parabolic approximation for F(a), Eq. 
(18.138), can be employed. This leads to 
T/"'(1-R"")(1+0.862 VM R""+0.78(VM Ron)
2
] 
Re 
V R, 
V R, 
(18.143) 
Equations (18.142) and (18.143) show how the efficiency varies with MOSFET on resistance Ron and 

684 
Pulse-Width Modulated Rectifiers 
11 
0.95 
0.9 
0.85 
0.8 
0.75 
0.0 
0.2 
0.4 
0.6 
0.8 
1.0 
VMIV 
Fig. 18.37 Boost rectifier efficiency, Eq. (18.142), accounting for MOSFET on resistance. 
with ac peak voltage V M" Equation ( 18.142) is plotted in Fig. 18.37. It can be seen that high efficiency is 
obtained when the peak ac line voltage V M is close to the de output voltage V. Efficiencies in the range 
90% to 95% can then be obtained, even with MOSFET on-resistances as high as 0.2Re. Of course, Fig. 
18.37 is optimistic because it neglects sources of loss other than the MOSFET conduction loss. 
18.6.4 
Design Example 
Let us utilize Fig. 18.37 to design for a given efficiency. Consider the following specifications: 
Output voltage 
390 V 
Output power 
500 W 
rrns input voltage 
120 V 
Efficiency 
95% 
Assume that losses other than the MOSFET conduction loss are negligible. The average input power is 
p. = pout = 500 W = 526 W 
"' 
TJ 
0.95 
(18.144) 
The emulated resistance is therefore 
y2 
2 
R = 
g,rms=(120V) = 274 Q 
e 
P;, 
526W 
. 
(18.145) 
Also, 
VM = 12012V =0435 
V 
390V 
. 
(18.146) 
From Fig. 18.37, or by evaluation of the exact equation (18.142), 95% efficiency with VMIV = 0.435 
occurs with R0n!Re"' 0.077. So we require a MOSFET having an on-resistance of 

18.7 ideal Three-Phase Rectifiers 
685 
Ron$ (0.077) Re = (0.077) (27.4 Q) = 2.11 Q 
(18.147) 
Of course, other converter losses have not been accounted for, which will reduce the efficiency. 
It is instructive to compare this result· with that obtained using the expressions for rms current 
from Section 18.5. The rms transistor current of the ideal CCM boost converter is given by Eq. (18.119). 
The rms input current will be equal to PiJVg,rms = (526 W)/(120 V) = 4.38 A. Hence, Eq. (18.119) pre-
dicts an rms transistor current of 
I 
8 VM 
[Qrms=[acrmsy 1-3nV 
= ( 4 38 A) 
/,--~-_-8----:c(l:-:::2-::-0 o-::V):-12c=2~ 
· 
V 
3n 
(390 V) 
(18.148) 
= 3.48 A 
Hence, the MOSFET on-resistance should be chosen according to 
R < P;n-Pour = (526 W)-(500W) =217 Q 
on-
[~rms 
(4.38 A)2 
, 
(18.149) 
This calculation is approximate because Eq. (18.119) was derived using the waveforms of the ideal (loss-
less) converter. Nonetheless, it gives an answer that is very close to the more exact result ofEq. (18.147). 
We would expect this approximate approach to exhibit good accuracy in this example, because of the 
high 95% efficiency. 
18.7 
IDEAL THREE-PHASE RECTIFIERS 
The single-phase ideal rectifier concepts of the previous sections can be generalized to cover ideal three-
phase rectifiers. Figure 18.38(a) illustrates the properties of an ideal three-phase rectifier, which presents 
a balanced resistive load to the utility system. A three-phase converter system is controlled such that 
resistor emulation is obtained in each input phase. The rectifier three-phase input port can then be mod-
eled by per-phase effective resistances Re, as illustrated in Fig. 18.38(a). The instantaneous powers 
apparently consumed by these resistors are transferred to the rectifier de output port. The rectifier output 
port can therefore be modeled by power sources equal to the instantaneous powers flowing into the effec-
tive resistances Re. It is irrelevant whether the three power sources are connected in series or in parallel; 
in either event, they can be combined into a single source equal to the total three-phase instantaneous 
input power as illustrated in Fig. 18.38(b). 
If the three-phase ac input voltages are 
van(t) = VM sin (wt) 
vbn(t) = V M sin ( wt- 120°) 
vC/.(t) = V M sin ( wt- 240°) 
then the instantaneous powers flowing into the phase a, b, and c effective resistances Re are 
(18.150) 

686 
Pulse-Width Modulated Rectifiers 
v 2 (t) 
V2 
( 
) 
pJt) = ___!!'!____ = _M_ 1- cos ( 2mt) 
R, 
2R, 
v 2 (t) 
V 2 ( 
) 
Pb(t) = _b_"- = _M_ 1 -cos ( 2mt- 240°) 
R, 
2R, 
(18.151) 
v 2 (t) 
V 2 
( 
) 
pJt) = -'-·"- = _M_ 1- cos ( 2mt- 120°) 
R, 
2R, 
Each instantaneous phase power contains a de term V~/(2R,), and a second-harmonic term. The total 
instantaneous three-phase power is 
(18.152) 
This is the instantaneous power which flows out of the rectifier de output port. Note that the second har-
monic terms add to zero, such that the rectifier instantaneous output power is constant. This is a conse-
quence of the fact that the instantaneous power flow in any balanced three-phase ac system is constant. 
So, unlike the single-phase case, the ideal three-phase rectifier can supply constant instantaneous power 
to a de load, without the need for internal low-frequency energy storage. 
(a) 
3¢ae 
input 
de output 
ia 
¢a 
+ 
ib 
Re 
¢b 
R 
v 
ic 
¢c 
(b) 
3¢ae 
input 
de output 
ia 
¢a 
+ 
ib 
R 
¢b 
v 
ic 
¢c 
Fig. 18.38 Development of the ideal three-phase rectifier model: (a) three ideal single-phase rectifiers, (b) combi-
nation of the three power sources into an equivalent single power source. 

3¢ac 
input 
0 
Fig. 18.39 Boost-type 3¢ac-dc PWM rectifier. 
18.7 Ideal Three-Phase Rectifiers 
687 
de output 
+ 
c 
A variety of 30ac-dc PWM rectifiers are known; a few of the many references on this subject 
are listed in the references [42-59]. The most well-known topology is the three-phase ac-dc boost recti-
fier, illustrated in Fig. 18.39. This converter requires six SPST current-bidirectional two-quadrant 
switches. The inductors and capacitor filter the high-frequency switching harmonics, and have little 
influence on the low-frequency ac components of the waveforms. The switches of each phase are con-
trolled to obtain input resistor emulation, either with a multiplying controller scheme similar to Fig. 18.5, 
or with some other approach. To obtain undistorted line current waveforms, the de output voltage V must 
be greater than or equal to the peak line-to-line ac input voltage VL.pk· In a typical realization, Vis some-
what greater than V L.pk" This converter resembles the voltagecsource inverter, discussed briefly in Chapter 
4, except that the converter is operated as a rectifier, and the converter input currents are controlled via 
high-frequency pulse-width modulation. 
The three-phase boost rectifier of Fig. 18.39 has several attributes that make it the leading can-
didate for most 30ac-dc rectifier applications. The ac input currents are nonpulsating, and hence very lit-
tle additional input EMI filtering is required. As in the case of the single-phase boost rectifier, the rms 
transistor currents and also the conduction losses of the three-phase boost rectifier are low relative to 
other 30ac-dc topologies such as the current-source inverter. The converter is capable of bidirectional 
power flow. A disadvantage is the requirement for six active devices: when compared with a de-de con-
verter of similar ratings, the active semiconductor utilization (discussed in Chapter 6) is low. Also, since 
the rectifier has a boost characteristic, it is not suitable for direct replacement of traditional buck-type 
phase-controlled rectifiers. 
The literature contains a wide variety of schemes for controlling the switches of a six-switch 
three-phase bridge network, which are applicable for control of the switches of Fig. 18.39. The basic 
operation of the converter can be most easily understood by assuming that the switches are controlled via 
simple sinusoidal pulse-width modulation. Transistor Q1 is driven with duty cycle d1(t), while transistor 
Q4 is driven by the complement of d 1(t), or d1'(t) = 1- d1(t). Transistors Q2 and Q5 are driven with duty 
cycles dz(t) and d2'(t), respectively, and transistors Q3 and Q6 are driven with duty cycles d3(t) and d3'(t), 
respectively. The switch voltage waveforms of Fig. 18.40 are obtained. The average switch voltages are 

688 
Pulse-Width Modulated Rectifiers 
Fig. 
18.40 Switch waveforms, 3!1lac-dc 
boost rectifier. 
v3o(t) 
v 
( v10(t))T = d1 ( v(t))T 
________________________ -!..____________ _ ___ §____________ -· 
0 
0 
dl 
v 
( Vzo(t))T = dz ( v(t))T 
_______________ .,:! ___________________ .§____________ -
jo 
0 
y 
T, 
v 
( v3o(t)); = d3 ( v(t))T 
_____________________ .,:! ________________ ..§ __________ --
i 0 
9 
l d3Ts 
Tf 
Conducting i,_-Q1t v1 
l 
i 
i+Q4 / D4 +!.·, 
devices: 
!-Qz!Dz •= : 
QsiDs•l 
l-Q31 D3 -i- Q6/ D6 -.i 
The averaged line-to-line switch voltages are therefore 
(v12(t))r, =(vw(t))T, -(v20(t))T, =(d1(t)-d2(t)) (v(t))T, 
( Vz3(t)) T, = ( Vzo{t)) T,- ( V3o(t)) T, = ( dz(t)- d3(t)) ( v(t)) T, 
(v3J(t))T, = (v3o(t))r,- (vw(t))r, = (d3(t)-d1(t)) (v(t))r, 
In a similar manner, the average switch currents can be shown to be 
(18.153) 
(18.154) 

18.7 Ideal Three-Phase Rectifiers 
689 
Equations (18.154) and (18.155) lead to the circuit-averaged model of Fig. 18.41. 
With sinusoidal PWM, the duty cycles are varied sinusoidally in synchronism with the ac line, 
as follows: 
d 1(t) = D0 + ~ Dm sin (wt -<p) 
dz(t) = D0 + ~ Dm sin ( Wt- <p- 120°) 
d3(t) = D0 + t Dm sin ( Wt- <p- 240°) 
(18.156) 
where w is the ac line frequency. Since each instantaneous duty cycle must lie in the interval [0,1], the de 
bias D0 is required. The factor Dm is called the modulation index; for D0 = 0.5, Dm must be less than or 
equal to one. Other choices of D0 further restrict Dm. In general, the modulation index can be defined as 
equal to the peak-to-peak amplitude of the fundamental component of the duty cycle variation. 
If the switching frequency is sufficiently large, then filter inductors L can be small in value, such 
that they have negligible effect on the low-frequency ac waveforms. The averaged switch voltage 
(v12(t))T, then becomes approximately equal to the ac line-line voltage vab(t): 
(18.157) 
Substitution ofEqs. (18.150) and (18.156) leads to 
~ D m l 
sin ( wt - (jl) - sin ( Wt - (jl - 120°) j ( 
v(t)) T, = V M [sin ( Wt) - sin ( Wt - 120°)] 
(18.158) 
For small L, the angle <p must tend to zero, and hence the sinusoidal terms in Eq. (18.158) cancel out. In 
steady-state, the de output voltage is (v(t))T, = V. Equation (18.158) then becomes 
(18.159) 
Solution for the de output voltage V leads to 
Fig. 18.41 
Averaged model of the open-loop 3¢ac-dc boost rectifier. 

690 
Pulse-Width Modulated Rectifiers 
V=2VM 
Dm 
Equation (18.160) can be written in terms of the peak line-to-line voltage VL,pk• as 
(18.160) 
(18.161) 
With Dm::::; 1, the de output voltage V must be greater than or equal to 1.15 times the peak line-to-line ac 
input voltage. Thus, the rectifier has a boost characteristic. 
The sinusoidal PWM approach of Eq. (18.156) is not the only way to vary the duty cycles to 
obtain sinusoidal ac voltages and currents. For example, trip len harmonics can be added to the duty cycle 
expressions of Eq. (18.156). These triplen harmonics cancel out in Eq. (18.154), such that the average 
inverter input voltages ( v1it) )Ts' ( v23(t) \;• and ( v31(t) )J:, contain only fundamental. Figure 18.42 illus-
trates duty cycle variations that lead to a de output voltage V equal to VL.pk· The effective modulation 
index in this case is 1.15. The ac-side voltages and currents are again undistorted. Further increases in the 
modulation index can be attained only by introduction of distortion in the ac-side voltages and currents. 
Of course, in practice the duty cycle modulations are usually generated by the feedback loops that con-
trol the input current waveforms to attain resistor emulation. 
Three-phase ac-to-de rectifiers having buck, buck-boost, or other characteristics, are possible, 
but find much less use than the boost topology. A 3¢ac-dc rectifier system can also be constructed simply 
using three separate single-phase rectifiers [34]; however, each single-phase rectifier must then contain 
transformer isolation, leading to substantially increased switch stress and loss. Other unconventional 
approaches to three-phase low-harmonic rectification have also been recently explored, such as the 
Vienna rectifier [56,59], single-switch approaches [49-55], and other circuits[44,45,46,57,58]. 
Yet another approach to solving the problem of three-phase rectifier harmonics is the harmonic 
correction scheme illustrated in Fig. 18.43. An active six-switch three-phase bridge removes the harmon-
ics generated by a nonlinear three-phase load such as an uncontrolled rectifier. The harmonic corrector is 
controlled such that its ac line currents contain harmonics that are equal in magnitude but opposite in 
phase to the harmonics generated by the nonlinear load. No average power flows into the harmonic cor-
rector. The total kVA rating of the harmonic corrector semiconductor devices depends on the magnitudes 
of the harmonics produced by the nonlinear load. If the THD generated by the load is not too large, then 
Fig. 
18.42 A modula-
tion strategy that leads to a 
0.5 
de output voltage equal to 
the peak input line-line 
voltage. 
0 
-0.5 
(f)f 
00 
60° 
120° 
180° 
240° 
300° 
360° 

18.8 Summary of Key Points 
691 
Nonlinear load 
r·-----------------------------------------------------------------------------------------------------------------------------1 
-----.-+'J 
! 
i 
i ! 
! 
i 
! 
i ' ' 
L------------------------------------------------------------------------------------------------------------------------------: 
~--- - -- ---- -------- - - - - - -------- -I 
! 
i 
i 
! 
! 
! 
! 
1 
! 
i 
L---------------------------------------------------------------------------------------------------------------------------------------------------------------.! 
Harmonic corrector 
Fig. 18.43 
A harmonic corrector, based on the 30ac-dc CCM boost converter of Fig. 18.39. 
the harmonic corrector scheme requires less total active silicon than the CCM boost-type rectifier of Fig. 
18.39. But if the uncontrolled rectifier contains small ac line inductances, such that it operates in the dis-
continuous conduction mode with large THD, then it is probably better to simply replace the uncon-
trolled rectifier with the CCM boost-type rectifier of Fig. 18.39. 
18.8 
1. 
2. 
3. 
SUMMARY OF KEY POINTS 
The ideal rectifier presents an effective resistive load, the emulated resistance Re, to the ac power system. 
The power apparently "consumed" by Re is transferred to the de output port. In a three-phase ideal recti-
fier, input resistor emulation is obtained in each phase. In both the single-phase and three-phase cases, the 
output port follows a power source characteristic, dependent on the instantaneous ac input power. Ideal 
rectifiers can perform the function of low-harmonic rectification, without need for low-frequency reactive 
elements. 
The de-de boost converter, as well as other converters capable of increasing the voltage according to Eq. 
(18.12), can be adapted to the ideal rectifier application. A control system causes the input current to be 
proportional to the input voltage. The converter may operate in CCM, DCM, or in both modes. The mode 
boundary can be expressed as a function of Re, 2L/Ts, and the instantaneous voltage ratio v/t)IV. A well-
designed average current controller leads to resistor emulation regardless of the operating mode; however, 
other schemes may lead to distorted current waveforms when the mode boundary is crossed. 
In a single-phase system, the instantaneous ac input power is pulsating, while the de load power is con-
stant. Whenever the instantaneous input and output powers are not equal, the ideal rectifier system must 

692 
Pulse-Width Modulated Rectifiers 
contain energy storage. A large capacitor is commonly employed; the voltage of this capacitor must be 
allowed to vary independently, as necessary to store and release energy. A slow feedback loop regulates the 
de component of the capacitor voltage, to ensure that the average ac input power and de load power are 
balanced. 
4. 
RMS values of rectifiers waveforms can be computed by double integration. In the case of the boost con-
verter, the rms transistor current can be as low as 39% ofthe rms ac input current, when the de output volt-
age Vis close in value to the peak ac input voltage V M" Other converter topologies such as the buck-boost, 
SEPIC, and Cuk converters exhibit significantly higher rms transistor currents but are capable of limiting 
the converter inrush current. 
5. 
In the three-phase case, a boost-type rectifier based on the PWM voltage-source inverter also exhibits low 
rms transistor currents. This approach requires six active switching elements, and its de output voltage 
must be greater than the peak input line-to-line voltage. Average current control can be used to obtain input 
resistor emulation. An equivalent circuit can be derived by averaging the switch waveforms. The converter 
operation can be understood by assuming that the switch duty cycles vary sinusoidally; expressions for the 
average converter waveforms can then be derived. 
6. 
Converter losses and efficiency can be modeled using the steady-state equivalent circuit models of Chapter 
3, with a time-varying duty cycle. The output current is averaged over one ac line period, to determine its 
de component. The converter losses and efficiency can then be computed. This approach is approximate, in 
that (i) it assumes that the converter dynamics are much faster than the ac line frequency, and (ii) it 
neglects operation in the discontinuous conduction mode. 
7. 
Average current control involves direct regulation of the low-frequency components of the rectifier input 
current to follow the input voltage. Feedforward can also be added, to cancel the influence of ac line volt-
age variations on the de output voltage. 
8. 
Current programmed control can also be adapted to attain input resistor emulation in rectifiers. The pro-
grammed current reference signal ic(t) is made proportional to the ac input voltage. The difference 
between ic(t) and the average inductor current leads to distortion, owing to the inductor current ripple and 
the need for a stabilizing artificial ramp. Several approaches are known for reducing the resulting har-
monic distortion of the line current waveform. 
9. 
Hysteretic control, particularly with 100% current ripple, has a simple controller implementation. The dis-
advantages are variable switching frequency, and increased peak currents. 
10. 
Nonlinear carrier control also leads to a simple controller implementation, and has the advantage of CCM 
operation with small peak transistor current. 
11. 
The outer low-bandwidth control system, which regulates the de output voltage to balance the rectifier and 
load powers, can be modeled by averaging the rectifier waveforms over one-half of the ac line period T2L. 
This causes the de-side system equations to become time-invariant. A small-signal model is then obtained 
by perturbation and linearization. 
12. 
The inner high-bandwidth control system, which regulates the ac input current waveform to attain resistor 
emulation, is in general highly nonlinear. However, in the case of the boost rectifier, a valid small-signal 
model can be derived. This approach is unsuccessful in the case of other converters; one must then resort 
to other approaches such as the quasi-static approximation or simulation. 
REFERENCES 
[1] 
D. CHAMBERS and D. WANG, "Dynamic Power Factor Correction in Capacitor Input Off-Line Convert-
ers," Proceedings Sixth National Solid-State Power Conversion Conference (Powercon 6), pp. B3-1 to B3-
6, May 1979. 

References 
693 
[2] 
R. ERICKSON, M. MADIGAN, and S. SINGER, "Design of a Simple High Power Factor Rectifier Based on 
the Flyback Converter," IEEE Applied Power Electronics Conference, 1990 Record, pp. 792-801. 
[3] 
S. SINGER and R.W. ERICKSON, "Power Source Element and Its Properties," lEE Proceedings-Circuits 
Devices Systems, Vol. 141, No.3, pp. 220-226, June 1994. 
[4] 
S. SINGER, "Realization of Loss-Free Resistive Elements," IEEE Transactions on Circuits and Systems, 
Vol. CAS-36, No. 12, January 1990. 
[5] 
W. E. RIPPEL, "Optimizing Boost Chopper Charger Design," Proceedings Sixth National Solid-State 
Power Conversion Conference (Powercon 6), 1979, pp. D1-1- D1-20. 
[6] 
M. F. SCHLECHT and B. A. MIWA, "Active Power Factor Correction for Switching Power Supplies," IEEE 
Transactions on Power Electronics, Vol. 2, No.4, October 1987, pp. 273-281. 
[7] 
J. SEBASTIAN, J. UCEDA, J. A. COBOS, J. ARAU, and F. ALDANA, "Improving Power Factor Correction in 
Distributed Power Supply Systems Using PWM and ZCS-QR SEPIC Topologies," IEEE Power Electron-
ics Specialists Conference, 1991 Record, pp. 780-791. 
[8] 
E. YANG, Y. JIANG, G. HUA, and F. C. LEE, "Isolated Boost Circuit for Power Factor Correction," IEEE 
Applied Power Electronics Conference, 1993 Record, pp. 196-203. 
[9] 
C. A. CANESIN and I BARBI, "A Unity Power Factor Multiple Isolated Outputs Switching Mode Power 
Supply Using a Single Switch," IEEE Applied Power Electronics Conference, 1991 Record, pp. 430-436. 
[10] 
S. FREELAND, "1. A Unified Analysis of Converters with Resonant Switches, II. Input-Current Shaping for 
Single-Phase Ac-<ic Power Converters," Ph.D. Thesis, California Institute of Technology, 1988. 
[11] 
M. J. SCHUTTEN, R. L. STEIGERWALD, and M. H. KHERALUWALA, "Characteristics of Load-Resonant 
Converters Operated in a High Power Factor Mode," IEEE Applied Power ElectroniCs Conference, 1991 
Record, pp. 5-16. 
[12] 
J. HONG, E. ISMAIL, R. ERICKSON, and I. KHAN, "Design of the Parallel Resonant Converter as a Low Har-
monic Rectifier," IEEE Applied Power Electronics Conference, 1993 Record, pp. 833-840. 
[13] 
I. BARB! and S. A. 0. DASILVA, "Sinusoidal Line Current Rectification at Unity Power Factor with Boost 
Quasi-Resonant Converters," IEEE Applied Power Electronics Conference, 1990 Record, pp. 553-562. 
[14] 
R. REDL and L. BALOGH, "RMS, DC, Peak, and Harmonic Currents in High-Frequency Power-Factor Cor-
rectors with Capacitive Energy Storage," IEEE Applied Power Electronics Conference, 1992 Record, pp. 
533-540. 
[15] 
J. SEBASTIAN, J. A. COBOS, P. GIL, and J. UCEDA, "The Determination of the Boundaries Between Contin-
uous and Discontinuous Conduction Modes in PWM De-to-De Converters Used as Power Factor Preregu-
lators," IEEE Power Electronics Specialists Conference, 1992 Record, pp. 1061-1070. 
[16] 
M. NALBANT, "Design of a 1 kW Power Factor Corrector," Power Conversion, October 1989 Proceedings, 
pp. 121-135. 
[17] 
R. MAMMANO and R. NEIDORFF, "Improving Input Power Factor-A New Active Controller Simplifies 
the Task," Power Conversion, October 1989 Proceedings, pp. 100-109. 

694 
Pulse-Width Modulated Rectifiers 
[18] 
J. BAZIMET and J. O'CONNOR, "Analysis and Design of a Zero Voltage Transition Power Factor Correction 
Circuit," IEEE Applied Power Electronics Conference, 1994 Record, pp. 591-597. 
[19] 
R. REDL and B. ERISMAN, "Reducing Distortion in Peak-Current,Controlled Boost Power Factor Correc-
tors," IEEE Applied Power Electronics Conference, 1994 Record, pp. 576-583. 
[20] 
C. ZHOU and M. JOVANOVIC, "Design Tradeoffs in Continuous Current-Mode Controlled Boost Power 
Factor Correction Circuits," High Frequency Power Conversion Conference, 1992 Proceedings, pp. 209-
220. 
[21] 
D. MAKSIMOVIC, "Design of the Clamped-Current High-Power-Factor Boost Rectifier," IEEE Applied 
Power Electronics Conference, 1994 Record, pp. 584-590. 
[22] 
C. CANESIN and I. BARB!, "Analysis and Design of Constant-Frequency Peak-Current-Controlled High-
Power-Factor Boost Rectifier with Slope Compensation," IEEE Applied Power Electronics Conference, 
1996 Record, pp. 807-813. 
[23] 
J. LA! and D. CHEN, "Design Considerations for Power Factor Correction Boost Converter Operating at 
the Boundary of Continuous Conduction Mode and Discontinuous Conduction Mode," IEEE Applied 
Power Electronics Conference, 1993 Record, pp. 267-273. 
[24] 
C. ZHOU, R. RIDLEY, and F. C. LEE, "Design and Analysis of a Hysteretic Boost Power Factor Correction 
Circuit," IEEE Power Electronics Specialists Conference, 1990 Record, pp. 800-807. 
[25] 
S. AHMED, "Controlled On-Time Power Factor Correction Circuit with Input Filter," M.S. Thesis, Virginia 
Polytechnic Institute and State University, Blacksburg VA, May 1990. 
[26] 
M. DAWANDE and G. DUBEY, "Programmable Input Power Factor Correction Method for Switch Mode 
Rectifiers," IEEE Applied Power Electronics Conference, 1993 Record, pp. 274-280. 
[27] 
J. SPANGLER and A. BEHERA, "A Comparison Between Hysteretic and Fixed Frequency Boost Converters 
Used for Power Factor Correction," IEEE Applied Power Electronics Conference, 1993 Record, pp. 281-
286. 
[28] 
D. MAKSIMOVIC, Y. JANG, and R. ERICKSON, "Nonlinear-Carrier Control for High Power Factor Boost 
Rectifiers," IEEE Applied Power Electronics Conference, 1995 Record, pp. 635-641 
[29] 
R. ZANE and D. MAKSIMOVIC, "Nonlinear Carrier Control for High Power Factor Rectifiers Based on Fly-
back, Cuk, or SEPIC Converters," IEEE Applied Power Electronics Conference, 1996 Record, pp. 814-
820. 
[30] 
Z. LA!, K. SMEDLEY, andY. MA, 'Time Quantity One-Cycle Control for Power Factor Controllers," IEEE 
Applied Power Electronics Conference, 1996 Record, pp. 821-827. 
[31] 
L. ROSSETTO, G. SPIAZZI, P. TENT!, B. FABIANO, and C. LICITRA, "Fast-Response High-Quality Rectifier 
with Sliding-Mode Control," IEEE Applied Power Electronics Conference, 1993 Record, pp. 175-181. 
[32] 
W. TANG, Y. JIANG, G. HUA, F. C. LEE, and I. COHEN, "Power Factor Correction with Flyback Converter 
Employing Charge Control," IEEE Applied Power Electronics Conference, 1993 Record, pp. 293-298. 
[33] 
F. C. SCHWARZ, "An Improved Method of Resonant Current Pulse Modulation for Power Converters," 
IEEE Power Electronics Specialists Conference, 1975 Record, pp. 194-204. 

References 
695 
[34] 
M. J. KOCHER and R. L. STEIGERWALD, "An Ac-to-de Converter with High Quality Input Waveforms," 
IEEE Power Electronics Specialists Conference, 1982 Record, pp. 63-75. 
[35] 
M. SCHLECHT, "Time-Varying Feedback Gains for Power Circuits with Active Waveshaping," IEEE Power 
Electronics Specialists Conference, 1981 Record, pp. 52-59. 
[36] 
I. KHAN and R. W. ERICKSON, "Control of Switched-Mode Converter Harmonic-Free Terminal Wave-
forms Through Internal Energy Storage," IEEE Power Electronics Specialists Conference, 1986 Record, 
pp. 13-26. 
[37] 
K. MAHABIR, G. VERGESE, J THOTTUVELIL, and A. HEYMAN, "Linear Averaged and Sampled Data Mod-
els for Large Signal Control of High Power Factor Ac-dc Converters," IEEE Power Electronics Specialists 
Conference, 1990 Record, pp. 372-381. 
[38] 
MICHAEL MADIGAN, ROBERT ERICKSON, and ESAM ISMAIL, "Integrated High Quality Rectifier-Regula-
tors," IEEE Power Electronics Specialists Conference, 1992 Record, pp. 1043-1051. 
[39] 
K. MAHABIR, G. VERGESE, J THOTTUVELIL, and A. HEYMAN, "Linear Averaged and Sampled Data Mod-
els for Large Signal Control of High Power Factor AC-DC Converters," IEEE Power Electronics Special-
ists Conference, 1990 Record, pp. 372-381. 
[ 40] 
R. RIDLEY, "Average Small-Signal Analysis of the Boost Power Factor Correction Circuit," Proceedings of 
the Virginia Power Electronics Center Seminar, Blacksburg, VA, Sept. 1989, pp. 108-120. 
[41] 
M. MADIGAN, "Single-Phase High-Quality Rectifier-Regulators," Ph.D. Thesis, University of Colorado at 
Boulder, 1992. 
[42] 
N. MOHAN, T. UNDELAND and W. ROBBINS, Power Electronics: Converters, Applications, and Design, 
Second edition, New York: John Wiley & Sons, 1995, Chapters 8 and 18. 
[43] 
H. MAO, D. BOROYEVICH, A. RAVINDRA, and F. LEE, "Analysis and Design of a High Frequency Three-
Phase Boost Rectifier," IEEE Applied Power Electronics Conference, 1996 Record, pp. 538-544. 
[44] 
B. T. 001, J. C. SALMON, J. W. DIXON, and A. B. KULKARNI, "A Three-Phase Controlled-Current PWM 
Converter with Leading Power Factor," IEEE Transactions on Industry Applications, Vol. 23, No. 1, pp. 
78-84, 1987. 
[45] 
P. TENT! and L. MALSANI, "Three-Phase AC/DC PWM Converter with Sinusoidal AC Currents and Mini-
mum Filter Requirements," IEEE Transactions on Industry Applications, Vol. 23, No. 1, pp. 71-77, 1987. 
[46] 
A-M. MAJED, T. C. GREEN, and B. W. WILLIAMS, "Dynamic Properties of a Step-Down Sinusoidal Cur-
rentAC/DC Converter Under State-Feedback Control," IEEE Applied Power Electronics Conference, 1993 
Record, pp. 161-167. 
[47] 
M. RASTOGI, N. MOHAN, and C. HENZE, "Three-Phase Sinusoidal Current Rectifier with Zero Current 
Switching," IEEE Applied Power Electronics Conference, 1994 Record, pp. 718-724. 
[48] 
K. D. T. NGO, S. CUK, and R. D. MIDDLEBROOK, "A New Flyback De-to-Three-Phase Converter with 
Sinusoidal Outputs," IEEE Power Electronics Specialists Conference, 1983 Record, pp. 377-388. 
[49] 
A. R. PRASAD, P. D. ZIOGAS, and S. MANIAS, "An Active Power Factor Correction Technique for Three-
Phase Diode Rectifiers," IEEE Power Electronics Specialists Conference, 1989 Record, pp. 58-66. 

696 
Pulse-Width Modulated Rectifiers 
[50] 
J. KOLAR, H. ERTL, and F. ZACH, "Space Vector Based Analysis of the Input Current Distortion of a Three 
Phase Discontinuous Conduction Mode Boost Rectifier System," IEEE Power Electronics Specialists 
Conference, 1993 Record, pp. 696-703. 
[51] 
R. ITOH and K. ISHITAKA, "Three-Phase Flyback Ac-dc Converter with Sinusoidal Supply Currents," lEE 
Proceedings, Vol. 136, Part B, No.4, pp. 143-151, 1991. 
[52] 
0. APELDOORN and P. SCHMIDT, "Single Transistor Three-Phase Power Conditioners with High Power 
Factor and Isolated Output," IEEE Applied Power Electronics Conference, 1994 Record, pp. 731-737. 
[53] 
E. H. ISMAIL and R. W. ERICKSON, "A Single Transistor Three-Phase Resonant Switch for High Quality 
Rectification," IEEE Power Electronics Specialists Conference, 1992 Record, pp. 1341-1351. 
[54] 
Y. lANG and R. ERICKSON, "New Single-Switch Three-Phase High Power Factor Rectifiers Using Multi-
Resonant Zero Current Switching," IEEE Applied Power Electronics Conference, 1994 Record, pp. 711-
717. 
[55] 
Y. lANG and R. ERICKSON, "Design and Experimental Results of a 6kW Single-Switch Three-Phase High 
Power Factor Rectifier Using Multi-Resonant Zero Current Switching," IEEE Applied Power Electronics 
Conference, 1996 Record, pp. 524-530. 
[56] 
J. KOLAR, H. ERTL, and F. ZACH, "Design and Experimental Investigation of a Three-Phase High Power 
Density High-Efficiency Unity-Power-Factor PWM (VIENNA) Rectifier Employing a Novel Integrated 
Power Semiconductor Module," IEEE Applied Power Electronics Conference, 1996 Record, pp. 514-523. 
[57] 
M. RASTOGI, N. MOHAN, and C. HENZE, "Three-Phase Sinusoidal Current Rectifier with Zero Current 
Switching," IEEE Applied Power Electronics Conference, 1994 Record, pp. 718-724. 
[58] 
S. GATARIC, D. BOROYEVICH, and F. C. LEE, "Soft-Switched Single-Switch Three-Phase Rectifier with 
Power Factor Correction," IEEE Applied Power Electronics Conference, 1994 Record, pp. 738-744. 
[59] 
J. KOLAR, U. DROFENIK, AND F. ZACH, "Vienna Rectifier II-A Novel Single-Stage High-Frequency Iso-
lated Three-Phase PWM Rectifier System," IEEE Applied Power Electronics Conference, 1998 Record, 
pp. 23-33. 
PROBLEMS 
18.1 
The boost converter of Fig. 18.5 is replaced by a buck-boost converter. Inductor energy storage has neg-
ligible influence on the low-frequency components of the converter waveforms. The average load power 
is Pload· The de output voltage is V and the sinusoidal ac input voltage has peak amplitude V M· 
(a) 
Determine expressions for the duty cycle variations d(t) and the inductor current variation i(t), 
assuming that the converter operates in the continuous conduction mode. 
(b) 
Derive the conditions for operation in the continuous conduction mode. Manipulate your result 
to show that the converter operates in CCM when Re is less than Re.cr;,(L, Ts, v8(t), V), and deter-
mine Re,crir· 
(c) 
For what values of Redoes the converter always operate in CCM? in DCM? 
(d) 
The ac input voltage has rms amplitude in the range 108 V to 132 V. The maximum load power 
is 100 W, and the minimum load power is 10 W. The de output voltage is 120 V. The switching 
frequency is 75 kHz. What value of L guarantees that the converter always operates in CCM? in 
DCM? 

Problems 
697 
18.2 
Derive expressions for the input characteristics of the buck-boost converter, similar to Eqs. (I8.25) to 
(I8.33). Sketch the converter input characteristics, and label the CCM-DCM boundary. 
18.3 
Derive expressions for the rms transistor and diode currents of rectifiers based on the single-phase CCM 
Cuk topology. Express your results in forms similar to those of Table I8.3. 
18.4 
To obtain an isolated de output, the boost converter in Fig. I8.5 is replaced by the full-bridge trans-
former-isolated CCM boost converter of Fig. 6.35. Derive an expression for the rms transistor current. 
Express your result as a function of lac rms' n, II, and V M" 
18.5 
Comparison of CCM boost and isolated SEPIC topologies as universal-input single-phase rectifiers. You 
are given that the de output voltage is V = 400 V, the load power is P = 500 W, and the rms input voltage 
varies between 90 and 270 V, such that the peak ac input voltage V M varies between V Mmin = I27 V and 
V Mmax = 382 V. Define the transistor stress S as the product of the worst-case peak transistor voltage and 
the worst-case rms transistor current. It is desired to minimizeS. 
(a) 
DetermineS for the boost converter in this application. 
(b) 
Briefly discuss your result of part (a): if universal input operation was not required, and hence 
V M = 382 V always, what S would result? 
In the isolated SEPIC, the transformer turns ratio n : I can be chosen to optimize the design. 
(c) 
Express S for the SEPIC as a function of n, II, P, V Mmin' and V Mmax· 
(d) 
Choose n for the SEPIC such that Sis minimized in this application. Compare with the results of 
parts (a) and (b). 
18.6 
In the boost-type dc-3(11ac rectifier of Fig. I8.39, the ac-side inductances L are not small: they exhibit 
line-frequency impedances that should not be ignored. The three-phase ac voltages are given by Eq. 
(I8.I50), and the duty cycles are modulated as in Eq. (I8.I56). The converter operates in the continuous 
conduction mode. 
(a) 
Determine the magnitudes and phases of the line-to-neutral average voltages at the ac inputs to 
the switch network. Express your result in terms of Dm, II, and <p. 
(b) 
Determine the real power P and reactive power Q drawn from the 3(11ac source. Express your 
results as functions of V M• II, D m' <p, and ooL. 
(c) 
How must <p be chosen to obtain unity power factor? 
18.7 
In the boost-type dc-3!!Sac rectifier of Fig. 18.39, the switch duty ratios are modulated as illustrated in 
Fig. 18.42. When the inductances L are sufficiently small, a de output voltage V equal to the peak line-to-
line ac input voltage can be obtained, with undistorted ac line currents. As illustrated in Fig. I8.42, d1(t) 
is equal to I for 0' :5 rot :5 60', where rot= 0' when ( v12(t) >r, = V. 
(a) 
Derive expressions for d2(t) and d3(t), over the interval 0' :5 rot :5 60'. 
(b) 
State how d 1(t), d2(t), and d3(t) should vary over each 60' interval. 
18.8 
The buck-type 3(11ac-dc rectifier of Fig. I8.44 operates in the continuous conduction mode. Transistors 
Q1 to Q6 operate with duty cycles d1(t) to d6(t), respectively. 
(a) 
Determine the constraints on switch operation. Which transistors must not conduct simulta-
neously? Which duty cycles must total unity? 
(b) 
Average the 3!11 bridge switch network, to determine expressions for the average ac-side switch 
currents (i.(t) >r,• (ib(t) >r,, and (ic(t) >r,. 
(c) 
Show that the average de-side switch voltage can be expressed as 
(d) 
The duty cycles are varied as follows: 

698 
Pulse-Width Modulated Rectifiers 
3¢ac 
input 
Fig. 18.44 Buck-type 31'!ac-dc rectifier, Problem 18.8. 
d 1(t) = t + tvm sin (mt-<v) 
dz(t) =t + t Dm sin {mt-<p-120°) 
d3(t) = t + t Dm sin { mt- <p- 240°) 
dit) = t-t Dm sin (mt- <v) 
ds(t) = t-t Dm sin { mt- ql- 120°) 
d6(t) = t-t Dm sin { mt- ql- 240°) 
L 
de output 
+ 
v(t) 
with the ac input voltages given by Eq. (18.150). The input filter has negligible effect of the low-
frequency components of the converter waveforms. Determine the steady-state de output voltage 
V, as a function of V M' D m' and (jJ. 
(e) 
Determine the power factor. You may assume that the input filter completely removes the switch-
ing harmonics from the currents i.(t), ib(t), and ic(t). However, the input filter elements consume 
or supply negligible line-frequency reactive power. 
18.9 
In the three-phase DCM ftyback rectifier of Fig. 18.45, the input filter has negligible effect on the low-
frequency components of the input ac waveforms. The transistor operates with switching frequency fs 
and duty cycle d. Fly back transformers T1, T2, and T3 each have magnetizing inductance L referred to the 
primary, turns ratio n : 1, and have negligible leakage inductances. 
~ 
·~ 
input 
c 
Input filter 
Fig. 18.45 
Isolated 31'!ac-dc rectifier based on the ftyback converter operating in discontinuous 
conduction mode: Problem 18.9. 
+ 
v(t) 
(a) 
Determine expressions for the low-frequency components of the ac input and de output currents. 
(b) 
Derive an averaged equivalent circuit model for the converter, and give expressions for the ele-

Problems 
699 
ment values. 
(c) 
Derive the conditions for operation in the discontinuous conduction mode. 
18.10 
Power stage design of a universal-input boost rectifier. The objective of this problem is to work out the 
power stage design of a low harmonic rectifier based on the boost converter. This converter is to be 
designed to operate anywhere in the world, and hence the input voltage may vary over the range 90 to 
270 Vrms, 50 to 60 Hz. The converter produces a regulated 385 V de output, at 1000 W. The switching 
frequency fs is 100kHz. You may assume that the controller operates perfectly, to produce an undistorted 
ac line current waveform and a well-regulated de output voltage. 
(a) 
Derive an expression for how the duty cycle d(t) will vary over the ac line cycle. You may 
neglect converter dynamics and losses. Sketch d(t) under conditions of maximum and minimum 
ac line voltage. 
(b) 
Specify the inductor: 
(i) 
Specify the value of L such that, at the peak of the sinusoidal input voltage, and 
under worst-case conditions, the inductor current ripple !li8 is 20% of the instanta-
neous low frequency current i8(t). 
(ii) 
Specify the worst-case values of the peak and rms inductor current, assuming 100% 
efficiency. 
(c) 
Determine the worst-case rms currents of the MOSFET and diode, assuming 100% efficiency. 
(d) 
Specify the value of C that leads to a worst-case low-frequency ( ~f,) output voltage peak-peak 
ripple of 5 V. 
(e) 
Given the following loss elements 
Inductor winding resistance 0.1 Q 
MOSFET on-resistance 
0.4 Q 
Diode forward voltage drop 
1.5 V 
Switching loss: model as i~(t)(0.25 Q) 
For a constant 1000 W load, and assuming that the controller operates perfectly as described 
above, find the rectifier efficiency 
(i) 
at an ac input voltage of 90 V rms 
(ii) 
at an ac input voltage of 270 V rms 
18.11 
The flyback converter shown in Fig. 18.46 operates in the continuous conduction mode. The MOSFET 
i(t) 
+ 
v(t) 
R 
Fig. 18.46 
Low-harmonic rectifier system based on the CCM flyback converter, Problem 18.11. 
has on-resistance Ron' and diode D1 has a constant forward voltage drop V 0 . All other loss elements can 

700 
Pulse-Width Modulated Rectifiers 
be neglected. The turns ratio of the fly back transformer is 1:1. The controller varies the duty cycle such 
that (igCt) >r, is equal to v8(t)/Re, where Re is the emulated resistance. The input voltage is V;n(t) = V M sin 
(wt). The input filter removes the switching harmonics from the input current i8(t), but has negligible 
effect on the low-frequency components of the converter waveforms. 
(a) 
Derive an expression for the rectifier efficiency, in terms of V M• V, V0 , Ron' andRe. 
(b) 
Given the following values, find the value of MOSFET on-resistance which leads to an effi-
ciency of96%. 
rms input voltage 
De output voltage 
Diode D1 forward voltage drop 
Load power 
120V 
120V 
1.5 v 
200W 
18.12 
Derive an expression for the emulated resistance Re(Vg,rms• Rs, kv, vcontml) of the average-current-con-
trolled boost rectifier with ac line voltage feedforward, Fig. 18.14. 
18.13 
Derive the CPM boost rectifier static input characteristics, Eq. (18.57). 
18.14 
The boost rectifier system of Fig. 18.47 employs average current control with ac line voltage feedfor-
ward. 
The ac line frequency is 50 Hz. The rectifier drives a constant-power load of 500 W. The pulse-width 
modulator contains a ramp having a peak-to-peak amplitude of 3 V. There is no compensator in the inner 
wide-bandwidth average current control feedback loop. The average current sensing circuit has gain 
Fig. 18.47 
Average current controlled boost rectifier with input voltage feedforward, Problem 18.14. 

Problems 
701 
Other converter parameter values are 
fs =100kHz 
L=2.5 mH 
fo =~~=10kHz 
R, = 1 Q 
v = 385 v 
vg.rms = 230 v 
(a) 
Construct the magnitude and phase Bode diagrams of the loop gain T;(s) of the average-current-
control loop. Label important features. 
(b) 
Determine numerical values of the crossover frequency and phase margin ofT;(s). 
The outer low-bandwidth feedback loop has loop gain Tv(s). The compensator of this loop has constant 
gain Gc/s) = 330. The multiplier gain is k, = 2. The capacitor value is C = 680 JIF. The reference voltage 
vrej2(t) is 3.85 V. 
(c) 
Determine the peak magnitude of the output 100Hz voltage ripple. 
(d) 
Determine the quiescent control voltage Vcontrot· 
(e) 
Construct the magnitude and phase Bode diagrams of the loop gain T/s) of the outer feedback 
loop. Label important features. 
(f) 
Determine numerical values of the crossover frequency and phase margin of T/s). 
18.15 
A critical conduction mode controller causes a boost rectifier to exhibit an ac input current waveform 
similar to Fig. 18.19(b). The ac input voltage is 120 Vrms at 60Hz. The rectifier supplies 225 Vdc to a 
120 W load. The boost converter inductance is L = 600 JIH. 
(a) 
Determine the emulated resistance Re. 
(b) 
Write the numerical expression for the converter switching frequency J,, as a function of t0n and 
the applied terminal voltages. Sketch/, vs. time. 
(c) 
What is the maximum switching frequency? What is the minimum switching frequency? 
(d) 
Derive an analytical expression for the rms transistor current for this control method, as a func-
tion of the magnitude of the sinusoidal line current. Compare the rms transistor current of this 
approach with a CCM boost rectifier having negligible current switching ripple. 

PartV 
Resonant Converters 

19 
Resonant Conversion 
Part V of this text deals with a class of converters whose operation differs significantly from the PWM 
converters covered in Parts I to IV. Resonant power converters [1-36] contain resonant L---C networks 
whose voltage and current waveforms vary sinusoidally during one or more subintervals of each switch-
ing period. These sinusoidal variations are large in magnitude, and hence the small ripple approximation 
introduced in Chapter 2 does not apply. 
Dc-to-high-frequency-ac inverters are required in a variety of applications, including electronic 
ballasts for gas discharge lamps [3,4], induction heating, and electrosurgical generators. These applica-
tions typically require generation of a sinusoid of tens or hundreds of kHz, having moderate or low total 
harmonic distortion. A simple resonant inverter system is illustrated in Fig. 19.1(a). A switch network 
produces a square wave voltage v/t). As illustrated in Fig. 19.2, the spectrum of v,(t) contains fundamen-
tal plus odd harmonics. This voltage is applied to the input terminals of a resonant tank network. The 
tank network resonant frequency f 0 is tuned to the fundamental component of v/t), that is, to the switch-
ing frequency f,, and the tank exhibits negligible response at the harmonics of fs· In consequence, the 
tank current is(t), as well as the load voltage v(t) and load current i(t), have essentially sinusoidal wave-
forms of frequency fs, with negligible harmonics. By changing the switching frequency fs (closer to or 
further from the resonant frequency f0), the magnitudes of is(t), v(t), and i(t) can be controlled. Other 
schemes for control of the output voltage, such as phase-shift control of the bridge switch network, are 
also possible. A variety of resonant tank networks can be employed; Fig. 19.1(b) to (d) illustrate the well-
known series, parallel, and LCC tank networks. Inverters employing the series resonant tank network are 
known as the series resonant, or series loaded, inverter. In the parallel resonant or parallel loaded 
inverter, the load voltage is equal to the resonant tank capacitor voltage. The LCC inverter employs tank 
capacitors both in series and in parallel with the load. 
Figure 19.3 illustrates a high-frequency inverter of an electronic ballast for a gas-discharge 
lamp. A half-bridge configuration of the LCC inverter drives the lamp with an approximately sinusoidal 

706 
Resonant Conversion 
(a) 
(b) 
de 
source 
vgCt) 
:. .................................. : 
Switch network 
Resonant tank network 
(c) 
·················-······················· 
' 
' 
' 
' 
' 
' 
: 
L 
C,. 
: 
rH-
' 
' 
: ........................................ : 
Series tank network 
......................................... 
' 
' 
' 
' 
L 
' 
' 
: 
: 
' 
' ' ' ' ' ' ' ' ' : 
' ' 
I c,II 
Parallel tank network 
(d) 
i(t) 
+ 
v(t) 
Resistive 
load 
R 
·······················------············ 
' 
' 
' 
' 
' 
' 
: 
L 
Cs 
: 
~II 
i 
c,Ti 
LCC tank network 
Fig. 19.1 
A basic class of resonant inverters that consist of (a) a switch network N5 that drives a resonant tank net-
work NT near resonance. Several common tank networks: (b) series, (c) parallel, (d) LCC. 
Switch 
1 
output I 
voltage 
spectrum 
t 
fs 
3fs 
5fs 
f 
Resonant 
1 A 
Fig. 
19.2 The tank network responds 
tank 
primarily to the fundamental component 
response 
of the applied waveforms. 
/, 
3fs 
5fs 
f 
Tank 
1 
current I 
spectrum 
J; 
Sf, 
f 

707 
+ 
Fig. 19.3 
Half-bridge LCC inverter circuit, as an electronic ballast for a gas-discharge lamp. 
de 
source 
vit) 
t ............ .':!.L ............... ! 
Switch network 
i,.(t) 
+ 
Transfer function 
H(s) 
~ 
L 
l .............. !!.T. ............... ! 
Resonant tank network 
i(t) 
, ............................ ] r········ 
+ 
v(t) 
R 
................. !!J!... .. ... .. .. . .... 1\'F. .... .: 
Rectifier network Low-pass 
filter 
network 
de 
load 
Fig. 19.4 
Derivation of a resonant de-de converter, by rectification and filtering of the output of a resonant 
inverter. 
high-frequency ac waveform. The converter is controlled to provide a relatively high voltage to start the 
lamp, and a lower voltage thereafter. When the ballast is powered by the ac utility, a low-harmonic recti-
fier typically provides the input de voltage for the inverter. 
A resonant de-de converter can be constructed by rectifying and filtering the ac output of a res-
onant inverter. Figure 19.4 illustrates a series-resonant de-de converter, in which the approximately sinu-
soidal resonant tank output current iR(t) is rectified by a diode bridge rectifier, and filtered by a large 
capacitor to supply a de load having current I and voltage V. Again, by variation of the switching fre-
quency f, (closer to or further from the resonant frequency f0 ), the magnitude of the tank current iR(t), 
and hence also the de load current I, can be controlled. Resonant de-de converters based on series, paral-
lel, LCC, and other resonant tank networks are well understood. These converters are employed when 
specialized application requirements justify their use. For example, they are commonly employed in high 
voltage de power supplies [5,6], because the substantial leakage inductance and winding capacitance of 
high-voltage transformers leads unavoidably to a resonant tank network. The same principle can be 
employed to construct resonant link inverters or resonant link cycloconverters [7-9]; controllable switch 
networks are then employed on both sides of the resonant tank network. 
Figure 19.5 illustrates another approach to resonant power conversion, in which resonant ele-

708 
Resonant Conversion 
(a) 
PWM switch network 
i l (t) 
[----------------------------------------: i2(t) 
+ 
T 
t ....................................... .: 
(c) 
+ 
Switch 
network 
(b) 
ZCS quasi-resonant 
switch network 
i1 (t) r·--------------------------------------------------------------1 i2(t) 
+ 
+ 
T 
L 
i(t) 
+ 
+ 
c 
R 
v(t) 
Fig. 19.5 Derivation of a quasi-resonant converter: (a) conventional PWM switch network, (b) a ZCS quasi-reso-
nant switch network, (c) a quasi-resonant buck converter is obtained by employing a quasi-resonant switch network 
such as (b) in a buck converter. 
ments are inserted into the switch network of an otherwise-PWM converter. A resonant switch network, 
or quasi-resonant converter, is then obtained. For example, in Fig. 19.5(b), resonant elements Lr and C, 
are combined with the switch network transistor and diode. The resonant frequency of these elements is 
somewhat higher than the switching frequency. This causes the switch network waveforms i 1(t) and vit) 
to become quasi-sinusoidal pulses. The resonant switch network of Fig. 19.5(b) can replace the PWM 
switch network of Fig. 19.5(a) in nearly any PWM converter. For example, insertion of the resonant 
switch network of Fig. 19.5(b) into the converter circuit of Fig. 19.5(c) leads to a quasi-resonant buck 
converter. Numerous resonant switch networks are known, which lead to a large number of resonant 
switch versions of buck, boost, buck-boost, and other converters. Quasi-resonant converters are 
described in Chapter 20. 
The chief advantage of resonant converters is their reduced switching loss, via mechanisms 
known as zero-current switching (ZCS), and zero-voltage switching (ZVS). The tum-on and/or tum-off 
transitions of the various converter semiconductor elements can occur at zero crossings of the resonant 
converter quasi-sinusoidal waveforms. This eliminates some of the switching loss mechanisms described 
in Chapter 4. Hence, switching loss is reduced, and resonant converters can operate at switching frequen-
cies that are higher than in comparable PWM converters. Zero-voltage switching can also eliminate some 
of the sources of converter-generated electromagnetic interference. 
Resonant converters exhibit several disadvantages. Although the resonant element values can be 
chosen such that good performance with high efficiency is obtained at a single operating point, typically 
it is difficult to optimize the resonant elements such that good performance is obtained over a wide range 
of load currents and input voltages. Significant currents may circulate through the tank elements, even 
when the load is removed, leading to poor efficiency at light load. Also, the quasi-sinusoidal waveforms 
of resonant converters exhibit greater peak values than those exhibited by the rectangular waveforms of 
PWM converters, provided that the PWM current spikes due to diode stored charge are ignored. For 

19.1 
Sinusoidal Analysis of Resonant Converters 
709 
these reasons, resonant converters exhibit increased conduction losses, which can offset their reduced 
switching losses. 
In this chapter, the properties of the series, parallel, and other resonant inverters and de-de con-
verters are investigated using the sinusoidal approximation [3, 10-12]. Harmonics of the switching fre-
quency are neglected, and the tank waveforms are assumed to be purely sinusoidal. This allows simple 
equivalent circuits to be derived for the bridge inverter, tank, rectifier, and output filter portions of the 
converter, whose operation can be understood and solved using standard linear ac analysis. This intuitive 
approach is quite accurate for operation in the continuous conduction mode with a high-Q response, but 
becomes less accurate when the tank is operated with a low Q-factor or for operation of de--de resonant 
converters in or near the discontinuous conduction mode. 
For de--de resonant converters, the important result of this approach is that the de voltage con-
version ratio of a continuous conduction mode resonant converter is given approximately by the ac trans-
fer function of the tank circuit, evaluated at the switching frequency. The tank is loaded by an effective 
output resistance, having a value nearly equal to the output voltage divided by the output current. It is 
thus quite easy to determine how the tank components and circuit connections affect the converter behav-
ior. The influence of tank component losses, transformer nonidealities, etc., on the output voltage and 
converter efficiency can also be found. Several resonant network theorems are presented, which allow the 
load dependence of conduction loss and of the zero-voltage- or zero-current-switching properties to be 
explained in a simple and intuitive manner. 
It is found that the series resonant converter operates with a step-down voltage conversion ratio. 
With a 1: 1 transformer turns ratio, the de output voltage is ideally equal to the de input voltage when the 
transistor switching frequency is equal to the tank resonant frequency. The output voltage is reduced as 
the switching frequency is increased or decreased away from resonance. On the other hand, the parallel 
resonant converter is capable of both step-up and step-down of voltage levels, depending on the switch-
ing frequency and the effective tank Q-factor. The exact steady-state solutions of the ideal series and par-
allel resonant de--de converters are stated in Section 19.5. 
Zero-voltage switching and zero-current switching mechanisms of the series resonant converter 
are described in Section 19.3. In Section 19.4, the dependence of resonant inverter properties on load is 
examined. A simple frequency-domain approach explains why some resonant converters, over certain 
ranges of operating points, exhibit large circulating tank currents and low efficiency. The boundaries of 
zero-voltage switching and zero-current switching are also determined. 
It is also possible to modify the PWM converters of the previous chapters, so that zero-current 
or zero-voltage switching is obtained. A number of diverse approaches are known that lead to soft switch-
ing in buck, boost, forward, flyback, bridge, and other topologies. Chapter 20 summarizes some of the 
well-known schemes, including resonant switches, quasi-square wave switches, the full-bridge zero-volt-
age transition converter, and zero-voltage switching in forward and flyback converters containing active-
clamp snubbers. A detailed description of soft-switching mechanisms of diodes, MOSFETs, and IGBTs 
is also given. 
19.1 
SINUSOIDAL ANALYSIS OF RESONANT CONVERTERS 
Consider the class of resonant converters that contain a controlled switch network Ns that drives a linear 
resonant tank network N r· In a resonant inverter, the tank network drives a resistive load as in Fig. 19 .1. 
The reactive component of the load impedance, if any, can be effectively incorporated into the tank net-
work. In the case of a resonant de--de converter, the resonant tank network is connected to an uncon-
trolled rectifier network NR, filter network NF and load R, as illustrated in Fig. 19.4. Many well-known 
converters can be represented in this form, including the series, parallel, and LCC topologies. 

710 
Resonant Conversion 
In the most common modes of operation, the controlled switch network produces a square wave 
voltage output v,(t) whose frequency f, is close to the tank network resonant frequency f 0• In response, 
the tank network rings with approximately sinusoidal waveforms of frequency fs. In the case where the 
resonant tank responds primarily to the fundamental component!, of the switch waveform v,(t), and has 
negligible response at the harmonic frequencies nfs, n = 3, 5, 7, ... , then the tank waveforms are well 
approximated by their fundamental components. As shown in Fig. 19.2, this is indeed the case when the 
tank network contains a high-Q resonance at or near the switching frequency, and a low-pass characteris-
tic at higher frequencies. Hence, let us neglect harmonics, and compute the relationships between the 
fundamental components of the tank terminal waveforms vs(t), i5(t), iR(t), and vR(t). 
19.1.1 
Controlled Switch Network Model 
If the switch network of Fig. 19.6 is controlled to produce a 
square wave of frequency fs = wJ2n as in Fig. 19.7, then its out-
put voltage waveform v,(t) can be expressed in the Fourier series 
4Vg 
"" 
1 
v,(t) = 1t 
..:.... 
11 sin (nw,t) 
(19.1) 
n =I, 3, 5, ... 
The fundamental component is 
4Vg . 
. 
v,/t) = 1t sm (wJ) = V,1 sm (w,t) 
(19.2) 
+ 
vs(t) 
L...--+-1---~ 
: ................................... J 
Switch network 
Fig. 19.6 An ideal switch network. 
which has a peak amplitude of (4/rr) times the de input voltage 
Vg, and is in phase with the original square wave v,(t). Hence, the switch network output terminal is mod-
eled as a sinusoidal voltage generator, V51(t). 
It is also of interest to model the converter de input port. This requires computation of the de 
component !8 of the switch input current igCt). The switch input current igCt) is equal to the output current 
is(t) when the switches are in position 1, and its inverse- i,(t) when the switches are in position 2. Under 
the conditions described above, the tank rings sinusoidally and i,(t) is well approximated by a sinusoid of 
some peak amplitude /51 and phase <ps: 
Fig. 19.7 Switch network output voltage v,(t) and its 
fundamental component v,1(t). 
(19.3) 
Fundamental component 
-1---t:;...._--T----, 
V s I (t) 

Fig. 19.8 
Switch network waveforms i,(t) and i8(t). 
+ 
2!,1 
1t cos (<p,) 
19.1 
Sinusoidal Analysis of Resonant Converters 
711 
v,1(t) = 
4V8 
• 
1t sm (ffi,t) 
.. 
........ 
. .. ···· 
Fig. 19.9 
An equivalent circuit for the switch network, which models the fundamental component of the output 
voltage waveform and the de component of the input current waveform. 
The input current waveform is shown in Fig. 19.8. 
The de component, or average value, of the input current can be found by averaging igCt) over 
one half switching period: 
(19.4) 
Thus, the de component of the converter input current depends directly on the peak amplitude of the tank 
input current Is! and on the cosine of its phase shift <p5 • 
An equivalent circuit for the switch is given in Fig. 19.9. This circuit models the basic energy 
conversion properties of the switch: the de power supplied by the voltage source Vg is converted into ac 
power at the switch output. Note that the de power at the source is the product of V8 and the de compo-
nent of igCt), and the ac power at the switch is the average of v/t)i,(t). Furthermore, if the harmonics of 
v/t) are negligible, then the switch output voltage can be represented by its fundamental component, a 
sinusoid v,1(t) of peak amplitude 4V/n. It can be verified that the switch network de input power and 
fundamental average output power, predicted by Fig. 19.9, are equal. 
19.1.2 
Modeling the Rectifier and Capacitive Filter Networks 
In the series resonant de-de converter, the output rectifier is driven by the nearly sinusoidal tank output 
current iR(t). A large capacitor C F is placed at the de output, so that the output voltage v(t) contains negli-
gible harmonics of the switching frequency fs, as shown in Fig. 19.10. Hence, we can make the small-rip-

712 
Resonant Conversion 
fi!!" 19.10 Uncontrqlled rectifier with can!lcitiv~ 
filter network, as in the series resonant converter. 
iR(t) r··································i I iR(t) I r··············i i(t) 
+ • ' 
A 
1....---....-1 
• ....;....-.,-1-+---+-,1 
+.I 
,~,) iM lTT 
! ................ 1!../i ............ : 
L •••• ~f ..... ! 
Rectifier network 
Low-pass 
filter 
network 
de 
load 
pie approximation as usual: v(t)"' V, i(t) "'I. The diode rectifiers switch when iR(t) passes through zero, as 
shown in Fig. 19.11. The rectifier input voltage vR(t) is essentially a square wave, equal to+ v(t) when 
iR(t) is positive and- v(t) when iR(t) is negative. Note that vR(t) is in phase with iR(t). 
If the tank output current iR(t) is a sinusoid with peak amplitude IR1 and phase shift cpR: 
(19.5) 
then the rectifier input voltage may be expressed in the Fourier series 
(19.6) 
where cpR is the phase shift of iR(t), with respect to v,(t). This voltage waveform is impressed on the out-
put port of the resonant tank network. Again, if the tank network responds primarily to the fundamental 
component (j.) of vR(t), and has negligible response at the harmonic frequencies nfs, n = 3, 5, 7 ... , then 
the harmonics of vR(t) can be ignored. The voltage waveform vR(t) is then well approximated by its fun-
damental component vR1(t): 
(19.7) 
The fundamental voltage component vR!(t) has a peak value of (4/n:) times the de output voltage V, and is 
in phase with the current iit). 
(a) 
(b) 
v 
+----+j 
(jlR 
(jlR 
R=j__2 R 
e 
1t 
Fig. 19.11 Rectifier network input terminal waveforms: (a) actual waveforms vR(t) and iR(t), (b) fundamental 
components vRI(t) and iRI(t). 

19.1 
Sinusoidal Analysis of Resonant Converters 
713 
Fig. 19.12 
An equivalent circuit for the rectifier and fil-
ter network, which models the fundamental components 
of the rectifier ac input waveforms and the de components 
of the load waveforms. The rectifier presents an effective 
resistive load Re to the tank network. 
+ 
Re=~R 
n 
2 
1f IR! 
v 
R 
The rectified tank output current, I iR(t) I, is filtered by capacitor C F. Since no de current can 
pass through CF, the de component of I iR(t) I must be equal to the steady-state load current/. By equat-
ing de components we obtain: 
(19.8) 
Therefore, the load current and the tank output current amplitudes are directly related in steady state. 
Since vRl(t), the fundamental component of vR(t), is in phase with iR(t), the rectifier presents an 
effective resistive load Re to the tank circuit. The value of Re is equal to the ratio of vR1 (t) to iR(t). Divi-
sion ofEq. (19.7) by Eq. (19.5), and elimination of IR 1 using Eq. (19.8) yields 
With a resistive load R equal to VII, this equation reduces to 
Re = ~ R = 0.8106R 
n 
(19.9) 
(19.10) 
Thus, the tank network is damped by an effective load resistance Re equal to 81% of the actual load resis-
tance R. An equivalent circuit that models the rectifier network input port fundamental components and 
output port de components is given in Fig. 19.12. 
19.1.3 
Resonant Tank Network 
We have postulated that the effects of harmonics can be neglected, and we have consequently shown that 
the bridge can be modeled as a fundamental voltage source v,it). In the case of a de-de converter, the 
rectifier can be modeled using an effective resistor of value Re. We can now solve the resonant tank net-
work by standard linear analysis. 
As shown in Fig. 19.13, the tank circuit is a linear network with the following voltage transfer 
function: 
(19.11) 

714 
Resonant Conversion 
Hence, the ratio VRI!Vs 1 of the peak magnitudes 
ofvR1(t) and vs1(t) is given by: 
VRI =II H(s) II . 
v.<d 
S=JWs 
(19.12) 
In addition, iR(s) is given by: 
(19.13) 
So the peak magnitude of iR(t) is: 
isl(t) 
Z; 
vsl (t) -
Transfer Junction 
H(s) 
----------... 
iRI(t) 
+ 
Resonant 
network 
VRI(t) 
Re 
II H(s) II . 
J -
s:JOJs V 
Rl-
R, 
sl 
(19.14) 
Fig. 19.13 The linear tank network, excited by an 
effective sinusoidal input source and driving an effec-
tive resistive load. 
Thus, the magnitude of the tank transfer function is found, with an effective resistive load. 
19.1.4 
Solution of Converter Voltage Conversion Ratio M = V!Vg 
An equivalent circuit of a complete de--de resonant converter is depicted in Fig. 19.14. The voltage con-
version ratio of the resonant converter can now be found: 
Simplification by use ofEq. (19.10) yields: 
Transfer Junction 
H(s) 
----------... 
is I (t) 
Z; 
Resonant 
vg 
-
network 
4Vg . 
1I sm (w,t) 
iRI(t) 
+ 
vRI(t) 
Re 
- 8 
R --2 R 
e 
n 
(19.15) 
I 
+ 
2 
'ft'/RI 
v 
R 
Fig. 19.14 Steady-state equivalent circuit that models the de and fundamental components of resonant converter 
waveforms. 

19.2 
Examples 
715 
~ =II H(s) 11s=Jws 
(19.16) 
g 
Equation (19.16) is the desired result. It states that the de conversion ratio of the resonant converter is 
approximately the same as the ac transfer function of the resonant tank circuit, evaluated at the switching 
frequency fs· This intuitive result can be applied to converters with many different types of tank circuits. 
However, it should be reemphasized that Eq. (19.16) is valid only if the response ofthe tank circuit to the 
harmonics of vs(t) is negligible compared to the fundamental response, an assumption that is not always 
justified. In addition, we have assumed that the switch network is controlled to produce a square wave 
and that the rectifier network drives a capacitive-type filter network. Finally, the transfer function H(s) is 
evaluated using the effective load resistance Regiven by Eq. (19.9). 
19.2 
EXAMPLES 
19.2.1 
Series Resonant DC-DC Converter Example 
The series resonant converter with switching frequency control is shown in Fig. 19.4. Current-bidirec-
tional two-quadrant switches are necessary. For this circuit, the tank network consists of a series L-C cir-
cuit, and Fig. 19.14 can be redrawn as in Fig. 19.15. The transfer function H(s) is therefore: 
where 
H(s)=~= 
Re 
ZJs) 
R +sL+_j_ 
e 
sC 
( Q:wo) 
Transfer function H(s) 
-------------.. 
L 
c 
Series tank network 
+ 
Fig. 19.15 Steady-state equivalent circuit of the series resonant converter. 
-
8 
R --2 R 
e 
n 
+ 
v 
(19.17) 
I 
R 

716 
Resonant Conversion 
The magnitude of H(jws), which coincides with the converter de conversion ratio M = V/Vg, is 
(19.18) 
where 
F=f/!0 
(19 .19) 
The Bode diagrams of Z;(s) and H(s) are constructed in Fig. 19.16, using the graphical construc-
tion method of Chapter 8. The series resonant impedance Z;(s) is dominated by the capacitor Cat low 
frequency, and by the inductor L at high frequency. At the resonant frequency f 0 , the impedances of the 
inductor and capacitor are equal in magnitude and opposite in phase; hence, they cancel. The series reso-
nant impedance Z;(s) is equal to Re at f = !0 . 
The transfer function II H(jw) II 
is constructed graphically, by division of 
11 z; 11 
Re by the II Z; II asymptotes of Fig. 19.16. 
At resonance, one obtains II H II = R/Re 
= 1. At frequencies above or below the 
resonant frequency, II Z; II> Re and hence 
II H II < 1. So the conversion ratio M is 
less than or equal to 1. It can also be 
seen that a decrease in the load resis-
tance R, which increases the effective 
quality factor Qe, causes a more peaked 
response in the vicinity of resonance. 
Exact characteristics of the series reso-
11 H 11 
nant converter are plotted in Fig. 19.45. 
Over what range of switching 
frequencies is Eq. (19.18) accurate? The 
response of the tank to the fundamental 
component of v,(t) must be sufficiently 
greater than the response to the harmon-
ics of v,(t). This is certainly true for 
operation above resonance because H(s) 
contains a bandpass characteristic that 
decreases with a single pole slope for fs 
> f0 . For the same reason, Eq. (19.18) is 
Fig. 19.16 Construction of the Bode diagrams of Z;(s) and H(s) 
valid when the switching frequency is 
for the series resonant converter. 
below but near resonance. 
However, for switching frequencies fs much less than the resonant frequency f 0 , the sinusoidal 
approximation breaks down completely because the tank responds more strongly to the harmonics of 

19.2 
Examples 
717 
~::;~~ ], __ it._____,__ _ _,____ __ 
voltage 
spectrum 
_ 
t 
+ 
Fig. 19.17 
Excitation of the tank network 
by the third harmonic of the switching fre-
quency. 
3fs 
Sfs 
f 
Reso;::~ 1 
A 
response 
. 
~----------L--~------------
3fs 
Sfs 
f 
Tank ], _ 
_____.___ 
current 
spectrum 
t 
fs 
3fs 
Sf, 
f 
v/f) than to its fundamental. For example, at!,.= f0/3, the third harmonic of v,(t) is equal tof0 and directly 
excites the tank resonance. Some other type of analysis must be used to understand what happens at 
these lower frequencies. Also, in the low-Q case, the approximation is less accurate because the filter 
response is less peaked, and hence does not favor the fundamental component as strongly. As shown in a 
later section, discontinuous conduction modes may then occur whose waveforms are highly nonsinusoi-
dal. 
19.2.2 
Subharmonic Modes of the Series Resonant Converter 
If the nth harmonic of the switch output waveform v,(t) is close to the resonant tank frequency, nf,- j 0, 
and if the tank effective quality factor Qe is sufficiently large, then as illustrated in Fig. 19.17, the tank 
responds primarily to harmonic n. All other components of the tank waveforms can then be neglected, 
and it is a good approximation to replace v,(t) with its nth harmonic component: 
4V8 
• 
v,(t) ~ v,,(t) = l'i'ft sm (nw,t) 
(19.20) 
This expression differs from Eq. (19.2) because the amplitude is reduced by a factor of lin, and the fre-
Fig. 19.18 The subharmonic modes of the series 
resonant converter. These modes occur when the har-
monics of the switching frequency excite the tank res-
onance. 
M 
1 3 
J 5 

718 
Resonant Conversion 
quency is nfs rather thanfs. 
The arguments used to model the tank and rectifier/filter networks are unchanged from Section 
19.1. The rectifier presents an effective resistive load to the tank, of value Re = 8R/n2• In consequence, the 
converter de conversion ratio is given by 
V 
~ H(jnw,) ~ 
M=v= 
n 
g 
(19.21) 
This is a good approximation provided that nfs is close to f0, and that Q. is sufficiently large. Typical 
characteristics are sketched in Fig. 19.18. 
The series resonant converter is not generally designed to operate in a subharmonic mode, since 
the fundamental modes yield greater output voltage and power, and hence higher efficiency. Nonetheless, 
the system designer should be aware of their existence, because inadvertent operation in these modes can 
lead to large signal instabilities. 
19.2.3 Parallel Resonant DC-DC Converter Example 
The parallel resonant de-de converter is diagrammed in Fig. 19.19. It differs from the series resonant 
converter in two ways. First, the tank capacitor appears in parallel with the rectifier network rather than 
in series: this causes the tank transfer function H(s) to have a different form. Second, the rectifier drives 
an inductive-input low-pass filter. In consequence, the value of the effective resistance Re differs from 
that of the rectifier with a capacitive filter. Nonetheless, sinusoidal approximations can be used to under-
stand the operation of the parallel resonant converter. 
As in the series resonant converter, the switch network is controlled to produce a square wave 
vsCf). If the tank network responds primarily to the fundamental component of vs(t), then arguments iden-
tical to those of Section 19.1 can be used to model the output fundamental components and input de 
components of the switch waveforms. The resulting equivalent circuit is identical to Fig. 19.9. 
The uncontrolled rectifier with inductive filter network can be described using the dual of the 
arguments of Section 19.1.2. In the parallel resonant converter, the output rectifiers are driven by the 
nearly sinusoidal tank capacitor voltage vR(t), and the diode rectifiers switch when vR(t) passes through 
zero as in Fig. 19.20. If the filter inductor current ripple is small, then in steady-state the filter inductor 
current is essentially equal to the de load current I. The rectifier input current iR(t) is therefore a square 
wave of amplitude I, and is in phase with the tank capacitor voltage vR(t): 
r··································1 i,(t) r·································-1 iR(t) r-·································: ································ 
i(t) 
+ 
v(t) 
R 
l ............. ~~---·············.: 
L ............ l!..r. ............... : 
····--------~r. ............... . 
Switch network 
Resonant tank network 
Rectifier network 
Low-pass filter 
de 
network 
load 
Fig. 19.19 Block diagram of the parallel resonant converter. 

19.2 Examples 
719 
(a) 
(b) 
<pR 
Fig. 19.20 Rectifier network input terminal waveforms, for the parallel resonant converter: (a) actual waveforms 
vR(t) and iR(t), (b) fundamental components vR1(t) and iR1(t). 
where <pR is the phase shift of vR(t). 
The fundamental component of iit) is 
(19.23) 
Hence, the rectifier again presents an effective resis-
tive load to the tank circuit, equal to 
(19.24) 
The ac components of the rectified tank capacitor 
voltage I vR(t) I are removed by the output low pass 
filter. In steady state, the output voltage Vis equal to 
the de component of I v R(t) I: 
v =f. rr/2 VRll sin (W/- <pR) I dt = 
~ VRl 
(19.25) 
s Jo 
(19.22) 
I 
+ 
+ 
v 
R 
nz 
Re=--gR 
Fig. 19.21 
An equivalent circuit for the rectifier 
and inductive filter network of the parallel resonant 
converter, which models the fundamental compo-
nents of the rectifier ac input waveforms and the de 
components of the load waveforms. 
So the load voltage V and the tank capacitor voltage amplitude are directly related in steady state. Substi-
tution of Eq. (19.25) and resistive load characteristics V = IR into Eq. (19.24) yields: 
nz 
Re = 8 R = 1.2337R 
(19.26) 
An equivalent circuit for the uncontrolled rectifier with inductive filter network is given in Fig. 
19.21. This model is similar to the one used for the series resonant converter, Fig. 19.12, except that the 
roles of the rectifier input voltage vR(t) and current iR(t) are interchanged, and the effective resistance Re 
has a different value. The model for the complete converter is given in Fig. 19.22. 
Solution of Fig. 19.22 yields the converter de conversion ratio: 

720 
Resonant Conversion 
4V8 
• 
---n- sm ( w,t) 
Transfer function H(s) 
----------... 
L 
c 
Parallel tank network 
I 
+ 
+ 
v 
R 
Fig. 19.22 Equivalent circuit for the parallel resonant converter, which models the fundamental components of the 
tank waveforms, and the de components of the converter input current and output voltage. 
(19.27) 
where H(s) is the tank transfer function 
H(s) = z;t) 
(19.28) 
and 
(19.29) 
The Bode magnitude diagrams of H(s) and Z0 (s) are constructed in Fig. 19.23, using the graphi-
cal construction method of Chapter 8. The impedance Z 0(s) is the parallel combination of the impedances 
of the tank inductor L, capacitor C, and effective load Re. The magnitude asymptote of the parallel com-
bination of these components, at a given frequency, is equal to the smallest of the individual asymptotes 
ffiL, 1/ffiC, andRe. Hence, at low frequency where the inductor impedance dominates the parallel combi-
nation, II Z0 (s) II = wL, while at high frequency the capacitor dominates and II Z0(s) II = l!wC. At reso-
nance, the impedances of the inductor and capacitor are equal in magnitude but opposite in phase, so that 
their effects cancel. The impedance II Z0 (s) II is then equal toRe: 
II Z(s)ll 
= 
1 
=R 
o 
s:::: Jms 
1 
. 
1 
e 
...,--L + JWoC + -R 
]Wo 
e 
(19.30) 
with 
The de conversion ratio is therefore 

Fig. 19.23 
Construction of Bode diagrams 
of Z;(s) and H(s) for the parallel resonant 
converter. 
where F = f/f0• 
\IHII 
At resonance, the conversion ratio is 
19.3 Soft Switching 
721 
(19.31) 
(19.32) 
The actual peak value of M occurs at a switching frequency slightly below the resonant frequency, with 
peak M slightly greater than Eq. (19.32). Provided that the load resistance R is greater than the tank char-
acteristic impedance Re, the parallel resonant converter can produce conversion ratios both greater than 
and less than one. In fact, the ideal parallel resonant converter can produce conversion ratios approaching 
infinity, provided that the output current is limited to values less than V/R0. Of course, losses limit the 
maximum output voltage that can be produced by practical converters. 
19.3 
SOFT SWITCHING 
As mentioned previously, the soft-switching phenomena known as zero-current switching (ZCS) and 
zero-voltage switching (ZVS) can lead to reduced switching loss. When the turn-on and/or turn-off tran-

722 
Resonant Conversion 
+ 
Fig. 19.24 A series resonant converter incorporating a full-bridge switch network. 
sitions of a semiconductor switching device coincide with the zero crossings of the applied waveforms, 
some of the switching loss mechanisms discussed in Section 4.3 are eliminated. In converters containing 
MOSFETs and diodes, zero-voltage switching mitigates the switching loss otherwise caused by diode 
recovered charge and semiconductor output capacitance. Zero-current switching can mitigate the switch-
ing loss caused by current tailing in IGBTs and by stray inductances. Zero-current switching can also be 
used for commutation of SCRs. In the majority of applications, where diode recovered charge and semi-
conductor output capacitances are the dominant sources of PWM switching loss, zero-voltage switching 
is preferred. 
19.3.1 
Operation of the Full Bridge Below 
Resonance: Zero-Current Switching 
When the series and parallel resonant inverters and 
de-de converters are operated below resonance, the 
zero-current switching phenomenon can occur, in 
which the circuit causes the transistor current to go to 
zero before the transistor is turned off. Let us consider 
the operation of the full bridge switch network of the 
series resonant converter in detail. 
A full bridge circuit, realized using power 
MOSFETs and antiparallel diodes, is shown in Fig. 
19.24. The switch output voltage v,(t), and its funda-
mental component vs1(t), as well as the approximately 
sinusoidal tank current waveform i.(t), are illustrated 
in Fig. 19.25. At frequencies less than the tank reso-
nant frequency, the input impedance of the series reso-
nant tank network Z;(s) is dominated by the tank 
capacitor impedance [see Fig. 19.16(a)]. Hence, the 
tank presents an effective capacitive load to the 
bridge, and switch current i/t) leads the switch volt-
age fundamental component vs1(t), as shown in Fig. 
19.25. In consequence, the zero crossing of the cur-
rent waveform i/t) occurs before the zero crossing of 
the voltage vs(t). 
Conducting 
devices: 
Q, 
Q, 
"Hard" 
"Soft" 
"Hard" 
turn-on of tum-off of turn-on of 
Ql' Q. 
Ql, Q. 
Q,, Q, 
p, 
!D, t 
"Soft" 
tum-off of 
Q,,QJ 
Fig. 19.25 Switch network output waveforms for 
the series resonant converter, operated below reso-
nance in the k = 1 CCM. Zero-current switching 
aids the transistor turn-off process. 

Fig. 19.26 Transistor Q1 voltage and current wave-
forms, for operation of the series resonant converter 
id,(t) 
below resonance in the k = 1 CCM. 
Conducting 
devices: 
t 
"Hard" turn-on 
ofQI' Q4 
19.3 Soft Switching 
723 
t~ i 
iDI 
!D4 
t 
"Soft" turn-off 
ofQ 1, Q4 
For the half cycle 0 < t < TJ2, the switch voltage vs is equal to+ Vg. For 0 < t < t~, the current 
i,(t) is positive and transistors Q1 and Q4 conduct. Diodes D 1 and D4 conduct when i/t) is negative, over 
the interval t~ < t < T,f2. The situation during T,/2 < t < Ts is symmetrical. Since is1 (t) leads vs1 (t), the 
transistors conduct before their respective antiparallel diodes. Note that, at any given time during the D1 
conduction interval t~ < t < TJ2, transistor Q1 can be turned off without incurring switching loss. The 
circuit naturally causes the transistor turn-off transition to be lossless, and long turn-off switching times 
can be tolerated. 
In general, zero current switching can occur when the resonant tank presents an effective capac-
itive load to the switches, so that the switch current zero crossings occur before the switch voltage zero 
crossings. In the bridge configuration, zero current switching is characterized by the half-bridge conduc-
tion sequence Q1-D1-Q2-D2, such that the transistors are turned off while their respective antiparallel 
diodes conduct. It is possible, if desired, to replace the transistors with naturally commutated thyristors 
whenever the zero-current-switching property occurs at the turn-off transition. 
The transistor turn-on transition in Fig. 19.26 is similar to that of a PWM switch: it is hard-
switched and is not lossless. During the turn-on transition of Q1, diode D2 must turn off. Neither the tran-
sistor current nor the transistor voltage is zero, Q1 passes through a period of high instantaneous power 
dissipation, and switching loss occurs. As in the PWM case, the reverse recovery current of diode D2 
flows through Q1• This current spike can be the largest component of switching loss. In addition, the 
energy stored in the drain-to-source capacitances of Q1 and Q2 and in the depletion layer capacitance of 
D 1 is lost when Q1 turns on. These turn-on transition switching loss mechanisms can be a major disad-
vantage of zero-current-switching schemes. Since zero-current switching does not address the switching 
loss mechanisms that dominate in MOSFET converters, improvements in efficiency are typically not 
observed. 
19.3.2 
Operation of the Full Bridge Above Resonance: Zero-Voltage Switching 
When the series resonant converter is operated above resonance, the zero-voltage switching phenomenon 
can occur, in which the circuit causes the transistor voltage to become zero before the controller turns the 

724 
Resonant Conversion 
Fig. 19.27 
Switch network output waveforms for the 
series resonant converter, operated above resonance in the 
continuous conduction mode. Zero-voltage switching aids 
the transistor tum-on process. 
Conducting D1 
devices: D4 
t 
"Soft" 
turn-on of 
Ql' Q4 
I 
"Hard" 
"Soft" 
"Hard" 
tum-off of turn-on of tum-off of 
Ql' Q4 
Q2' Q3 
Q2' Q3 
transistor on. With a minor circuit modification, the transistor tum-off transitions can also be caused to 
occur at zero voltage. This process can lead to significant reductions in the switching losses of converters 
based on MOSFETs and diodes. 
For the full bridge circuit of Fig. 19.24, the switch output voltage v/(), and its fundamental 
component vs1(t), as well as the approximately sinusoidal tank current waveform i,(t), are plotted in Fig. 
19.27. At frequencies greater than the tank resonant frequency, the input impedance of the tank network 
Z;(s) is dominated by the tank inductor impedance. Hence, the tank presents an effective inductive load to 
the bridge, and the switch current i,.(t) lags the switch voltage fundamental component vs1(t), as shown in 
Fig. 19.27. In consequence, the zero crossing of the voltage waveform v,.(t) occurs before the current 
waveform is(t). 
For the half cycle 0 < t < TJ2, the switch voltage vs(t) is equal to+ V8 . For 0 < t < ta, the current 
is(t) is negative and diodes D 1 and D4 conduct. Transistors Q1 and Q4 conduct when i,(t) is positive, over 
the interval ta < t < TJ2. The waveforms during TJ2 < t < Ts are symmetrical. Since the zero crossing of 
v,.(t) leads the zero crossing of i,.(t), the transistors conduct after their respective anti parallel diodes. Note 
that, at any given time during the D1 conduction interval 0 < t < ta, transistor Q1 can be turned on without 
incurring switching loss. The circuit naturally causes the transistor tum-on transition to be lossless, and 
long tum-on switching times can be tolerated. A particularly significant implication of this is that the 
switching loss associated with reverse recovery of the antiparallel diodes is avoided. Relatively slow 
diodes, such as the MOSFET body diodes, can be employed for realization of diodes D 1 to D4 . In addi-
tion, the output capacitances of transistors Q1 to Q4 and diodes D1 to D4 do not lead to switching loss. 
In general, zero-voltage switching can occur when the resonant tank presents an effective induc-
tive load to the switches, and hence the switch voltage zero crossings occur before the switch current 
zero crossings. In the bridge configuration, zero-voltage switching is characterized by the half-bridge 
conduction sequence D 1-Q1-D2-Q2 , such that the transistors are turned on while their respective anti par-

Fig. 19.28 Transistor Q1 voltage and current wave-
forms, for operation of the series resonant converter 
above resonance in the k = 0 CCM. 
Ita 
Conducting D 1 j 
devices: v4 ! 
t 
19.3 Soft Switching 
725 
"Soft" 
"Hard" 
tum-on of tum-off of 
Ql' Q4 
Ql' Q4 
allel diodes conduct. Since the transistor voltage is zero during the entire tum on transition, switching 
loss due to slow tum-on times or due to energy storage in any of the device capacitances does not occur 
at tum-on. 
The transistor tum-off transition in Fig. 19.28 is similar to that of a PWM switch. In converters 
that employ IGBTs or other minority-carrier devices, significant switching loss may occur at the tum-off 
transitions. The current tailing phenomenon causes Q1 to pass through a period of high instantaneous 
power dissipation, and switching loss occurs. 
To assist the transistor tum off process, small capacitors C 1eg may be introduced into the legs of 
the bridge, as demonstrated in Fig. 19.29. In a converter employing MOSFETs, the device output capac-
itances are sufficient for this purpose, with no need for external discrete capacitors. A delay is also intro-
duced into the gate drive signals, so that there is a short commutation interval when all four transistors 
are off. During the normal Q1, D1, Q2, and D2 conduction intervals, the leg capacitors appear in parallel 
with the semiconductor switches, and have no effect on the converter operation. However, these capaci-
tors introduce commutation intervals at transistor tum-off. When Q1 is turned off, the tank current 
i8(T/2) flows through the switch capacitances Cleg instead of Q1, and the voltage across Q1 and C 1eg 
increases. Eventually, the voltage across Q1 reaches Vg; diode D2 then becomes forward-biased. If the 
MOSFET tum-off time is sufficiently fast, then the MOSFET is switched fully off before the drain volt-
age rises significantly above zero, and negligible tum-off switching loss is incurred. The energy stored in 
the device capacitances, that is, in Cteg' is transferred to the tank inductor. The fact that none of the semi-
conductor device capacitances or stored charges lead to switching loss is the major advantage of zero-
voltage switching, and is the most common motivation for its use. MOSFET converters can typically be 
operated in this manner, using only the internal drain-to-source capacitances. However, other devices 
such as IGBTs typically require substantial external capacitances to reduce the losses incurred during the 
IGBT tum-off transitions. 
An additional advantage of zero-voltage switching is the reduction of EMI associated with 
device capacitances. In conventional PWM converters and also, to some extent, in zero-current switching 
converters, significant high-frequency ringing and current spikes are generated by the rapid charging and 
discharging of the semiconductor device capacitances during the tum-on and/or tum-off transitions. 

726 
Resonant Conversion 
(a) 
+ 
Fig. 19.29 Introduction of small capacitors C1eg' 
which reduce the turn-off-transition switching loss 
when the series resonant converter is operated above 
resonance: (a) bridge circuit, (b) transistor voltage 
waveform. 
+ 
V dsi (t) 
(b) 
L 
to remainder 
of converter 
Ringing is conspicuously absent from the waveforms of converters in which all semiconductor devices 
switch at zero voltage; these converters inherently do not generate this type of EMI. 
19.4 
LOAD-DEPENDENT PROPERTIES 
OF RESONANT CONVERTERS 
The properties of the CCM PWM converters studied in previous chapters are largely unaffected by the 
load current. In consequence, these converters exhibit several desirable properties that are often taken for 
granted. The transistor current is proportional to the load current; hence conduction losses become small 
at light load, leading to good light-load efficiency. Also, the output impedance is low, and hence the de 
output voltage does not significantly depend on the load i-v characteristic (at least, in CCM). Unfortu-
nately, these good properties are not necessarily shared by resonant converters. Of central importance in 
design of a resonant converter is the selection of the resonant tank topology and element values, so that 
the transistor conduction losses at light load are minimized, so that zero-voltage switching is obtained 
over a wide range of load currents (preferably, for all anticipated loads, but at least at full and intermedi-
ate load powers), and so that the converter dynamic range is compatible with the load i-v characteristic. 
These design issues are addressed in this section. 
The conduction loss caused by circulating tank currents is well-recognized as a problem in res-
onant converter design. These currents are independent of, or only weakly dependent on, the load cur-
rent, and lead to poor efficiency at light load. In Fig. 19.30, the switch current i/s) is equal to vs(s)/Z;(s). 
If we want the switch current to track the load current, then at the switching frequency II Z; II should be 
dominated by, or at least strongly influenced by, the load resistance R. Unfortunately, this is often not 
consistent with the requirement for zero-voltage switching, in which Z; is dominated by a tank inductor. 

Fig. 19.30 
Resonant inverter model. 
19.4 
Load-Dependent Properties of Resonant Converters 
727 
Transfer function 
H(s) 
~ 
i,(t) 
i(t) 
Resonant 
network 
+ 
Z; 
zo 
v(t) 
-
-
Purely reactive 
Effective 
resistive 
load 
R 
To design a resonant converter that exhibits good properties, the engineer must develop physical insight 
into how the load resistance R affects the tank input impedance and output voltage. 
In this section, the inverter output characteristics, zero-voltage switching boundary, and the 
dependence of transistor current on load resistance, are related to the properties of the tank network 
under the extreme conditions of an open-circuited or short-circuited load. The undamped tank network 
responses are easily plotted, and the insight needed to optimize the tank network design can be gained 
quickly. 
19.4.1 
Inverter Output Characteristics 
Let us first investigate how the magnitude of the inverter output voltage II v II depends on the load current 
magnitude II i 11. Consider the resonant inverter system of Fig. 19.30. Let Hjs) be the open-circuit 
(R --> oo) transfer function of the tank network: 
(19.33) 
and let Z00(s) be the output impedance, determined when the source vs1(s) is short-circuited. Then we can 
model the output port of the tank network using the Thevenin-equivalent circuit of Fig. 19.31. Solution 
of this circuit using the voltage divider formula leads to 
(19.34) 
At a given angular switching frequency ffis = 2nfs, the phasor representing the magnitude and phase of 
the ac output voltage is found by letting s = jffi,: 
(19.35) 
The magnitude can be found by noting that 
(19.36) 
where v*(jffis) is the complex conjugate of v(jffi). Substitution of Eq. (19.35) into Eq. (19.36) leads to 

728 
Resonant Conversion 
,-------------------------------------------~----_-----+·1 _ _,...., 
[ + 
I Hoovsl 
I V 
I 
.:i 
I 
' 
'j 
-
! 
R 
! ________________ T_~l_!-~_l_!_f!_0Y__r:_:_~---------i 
Fig. 19.31 
Thevenin-equivalent circuit that models the output port of the tank network. 
(19.37) 
This result can be further simplified with the assumption that the tank network contains only purely reac-
tive elements, i.e., that any losses or other resistive elements within the tank network have negligible 
effect. Then the output impedance Z00(joos), as well as all other driving-point impedances of the tank net-
work, are purely imaginary quantities. This implies that the complex conjugate Z: 00(joos) is given by 
(19.38) 
Substitution of Eq. (19.38) into Eq. (19.37) and simplification leads to 
(19.39) 
with 
II v(}w,) II 
R=---
11 i(Jw,) II 
(19.40) 
Substitution of Eq. (19.40) into Eq. (19.39) and rearrangement of terms yields 
(19.41) 
Hence, at a given frequency, the inverter output characteristic, that is, the relationship between II v(Joo,) II 
and II i(Joo,) II, is elliptical. Equation (19.41) can be further rearranged, into the form 

19.4 Load-Dependent Properties of Resonant Converters 
729 
II iII 
Inverter output 
characteristic 
Fig. 
19.32 Elliptical output 
I,c 
characteristics 
of 
resonant 
,f2 
inverters. A resistive matched 
load is also illustrated. 
where the open-circuit voltage Voc and short-circuit current Isc are given by 
V oc = II H =(jm,) 1111 v ,(jm) II 
1 Jl H =(jw,) 1111 v,(jw,) ~ = 
Voc 
sc 
II 2 aoUW,) II 
II 2 ao(jm,) II 
(19.43) 
These inverter output characteristics are constructed in Fig. 19.32. This characteristic describes how, at a 
given switching frequency, the ac output voltage magnitude varies as the circuit is loaded. The equilib-
rium output voltage is given by the intersection of this elliptical characteristic with the load i-v character-
istic. For example, Fig. 19.32 also illustrates a superimposed resistive load line having slope 1/R, in the 
special case where R = II Z00(jm)ll. This value of R corresponds to matched load operation, in which the 
converter output power is maximized. It can be shown that the operating point is then given by 
II v(jwJII 2 = h 
II i(jw,) 11 2 =A 
(19.44) 
Note that Fig. 19.32 can also be applied to the output i-v characteristics of resonant de-de converters, 
since the output rectifier then loads the tank with an effective resistive load Re. 
19.4.2 
Dependence of Transistor Current on Load 
The transistors must conduct the current appearing at the input port of the tank network, i,(t). This cur-
rent is determined by the tank network input impedance Z;(jws): 

730 
Resonant Conversion 
(a) 
L 
(b) 
Fig. 19.33 Tank network, parallel resonant converter example: (a) tank circuit, (b) Bode plot of input impedance 
magnitude II Z; II for the limiting cases R -> 0 and R -+ oo. 
i ( ·w)- v,/}W,) 
sl J s - z .( ·w ) 
' J s 
(19.45) 
As described previously, obtaining good light-load efficiency requires that II Z;(jw,.) II increase as the load 
resistance R increases. To understand how II Z;(Jws) II depends on R, let us sketch II Z;(Jws) II in the 
extreme cases of an open-circuited (R--+ oo) and short-circuited (R--+ 0) load: 
Z;o(Jw,) = Z;(Jw,) IR->O 
Z;=(jw) = Z;(jw,) IR--+= 
(19.46) 
For example, consider the parallel resonant converter of Figs. 19.19 to 19.23. The Bode dia-
grams of the impedances II ZiO(jws) II and II Zi=(jw,.) II are constructed in Fig. 19.33. Z;o(s) is found with 
the load R shorted, and is equal to the inductor impedance sL. Z;=(s), found with the load R open-cir-
cuited, is given by the series combination (sL + 1/sC). It can be seen in Fig. 19.33 that the impedance 
magnitudes II Z;0CJws) II and II Z;=(Jw,.) II intersect at frequency fm. If the switching frequency is chosen 
such that..t; <fm, then II Zi=(jW8 ) II > II ZiO(Jw,) 11. The converter then exhibits the desirable characteristic 
that the no-load switch current magnitude II v,(Jw,.) II I II Z;=CJw,.) II is smaller than the switch current 
under short-circuit conditions, II v,(Jws) II I II Z;0CJws) If. In fact, the short-circuit switch current is limited 
by the impedance of the tank inductor, while the open-circuit switch current is determined primarily by 
the impedance of the tank capacitor. 
If the switching frequency is chosen such that..t; > fm, then II Z;=(Jw,.) II < II Z;0(Jw,.) If. The no-
load switch current is then greater in magnitude than the switch current when the load is short-circuited! 
When the load current is reduced or removed, the transistors will continue to conduct large currents and 
generate high conduction losses. This causes the efficiency at light load to be poor. It can be concluded 
that, to obtain good light-load efficiency in the parallel resonant converter, one should choose fs suffi-
ciently less than fm· Unfortunately, this requires operation below resonance, leading to reduced output 
voltage dynamic range and a tendency to lose the zero-voltage switching property. 
A remaining question is how II Z;CJws) II behaves for intermediate values of load between the 
open-circuit and short-circuit conditions. The answer is given by Theorem 1 below: II Z;CJW8 ) II varies 
monotonically with R, and therefore is bounded by II ZiO(jw,) II and II Z;=CJw,.) If. Hence, the Bode plots of 

19.4 
Load-Dependent Properties of Resonant Converters 
731 
Fig. 
19.34 Series, parallel, 
and LCC resonant tank net-
works, and their input imped-
ances Z;o and Z1=. 
Parallel 
L 
~~ 
LCC 
iuz,_ll 
f 
IIZ,oll-
f 
the limiting cases II Zi0(jwJ II and II Zi=(jws) II provide a correct qualitative understanding of the behavior 
of II Zi II for all R. The theorem is valid for loss less tank networks. 
Theorem 1: If the tank network is purely reactive, then its input impedance II Zi II is a monotonic 
function of the load resistance R. 
This theorem is proven by use of Middlebrook's Extra Element Theorem (see Appendix C). The tank 
network input impedance Zi(s) can be expressed as a function of the load resistance Rand the tank net-
work driving-point impedances, as follows: 
(19.47) 
where ZiO and Zi= are the resonant network input impedances, with the load short-circuited or open-cir-
cuited, respectively, and Z00 and Zo= are the resonant network output impedances, with the source input 
short-circuited or open-circuited, respectively. These terminal impedances are simple functions of the 
tank elements, and their Bode diagrams are easily constructed. The input impedances of the series reso-

732 
Resonant Conversion 
nant, parallel resonant, and LCC inverters are listed in Fig. 19.34. Since these impedances do not depend 
on the load, they are purely reactive, ideally have zero real parts [38], and their complex conjugates are 
given by Z00* =- Z00 , Zo=* =- Zo=' etc. Again, recall that the magnitude of a complex impedance Z(jw) 
can be expressed as the square root of Z(jw)z*(jw). Hence, the magnitude of Z;(s) is given by 
(19.48) 
where Z/ is the complex conjugate of Z;. 
Next, let us differentiate Eq. (19.48) with respect toR: 
(19.49) 
The derivative has roots at (i) R = 0, (ii) R = =, and in the special case (iii) where II Zm II = II Zi= 11. Since 
the derivative is otherwise nonzero, the resonant network input impedance II Z; II is a monotonic function 
of R, over the range 0 < R < =. In special case (iii), II Z; II is independent of R. Therefore, Theorem 1 is 
proved. 
An example is given in Figs. 19.36 and 19.35, for the LCC inverter. Figure 19.35 illustrates the 
impedance asymptotes of the limiting cases II Z;o II and II Zi= 11. Variation of II Z; II between these limits, 
for finite nonzero R, is illustrated in Fig. 19.36. The open-circuit resonant frequency f= and the short-cir-
cuit resonant frequency fo are given by 
f'-
1 
10 - 2n/LC; 
t = 
1 
= 
2n.j L C,IIC P 
(19.50) 
where Csll CP denotes inverse addition of Cs and CP: 
(19.51) 
For the LCC inverter, the impedance magnitudes II Z;o II and II Zi= II are equal at frequency fm, given by 
(19.52) 

Fig. 
19.35 Construction of 
the 
quantities 
II Z;0 II 
and 
II zi= II' for the LCC inverter. 
Fig. 19.36 Variation of tank 
network 
input 
impedance 
II Z; II with load resistance R, 
LCC inverter. As the load 
resistance is increased, II Z; II 
changes monotonically from 
II Z;o II to II Z;= 11. 
liZ; II 
liZ; II 
-~ 
"'"-..:;r 
19.4 Load-Dependent Properties of Resonant Converters 
733 
fo 
--
fr-
1 
o- 2n.jLC, 
J> 
l 
= 
2nJLC,IICP 
!, -
1 
'"- 2nJ LC,II2C P 
f 
f 
If the switching frequency is chosen to be greater than fm, then II zi= II is less than II Z;o II- This implies 
that, as the load current is decreased, the transistor current will increase. Such a converter will have poor 
efficiency at light load, and will exhibit significant circulating currents. If the switching frequency is cho-
sen to be less thanfm, then the transistor current will increase with decrease with decreasing load current. 
The short-circuit current is limited by II Z;o II, while the circulating currents under open-circuit conditions 
are determined by II Z;= 11. In general, iff> fm, then the transistor current is greater than or equal to the 
short-circuit current for all R. The inequality is reversed whenf <fm· 
The impedance magnitudes II Z;o II and II Zi= II are illustrated in Fig. 19.34 for the series, parallel, 
and LCC tank networks. In the case of the series tank network, II Zi= II= oo. In consequence, the no-load 
transistor current is zero, both above resonance and below resonance. Hence, the series resonant inverter 
exhibits the desirable property that the transistor current is proportional to the load current. In addition, 
when the load is short-circuited, the current magnitude is limited by the impedance of the series resonant 
tank. For the parallel and LCC inverters, it is desirable to operate below the frequency fm· 
Thus, the dependence of the transistor current on load can be easily determined, using an intui-
tive frequency-domain approach. 

734 
Resonant Conversion 
19.4.3 
Dependence of the ZVS/ZCS Boundary 
on Load Resistance 
It is also necessary to determine the critical load resistance R = Rcrit at the boundary between ZVS and 
ZCS. This boundary can also be expressed as a function of the impedances Z;o and Z;=· 
As discussed in Section 19.3, zero-voltage switching occurs when the switch current i,.(t) lags 
the switch voltage v,.(t). Zero-voltage switching occurs when i,(t) leads v,(t). This definition ignores the 
effects of semiconductor output capacitances, and hence gives an approximate ZVS/ZCS boundary. The 
phase between the switch current and switch voltage is again determined by the input impedance of the 
tank network: 
i ( ·w) = v,I(jw) 
st J s 
z.( ·w) 
I j 
S 
(19.53) 
Hence, zero-voltage switching occurs when ZJjw,) is inductive in nature, zero-current switching occurs 
when Z;()w,) is capacitive in nature, and the ZVS/ZCS boundary occurs where Z;(jw,) has zero phase. 
It is instructive to again consider the limiting cases of a short-circuited and open-circuited load. 
The Bode plots of ZiO(jws) and Zi=(jw,.) for an LCC inverter example are sketched in Fig. 19.37. Since, in 
these limiting cases, the input impedance Z; is composed only of the reactive tank elements, ZiO(jws) and 
Zi=(jws) are purely imaginary quantities having phase of either- 90° or + 90°. For!,. <J0 , both Z;0(jws) 
and Zi=(jws) are dominated by the tank capacitor or capacitors; the phase of Z;(jws) is therefore- 90°. 
Hence, zero-current switching is obtained under both short-circuit and open-circuit conditions. For 
is> L, both Z;oVWs) and zi=(jw,) are dominated by the tank inductor; hence the phase of Z;()w) is+ 90° 0 
Zero-voltage switching is obtained for both a short-circuited and an open-circuited load. For f0 <fs <L, 
Z;0(jws) is dominated by the tank inductor while Zi=(jws) is dominated by the tank capacitors. This 
implies that zero-voltage switching is obtained under short-circuit conditions, and zero-voltage switch-
ing is obtained under open-circuit conditions. For this case, there must be some critical value of load 
resistance R = Rcrit that represents the boundary between ZVS and ZCS, and that causes the phase of 
Z;(jws) to be equal to 0°. 
The behavior of ZJJws) for nonzero finite R is easily extrapolated from the limiting cases dis-
Fig. 19.37 
Use of the input 
impedance quantities Z;o and 
Z;= to determine the ZCS/ZVS 
boundaries, LCC example. 
liZ; II 
fo 
L 
zcs lzcs: R > R l zvs 
: 
cnt: 
for all R izvs:R<R . ! for all R 
: 
cnt: 
' 
[---+ 
f 

19.4 Load-Dependent Properties of Resonant Converters 
735 
cussed above. Theorem 2 below shows that: 
1. 
If zero-current switching occurs for both an open-circuited load and a short-circuited load [i.e., Z;0(jws) 
and Z;=(jws) both have phase+ 90'], then zero-current switching occurs for all loads. 
2. 
If zero-voltage switching occurs for both an open-circuited load and a short-circuited load [i.e., Z;o(jws) 
and Z;=(jws) both have phase- 90'], then zero-voltage switching occurs for all loads. 
3. 
If zero-voltage switching occurs for an open-circuited load and zero-current switching occurs for a short-
circuited load [i.e., Z;0(jws) has phase - 90' and Zi=(jws) has phase + 90'], then zero-voltage switching 
occurs for R > Rcrit' and zero-current switching occurs for R < Rcrit' with Rcrit given by Eq. (19.54) below. 
4. 
If zero-current switching occurs for an open-circuited load and zero-voltage switching occurs for a short-
circuited load [i.e., Z;0(jws) has phase + 90' and Zi=(jws) has phase - 90'], then zero-current switching 
occurs for R > Rcrir' and zero-voltage switching occurs for R < Rcrir• with Rcrit given by Eq. (19.54) below. 
For the LCC example, we can therefore conclude that, for is <f0 , zero-current switching occurs for all 
values of R. For fs > L. zero-voltage switching occurs for all values of R. For / 0 <is <L, the boundary 
between ZVS and ZCS is given by Eq. (19.54). 
Theorem 2: If the tank network is purely reactive, then the boundary between zero-current switch-
ing and zero-voltage switching occurs when the load resistance R is equal to the critical value 
Rcrit' given by 
(19.54) 
This theorem relies on the assumption that zero-current switching occurs when the tank input impedance 
is capacitive in nature, while zero-voltage switching occurs for inductive input impedances. The bound-
ary therefore occurs where the phase of Z;(joo) is zero. This definition gives a necessary but not sufficient 
condition for zero-voltage switchingwhen significant semiconductor output capacitance is present. 
The result is derived by finding the value of R which causes the imaginary part of Z/}00) in Eq. 
(19.47) to be zero. Since the tank network is assumed to ideal and lossless, the impedances Zo=' Z00 , and 
Zi= must have zero real parts. Hence, 
( 
Z l ( 
ZooZo=) 
1 + __<J(l_ 
1 - -2-
( 
) 
( 
) 
Rcrit 
( 
) 
R crit 
Im Z;(Rcr;1) = Im Z;= Re --
= Im Z;= ( 
2 ) 
0 
1+ 2o= 
1)lzo=ll 
Rcrir 
R2. 
cnt 
(19.55) 
where Im(Z) and Re(Z) denote the imaginary and real parts of the complex quantity Z. The nontrivial 
solution to Eq. (19.55) is given by 
(19.56) 
hence, 
(19.57) 
A useful equivalent form makes use of the reciprocity identities 

736 
Resonant Conversion 
(a) 
LZ; 
90' 
60' 
30' 
o· ... 
............................................. 
-30' 
-60' 
-90' 
f 
fo 
f_ 
(b) 
R 
fo 
!,, 
f_ 
f 
Fig. 19.38 
ZCS/ZVS boundary, LCC inverter example: (a) variation of tank network input impedance phase shift 
with load resistance, (b) Comparison of Rcrir with matched-load impedance II ZoO 11. 
(19.58) 
Use of Eq. (19.58) to eliminate 20<'0 from Eq. (19.57) leads to 

19.4 Load-Dependent Properties of Resonant Converters 
737 
Rcrit =II Zoo II ff. 
(19.59) 
This is the desired result. The quantity Z00 is the inverter output impedance, and R = II Z00 II corresponds 
to operation at matched load with maximum output power. The impedances Zi= and ZiO are purely imagi-
nary, and hence Eq. (19.59) has no real solution unless Zi= and Zi0 are of opposite phase. As illustrated in 
Fig. 19.37, if at a given frequency Zi= and ZiO are both inductive, then zero-voltage switching occurs for 
all loads. Zero-current switching occurs for all loads when Zi= and ZiO are both capacitive. Therefore, 
Theorem 2 is proved. 
Figure 19.38(a) illustrates the phase response of Z/jW) as R varies from 0 to =, for the LCC 
inverter. A typical dependence of Rcrit and the matched-load impedance II Z00 II on frequency is illustrated 
in Fig. 19.38(b). Zero-voltage switching occurs for all loads when f > L, and zero-current switching 
occurs for all loads whenf <j0 . Over the range f0 <f <L, ZiO is inductive while Zi= is capacitive; hence, 
zero-voltage switching occurs for R < Rcrit while zero-current switching occurs for R > Rcrir At frequency 
fm, Rcrit =II Z00 11. and hence the ZVS/ZCS boundary is encountered exactly at matched load. It is com-
monly desired to obtain zero-voltage switching at matched load, with low circulating currents and good 
efficiency at light load. It is apparent that this requires operation in the range f0 < f < fm. Zero-voltage 
switching will then be obtained under matched-load and short-circuit conditions, but will be lost at light 
load. The choice of element values such that II ZiO II < II Zi= II is advantageous in that the range of loads 
leading to zero-voltage switching is maximized. 
19.4.4 
Another Example 
As a final example, let us consider selection of the resonant tank elements to obtain a given output char-
acteristic at a certain switching frequency, and let's evaluate the effect of this choice on Rcrit" It is desired 
to operate a resonant inverter at switching frequency fs = 100kHz, with an input voltage of V8 = 160 V. 
The converter should be capable of producing an open-circuit peak output voltage Voc = 400 V, and 
should also produce a nominal output of 150 Vrms at 25 W. It is desired to select resonant tank elements 
that accomplish this. 
The specifications imply that the converter should exhibit an open-circuit transfer function of 
. 
voc 
(4oov) 
II H =(JW,) II = v = ( 
) = 1.96 
sl 
_1160V 
n 
(19.60) 
The required short-circuit current is found by solving Eq. (19.42) for I,c: 
(19.61) 
The specifications also imply that the peak voltage and current at the nominal operating point are 

738 
Resonant Conversion 
V=15012=212V 
I=__E_I2 = 25W 12 =0.236A 
vrms 
150 v 
v 
Rnom = T = 900 Q 
Substitution ofEq. (19.62) into Eq. (19.61) yields 
(0.236 A) 
lsc = -----;~"'7"=~;;= = 0.278 A 
1- (212 V) 2 
400V 
Matched load therefore occurs at the operating point 
v = voc = 283 v 
mat 12 
I 
!mat= jf=0.196A 
II Z 0o(JW,) II= ioc = 1439 Q 
sc 
(19.62) 
(19.63) 
(19.64) 
Let us select the values of the tank elements in the LCC tank network illustrated in Fig. 
19.39(a). The impedances of the series and parallel branches can be represented using the reactances X, 
andXP illustrated in Fig. 19.39(b), with 
}X,= jw,L + -. -1- = j(w,L-_1_) 
JW,C, 
w,C, 
}X =-1-=J(--1-) 
P 
}w,CP 
w,CP 
The transfer function H 00(jWs) is given by the voltage divider formula 
X 
H (. ) 
1 P 
= JW, = ·x 
·x 
J s + J p 
The output impedance Z00(jw,) is given by the parallel combination 
(a) 
(b) 
(19.65) 
(19.66) 
Fig. 19.39 Tank network of the LCC inverter example: (a) schematic, (b) representation of series and parallel 
branches by reactances X, and XP. 

19.4 Load-Dependent Properties of Resonant Converters 
739 
(19.67) 
Solution of Eqs. (19.66) and (19.67) for XP and Xs leads to 
(19.68) 
Hence, the capacitance CP should be chosen equal to 
XP=-1499 Q 
1 
H_(jm) -1 
(1.96) -1 
C =---= 
' 
= 
= 1 nF 
P 
m,XP 
m,IIZ00(jm,)ll (2n 100kHz)(l439Q)-
(19.69) 
and the reactance of the series branch should be chosen according to 
1-(1.96) 
(-1493Q) 
( 
) =733Q 
1.96 
(19.70) 
Since Xs is comprised of the series combination of the inductor L and capacitor Cs, there is a degree of 
freedom in choosing the values of Land capacitor Cs to realize Xs. For example, we could choose Cs very 
large (tending to a short circuit); this effectively would result in a parallel resonant converter with 
L = X/ms = 1.17 mH. For nonzero Cs, L must be chosen according to 
L= J (x,+-1-) 
, 
m,c, 
(19.71) 
For example, the choice Cs = CP = 1.06 nF leads to L = 3.5 mH. Designs using different Cs will exhibit 
exactly the same characteristics at the design frequency; however, the behavior at other switching fre-
quencies will differ. 
For the tank network illustrated in Fig. 19.39, the value of Rcrit is completely determined by the 
parameters of the output characteristic ellipse; i.e., by the specification of Vg, Voc and /sc· Note that Z000 , 
the tank output impedance with the tank input port open-circuited, is equal to jXP. Substitution of expres-
sions for 2 000 and Z 00 into Eq. (19.57) leads to the following expression for Rcrit: 
Z~0(jm,) 
1-H_(jm,) 
(19.72) 
Since Z00 and Hoo are determined by the operating point specifications, then Rcrit is also. Evaluation of 
Eq. (19.72) for this example leads to Rcrit = 1466 Q. Therefore, the inverter will operate with zero-volt-
age switching for R < 1466 Q, including at the nominal operating point R = 900 Q. Other topologies of 
tank network, more complex than the circuit illustrated in Fig. 19.39(b), may have additional degrees of 
freedom that allow Rcrit to be independently chosen. 
The choice Cs = 3CP = 3.2 nF leads to L = 1.96 JIH. The following frequencies are obtained: 

740 
Resonant Conversion 
f== 127kHz 
fm = 100.6 kHz 
fs = 100.0 kHz 
fo= 64kHz 
Regardless of how Cs is chosen, the open-circuit tank input impedance is 
Therefore, when the load is open-circuited, the transistor peak current has magnitude 
_ 
V,1 
_ ~(160V) 
I,r-IIZ;=II-
760Q 
0.268A 
When the load is short-circuited, the transistor peak current has magnitude 
V,1 
V,1 
~ ( 160 v) 
I,r =II Z;o II= rx:r (733 n) = 0.278 A 
(19.73) 
(19.74) 
(19.75) 
(19.76) 
which is nearly the same as the result in Eq. (19.75). The somewhat large open-circuit switch current 
occurs because of the relatively-high specified open-circuit output voltage; lower values of Voc would 
reduce the result in Eq. (19.75). 
19.5 
EXACT CHARACTERISTICS OF THE SERIES 
AND PARALLEL RESONANT CONVERTERS 
The exact steady-state behavior of resonant converters can be determined via methods such as state-
plane analysis. A detailed analysis of resonant de-de converters is beyond the scope of this book. How-
ever, the exact steady-state characteristics of ideal series [1, 13-20] and parallel [6, 22-25] resonant 
de-de converters (Fig. 19.40) are summarized in this section. Small-signal ac modeling has also been 
described in the literature; several relevant papers are [27-30]. 
19.5.1 
Series Resonant Converter 
At a given switching frequency, the series resonant de-de converter can operate in one continuous con-
duction mode, and possibly in several discontinuous conduction modes. The mode index k is defined as 
the integer that satisfies 
or 
(19.77) 
where F = fslfo is the normalized switching frequency. The sub harmonic numbers is defined as 

19.5 
Exact Characteristics of the Series and Parallel Resonant Converters 
741 
(a) 
~ 
+ 
vg 
+ 
R 
V 
&f 
(b) 
~ 
+ 
vg 
+ 
R 
V 
&f 
Fig. 19.40 Transformer-isolated resonant de-de converters: (a) series resonant converter, (b) parallel resonant 
converter. 
~-k+l+C-Il 
..,-
2 
(19.78) 
Values of k and~ as functions offs are summarized in Fig. 19.4l(a). The subharmonic number~ denotes 
the dominant harmonic that excites the tank resonance. When the converter is heavily loaded, it operates 
in type k continuous conduction mode. As the load is reduced (i.e., as the load resistance R is increased), 
the converter enters the type k discontinuous conduction mode. Further reducing the load causes the con-
verter to enter the type (k- 1) DCM, type (k- 2) DCM, ... , type 1 DCM. There is no type 0 DCM, and 
hence when the converter operates above resonance, only the type 0 continuous conduction mode is pos-
sible. 
In the type k continuous conduction mode, the series resonant converter exhibits elliptical out-
put characteristics, given by 
(19.79) 
For the transformer-isolated converters of Fig. 19.40, M and J are related to the load voltage V and load 
current I according to 
(19.80) 
Again, R0 is the tank characteristic impedance, referred to the transformer primary side. The quantity y is 
the angular length of one-half of the switching period: 

742 
Resonant Conversion 
(a) 
-- ~=3- ----- ~= 1 ---+ 
k=3 ++k=2-++--k= 1--+-k=O--
~ 
~ 
fo/3 
fo/2 
fo 
(b) 
,.(t) I 
vg 
~~ 
iL(t) 
Ql 
+--- (k- 1) complete half-cycles -----+ 
~---------------------y------------------------. 
(c) 
'Pll 
vg 
~~ 
iL(t) 
1-------------- k complete half-cycles -------
1-----------y ----------
Fig. 19.41 
Continuous conduction modes of the series resonant converter: (a) switching frequency ranges ove1 
which various mode indices k and subharmonic numbers S occur; (b) tank inductor current waveform, type k CCM, 
for odd k; (c) tank inductor current waveform, type k CCM, for even k. 

19.5 Exact Characteristics of the Series and Parallel Resonant Converters 
743 
WoT, 
1t 
(19.81) 
y=-2-=F 
Equation (19.79) is valid only fork satisfying Eq. (19.77). It predicts that the voltage conversion ratio M 
is restricted to the range 
(19.82) 
This is consistent with Eq. (19.21). 
Typical CCM tank current waveforms are illustrated in Fig. 19.41. When k is even, the tank 
inductor current is initially negative. In consequence, the switch network antiparallel diodes conduct 
first, for a fraction of a half resonant cycle. If k is odd, then each half switching period is initiated by con-
duction of the switch network transistors. In either case, this is followed by (~- 1) complete tank half-
cycles of ringing. The half-switching period is then concluded by a subinterval shorter than one complete 
resonant half-cycle, in which the device that did not initially conduct is on. The next half switching 
period then begins, and is symmetrical. 
The steady-state control-plane characteristic can be found for a resistive load R obeying V = IR, 
by substitution of the normalized relation J = MQ into Eq. (19.79), where Q = n2R0/R. Use of the qua-
dratic formula and some algebraic manipulations allows solution forM, as a function of load (via Q) and 
switching frequency (via y): 
(19.83) 
This is the closed-form relationship between the conversion ratio M and the switching frequency, for a 
resistive load. It is valid for any continuous conduction mode k. 
The type k discontinuous conduction modes, for k odd, occur over the frequency range 
(19.84) 
In these modes, the output voltage is independent of both load current and switching frequency, and is 
described by 
M=t 
(19.85) 
The type k discontinuous conduction mode, for odd k, occurs over the range of load currents given by 
2(k+ 1) >]> 2(k-1) 
y 
y 
(19.86) 
In the odd discontinuous conduction modes, the tank current rings for k complete resonant half cycles. 
All four output bridge rectifier diodes then become reverse-biased, and the tank current remains at zero 
until the next switching half-period begins, as illustrated in Fig. 19.42. Series resonant converters are not 

744 
Resonant Conversion 
'/') I 
vg 
~~ 
iL(t) 
X 
~+--------- k complete half-cycles ----+ 
y----------
Fig. 19.42 Tank inductor current waveform, type k DCM, for odd k. 
.. 
- vg 
normally purposely designed to operate in odd discontinuous conduction modes, because the output volt-
age is not controllable. Nonetheless, when the load is removed with.fs <f0 , the series resonant converter 
operates in k = 1 DCM with M = I. 
The type k discontinuous conduction mode, fork even, also occurs over the frequency range 
'<!J!. 
Js 
k 
(19.87) 
Even discontinuous conduction modes exhibit current source characteristics, in which the load current is 
a function of switching frequency and input voltage, but not of the load voltage. The output relationship 
is: 
Operation in this mode occurs for 
J - 2k 
- y 
1 
1 
k-1>M>k+1 
(19.88) 
(19.89) 
In the even discontinuous conduction modes, the tank current rings for k complete resonant half-cycles 
during each switching half-period. All four output bridge then become reverse-biased, and the tank cur-
rent remains at zero until the next switching half-period is initiated. Tank current waveforms are illus-
trated in Fig. 19.43 for even DCM. 
The series resonant converter possesses some unusual properties when operated in an even dis-
continuous conduction mode. A de equivalent circuit is given in Fig. 19.44, consisting of a gyrator with 
gyration conductance g = 2k/gn2Ro- The gyrator has the property of transforming circuits into their dual 
networks; in the typical de-de converter application, the input voltage source V8 is effectively trans-
formed into its dual, an output current source of value gV8 • Series resonant converters have been pur-
posely designed to operate in the k = 2 DCM, at power levels of several tens of kW. 
The complete control plane characteristics can now be plotted using Eqs. (19.77) to (19.89). 

19.5 Exact Characteristics of the Series and Parallel Resonant Converters 
745 
,p)l 
vg 
~~ 
- vg 
iL(t) 
Fig. 19.43 Tank inductor current waveform, type k DCM, for even k. 
!8 = gV 
lg = gV8 
_+_.,._..;.:·_ .................. g 
........... .-... -... +, ---1-+-
Fig. 19.44 Steady-state equivalent circuit model for an even dis-
continuous conduction mode: an effective gyrator. The converter 
exhibits current source characteristics. 
~ 
g = Jls.... 
YRo 
; ___________________________________ ] 
v 
The result is shown in Fig. 19.45, and the mode boundaries are explicitly diagrammed in Fig. 19.46. It 
can be seen that, for operation above resonance, the only possible operating mode is the k = 0 CCM, and 
that the output voltage decreases monotonically with increasing switching frequency. Reduction in load 
current (or increase in load resistance, which decreases Q) causes the output voltage to increase. Anum-
ber of successful designs that operate above resonance and utilize zero-voltage switching have been doc-
umented in the literature [7,21]. 
Operation below resonance is complicated by the presence of subharmonic and discontinuous 
conduction modes. The k = 1 CCM and k = 2 DCM are well behaved, in that the output voltage increases 
monotonically with increasing switching frequency. Increase of the load current again causes the output 
voltage to decrease. Successful designs that operate in these modes and employ zero-current switching 
are numerous. However, operation in the higher-order modes (k = 2 CCM, k = 4 DCM, etc.) is normally 
avoided. 
Given F and Q, the operating mode can be evaluated directly, using the following algorithm. 
First, the continuous conduction mode k corresponding to operation at frequency F with heavy loading is 
found: 
(19.90) 
where INT(x) denotes the integer part of x. Next, the quantity k1 is determined: 

746 
Resonant Conversion 
0.9 
Q=0.2 
0.8 
0.35 
0.7 
0.5 
0.6 
0.35 
:::."" 
0.75 
S: 
0.5 
II 
~ 0.4 
0.5 
0.75 
0.3 
1 
1.5 
1.5 
2 
0.2 
2 
3.5 
3.5 
0.1 
5 
5 
10 
10 
0 Q=20 
Q=20 
0 
0.2 
0.4 
0.6 
0.8 
1.2 
1.4 
1.6 
1.8 
2 
F=fsl fo 
Fig. 19.45 
Complete control plane characteristics of the series resonant converter, for the range 0.2 :::; F:::; 2. 
0.9 
0.8 
0.7 
0.6 
~ 0.5 
0.4 
0.3 
0.2 
0.1 
0 
0 
0.2 
0.4 
0.6 
0.8 
1.2 
1.4 
1.6 
1.8 
2 
F 
Fig. 19.46 
Continuous and discontinuous conduction mode boundaries. 

19.5 Exact Characteristics of the Series and Parallel Resonant Converters 
747 
6-r-------
F = 1.01 
4 
J 
3 
2 
F= 1.30 
0 
0.2 
0.4 
0.6 
0.8 
M 
Fig. 19.47 
Output characteristics, k = 0 CCM (above resonance). 
(19.91) 
The converter operates in type k CCM provided that: 
(19.92) 
Otherwise, the converter operates in type k1 DCM. A simple algorithm can therefore be defined, in which 
the conversion ratio M is computed for a given F and Q. First, Eqs. (19.90) to (19.92) are evaluated, to 
determine the operating mode. Then, the appropriate equation (19.83), (19.85), or (19.88) is evaluated to 
findM. 
Output I-V plane characteristics for the k = 0 CCM, plotted using Eq. (19.79), are shown in Fig. 
19.47. The constant-frequency curves are elliptical, and all pass through the point M = 1, J = 0. For a 
given switching frequency, the operating point is given by the intersection of the elliptical converter out-
put characteristic with the load I-V characteristic. 
Output plane characteristics that combine the k = 1 CCM, k = 1 DCM, and k = 2 DCM are 
shown in Fig. 19.48. These were plotted using Eqs. (19.79), (19.85), and (19.88). These curves were 
plotted with the assumption that the transistors are allowed to conduct no longer than one tank half-cycle 
during each switching half-period; this eliminates subharmonic modes and causes the converter to oper-
ate ink= 2 or k = 1 DCM wheneverfs < 0.5f0• It can be seen that the constant-frequency curves are ellip-
tical in the continuous conduction mode, vertical (voltage source characteristic) in the k = 1 DCM, and 
horizontal (current source characteristic) in the k = 2 DCM. 

748 
Resonant Conversion 
J 
3 
2.5 +----------
2 
1.5 
2 n 
F= .75 
F=.5 
F= .90 
4 
k= l CCM 
8 
b-----------~F~=~-2~5~--------------------------------------~~ 
F= .l 
k=2DCM 
0 
0 
0.2 
0.4 
0.6 
0.8 
M 
Fig. 19.48 Output characteristics, k = l CCM, k = l DCM, and k = 2 DCM (below resonance). 
19.5.2 
Parallel Resonant Converter 
For operation in the frequency range 0.5f0 <fs <=,the parallel resonant de-de converter exhibits one 
continuous conduction mode and one discontinuous conduction mode. Typical CCM switch voltage v/t), 
tank inductor current iL(t), and tank capacitor voltage vc(t) waveforms are illustrated in Fig. 19.49. The 
CCM converter output characteristics are given by 
<p= 
- y <p---
M _ (2)( 
sin (<p)) 
cosG) 
-COS- I (COS m 
+ J sin m) 
+ COS- I (COS m 
+} sin m) 
for 0 < y < n (above resonance) 
for n < y < 2n (below resonance) 
(19.93) 
(19.94) 
and where M, J, andy are again defined as in Eqs. (19.80) and (19.81). Given the normalized load current 
J and the half-switching-period-angle y, one can evaluate Eq. (19.94) to find Q), and then evaluate Eq. 
(19.93) to find the converter voltage conversion ratio M. In other words, the output voltage can be found 
for a given load current and switching frequency, without need for computer iteration. 

Fig. 19.49 Typical waveforms of 
the 
parallel resonant converter, 
operating in the continuous conduc-
tion mode. 
19.5 Exact Characteristics of the Series and Parallel Resonant Converters 
749 
v,.(t) 
v g 
y 
y 
- vg 
uv 
A discontinuous conduction mode mechanism occurs in the parallel resonant converter which is 
the dual of the discontinuous conduction mode mechanism of the series resonant converter. In this mode, 
a discontinuous subinterval occurs in which all four output bridge rectifier diodes are forward-biased, 
and the tank capacitor voltage remains at zero. This mode occurs both above and below resonance when 
the converter is heavily loaded. Typical DCM tank capacitor voltage and inductor current waveforms are 
illustrated in Fig. 19.50. The condition for operation in the discontinuous conduction mode is 
where 
J > JcrJY) 
J < JcriY) 
forDCM 
forCCM 
The discontinuous conduction mode is described by the following set of equations: 
(19.95) 
(19.96) 

750 
Resonant Conversion 
: D5 D8 ; D5 D8 
D5 D8 
D6 D7 
! D6 D7 ! 
·-a--: 
!-~-
!------' li : y _ __,:i----
I 
Fig. 19.50 Typical waveforms of the parallel resonant converter, operating in the discontinuous conduction mode. 
3.0 . . 
. 
~... 
: 
2.s 
----~-~-'!' ... _. ____ ,. _____ ,. __ r-.. ---.;;·.:······--------- --1·---------------------------r---------------------------r---------------------------
!F=o.si 
i 
i 
. 
2.0 
J 
1.5 
1.0 
0.5 
'•,, 
1.5 : 
F=2 
! 
0.0 
0.0 
0.5 
1.0 
1.5 
2.0 
2.5 
M 
Fig. 19.51 
Exact output characteristics of the parallel resonant converter, for F > 0.5. Solid curves: CCM, dashed 
curves: DCM. 

19.5 Exact Characteristics of the Series and Parallel Resonant Converters 
751 
3.0 
Q=5 
2.5 
2.0 
i 
; 
, I I I : 
~"" 
::;: 
1.5 
II 
. 
. 
. 
···················-r····························:·····························r···························· 
~ 
1.0 
0.5 
, r r : : 
0.0 
0.5 
1.0 
1.5 
2.0 
2.5 
3.0 
!, lfo 
Fig. 19.52 Exact control characteristics of the parallel resonant converter, with a resistive load. Both CCM and 
DCM operation is included, for 0.5 :o; F :o; 3. 
M co = 1 -cos (~) 
J w = J + sin (~) 
cos (a+~)- 2 cos (a)= -1 
-sin (a+~)+ 2 sin (a)+ (8-a) = 2J 
~+8=y 
M=1+(t)(l-8) 
(19.97) 
Unfortunately, the solution to this set of equations is not known in closed form, because of the 
mixture of linear and trigonometric terms. In consequence, the equations must be solved iteratively. For a 
given y and J, a computer is used to iteratively find the angles a, ~. and 8. M is then evaluated, and the 
output plane characteristics can be plotted. The result is given in Fig. 19.51. The dashed lines are the 
DCM solutions, and the solid lines are the valid CCM solutions. Figure 19.51 describes the complete de 
behavior of the ideal parallel resonant converter for all switching frequencies above 0.5j0. For given val-
ues of normalized switching frequency F = fslf0 = n/y, the relationship between the normalized output 
current J and the normalized output voltage M is approximately elliptical. At resonance (F = 1), the CCM 
ellipse degenerates to the horizontal line J = 1, and the converter exhibits current source characteristics. 
Above resonance, the converter can both step up the voltage (M > 1) and step down the voltage (M < 1). 
The normalized load current is then restricted to J < 1, corresponding to I< V/nR0. For a given switch-
ing frequency greater than the resonant frequency, the actual limit on maximum load current is even 
more restrictive than this limit. Below resonance, the converter can also step up and step down the volt-

752 
Resonant Conversion 
age. Normalized load currents J greater than one are also obtainable, depending on M and F. However, 
no solutions occur when M and J are simultaneously large. 
In Fig. 19.52, the control plane characteristics are plotted for a resistive load. The parameter Q 
is defined for the parallel resonant converter as Q = R!n2R0 • The normalized load current is then given by 
l=MIQ. 
19.6 
SUMMARY OF KEY POINTS 
1. 
The sinusoidal approximation allows a great deal of insight to be gained into the operation of resonant 
inverters and de-de converters. The voltage conversion ratio of de-de resonant converters can be directly 
related to the tank network transfer function. Other important converter properties, such as the output char-
acteristics, dependence (or lack thereof) of transistor current on load current, and zero-voltage- and zero-
current-switching transitions, can also be understood using this approximation. The approximation is 
accurate provided that the effective Q factor is sufficiently large, and provided that the switching frequency 
is sufficiently close to resonance. 
2. 
Simple equivalent circuits are derived, which represent the fundamental components of the tank network 
waveforms, and the de components of the de terminal waveforms. 
3. 
Exact solutions of the ideal de-de series and parallel resonant converters are listed here as well. These 
solutions correctly predict the conversion ratios, for operation not only in the fundamental continuous con-
duction mode, but in discontinuous and subharmonic modes as well. 
4. 
Zero-voltage switching mitigates the switching loss caused by diode recovered charge and semiconductor 
device output capacitances. When the objective is to minimize switching loss and EMI, it is preferable to 
operate each MOSFET and diode with zero-voltage switching. 
5. 
Zero-current switching leads to natural commutation of SCRs, and can also mitigate the switching loss due 
to current tailing in IGBTs. 
6. 
The input impedance magnitude II Z; II, and hence also the transistor current magnitude, are monotonic 
functions of the load resistance R. The dependence of the transistor conduction loss on the load current can 
be easily understood by simply plotting II Z; II in the limiting cases as R--> = and as R--> 0, or II Z;= II and 
II Z;o II. 
7. 
The ZVS/ZCS boundary is also a simple function of Zi= and Z;o· If ZVS occurs at open-circuit and at 
short-circuit, then ZVS occurs for all loads. If ZVS occurs at short-circuit, and ZCS occurs at open-circuit, 
then ZVS is obtained at matched load provided that II Z;= II > II Z;o 11. 
8. 
The output characteristics of all resonant inverters considered here are elliptical, and are described com-
pletely by the open-circuit transfer function magnitude II H= 11. and the output impedance II Z00 11. These 
quantities can be chosen to match the output characteristics to the application requirements. 
REFERENCES 
[1] 
F.C. SCHWARZ, "An Improved Method of Resonant Current Pulse Modulation for Power Converters," 
IEEE Power Electronics Specialists Conference, 1975Record, pp. 194-204, June 1975. 
[2] 
R.L. STEIGERWALD, "High Frequency Resonant Transistor De-De Converters," IEEE Transactions on 
Industrial Electronics, Vol. 31, No.2, pp. 181-191, May 1984. 
[3] 
M. COSBY and R. NELMS, "Designing a Parallel-Loaded Resonant Inverter for an Electronic Ballast Using 

References 
753 
the Fundamental Approximation," IEEE Applied Power Electronics Conference, 1993 Record, 
pp. 413-423. 
[4] 
M. GULKO and S. BEN-YAAKOV, "Current-Sourcing Push-Pull Parallel-Resonance Inverter (CS-PPRI): 
Theory and Application as a Fluorescent Lamp Driver," IEEE Applied Power Electronics Conference, 
1993 Record, pp. 411-417. 
[5] 
Y. CHER0N, H. FOCH, and J. SALESSES, "Study of a Resonant Converter Using Power Transistors in a 
25kWX-ray Tube Power Supply," IEEE Power Electronics Specialists Conference, Proceedings ESA Ses-
sions, pp. 295-306, June 1985. 
[6] 
S. D. JOHNSON, A. F. WITULSKI, and R. W. ERICKSON, "A Comparison of Resonant Topologies in High 
Voltage Applications," IEEE Transactions on Aerospace and Electronic Systems, Vol. 24, No. 3, 
pp. 263-274, July 1988. 
[7] 
Y. MURAl and T. A. LIPO, "High Frequency Series Resonant De Link Power Conversion," IEEE Industry 
Applications Society Annual Meeting, 1988 Record, pp. 648-656. 
[8] 
F. C. SCHWARZ, "A Doublesided Cyclo-Converter," IEEE Power Electronics Specialists Conference, 1979 
Record, pp. 437-447. 
[9] 
D. DIVAN, "The Resonant De Link Converter: A New Concept in Static Power Conversion," IEEE Indus-
try Applications Society Annual Meeting, 1986 Record, pp. 648-656. 
[10] 
R.L. STEIGERWALD, "A Comparison of Half-Bridge Resonant Converter Topologies," IEEE Applied 
Power Electronics Conference, 1987 Record, pp. 135-144. 
[11] 
R. SEVERNS, "Topologies for Three Element Resonant Converters," IEEE Applied Power Electronics Con-
ference, 1990 Record, pp. 712-722. 
[ 12] 
M. KAZIMIERCZUK, W. SZARANIEC, and S. WANG, "Analysis and Design of Parallel Resonant Converter at 
High Qu" IEEE Transactions on Aerospace and Electronic Systems, Vol. 28, pp. 35-50. January 1992. 
[13] 
R. KING and T. STUART, "A Normalized Model for the Half Bridge Series Resonant Converter," IEEE 
Transactions on Aerospace and Electronic Systems, March 1981, pp. 180-193. 
[14] 
V. VORPERIAN and S. CUK, "A Complete DC Analysis of the Series Resonant Converter," IEEE Power 
Electronics Specialists Conference, 1982 Record, pp. 85-100, June 1982. 
[15] 
R. KING and T.A. STUART, "Inherent Overload Protection for the Series Resonant Converter," IEEE Trans-
actions on Aerospace and Electronic Systems, Vol. 19, No.6, pp. 820-830, Nov. 1983. 
[16] 
A. WITULSKI and R. ERICKSON, "Steady-State Analysis of the Series Resonant Converter," IEEE Transac-
tions on Aerospace and Electronic Systems, Vol. 21, No.6, pp. 791-799, Nov. 1985. 
[17] 
A. WITULSKI and R. ERICKSON, "Design of the Series Resonant Converter for Minimum Component 
Stress," IEEE Transactions on Aerospace and Electronic Systems, Vol. 22, No.4, July 1986, pp. 356-363. 
[18] 
R. ORUGANTI and F.C. LEE, "Resonant Power Processors, Part 1: State Plane Analysis," IEEE Transac-
tions on Industry Applications, Vol. 21, Nov./Dec. 1985, pp. 1453-1460. 
[19] 
C.Q. LEE and K. SIR!, "Analysis and Design of Series Resonant Converter by State Plane Diagram," IEEE 

754 
Resonant Conversion 
Transactions on Aerospace and Electronic Systems, Vol. 22, No.6, pp. 757-763, November 1986. 
[20] 
S. TRABERT and R. ERICKSON, "Steady-State Analysis of the Duty Cycle Controlled Series Resonant Con-
verter," IEEE Power Electronics Specialists Conference, 1987 Record, pp. 545-556. 
[21] 
K.D.T. NGO, "Analysis of a Series Resonant Converter Pulsewidth-Modulated of Current-Controlled for 
Low Switching Loss," IEEE Power Electronics Specialists Conference, 1987 Record, pp. 527-536, June 
1987. 
[22] 
R. ORUGANTI and F.C. LEE, "State Plane Analysis of the Parallel Resonant Converter," IEEE Power Elec-
tronics Specialists Conference, 1985 Record, pp. 56-73, June 1985. 
[23] 
S. JOHNSON, "Steady-State Analysis and Design of the Parallel Resonant Converter," M.S. Thesis, Univer-
sity of Colorado, Boulder, 1986. 
[24] 
S. JOHNSON and R. ERICKSON, "Steady-State Analysis and Design of the Parallel Resonant Converter," 
IEEE Transactions on Power Electronics, Vol. 3, No.4, pp. 93-104, Jan. 1988. 
[25] 
A. BHAT and M. SWAMY, "Analysis and Design of a High-Frequency Parallel Resonant Converter Operat-
ing Above Resonance," IEEE Transactions on Aerospace and Electronic Systems, Vol. 25, No. 4, July 
1989,pp.449-458. 
[26] 
F.S. TSAI, P. MATERU, and F.C. LEE, "Constant Frequency, Clamped Mode Resonant Converters," IEEE 
Power Electronics Specialists Conference, 1987 Record, pp. 557-566, June 1987. 
[27] 
V. VORPERIAN and S. CUK, "Small-Signal Analysis of Resonant Converters," IEEE Power Electronics 
Specialists Conference, 1983 Record, pp. 269-282, June 1983. 
[28] 
V. VORPERIAN, "High-Q Approximation in the Small-Signal Analysis of Resonant Converters," IEEE 
Power Electronics Specialists Conference, 1985 Record, pp. 707-715. 
[29] 
R. KING and T. STUART, "Small-Signal Model for the Series Resonant Converter," IEEE Transactions on 
Aerospace and Electronic Systems, May 1985, Vol. 21, No.3, pp. 301-319. 
[30] 
A. WITULSKI, A. HERNANDEZ, and R. ERICKSON, "Small-Signal Equivalent Circuit Modeling of Resonant 
Converters," IEEE Transactions on Power Electronics, January 1991. 
[31] 
R. FISHER, K. NGO, and M. Kuo, "A 500kHz, 250 W De-de Converter with Multiple Outputs Controlled 
by Phase-Shifted PWM and Magnetic Amplifiers," Proceedings of High Frequency Power Conversion 
Conference, pp. 100-110, May 1988. 
[32] 
L. MWEENE, C. WRIGHT, and M. SCHLECHT, "A 1 kW, 500 kHz Front-End Converter for a Distributed 
Power Supply System," IEEE Applied Power Electronics Conference, 1989 Record, pp. 423-432. 
[33] 
R. REDL, L. BELOGH, and D. EDWARDS, "Optimum ZVS Full-Bridge DC/DC Converter with PWM 
Phase-Shift Control: Analysis, Design Considerations, and Experimental Results," IEEE Applied Power 
Electronics Conference, 1994 Record, pp. 159-165. 
[34] 
J. G. CHO, J. A. SABATE, and F. C. LEE, "Novel Full Bridge Zero-Voltage-Transition PWM DC/DC Con-
verter for High Power Applications," IEEE Applied Power Electronics Conference, 1994 Record, 
pp. 143-149. 

Problems 
755 
[35] 
0. D. PATIERSON and D. M. DIVAN, "Pseudo-Resonant Full Bridge DC/DC Converter," IEEE Power 
Electronics Specialists Conference, 1987 Record, pp. 424-430. 
[36] 
R. FARRINGTON, M. JOVANOVIC, and F. C. LEE, "Analysis of Reactive Power in Resonant Converters," 
IEEE Power Electronics Specialists Conference, 1992 Record, pp. 197-205. 
[37] 
R. D. MIDDLEBROOK, "Null Double Injection and the Extra Element Theorem," IEEE Transactions on 
Education, Vol. 32, No.3, pp. 167-180, August 1989. 
[38] 
D. TUTTLE, Network Synthesis, New York: John Wiley & Sons, Vol. 1, Chapter 6, 1958. 
PROBLEMS 
19.1 
Analysis of a half-bridge de-de parallel resonant converter, operated above resonance. In Fig. 19.53, 
the elements Ch, LF, and CF are large in value, and have negligible switching ripple. You may assume 
that all elements are ideal. You may use the sinusoidal approximation as appropriate. 
(b) 
v,(t) 
0 
0 
0.5T, 
Fig. 19.53 Half-bridge parallel resonant converter of Problem 19.1: (a) schematic, (b) switch voltage 
waveform. 
(a) 
Sketch the waveform of the current igCt). 
(b) 
Construct an equivalent circuit for this converter, similar to Fig. 19 .22, which models the funda-
mental components of the tank waveforms and the de components of the converter input current 
and output voltage. Clearly label the values and/or give expressions for all elements in your 
model, as appropriate. 
(c) 
Solve your model to derive an expression for the conversion ratio V/V8 = M(F, Qe, n). 
At rated (maximum) load, this converter produces I= 20 A at V = 3.3 V. 
(d) 
What is the converter switching frequency f, at rated load? 
(e) 
What is the magnitude of the peak transistor current at rated load? 
At minimum load, the converter produces I= 2 A at V = 3.3 V. 

756 
Resonant Conversion 
(f) 
What is the converter switching frequency J; at minimum load? 
(g) 
What is the magnitude of the peak transistor current at minimum load? Compare with your 
answer from part (e)-what happens to the conduction loss and efficiency at minimum load? 
19.2 
A de-de resonant converter contains an LCC tank network [Fig. 19.l(d)], with an output filter contain-
ing a filter inductor as in the parallel resonant de-de converter. 
(a) 
Sketch an equivalent circuit model for this converter, based on the approximate sinusoidal anal-
ysis method of Section 19 .1. Give expressions for all elements in your model. 
(b) 
Solve your model, to derive an expression for the conversion ratio M = V!Vg. Express Mas a 
function ofF= J;IL, Qe = R.fR0, and n = C/Cp, wherefoo is defined as in Eq. (19.50) and R0 is 
(c) 
Plot M vs. F, for n = 1 and Qe = 1, 2, and 5. 
(d) 
Plot M vs. F, for n = 0.25 and Qe = 1, 2, and 5. 
19.3 
Dual of the series resonant converter. In the converter illustrated in Fig. 19.54, LFl' Ln, and CF are large 
filter elements, whose switching ripples are small. Land Care tank elements, whose waveforms iL(t) and 
v c(t) are nearly sinusoidal. 
LFI 
Fig. 19.54 
Dual of the series resonant converter, Problem 19.3. 
(a) 
Using the sinusoidal approximation method, develop equivalent circuit models for the switch 
network, tank network, and rectifier network. 
(b) 
Sketch a Bode diagram of the parallel LC parallel tank impedance. 
(c) 
Solve your model. Find an analytical solution for the converter voltage conversion ratio 
M = V!Vg, as a function of the effective Qe and the normalized switching frequency F = J;/f0. 
Sketch M vs. F. 
(d) 
What can you say about the validity of the sinusoidal approximation for this converter? Which 

Problems 
757 
parts of your M vs. F plot of part (c) are valid and accurate? 
19.4 
The converter of Problem 19.3 operates below resonance. 
(a) 
Sketch the waveform v cU). For each subinterval, label: (i) which of the diodes D 1 to D 4 and tran-
sistors Q1 to Q4 conduct current, and (ii) which devices block voltage. 
(b) 
Does the reverse recovery process of diodes D1 to D4 lead to switching loss? Do the output 
capacitances of transistors Q1 to Q4 1ead to switching loss? 
(c) 
Repeat parts (a) and (b) for operation above resonance. 
19.5 
A parallel resonant converter operates with a de input voltage of V8 = 270 V. The converter supplies 5 V 
to a de load. The de load power varies over the range 20 W to 200 W. It is desired to operate the power 
transistors with zero voltage switching. The tank element values are L =57 ~-tH, CP = 0.9 nF, referred to 
the transformer primary. The parallel resonant tank network contains an isolation transformer having a 
turns ratio of 52: l. 
(a) 
Define F as in Eq. (19.19). Derive an expression for F, as a function of M and Qe. 
(b) 
Determine the switching frequency, peak transistor current, and peak tank capacitor voltage at 
the maximum load power operating point. 
(c) 
Determine the switching frequency, peak transistor current, and peak tank capacitor voltage at 
the minimum load power operating point. 
19.6 
In a certain resonant inverter application, the de input voltage is V8 = 320 V. The inverter must produce 
an approximately sinusoidal output voltage having a frequency of 200 kHz. Under no load (output open-
circuit) conditions, the inverter should produce a peak-to-peak output voltage of 1500 V. The nominal 
resistive operating point is 200 Vrms applied to 100 Q. A nonisolated LCC inverter is employed. It is 
desired that the inverter operate with zero-voltage switching, at least for load resistances less than 200 Q. 
(a) 
Derive expressions for the output open-circuit voltage Voc and short-circuit current l,c of the 
LCC inverter. Express your results as functions ofF= !,If~, V8 , R~ = UC,IICP and n = C,ICP. 
The open-circuit resonant frequency f~ is defined in Eq. (19.50). 
(b) 
To meet the given specifications, how should the short-circuit current l,c be chosen? 
(c) 
Specify tank element values that meet the specifications. 
(d) 
Under what conditions does your design operate with zero-voltage switching? 
(e) 
Compute the peak transistor current under no-load and short-circuit conditions. 
19.7 
A series resonant de-de converter operates with a de input voltage of V8 = 550 V. The converter supplies 
30 kV to a load. The de load power varies over the range 5 kW to 25 kW. It is desired to operate the 
power transistors with zero-voltage switching. The maximum feasible switching frequency is 50 kHz. 
An isolation transformer having a 1: n turns ratio is connected in series with the tank network. The peak 
tank capacitor voltage should be no greater than 2000 V, referred to the primary. 
(a) 
Derive expressions for the peak tank capacitor voltage and peak tank inductor current. 
(b) 
Select values for the tank inductance, tank capacitance, and turns ratio, such that the given spec-
ifications are met. Attempt to minimize the peak tank inductor current, while maximizing the 
worst-case minimum switching frequency. 
19.8 
Figure 19.55 illustrates a full-bridge resonant inverter containing an LLC tank network. 
(a) 
Sketch the Bode diagrams of the input impedance under short-circuit and open-circuit condi-
tions: II Z;o()w) II and II Z;=()w) 11. Give analytical expressions for the resonant frequencies and 
asymptotes. 
(b) 
Describe the conditions on switching frequency and load resistance that lead to zero-voltage 
switching. 
(c) 
Derive an expression for the frequency fm' where II Z;0 II= II Zi= 11. 

758 
Resonant Conversion 
~ 
Dl 
~ 
I 
+ 
vg 
+ 
R 
v 
~ 
D2 
~ 
Fig. 19.55 LLC inverter of Problem 19.8. 
(d) 
Sketch the Bode plot of II H~Uro) 11. Label the resonant frequency, and give analytical expres-
sions for the asymptotes. 
19.9 
You are given the LLC inverter circuit of Fig. 19.56. Under nominal conditions, this converter operates 
at switching frequency f.= 100kHz. All e1ements are ideal. 
~ 
Dl 
~ 
+ 
vg 
+ 
12 v 
v 
~ 
D2 
~ 
Fig. 19.56 Transformer-isolated LLC inverter, Problem 19.9. 
(a) 
Determine the numerical values of the open-circuit peak output voltage Voc and the short-circuit 
peak output current lsc· 
(b) 
Sketch the elliptical output characteristic. Over what portion of this ellipse does the converter 
operate with zero-voltage switching? Does it operate with zero-voltage switching at matched 
load? 
(c) 
Sketch the Bode plots of II Zi~ II and II ZiO 11. and label the numerical values off0.f~,f ... and f.. 
(d) 
What is the numerical value of the peak transistor current when R = 0? When R--+ oo? 
(e) 
The inverter operates with load resistances that can vary between 500 Q and an open circuit. 
What is the resulting range of output voltage? Does the inverter always operate with zero-volt-
age switching? 
19.10 
It is desired to obtain a converter with current source characteristics. Hence, a series resonant converter 
is designed for operation in the k = 2 discontinuous conduction mode. The switching frequency is chosen 
to be f.= 0.225/0, wheref0 is the tank resonant frequency (consider only open-loop operation). The load 
R is a linear resistance which can assume any positive value: 0 :>: R < oo, 
(a) 
Plot the output characteristics (M vs. 1), for all values of R in the range 0 :>: R < oo. Label mode 
boundaries, evaluate the short-circuit current, and give analytical expressions for the output 
characteristics. 

19.11 
Problems 
159 
(b) 
Over what range of R (referred to the tank characteristic impedance R0) does the converter oper-
ate as intended, in the k = 2 discontinuous conduction mode? 
The parallel resonant converter as a single-phase high-quality rectifier. It is desired to utilize a trans-
former-isolated parallel resonant de-de converter in a single-phase low-harmonic rectifier system. By 
properly varying the converter switching frequency, a near-ideal rectifier system that can be modeled as 
in Fig. 18.12 is obtained. You may utilize the results of Section 19.5.2 to answer this problem. The paral-
lel resonant tank network contains an isolation transformer having a 1: n turns ratio. You may use either 
approximate graphical analysis or computer iteration to answer parts (b) and (c). 
(a) 
Plot the normalized input characteristics (normalized input voltage mg = nvglv vs. normalized 
input currentjg = ignR0/v) of the parallel resonant converter, operated in the continuous conduc-
tion mode above resonance. Plot curves for F = f/fo = 1.0, 1.1, 1.2, 1.3, 1.5, and 2.0. Compare 
these characteristics with the desired linear resistive input characteristic v /ig = Remulated. 
(b) 
The converter is operated open-loop, with F = 1.1. The applied normalized input voltage is a rec-
tified sinusoid of unity magnitude: m/t) =I sin (wt) 1. Sketch the resulting normalized input cur-
rent waveformjg(t). Approximately how large is the peak current? The crossover dead time? 
(c) 
A feedback loop is now added, which regulates the input current to follow the input voltage such 
that i/t) = v/t)/Remutared' You may assume that the feedback loop operates perfectly. For the case 
Remulared = R0, and with the same applied mg(t) waveform as in part (b), sketch the switching fre-
quency waveform for one ac line period [i.e., show how the controller must vary F to regulate 
i/t)]. What is the maximum value ofF? Note: In practice, the converter would be designed to 
operate with a smaller peak value ofjg, so that the switching frequency variations would be bet-
ter behaved. 
(d) 
Choose element values (tank inductance, tank capacitance, and transformer turns ratio) such tbat 
the converter of part (c) meets the following specifications: 
Ac input voltage 
120 Vrms, 60Hz 
De output voltage 
42 V 
Average power 
Maximum switching frequency 
soow 
200kHz 
Refer the element values to the primary side of the transformer. 

20 
Soft Switching 
In addition to the resonant circuits introduced in Chapter 19, there has been much interest in reducing the 
switching loss of the PWM converters of the previous chapters. Several of the more popular approaches 
to obtaining soft switching in buck, boost, and other converters, are discussed in this chapter. 
Mechanisms that cause switching loss are discussed in Chapter 4, including diode reverse 
recovery, semiconductor output capacitances, and IGBT current tailing. Soft switching involves mitiga-
tion of one or more of these switching loss mechanisms in a PWM converter. The energy that would oth-
erwise be lost is recovered, and is transferred to the converter source or load. The operation of a 
semiconductor device, during a given tum-on or tum-off switching transition, can be classified as hard-
switched, zero-current switched, or zero-voltage switched. Operation of diodes and transistors with soft 
switching is examined in Section 20.1. In particular, it is preferable to operate diodes with zero-voltage 
switching at their tum-off transitions, and to operate MOSFETs with zero-voltage switching during their 
tum-on transitions. However, zero-voltage switching comes at the expense of increased conduction loss, 
and so the engineer must consider the effect of soft switching on the overall converter efficiency. 
Resonant switch converters are a broad class of converters in which the PWM switch network of 
a conventional buck, boost, or other converter is replaced with a switch cell containing resonant ele-
ments. These resonant elements are positioned such that the semiconductor devices operate with zero-
current or zero-voltage switching, and such that one or more of the switching loss mechanisms is reduced 
or eliminated. Other soft-switching approaches may employ resonant switching transitions, but other-
wise exhibit the approximately rectangular waveforms of hard-switched converters. In any case, the 
resulting hybrid converter combines the properties of the resonant switching network and the parent 
hard-switched PWM converter. 
Soft-switching converters can exhibit reduced switching loss, at the expense of increased con-
duction loss. Obtaining zero-voltage or zero-current switching requires that the resonant elements have 
large ripple; often, these elements are operated in a manner similar to the discontinuous conduction 

762 
Soft Switching 
modes of the series or parallel resonant converters. As in other resonant schemes, the objectives of 
designing such a converter are: (1) to obtain smaller transformer and low-pass filter elements via increase 
of the switching frequency, and/or (2) to reduce the switching loss induced by component nonidealities 
such as diode stored charge, semiconductor device capacitances, and transformer leakage inductance and 
winding capacitance. 
The resonant switch and soft-switching ideas are quite general, and can be applied to a variety 
of topologies and applications. A large number of resonant switch networks have been documented in the 
literature; a few basic approaches are listed here [1-24]. The basic zero-current-switching quasi-resonant 
switch network is analyzed in detail in Section 20.2. Expressions for the average components of the 
switch network terminal waveforms are found, leading to determination of the switch conversion ratio /).. 
The switch conversion ratio /l performs the role of the duty cycle d of CCM PWM switch networks. For 
example, the buck converter exhibits conversion ratio M equal to /).. Both half-wave and full-wave ring-
ing of the tank network is considered; these lead to different switch conversion ratio functions ll· In gen-
eral, given a PWM CCM converter having conversion ratio M(d), we can replace the PWM switch 
network with a resonant switch network having switch conversion ratio ll· The resulting quasi-resonant 
converter will then have conversion ratio M(/).). So we can obtain soft-switching versions of all of the 
basic converters (buck, boost, buck-boost, forward, flyback, etc.), that exhibit zero-voltage or zero-cur-
rent switching and other desirable properties. 
In Section 20.3, the characteristics of several other resonant switch networks are listed: the 
zero-voltage-switching quasi-resonant switch network, the zero-current-switching and zero-voltage-
switching quasi-square-wave networks, and the multiresonant switch network. One can obtain zero-volt-
age switching in all transistors and diodes using these networks. 
Several related soft-switching approaches are now popular, which attain zero-voltage switching 
of the transistor or transistors in commonly-used converters. The zero-voltage transition approach finds 
application in full-bridge buck-derived converters. Active-clamp snubbers are often added to forward and 
fiyback converters, to attain zero-voltage switching and to reset the transformer. These circuits lead to 
zero-voltage switching of the transistors, but (less-than-optimal) zero-current switching of the second-
ary-side diodes. Nonetheless, high efficiency can be achieved. An auxiliary resonant-commutated pole 
can achieve zero-voltage switching in voltage-source inverters. These converters are briefly discussed in 
Section 20.4. 
20.1 
SOFT -SWITCIITNG MECHANISMS 
OF SEMICONDUCTOR DEVICES 
When loosely used, the terms "zero-current switching" and "zero-voltage switching" normally refer to 
one or more switching transitions of the transistor in a converter. However, to fully understand how a 
converter generates switching loss, one must closely examine the switching transitions of every semicon-
ductor device. As described in Section 4.3, there are typically several mechanisms that are sources of sig-
nificant switching loss. At the tum-off transition of a diode, its reverse-recovery process can induce loss 
in the transistor or other elements of the converter. The energy stored in the output capacitance of a 
MOSFET can be lost when the MOSFET turns on. IGBTs can lose significant energy during their tum-
off transition, owing to the current-tailing phenomenon. The effects of zero-current switching and zero-
voltage switching on each of these devices is discussed in detail below. 

20.1 
Soft-Switching Mechanisms of Semiconductor Devices 
763 
(a) 
I 
Silicon 
vg 
v(t) 
diode 
+ 
i(t) 
Fig. 20.1 Hard switching at the turn-off transition of a 
diode, conventional buck converter example: (a) schematic, 
(b) diode voltage and current waveforms. 
20.1.1 
Diode Switching 
(b) 
i(t) 
I 
0 
Area 
Qr 
v(t) 
0 
As discussed in Chapter 4, the reverse-recovery process usually leads to significant switching loss associ-
ated with the tum-off transition of diodes. This is often the largest single source of loss in a hard-
switched converter. Normally, negligible loss is associated with the tum-on transition of power diodes. 
Three types of diode turn-off transition waveforms are commonly encountered in modem switching con-
verters: hard switching, zero-current switching, and zero-voltage switching. 
Figure 20.1 illustrates a conventional hard-switched PWM buck converter. The diode voltage 
and current waveforms v(t) and i(t) are also illustrated, with an exaggerated reverse recovery time. The 
output inductor current ripple is small. The diode turns off when the transistor is turned on; the reverse 
recovery process leads to a negative peak current of large amplitude. The diode must immediately sup-
port the full reverse voltage Vg, and hence both v(t) and i(t) must change with large slopes during reverse 
recovery. As described in Section 4.3.2, hard switching of the diode induces energy loss W0 in the tran-
sistor, given approximately by 
(20.1) 
where Qr is the diode recovered charge and tr is the reverse recovery time, both taken to be positive quan-
tities. The recovered charge is relatively large because the slope dildt is large during the turn-off transi-
tion. The resonant circuit formed by the diode output capacitance Cj and the diode package and other 
wiring inductances leads to ringing at the end of the reverse recovery time. 
Figure 20.2 illustrates zero-current switching at the turn-off transition of a diode. The converter 
example is a quasi-resonant zero-voltage switching buck converter (see Section 20.3.1). The output 
inductor current ripple is again small. However, tank inductor Lr is now connected in series with the 
diode. The resulting diode current waveform i(t) changes with a limited slope as shown. The diode 
reverse-recovery process commences when i(t) passes through zero and becomes negative. The negative 
i(t) actively removes stored charge from the diode; during this reverse recovery time, the diode remains 
forward-biased. When the stored charge is removed, then the diode voltage must rapidly change to- V8• 
As described in Section 4.3.3, energy W 0 is stored in inductor Lr at the end of the reverse recovery time, 
given by 

764 
Soft Switching 
(a) 
(b) 
i(t) 
0 
vg 
Area 
Q, 
v(t) 
0 
Fig. 20.2 Zero-current switching at the turn-off transition of a diode, ZVS quasi-resonant buck converter example: 
(a) converter schematic, (b) diode voltage and current waveforms. 
(20.2) 
The resonant circuit formed by L, and the diode output capacitance c1 then cause this energy to be circu-
lated between L, and c1. This energy is eventually dissipated by parasitic resistive elements in the circuit, 
and hence is lost. Since Eqs. (20.1) and (20.2) are similar in form, the switching losses induced by the 
reverse-recovery processes of diodes operating with hard switching and with zero-current switching are 
similar in magnitude. Zero-current switching may lead to somewhat lower loss because the reduced di/dt 
leads to less recovered charge Q,. Zero-current switching of diodes also typically leads to increased peak 
inverse diode voltage during the ringing of L, and c1, because of the relatively large value of L,. 
When a diode operates with hard switching or zero-current switching, and when substantial 
inductance is present in series with the diode, then significant ringing is observed in the diode voltage 
waveform. A resonant circuit, comprised of the series inductance and the diode output capacitance, is 
excited by the diode reverse recovery process, and the resulting ringing voltage can be of large enough 
magnitude to lead to breakdown and failure of the diode. A common example is the diodes on the sec-
ondary side of a hard-switched transformer-isolated converter; the resonant circuit is then formed by the 
transformer leakage inductance and the diode output capacitance. Other examples are the circuits of 
Figs. 20.2 and 20.36, in which the series inductance is a discrete tank inductor. 
A simple snubber circuit that is often used to protect the diode from excessive reverse voltage is 
Fig. 20.3 A dissipative snubber circuit, for protec-
tion of a diode from excessive voltage caused by 
ringing. 
Tank 
circuit 

20.1 
Soft-Switching Mechanisms of Semiconductor Devices 
765 
(a) 
i,(t) 
i(t) 
L,. 
vg 
cr 
+ 
Fig. 20.4 Zero-voltage switching 
at the turn-off transition of a diode, 
(b) 
i(t) 
ZVS quasi-squarewave buck con-
verter example: (a) converter sche-
matic, (b) diode current and voltage 
waveforms. 
Area 
0 
Qr 
0 
illustrated in Fig. 20.3. Resistor R damps the ringing of the resonant circuit. Capacitor C prevents the 
off-state voltage of the diode from causing excessive power loss in R. Nonetheless, the energy consumed 
by R per switching period is typically greater than Eqs. (20.1) or (20.2). 
Figure 20.4 illustrates zero-voltage switching at the tum-off transition of a diode. The figure 
illustrates the example of a zero-voltage switching quasi-square wave buck converter, discussed in Sec-
tion 20.3.3. The output inductor Lr of this converter assumes the role of the tank inductor, and exhibits 
large current ripple that causes the current i,(t) to reverse polarity. While the diode conducts, its current 
i(t) is equal to ir(t). When i,(t) becomes negative, the diode continues to conduct until its stored charge Qr 
has been removed. The diode then becomes reverse-biased, and ir(t) flows through capacitor Cr and the 
diode output capacitance Cj. The diode voltage and current both change with limited slope in this type of 
switching, and the loss induced by the diode reverse-recovery process is negligible because the wave-
forms are not significantly damped by parasitic resistances in the circuit, and because the peak currents 
during reverse recovery are relatively low. The diode stored charge and diode output capacitance both 
behave as an effective nonlinear capacitor that can be combined with (or replace) tank capacitor Cr. 
Snubber circuits such as Fig. 20.3 are not necessary when the diode operates with zero-voltage switch-
ing. 
Thus, zero-voltage switching at the turn-off transition of a diode is the preferred approach, that 
leads to minimum switching loss. Zero-current switching at the tum-off transition can be problematic, 
because of the high peak inverse voltage induced across the diode by ringing. 
20.1.2 
MOSFET Switching 
The switching loss mechanisms typically encountered by a MOSFET in a hard-switched converter are 
discussed in Chapter 4, and typical MOSFET voltage and current waveforms are illustrated in Fig. 20.5. 
The most significant components of switching loss in the MOSFET of this circuit are: (1) the loss 

766 
Soft Switching 
(a) 
+ v(t) 
-
I 
Silicon 
diode 
(b) 
i(t) 
0 
I 0 r. 
induced by the diode reverse recovery process, and (2) the loss of the energy stored in the MOSFET out-
put capacitance Cds' Both loss mechanisms occur during the MOSFET tum-on process. 
In the hard-switched circuit of Fig. 20.5, there is essentially no switching loss incurred during 
the MOSFET tum-off transition. This occurs because of the substantial output capacitance Cds of the 
MOSFET. This capacitance holds the voltage v(t) close to zero while the MOSFET turns off, so that the 
tum-off switching loss is very small. After the MOSFET has turned off, the output inductor current I 
flows through Cds. The voltage v(t) then increases until v = Vg and the diode becomes forward biased. 
However, when the MOSFET turns on, a high peak current flows through the MOSFET chan-
nel, induced by the diode reverse recovery and by the output capacitances of the MOSFET and diode. 
This leads to substantial energy loss during the hard-switched tum-on transition of the MOSFET. 
When a MOSFET (or other transistor) operates with hard switching, and when substantial 
inductance is present in series with the MOSFET, then significant ringing is observed in the MOSFET 
voltage waveform. A resonant circuit, composed of the MOSFET output capacitance and the series 
inductance, is excited when the MOSFET turns off, and the resulting ringing voltage can be of large 
enough magnitude to lead to breakdown and failure of the MOSFET. A common example is the MOS-
+ 
-----, 
Csl 
+ 
I I 
n, I 
Rs 
!Snubber 
I circuit 
~--------------------------1 
-I 
Fig. 20.6 Insertion of a dissipative voltage-clamped snubber circuit into a flyback converter. The MOSFET volt-
age is clamped to a peak value of (V8 + v,). 

20.1 
Soft-Switching Mechanisms of Semiconductor Devices 
767 
FET of the flyback converter, in which series inductance is introduced by the transformer leakage induc-
tance. An R-C snubber circuit, similar to that used for the diode in Fig. 20.3, can be used to protect the 
MOSFET from damage caused by excessive applied voltage. Another common snubber circuit is illus-
trated in Fig. 20.6. When the MOSFET turns off, the current flowing in the transformer leakage induc-
tance Le begins to flow into the MOSFET capacitance Cds· These parasitic elements then ring, and the 
peak transistor voltage can significantly exceed the ideal value of (DID')Vg. 
One simple way to design the snubber circuit of Fig. 20.6 is to choose the capacitance Cs to be 
large, so that v/t) "' Vs contains negligible switching ripple. The resistance Rs is then chosen so that the 
power consumption of Rs at the desired voltage Vs is equal to the switching loss caused by Le: 
(20.3) 
The current i is equal to the current flowing in the transformer primary just before the MOSFET is turned 
off. This approximate expression is useful for obtaining a first estimate of how to chooseRs to obtain a 
given desired Vs. 
Zero-current switching does not affect the switching loss that arises from the MOSFET output 
capacitance, and it may or may not influence the loss induced by diode reverse recovery. In consequence, 
zero-current switching is of little or no help in improving the efficiency of converters that employ MOS-
FETs. 
Zero-voltage switching can prevent both diode reverse recovery and semiconductor output 
capacitances from inducing switching loss in MOSFETs. An example is illustrated in Fig. 20.7. This cir-
cuit is again a zero-voltage switching quasi-squarewave example, discussed in Section 20.3.3. The con-
verter circuit naturally discharges the energy stored in Cds' before the MOSFET is switched on. When the 
drain-to-source voltage v(t) passes through zero, the MOSFET body diode becomes forward-biased. The 
MOSFET can then be turned on at zero voltage, without incurring turn-on switching loss. The MOSFET 
tum-on transition must be completed before the tank inductor current i,(t) becomes positive. The MOS-
FET tum-off transition is also lossless, and is similar to the hard-switched case discussed above. 
Zero-voltage switching of a MOSFET also causes its body diode to operate with zero-voltage 
switching. This can eliminate the switching loss associated with reverse recovery of the slow body diode, 
and improve the reliability of circuits that forward-bias this diode. 
(a) 
+ v(t) 
-
(b) 
i(t) 
Fig. 20.7 
Zero-voltage switching of a MOSFET, ZVS quasi-squarewave buck converter example. The MOSFET, 
its body diode, and its output capacitance Cds are illustrated. (a) converter schematic, (b) MOSFET voltage and cur-
rent waveforms. 

768 
Soft Switching 
Zero-voltage switching can also eliminate the overvoltage problems associated with trans-
former leakage inductances, removing the need for voltage-clamped snubber circuits such as in 
Fig. 20.6. An example is discussed in Section 20.4.2. 
20.1.3 
IGBT Switching 
Like the MOSFET, the IGBT typically encounters substantial switching loss during its tum-on transition, 
induced by the reverse-recovery process of diodes within the converter. In addition, the IGBT exhibits 
significant switching loss during its tum-off transition, caused by the current tailing phenomenon (see 
Chapter4). 
Zero-voltage switching has been successfully applied to IGBT circuits-an example is the aux-
iliary resonant commutation circuit discussed in Section 20.4.3. This has the principal advantage of elim-
inating the switching loss caused by diode reverse recovery. Although zero-voltage switching can reduce 
the loss incurred during the tum-off transition, it is difficult to eliminate the substantial loss caused by 
current tailing. 
20.2 
THE ZERO-CURRENT SWITCHING QUASI-RESONANT SWITCH CELL 
Figure 20.8(a) illustrates a generic buck converter, consisting of a switch cell cascaded by an L-C low-
pass filter. When the switch cell is realized as in Fig. 20.8(b), then a conventional PWM buck converter 
is obtained. Figures 20.8(b) and (c) illustrate two other possible realizations of the switch cell: the half-
wave and full-wave zero-current-switching quasi-resonant switches [1, 2]. In these switch cells, a reso-
nant tank capacitor Cr is placed in parallel with diode D2, while resonant tank capacitor Lr is placed in 
series with the active transistor element. 
Both resonant switch cells require a two-quadrant SPST switch. In the half-wave switch cell of 
Fig. 20.8(c), diode D 1 is added in series with transistor Q1• This causes the QcD1 SPST switch to tum 
off at the first zero crossing of the tank inductor current i1 (t). In the full-wave switch cell of Fig. 20.8( d), 
antiparallel diode D 1 allows bidirectional flow of the tank inductor current i1(t). With this switch net-
work, the Q1-D1 SPST switch is normally turned off at the second zero-crossing of the i1(t) waveform. In 
either switch cell, the Lr and Cr elements are relatively small in value, such that their resonant frequency 
fo is greater than the switching frequency f., where 
(20.4) 
In the analysis which follows, it is assumed that the converter filter element values Land C have 
negligible switching ripple. Hence, the switch cell terminal waveforms v1(t) and i2(t) are well-approxi-
mated by their average values: 
(20.5) 
with the average defined as in Eq. (7.3). In steady-state, we can further approximate v1(t) and i2(t) by 
their de components V1 and 12: 

(a) 
(b) 
(c) 
(d) 
20.2 
The Zero-Current Switching Quasi-Resonant Switch Cell 
769 
Switch 
cell 
T 
+ 
t ....................................... } 
Switch network 
L 
i(t) 
c 
v2(t) 
cr 
·------------------------------------···----· 
---····----··············-········--·······--···································· 
R 
v2(t) 
1 
.... -------............................ ___ 1 i2/t) 
I iz(t) 
+ 
Switch network 
---------------------···-------------------
+ 
v(t) 
Fig. 20.8 
Implementation of the switch cell in a buck converter: (a) buck converter, with arbitrary switch cell; 
(b) PWM switch cell; (c) half-wave ZCS quasi-resonant switch cell; (d) full-wave ZCS quasi-resonant switch cell. 

770 
Soft Switching 
:····-·························-----····------·----·-·······················-················-······: 
;····································-----·; 
. 
. 
'DI 
QI 
' iz/0 
+ 
; _______ §.~!t.c_~--'!:~~?_!~------' 
! .... f!C!:!f.":!.C!:.~_e._z:.c;_~_qz:_{_I:S.i_~!:e.S.?..'!:C!:!!.t __ ~"'!it_~-~-~-e-~1 
Fig. 20.9 The half-wave ZCS quasi-resonant switch cell, driven by the terminal quantities (vi (t) )r,. and (iz(t))Ts" 
iz(t)=elz 
vi(t)"' VI 
Thus, the small-ripple approximation is employed for the converter filter elements, as usual. 
(20.6) 
To understand the operation of the half-wave ZCS quasi-resonant switch cell, we can solve the 
simplified circuit illustrated in Fig. 20.9. In accordance with the averaged switch modeling approach of 
Sections 7.4 and 11.1, it is desired to determine the average terminal waveforms (v2(t))Ts and (i1(t))Ts' as 
functions of the applied quantities ( v 1 (t) >rs and ( iz(t) )Ts" The switch conversion ratio 11 is then given by 
(20.7) 
In steady state, we can write 
(20.8) 
The steady-state analysis of this section employs Eq. (20.8) to determine 11· 
20.2.1 
Waveforms of the Half-Wave ZCS Quasi-Resonant Switch Cell 
Typical waveforms of the half-wave cell of Fig. 20.9 are illustrated in Fig. 20.10. Each switching period 
consists of four subintervals as shown, having angular lengths a, 0, 8, and 1;. The switching period begins 
when the controller turns on transistor Q1. The initial values of the tank inductor current i1(t) and tank 
capacitor voltage v2(t) are zero. During subinterval 1, all three semiconductor devices conduct. Diode D2 
is forward-biased because i1 (t) is less than / 2. In consequence, during subinterval 1 the switch cell 
reduces to the circuit of Fig. 20.11. 
The slope of the inductor current is given by 
(20.9) 

20.2 
The Zero-Current Switching Quasi-Resonant Switch Cell 
771 
l,(:b 
Subinterval: 
1 ; 
2 
; 3 
4 
Fig. 20.10 Tank inductor current and capacitor 
voltage waveforms, for the half-wave ZCS quasi-res-
onant switch of Fig. 20.9. 
vz(t) ]I !v) l, 
. LJ~r 
with the initial condition i 1 (0) = 0. The solution is 
Conducting 
devices: 
where the tank characteristic impedance R0 is defined as 
R- (T; 
o-y C, 
i a ' 
P 
' 8 ' 
~ 
!-! 
i-i----'-• 
i : 
woT, ----+ 
X 
1. 
e = (J)ot 
(20.10) 
(20.11) 
It is convenient to express the waveforms in terms of the angle 8 = uv, instead of time t. At the end of 
subinterval 1, u:Jof =a. The subinterval ends when diode D2 becomes reverse-biased. Since the diode D2 
current is equal to 12 - i 1(t), this occurs when i 1(t) = 12 . Hence, we can write 
(20.12) 
Solution for a yields 
(20.13) 
Fig. 20.11 
Circuit of the switch network during subinterval 1. 

772 
Soft Switching 
+ 
Fig. 20.12 
Circuit of the switch network during 
subinterval 2. 
V1 
During subinterval2, transistor Q1 and diode D1 conduct, while diode D2 is reverse-biased. The 
switch network then becomes the circuit illustrated in Fig. 20.12. The resonant L,-C, tank network is 
excited by the constant sources V1 and /2. The network equations are 
with the initial conditions 
The solution is 
L di 1(w0t)_v 
( 
) 
r 
d t 
-
I - Vz Wot 
C dv2(uJof) _. ( 
) -I 
r 
dt 
-II Wot 
2 
v2(a)=0 
i 1(a)=I2 
i/W0t) = I 2 + ~1 sin (w0t- a) 
0 
vz(w0t) = V1 ( 1- cos (w0t- a)) 
The tank inductor current rises to a peak value given by 
(20.14) 
(20.15) 
(20.16) 
(20.17) 
The subinterval ends at the first zero crossing of i 1(t). If we denote the angular length of the subinterval 
as (3, then we can write 
(20.18) 
Solution for sin ((3) yields 
sin ((3) =- I ~Ro 
I 
(20.19) 
Care must be employed when solving Eq. (20.19) for the angle (3. It can be observed from Fig. 20.10 
that the angle f3 is greater than n. The correct branch of the arcsine function must be selected, as follows: 
(20.20) 

20.2 
The Zero-Current Switching Quasi-Resonant Switch Cell 
773 
+ 
Fig. 20.13 Circuit of the switch network during subinterval3. 
cr 
where 
Note that the inequality 
(20.21) 
must be satisfied; otherwise, there is no solution to Eq. (20.19). At excessive load currents, where Eq. 
(20.21) is not satisfied, the tank inductor current never reaches zero, and the transistor does not switch off 
at zero current. 
The tank capacitor voltage at the end of subinterval 2 is found by evaluation of Eq. (20.16) at 
Olaf= (a + ~). The cos (~) term can be expressed as 
1-(~tr~of 
(20.22) 
Substitution ofEq. (20.22) into Eq. (20.16) leads to 
1- ( IV~o r) 
(20.23) 
At the end of subinterval 2, diode D1 becomes reverse-biased. Transistor Q1 can then be switched off at 
zero current. 
During subinterval 3, all semiconductor devices are off, and the switch cell reduces to the cir-
cuit of Fig. 20.13. The tank capacitor C, is discharged by the filter inductor current 12• Hence, the tank 
capacitor voltage v2 decreases linearly to zero. The circuit equations are 
C dvz(OJo!) =-I 
r 
dt 
2 
(20.24) 
v2(CX +~)=Vel 
The solution is 
(20.25) 
Subinterval 3 ends when the tank capacitor voltage reaches zero. Diode D2 then becomes forward-biased. 
Hence, we can write 
(20.26) 

774 
Soft Switching 
where o is the angular length of subinterval 3. Solution foro yields 
l-( I~o r) 
(20.27) 
Subinterval 4. of angular length~. is identical to the diode conduction subinterval of the con-
ventional PWM switch network. Diode D2 conducts the filter inductor current / 2 , and the tank capacitor 
voltage v2 is equal to zero. Transistor Q1 is off, and the input current i 1 is equal to zero. 
where 
The angular length of the switching period is 
A 
~ 
" 
2nfo 
2n 
w0T, =a+ 1-' + u +., = T = F 
F=t_ 
fo 
(20.28) 
(20.29) 
Quasi-resonant switch networks are usually controlled by variation of the switching frequency fs or, in 
normalized terms, by variation of F. Note that the interval lengths a., ~. and o are determined by the 
response of the tank network. Hence, control of the switching frequency is equivalent to control of the 
fourth subinterval length~· The subinterval length~ must be positive, and hence, the minimum switch-
ing period is limited as follows: 
(20.30) 
Substitution of Eqs. (20.13), (20.20), and (20.27) into Eq. (20.30) yields 
2 
I R 
. 
(I R ) 
V ( 
_11:2 _1_Q + 7t +Sin-! _1_Q + -
1-
1-
F 
vl 
VI 
IzRo 
1- ( /t~o r) 
(20.31) 
This expression limits the maximum switching frequency, or maximum F, of the half-wave ZCS quasi-
resonant switch cell. 
20.2.2 
The Average Terminal Waveforms 
It is now desired to solve for the power processing function performed by the switch network. The switch 
conversion ratio Jl is a generalization of the duty cycle d. It expresses how a resonant switch network 
controls the average voltages and currents of a converter. In our buck converter example, we can define Jl 
as the ratio of (v2(t))1; to (v1(t))Ts, or equivalently, the ratio of (i1(t)\; to (i2(t))Ts" In a hard-switched 
PWM network, this ratio is equal to the duty cycle d. Hence, analytical results derived for hard-switched 
PWM converters can be adapted to quasi-resonant converters, simply by replacing d with Jl. In this sec-
tion, we derive an expression for Jl, by averaging the terminal waveforms of the switch network. 
The switch input current waveform i1 (t) of Fig. 20.10 is reproduced in Fig. 20.14. The average 
switch input current is given by 

20.2 The Zero-Current Switching Quasi-Resonant Switch Cell 
775 
Fig. 20.14 
Input current waveform i1(t), and the areas q1 and 
q2 during subintervals 1 and 2 respectively. 
(20.32) 
The charge quantities q1 and q2 are the areas under the i1(t) waveform during the first and second sub-
intervals, respectively. The charge q 1 is given by the triangle area formula 
(20.33) 
The time a./ro0 is the length of subinterval 1. The charge q2 is 
(20.34) 
According to Fig. 20.12, during subinterval2 the current i1(t) can be related to the tank capacitor current 
ic(t) and the switch output current /2 by the node equation 
(20.35) 
Substitution of Eq. (20.35) into Eq. (20.34) leads to 
(20.36) 
Both integrals in Eq. (20.36) can easily be evaluated, as follows. Since the second term involves the inte-
gral of the constant current /2, this term is 
(20.37) 
The first term in Eq. (20.36) involves the integral of the capacitor current over subinterval 2. Hence, this 
term is equal to the change in capacitor charge over the second subinterval: 
(20.38) 

776 
Soft Switching 
(recall that !!q = C!!v in a capacitor). During the second subinterval, the tank capacitor voltage is initially 
zero, and has a final value of Vel. Hence, Eq. (20.38) reduces to 
(l+~ 
J_:o ic(t)dt = c (vel - o) = CVc1 
(1)0 
(20.39) 
Substitution of Eqs. (20.37) and (20.39) into Eq. (20.36) leads to the following expression for q2: 
(20.40) 
Equations (20.33) and (20.40) can now be inserted into Eq. (20.32), to obtain the following expression 
for the switch input current: 
(20.41) 
Substitution of Eq. (20.41) into (20.8) leads to the following expression for the switch conver-
sion ratio: 
(20.42) 
Finally, the quantities a, ~. and Vel can be eliminated, using Eqs. (20.13), (20.20), (20.23). The result is 
fl = F 2~ [-!- 1., + 1t + sin- 1(1.) + * ( 
1 + .j 1-1;}] 
(2Q.43) 
where 
(20.44) 
Equation (20.43) is of the form 
(20.45) 
where 
(20.46) 
Thus, the switch conversion ratio Jl is directly controllable by variation of the switching frequency, 
through F. The switch conversion ratio is also a function of the applied terminal voltage V1 and current /2, 
via ]8 • The function P~(J.) is sketched in Fig. 20.15. The switch conversion ratio J.1. is sketched in 
Fig. 20.16, for various values ofF and ]8 • These characteristics are similar in shape to the function 
P(J.), and are simply scaled by the factor F. It can be seen that the conversion ratio J.l. is a strong function 

20.2 
1he Zero-Current Switching Quasi-Resonant Switch Cell 
777 
10 
8 
6 
Fig. 20.15 
The function P~ (J,.). 
4 
2 
0 
0 
0.2 
0.4 
0.6 
0.8 
ZCS boundary 
0.8 
0.6 
Fig. 20.16 
Characteristics of the half-
wave ZCS quasi-resonant switch. 
1,. 
0.4 
0.2 
0 
0 
0.2 
0.4 
0.6 
0.8 
of the current 12 , via Js. The characteristics end at Js = 1; according to Eq. (20.31), the zero current 
switching property is lost when 1,. > 1. The characteristics also end at the maximum switching frequency 
limit given by Eq. (20.31). This expression can be simplified by use of Eq. (20.43), to express the limit in 
terms of 11 as follows: 

778 
Soft Switching 
II< J- JsF 
r-
4n 
The switch conversion ratio p. is thus limited to a value slightly less than 1. 
(20.47) 
The averaged waveforms of converters containing half-wave ZCS quasi-resonant switches can 
now be determined. The results of the analysis of PWM converters operating in the continuous conduc-
tion mode can be directly adapted to the related quasi-resonant converters, simply by replacing the duty 
cycle d with the switch conversion ratio p.. For the buck converter example, the conversion ratio is 
(20.48) 
This result could also be derived by use of the principle of inductor volt-second balance. The average 
voltage across the filter inductor is (p.Vg- V). Upon equating this voltage to zero, we obtain Eq. (20.48). 
In the buck converter, 12 is equal to the load current /, while V1 is equal to the converter input 
voltage Vg. Hence, the quantity Js is 
Zero current switching occurs for 
The output voltage can vary over the range 
v 
I<____§_ 
- Ro 
(20.49) 
(20.50) 
0 < V< V _ FIRo 
(20.51) 
-
-
g 
4n 
which nearly coincides with the PWM output voltage range 0::::; V::::; Vg. 
A boost converter employing a half-wave ZCS quasi-resonant switch is illustrated in 
Fig. 20.17. The conversion ratio of the boost converter is given by 
Fig. 20.17 
Boost converter containing 
a half-wave ZCS quasi-resonant switch. 
c 
+ 
R 
V 

20.2 
The Zero-Current Switching Quasi-Resonant Switch Cell 
779 
The half-wave switch conversion ratio JL is again given by Eqs. (20.44) to (20.46). For the boost con-
verter, the applied switch voltage V1 is equal to the output voltage V, while the applied switch current /2 is 
equal to the filter inductor current, or 18• Hence, the quantity Js is 
Also, the input current Ig of the boost converter is related to the load current I according to 
I=~/_ 
g 
1-!-1 
(20.53) 
(20.54) 
Equations (20.52) to (20.54), in conjunction with Eqs. (20.44) to (20.46), describe the averaged wave-
forms of the half-wave quasi-resonant ZCS boost converter. 
20.2.3 
The Full-Wave ZCS Quasi-Resonant Switch Cell 
The full-wave ZCS quasi-resonant switch cell is illustrated in Fig. 20.8(d). It differs from the half-wave 
cell in that elements D 1 and Q1 are connected in antiparallel, to form a current-bidirectional two-quadrant 
switch. Typical tank inductor current and tank capacitor voltage waveforms are illustrated in Fig. 20.18. 
These waveforms are similar to those of the half-wave case, except that the Q1/D1 switch interrupts the 
tank inductor current i1(t) at its second zero-crossing. While i1(t) is negative, diode D1 conducts, and 
transistor Q 1 can be turned off at zero current. 
The analysis is nearly the same as for the half-wave case, with the exception of subinterval 2. 
The subinterval 2 angular length ~ and final voltage Vel can be shown to be 
_ f n + sin- 1 (Is) 
(half wave) 
B- \ 2n-sin- 1 (1,) 
(full wave) 
Fig. 20.18 Tank inductor current and capacitor 
voltage waveforms, for the full-wave ZCS quasi-
resonant switch cell of Fig. 20.8(d). 
Subinterval: 
Conducting 
Q 1 
devices: 
Dz 
(20.55) 

780 
Soft Switching 
Fig. 20.19 Characteristics of the 
full-wave ZCS quasi-resonant switch. 
0.8 
F=0.2 
0.6 
0.4 
0.2 
ZCS boundary 
0.4 
0.6 
0.8 
0 ,_-----T------+------+------r-----~ 
0 
0.2 
0.4 
0.6 
0.8 
V,={v,(1+V1-1;) 
(halfwave) 
c 
V1 ( 1-J 1 - 1;) 
(full wave) 
(20.56) 
In either case, the switch conversion ratio Jl is given by Eq. (20.42). For the full-wave switch, one obtains 
(20.57) 
where P1(Js) is given by 
(20.58) 
In the full-wave case, P 1 (Is) is essentially independent of Js: 
(20.59) 
The worst-case deviation of P 1(Js) from 1 occurs as Js tends to 1, where P1(Js) tends to 0.96. So P1(Js) 
lies within 4% of unity for 0 < Js < 1. Hence, for the full-wave case, it is a good approximation to express 
the switch conversion ratio as 
(20.60) 
The full-wave quasi-resonant switch therefore exhibits voltage-source output characteristics, controllable 

20.3 
Resonant Switch Topologies 
781 
by F. Equations describing the average waveforms of CCM PWM converters can be adapted to apply to 
full-wave ZCS quasi-resonant converters, simply by replacing the duty cycle d with the normalized 
switching frequency F. The conversion ratios of full-wave quasi-resonant converters exhibit negligible 
dependence on the load current. 
The variation of the switch conversion ratio Jl with F and Js is plotted in Fig. 20.19. For a typi-
cal voltage regulator application, the range of switching frequency variations is much smaller in the full-
wave mode than in the half-wave mode, because Jl does not depend on the load current. Variations in the 
load current do not induce the controller to significantly change the switching frequency. 
20.3 
RESONANT SWITCH TOPOLOGIES 
So far, we have considered the zero-current-switching quasi-resonant switch cell, illustrated in 
Fig. 20.20. The ideal SPST switch is realized using a voltage-bidirectional or current-bidirectional two-
quadrant switch, to obtain half-wave or full-wave ZCS quasi-resonant switch networks, respectively. 
The resonant elements Lr and Cr can be moved to several different positions in the converter, 
without altering the basic switch properties. For example, Fig. 20.21 illustrates connection of the reso-
nant tank capacitor Cr between the cathode of diode D2, and the converter output or input terminals. 
Although this may change the de component of the tank capacitor voltage, the ac components of the tank 
capacitor voltage waveform are unchanged. Also, the terminal voltage waveform vit) is unchanged. The 
voltages vgCt) and v(t) contain negligible high-frequency ac components, and hence the converter input 
and output terminal potentials can be considered to be at high-frequency ac ground. 
A test to determine the topology of a resonant switch network is to replace all low-frequency fil-
ter inductors with open circuits, and to replace all de sources and low-frequency filter capacitors with 
short circuits [13]. The elements of the resonant switch cell remain. In the case of the zero-current-
switching quasi-resonant switch, the network of Fig. 20.22 is always obtained. 
It can be seen from Fig. 20.22 that diode D2 switches on and off at the zero crossings of the 
tank capacitor voltage vit), while the switch elements Q1 and D 1 switch at the zero crossings of the tank 
inductor current i 1(t). Zero voltage switching of diode D2 is highly advantageous, because it essentially 
eliminates the switching loss caused by the recovered charge and output capacitance of diode D2 • Zero 
current switching of Q1 and D1 can be used to advantage when Q1 is realized by an SCR or IGBT. How-
ever, in high-frequency converters employing MOSFETs, zero current switching of Q1 and D 1 is gener-
ally a poor choice. Significant switching loss due to the output capacitances of Q1 and D 1 may be 
observed. In addition, in the full-wave case, the recovered charge of diode D 1 leads to significant ringing 
,----------------··································----·······----·--··-·······-----············· 
i~·-··················· 1 i2,(t) 
1 i2(t) 
+ 
' 
+ ' 
sw 
+ 
Switch network 
: ........................................... : 
L .............. ~~~--~~-~~~-~:_~~?..'!.~.'!.~ .. s.~~!.~~--~~~-~ ................. .J 
Fig. 20.20 Basic ZCS quasi-resonant switch cell. 

782 
Soft Switching 
(a) 
:················································································~~---·············1 
sw 
["~~(~;··············"£········· 
+ 
~~----~ + 
v2(t) 
c 
R 
v 
(b) 
L 
+ 
c 
R 
v 
ZCS quasi-resonant switch 
----·····-··-------·····-------······---------···· 
Fig. 20.21 
Connection of the tank capacitor of the ZCS quasi-resonant cell to other points at ac ground: (a) con-
nection to the de output, (b) connection to the de input In each case, the ac components of the waveforms are 
unchanged. 
Fig. 20.22 Elimination of converter low-frequency elements 
causes the ZCS quasi-resonant switch cell to reduce to this 
network. 
and switching loss at the end of subinterval 2 [3]. 
L, 
SW 
+ 
C, v2(t) 
The ZCS quasi-resonant switch exhibits increased conduction loss, relative to an equivalent 
PWM switch, because the peak transistor current is increased. The peak transistor current is given by Eq. 
(20.17); since Is:<=; I, the peak current is I!pk ;:o: 2/2. In addition, the full-wave ZCS switch exhibits poor 
efficiency at light load, owing to the conduction loss caused by circulating tank currents. The half-wave 
ZCS switch exhibits additional conduction loss due to the added forward voltage drop of diode D1• The 
peak transistor voltage is Vp which is identical to the PWM case. 

20.3.1 
The Zero-Voltage-Switching Quasi-Resonant Switch 
The resonant switch network illustrated in Fig. 20.23 is the dual 
of the network of Fig. 20.22. This network is known as the zero-
voltage-switching quasi-resonant switch [4]. Since the tank 
capacitor C, appears in parallel with the SPST switch, the ele-
ments Q1 and D1 used to realize the SPST switch tum on and off 
at zero voltage. The tank inductor L, is effectively in series with 
diode D2, and hence diode D2 switches at zero current. Convert-
ers containing ZVS quasi-resonant switches can be realized in a 
number of ways. The only requirement is that, when the low-fre-
quency filter inductors, filter capacitors, and sources are replaced 
by open- or short-circuits as described above, then the high-fre-
quency switch network of Fig. 20.23 should remain. 
For example, a zero-voltage-switching quasi-resonant 
buck converter is illustrated in Fig. 20.24(a). Typical tank capac-
itor voltage and tank inductor current waveforms are given in 
Fig. 20.24(b). A current-bidirectional realization of the two-
quadrant SPST switch is shown; this causes the ZVS quasi-reso-
20.3 Resonant Switch Topologies 
783 
c, 
Fig. 20.23 Elimination 
of con-
verter 
low-frequency 
elements 
reduces the ZVS quasi-resonant 
switch cell to this network. 
nant switch to operate in the half-wave mode. Use of a voltage-bidirectional two-quadrant SPST switch 
allows full-wave operation. 
By analysis similar to that of Section 20.2, it can be shown that the switch conversion ratio f1 of 
the half-wave ZVS quasi-resonant switch is 
(20.61) 
The function Pt (1) is again given by Eq. (20.46), and the quantity Js is defined in Eq. (20.44). For the 
full-wave ZVS quasi-resonant switch, one obtains 
(20.62) 
where P 1(J) is given by Eq. (20.58). The condition for zero voltage switching is 
J,;::: 1 
(20.63) 
Thus, the zero voltage switching property is lost at light load. The peak transistor voltage is given by 
peak transistor voltage vcr,pk = (1 + J,) vl 
(20.64) 
This equation predicts that load current variations can lead to large voltage stress on transistor Q1. For 
example, if it is desired to obtain zero voltage switching over a 5:1 range of load current variations, then 
Js should vary between 1 and 5. According to Eq. (20.64), the peak transistor voltage then varies between 
two times and six times the applied voltage V1• The maximum transistor current is equal to the applied 
current !2 . Although the maximum transistor current in the ZVS quasi-resonant switch is identical to that 

7841 
Soft Switching 
(a) 
(b) 
Conducting 
devices: 
X 
Fig. 20.24 
A ZVS quasi-resonant buck converter: (a) circuit, (b) tank waveforms. 
I 
+ 
R 
v 
of the PWM switch, the peak transistor blocking voltage is substantially increased. This leads to 
increased conduction loss, because transistor on-resistance increases rapidly with rated blocking voltage. 
20.3.2 
The Zero-Voltage-Switching Multiresonant Switch 
The resonant switch network of Fig. 20.25 contains tank capacitor C din parallel with diode D2, as in the 
ZCS switch network of Fig. 20.22. In addition, it contains tank capacitor Cs in parallel with the SPST 
switch, as in the ZVS switch network of Fig. 20.23. In consequence, all semiconductor elements switch 
at zero voltage. This three-element resonant switch network is known as the zero-voltage-switching mul-
tiresonant switch (ZVS MRS). Since no semiconductor output capacitances or diode recovered charges 
lead to ringing or switching loss, the ZVS MRS exhibits very low switching loss. For the same reason, 
generation of electromagnetic interference is reduced. 
A half-wave ZVS MRS realization of the buck converter is illustrated in Fig. 20.26. In a typical 
design that must operate over a 5:1load range and with 0.4 ~ fl ~ 0.6, the designer might choose a maxi-
mum F of 1.0, a maximum J of 1.4, and Cd!Cs = 3, where these quantities are defined as follows: 

20.3 Resonant Switch Topologies 
785 
c. 
SW 
L, 
Fig. 20.25 Elimination of converter low-frequency elements reduces the ZVS multiresonant switch cell to this 
network. 
fr -
1 
o- 2n;rc; 
F=t_ 
fo 
R- ~ 
o-v c, 
J-12Ro 
- v, 
(20.65) 
As usual, the conversion ratio is defined as Jl = V2/V1• The resulting peak transistor voltage for this typi-
cal design is approximately 2.8VJo while the peak transistor current is 2/2. Hence, conduction losses are 
higher than in an equivalent PWM switch. The range of switch conversion ratios Jl is a function of the 
capacitor ratio Cd/Cs; in a good design, values of Jl ranging from nearly one to nearly zero can be 
obtained, with a wide range of de load currents and while maintaining zero voltage switching. 
Analysis and design charts for the ZVS MRS are given in [5-8]. Results for the typical choice 
Cd = 3Cs are plotted in Fig. 20.27. These plots illustrate how the switch conversion ratio Jl varies as a 
function of load current and switching frequency. Figure 20.27(a) also illustrates the boundary of zero-
voltage switching: ZVS is lost for operation outside the dashed lines. Decreasing the ratio of Cd to c. 
reduces the area of the ZVS region. 
Other resonant converters in which all semiconductor devices operate with zero voltage switch-
ing are known. Examples include some operating modes of the parallel and LCC resonant converters 
described in Chapter 19, as well as the class-E converters described in [10-12]. 
:······-------·-··········································--·-··········--·; 
I 
+ 
c 
R 
v 
t ......................................................................... .l 
Fig. 20.26 Half-wave ZVS multiresonant buck converter. 

786 
Soft Switching 
(a) 
1.0 
-
-
-
-
-
-
-
-
-
0.5 
0 
0.5 
1.0 
1.5 
2.0 
2.5 
J 
(b) 
0.5 
1.0 
1.5 
2.0 
2.5 
F 
Fig. 20.27 
Conversion ratio J.l. for the multi-resonant switch with Cd = 3Cs: (a) conversion ratio J.l. vs. normalized 
current] (solid lines: conversion ratio; dashed lines: boundaries of zero-voltage switching), (b) conversion ratio J.l. vs. 
normalized switching frequency F. 

20.3.3 
Quasi-Square-Wave Resonant Switches 
Another basic class of resonant switch networks is the 
(a) 
quasi-square wave converters. Both zero-voltage switching 
and zero-current switching versions are known; the reso-
nant tank networks are illustrated in Fig. 20.28. In the net-
work of Fig. 20.28(a), all semiconductor devices are 
effectively in series with the tank inductor, and hence oper-
ate with zero-current switching. In the network of 
Fig. 20.28(b), all semiconductor devices are effectively in 
parallel with the tank capacitor, and hence operate with 
(b) 
zero-voltage switching. 
Figure 20.29 illustrates implementation of a zero 
current switching quasi-square wave resonant switch, in a 
buck converter with input filter. Elements L1and C1are large 
20.3 Resonant Switch Topologies 
787 
L, 
c, 
L, 
c, 
in value, and constitute a single-section L--C input filter. 
Elements L, and C, form the series resonant tank; these ele-
ments are placed in series with input filter capacitor Cf" 
Since c, and c1 are connected in series, they can be com-
bined into a single small-value capacitor. In this zero-cur-
rent-switching converter, the peak transistor current is 
identical to the peak transistor current of an equivalent 
Fig. 20.28 Elimination of converter low-
frequency elements reduces the quasi-
square-wave switch cells to these networks: 
(a) 
ZCS 
quasi-square-wave 
network, 
(b) ZVS quasi-square-wave network. 
PWM converter. However, the peak transistor blocking voltage is increased. The ZCS QSW resonant 
switch exhibits a switch conversion ratio p, that is restricted to the range 0 ~ p, ~ 0.5. Analysis of this res-
onant switch is given in [13-14]. 
A buck converter, containing a zero-voltage-switching quasi-square wave (ZVS QSW) resonant 
switch, is illustrated in Fig. 20.30. Typical waveforms are given in Fig. 20.31. Since the tank inductor L, 
and the output filter inductor L are connected in parallel, these two elements can be combined into a sin-
gle inductor having a small value nearly equal to L,. Analyses of the ZVS QSW resonant switch are 
given in [14,15,18]. A related full-bridge converter is described in [16]. The ZVS QSW resonant switch 
is notable because zero voltage switching is obtained in all semiconductor devices, yet the peak transistor 
voltage is identical to that of an equivalent PWM switch [13]. However, the peak transistor currents are 
increased. 
Characteristics of the zero-voltage-switching quasi-square wave resonant switch are plotted in 
Fig. 20.32. The switch conversion ratio p, = V2/V1 is plotted as a function of normalized switching fre-
I 
+ 
R 
v 
Fig. 20.29 Incorporation of a ZCS quasi-square-wave resonant switch into a buck converter containing an L-C 
input filter. 

788 
Soft Switching 
DI 
Lr 
iit) 
I 
+ 
L 
vg 
cr 
v2(t) 
c 
R 
Fig. 20.30 Incorporation of a ZVS quasi-square-wave resonant switch into a buck converter. 
Fig. 20.31 
Waveforms of the ZVS quasi-square-
wave resonant switch converter of Fig. 20.30. 
Fig. 20.32 Characteristics of 
the ZVS quasi-square wave 
resonant 
switch 
network: 
switch conversion ratio f-1, as a 
function of F and J. Dashed 
line: ZVS boundary. 
1.0 
0.5 
5 
3 
Conducting 
devices: l D1 
0.5 
0.5 
+ 
v 
1=0 
1.0 
F 

20.3 Resonant Switch Topologies 
789 
I 
+ 
+ 
c 
R 
v 
Fig. 20.33 Quasi-square wave ZVS buck converter containing a synchronous rectifier. 
quency F and normalized output current J, where these quantities are defined as follows: 
fr -
1 
0 - 2n.jL,C, 
(20.66) 
F=t_ 
fo 
In addition, the zero-voltage-switching boundary is plotted. It can be seen that the requirement for zero-
voltage switching limits the switch conversion ratio Jl to the range 0.5 :S: Jl :S: 1. In consequence, the buck 
converter of Fig. 20.30 cannot produce output voltages less than 0.5 Vg without losing the ZVS property. 
A version which attains 0 ::; Jl ::; 1, at the expense of increased transistor voltage stress, is described in 
[ 17]. In addition, the two-switch version of the ZVS-QSW switch can operate with ZVS for Jl < 0.5. 
A useful variant of the converter of Fig. 20.30 involves replacement of the diode with a syn-
chronous rectifier, as illustrated in Fig. 20.33 [8,9]. The second transistor introduces an additional 
degree of freedom in control of the converter, because this transistor can be allowed to conduct longer 
than the diode would otherwise conduct. This fact can be used to extend the region of zero-voltage 
switching to conversion ratios approaching zero, and also to operate the converter with constant switch-
ing frequency. 
Typical tank element waveforms for the circuit of Fig. 20.33 are illustrated in Fig. 20.34. 
These waveforms resemble those of the single switch case, Fig. 20.31, except that the tank current is 
negative while transistor Q2 conducts. The duty cycle D is defined with respect to the tum-off transitions 
Fig. 20.34 Waveforms 
for 
the 
QSW-ZVS converter of Fig. 20.33. 
two-switch 

7911 
Soft Switching 
ll 
1.0 
0.5 
0 
-=-=-o.2 -
D=0.8 
0.3 
0.2 
0.4 
0.7 
' ,0.6 
' 
' 0.5 
0.4 
F=0.5 
0.6 
0.8 
J 
Fig. 20.35 Conversion ratio Jl, as a function of duty cycle D and normalized load current J, for the two-switch 
QSW-ZVS switch illustrated in Fig. 20.33. Curves are plotted for constant-frequency control with F = 0.5. The 
dashed line is the zero-voltage switching boundary. 
of transistors Q 1 and Q2, as illustrated. 
Characteristics of the two-switch QSW-ZVS switch network are plotted in Fig. 20.35, for the 
case of constant switching frequency at F = 0.5. The boundary of zero-voltage switching is also illus-
trated. Operation at a lower value ofF causes the ZVS boundary to be extended to larger values of J, and 
to values of Jl that more closely approach the extreme values Jl = 0 and Jl = 1. 
To the commutation intervals can be neglected, one would expect that the switch conversion 
ratio Jl is simply equal to the duty cycle D. It can be seen from Fig. 20.35 that this is indeed the case. The 
characteristics are approximately horizontal lines, nearly independent of load current J. 
Zero-voltage switching quasi-square wave converters exhibit very low switching loss, because 
all semiconductor elements operate with zero-voltage switching. In the constant-frequency case contain-
ing a synchronous rectifier, the converter behavior is nearly the same as for the hard-switched PWM 
case, since Jl =D. The major disadvantage is the increased conduction loss, caused by the reversal of the 
inductor current. 
20.4 
SOFT SWITCHING IN PWM CONVERTERS 
The quasi-square wave approach of the previous section is notable because it attains zero-voltage switch-
ing without increasing the peak voltage applied to the transistor. Several related soft-switching 
approaches have now become popular, which also attain zero-voltage switching without increasing the 
transistor peak voltage stress. In this section, popular zero-voltage switching versions of the full bridge, 
forward, and flyback converters, as well as the voltage-source inverter, are briefly discussed. 

20.4 Soft Switching in PWM Converters 
791 
20.4.1 
The Zero-Voltage Transition 
Full-Bridge Converter 
It is possible to obtain soft switching in other types of converters as well. An example is the zero-voltage 
transition (ZVT) converter based on the full-bridge transformer-isolated buck converter. illustrated in 
Fig. 20.36 [25-28]. The transistor and diode output capacitances are represented in the figure by capaci-
tances C1eg· Commutating inductor Lc is placed in series with the transformer; the net inductance Lc 
includes both transformer leakage inductance and the inductance of an additional discrete element. This 
inductor causes the full-bridge switch network to drive an effective inductive load, and results in zero-
voltage switching of the primary-side semiconductor devices. Although the waveforms are not sinusoi-
dal, it can nonetheless be said that the switch network output current i/t) lags the voltage v/t), because 
the zero crossings of i/t) occur after the ZVS switching transitions are completed. 
The output voltage is controlled via phase control. As illustrated in Fig. 20.37, both halves of 
the bridge switch network operate with a 50% duty cycle, and the phase difference between the half-
bridge switch networks is controlled. The idealized waveforms of Fig. 20.37 neglect the switching tran-
sitions, and the subinterval numbers correspond to those of the more detailed Fig. 20.38. The phase shift 
variable <1> lies in the range 0 ::; <1> ::; 1, and assumes the role of the duty cycle din this converter. The quan-
tity <1> is defined as 
(20.67) 
By volt-second balance on the secondary-side filter inductor, the conversion ratio M(<l>) is expressed as 
M(!jl)= t =n!jl 
g 
(20.68) 
This expression neglects the lengths of the switching transitions. 
Although the circuit appears symmetrical, the phase-shift control scheme introduces an asym-
metry that causes the two half-bridge switch networks to behave quite differently during the switching 
transitions. During subintervals 4 and 10, energy is actively transmitted from the source Vg through the 
switches and transformer. These subintervals are initiated by the switching of the half-bridge network 
igCt) 
~ 
+ 
vg 
+ 
v 
&f 
Fig. 20.36 Zero-voltage transition converter, based on the full-bridge isolated buck converter. 

792 
Soft Switching 
'it) l 
vg 
I· 
TJ2 
[ 
0 
0 
'it) 1 
Ts 
vg 
,. 
TJ2 
• 
0 
0 
v,(t) 
vg 
'r---
0 
-
<!JT/2 -1--- (1- <)J)T/2 -+-- <)JTJ2l 
0 
i,(t) 1'--_o_--+--n-I --+------!------+------+---
Subinterval: 
Conducting 
devices: 
Fig. 20.37 
Phase-shift control of the ZVT full-bridge converter. Switching transitions are neglected in this figure, 
and subinterval numbering follows Fig. 20.38. 
composed of the elements Ql' D 1, Q2, and D2, called the "passive-to-active" (P-A) transition [27]. Sub-
intervals 4 and 10 are terminated by the switching of the half-bridge network comprised by the elements 
Q3, D3, Q4 , and D 4, called the "active-to-passive" (A-P) transition. 
The tum-on and tum-off switching processes of this converter are similar to the zero-voltage-
switching turn-off process described in the previous section. Detailed primary-side waveforms are illus-
trated in Fig. 20.38. During subinterval 0, Q2 and D4 conduct. If the transformer magnetizing current iM 
is negligible, then the commutating inductor current is given by Vt0) = - ni, where I is the load current. 
The passive-to-active transition is initiated when transistor Q2 is turned off. The negative ic then causes 
capacitors cleg! and cleg2 to charge, increasing Vz(t). During subinterval 1, Lc, clegl' and cleg2 form a res-
onant network that rings with approximately sinusoidal waveforms. If sufficient energy was initially 
stored in Lc, then v2(t) eventually reaches V8, terminating subinterval 1. Diode D 1 then clamps v2(t) to V8 
during subinterval 2. Transistor Q1 is turned on at zero voltage during subinterval 2; in practice, this is 
implemented by insertion of a small delay between the switching transitions of transistors Q2 and Q1. 
If Lc does not initially store sufficient energy to charge the total capacitance ( Cteg! + C1e82 ) from 
v2 = 0 to v2 = Vg during subinterval 1, then v2(t) will never reach V8 • Switching loss will then occur when 
transistor Q1 is turned on. This situation typically occurs at light load, where I is small. Sometimes, the 
design engineer may choose to simply accept this power loss; after all, other losses such as conduction 
loss are small at light load. An alternative is to modify the circuit to increase the energy stored in Lc at 

0 
-nl 
Subinterval: 
0 
Q2 
Conducting 
D4 
devices: 
20.4 
Soft Switching in PWM Converters 
793 
nl 
"--------'"----':vL__J::,,:,::,,,,,,,. 
~j 
r-~~~~----~~~ 
!2: 3 
4 
X Pl: 
Ql 
D4 P4! 
Q4 
Ds Psi Ds [ Ds 
D6 iD6i D6 j X 
- V/Lc 
7 i 8: 9 
10 
X lDzl 
Qz 
D3lD3! 
Q3 
Ds Psi Ds 
X 
D6 !D6! D6 
D6 
0 
nl 
0 
Q2 
} P-A 
D4 
} A-P 
Ds 
} Secondary 
D6 
diodes 
Fig. 20.38 Detailed diagram of primary-side waveforms of the ZVT full-bridge converter, illustrating the zero-
voltage switching mechanisms. An ideal transformer is assumed. 
t = t0 under light load conditions. One way to accomplish this is to increase the transformer magnetizing 
current iM(t0) to a significant level; at the beginning of subinterval 1, ic is then equal to 
i/t0) =- nl + iM(t0 ) with iM(t0 ) < 0. At light load where I is small, the magnetizing current maintains the 
required level of ic. 
During subintervals 0, 1, 2, and 3, secondary-side diodes D5 and D6 both conduct; hence, zero 
voltage appears across all transformer windings. In consequence, voltage Vg is applied to commutating 
inductor Lc during subintervals 2 and 3, causing i/t) to increase with slope V/Lc. Current ic(t) reaches 
zero at the end of subinterval 2, and increases to the positive value + nl at the end of subinterval 3. The 
reversal of polarity of i/t) enables zero-voltage switching during the next switching transitions, subinter-
valS and subintervals 7-9. 
At the end of subinterval 3, the current in diode D6 has decreased to zero. D6 then becomes 
reverse-biased, with zero-current switching. At this instant, diode D6 must begin to block voltage 2n V8• 

794 
Soft Switching 
The output capacitance of D6 prevents the voltage from changing immediately to 2n Vg; instead, the reso-
nant circuit formed by Lc and the D6 output capacitance begins to ring in a manner similar to Fig. 4.54. 
Peak D6 voltages are typically observed that are considerably in excess of 2n Vg, and it is usually neces-
sary to add voltage-clamp snubbers that prevent the secondary-side diode voltages from exceeding a safe 
value. Several dissipative and non-dissipative approaches are discussed in [26-28]. 
The active-to-passive switching transition occurs during subinterval 5. This subinterval is initi-
ated when transistor Q4 is turned off. The positive current ic(t1) is equal to the reflected load current nl, 
and charges capacitors C1eg3 and C1eg4 from v4 = 0 to v4 = Vg. Subinterval 5 ends when v4 reaches Vg; 
Diode D3 then becomes forward-biased. Transistor Q3 is then turned on during subinterval 6, with zero-
voltage switching. This is typically implemented by insertion of a small delay between the switching of 
transistors Q4 and Q3. Because ic is constant and equal to nl during subinterval 5, the active-to-passive 
transition maintains Zero-voltage switching at all load currents. 
Circuit behavior during the next half switching period, comprising subintervals 6 to 11, is sym-
metrical and therefore similar to the behavior observed during subintervals 0 to 5. The switching transi-
tions of transistors Q1 and Q2 are passive-to-active transitions, and occur with zero-voltage switching 
provided that sufficient energy is stored in Lc as described above. The switching transitions of Q3 and Q4 
are active-to-passive, and occur with zero-voltage switching at all loads. 
The zero-voltage transition converter exhibits low primary-side switching loss and generated 
EMI. Conduction loss is increased with respect to an ideal PWM full-bridge topology, because of the 
current ic that circulates through the primary-side semiconductors during subintervals 0 and 6. However, 
this increase in conduction loss can be small if the range of input voltage variations is narrow. This soft-
switching approach has now found commercial success. 
20.4.2 
The Auxiliary Switch Approach 
A similar approach can be used in forward, flyback, and other transformer-isolated converters. As illus-
trated in Fig. 20.39, an "active-clamp snubber" network consisting of a capacitor and auxiliary MOS-
FET Q2 is added, that is effectively in parallel with the original power transistor Q1 [29]. The MOSFET 
body diodes and output drain-to-source capacitances, as well as the transformer leakage inductance Le, 
participate in the circuit operation. These elements lead to zero-voltage switching, with waveforms simi-
lar to those of the ZVT full-bridge converter of Section 20.4.1 or the two-transistor QSW-ZVS switch of 
Section 20.3.3. The transistors are driven by complementary signals; for example, after turning off Q1, 
the controller waits for a short delay time and then turns on Q2 • 
The active-clamp snubber can be viewed as a voltage-clamp snubber, similar to the dissipative 
snubber illustrated in Fig. 20.6. However, the snubber contains no resistor; instead, MOSFET Q2 allows 
bidirectional power flow, so that the energy stored in capacitor c. can flow back into the converter. 
The voltage v. can be found by volt-second inductance on the transformer magnetizing induc-
tance. If the lengths of the commutation intervals are neglected, and if the voltage ripple in v.(t) can be 
neglected, then one finds that 
(20.69) 
The voltage v s is effectively an unloaded output of the converter. With the two-quadrant switch provided 
by Q2, this output operates in continuous conduction mode with no load, and hence the peak voltage of 
Q1 is clamped to the minimum level necessary to balance the volt-seconds applied to the transformer 
magnetizing inductance. 

20.4 Soft Switching in PWM Converters 
795 
(a) 
Dz 
L 
+ 
c 
R 
v 
vg 
+ 
~ 
+ 
vds 
(b) 
+ 
Fig. 20.39 
Active-clamp snubber circuits: (a) forward converter, (b) flyback converter. 
r. 
Fig. 20.40 
Waveforms of the active-clamp snubber circuit of Fig. 20.39(a). 

796 
Soft Switching 
Typical waveforms for a forward converter incorporating an active-clamp snubber are illus-
trated in Fig. 20.40. The current ie(t) reverses direction while Q2 conducts. When Q2 turns off, capacitor 
Cds begins to discharge. When vds reaches zero, the body diode of Q1 becomes forward-biased. Q1 can 
then be turned on at zero voltage. 
An added benefit of the active clamp snubber, when used in a forward converter, is that it resets 
the transformer. Consequently, the converter can operate at any duty cycle, including duty cycles greater 
than 50%. When the converter must operate with a wide range of input voltages, this can allow substan-
tial improvements in transistor stresses and efficiency. The MOSFETs in Fig. 20.39 operate with zero-
voltage switching, while the secondary-side diodes operate with zero-current switching. 
This approach is quite versatile, and similar auxiliary circuits can be added to other converter 
circuits to obtain zero-voltage switching [30,31]. 
20.4.3 
Auxiliary Resonant Commutated Pole 
The auxiliary resonant commutated pole (ARCP) is a related circuit that uses an auxiliary four-quadrant 
switch (or two equivalent two-quadrant switches) to obtain soft switching in the transistors of a bridge 
inverter circuit [32-34]. This approach finds application in dc-ac inverter circuits. Figure 20.41 illus-
trates a half-bridge circuit, or one phase of a three-phase voltage-source inverter, driving an ac load. This 
circuit can lead to zero-voltage switching that mitigates the switching loss induced by the reverse recov-
ery of diodes D 1 and D2. Filter inductor L1is relatively large, so that the output current ia(t) is essentially 
constant during the resonant commutation interval. Capacitors Cds are relatively small, and model the 
output capacitances of the semiconductor devices. Inductor L, is also relatively small, and elements L, 
and C tis form a resonant circuit that rings during part of the commutation process. Semiconductor switch-
ing devices Q3, Q4 , D3, and D4 form an auxiliary four-quadrant switch that turns on to initiate the reso-
nant commutation process. 
Typical commutation waveforms are illustrated in Fig. 20.42(a), for the case in which the ac 
load current ia is positive. Diode D2 is initially conducting the output current ia. It is desired to tum off 
D2 and tum on Q 1, with zero-voltage switching. This is accomplished with the following sequence: 
Interval!. 
Interval2. 
lnterval3. 
Turn on transistor Q3• Devices D2, Q3, and D4 conduct. 
When the current in D2 reaches zero, D2 turns off. A resonant ringing interval occurs. 
When the voltage van reaches V/2, diode D1 begins to become forward-biased. Tran-
sistor Q1 is then immediately turned on at zero voltage. 
Fig. 20.41 Half-bridge circuit driving an ac load, with ARCP zero-voltage switching. 

20.5 Summary of Key Points 
797 
(a) 
i,(<) 11....-.-...f---n:~,···---2---~-, 
3 
:~ 
Interval: 
(b) 
",,(<: ~--+--+----!---+-----+-----+ 
- v 12 
V/2 
: /i 
iT. 
(DI) 
Conducting ; 
8 
Dz 
Q3 
Ql 
Ql 
Conducting 
devices: 
devices: 
D2 
Q3 
D4 
Q3 
D4 
D4 
Fig. 20.42 
Waveforms of the ARCP circuit of Fig. 20.41: (a) basic waveforms, (b) with current boost. 
At the conclusion of interval 3, ir(t) reaches zero and diode D3 turns off. For negative current, the process 
for commutation of diode D1 is similar, except that transistor Q4 and diode D3 conduct the resonant cur-
rent i,(t). 
One issue related to the waveforms of Fig. 20.42(a) is that the circuit always operates at the 
boundary of zero-voltage switching. At the end of interval 2, diode D1 is not actually forward-biased, 
because its current never actually becomes positive. Instead, transistor Q1 should be turned on at the 
beginning of interval 3. If transistor Q1 is gated on late, then the continued ringing will cause voltage 
v an(t) to decrease, and zero-voltage switching will be lost. 
To further assist in the zero-voltage switching commutation process, transistor Q2 can be turned 
on while D2 conducts, as illustrated in Fig. 20.42(b). Transistor Q2 is used to lengthen the duration of 
interval 1: now, when the current ir(t) exceeds current i0 by an amount iboost' then the controller turns off 
Q2 to end interval 1. This causes diode D1 to become forward-biased during the beginning of interval 3. 
Transistor Q1 is then turned on with zero-voltage switching, while D1 is conducting. 
Regardless of whether the circuit operates with the waveforms of Fig. 20.42(a) or (b), the 
ARCP approach eliminates the switching loss caused by the reverse recovery of diodes D1 and D2• 
Unlike the previous circuits of this chapter, the ARCP has no circulating currents that cause conduction 
loss, because the tank inductor current ir(t) is nonzero only in the vicinity of the commutation interval. 
The approach of Fig. 20.42(a) does not completely eliminate the loss caused by the device output capac-
itances. This loss is eliminated using the current boost of Fig. 20.42(b ), but additional conduction loss is 
incurred because of the increased peak i,(t). The waveforms of Fig. 20.42(b) may, in fact, lead to 
reduced efficiency relative to Fig. 20.42(a)! 
20.5 
SUMMARY OF KEY POINTS 
1. 
In a resonant switch converter, the switch network of a PWM converter is replaced by a switch network 
containing resonant elements. The resulting hybrid converter combines the properties of the resonant 
switch network and the parent PWM converter. 
2. 
Analysis of a resonant or soft-switching switch cell involves determination of the switch conversion ratio 
fl. The resonant switch waveforms are determined, and are then averaged. The switch conversion ratio fl is 

798 
Soft Switching 
a generalization of the PWM CCM duty cycle d. The results of the averaged analysis of PWM converters 
operating in CCM can be directly adapted to the related resonant switch converter, simply by replacing d 
with p.. 
3. 
In the zero-current-switching quasi-resonant switch, diode D2 operates with zero-voltage switching, while 
transistor Q1 and diode D1 operate with zero-current switching. In the zero-voltage-switching quasi-reso-
nant switch, the transistor Q1 and diode D1 operate with zero-voltage switching, while diode D2 operates 
with zero-current switching. 
4. 
In the zero-voltage-switching multiresonant switch, all semiconductor devices operate with zero-voltage 
switching. In consequence, very low switching loss is observed. 
5. 
In the quasi-square-wave zero-voltage-switching resonant switches, all semiconductor devices operate 
with zero-voltage switching, and with peak voltages equal to those of the parent PWM converter. The 
switch conversion ratio is restricted to the range 0.5 ::; p. ::; 1. Versions containing synchronous rectifiers 
can operate with values of p. approaching zero. 
6. 
The zero-voltage transition approach, as well as the active-clamp snubber approach, lead to zero-voltage 
switching of the transistors and zero-current switching of the diodes. These approaches have been success-
ful in substantially improving the efficiencies of transformer-isolated converters. The auxiliary resonant 
commutated pole induces zero-voltage switching in bridge circuits such as the voltage-source inverter. 
REFERENCES 
[1] 
P. VINCIARELLI, "Forward Converter Switching at Zero Current," U.S. Patent 4,415,959, Nov. 1983. 
[2] 
K. LIU, R. ORUGANTI, and F. C. LEE, "Resonant Switches: Topologies and Characteristics," IEEE Power 
Electronics Specialists Conference, 1985 Record, pp. 106-116. 
[3] 
M. F. SCHLECHT and L. F. CASEY, "Comparison of the Square-Wave and Quasi-Resonant Topologies," 
IEEE Applied Power Electronics Conference, 1987 Record, pp. 124-134. 
[4] 
K. LIU and F. C. LEE, "Zero Voltage Switching Technique in De-De Converters," IEEE Power Electronics 
Specialists Conference, 1986 Record, pp. 58-70. 
[5] 
W. A. TABISZ and F. C. LEE, "Zero-Voltage-Switching Multi-Resonant Technique-A Novel Approach to 
Improve Performance of High-Frequency Quasi-Resonant Converters," IEEE Power Electronics Special-
ists Conference, 1988 Record, pp. 9-17. 
[6] 
W. A. TABISZ, M. M. JovANOVIC, and F. C. LEE, "High Frequency Multi-Resonant Converter Technology 
and Its Applications," lEE International Conference on Power Electronics and Variable Speed Drives, July 
17-19, 1990, p. 1-8. 
[7] 
R. FARRINGTON, M. JOVANOVIC, and F. C. LEE, "Constant-Frequency Zero-Voltage-Switched Multi-Res-
onant Converters: Analysis, Design, and Experimental Results," IEEE Power Electronics Specialists Con-
ference, 1990 Record, pp. 197-205. 
[8] 
D. MAKSIMOVIC, "Synthesis of PWM and Quasi-Resonant De-to-De Power Converters," Ph.D. thesis, 
California Institute of Technology, January 1989. 
[9] 
X. ZHOU, X. ZHANG, J. LIU, P. WONG, J. CHEN, H. Wu, L. AMOROSO, F. LEE, and D. CHEN, "Investiga-
tion of Candidate VRM Topologies for Future Microprocessors," IEEE Applied Power Electronics Confer-
ence, 1998 Record, pp. 145-150. 

References 
799 
[10] 
R. REDL, B. MOLNAR, and N. SOKAL, "Class E Resonant Regulated De-De Power Converters: Analysis of 
Operation and Experimental Results at 1.5 MHz," IEEE Transactions on Power Electronics, 1986, Vol. 1, 
No.2, pp. 111-120. 
[11] 
N. SOKAL and A. SOKAL, "Ciass-E, A New Class of High Efficiency Tuned Single-Ended Switching 
Power Amplifiers," IEEE Journal of Solid State Circuits, Vol. SC-10, June 1975, pp. 168-176. 
[12] 
F. H. RAAB, "Idealized Operation of Class-E Tuned Power Amplifier," IEEE Transactions on Circuits and 
Systems, Vol. 24, No. 12, December 1977, pp. 725-735. 
[13] 
K. D. T. Noo, "Generalization of Resonant Switches and Quasi-Resonant De-De Converters," IEEE 
Power Electronics Specialists Conference, 1987 Record, pp. 395-403. 
[14] 
V. VORPERIAN, "Quasi-Square Wave Converters: Topologies and Analysis," IEEE Transactions on Power 
Electronics, Vol. 3, No.2, Apri11988, pp. 183-191. 
[15] 
D. MAKSIMOVIC, "Design of the Zero-Voltage-Switching Quasi-Square-Wave Resonant Switch," IEEE 
Power Electronics Specialists Conference, 1993 Record, pp. 323-329. 
[16] 
0. D. PATTERSON and D. M. DIVAN, "Pseudo-Resonant Full-Bridge De-De Converter," IEEE Power Elec-
tronics Specialists Conference, 1987 Record, pp. 424-430. 
[17] 
Y. JANG and R. ERICKSON, "New Quasi-Square Wave and Multi-Resonant Integrated Magnetic Zero Volt-
age Switching Converters," IEEE Power Electronics Specialists Conference, 1993 Record, pp. 721-727. 
[18] 
V. VORPERIAN, R. TYMERSKI, and F. C. LEE, "Equivalent Circuit Models for Resonant and PWM 
Switches," IEEE Transactions on Power Electronics, Vol. 4, No.2, Aprill989, pp. 205-214. 
[19] 
S. FREELAND and R. D. MIDDLEBROOK, "A Unified Analysis of Converters with Resonant Switches", 
IEEE Power Electronics Specialists Conference, 1987 Record, pp. 20-30. 
[20] 
A. WITULSKI and R. ERICKSON, "Extension of State-Space Averaging to Resonant Switches-and 
Beyond," IEEE Transactions on Power Electronics, Vol. 5, No. 1, pp. 98-109, January 1990. 
[21] 
D. MAKSIMOVIC and S. CUK, "A General Approach to Synthesis and Analysis of Quasi-Resonant Convert-
ers," IEEE Transactions on Power Electronics, Vol. 6, No.1, January 1991, pp. 127-140. 
[22] 
R. ERICKSON, A. HERNANDEZ, A. WITULSKI, and R. Xu, "A Nonlinear Resonant Switch," IEEE Transac-
tions on Power Electronics, Vol. 4, No.2, April1989, pp. 242-252. 
[23] 
I. BARB!, D. MARTINS, and R. DO PRADO, "Effects of Nonlinear Resonant Inductor on the Behavior of 
Zero-Voltage Switching Quasi-Resonant Converters," IEEE Power Electronics Specialists Conference, 
1990 Record, pp. 522-527. 
[24] 
S. FREELAND, "I. A Unified Analysis of Converters with Resonant Switches, II. Input-Current Shaping for 
Single-Phase Ac-Dc Power Converters," Ph.D. Thesis, California Institute of Technology, 1988. 
[25] 
R. FISHER, K. Noo, and M. Kuo, "A 500 kHz, 250 W De-de Converter with Multiple Outputs Controlled 
by Phase-Shifted PWM, and Magnetic Amplifiers," Proceedings of High Frequency Power Conversion 
Conference, pp. 100-110, May 1988. 
[26] 
L. MWEENE, C. WRIGHT, and M. SCHLECHT, "A 1 kW, 500 kHz Front-End Converter for a Distributed 

800 
Soft Switching 
Power Supply System," IEEE Applied Power Electronics Conference, 1989 Record, pp. 423-432. 
[27] 
R. REDL, L. BELOGH, and D. EDWARDS, "Optimum ZVS Full-Bridge DC/DC Converter with PWM 
Phase-Shift Control: Analysis, Design Considerations, and Experimental Results," IEEE Applied Power 
Electronics Conference, 1994 Record, pp. 159-165. 
[28] 
J. G. CHO, J. A. SABATE, and F. C. LEE, "Novel Full Bridge Zero-Voltage-Transition PWM DC/DC Con-
verter for High Power Applications," IEEE Applied Power Electronics Conference, 1994 Record, 
pp. 143-149. 
[29] 
P. VINCIARELLI, "Optimal Resetting of the Transformer's Core in Single-Ended Forward Converters," 
Reissued U.S. Patent No. Re. 36,098, Feb. 16, 1999. 
[30] 
C. DUARTE and I. BARB!, "A Family of ZVS-PWM Active-Clamping De-to-De Converters: Synthesis, 
Analysis, Design, and Experimentation," IEEE Transactions on Circuits and Systems-/: Fundamental 
Theory and Applications, Vol. 44, No.8, pp. 698-704, Aug. 1997. 
[31] 
P. HENG and R. ORUGANTI, "Family of Two-Switch Soft-Switched Asymmetrical PWM De/De Convert-
ers," IEEE Power Electronics Specialists Conference, 1994 Record, pp. 85-94. 
[32] 
R. DEDONCKER and J. LYONS, "The Auxiliary Resonant Commutated Pole Converter," IEEE Industry 
Applications Society Annual Meeting, 1990 Record, pp. 1228-1235. 
[33] 
R. TEICHMANN and S. BERNET, "Investigation and Comparison of Auxiliary Resonant Commutated Pole 
Converter Topologies," IEEE Power Electronics Specialists Conference, 1998 Record, pp. 15-23, May 
1998. 
[34] 
W. McMURRAY, "Resonant Snubbers with Auxiliary Devices," IEEE Transactions on Industry Applica-
tions, Vol.29, No.2, pp. 355-361, 1993. 
PROBLEMS 
20.1 
In the forward converter of Fig. 20.43, Land Care large filter elements while LP, L8 , and C, have rela-
tively small values. The transformer reset mechanism is not shown; for this problem, you may assume 
that the transformer is ideal. 
+ 
R 
v 
Fig. 20.43 Forward converter with resonant switch, Problem 20.1. 
(a) 
Classify the resonant switch. 

Problems 
801 
(b) 
Which semiconductor devices operate with zero-voltage switching? With zero-current switch-
ing? 
(c) 
What is the resonant frequency? 
20.2 
In the high-voltage converter of Fig. 20.44, capacitor C is relatively large in value. The transformer 
model includes an ideal 1 :n transformer, in conjunction with magnetizing inductance Lmp (referred to the 
primary side) and winding capacitance Cws (referred to the secondary side). Transistor Q and diode D P 
exhibit total output capacitance CP, while the output capacitance of diode D, is C,. Other nonidealities, 
such as transformer leakage inductance, can be ignored. The resonant switch is well-designed, such that 
all elements listed above contribute to ideal operation of ihe converter and resonant switch. 
r-····-------------------~-;--~---------------------------1 
r--,-----+-r~~--~--~r---~ + 
R 
v 
+ 
Fig. 20.44 High-voltage de-de converter containing a resonant switch network, Problem 20.2. 
(a) 
What type of resonant switch is employed? What is the parent PWM converter? 
(b) 
Which semiconductor devices operate with zero-voltage switching? With zero-current switch-
ing? 
(c) 
What is the tank resonant frequency? 
(d) 
Sketch the waveforms of the transistor drain-to-source voltage and transformer magnetizing cur-
rent. 
20.3 
In the transformer-isolated de-de converter of Fig. 20.45, capacitors C1 and C2 and inductors L1 and LM 
are relatively large in value, so that they have small switching ripples. The transformer model includes 
an ideal l:n transformer, in conjunction with magnetizing inductance LM (referred to the primary side) 
and leakage inductances LCl and L12 as shown. Transistor Q1 exhibits output capacitances Cds• while the 
output capacitance of diode D1 is Cd. MOSFET Q1 contains a body diode (not explicitly shown). Other 
nonidealities can be ignored. The resonant switch is well-designed, such that all elements listed above 
contribute to ideal operation of the converter and resonant switch. 
(a) 
What type of resonant switch is employed? What is the parent PWM converter? 
(b) 
Which semiconductor devices operate with zero-voltage switching? With zero-current switch-
ing? 
20.4 
A buck-boost converter is realized using a half-wave ZCS quasi-resonant switch. The load resistance has 
valueR, the input voltage has value V8 , and the converter switching frequency isf,. 
(a) 
Sketch the circuit schematic. 
(b) 
Write the complete system of equations that can be solved to determine the output voltage V, in 
terms of the quantities listed above and the component values. It is not necessary to actually 
solve your equations. You may also quote results listed in this textbook. 

802 
Soft Switching 
+ 
R 
v 
Ideal 
'·············---· 
Transformer 
c ••••••••.•.••••••••• rrz.0.4.~! ...................... , 
Fig. 20.45 Transformer-isolated de-de converter containing a resonant switch network, Problem 20.3. 
20.5 
It is desired to design a half-wave zero-current-switching quasi-resonant forward converter to operate 
with the following specifications: V8 = 320 V, V = 42 V, 5 W :o; P :o; 100 W. Design the converter to oper-
ate with a maximum switching frequency of 1 MHz and a switch conversion ratio of p, = 0.45. Attempt 
to minimize the peak transistor current, while maintaining zero current switching at all operating points. 
You may neglect the transformer magnetizing current, and ignore the transformer reset scheme. 
(a) 
Specify your choices for the turns ratio n, and the tank elements Lr and Cr, referred to the trans-
former secondary side. 
(b) 
For your design of part (a), what is the minimum switching frequency? 
(c) 
What is the worst-case peak transistor current? 
20.6 
Analysis of the ZVS quasi-resonant switch of Fig. 20.24. 
(a) 
For each subinterval, sketch the resonant switch cell circuit, and derive expressions for the tank 
inductor current and capacitor voltage waveforms. 
(b) 
For subinterval2, in which QlfD1 are off and D2 conducts, write the loop equation which relates 
the tank capacitor voltage, tank inductor voltage, and any other network voltages as appropriate. 
Hence, for subinterval 2 relate the integral of the tank capacitor voltage to the change in tank 
inductor current. 
(c) 
Determine the switch-network terminal-waveform average values, and hence derive an expres-
sion for the switch conversion ratio p,. Verify that your result coincides with Eq. (20.61). 
20.7 
Analysis of the full-bridge zero-voltage transition converter of Section 20.4.1. The converter of 
Fig. 20.36 operates with the waveforms illustrated in Fig. 20.38. According to Eq. (20.68), the conver-
sion ratio of this converter is given approximately by M( <1>) = n$. 
Derive an exact expression for M, based on the waveforms given in Fig. 20.38. Your result 
should be a function of the length of subinterval 4, the load current, the switching frequency, and the val-
ues of the inductance and capacitances. Note: there is a reasonably simple answer to this question. 

Appendices 

Appendix A 
RMS Values of Commonly Observed 
Converter Waveforms 
The waveforms encountered in power electronics converters can be quite complex, containing modula-
tion at the switching frequency and often also at the ac line frequency. During converter design, it is often 
necessary to compute the rms values of such waveforms. In this appendix, several useful formulas and 
tables are developed which allow these rms values to be quickly determined. 
RMS values of the doubly-modulated waveforms encountered in PWM rectifier circuits are dis-
cussed in Section 18.5. 
A.l 
SOME COMMON WAVEFORMS 
DC, Fig. A.l: 
rms=l 
(A.l) 
Fig. A.l 

806 
RMS Values of Commonly Observed Converter Waveforms 
DC plus linear ripple, Fig. A.2: 
i(t) 
I 
Fig. A.2 
Square wave, Fig. A.3: 
i(t) 
Fig. A.3 
Sine wave, Fig. A.4: 
Fig. A.4 
Pulsating waveform, Fig. A.5: 
rms=IJ l+t(1ir 
rms=Ipk 
I pk 
rms = ./2 
rms =I pk ll5 
(A.2) 
(A.3) 
(A.4) 
(A.5) 

i(t) 
0 
Fig. A.S 
0 
DT, 
Pulsating waveform with linear ripple, Fig. A.6: 
Fig. A.6 
i(t) 
I 
Triangular waveform, Fig. A.7: 
Fig. A.7 
i(t) 
Ipk 
Triangular waveform, Fig. A.S: 
0 
0 
J Dt +Dz 
rms = I pk 
--3-
0 
Wt 
rms=IpkV 3 
A. I 
Some Common Waveforms 
807 
-
(A.6) 
T, 
(A.7) 
(A.S) 

808 
RMS Values of Commonly Observed Converter Waveforms 
i(t) 
Ipk ....................... . 
0 
Fig. A.8 
0 
Ts 
t 
Triangular waveform, no de component, Fig. A.9: 
rms= Jf 
(A.9) 
Fig. A.9 
Center-tapped bridge winding waveform, Fig. A.lO: 
rms=tlpkv'l+D 
(A.lO) 
i(t) 
0 
Fig. A.lO 
0 
DT5 
Ts 
(1 +D)Ts 2Ts 
General stepped waveform, Fig. A. II: 
(A.ll) 
i(t) 
... J 
Fig. A.ll 
0 

A.2 
General Piecewise Waveform 
809 
i(t) 
Fig. A.12 
General piecewise waveform. 
A.2 
GENERAL PIECEWISE WAVEFORM 
For a periodic waveform composed of n piecewise segments as in Fig. A.l2, the rms value is 
(A.l2) 
where Dk is the duty cycle of segment k, and uk is the contribution of segment k. The uks depend on the 
shape of the segments-several common segment shapes are listed below: 
Constant segment, Fig. A.l3: 
(A.l3) 
i(t) 
Fig. A.13 
Triangular segment, Fig. A.l4: 
(A.l4) 
i(t) 
0 
Fig. A.14 

810 
RMS Values of Commonly Observed Converter Waveforms 
Trapezoidal segment, Fig. A.15: 
(A.15) 
i(t) 
Fig. A.lS 
Sinusoidal segment, half or full period, Fig. A.16: 
(A.16) 
i(t) 
Fig. A.16 
Sinusoidal segment, partial period: as in Fig. A.17, a sinusoidal segment of less than one half-period, 
which begins at angle 81 and ends at angle 82 • The angles 81 and 82 are expressed in radians: 
(A.l7) 
i(t) 
--..:~ 
!81 
mt 
Fig. A.17 
f.- 82 -! 

i(t) 
A.2 
General Piecewise Waveform 
811 
Ts 
10 J.!S 
Fig. A.18 
Example: an approximate transistor current waveform, including estimated current spike due to diode 
stored charge. 
Example 
A transistor current waveform contains a current spike due to the stored charge of a freewheel-
ing diode. The observed waveform can be approximated as shown in Fig. A1.18. Estimate the rms cur-
rent. 
The waveform can be divided into six approximately linear segments, as shown. The Dk and uk 
for each segment are 
1. Triangular segment: 
2. Constant segment: 
3. Trapezoidal segment: 
4. Constant segment: 
5. Triangular segment: 
6. Zero segment: 
Dl = (0.2 {tS)/(10 {tS) = 0.02 
D2 = (0.2 {tS)/(10 {tS) = 0.02 
D3 = (0.1 {tS)/(10 {tS) = 0.01 
D4 = (5 {tS)/(10 {tS) = 0.5 
D5 = (0.2 J.tS)/(10 J.tS) = 0.02 
u5 = 1;13 = (2 A)2/3 = 1.3 A2 

812 
RMS Values of Commonly Observed Converter Waveforms 
The rms value is 
(A.l8) 
Even though its duration is very short, the current spike has a significant impact on the rms value of the 
current-without the current spike, the rms current is approximately 2.0 A. 

Appendix B 
Simulation of Converters 
Computer simulation can be a powerful tool in the engineering design process. Starting from design 
specifications, an initial design typically includes selection of system and circuit configurations, as well 
as component types and values. In this process, component and system models are constructed based on 
vendor-supplied data, and by applications of analysis and modeling techniques. These models, validated 
by experimental data whenever possible, are the basis upon which the designer can choose parameter 
values and verify the achieved performance against the design specifications. One must take into account 
the fact that actual parameter values will not match their nominal values because of inevitable production 
tolerances, changes in environmental conditions (such as temperature), and aging. In the design verifica-
tion step, worst-case analysis (or other reliability and production yield analysis) is performed to judge 
whether the specifications are met under all conditions, i.e., for expected ranges of component parameter 
values. Computer simulation is very well suited for this task: using reliable models and appropriate sim-
ulation setups, the system performance can be tested for various sets of component parameter values. 
One can then perform design iterations until the worst-case behavior meets specifications, or until the 
system reliability and production yield are acceptably high. 
In the design verification of power electronic systems by simulation, it is often necessary to use 
component and system models of various levels of complexity: 
1. 
Detailed, complex models that attempt to accurately represent physical behavior of devices. Such models 
are necessary for tasks that involve finding switching times, details of switching transitions and switching 
loss mechanisms, or instantaneous voltage and current stresses. Component vendors often provide librar-
ies of such device models. To complete a detailed circuit model, one must also carefully examine effects of 
packaging and board interconnects. With fast-switching power semiconductors, simulation time steps of a 
few nanoseconds or less may be required, especially during on/off switching transitions. Because of the 
complexity of detailed device models, and the fine time resolution, the simulation tasks can be very time 
consuming. In practice, time-domain simulations using detailed device models are usually performed only 

814 
Simulation of Converters 
on selected parts of the system, and over short time intervals involving a few switching cycles at most. 
Devices for power converters, and detailed physical device modeling, are areas of active research and 
development beyond the scope of this book. 
2. 
Simplified device models. Since an on/off switching transition usually takes a small fraction of a switching 
cycle, the basic operation of switching power converters can be explained using simplified, idealized 
device models. For example, a MOSFET can be modeled as a switch with a small (ideally zero) on-resis-
tance Ron when on, and a very large off-resistance (ideally an open circuit) when off. Such simplified mod-
els yield physical insight into the basic operation of switching power converters, and provide the starting 
point for developments of analytical models described throughout this book. Simplified device models are 
also useful for time-domain simulations aimed at verifying converter and controller operation, switching 
ripples, current and voltage stresses, and responses to load or input transients. Since device models are 
simple, and details of switching transitions are ignored, tasks that require simulations over many switching 
cycles can be completed efficiently using general-purpose circuit simulators. In addition, specialized tools 
have been developed to support fast transient simulation of switching power converters based on idealized, 
piecewise-linear device models [1-7], or a combination of piecewise-linear and nonlinear models [8]. 
3. 
Averaged converter models. Averaged models that are well suited for prediction of converter steady-state 
and dynamic responses are discussed throughout this book. These models are essential design tools 
because they provide physical insight and lead to analytical results that can be used in the design process 
to select component parameter values for a given set of specifications. In the design verification step, sim-
ulations of averaged converter models can be performed to test for losses and efficiency, steady-state volt-
ages and currents, stability, and large-signal transient responses. Since switching transitions and ripples 
are removed by averaging, simulations over long time intervals and over many sets of parameter values 
can be completed efficiently. As a result, averaged models are also well suited for simulations of large 
electronic systems that include switching converters. Furthermore, since large-signal averaged models are 
nonlinear, but time-invariant, small-signal ac simulations can be used to generate various frequency 
responses of interest. Selected references on averaged converter modeling for simulation are listed at the 
end of this chapter [9-18]. 
Averaged models for computer simulation are covered in this appendix. Based on the material presented 
in Section 7.4, averaged switch models for computer simulation of converters operating in continuous 
conduction mode are described in Section B.l. Application examples include finding SEPIC de conver-
sion ratio and efficiency, and large-signal transient responses of a buck-boost converter. Section B.2 
describes an averaged switch model suitable for simulation of converters that may operate either in con-
tinuous conduction mode or in discontinuous conduction mode. Application examples include finding 
SEPIC open-loop frequency responses in CCM and DCM, loop-gain, phase margin and closed-loop 
responses of a buck voltage regulator, and current harmonics in a DCM boost rectifier. Based on the 
results from Chapter 12, a simulation model for converters with current programmed control is described 
in Section B.3, together with a buck converter example that compares control-to-output frequency 
responses with current programmed control against duty-cycle control. 
It is assumed that the reader is familiar with basics of Spice circuit simulations. All simulation 
models and examples in this appendix are prepared using the PSpice circuit simulator [19]. Netlists are 
included to help explain details of model implementation and simulation analysis options. Usually, 
instead of writing netlists, the user would enter circuit diagrams and analysis options from a front-end 
schematic capture tool. The examples and the library switch.lib of subcircuit models described in this 
appendix are available on-line. Similar models and examples can be constructed for use with other simu-
lation tools. 

B. I 
Averaged Switch Models for Continuous Conduction Mode 
815 
(a) 
(c) 
: ................. !?. ····················' 
(b) 
( v/t)) r 
s 
* Subcircuit: CCM1 
* Application: two-switch PWM converters 
* Limitations: ideal switches, CCM only, no transformer 
**************************************************************** 
* Parameters: none 
*Nodes: 
* 1: transistor positive (drain for an n-channel MOS) 
* 2: transistor negative (source for ann-channel MOS) 
* 3: diode cathode 
* 4: diode anode 
* 5: duty cycle control input 
**************************************************************** 
.subckt CCM1 1 2 3 4 5 
Et 1 2 value={(1-v(5))*v(3,4)/v(5)} 
Gd 4 3 value={(1-v(5))*i(Et)/v(5)} 
.ends 
Fig. B.l Averaged switch model CCMl: (a) the gen-
eral two-switch network: (b) symbol for the averaged 
switch subcircuit model; (c) PSpice netlist of the subcir-
cuit. 
B.l 
AVERAGED SWITCH MODELS FOR CONTINUOUS CONDUCTION MODE 
The central idea of the averaged switch modeling described in Section 7.4 is to identify a switch network 
in the converter, and then to find an averaged circuit model. The resulting averaged switch model can 
then be inserted into the converter circuit to obtain a complete model of the converter. An important fea-
ture of the averaged switch modeling approach is that the same model can be used in many different con-
verter configurations; it is not necessary to rederive an averaged equivalent circuit for each particular 
converter. This feature is also very convenient for construction of averaged circuit models for simulation. 
A general-purpose subcircuit represents a large-signal nonlinear averaged switch model. The converter 
averaged circuit for simulation is then obtained by replacing the switch network with this subcircuit. 
Based on the discussion in Section 7.4, subcircuits that represent CCM averaged switch models are 
described in this section, together with application examples. 
B.l.l 
Basic CCM Averaged Switch Model 
The large-signal averaged switch model for the general two-switch network of Fig. 7.39(a) is shown in 
Fig. 7.39(c). A PSpice subcircuit implementation of this model is shown in Fig. B.l. The subcircuit has 
five nodes. The transistor port of the averaged switch network is connected between the nodes 1 and 2, 
while the diode port is comprised of nodes 3 and 4. The duty ratio d = v(5) is the control input to the sub-
circuit at the node 5. The quantity v(5) is a voltage that is equal to the duty cycle, and that lies in the 
range zero to one volt. Figure B.l(c) shows the netlist of the subcircuit. The netlist consists of only four 
lines of code and several comment lines (the lines starting with *). The .subckt line defines the name 
(CCMl) of the subcircuit and the interface nodes. The value of the controlled voltage source E1, which 

816 
Simulation of Converters 
models the transistor port of the averaged switch network, is written according to Eq. (7 .136): 
(B.l) 
Note that v(3,4) in the subcircuit of Fig. B.l is equal to the switch network independent input (vit))Ts' 
Also, d(t) = v(5), and d'(t) = 1 - d(t) = 1 - v(5). The value of the controlled current source Gd, which 
models the diode port, is computed according to Eq. (7.137): 
(B.2) 
The switch network independent input (i1(t))Ts equals the current i(E1) through the controlled voltage 
source Er The .ends line completes the subcircuit netlist. The subcircuit CCM1 is included in the model 
library switch.lib. 
An advantage of the subcircuit CCM1 of Fig. B .1 is that it can be used to construct an averaged 
circuit model for simulation of any two-switch PWM converter operating in continuous conduction 
mode, subject to the assumptions that the switches can be considered ideal, and that the converter does 
not include a step-up or step-down transformer. The subcircuit can be further refined to remove these 
limitations. In converters with an isolation transformer, the right-hand side of Eqs. (B.1) and (B.2) 
should be divided by the transformer turns ratio. Inclusion of switch conduction losses is discussed in the 
next section. 
A disadvantage of the model in Fig. B.l is that Eqs. (B.1) and (B.2) have a discontinuity at duty 
cycle equal to zero. In applications of the subcircuit, it is necessary to restrict the duty-cycle to the range 
0 < Dmin $. d $. 1. 
Following the approach of this section, subcircuits can be constructed for the large-signal aver-
aged models of the buck switch network (see Fig. 7.50(a), and Eqs. (7.150)), and the boost switch net-
work (see Fig. 7.46(a) and Eqs. (7.146)). An advantage of these models is that their defining equations do 
not have the discontinuity problem at d = 0. 
B.1.2 
CCM Averaged Switch Model that Includes Switch Conduction Losses 
Let us modify the model of Fig. B.1 to include switch conduction losses. Figure B.2 shows simple device 
models that include transistor and diode conduction losses in the general two-switch network of 
Fig. B.l(a). The transistor is modeled as an ideal switch in series with an on-resistance Ron· The diode is 
modeled as an ideal diode in series with a forward voltage drop VD and resistance RD. 
Construction of de equivalent circuits to find de conversion ratio and efficiency of converters is 
discussed in Chapter 3. Derivation of an averaged switch model that includes conduction losses arising 
from Ron and VD is described in Section 7.4.5. Following the same averaged switch modeling approach, 
we can find the following relationships that describe the averaged switch model for the switch network of 
Fig. B.2: 
(B.3) 

B. I 
Averaged Switch Models for Continuous Conduction Mode 
817 
Fig. B.2 Switch network model that includes 
conduction loss elements Ron' Vv and Rv· 
(b) 
(a) 
( vz(t)) r 
s 
Fig. B.3 Subcircuit implementation of the 
CCM averaged switch model that includes 
conduction losses: (a) circuit symbol; (b) 
PSpice netlist for the subcircuit. 
' MODEL: CCM2 
• Application: two-switch PWM converters, includes 
• 
conduction losses due to Ron, VD, RD 
• Limitations: CCM only, no transformer 
************************************************************** 
• Parameters: 
Ron = transistor on-resistance 
VD = diode forward voltage drop 
RD = diode on-resistance 
*Nodes: 
* 1: transistor positive (drain for an n-channel MOS) 
* 2: transistor negative (source for ann-channel MOS) 
* 3: diode cathode 
* 4: diode anode 
* 5: duty cycle control input 
************************************************************** 
.subckt CCM2 1 2 3 4 5 
+params: Ron=O VD=O RD=O 
Er 1 1 x value={i(Et)*(Ron+(1-v(5))*RD/v(5))/v(5)} 
Et 1 x 2 value={(1-v(5))*(v{3,4)+VD)/v(5)} 
Gd 4 3 value={{1-v{5))*i(Et)/v(5)} 
.ends 
(B.4) 
A subcircuit implementation of the averaged switch model described by Eqs. (B.3) and (B.4) is shown in 
Fig. B.3 The subcircuit terminal nodes are the same as in the CCMl subcircuit: the transistor port is 
between the nodes 1 and 2; the diode port is between the nodes 3 and 4; the duty ratio d = v(S) is the con-

818 
Simulation of Converters 
4 
+ 
c2 
100 ~F 
v 
Rload 
son 
Fig. B.4 SEPIC simulation example. 
SEPJC DC conversion ratio and efficiency 
* Define parameters: 
.param Ron=O.O VD=0.8 RD=0.05 
* Analysis setup: 
.de lin Vc 0.1 1 0.01 
.step lin PARAM Ron 0 1 0.5 
* Converter nellis!: 
Vg 1 0 50V 
L 1 1 2x 800u 
RL1 2x 2 0.5 
L2 0 3x 100uH 
RL2 3x 3 0.1 
C1 2 3 100uF 
C2 4 0 100uF 
Xswitch 2 0 4 3 5 CCM2 
+params: Ron={Ron} VD={VD} RD={RD} 
Rload 4 0 50 
* Duty cycle input: 
Vc 50 0.5 
.lib switch.lib 
.probe 
.end 
trol input to the subcircuit at the node 5. Two controlled voltage sources in series, Er and E1, are used to 
generate the port 1 (transistor) averaged voltage according to Eq. (B.3). The controlled voltage source Er 
models the voltage drop across the equivalent resistance R0/d(t) + d'(t)RD/d2(t) in Eq. (B.3). Note that 
this equivalent resistance is a nonlinear function of the switch duty cycle d(t). The controlled voltage 
source £1 shows how the port 1 (transistor) averaged voltage depends on the port 2 (diode) averaged volt-
age. The controlled current source Gd models the averaged diode current according to Eq. (B.4). The 
subcircuit CCM2 has three parameters (Ron' V D' and RD) that can be specified when the subcircuit is used 
in a converter circuit. The default values of the subcircuit parameters, Ron= 0, VD = 0, and RD = 0, are 
defined in the .subckt line. These values correspond to the ideal case of no conduction losses. The subcir-
cuit CCM2 is included in the model library switch. lib. 
The model of Fig. B.3 is based on the simple device models of Fig. B.2. It is assumed that 
inductor current ripples are small and that the converter operates in continuous conduction mode. Many 
practical converters, however, must operate in discontinuous conduction mode at low duty cycles where 
the diode forward voltage drop is comparable to or larger than the output voltage. In such cases, the 
model of Fig. B.2, which includes VD as a fixed voltage generator, gives incorrect, physically impossible 
results for polarities of converter voltages and currents, losses and efficiency. 
B.1.3 
Example: SEPIC DC Conversion Ratio and Efficiency 
Let us consider an example of how the subcircuit CCM2 can be used to generate de conversion ratio and 
efficiency curves for a CCM converter. As an example, Figure B.4 shows a SEPIC averaged circuit 
model. The converter circuit can be found in Fig. 6.38(a), or in Fig. 7.37. To construct the averaged cir-
cuit model for simulation, the switch network is replaced by the subcircuit CCM2. In the converter netlist 
shown in Fig. B.4, the X,·wirch line shows how the subcircuit is connected to other parts of the converter. 
The switch duty cycle is set by the voltage source Vc. All other parts of the converter circuit are simply 
copied to the averaged circuit model. Inductor winding resistances Ru = 0.5 Q and RL2 = 0.1 Q are 

8.1 
Averaged Switch Models for Continuous Conduction Mode 
819 
(a) 
(b) 
100% 
11 
80% 
60% 
40% 
20% 
0% 
0 
0.2 
0.4 
0.6 
0.8 
D 
D 
Fig. B.S 
SEPIC simulation example: (a) de conversion ratio and (b) efficiency. 
included to model copper losses of the inductors L1 and L2, respectively. The switch conduction loss 
parameters are defined by the .param line in the netlist: Ron= 0, V0 = 0.8 V, R0 = 0.05 Q. Notice how 
these values are passed to the subcircuit CCM2 in the Xswitch line. In this example, all other losses in the 
converter are neglected. A de sweep analysis (see the .de line in the netlist) is set to vary the de voltage 
source Vc from 0.1 V to 1 V, in 0.01 V increments, which corresponds to varying the switch duty cycle 
over the range from D = 0.1 to D = 1. The range of duty cycles from zero to 0.1 is not covered because of 
the model discontinuity problem at D = 0 (discussed in Section B.l.l), and because the model predic-
tions for conduction losses at low duty cycles are not valid, as discussed in Section B .1.2. The de sweep 
analysis is repeated for values of the switch on-resistance in the range from Ron= 0 Q to Ron= 1 Q in 
0.5 Q increments (see the .step line in the netlist). The .lib line refers to the switch. lib library, which con-
tains definitions of the subcircuit CCM2 and all other subcircuit models described in this appendix. 
Simulation results for the de output voltage V and the converter efficiency 11 are shown in 
Fig. B.S. Several observations can be made based on the modeling approach and discussions presented in 
Chapter 3. At low duty cycles, efficiency drops because the diode forward voltage drop is comparable to 
the output voltage. At higher duty cycles, the converter currents increase, so that the conduction losses 
increase. Eventually, for duty cycles approaching 1, both the output voltage and the efficiency approach 
zero. Given a desired de output voltage and efficiency, the plots in Fig. B.5 can be used to select the tran-
sistor with an appropriate value of the on-resistance. 
B.1.4 
Example: Transient Response of a Buck-Boost Converter 
In addition to steady-state conversion characteristics, it is often of interest to investigate converter tran-
sient responses. For example, in voltage regulator designs, it is necessary to verify whether the output 
voltage remains within specified limits when the load current takes a step change. As another example, 
during a start-up transient when the converter is powered up, converter components can be exposed to 
significantly higher stresses than in steady state. It is of interest to verify that component stresses are 

820 
Simulation of Converters 
+ 
R 
v(t) 
20Q 
Fig. B.6 
Buck-boost converter example. 
within specifications or to make design modifications to reduce the stresses. In these examples, transient 
simulations can be used to test for converter responses. 
Transient simulations can be performed on the converter switching circuit model or on the con-
verter averaged circuit model. As an example, let us apply these two approaches to investigate a start-up 
transient response of the buck-boost converter shown in Fig. B.6. 
Figure B.7 shows a switching circuit model of the buck-boost converter. The inductor winding 
resistance RL is included to model the inductor copper losses. The MOSFET is modeled as a voltage-con-
trolled switch Sq1 controlled by a pulsating voltage source vc. The switch .model line specifies the switch 
on-resistance Ran= 50 mQ, and the switch off-resistance Rolf= 10 MQ. The switch is on when the con-
trolling voltage v c is greater than Von = 6 V, and off when the controlling voltage v c is less than V0ff = 4 V. 
The pulsating source vc has the pulse amplitude equal to 10 V. The period is Ts = 1/fs = 10 )ls, the rise and 
fall times are tr = t1 = 100 ns, and the pulse width is tP = 7.9 f-lS. The switch duty cycle is 
D = (tP + 0.5 (tr + t1))/Ts = 0.8. The built-in nonlinear Spice model is used for the diode. In the diode 
.model statement, only the parameter Is is specified, to set the forward voltage drop across the diode. The 
switch and the diode models used in this example are very simple. Conduction losses are modeled in a 
simple manner, and details of complex device behavior during switching transitions are neglected. 
3 
DI 
O.IQ 
RL 
vg 
4 
cl 
15V 
-
50~F 
15~H 
i(t) 
+ 
R 
v(t) 
20Q 
Buck-boost converter: switching circuit 
Vg1 015V 
Sq1 1 2 50 switch 
01 3 2 diode 
RL 2 4 0.1 
L1 4 0 15uH ic=O 
C1 3 0 50uF ic=O 
R 3020 
Vc 50 pulse 
+(0 1 OV Ous 1 OOns 1 OOns 7.9us 1 Ous) 
.model switch vswitch 
+(Ron=0.05 Roff=1 Omeg Von=6V Voff=4V) 
.model diode d (ls=1 e-12) 
.tran 1 u 1.2m Om 1 u uic 
.probe 
.end 
Fig. B.7 
Buck-boost converter simulation example, switching circuit model. 

2 
RL 
lSJ.lH 
i(t) 
B. I 
Averaged Switch Models for Continuous Conduction Mode 
821 
3 
+ 
c, 
v(t) 
SOJ.lF 
20Q 
Buck-boost converter, averaged circuit 
.lib switch.lib 
Vg 1 0 15V 
Xswitch 1 2 2 3 5 CCM2 
+ PARAMS: Ron=0.05 VD=0.8 RD=O 
RL 2 4 0.1 
L1 4 0 15uH ic=O 
C1 3 0 50uF ic=O 
R 3020 
Vc5 00.8 
.Iran 1 Ou 1.2m Om 1 Ou uic 
.probe 
.end 
Fig. B.S Buck-boost converter simulation example, averaged circuit model. 
Therefore, the circuit model of Fig. B.7 cannot be used to examine switching transitions or to predict 
switching losses in the converter. Nevertheless, basic switching operation is modeled, and a transient 
simulation can be used to find out how the converter waveforms evolve in time over many switching 
cycles. Transient simulation parameters are defined by the .tran line: the output time step is 1 ~-ts, the final 
simulation time is 1.2 ms, the output waveforms are generated from the start of simulation at time equal 
to zero, and the maximum allowed time step is 1 ~-ts. The uic ("use initial conditions") option tells the 
simulator to start with all capacitor voltages and inductor currents equal to the specified initial values. 
For example, ic=O in the L1 line sets the initial inductor current to zero. In Spice, the default initial condi-
tions are always zero, so that ic=O statements can be omitted. 
An averaged circuit model of the buck-boost converter is shown in Fig. B.S. This circuit model 
is obtained by replacing the switch network in the converter of Fig. B.6 by the CCM2 subcircuit. Notice 
that the circuits and the netlists of Figs. B.7 and Fig. B.8 are very similar. The only difference is that the 
switching devices in the converter circuit of Fig. B.7 are replaced by the CCM2 subcircuit Xswitch in 
Fig. B.S. Also, the pulsating source v/t) in the switching circuit is replaced by a constant voltage source 
vc equal to the switch duty cycleD= 0.8. 
The inductor current and the capacitor voltage waveforms during the start-up transient are 
shown in Fig. B.9. For comparison, the waveforms obtained by transient simulation of the switching con-
verter circuit shown in Fig. B.7, and by simulation of the averaged circuit model of Fig. B.8 are shown. 
Switching ripples can be observed in the waveforms obtained by simulation of the switching circuit 
model. The converter transient response is governed by the converter natural time constants. Since these 
time constants are much longer than the switching period, the converter start-up transient responses in 
Fig. B.9 take many switching cycles to reach the steady state. In the results obtained by simulation of the 
averaged circuit model, the switching ripples are removed, but the low-frequency portions of the con-
verter transient responses, which are governed by the natural time constants of the converter network, 
match very closely the responses obtained by simulation of the switching circuit. 
Based on the results shown in Fig. B.9, we can see that converter components are exposed to 
significantly higher current stresses during the start-up transient than during steady state operation. The 
problem of excessive stresses in the start-up transient is quite typical for switching power converters. 
Practical designs usually include a "soft-start" circuit, where the switch duty cycle is slowly increased 

822 
Simulation of Converters 
i(t) 
60A 
50 A 
40A 
30A 
20A 
lOA 
Waveform obtained by simulation 
of the averaged model 
/ 
Waveform obtained by simulation 
of the switching circuit model 
0~-------.-------.-------,-------,-------.-------. 
0 
v(t) 
lOY 
0 
-10 v 
-20V 
-30V 
-40V 
-50V 
0.2 ms 
0.4 ms 
0.6ms 
0.8 ms 
Waveform obtained by simulation 
of the averaged model 
Waveform obtained by simulation 
/of the switching circuit model 
1 ms 
1.2 ms 
-60V,_------.-------.-------,-------,------,,------, 
0 
0.2ms 
0.4ms 
0.6ms 
0.8 ms 
1 ms 
1.2 ms 
Fig. B.9 
Inductor current and output voltage waveforms obtained by transient simulation of the switching con-
verter circuit shown in Fig. B.7, and by simulation of the averaged circuit model of Fig. B.8 
from zero to the steady-state value to reduce start-up transient stresses. 
This simulation example illustrates how an averaged circuit model can be used in place of a 
switching circuit model to investigate converter large-signal transient responses. An advantage of the 
averaged circuit model is that transient simulations can be completed much more quickly because the 
averaged model is time invariant, and the simulator does not spend time computing the details of the fast 
switching transitions. This advantage can be important in simulations of larger electronic systems that 
include switching power converters. Another important advantage also comes from the fact that the aver-
aged circuit model is nonlinear but time-invariant: ac simulations can be used to linearize the model and 
generate small-signal frequency responses of interest. This is not possible with switching circuit models. 
Examples of small-signal ac simulations can be found in Sections B.2 and B.3. 
B.2 
COMBINED CCMIDCMAVERAGED SWITCH MODEL 
The models and examples of Section B.l are all based on the assumption that the converters operate in 
continuous conduction mode (CCM). As discussed in Chapters 5 and 11, all converters containing a 
diode rectifier operate in discontinuous conduction mode (DCM) if the load current is sufficiently low. In 
some cases, converters are purposely designed to operate in DCM. It is therefore of interest to develop 

(b) 
(a) 
i1 (t) ;································; i2(t) 
(c) 
: ................................ ! 
B.2 
Combined CCMIDCM Averaged Switch Model 
823 
i 
CCM 
L~~-:~~~:~-~-~~!.~~--'!!:q_~:L. 
(it(t))rs , .............................................. . 
+~-.;......., 
(p(t))r 
.....-t-+-o+ 
s 
--------... 
i 
DCM 
, 
i.~~::.~¥.:4..~-~~:~-~?.4.:~ . .! 
Fig. B.lO 
Summary of averaged switch modeling: (a) general two-switch network, (b) averaged switch model in 
CCM, and (c) averaged switch model in DCM. 
(it(t))rs r······························""""""""""""] 
+ 
0 
. 
CCM/DCM 
i 
! averaged switch model ! 
~--··············································! 
+ 
( Vz{t)) r_, 
Fig. B.ll A general averaged switch model 
using the equivalent switch conversion ratio 1-l· 
averaged models suitable for simulation of converters that may operate in either CCM or DCM. 
Figure B.lO illustrates the general two-switch network, and the corresponding large-signal aver-
aged models in CCM and DCM. The CCM averaged switch model, which is derived in Section 7.4, is an 
ideal transformer with ff : d turns ratio. In DCM, the large-signal averaged switch model is a loss-free 
resistor, as derived in Section 11.1. Our objective is to construct a combined CCM/DCM averaged switch 
model that reduces to the model of Fig. B.lO(a) or to the model of Fig. B.lO(c) depending on the operat-
ing mode of the converter. Let us define an effective switch conversion ratio 11-(t), so that the averaged 
switch model in both modes has the same form as in CCM, as shown in Fig. B.ll. If the converter oper-
ates in CCM, then the switch conversion ratio /L(t) is equal to the switch duty cycle d(t), 

824 
Simulation of Converters 
Jl=d 
(B.5) 
If the converter operates in DCM, then the effective switch conversion ratio can be computed so that the 
terminal characteristics of the averaged-switch model of Fig. B.11 match the terminal characteristics of 
the loss-free resistor model of Fig. B.lO(c). Matching the port 1 characteristics gives 
{B.6) 
which can be solved for the switch conversion ratio JL, 
(B.7) 
It can be verified that matching the port 2 characteristics of the models in Figs. B .1 0( c) and B .11 gives 
exactly the same result for the effective switch conversion ratio in DCM. 
The switch conversion ratio JL(t) can be considered a generalization of the duty cycle d(t) of 
CCM switch networks. Based on this approach, models and results developed for converters in CCM can 
be used not only for DCM but also for other operating modes or even for other converter configurations 
by simply replacing the switch duty cycle d(t) with the appropriate switch conversion ratio JL(t) [21-24]. 
For example, if M(d) is the conversion ratio in CCM, then M(JL), with JL given by Eq. (B.7), is the conver-
sion ratio in DCM. The switch conversion ratio in DCM depends on the averaged terminal voltage and 
current, as well as the switch duty cycle d through the effective resistance Re = 2L!d2T8• If the converter 
is completely unloaded, then the average transistor current (i1(t))Ts is zero, and the DCM switch conver-
sion ratio becomes JL = 1. As a result, the de output voltage attains the maximum possible value 
V = V8M(l ). This is consistent with the results of the steady-state DCM analyses in Chapter 5 and Sec-
tion 11.1. 
To construct a combined CCM/DCM averaged switch model based on the general averaged 
switch model of Fig. B.ll, it is necessary to specify which of the two expressions for the switch conver-
sion ratio to use: Eq. (B.S), which is valid in CCM, or Eq. (B.7), which is valid in DCM. At the CCM/ 
DCM boundary, these two expressions must give the same result, JL = d. If the load current decreases fur-
ther, the converter operates in DCM, the average switch current (i1(t))Ts decreases, and the DCM switch 
conversion ratio in Eq. (B.7) becomes greater than the switch duty cycle d. We conclude that the correct 
value of the switch conversion ratio, which takes into account operation in CCM or DCM, is the larger of 
the two values computed using Eq. (B.S) and Eq. (B.7). 
Figure B.12 shows an implementation of the combined CCM/DCM model as a PSpice subcir-
cuit CCM-DCMl. This subcircuit has the same five interface nodes as the subcircuits CCMl and CCM2 
of Section B.l. The controlled sources E1 and Gd model the port 1 (transistor) and port 2 (diode) averaged 
characteristics, as shown in Fig. B.ll. The switch conversion ratio JL is equal to the voltage v(u) at the 
subcircuit node u. The controlled voltage source Eu computes the switch conversion ratio as the greater 
of the two values obtained from Eqs. (B.S) and (B.7). The controlled current source Ga, the zero-value 
voltage source Va, and the resistor Ra form an auxiliary circuit to ensure that the solution found by the 
simulator has the transistor and the diode currents with correct polarities, (i1(t))Ts > 0, (i2(t))Ts > 0. The 
subcircuit parameters are the inductance L relevant for CCMIDCM operation, and the switching fre-
quency fs. The default values in the subcircuit are arbitrarily set to L = 100 f!H andfs = 100kHz. 
The PSpice subcircuit CCM-DCMl of Fig. B.l2 can be used for de, ac, and transient simula-

..-----------, (izCt)) r, 
+ 
( vz(t)) T 
s 
Fig. B.12 Implementation of the com-
bined CCM/DCM averaged switch model. 
B.2 
Combined CCM!DCM Averaged Switch Model 
825 
* MODEL: CCM-DCM1 
* Application: two-switch PWM converters, CCM or DCM 
• Limitations: ideal switches, no transformer 
* Parameters: 
L = equivalent inductance for DCM 
fs = switching frequency 
*Nodes: 
* 1: transistor positive (drain for an n-channel MOS) 
* 2: transistor negative (source for an n-channel MOS) 
* 3: diode cathode 
* 4: diode anode 
* 5: duty cycle control input 
.subckt CCM-DCM1 1 2 3 4 5 
+ params: L=1 OOu fs=1 E5 
Et 1 2 value={(1-v(u))*v(3,4)/v(u)} 
Gd 4 3 value={(1-v(u))*i(Et)/v(u)} 
Ga 0 a value={MAX(i(Et),O)} 
Vaab 
Ra b 0 1 k 
Eu u 0 table {MAX(v(5), 
+ v(5)*v(5)/(v(5)*v(5)+2*L*fs*i(Va)/v(3,4)))} (0 0) (1 1) 
.ends 
tions of PWM converters containing a transistor switch and a diode switch. This subcircuit is included in 
the model library switch. lib. It can be modified further for use in converters with isolation transformer. 
B.2.1 
Example: SEPIC Frequency Responses 
As an example, Fig. B.13 shows a SEPIC circuit and the averaged circuit model obtained by replacing 
the switch network with the CCM-DCMl subcircuit of Fig. B.l2. A part of the circuit netlist is included 
in Fig. B.13. The connections and the parameters of the CCM-DCMl subcircuit are defined by the Xswitch 
line. In the SEPIC, the inductance parameter L = 83.3 J.tH is equal to the parallel combination of L1 and 
L2• The voltage source vc sets the quiescent value of the duty cycle to D = 0.4, and the small-signal ac 
value to d = 1. Ac simulation is performed on a linearized circuit model, so that amplitudes of all small-
signal ac waveforms are directly proportional to the amplitude of the ac input, regardless of the input ac 
amplitude value. For example, the control-to-output transfer function is Gvd = Vld, where 0 = v( 4) in the 
circuit of Fig. B.13(b ). We can set the input ac amplitude to 1, so that the control-to-output transfer func-
tion Gvd can be measured directly as v(5). This setup is just for convenience in finding small-signal fre-
quency responses by simulation. For measurements of converter transfer functions in an experimental 
circuit (see Section 8.5), the actual amplitude of the small-signal ac variation d would be set to a fraction 
of the quiescent duty cycle D. Parameters of the ac simulation are set by the .ac line in the netlist: the sig-
nal frequency is swept from the minimum frequency of 5 Hz to the maximum frequency of 50 kHz in 
201 points per decade. 
Figure B.l4 shows magnitude and phase responses of the control-to-output transfer function 
obtained by ac simulations for two different values of the load resistance: R = 40 Q, for which the con-
verter operates in CCM, and R = 50 Q, for which the converter operates in DCM. For these two operating 

826 
Simulation of Converters 
points, the quiescent (de) voltages and currents in the circuit are nearly the same. Nevertheless, the fre-
quency responses are qualitatively very different in the two operating modes. In CCM, the converter 
exhibits a fourth-order response with two pairs of high-Q complex-conjugate poles and a pair of com-
plex-conjugate zeros. Another RHP (right-half plane) zero can be observed at frequencies approaching 
50 kHz. In DCM, there is a dominant low-frequency pole followed by a pair of complex-conjugate poles 
and a pair of complex-conjugate zeros. The frequencies of the complex poles and zeros are very close in 
value. A high-frequency pole and a RHP zero contribute additional phase lag at higher frequencies. 
In the design of a feedback controller around a converter that may operate in CCM or in DCM, 
one should take into account that the crossover frequency, the phase margin, and the closed-loop 
responses can be substantially different depending on the operating mode. This point is illustrated by the 
example of the next section. 
(a) 
120V 
(b) 
120V 
~ 
ill Ql 
D = 0.4 
!, =100kHz 
0 
SEPIC frequency response 
... other parts of the netlist omitted ... 
* duty cycle input: 
vc 5 0 de 0.4 ac 1 
* subcircuit 
Xswitch 2 0 4 3 5 CCM-DCM1 
+ PARAMS: L=83.3uH fs=100kHz 
.lib switch.lib 
* analysis setup: 
.ac dec 201 5 50kHz 
.end 
RL2 
0.02Q 
200 !!F 
4 
+ 
R 
v 
load 
+ 
200 !!F 
R 
v 
c2 
load 
X switch 
L = 83.31-!H 
J, =100kHz 
Fig. B.13 
SEPIC simulation example: (a) converter circuit, (b) averaged circuit model for simulation. 

B.2 
Combined CCM/DCM Averaged Switch Model 
827 
80dBV 
II Gvdll 
60dBV 
40dBV 
20dBV 
OdBV 
J\ 
R =40Q 
/ 
\ 
:; 
··············································- \/\. 
~ "·,_ 
I~ 
':--, 
o· 
-20dBV 
-90" 
-40dBV 
-180" 
-1-------+-----+-----t-------+-270" 
5Hz 
50Hz 
500Hz 
5kHz 
50kHz 
f 
Fig. B.14 Magnitude and phase responses of the control-to-output transfer function obtained by simulation of the 
SEPIC example, for two values of the load resistance. For R =50 Q, the converter operates in DCM (solid lines), and 
for R = 40 Q, the converter operates in CCM (dotted lines). 
B.2.2 
Example: Loop Gain and Closed-Loop Responses of a Buck Voltage Regulator 
A controller design for a buck converter example is discussed in Section 9.5.4. The converter and the 
block di<~;gram of the controller are shown in Fig. 9.22. This converter system is designed to regulate the 
de output voltage at V = 15 V for the load current up to 5 A. Let us test this design by simulation. An 
averaged circuit model of a practical realization of the buck voltage regulator described in Section 9.5.4 
is shown in Fig. B.15. The MOSFET and the diode switch are replaced by the averaged switch model 
implemented as the CCM-DCM1 subcircuit. The pulse-width modulator with V M = 4 V is modeled 
according to the discussion in Section 7.6 as a dependent voltage source Epwm controlled by the PWM 
input voltage vx. The value of Epwm is equal to l!V M = 0.25 times the PWM input voltage vx, with a limit 
for the minimum value set to 0.1 V, and a limit for the maximum value set to 0.9 V. The output of the 
pulse-width modulator is the control duty-cycle input to the CCM-DCM1 averaged switch subcircuit. 
Given the specified limits for Epwm• the switch duty cycle d(t) can take values in the range: 
(B.8) 
where Dmin = 0.1, and Dmax = 0.9. Practical PWM integrated circuits often have a limit Dmax < 1 for the 
maximum possible duty cycle. The voltage sensor and the compensator are implemented around an op-
amp LM324. With very large loop gain in the systei:n, the steady-state error voltage is approximately 
zero, i.e., the de voltages at the plus and the minus inputs of the op-amp are almost the same, 

828 
Simulation of Converters 
v(5) = vref 
(B.9) 
As a result, the quiescent (de) output voltage Vis set by the reference voltage v ref and the voltage divider 
comprised of Ri' R2, R4: 
(B.10) 
By setting the ac reference voltage v 
ref to zero, the combined transfer function of the voltage sensor and 
the compensator can be found as: 
1 
v 
R3+C 
H(s)G (s) =-f.= 
s 3 
c 
v 
1 
Rt+Rzll-c 
s 2 
This transfer function can be written in factored pole-zero form as 
where 
LM324 
Epwm 
value = {LIMIT(0.25 v x' 0.1, 0.9)} 
.nodeset v(3)=15 v(5)=5 v(6)=4.144 v(8)=0.536 
Fig. B.15 Buck voltage regulator example. 
(B.ll) 
(B.12) 
3 
+ 
v 

B.2 
Combined CCM/DCMAveraged Switch Model 
829 
G H 
RJ 
(B.l3) 
em = Rr+Rz 
J; = ~~· = 2n12C2 
(B.l4) 
ft.=;~= 2n1 C 
(B.lS) 
3 3 
and 
(B.l6) 
The design described in Section 9.5.4 resulted in the following values for the gain and the corner fre-
quencies: 
Gcn!f = 3.7 (113) = 1.23, J; = 1.7 kHz, A= 500Hz, JP = 14.5 kHz 
(B.l7) 
Eqs. (B.lO) and (B.l3) to (B.l7) can be used to select the circuit parameter values. Let us (somewhat 
arbitrarily) choose C2 = 1.1 nF. Then, from Eq. (B.l4), we have R2 = 85 kQ, and Eq. (B.16) yields 
R1 = 11 kQ. From Eq. (B.I3) we obtain R3 = 120 kQ, and Eq. (B.15) gives C3 = 2.7 kQ. Finally, 
R4 = 47 kQ is found from Eq. (B.1 0). The voltage regulator design can now be tested by simulations of 
the circuit in Fig. B.15. 
Loop gains can be obtained by simulation using exactly the same techniques described in Sec-
tion 9.6 for experimental measurement of loop gains [20]. Let us apply the voltage injection technique of 
Section 9.6.1. An ac voltage source vz is injected between the compensator output and the PWM input. 
This is a good injection point since the output impedance of the compensator built around the op-amp is 
small, and the PWM input impedance is very large (infinity in the circuit model of Fig. B.l5). With the 
ac source amplitude set (arbitrarily) to 1, and no other ac sources in the circuit, ac simulations are per-
formed to find the loop gain as 
0 
v(6) 
T(s)=+=--
vx 
v(7) 
(B.l8) 
To perform ac analysis, the simulator first solves for the quiescent (de) operating point. The circuit is 
then linearized at this operating point, and small-signal frequency responses are computed for the speci-
fied range of signal frequencies. Solving for the quiescent operating point involves numerical solution of 
a system of nonlinear equations. In some cases, the numerical solution does not converge and the simula-
tion is aborted with an error message. In particular, convergence problems often occur in circuits with 
feedback, especially when the loop gain at de is very large. This is the case in the circuit of Fig. B.15. To 
help convergence when the simulator is solving for the quiescent operating point, one can specify 
approximate or expected values of node voltages using the .nodeset line as shown in Fig. B.15. In this 
case, we know by design that the quiescent output voltage is close to 15 V (v(3) = 15), that the negative 
input of the op-amp is very close to the reference (v(5) = 5), and that the quiescent duty cycle is approxi-
mately D = V/Vg =0.536, so that v(8) = 0.536 V. Given these approximate node voltages, the numerical 
solution converges, and the following quiescent operating points are found by the simulator for two val-
ues of the load resistance R: 

830 
Simulation of Converters 
Fig. B.16 
Loop gain in the 
buck voltage regulator example. 
II Til 
60dB 
40dB 
20dB 
OdB 
-20dB 
-40dB 
5Hz 
50Hz 
500Hz 
5kHz 
f 
R = 3 Q, v(3) = 15.2 V, v(5) = 5.0 V, v(7) = 2.173 V, v(S) = 0.543 V, D = 0.543 
R = 25 Q, v(3) = 15.2 V, v(5) = 5.0 V, v(7) = 2.033 V, v(8) = 0.508 V, D = 0.508 
L.T 
00 
-90° 
-180° 
50kHz 
(B.l9) 
(B.20) 
For the nominal load resistance R = 3 Q, the converter operates in CCM, so that D = V/Vg. For R = 25 Q, 
the same de output voltage is obtained for a lower value of the quiescent duty cycle, which means that the 
converter operates in DCM. 
The magnitude and phase responses of the loop gain found for the operating points given by 
Eqs. (B.19) and (B.20) are shown in Fig. B.16. For R = 3 Q, the crossover frequency isfc = 5.3 kHz, and 
the phase margin is <PM= 4T, very close to the values lfc =5kHz, <PM= 52°) that we designed for in 
Section 9.5.4. At light load, for R = 25 Q, the loop gain responses are considerably different because the 
converter operates in DCM. The crossover frequency drops to fc = 390 Hz, while the phase margin is 
<!JM=5Y. 
The magnitude responses of the line-to-output transfer function are shown in Fig. B.l7, again 
for two values of the load resistance, R = 3 Q and R = 25 Q. The open-loop responses are obtained by 
braking the feedback loop at node 8, and setting the de voltage at this node to the quiescent value D of 
the duty cycle. For R = 3 Q, the open-loop and closed-loop responses can be compared to the theoretical 
plots shown in Fig. 9.32. At 100 Hz, the closed-loop magnitude response is 0.012 ==>- 38 dB. A 1 V, 
100Hz variation in vg(t) would induce a 12 mV variation in the output voltage v(t). For R = 25 Q, the 
closed loop magnitude response is 0.02 ==>- 34 dB, which means that the 1 V, 100Hz variation in vgCt) 
would induce a 20 mV variation in the output voltage. Notice how the regulator performance in terms of 
rejecting the input voltage disturbance is significantly worse at light load than at the nominal load. 
A test of the transient response to a step change in load is shown in Fig. B.18. The load current 
is initially equal to 1.5 A, and increases to iwAD = 5 A at t = 0.1 ms. When the converter is operated in 

Fig. B.17 
Line 
to 
output 
response of the buck voltage 
regulator. 
20dB 
II Gv8 II 
OdB 
-20dB 
-40dB 
-60dB 
B.2 
Combined CCMIDCM Averaged Switch Model 
831 
-SOdB+---------+---------4---------4----------+ 
5 Hz 
50Hz 
500Hz 
5kHz 
50kHz 
f 
16V 
v 
14V 
Open loop 
d(t) = constant 
0 
0.2 ms 
0.4 ms 
0.6 ms 
0.8 ms 
1.0 ms 
1.2ms 
1.4 ms 
1.6 ms 
1.8 ms 
2.0ms 
"W 
,,,., :: 
I 
I 
I 
I 
I 
I 
I 
I 
I 
I 
0 
0.2 ms 
0.4 ms 
0.6ms 
0.8 ms 
1.0 ms 
1.2ms 
1.4 ms 
1.6ms 
1.8 ms 
2.0 ms 
t 
Fig. B.18 
Load transient response of the buck voltage regulator example. 
open loop at constant duty cycle, the response is governed by the natural time constants of the converter 
network. A large undershoot and long lightly-damped oscillations can be observed in the output voltage. 
With the feedback loop closed, the controller dynamically adjusts the duty cycle d(t) trying to maintain 
the output voltage constant. The output voltage drops by about 0.2 V, and it returns to the regulated value 
after a short, well-damped transient. 
The voltage regulator example of Fig. B.l5 illustrates how the performance can vary signifi-
cantly if the regulator is expected to supply a wide range of loads. In practice, further tests would also be 
performed to account for expected ranges of input voltages, and variations in component parameter val-
ues. Design iterations may be necessary to ensure that performance specifications are met under worst 
case conditions. 

832 
Simulation of Converters 
L 
+ 
Epwm 
value= {LIMIT(0.5 vx, 0.1, 0.9)) L---....1...---C 
Fig. B.19 DCM boost rectifier example. 
B.2.3 
Example: DCM Boost Rectifier 
Converters switching at frequencies much above the ac line frequency can be used to construct near-ideal 
rectifiers where power is taken from the ac line without generation of line current harmonics. Approaches 
to construction of low-harmonic rectifiers are discussed in Chapter 18. One simple solution is based on 
the boost converter operating in discontinuous conduction mode, as described in Section 18.2.1. When a 
boost DCM converter operates at a constant switch duty cycle, the input current approximately follows 
the input voltage. The DCM effective resistance 2L!d2(t)Ts is an approximation of the emulated resis-
tance Re of the DCM boost rectifier. Ac line current harmonics are not zero, but the rectifier can still be 
designed to meet harmonic limits. In this section we consider a DCM boost rectifier example and test its 
performance by simulation. 
An averaged circuit model of the boost DCM rectifier is shown in Fig. B.19. Full-wave rectified 
120 Vrms, 50 Hz ac line voltage is applied to the input of the boost converter. The converter switches are 
replaced by the CCM-DCM1 averaged switch subcircuit. It is desired to regulate the de output voltage at 
V = 300 V at output power up to Pout= 120 W across the load R. The switching frequency is 
fs = 100kHz. Let us select the inductance L so that the converter always operates in DCM. From 
Eq. (18.24), the condition for DCM is: 
(B.21) 
where Re is the emulated resistance of the rectifier and V M is the peak of the ac line voltage. When line 

B.2 
Combined CCM/DCM Averaged Switch Model 
833 
305 v 
v(t) 
300V 
295VL-----r-----~--~----~-----+-----r-----r----~----,_--~ 
0 
2ms 
4ms 
6ms 
Sms 
!Oms 
12ms 
14ms 
16ms 
ISms 
20ms 
-2A 
Fig. B.20 
Output voltage and ac line current in the DCM boost rectifier example. 
current harmonics and losses are neglected, the rectifier emulated resistance Re at the specified load 
power Pis 
(B.22) 
Given V M = 170 V andRe found from Eq. (B.22), Eq. (B.21) gives L < 260 J.l.H. The selected inductance 
is L = 200 J.l.H. A low-bandwidth voltage feedback loop is closed around the converter to regulate the de 
output voltage. The output voltage is sensed and compared to the reference v ref' A PI compensator is con-
structed around the LM324 op-amp. The output vcontrol of the compensator is the input to the pulse-width 
modulator. By adjusting the switch duty ratio d, vcontrol adjusts the emulated resistance Re = 2Lid2Ts of 
the rectifier, and thereby controls the power taken from the ac line. In steady state, the input power 
matches the output power. The de output voltage Vis regulated at the value set by the reference voltage 
vrefand the voltage divider composed of R1 and R2, as follows: 
(B.23) 
Modeling of the low-bandwidth voltage regulation loop is discussed in Section 18.4.2. 
It is of interest to find ac line current harmonics. First, a long transient simulation is performed 
to reach steady-state operation. Then, current harmonics are computed using Fourier analysis applied to 
the ac line current waveform iaJt) during one line cycle in steady state. Figure B.20 shows the steady-
state ac line current and output voltage obtained for R = 900 Q, i.e., for 100 W of output power. The out-
put voltage has a de component equal to 300 V, and an ac ripple component at twice the line frequency. 
The peak-to-peak voltage ripple at twice the line frequency is approximately 8 V, which compares well 
with the value (7 V) found from Eq. (18.91). The ac line current has noticeable distortion. The spectrum 
of the ac line current is shown in Fig. B .21. The largest harmonic, the third, has an amplitude of 16.6% of 
the fundamental, and the total harmonic distortion is 16.7%. 
We can also examine what happens if the rectifier is overloaded. The steady-state ac line current 
waveform for the case when the load resistance is R = 500 Q, and the output power is 180 W, is shown in 

834 
Simulation of Converters 
Fig. 8.21 
Spectrum of the ac line 
current in the DCM boost rectifier. 
CCM operation 
4A 
2A 
-2A 
-4A 
-6A 
- SA 
20% 
THD = 16.7% 
3 
5 
7 
Harmonic number 
THD = 71% 
Fig. 8.22 Ac line current of the DCM boost rectifier example, when the output is overloaded. 
9 
20ms 
Fig. 8.22. The boost converter operates in CCM near the peak of the ac line voltage; this results in cur-
rent spikes and significant harmonic distortion. 
B.3 
CURRENT PROGRAMMED CONTROL 
In the current programmed mode (CPM), which is studied in Chapter 12, the transistor switching is con-
trolled so that the peak transistor current follows a control signal. The transistor duty cycle d(t) is not 
directly controlled, but depends on the CPM control input as well as on other converter voltages and cur-
rents. In this section, large-signal averaged relationships in CPM are written in a form suitable for imple-
mentation as a subcircuit for simulation. 
B.3.1 
Current Programmed Mode Model for Simulation 
Typical inductor current and voltage waveforms of CPM converters operating in continuous 
conduction mode or in discontinuous conduction mode are shown in Fig. 8 .23. Signal ic(t) is the CPM 
control input. An artificial ramp having slope - ma is added to the control input. In the first subinterval, 

B.3 Current Programmed Control 
835 
dT, 
(vt(t))r .. 
'-
0 
- (vz(t) )r 
t 
T, 
T, 
Fig. B.23 
Current programmed mode waveforms: (a) continuous conduction mode; (b) discontinuous conduction 
mode. 
when the transistor is on, the inductor current increases with.slope m1 given by: 
(B.24) 
It is assumed that voltage ripples are small so that the voltage v1(t) across the inductor is approximately 
equal to the averaged value (v1(t))r; The length of the first subinterval is d(t)T •. The transistor is turned 
off when the inductor current reaches the peak value ipk equal to: 
(B.25) 
In the second subinterval, when the transistor is off and the diode is on, the inductor current decreases 
with a negative slope- m2• With the assumption the voltage ripples are small, the slope m2 is given by: 
(B.26) 
The length of the second subinterval is d2(t)T •. In CCM, the second subinterval lasts until the end of the 
switching cycle. Therefore: 
d2 = 1-d 
(B.27) 
In DCM, the current drops to zero before the end of the switching period. The length of the second sub-
interval can be computed from: 

836 
Simulation of Converters 
Output: duty cycle d 
d 
CPM 
PARAMETERS: 
control 
current 
2 
Rtfs, L, Va 
Fig. B.24 Current programmed mode (CPM) subcircuit. 
(B.28) 
If the converter operates in DCM, d2 computed from Eq. (B.28) is smaller that 1- d. If the converter 
operates in CCM, 1- dis smaller than d2 computed from Eq. (B.28). In general, the length of the second 
subinterval can be found as the smaller of the two values computed using Eqs. (B.27) and (B.28). 
The average inductor current can be found by computing the area under the inductor current 
waveform in Fig. B.23: 
(. ( )) = d(. _ rn1dTs) 
d (. _ rn2d2Ts) 
lL t 
Ts 
lpk 
2 
+ 2 lpk 
2 
(B.29) 
The relationship given by Eq. (B.29) is valid for both CCM and DCM provided that the second subinter-
vallength is computed as the smaller of the values obtained from Eqs. (B.27) and (B.28). 
Based on Eqs. (B.24) to (B.29), an averaged CPM subcircuit model is constructed in the form 
shown in Fig. B.24. The inputs to the CPM subcircuit are the control input (vc(t))rs = JY(i/t))Ts, the mea-
sured inductor current R1(iL(t))Ts, and the inductor voltages (v1 (t))rs and (v2(t))Ts of the two subintervals. 
The output of the subcircuit is the switch duty cycle d. The parameters of the CPM subcircuit are the 
equivalent current-sense resistance R1, the inductance L, the switching frequency fs = 1/Ts, and the ampli-
tude va of the artificial ramp: 
(B.30) 
In the subcircuit implementation, the length of the second subinterval is computed as the smaller of the 
values given by Eqs. (B.27) and (B.28): 
( 
ipk ) 
d2 =MIN 1 - d, rnzTs 
(B.31) 
Next, the switch duty cycle is found by solving Eq. (B.29). There are many different ways the switch 
duty cycle can be expressed in terms of other quantities. Although mathematically equivalent to 
Eq. (B.29), these different forms of solving for d result in different convergence performance of the 
numerical solver in the simulator. In the CPM subcircuit available in the switch. lib library, the duty cycle 
is found from: 

B.3 
Current Programmed Control 
837 
L 
3 iL 
RL 
4 iLOAD 
0:05 .Q 
+ 
X switch 
c 
R 
100'" I 
v 
J, =200kHz 
10 .Q 
L= 35 ~H 
":" 
":" 
d 
.--------...1.--------, xcpm 
d 
R1= 1 n 
f, =200kHz 
CPM 
control 
current 
2 
L = 35 ~H 
1....--,----.-------.----,---' va = 0.6 v 
JYiL 
v(l)-v(3) 
v(3) 
E. 
l 
-
Fig. B.25 CPM buck converter example. 
(B.32) 
which is obtained by inserting Eq. (B.25) into Eq. (B:29). This implicit expression (notice that d is on 
both sides of the equation) is used by the numerical solver in the simulator to .compute the switch duty 
cycle d. 
B.3.2 
Example: Frequency Responses of a Buck Converter with Current Programmed Control 
To illustrate an application of the CPM subcircuit, let us consider the example buck converter circuit 
model of Fig. B.25. To construct this averaged circuit model, the switches are replaced by the CCM-
DCMl averaged switch subcircuit. The control input to the CPM subcircuit is the independent voltage 
source vc. Three dependent voltage sources are used to generate other inputs to the CPM subcircuit. The 
controlled voltage source E; is proportional to the inductor current iL' The controlled voltage source E1 is 
equal to v(l)- v(3), which is equal to the voltage (v1(t))r,applied across the inductor during the first sub-
interval when the transistor is on and the diode is off. The controlled voltage source E2 is equal to v(3), 
which is equal to the voltage (v2(t))r, applied across the inductor during the second .subinterval when the 
transistor is off and the diode is on. 
Ac simulations are performed at the quiescent operating point obtained for the de value of the 

838 
Simulation of Converters 
40dB 
II Gil 
LG 
20dB 
OdB 
-20dB 
-40dB 
o· 
-60dB 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
f 
Fig. B.26 Comparison of CPM control with duty-cycle control. for the control-to-output frequency response of 
the buck converter example. 
control input equal to Vc = 1.4 V. At the quiescent operating point, the switch duty cycle is D = 0.676, the 
de output voltage is V = 8.1 V, and the de component of the inductor current is I L = 0.81 A. The converter 
operates in CCM. 
Magnitude and phase responses of the control-to-output transfer functions Gvc(s) = Vlvc and 
GvJs) = Vld are shown in Fig. B.26. The duty-cycle to output voltage transfer function Gvis) exhibits the 
familiar second-order high-Q response. Peaking in the magnitude response and a steep change in phase 
from 0° to- 180° occur around the center frequency of the pair of complex-conjugate poles. In contrast, 
the CPM control-to-output response has a dominant low-frequency pole. The phase lag is around- 90° in 
a wide range of frequencies. A high frequency pole contributes to additional phase lag at higher frequen-
cies. The frequency responses of Fig. B.26 illustrate an advantage of CPM control over duty-cycle con-
trol. Because of the control-to-output frequency response dominated by the single low-frequency pole, it 
can be much easier to close a wide-bandwidth outer voltage feedback loop around the CPM controlled 
power converter than around a converter where the duty cycle is the control input. 
Another advantage of CPM control is in rejection of input voltage disturbances. Line-to-output 
frequency responses for duty-cycle control and CPM control in the buck example are compared in 
Fig. B.27. At practically all frequencies of interest, CPM control offers more than 30 dB better attenua-
tion of input voltage disturbances. 
It is also interesting to compare the output impedance of the converter with duty-cycle control 
versus CPM control. The results are shown in Fig. B.28. At low frequencies, duty-cycle controlled con-
verter has very low output impedance determined by switch and inductor resistances. As the frequency 
goes up, the output impedance increases as the impedance of the inductor increases. At the resonant fre-
quency of the output LC filter, significant peaking in the output impedance of the duty-cycle controlled 
converter can be observed. At higher frequencies, the output impedance is dominated by the impedance 
of the filter capacitor, which decreases with frequency. In the CPM controlled converter, the low-fre-
quency impedance is high. It is equal to the parallel combination of the load resistance and the CPM out-

20dB 
II G II 
Duty cycle control 
vg 
d(t) = constant 
OdB~------------------
-20dB 
-40 dB 1--------
-60 dB 
Current programmed mode 
v/t) =constant 
-80dB 
B.3 
Current Programmed Control 
839 
-100 dB +-----+-----+----.-.....,1--------+ 
10Hz 
100Hz 
1kHz 
10kHz 
100kHz 
f 
Fig. B.27 Comparison of CPM control with duty-cycle control, for the line-to-output frequency response of the 
buck converter example. 
20 dBQ 1------
11 Zout II 
OdBQ 
-20dBQ 
Duty cycle control 
d(t) = constant 
-40 dBQ +-------il-------+-----+------+ 
lOHz 
100Hz 
1kHz 
10kHz 
100kHz 
f 
Fig. B.28 Comparison of CPM control with duty-cycle control, for the output impedance of the buck converter 
example. 
put resistance. Because of the lossless damping introduced by CPM control, the series inductor does not 
affect the output impedance. As the frequency goes up, the output impedance becomes dominated by the 
output filter capacitor and it decreases with frequency. At high frequencies the output impedances of the 
duty-cycle and CPM controlled converters have the same asymptotes. 

840 
Simulation of Conv.ef1ers 
REFERENCES 
.[1] 
R. J. DIRKMAN, "The Simulatioo of General Circuits Containing Ideal Switches," IEEE Power Electronics 
Specialists Conference, 1987 Record, pp. 185-194. 
[2] 
C. J. HSIAO, R. B. RIDLEY, H. NAITOH and F. C. LEE, "Circuit-Oriented Discrete-Time Modeling and Sim-
ulatioo of Switching Converters, IEEE Power Electronics Specialists Confer:ence, 1987 record, pp. 167-
176. 
[3J 
R. C. WONG, H. A. OWEN, T. G. WILSON, "An Efficient Algorithm for the Time-Domain Simulation of 
Regulated Energy-Storage DC-to-DC Converters," IEEE Transactions on Power Electronics, Vol. 2, No. 2, 
April1987, pp. 154-168. 
[4] 
A.M. LUCIANO and A. G. M. STROLW, "A Fast Time-Domain Algorithm for Simulation of Switching 
Power Converters," IEEE Transactions on Power Electronics, Vol. 2, No.3, July 1990, pp. 363-370. 
£5] 
D. BEDROSIAN and J. VLACH, ''Time-Domain Analysis of Networks with Internally Controlled Switches," 
IEEE Transactions on Circuits and Systems-!: Fundamental Theory and Applications, Vol. 39, No.3, 
March 1992, pp. 199-212. 
[6] 
P. PEIOVIC and D. MAKSIMOVIC, "A New Algorithm for Simulation of Power Electronic Systems Using 
Piecewise-Linear Device Models," IEEE Transactions on Power Electronics, Vol. 10, No. 3, May 1995, 
pp. 340-348. 
[7] 
PREDRAG PEIOVIC, "A Method for Simulation of Power Electronic Systems Using Piecewise-Linear 
Device Models," Ph.D. thesis, University of Colorado, Boulder, April1995. 
[8] 
D. LI, R. TYMERSKI, T. NINOMIY A, "PECS-An Efficacious Solution for Simulating Switched Networks 
with Nonlinear Elements," IEEE Power Electronics Specialists Conference, 2000 Record, pp. 274-279, 
June 2000. 
[9] 
V. BELLO, "Computer Aided Analysis of Switching Regulators Using SPICE2," IEEE Power Electronics 
Specialists Conference, 1980 Record, pp. 3-11. 
[10] 
V. BELW, "Using the SPICE2 CAD Package for Easy Simulation of Switching Regulators in Both Con-
tinuous and Discontinuous Conduction Modes," Proceedings of the Eighth National Solid-State Power 
Conversion Conference (Powercon 8), April1981. 
[11] 
V. BELW, "Using the SPICE2 CAD Package to Simulate and Design the Current Mode Converter," Pro-
ceedings of the Eleventh National Solid-State Power Conversion Conference (Powercon 11), April1984. 
[12] 
D. KIMHI, S. BEN-YAAKOV, "A SPICE Model for Current Mode PWM Converters Operating Under Con-
tinuous Inductor Current Conditions," IEEE Transactions on Power Electronics, Vol. 6, No.2, April1991, 
pp. 281-286. 
[13] 
Y. AMRAN, F. HULIEHEL, S. BEN-YAAKOV, "A Unified SPICE Compatible Average Model of PWM Con-
verters," IEEE Transactions on Power Electronics, Vol. 6, No.4, October 1991, pp. 585-594. 
[14] 
S. BEN-YAAKOV, Z. GAATON, "Generic SPICE Compatible Model of Current Feedback in Switch Mode 
Converters, Electronics Letters, Vol. 28, No. 14, 2nd July 1992. 
[15] 
S. BEN-Y AAKOV, "Average Simulation of PWM Converters by Direct Implementation of Behavioral Rela-

References 
841 
tionships," IEEE Applied Power Electronics Conference, 1993 Record, pp. 510-516, February 1993. 
[16] 
S. BEN-YAAKOV, D. ADAR, "Average Models as Tools for Studying Dynamics of Switch Mode DC-DC 
converters," IEEE Power Electronics Specialists Conference, 1994 Record, pp. 1369-1376. 
[17] 
V. M. CANALLI, J. A. COBOS, J. A. OLIVER, J. UCEDA, "Behavioral Large Signal Averaged Model for DC/ 
DC Switching Power Converters," IEEE Power Electronics Specialists Conference, 1996 Record, 
pp. 1675-1681. 
[18] 
N. JAYARAM, D. MAKSIMOVIC, "Power Factor Correctors Based on Coupled-Inductor SEPIC and Cuk 
Converters with Nonlinear- Carrier Control," IEEE Applied Power Electronics Conference, 1998 Record, 
pp. 468-474, February 1998. 
[19] 
J. KEOWN, OrCAD ?Spice and Circuit Analysis, Fourth Edition, Englewood Cliffs: Prentice Hall, 2000. 
[20] 
P. W. TUINENGA, SPICE: A Guide to Circuit Simulation and Analysis Using ?Spice, Third Edition, Engle-
wood Cliffs: Prentice Hall, 1995. 
[21] 
V. VORPERIAN, "Simplified Analysis of PWM Converters Using the Model of the PWM Switch: Parts I 
and II," IEEE Transactions on Aerospace and Electronic Systems, Vol. AES-26, pp. 490-505, May 1990. 
[22] 
S. FREELAND and R. D. MIDDLEBROOK, "A Unified Analysis of Converters with Resonant Switches," 
IEEE Power Electronics Specialists Conference, 1987 Record, pp. 20-30. 
[23] 
ARTHUR WITULSKI and ROBERT ERICKSON, "Extension of State-Space Averaging to Resonant Switches 
-and Beyond," IEEE Transactions on Power Electronics, Vol. 5, No.1, pp. 98-109, January 1990. 
[24] 
D. MAKSIMOVIC and S. CuK, "A Unified Analysis of PWM Converters in Discontinuous Modes," IEEE 
Transactions on Power Electronics, Vol. 6, No.3, pp. 476-490, July 1991. 

AppendixC 
Middlebrook's 
Extra Element Theorem 
The Extra Element Theorem ofR. D. Middlebrook [1-3] shows how a transfer function is changed by the 
addition of an impedance to the network. The theorem allows one to determine the effects of this extra 
element on any transfer function of interest, without solving the system all over again. The Extra Ele-
ment Theorem is a powerful technique of design-oriented analysis. It leads to impedance inequalities 
which guarantee that an element does not substantially alter a transfer function. The Extra Element The-
orem is employed in Chapter 10, where it leads to a relatively simple methodology for designing input 
filters that do not degrade the loop gains of switching regulators. It is also employed in Section 19.4, to 
determine how the load resistance affects the properties of a resonant inverter. In this appendix, Middle-
brook's Extra Element Theorem is derived, based on the principle of superposition. Its application is 
illustrated via examples. 
C.l 
BASIC RESULT 
Consider the linear circuit of Fig. C.l(a). This network contains an input v;n(s) and an output v0u1(s). In 
addition, it contains a port whose terminals are open-circuited. It is assumed that the transfer function 
from V;n(s) to V0 u1(s) is known, and is given by 
(C.l) 
The Extra Element Theorem tells us how the transfer function G(s) is modified when an impedance Z(s) 
is connected between the terminals at the port, as in Fig. C.l(b). The result is 

844 
Middlebrook's Extra Element Theorem 
(a) 
Transfer function 
G(s) lz(s)~~ 
....-------.... 
Linear circuit 
Input 
Output 
Port 
Open-circuit 
(b) 
+ 
Transfer function 
G(s) 
....-------.... 
Linear circuit 
Input 
+ 
Fig. C.l 
How an added element changes a transfer function G(s): (a) original conditions, before addition of the 
new element; (b) addition of element having impedance Z(s). 
(a) 
Transfer function 
G(s) lz(s) ~ o 
....-------.... 
Linear circuit 
+ 
(b) 
Transfer function 
G(s) 
....-------.... 
Linear circuit 
+ 
Fig. C.2 The dual form of the Extra Element Theorem, in which the extra element replaces a short circuit: (a) orig-
inal conditions, (b) addition of element having impedance Z(s). 
( 
1 + ZN(s) ) 
V0js) _ G s 
Z(s) 
v;11(s) - ( 
( ) lz(s)~~) 
1 + ~ 
Z(s) 
(C.2) 
The right-hand side terms involving Z(s) account for the influence of Z(s) on G(s), and are known as the 
correction factor. 
The Extra Element Theorem also applies to the dual form illustrated in Fig. C.2. In this form, 
the transfer function is initially known under the conditions that the port is short-circuited. In 
Fig. C.2(b ), the short-circuit is replaced by the impedance Z(s). In this case, the addition of the imped-
ance Z(s) causes the transfer function to become 
(C.3) 

C. I 
Basic Result 
845 
(a) 
Linear circuit 
+ 
i(s) 
(b) 
Linear circuit 
i(s) 
Fig. C.3 Determination of the quantities ZJ..s) and Z0 (s): (a) Z0 (s) is the Thevenin-equivalent impedance at the 
port, and is measured with the input v;n(s) set to zero; (b) ZN(s) is the impedance seen at the port under the condition 
that the output is nulled. 
The ZN(s) and ZD(s) terms in Eqs. (C.2) and (C.3) are identical. By equating the G(s) expressions of 
Eqs. (C.2) and (C.3), one can show that 
G(s) lz(s)~~ 
Z 0 (s) 
G( ) [ 
ZN(s) 
S 
Z(s)~ 0 
This is known as the reciprocity relationship. 
(C.4) 
The quantities ZJs) and ZD(s) can be found by measuring impedances at the port. The term 
ZD(s) is the Thevenin equivalent impedance seen looking into the port, also known as the driving-point 
impedance. As illustrated in Fig. C.3(a), this impedance is found by setting the independent source v;n(s) 
to zero, and then measuring the impedance between the terminals of the port: 
v(s) I 
Zo(s) = i(s) 
"'in(s)=O 
(C.5) 
Thus, ZD(s) is the impedance between the port terminals when the input v;Js) is set to zero. 
Determination of the impedance ZN(s) is illustrated in Fig. C.3(b). The term ZJs) is found 
under the conditions that the output v0Js) is nulled to zero. A current source i(s) is connected to the ter-
minals of the port. In the presence of the input signal v;Js), the current i(s) is adjusted so that the output 
vouis) is nulled to zero. Under these conditions, the quantity ZN(s) is given by 

846 
Middlebrook's Extra Element Theorem 
(C.6) 
Note that nulling the output is not the same as shorting the output. If one simply shorted the output, then 
a current would flow through the short, which would induce voltage drops and currents in other elements 
of the network. These voltage drops and currents are not present when the output is nulled. The null con-
dition of Fig. C.3(b) does not employ any connections to the output of the circuit. Rather, the null condi-
tion employs the adjustment of the independent sources v;n(s) and i(s) in a special way that causes the 
output v0ut(s) to be zero. By superposition, v0u1(s) can be expressed as a linear combination of V;n(s) and 
i(s); therefore, for a given V;n(s), it is always possible to choose an i(s) that will cause V0ut(s) to be zero. 
Under these null conditions, ZN(s) is measured as the ratio of v(s) to i(s). In practice, the circuit analysis 
to find ZJs) is simpler than analysis of Z0 (s), because the null condition causes many of the signals 
within the circuit to be zero. Several examples are given in Section C.4. 
The input and output quantities need not be voltages, but could also be currents or other signals 
that can be set or nulled to zero. The next section contains a derivation of the Extra Element Theorem 
with a general input u(s) and output y(s). 
C.2 
DERIVATION 
Figure C.4(a) illustrates a general linear system having an input u(s) and an output y(s). In addition, the 
system contains an electrical port having voltage v(s) and current i(s), with the polarities illustrated. Ini-
tially, the port is open-circuited: i(s) = 0. The transfer function of this system, with the port open-cir-
cuited, is 
y(s) I 
Gold(s) = u(s) . 
l(s);O 
(C.7) 
The objective of the extra element theorem is to determine the new transfer function G(s) that is obtained 
when an impedance Z(s) is connected to the port: 
G(s) = y(s) 
u(s) 
(C.8) 
The situation is illustrated in Fig. C.4(b). It can be seen that the conditions at the port are now given by 
(b) 
(a) 
Linear network 
Linear network 
u(s) 
y(s) 
u(s) 
Input 
Output 
Input 
Port 
i(s) 
i(s) 
Open-circuit 
Fig. C.4 Modification of a linear network by addition of an extra element: (a) original system, (b) modified sys-
tem, witb impedance Z(s) connected at an electrical port. 

Fig. C.S 
Current injection at the electrical port, by addition 
of independent current source i(s). 
v(s) =- i(s)Z(s) 
u(s) 
Input 
C.2 Derivation 
847 
Linear network 
y(s) 
Output 
Port 
+ v(s) -
i(s) 
(C.9) 
To express the new transfer function G(s) in Eq. (C.8) in terms of the original transfer function G01is) of 
Eq. (C.7), we use current injection at the port, as illustrated in Fig. C.5. There are now two independent 
inputs: the input u(s) and the independent current source i(s). The dependent quantities y(s) and v(s) can 
be expressed as functions of these independent inputs using the principle of superposition: 
where 
y(s) = Go1is)u(s) + G;(s)i(s) 
v(s) = G,(s)u(s) + ZD(s)i(s) 
y(s) I 
Gozd(s) = u(s) . 
1(s)=O 
y(s) I 
G,(s) = i(s) 
v(s) I 
ZD(s) = i(s) 
u(s)=O 
u(s)=O 
G (s) = v(s) I 
v 
u(s) i(s)=O 
(C.lO) 
(C.ll) 
(C.l2) 
(C.l3) 
(C.14) 
(C.l5) 
are the transfer functions from the independent inputs to the respective dependent quantities y(s) and 
v(s). 
The transfer function G(s) can be found by elimination of v(s) and i(s) from the system of equa-
tions (C.9) to (C.ll), and solution for y(s) as a function of u(s). The result is 
G(s) = y(s) = G (s) _ G,(s)G1(s) 
u(s) 
old 
Z(s) + ZD(s) 
(C.l6) 
This intermediate result expresses the new transfer function G(s) as a function of the original transfer 
function G0 ld(s) and the extra element Z(s), as well as the quantities ZD(s), Gv(s), and G;(s). 

848 
Middlebrook's Extra Element Theorem 
Equation (C.l4) gives a direct way to find the quantity ZD(s). ZD(s) is the driving-point imped-
ance at the port, when the input u(s) is set to zero. This quantity can be found either by conventional cir-
cuit analysis or simulation, or by laboratory measurement. 
Although GJs) and G/s) could also be determined from the definitions (C.l3) and (C.l5), it is 
preferable to eliminate these quantities, and instead express G(s) as a function of the impedances at the 
given port. This can be accomplished via the following thought experiment. In the presence of the input 
u(s), we adjust the independent current source i(s) in the special way that causes the output y(s) to be 
nulled to zero. The impedance Ztf..s) is defined as the ratio of v(s) to i(s) under these null conditions: 
(C.l7) 
The value of i(s) that achieves the null condition y(s) ;;-;;0 0 can be found by setting y(s) = 0 in Eq. (C.lO), 
as follows: 
(C.l8) 
Hence, the output y(s) is nulled when the inputs u(s) and i(s) are related as follows: 
( ) I 
G;(s) 
·c ) I 
US 
=---lS 
y(s)~O 
Gold(s) 
y(s)~O 
(C.l9) 
Under this null condition, the voltage v(s) is given by 
(C.20) 
which follows from Eqs. (C.ll) and (C.l9). Substitution of Eq. (C.l7) into Eq. (C.20) yields 
(C.21) 
Hence, 
z ( ) = z ( ) _ Gy(s)G;(s) 
N s 
D s 
Gotis) 
(C.22) 
Solution for the quantity GJs)Gi(s) yields 
(C.23) 
Thus, the unknown quantities GJs) and Gi(s) can be related to ZN(s) and ZD(s), which are properties of 
the port at which the new impedance Z(s) will be connected, and to the original transfer function G otis). 
The final step is to substitute Eq. (C.23) into Eq. (C.l6), leading to 

C.J Discussion 
849 
This expression can be simplified as follows: 
(C.25) 
or, 
(C.26) 
This is the desired result. It states how the transfer function G(s) is modified by addition of the extra ele-
ment Z(s). The right-most term in Eq. (C.26) is called the correction factor; this term gives a quantitative 
measure of the change in G(s) arising from the introduction of Z(s). 
Derivation of the dual result, Eq. (C.3), follows similar steps. 
C.3 
DISCUSSION 
The general form of the extra element theorem makes it useful for designing a system such that 
unwanted circuit elements do not degrade the desirable system performance already obtained. For exam-
ple, suppose that we already know some transfer function or similar quantity G(s), under simplified or 
ideal conditions, and have designed the system such that this quantity meets specifications. We can then 
use the extra element theorem to answer the following questions: 
What is the effect of a parasitic element Z(s) that was not included in the original analysis? 
What happens if we later decide to add some additional components having impedance Z(s) to the 
system? 
Can we establish some conditions on Z(s) that ensure that G(s) is not substantially changed? 
A common application of the extra element theorem is the determination of conditions on the extra ele-
ment that guarantee that the transfer function G(s) is not significantly altered. According to Eqs. (C.2) 
and (C.26), this will occur when the correction factor is approximately equal to unity. The conditions are: 
II Z(}m) II » 
II Z N(}w) II 
II Z(jm) II » II Z v(}w) II 
(C.27) 
This gives a formal way to show when an impedance can be ignored: one can plot the impedances 
II ZN(jw) II and II ZD(jw) 11. and compare the results with a plot of II Z(jw) 11. The impedance Z(s) can be 
ignored over the range of frequencies where the inequalities (C.27) are satisfied. 
For the dual case in which the new impedance is inserted where there was previously a short cir-
cuit, Eq. (C.3), the inequalities are reversed: 

850 
Middlebrook's Extra Element Theorem 
II Z(jw) II~ II ZN(jw) II 
II Z(jw) II~ II Zo(jW) II 
(C.28) 
This equation shows how to limit the magnitude II Z(jro) II, to avoid significantly changing the transfer 
function G(s). 
For quantitative design, Eqs. (C.27) and (C.28) raise an additional question: By what factor 
should II Z(jro) II exceed (or be less than) II ZN(jw) II and II Zv(jffi) II, in order for the inequalities of Eq. 
(C.27) or (C.28) to be well satisfied? This question can be answered by plotting the magnitudes and 
phases of the correction factor terms, as a function of the magnitudes imd phases of (Z/ZN) and (Z/Zv)· 
Figure C.6 shows contours of constant Ill + ZIZN II, as a function of the magnitude and phase of 
Z!Zw Figure C.7 shows similar contours of constant L(l + ZIZN). It can be seen that, when II ZIZN II is 
less than -20 dB, then the maximum deviation caused by the numerator (1 + ZIZN) term is less than 
±1 dB in magnitude, and less than ± 7' in phase. For II ZIZN II less than- 10 dB, the maximum deviation 
caused by the numerator (1 + ZIZN) term is less than± 3.5 dB in magnitude, and less than± 20° in phase. 
Figures C.8 and C.9 contain contours of constant II 1/(1 + Z/Zv)ll and Ll/(1 + ZIZv), respec-
tively, as a function of the magnitude and phase of ZIZv. These plots contain minus signs because the 
terms appear in the denominator of the correction factor; otherwise, they are identical to Figs. C.6 and 
C.7. Again, for II Z/ZD II less than- 20 dB, the maximum deviation caused by the denominator (1 + ZIZv) 
term is less than ± 1 dB in magnitude, and less than ± 7' in phase. For II Z!Zv II less than - 10 dB, the 
maximum deviation caused by the denominator (1 + ZIZv) term is less than ± 3.5 dB in magnitude, and 
less than ± 20° in phase. 
C.4 
EXAMPLES 
C.4.1 
A Simple Transfer Function 
The first example illustrates how the Extra Element Theorem can be used to find a transfer function 
essentially by inspection. We are given the circuit illustrated in Fig. C.lO. It is desired to solve for the 
transfer function 
(C.29) 
and to express this transfer function in factored pole-zero form. One way to do this is to employ the Extra 
Element Theorem, treating the capacitor Cas an "extra" element. As illustrated in Fig. C.ll, the electri-
cal port is taken to be at the location of the capacitor, and the "original conditions" are taken to be the 
case when the capacitor impedance is infinite, i.e., an open circuit. Under these original conditions, the 
transfer function is given by the voltage divider composed of resistors R 1, R3, and R4 • Hence, G(s) can be 
expressed as 
(C.30) 

C.4 
Examples 
851 
lOdB 
II iN L 5dB ~~~:;::--+--t---+-~~~ 
OdB 
OdB 
-30dB +-~---+--~~------+------+----~------+-~---+--~~ 
-180° 
-135° 
-90° 
-45° 
oo 
45° 
90° 
135° 
180° 
L__Z__ 
ZN 
Fig. C.6 
Contours of constant Ill + ZIZN II. as a function of the magnitude and phase of ZIZN' 
lliNL 
10dB 
5 dB 
OdB 
-5 dB 
-lOdB 
-15 dB 
-20dB 
-25 dB 
-30dB 
-180° 
-135° 
-90° 
-45° 
oo 
45° 
90° 
135° 
180° 
L__Z__ 
ZN 
Fig. C.7 
Contours of constant .L(l + ZIZN), as a function of the magnitude and phase of ZIZN. 

852 
Middlebrook's Extra Element Theorem 
10dB 
II fD L 5 dB ~~~;;;;;:::------t-------t-----r-~~~ 
-10 dB 
-15 dB 
OdB 
OdB 
-30dB +-~--~-----+----~------~----+-----~----~----~ 
-180° 
-135° 
-90° 
-45° 
oo 
45° 
135° 
180° 
L_L 
Zv 
Fig. C.S 
Contours of constant Ill!( 1 + Z!Zv) II, as a function of the magnitude and phase of Z!Zv 
~fDL 
lOdB 
5 dB 
OdB 
-5 dB 
-10 dB 
-15 dB 
-20dB 
-25 dB 
-30 dB 
-180° 
-135° 
-90° 
-45° 
oo 
45° 
90° 
135° 
180° 
Fig. C.9 
Contours of constant Ll/(1 + Z!Zv), as a function of the magnitude and phase of Z!Zv. 

C.4 Examples 
853 
+ 
v1(s) 
v2(s) 
Fig. C.lO R-C circuit example of Section C.4.1. 
where Z(s) is the capacitor impedance 1/sC. 
The impedance ZD(s) is the Thevenin equivalent impedance seen at the port where the capacitor 
is connected. As illustrated in Fig. C.l2(a), this impedance is found by setting the independent source 
v1(s) to zero, and then determining the impedance between the port terminals. The result is: 
(C.31) 
Figure C.l2(b) illustrates determination of the impedance ZJ..s). A current source i(s) is con-
nected to the port, in place of the capacitor. In the presence of the input v1(s), the current source i(s) is 
adjusted so that the output v2(s) is nulled. Under these null conditions, the impedance ZJ..s) is found as 
the ratio of v(s) to i(s). 
It is easiest to find ZN(s) by first determining the effect of the null condition on the signals in the 
circuit. Since v2 is nulled to zero, there is no current through the resistor R4• Since R3 is connected in 
series with R4, there is also no current through R3, and hence no voltage across R3• Therefore, the voltage 
v3 in Fig. C.l2(b) is equal to v2, i.e., 
Therefore, the voltage vis given by iR2. The impedance ZN is 
Fig. C.ll Manipulation of the circuit 
of Fig. C.lO into the form of Fig. C.l. 
v1(s) 
Linear circuit 
r·---------~~-------------------------------~:-------------------------1 
i 
j______________ _ ___________ !!_?_:.~------------ _________________________ ] 
i (s) 
+ 
v(s) 
c 
(C.32) 
+ 
v2(s) 

854 
Middlebrook's Extra Element Theorem 
(a) 
(b) 
r··---------~-:-------------------------------~:-----------------------
"'v 
R ~ 
2 <; 
, 
port 
i 
L------------ ---------------------------------- -------------------------..! 
port 
! 
------------ ---------------------------------- -------------------------..! 
+ 
v(s) 
i (s) 
+ 
+ 
v(s) I 
ZN(s) = i(s) v ~a= Rz 
2 null 
Fig. C.12 Measurement of the 
quantities Ztf_s) and ZD(s): (a) deter-
mination of ZD(s), (b) determination 
of ZN(s). 
(C.33) 
Note that, in general, the independent sources v1 and i are nonzero during the ZN measurement. For this 
example, the null condition implies that the current i(s) flows entirely through the path composed of R2, 
Rp and v1• 
The transfer function G(s) is found by substitution ofEqs. (C.31) and (C.33) into Eq. (C.30): 
(C.34) 
For this example, the result is obtained in standard normalized pole-zero form, because the capacitor is 
the only dynamic element in the circuit, and because the "original conditions," in which the capacitor 
impedance tends to an open circuit, coincide with de conditions in the circuit. A similar procedure can be 

C.4 
Examples 
855 
applied to write the transfer function of a circuit, containing an arbitrary number of reactive elements, in 
normalized form via an extension of the Extra Element Theorem [3]. 
C.4.2 
An Unmodeled Element 
We are told that the transformer-isolated parallel resonant inverter of Fig. C.13 has been designed with 
the assumption that the transformer is ideal. The approximate sinusoidal analysis techniques of Chapter 
19 were employed to model the inverter. It is now desired to specify a transformer; this requires that lim-
its be specified on the minimum allowable transformer magnetizing inductance. One way to approach 
this problem is to view the transformer magnetizing inductance as an extra element, and to derive condi-
tions that guarantee that the presence of the transformer magnetizing inductance does not significantly 
change the tank network transfer function G(s). 
Figure C.14 illustrates the equivalent circuit model of the inverter, derived using the approxi-
mate sinusoidal analysis technique of Section 19.1. The switch network output voltage vs(t) is modeled 
by its fundamental component vs1(t), a sinusoid. The tank transfer function G(s) is given by: 
+ 
Fig. C.13 Parallel resonant inverter example. 
L 
Transfer function 
G(s) 
1 : n 
(C.35) 
+ 
vJs) 
R 
+ 
vJs) 
R 
Fig. C.14 Equivalent circuit model of the tank network, based on the approximate sinusoidal analysis technique. 

856 
Middlebrook's Extra Element Theorem 
(a) 
L 
1: n 
c 
(b) 
L 
1: n 
+ 
R 
Fig. C.lS Measurement of Ztfs) and ZD(s): (a) determination of ZD(s), (b) determination of Ztfs). 
Under the conditions that the transformer is ideal (i.e., the transformer magnetizing inductance LM is 
open circuited), then the transfer function is given by: 
(C.36) 
We can therefore employ the extra element theorem to determine how finite magnetizing inductance 
changes G(s). With reference to Fig. C.l, the system input is v51(s), the output is the voltage v0(s), and the 
"port" is the primary winding of the transformer, where the magnetizing inductance is connected. In the 
presence of the magnetizing inductance, the transfer function becomes 
(C.37) 
where Z(s) is the impedance of the magnetizing inductance referred to the primary winding, sLM. 
Figure C.15(a) illustrates determination of Z0 (s). The input source V51(s) is set to zero, and the 
impedance between the terminals of the port is found. It can be seen that the impedance Z0 (s) is the par-
allel combination of the impedances of the tank inductor, tank capacitor, and the reflected load resis-
tance: 
R 
1 
Zv(s) = n2 II sL II sC 
(C.38) 
Figure C.15(b) illustrates determination of ZN(s). In the presence of the input source v51(s), a 
current i(s) is injected at the port as shown. This current is adjusted such that the output v 0(s) is nulled. 
Under these conditions, the quantity ZN(s) is given by v(s)/i(s). It can be seen that nulling v0 (s) also nulls 
the voltage v(s). Therefore, 

C.4 Examples 
857 
Fig. C.l6 To avoid significantly changing the 
transfer function G( s ), the transformer should be 
designed such that II Z II ~ II Z0 11. 
(C.39) 
Note that, in general, i(s) will not be equal to zero during the ZJs) measurement. The null condition is 
achieved by setting the source i(s) equal to the value- vs1(s)/sL. Thus, in the presence of finite magnetiz-
ing inductance, the transfer function G(s) can be expressed as follows: 
(C.40) 
We can now plot the impedance inequalities (C.27) that guarantee that the magnetizing induc-
tance does not substantially modify G(s). The ZD(s) given in Eq. (C.38) is the impedance of a parallel 
resonant circuit. Construction of the magnitude of this impedance is described in Section 8.3.4, with 
results illustrated in Fig. C.l6. To avoid affecting the transfer function G(s), the impedance of the mag-
netizing inductance must be much greater than II ZD(jw) II over the range of expected operating frequen-
cies. It can be seen that this will indeed be the case provided that the impedance of the magnetizing 
inductance is greater than the impedances of both the tank inductance and the reflected load impedance: 
where w0 = li(JLf;). These conditions can be further reduced to 
LM ~ L, and 
LM ~ ~ .;rc 
n 
C.4.3 
Addition of an Input Filter to a Converter 
(C.41) 
(C.42) 
As discussed in Chapter 10, the addition of an input filter to a switching regulator can significantly alter 
its loop gain T(s). Hence, it is desirable to design the input filter so that it does not substantially change 

858 
Middlebrook's Extra Element Theorem 
..--- H(s)-----.... 
Input 
filter 
Converter 
Fig. C.17 Addition of an input filter to a switching voltage regulator system. 
the converter control-to-output transfer function Gvis). The Extra Element Theorem can provide design 
criteria that show how to design such an input filter. 
Figure C.l7 illustrates the addition of an input filter to a switching voltage regulator system. 
The control-to-output transfer function of the converter power stage is given by: 
G ( ) = v(s) I 
vd S 
" 
d(s) Og(,)=O 
(C.43) 
The quantity Z0(s) is the Thevenin equivalent output impedance of the input filter. Upon setting vgCs) to 
zero in Fig. C.l7, the system of Fig. C.l8 is obtained. It can be recognized that this system is of the 
same form as Fig. C.2, in which the "extra element" is the output impedance Z0(s) of the added input fil-
ter. With no input filter [Z0 (S) == 0], the "original" transfer function Gvis)!Zo(s) = 0 is obtained. In the pres-
ence of the input filter, Gvd(s) is expressed according to Eq. (C.3): 
(C.44) 
where 
(C.45) 
Converter 
Fig. C. IS Determination of the control-to-output transfer 
Z0(s) 
function Gvis) for the system of Fig. C.l7. 
d 

C.4 Examples 
859 
is the impedance seen looking into the power input port of the converter when J is set to zero, and 
(C.46) 
is the impedance seen looking into the power input port of the converter when the converter output v is 
nulled. The null condition is achieved by injecting a test current source itest at the converter input port, in 
the presence of J variations, and adjusting itest such that vis nulled. Derivation of expressions for ZJ,..s) 
and Zv(s) for a buck converter example is described in Section 10.3.1. 
According to Eq. (C.28), the input filter does not significantly affect Gvis) provided that 
~ Z0(jOJ) II «I ZN(jw) ~ 
I ZoUro) II «II Zv(jm) ~ 
(C.47) 
These inequalities can provide an effective set of criteria for designing the input filter. Bode plots of 
II ZJJw) II and II Zv(jw) II are constructed, and then the filter element values are chosen to satisfy (C.47). 
Several examples of this procedure are explained in Chapter 10. 
C.4.4 
Dependence of Transistor Current on Load 
in a Resonant Inverter 
The conduction loss caused by circulating tank currents is a major problem in resonant converter design. 
These currents are independent of, or only weakly dependent on, the load current, and lead to poor effi-
ciency at light load. The origin of this problem is the weak dependence of the tank network input imped-
ance on the load resistance. For example, Fig. C.l9 illustrates the model of the ac portion of a resonant 
inverter, derived using the sinusoidal approximation of Section 19.1. The resonant network contains the 
tank inductors and capacitors of the converter, and the load is the resistance R. The current i.(t) flowing in 
the effective sinusoidal source is equal to the switch current. This model predicts that the switch current 
i.(s) is equal to v.1(s)IZ/s), where Z;(s) is the input impedance of the resonant tank network. If we want 
the switch current to track the load current, then at the switching frequency II Z; II should be dominated 
by, or at least strongly influenced by, the load resistance R. Unfortunately, this is often not consistent 
with other requirements, in which Z; is dominated by the impedances of the tank elements. To design a 
resonant converter that exhibits good properties, the engineer must develop physical insight into how the 
load resistance R affects the tank input impedance and output voltage. 
Fig. C.l9 Resonant inverter model. 
Transfer function 
H(s) 
~ 
i.(t) 
i(t) 
Resonant 
network 
+ 
Z; 
zo 
v(t) 
-
-
Purely reactive 
Effective 
resistive 
load 
R 

860 
Middlebrook's Extra Element Theorem 
i(t) 
+ 
Resonant 
network 
+ 
"tl zo 
"Extra" 
vs1(t) 
Cl 
v(t) 
element 
::t -
R 
Input 
Output 
Fig. C.20 Application of the Extra Element Theorem to the system of Fig. C.l9, to expose the dependence of 
Z;(s) onR. 
To expose the dependence of Z/s) on the load resistance R, we can treat R as the "extra" ele-
ment as in Fig. C.20. The input impedance Z/s) is viewed as the transfer function from the current is to 
the voltage vs1; in this sense, is is the "input" and vs1 is the "output." Equations (C.2) and (C.3) then imply 
that Z;(s) can be expressed as follows: 
(C.48) 
Here, the impedance Z;o(s) is 
(C.49) 
i.e., the input impedance Z;(s) when the load terminals are shorted. Likewise, the impedance Z;~(s) is 
(C.50) 
which is the input impedance Z;(s) when the load is disconnected (open circuited). 
Determination of ZJs) and Zv(s) is illustrated in Fig. C.21. The quantity ZJ_s) is found by null-
ing the "output" vs1 to zero, and then solving for v(s)li(s). The quantity Z,fs) coincides with the conven-
tional output impedance Z0 (s) illustrated in Fig. C.19. In Fig. C.21(a), the act of nulling vs1 is equivalent 
to shorting the source v,1 of Fig. C.l9. In Section 19.4, the quantity ZN(s) is denoted Z00(s), because it 
coincides with the converter output impedance with the switch network shorted. 
The quantity Zv(s) is found by setting the "input" i, to zero, and then solving for v(s)li(s). The 
quantity Zv(s) coincides with the output impedance Z/s) illustrated in Fig. C.19, under the conditions 
that the source vs1 is open-circuited. In Section 19.4, the quantity Zv(s) is denoted Z~(s), because it coin-
cides with the converter output impedance with the switch network open-circuited. 
The reciprocity relationship, Eq. (C.4), becomes 
(C.51) 
The above results are used in Section 19.4 to expose how conduction losses and the zero-voltage switch-
ing boundary depend on the loading of a resonant converter. 

References 
861 
(a) 
+ 
Resonant 
network 
+ 
i.(t) 
v,it) ;;;t 0 
'"tl· 
ZN 
v(t) 
C) 
;::[ -
Input 
Output 
(b) 
+ 
Resonant 
network 
+ 
v,it) 
~ ZD 
v(t) 
;::[ -
Fig. C.21 
Determination of the quantities Ztf..s) and Zn(s) for the network of Fig. C.20: (a) finding Ztf..s), 
(b) finding Zv(s). 
REFERENCES 
[1] 
R. D. MIDDLEBROOK, "Null Double Injection and the Extra Element Theorem," IEEE Transactions on 
Education, vol. 32, No.3, Aug. 1989, pp. 167-180. 
[2] 
R. D. MIDDLEBROOK, "The Two Extra Element Theorem," IEEE Frontiers in Education Conference Pre-
ceedings, Sept. 1991, pp. 702-708. 
[3] 
R. D. MIDDLEBROOK, V. VORPERIAN, AND J. LINDAL, "TheN Extra Element Theorem," IEEE Transac-
tions on Circuits and Systems 1: Fundamental Theory and Applications, Vol. 45, No. 9, Sept. 1998, pp. 
919-935. 

Appendix D 
Magnetics Design Tables 
Geometrical data for several standard ferrite core shapes are listed here. The geometrical constant K8 is a 
measure of core size, useful for designing inductors and transformers that attain a given copper loss [1]. 
The Kg method for inductor design is described in Chapter 14. K8 is defined as 
K _ A~WA 
g- MLT 
(D.l) 
where Ac is the core cross-sectional area, WA is the window area, and MLT is the winding mean-length-
per-tum. The geometrical constant Kgfe is a similar measure of core size, which is useful for designing ac 
inductors and transformers when the total copper plus core loss is constrained. The Kgfe method for mag-
netics design is described in Chapter 15. Kgfe is defined as 
W A2(t-tl~l 
K 
_ 
A 
c 
u(R) 
gfe-
MLT e 21~ 
~--' 
"' 
(D.2) 
where em is the core mean magnetic path length, and ~ is the core loss exponent: 
(D.3) 
For modem ferrite materials, ~typically lies in the range 2.6 to 2.8. The quantity u(~) is defined as 
(D.4) 

864 
Magnetics Design Tables 
u(~) is equal to 0.305 for~= 2.7. This quantity varies by roughly 5% over the range 2.6::; ~::; 2.8. Values 
of Kgfe are tabulated for~= 2.7; variation of Kgfe over the range 2.6::; ~::; 2.8 is typically quite small. 
Thermal resistances are listed in those cases where published manufacturer's data are available. 
The thermal resistances listed are the approximate temperature rise from the center leg of the core to 
ambient, per watt of total power loss. Different temperature rises may be observed under conditions of 
forced air cooling, unusual power loss distributions, etc. Listed window areas are the winding areas for 
conventional single-section bobbins. 
An American Wire Gauge table is included at the end of this appendix. 
D.l 
POT CORE DATA 
8 
A [ 
. 0 
r·••• • ••• r-, • • ••••···~ · · · ······· 
~ 
IH 
····················· 
Fig. D.l 
Core 
Geometrical 
Geometrical 
Cross-
Bobbin 
Mean 
Magnetic 
Thermal 
Core 
type 
constant 
constant 
sectional 
winding 
length 
path 
resistance 
weight 
area 
area 
per turn 
length 
(A H) 
Kg 
Kgfe 
Ac 
WA 
MLT 
em 
R,h 
(mm) 
cm5 
cmx 
(cm2) 
(cm2) 
(em) 
(em) 
CC!W) 
(g) 
704 
0.738·10 6 
1.61·10 6 
0.070 
0.22·10-3 
1.46 
1.0 
0.5 
905 
0.183·W 3 
256·W 6 
0.101 
0.034 
1.90 
1.26 
1.0 
1107 
0.667· 10- 3 
554· 10- 6 
0.167 
0.055 
2.30 
1.55 
1.8 
1408 
2.107-10- 3 
1.1·10- 3 
0.251 
0.097 
2.90 
2.00 
100 
3.2 
1811 
9.45· 10- 3 
2.6·10- 3 
0.433 
0.187 
3.71 
2.60 
60 
7.3 
2213 
27.1· 10-3 
4.9· 10- 3 
0.635 
0.297 
4.42 
3.15 
38 
13 
2616 
69.1· 10- 3 
8.2· 10- 3 
0.948 
0.406 
5.28 
3.75 
30 
20 
3019 
0.180 
14.2·10- 3 
1.38 
0.587 
6.20 
4.50 
23 
34 
3622 
0.411 
2J.no- 3 
2.02 
0.748 
7.42 
5.30 
19 
57 
4229 
1.15 
41.1·10- 3 
2.66 
1.40 
8.60 
6.81 
13.5 
104 

D.2 
EE Core Data 
865 
D.2 
EECOREDATA 
.· . 
. ·. ·.· .. 
I 
A 
I 
Fig. D.2 
Core 
Geometrical 
Geometrical 
Cross-
Bobbin 
Mean 
Magnetic 
Core 
type 
constant 
constant 
sectional 
winding 
length 
path 
weight 
area 
area 
per turn 
length 
(A) 
Kg 
Kgfe 
Ac 
WA 
MLT 
e, 
(mm) 
(cm5) 
(cmx) 
(cm2) 
(cm2) 
(em) 
(em) 
(g) 
EE12 
0.731·10- 3 
0.458· w- 3 
0;)4 
0.085 
2.28 
2.7 
2.34 
EE16 
2.02·10- 3 
0.842·10- 3 
0.19 
0.190 
3.40 
3.45 
3.29 
EE19 
4.07-1 o- 3 
1.3·10- 3 
0.23 
0.284 
3.69 
3.94 
4.83 
EE22 
8.26·10- 3 
1.8·10- 3 
0.41 
0.196 
3.99 
3.96 
8.81 
EE30 
85.7-10- 3 
6.no- 3 
1.09 
0.476 
6.60 
5.77 
32.4 
EE40 
0.209 
11.8·10-3 
1.27 
1.10 
8.50 
7.70 
50.3 
EE50 
0.909 
28.4·10- 3 
2.26 
1.78 
10.0 
9.58 
116 
EE60 
1.38 
36.4·10- 3 
2.47 
2.89 
12.8 
11.0 
135 
EE70/68/19 
5.06 
75.9·10- 3 
3.24 
6.75 
14.0 
18.0 
280 

866 
Magnetics Design Tables 
D.3 
EC CORE DATA 
A 
Fig. D.3 
Core 
Geometrical 
Geometrical 
Cross-
Bobbin 
Mean 
Magnetic 
Thermal 
Core 
type 
constant 
constant 
sectional 
winding 
length 
path 
resistance 
weight 
area 
area 
per turn 
length 
(A) 
K g 
Kgfe 
Ac 
WA 
MLT 
em 
R,, 
(mm) 
(cm5) 
(em) 
(cm2) 
(cm2) 
(em) 
(em) 
('C!W) 
(g) 
EC35 
0.131 
9.9·10 3 
0.843 
0.975 
5.30 
7.74 
18.5 
35.5 
EC41 
0.374 
19.5·10- 3 
1.21 
1.35 
5.30 
8.93 
16.5 
57.0 
EC52 
0.914 
31.7-10- 3 
1.80 
2.12 
7.50 
10.5 
11.0 
111 
EC70 
2.84 
56.2·10- 3 
2.79 
4.71 
12.9 
14.4 
7.5 
256 
D.4 
ETD CORE DATA 
A 
Fig. D.4 
Core 
Geometrical 
Geometrical 
Cross-
Bobbin 
Mean 
Magnetic 
Thermal 
Core 
type 
constant 
constant 
sectional 
winding 
length 
path 
resistance 
weight 
area 
area 
per turn 
length 
(A) 
Kg 
Kgfe 
Ac 
WA 
MLT 
em 
R,, 
(mm) 
(cm5) 
(em) 
(cm2) 
(cm2) 
(em) 
(em) 
('C/W) 
(g) 
ETD29 
0.0978 
8.5·10 3 
0.76 
0.903 
5.33 
7.20 
30 
ETD34 
0.1 93 
13.1·10- 3 
0.97 
1.23 
6.00 
7.86 
19 
40 
ETD39 
0.397 
19.8·10- 3 
1.25 
1.74 
6.86 
9.21 
15 
60 
ETD44 
0.846 
30.4·10- 3 
1.74 
2.13 
7.62 
10.3 
12 
94 
ETD49 
1.42 
41.0·10- 3 
2.11 
2.71 
8.51 
11.4 
II 
124 

D.5 PQ Core Data 
867 
D.S 
PQCOREDATA 
.. -......... 
-~ ............. 
::::::::cJ 
A, 
----------.!·········· ·-
2D 
Fig. 0.5 
Core 
Geometrical 
Geometrical 
Cross-
Bobbin 
Mean 
Magnetic 
Core 
type 
constant 
constant 
sectional 
winding 
length 
path 
weight 
area 
area 
per turn 
length 
(A/2D) 
K g 
K gfe 
Ac 
WA 
MLT 
e, 
(mm) 
(cm5) 
(cmx) 
(cm2) 
(cm2) 
(em) 
(em) 
(g) 
PQ 20116 
22.4·10-3 
3.7·10"3 
0.62 
0.256 
4.4 
3.74 
13 
PQ 20/20 
33.6·10-3 
4.8·10"3 
0.62 
0.384 
4.4 
4.54 
IS 
PQ 26/20 
83.9·10"3 
7.2·10"3 
1.19 
0.333 
5.62 
4.63 
31 
PQ 26/25 
0.125 
9.4·10"3 
1.18 
0.503 
5.62 
5.55 
36 
PQ 32/20 
0.203 
11.7·10"3 
1.70 
0.471 
6.71 
5.55 
42 
PQ 32/30 
0.384 
18.6·10"3 
1.61 
0.995 
6.71 
7.46 
55 
PQ 35/35 
0.820 
30.4-10-3 
1.96 
1.61 
7.52 
8.79 
73 
PQ 40/40 
1.20 
39.1·10"3 
2.01 
2.50 
8.39 
10.2 
95 

868 
Magnetics Design Tables 
D.6 
AMERICAN WIRE GAUGE DATA 
AWG# 
Bare area, 
Resistance, 
Diameter, 
w- 3 cm2 
w- 6 Q/cm 
em 
0000 
1072.3 
1.608 
1.168 
000 
850.3 
2.027 
1.040 
00 
674.2 
2.557 
0.927 
0 
534.8 
3.224 
0.825 
424.1 
4.065 
0.735 
2 
336.3 
5.128 
0.654 
3 
266.7 
6.463 
0.583 
4 
211.5 
8.153 
0.519 
5 
167.7 
10.28 
0.462 
6 
133.0 
13.0 
0.411 
7 
105.5 
16.3 
0.366 
8 
83.67 
20.6 
0.326 
9 
66.32 
26.0 
0.291 
10 
52.41 
32.9 
0.267 
11 
41.60 
41.37 
0.238 
12 
33.08 
52.09 
0.213 
13 
26.26 
69.64 
0.190 
14 
20.02 
82.80 
0.171 
15 
16.51 
104.3 
0.153 
16 
13.07 
131.8 
0.137 
17 
10.39 
165.8 
0.122 
18 
8.228 
209.5 
0.109 
19 
6.531 
263.9 
0.0948 
20 
5.188 
332.3 
0.0874 
21 
4.116 
418.9 
0.0785 
22 
3.243 
531.4 
0.0701 
23 
2.508 
666.0 
0.0632 
24 
2.047 
842.1 
0.0566 
25 
1.623 
1062.0 
0.0505 
26 
1.280 
1345.0 
0.0452 
27 
1.021 
1687.6 
0.0409 
28 
0.8046 
2142.7 
0.0366 
29 
0.6470 
2664.3 
0.0330 

References 
869 
Continued 
AWG# 
Bare area, 
Resistance, 
Diameter, 
10-3 cm2 
10- 6 Q/cm 
em 
30 
0.5067 
3402.2 
0.0294 
31 
0.4013 
4294.6 
0.0267 
32 
0.3242 
5314.9 
0.0241 
33 
0.2554 
6748.6 
0.0236 
34 
0.2011 
8572.8 
0.0191 
35 
0.1589 
10849 
0.0170 
36 
0.1266 
13608 
0.0152 
37 
0.1026 
16801 
0.0140 
38 
0.08107 
21266 
0.0124 
39 
0.06207 
27775 
0.0109 
40 
0.04869 
35400 
0.0096 
41 
0.03972 
43405 
0.00863 
42 
O.o3166 
54429 
0.00762 
43 
0.02452 
70308 
0.00685 
44 
0.0202 
85072 
0.00635 
REFERENCES 
[1] 
C. W. T. MCLYMAN, Transformer and Inductor Design Handbook, Second edition, New York: Marcel 
Dekker, 1988. 
[2] 
Ferrite Materials and Components Catalog, Philips Components. 

Index 
Air gap 
in coupled inductor, 529, 551, 553 
in flyback transformer, 530,559 
in inductor, 499-501, 525-526, 539-542, 544 
in transformer, 504 
AL (mH/1000 turns), 545 
American wire gauge (AWG) 
data, 868-869 
design examples, 557, 560, 575, 580 
Amorphous alloys, 507 
Ampere's law, 493-494 
Amp-second balance (see Capacitor charge balance) 
Apparent power, 598 
Artificial ramp 
circuit, 446 
effect on CPM boost low-harmonic rectifier, 654-
656 
effect on line-to-output transfer function of CCM 
buck, 466-469 
effect on small-signal CCM models, 459-466 
effect on small-signal DCM models, 473-480 
effect on stability of CPM controllers, 444-449 
Asymptotes (see Bode plots) 
Audiosusceptibility G v/s) (see Line-to-output transfer 
function) 
Average current control 
feedforward, 650-652 
in low-harmonic rectifier systems, 648-654 
modeling of, 652-654 
Averaged switch modeling, 226-247 
of current-programmed CCM converters, 454-459 
of current-programmed DCM converters, 473-480 
in discontinuous conduction mode, 410-431 
equivalent circuit modeling of conduction losses, 
242-244, 816-818 
equivalent circuit modeling of switching losses, 
244-247 
examples 
nonideal buck converter, 244-247 
nonideal buck-boost converter, 242-244 
CCM SEPIC, 228-235 
of ideal CCM switch networks, 226-241, 815-816, 
822-825 
of ideal DCM switch networks, 416, 822-825 
of quasi-resonant converters, 768-790 
Average power 
and Fourier series, 590-593 
modeled by power source element, 414-418, 454-
459, 473-480 
in nonsinusoidal systems, 590-603 
predicted by averaged models, 56 
power factor, 594-598 
sinusoidal phasor diagram, 598-599 
Averaging 
approximation, discussion of, 189-190, 194-196 
averaged switch modeling, 226-247 
basic approach, 192-204 
capacitor charge balance, 21-22 
circuit, 226-247 
to find de component, 5, 14 
ftyback ac model, 209-218 
inductor volt-second balance, 20-21 
introduction to, 187-192 
modeling efficiency and loss via, 56 
to model rectifier output, 668-670 
to model 30 converters, 685-690 
of quasi-resonant converters, 768-790 
state-space, 213-226 
Ballast, electronic 705-707 

872 
Index 
resonant inverter design, 726-740 
Battery charger, 8, 70 
B-Hloop 
in an ac inductor, 527-528 
in a conventional transformer, 148, 528 
in a coupled inductor, 529-530 
in a filter inductor, 526-527 
in a flyback transformer, 530-531 
modeling of, 494-495 
Bidirectional de-de converters, 70 
Bipolar junction transistor (BJT) 
breakdown mechanisms in, 85-86 
construction and operation of, 81-86 
current crowding, 84-85 
Darlington-connected, 86 
idealized switch characteristics, 65-66 
on resistance, 52, 81-82 
quasi-saturation, 82, 85 
storage time, 84 
stored minority charge in, 81-85 
switching waveforms, 82-84 
Bode plots (see also Harmonic trap filters, Sinusoidal 
approximation) 
asymptote analytical equations, 281 
CCM buck-boost example, 294-299 
combinations, 278-281 
complex poles, 282-286 
frequency inversion, 277-278 
graphical construction of, 302-317 
addition, 303-307 
closed-loop transfer functions, 337-340 
division, 311-313 
parallel combination, 308-310 
parallel resonance, 309-310 
series resonance, 305-307 
impedance graph paper, 310 
nonminimum phase zero, 276 
reactance graph paper, 310 
real pole, 269-274 
real zero, 27 5 
RHP zero, 276 
transfer functions of buck, boost, buck-boost, 300 
Body diode (see MOSFET) 
Boost converter (see also Bridge configuration, Push-
pull isolated converters) 
active switch utilization in, 173,676 
averaged switch model, DCM, 419-420 
circuit-averaged model, 235-239 
current -programmed 
averaged switch model, CCM, 455-456 
averaged switch model, DCM, 477 
small-signal ac model, CCM, 458-459, 460-463, 
469-470 
small-signal ac model, DCM, 478-480 
as inverted buck converter, 132-133 
as low-harmonic rectifier, 642-646, 648-663, 666, 
674-685, 832-834 
nonideal analysis of, 42-49, 52-56 
quasi-resonant ZCS, 778-779 
simulation example, 832-834 
small-signal ac model 
CCM, 204-205,252-253 
DCM, 424-429 
steady-state analysis of, 
CCM, 22-27 
DCM, 117-124 
transfer functions, CCM, 300 
Bridge configuration (de-de converters) 
boost -derived full bridge, 165~ 166 
buck-derived full bridge, 149-152 
buck-derived half bridge, 152-154 
full bridge transformer design example, 576-580 
minimization of transformer copper loss in, 549-550 
Bridge configuration (inverters) 
single phase, 7-8, 138-141, 143-145 
three phase, 70, 141-143 
Buck-boost converter (see also Fly back converter) 
averaged switch model, DCM, 410-420 
as cascaded buck and boost converters, 134-136 
current-programmed 
averaged switch model, DCM, 473-477 
more accurate model, CCM, 461-463 
simple model, CCM, 450-454 
small-signal ac model, DCM, 478-480 
dc-3(21ac inverter, 71-72 
DCM characteristics, 112, 124-125, 420 
as low-harmonic rectifier, 645-646, 650 
manipulation of ac model into canonical form, 250-
252 
nonideal, state-space averaged model of, 221-226 
noninverting version, 135, 143-144 
as rotated three-terminal cell, 137 
simulation of, 819-822 
small-signal ac model, CCM, 204-205, 252-253 
small-signal ac model, DCM, 420-425 
transfer functions, CCM, 294-300 
transformer isolation in, 161-165 
Buck converter (see also Bridge configuration, Forward 
converter, Push-pull isolated converters), 5-6, 13-22, 
31-33 
active switch utilization in, 173 
averaged switch model, 239-241 
current-programmed 
averaged switch model, CCM, 454-457 

averaged switch model, DCM, 477-478 
small-signal ac model, CCM, 453,462,466-470 
small-signal ac model, DCM, 477-480 
equivalent circuit modeling of, 
small-signal ac, CCM, 204-205, 253 
small-signal ac, DCM, 424-426 
steady-state, CCM, 50-52 
steady-state, DCM, 420 
as high power factor rectifier, 646 
multi-resonant realization, 784-786 
quasi-square-wave resonant realizations, 787-790 
quasi-resonant realizations 
zero current switching, 708, 768-782 
zero voltage switching, 783-784 
simulation examples 
current programmed control, 837-839 
voltage regulator, 827-831 
small-signal ac model 
CCM, 204-205,253 
DCM, 424-427 
steady-state analysis of, 
CCM, 13-22, 31-33, 50-52 
DCM, 111-117,418-420 
switching loss in, 93-100,244-247 
employing synchronous rectifier, 73-74 
transfer functions, CCM, 300 
Buck2 converter, 145-146 
Buck 3!1) inverter (see Voltage source inverter) 
Canonical circuit model, 248-253 
manipulation into canonical form, 250-253 
parameters for buck, boost, buck-boost, 253 
physical development of, 248-250 
transfer functions predicted by, 248-250 
Capacitor amp-second balance (see Capacitor charge 
balance) 
Capacitor charge balance 
boost converter example, 24-25 
Cuk converter example, 29-30 
definition, 22 
in discontinuous conduction mode, 115 
nonideal boost converter examples, 44, 54 
Capacitor voltage ripple 
boost converter example, 26-27 
buck converter example, 31-33 
in converters containing two-pole filters, 31-33 
Cuk converter example, 30-31 
Cascade connection of converters, 134-137 
Characteristic value a (current programmed mode), 
445,448 
Charge balance (see Capacitor charge balance) 
Circuit averaging (see also Averaged switch modeling), 
226-247 
averaging step, 229-231 
examples 
buck, 239-241 
boost, 235-239 
SEPIC, 228-234 
linearization, 232-235 
obtaining a time-invariant network, 228-229 
summary of, 226-227 
Commutation 
failure, 621 
notching, 622 
in 3!1) phase controlled rectifier, 620-622 
Compensators (see also Control system design) 
design example, 354-362,827-831 
lag, 351-353 
lead, 348-351, 358-359 
PD, 348-351, 358-359 
PI, 351-353 
PID, 353-354, 359-362 
Complex power, 598, 620 
Computer power supply, 7-8 
873 
Computer spreadsheet, design using, 174-176 
Conduction loss (see·Copper loss, Semiconductor con-
duction loss) 
Conductivity modulation, 74-76,78, 82, 83, 87,89 
Control system design (see also Compensators, Nega-
tive feedback), 331-376 
compensation, 348-354 
construction of closed-loop transfer functions, 334-
340 
design example, 354-362, 827-831 
for low-harmonic rectifiers 
approaches, 648-663, 668-673 
modeling, 652-653, 668-673 
phase margin 
test, 341-342 
vs. closed-loop damping factor, 342-345 
stability, 340-347 
voltage regulator 
block diagram, 332-333, 336, 355-357 
design specifications, 347-348 
Control-to-output transfer function 
as predicted by canonical model, 248-250 
of CCM buck, boost, and buck-boost converters, 300 
of current programmed converters, 453, 458-459, 
464-472,480 
ofDCM converters, 426-427,433 
input filter, effect on, 380-382 
Conversion ratio M (see also Switch conversion ratio )l) 
of boost, 16, 24, 123, 420 
of buck, 16, 116-117,420 

874 
Index 
of buck-boost, 16, 124, 420 
of Cuk converter, 29-30, 420 
of loss-free resistor networks, 416-418 
in low-harmonic rectifiers, 641-642 
modeling of, 39-42 
of quasi-resonant converters, 762, 770, 778 
of parallel resonant converter, 719-721,748-752 
of SEPIC, 146, 420 
of series resonant converter, 716-718, 740-748 
via sinusoidal approximation, 714-715 
Copper loss 
allocation of window area to minimize, 545-550, 
567-568 
high frequency effects 
skin effect, 508-510 
proximity effect, 510-525 
inductor design to meet specified, 539-545 
low frequency, 508 
modeling in converters, 43-53 
multiple winding design to meet specified, 545-554 
Core loss, 506-507, 527-529, 560-562, 565-567 
Correction factor (see also Extra element theorem), 
384,844,849 
Coupled inductors, 529-530, 545, 550-554 
in Cuk converter, 534-535, 529 
design of, 545-554 
in multiple-output buck-derived converters, 529-
530, 554-557 
Crossover frequency, 338-346 
Cuk converter 
active switch utilization of, 173 
as cascaded boost and buck converters, 136-137 
conversion ratio M(D), 30, 420 
DCM averaged switch model of, 418-420 
as low-harmonic rectifier, 645-646, 650, 676 
as rotated three-terminal cell, 136-137 
steady-state analysis of, 27-31 
transformer design example, 573-576 
with transformer isolation, 170-171 
Current-fed bridge, 144-145 
Current injection, 367-368 
Current programmed control, 439-487 
ac modeling of 
via averaged switch modeling, CCM, 454-459 
via averaged switch modeling, DCM, 473-480 
CCM more accurate model, 459-473 
CCM simple approximation, 449-459 
artificial ramp, 445-449 
controller circuit, 440, 446 
controller small-signal block diagram, 459-464 
in full-bridge buck converters, 152 
in half-bridge buck converters, 154, 441 
in low harmonic rectifiers, 654-656 
oscillation forD > 0.5, 441-449 
in push-pull buck converters, 160, 441 
Current ripple (see inductor current ripple) 
Current sense circuit, isolated, 181-182 
Current source inverter (CSI), 142-143 
Cycloconverter, 1, 72-73 
Damping (see also Q-factor, Input filters) 
factor ~. 283 
of input filters, 380, 385-392 
optimal, 392-398 
vs. overshoot, 346-347 
DC conversion ratio (see Conversion ratio M) 
DC link, 8-9 
DC transformer model 
in averaged switch models, 232-235, 237-241, 247 
in canonical model, 248-253 
comparison with DCM model, 410 
derivation of, 40-42 
equivalence with dependent sources, 40 
manipulation of circuits containing, 41-42, 47-48 
in a nonideal boost converter, 47-48, 55 
in a nonideal buck converter, 51 
in small-signal ac CCM models, 204-205, 212-213 
Decibel, 267-268 
Delta-wye transformer connection, 628-629 
Dependent power source (see Power source element) 
Derating factor, 17 4 
Design-oriented analysis, techniques of 
analytical expressions for asymptotes, 281 
approximate factorization, 289-293 
doing algebra on the graph, 302-317 
extra element theorem, 843-861 
frequency inversion, 277-278 
graphical construction 
of Bode plots, 302-317 
of closed-loop transfer functions, 337-340 
input filter design inequalities, 381-385, 392, 399 
load-dependent properties of resonant inverters, 
726-740 
low Q approximation, 287-289 
philosophy of, 267, 302-303 
Differential connection of load 
polyphase inverter, 141-143 
single-phase inverter, 138-141 
Diode 
antiparallel, 67 
characteristics of, 77 
fast recovery, 77 
forward voltage drop (see also Semiconductor con-
duction losses), 52-55, 77 

freewheeling, 67 
parallel operation of, 77 
recovered charge Qr, 76-77,96-98,722,763-764, 
781 
recovery mechanisms, 76-77,96-98 
Schottky, 74,77,99 
soft recovery, 97-98 
snubbing of, 97, 99, 764-765 
switching loss, 96-100, 763-765 
switching waveforms, 76-77, 97, 100,763-765 
zero current switching of, 764, 783 
zero voltage switching of, 722-724,781,784-785, 
787 
Discontinuous conduction mode (DCM) 
B-H loop, effect on, 530-531 
boost converter example, 117-124 
buck converter example, 108-117 
buck-boost converter example, 410-418 
in current programmed converters, 473-480 
equivalent circuit modeling of, 409-420,473-477 
in forward converter, 158 
in line-commutated rectifiers, 611-614,616-617 
in low-harmonic rectifiers 
boost rectifier, 643-646, 832-834 
flyback rectifier, 646-648 
mode boundary 
in boost rectifier, 643-646 
vs. K, 110-112,118-119, 123-124 
vs. load current andRe, 418 
origin of, 108-112 
in parallel resonant converter, 749-752 
in PWM converters, 107-130,409-437,473-480 
in series resonant converter, 741-748 
small-signal ac modeling of, 420-433 
Displacement factor, 596, 599 
Distortion factor (see also Total harmonic distortion), 
596-597 
of single-phase rectifier, 596, 610-613 
Distributed power system, 7 
Doing algebra on the graph (see Graphical construction 
of Bode plots) 
Duty ratio 
complement of, 14 
definition of, 14 
EC core data, 866 
Eddy currents 
in magnetic cores, 506 
in winding conductors, 508-511 
EE core data, 865 
Effective resistance Re 
in DCM averaged switch model, 413-420 
in loss-free resistor model, 413-420 
in resonant converter models 
with capacitive filter network, 711-713 
with inductive filter network, 718-720 
Emulated resistance Re, 638-640 
Efficiency, 2 
averaged switch modeling, predicted by, 247 
of boost converter 
as low-harmonic rectifier, 683-685 
nonideal de-de, 48-49, 55 
calculation via averaged model, 48-49, 55 
vs. switching frequency, 100-101 
Equivalent circuit modeling 
by canonical circuit model, 247-253 
875 
of CCM converters operating in steady-state, 39-61 
of converters having pulsating input currents, 50-52 
of current programmed switch networks 
CCM, 454-459 
DCM, 473-480 
small-signal models, 452-453, 457-459, 478-480 
of fly back converter, CCM, 165, 212-213 
of ideal rectifiers, 638-640, 658-686 
of ideal de-de converters, 39-41 
of inductor copper loss, 42-52 
small-signal models, construction of 
CCM, 201-203,211-213,225-226 
DCM, 420-433 
current programmed, 452-453, 457-459,478-480 
of switching loss, 246-247 
of switch networks 
CCM, 235-241 
DCM, 410-420 
of systems containing ideal rectifiers, 666 
Equilibrium (see Steady state) 
Equivalent series resistance (esr) of capacitor, 602-603 
ETD core data, 866 
Evaluation and design of converters, 171-176 
Experimental techniques 
measurement of impedances, 318-321 
measurement of loop gains 
by current injection, 367-368 
by voltage injection, 364-367 
of an unstable system, 368 
measurement of small-signal transfer functions, 
317-318 
Extra element theorem, 843-861 
applications of 
input filter design, 381-392,398-399, 857-859 
transfer function, solving for, 850-855 
unmodeled element, effects of, 855-857 
resonant inverter, load dependence of, 731, 859-
861 

876 
Index 
basic result, 843-846 
correction factor, 384, 844, 849 
deviation caused by, 850-852 
derivation, 846-849 
impedance inequalities, 849-850 
nulling, 845-846 
reciprocity relationship, 736, 845 
Z0 driving-point impedance, 845 
ZN impedance, 845-846 
Factorization, approximate 
approximate roots of arbitrary-degree polynomial, 
289-293 
graphical construction of Bode diagrams, 302-317 
low-Q approximation, 287-289 
Faraday's law, 492-493 
Feedback (see Control system design, Negative feed-
back) 
Ferrite 
applications of, 528, 556, 557, 574, 577 
core loss, 506-507, 527-529, 566 
core tables, 863-867 
saturation flux density, 495, 503, 507, 527 
Fill factor (see Ku) 
Filter design (see Input filter design) 
Filter inductor 
B-H loop of, 527 
design of 
derivation of procedure, 539-544 
step-by-step procedure, 544-545 
Flux cl>, 492 
Flux density B 
definition, 492 
saturation value Bsat' 495 
Flux-linkage balance (see Inductor volt-second bal-
ance) 
Flyback converter (see also Buck-boost converter) 
active switch utilization, 171-17 4 
derivation of, 161-162 
nonideal, ac modeling of, 204-213 
rectifier, 646-648 
spreadsheet design example, 174-176 
steady-state analysis of, 161-165 
two transistor version, 180 
utilization of flyback transformer, 165 
Flyback transformer, 522, 530-531, 552 
design example, 557-562 
Forced commutation of SCRs, 89-90 
Forward converter (see also Buck converter), 154-159 
active switch utilization, 173 
spreadsheet design example, 174-176 
steady-state analysis of, 154-159 
transformer reset mechanisms, 157-158 
transformer utilization in, 159 
two transistor version, 158-159 
Four-quadrant switches (see Switch) 
Freewheeling diode, 67 
Gate tum-off thyristor (GTO), 90 
Geometrical constant (see K8 , Kgfe) 
Graphical construction of Bode plots (see also Bode 
plots, Design-oriented analysis) 
of converter transfer functions, 313-317 
division, 311-313 
of harmonic trap filters, 622-628 
parallel combinations, 308-310 
parallel resonance, 309-310 
of parallel resonant converter, 720-721 
series combinations, 303-307 
series resonance, 305-307 
of series resonant converter, 715-717 
Grounding problems, 319-321 
Gyrator, 744-745 
Harmonic correction, 690-691 
Harmonic loss factor FH,523-525 
Harmonics in power systems 
average power vs. Fourier series, 590-593 
distortion factor, 596 
harmonic standards, 603-605 
neutral currents, 599-600 
power factor, 594-598 
root-mean-square value of waveform, 593-596 
rectifier harmonics, 597-598 
in three-phase systems, 599-603 
total harmonic distortion, 596 
Harmonic trap filters, 622-628 
bypass resistor, 626-628 
parallel resonance in, 624-626 
reactive power in, 628 
H-bridge, 7, 139-141, 143-145 
Hold-up time, 665 
Hot spot formation, 77, 88 
Hysteresis loss PH, 506 
Hysteretic control, 657-659 
Ideal rectifier (see also Low harmonic rectifiers) 
in converter systems, 663-673 
properties of, 638-640 
realization of 
single phase, 640-648 
three phase, 687-691 
rms values of waveforms in, 673-677 
single phase, 638-642 

three phase, 685-687 
IEC 1000, 603-604 
IEEE/ ANSI standard 519, 604 
Impedance graph paper, 310 
Inductor copper loss (see Copper loss) 
Inductor current ripple 
in ac inductor, 527-528 
boost example, 25-26 
buck example, 19 
calculation of, 19 
in converters containing two-pole filters, 31-33 
Cuk converter example, 30-31 
in filter inductor, 525-526 
magnitude vs. DCM, 108-110 
Inductor design 
ac inductor design 
derivation, 580-581 
step-by-step procedure, 582-583 
filter inductor design 
derivation, 539-544 
step-by-step procedure, 544-545 
Inductor volt-second balance 
boost example, 24 
buck example, 21 
Cuk converter example, 28-29 
definition, 20 
in discontinuous conduction mode, 112 
Input filters, 377-408, 857-859 
cascaded filter sections, 398-404 
noninteraction, impedance inequalities for, 398-
399 
two-section design example, 400-404 
conducted EMI, attenuation of, 377-378 
conducted susceptibility, 378 
damping of, 391-404 
RrCb parallel damping, 394, 395-396 
RrLb parallel damping, 394, 396-397 
RrLb series damping, 394, 398 
effect on control-to-output transfer function 
buck example, 380, 389-392 
general result, 381-382 
negative resistance oscillations, 382-384 
results for basic converters, 382 
right half-plane zeroes, 390 
impedance inequalities for design 
construction of, buck example, 385-389 
control-to-output transfer function, to avoid 
changing, 384 
output impedance, to avoid changing, 385 
Input port, converter 
ac modeling of, 197 
boost static characteristics, 643-644, 655-656 
modeling of, via state-space averaging, 222, 225-
226 
steady-state modeling of, 50-52 
Inrush current, 646, 665, 676 
Insulated-gate bipolar transistor (IGBT) 
construction and operation of, 86-88 
current tailing in, 87-88, 95-96 
equivalent circuit, 87 
forward voltage drop, modeling of, 88 
idealized switch characteristics, 65-66 
parallel operation of, 88 
switching loss in, 95-96, 768 
Inversion of source and load, 132-133 
Inverters, 1 
high frequency, 705-709,727-729,732-739 
line commutated, 619 
single phase, 7, 68-69, 138-141 
877 
sinusoidal analysis of resonant converters, 709-715, 
726-740 
three phase, 69-72, 141-143 
Iron laminations, 495, 507 
K, dimensionless parameter 
critical value Kcrit(D), 110-112,116-117,124 
andDCMboundary, 110-112,116-117,124 
in line-commutated rectifier analysis, 612-613 
in steady-state DCM analysis, 117, 123-124 
Kg, core geometrical constant 
definition of, 543-544, 863 
ferrite core tables of, 864-869 
filter inductor design procedure using, 544-545 
multiple winding magnetics design using, 545, 552-
554 
Kgfe' ac core geometrical constant 
ac inductor design procedure using, 580-583 
definition of, 569-570, 863 
ferrite core tables of, 864-869 
transformer design using, 
derivation, 565-570 
examples, 573-580 
step-by-step procedure, 570-573 
KL, rectifier dimensionless parameter, 612-613 
Ku, window utilization factor, 542 
LCC resonant converter 
dependence of transistor current on load, 732-733 
design example, 737-740 
introduction to, 705-707 
ZVS/ZCS boundary, 734-737 
Lenz's law, 493, 506,508,510 
Linear ripple approximation (see Small ripple approxi-
mation) 

878 
Index 
Line-to-output transfer function Gv/s) 
of the buck, boost, and buck -boost converters in 
CCM, 300 
canonical model, as predicted by, 248 
closed-loop, 334-335, 339-340 
control system design of, 347c348, 361-362 
of current-programmed converters, 454, 464-466, 
469-471,480 
of DCM converters, 427 
Litz wire, 522 
Loop gain (see also Control system design, Negative 
feedback) 
definition, 335 
measurement of, 362-368 
Loss-free resistor model 
averaged switch model of discontinuous conduction 
mode, 413-420 
ideal rectifier model 
single phase, 638-640 
three phase, 685-686 
Low harmonic rectifiers (see also Ideal rectifiers) 
controller schemes 
average current control, 648-654 
current programmed control, 654-656 
critical conduction mode, 657-659 
feedforward, 650-652 
hysteretic control, 657-659 
nonlinear carrier control, 659-663 
modeling of 
efficiency and losses, 678-685 
low-bandwidth control loop, 668-673 
wide-bandwidth average current control loop, 
652-654 
rms calculations in, 673-678 
Low Q approximation, 287-289 
Magnetic circuits, 498-501 
Magnetic field H, 491-492 
Magnetic path length em 
definition, 497 
ferrite core tables, 864-867 
Magnetics,489-586 
ac inductor design, 580-583 
basic relationships, 491-498 
copper loss, 42-45, 508, 510-525 
core loss, 42, 506-508, 561-562 
coupled inductor design, 550-557 
ferrite core tables, 864-867 
flyback transformer design, 557-562 
inductor design, 539-562 
inductor design, multiple winding, 550-562 
magnetic circuits, 498-501 
magnetic devices, types of, 525-531 
optimizing till to minimize total loss, 569-570 
optimizing window allocation to minimize copper 
loss, 545-550 
proximity effect, 508-525 
transformer basics, 146-149, 501-505 
transformer design, 565-583 
Magnetizing current, 147-148, 502-504 
Magnetomotive force (MMF) 
definition, 491-492 
magnetic circuit, in, 498-499 
MMF diagrams, 512-514 
Majority carrier devices (see also MOSFET, Schottky 
diode), 74-75 
Matrix converter, 72-73 
Meal length per turn (ML7) 
definition, 543 
ferrite core tables, 864-867 
Measurement of transfer functions and loop gains (see 
Experimental techniques) 
Middlebrook's extra element theorem (see Extra ele-
ment theorem) 
Minority carrier devices (see also Bipolar junction tran-
sistor, Diode, Gate turn-off thyristor, Insulated-gate 
bipolar transistor, MOS-controlled thyristor, Silicon 
controlled rectifier), 74-75 
Modulation index, 689-690 
MOS-controlled thyristor (MCT), 91-92 
MOSFET 
body diode, 67-68, 78-79 
conduction loss, modeling of, 52-56, 204-213, 816-
819 
construction and operation of, 78-81 
on resistance, 52-56, 78-81 
switching loss owing to Cds, 98-99, 765-768 
as synchronous rectifier, 73-7 4 
terminal capacitances, 80-81 
typical characteristics, 80-81 
zero-voltage and zero-current switching of, 721-726, 
765-768 
Motor drive system, 8-9 
Multiplying controller (see also Average current con-
trol, Current programmed control), 648-659 
Multi-resonant switch, 784-786 
Negative feedback (see also Control system design) 
effects of, on network transfer functions, 334-337 
objectives of, 187, 331-334 
reduction of disturbances by, 335-337 
reduction of sensitivity to variations in forward gain 
by, 337 
Nonlinear carrier control, 659-663 

Nonminimum-phase zero (see Right half-plane zero) 
Output characteristics 
of the parallel resonant converter, 750 
of resonant inverters, 727-729 
of the series resonant converter, 7 4 7-7 48 
Overshoot, 346-347, 348 
Parallel resonant converter 
analysis via sinusoidal approximation, 718-721 
dependence of transistor current on load, 730-731 
exact characteristics 
continuous conduction mode, 748-751 
control plane, 751 
discontinuous conduction mode, 749-751 
output plane, 750 
introduction to, 705-706 
Permeability J.t 
definition, 494-495 
of free space, j.t0, 494 
relative, J.t,, 495 
Phase asymptotes 
of complex poles, 284-285 
inverted forms, 278 
of real pole, 272-274 
of real zero, 275 
of RHP zero, 276 
Phase control 
of resonant converters, 705 
of three-phase rectifiers, 617-622 
of zero-voltage transition de-de converter, 791-794 
Phase margin 
vs. closed-loop damping factor, 342-346 
input filter, undamped, effect on, 390-391 
stability test, 341-342 
Poles 
complex, Bode plots of, 282-286 
the low Q approximation, 287-289 
real, Bode plots of, 269-274 
Pot core data, 864 
Powdered iron, 495, 507 
Power factor (see also Total harmonic distortion, Dis-
placement factor, Distortion factor) 
definition of, 594-598 
of bridge rectifier, single phase, 597, 610-613 
of peak detection rectifier, 597 
of phase-controlled rectifier, three phase, 616, 619-
620 
Power sink element (see Power source element) 
Power source element 
in averaged switch models 
current programmed mode, CCM, 454-457 
current programmed mode, DCM, 475-477 
discontinuous conduction mode, 414-420 
definition of, 415-416 
879 
in ideal rectifier model, 638-640, 646-647, 650, 666, 
668-670, 686 
linearization of, 383-384,423-424,457, 668-671 
in loss-free resistor model, 416-417,639-640 
properties of, 415-416 
in switched-mode regulators, 383-384, 455, 665-666 
PQ core data, 867 
Proximity effect 
conductor spacing factor T], 515 
interleaving, effect on, 520-522 
layer copper loss, 515-517 
Litz wire, effect of, 522 
MMF diagrams, 512-514 
PWM waveform harmonics, 522-525 
simple explanation, 508-512 
transformer design procedure, accounting for, 572 
winding loss, total, 518-520 
PSpice (see Simulation) 
Pulse width modulation (PWM), 4-6 
modulator ac model, 253-255 
operation of modulator, 253-255 
spectrum ofPWM waveform, 188-189 
Push-pull isolated converters 
based on boost converter, 167-168 
based on buck converter, 159-160,441 
Watkins-Johnson converter, 167-168 
Q factor, 283-286 
canonical model, predicted by, 300 
closed-loop, vs. phase margin, 342-346 
of the CCM buck, boost, and buck-boost converters, 
300 
graphical determination of, 307, 310,312, 314 
the low Q approximation, 287-289 
vs. overshoot, 346-347 
of parallel resonant circuit, 309-310 
of series resonant circuit, 305-307 
Quasi-resonant converters (see also Multi-resonant 
switch, Quasi-square-wave switch) 
zero-current switching de-de 
full wave, 779-781 
half wave, 768-779 
zero-voltage switching de-de, 783-784 
Quasi-square-wave converters, 787-790 
Quasi-static approximation, 653-654 
Quiescent operating point, 190-191, 198,2205 
Reactance graph paper (see Impedance graph paper) 
Reactive power 

880 
Index 
definition, 598-599 
in harmonic trap filters, 628 
in phase-controlled rectifiers, 619-620 
Reciprocity relationship (see also Extra element theo-
rem), 736, 845 
Rectifiers (see also Ideal rectifiers, Low harmonic recti-
fiers), 1 
energy storage in single-phase, 663-668 
high quality, 589 
ideal, 637-640 
line-commutated 
phase control of, 617-622 
single-phase, 597, 609-615 
three-phase, 615-617 
three-phase transformer connections in, 628-630 
twelve pulse, 628-630 
in resonant de-De converter, 711-713, 718-719 
Regulator system (see also Control system design), 
187-188,331-334,665-666 
Reluctance, 498 
Resonance 
Bode plots of complex poles, 282-286 
damping of, 391-398 
graphical construction examples, 305-313 
harmonic traps, 622-628 
the low-Q approximation, 287-289 
parallel resonant network, 309-310 
series resonant network, 305-307 
Resonant converters (see also Quasi-resonant convert-
ers, Multi-resonant converters, Quasi-square-wave 
converters, Zero voltage transition converter), 705-
752 
analysis of, via sinusoidal approximation, 709-713 
LCC, 705-706,731-733, 737-740 
parallel, 705-706,718-722,731,733 
resonant link, 707 
series, 705-707,709-718,722-726,733,741-748 
Resonant inverters, design of, 726-740 
LCC design example, 737-740 
output characteristics, 727-729 
transistor current, dependence on load, 729-733 
ZVS boundary, dependence on load, 734-737 
Resonant link converters, 707 
Resonant switches (see Quasi-resonant converters, 
Multi-resonant switch, Quasi-square-wave convert-
ers) 
Right half-plane zero 
Bode plot of, 276 
caused by input filter, 390 
physical origins of, 300-302 
Ripple, switching, 15-19, 108-110, 188-190 
Root mean square value 
of commonly-observed converter waveforms, 805-
812 
vs, Fourier series, 593-594 
of near-ideal rectifier currents, table of, 677 
of near-ideal rectifier waveforms, 673-678 
Rotation of three-terminal cell, 137 
Saturation 
of inductors, 497-498, 501 
of magnetic materials, 494-495 
of transformers, 152, 503-504 
Schottky diode, 74, 77 
Semiconductor conduction loss 
boost converter example, 52-56 
inclusion in ac model, 204-213,221-226,242-244, 
816-822 
with synchronous rectifier, 73-74 
Semiconductor cost, 173-17 4 
Semiconductor power devices (see also Bipolar junc-
tion transistor, Diode, Gate turn-off thyristor, Insu-
lated-gate bipolar transistor, MOS-controlled 
thyristor, Schottky diode, Silicon controlled recti-
fier), 63-102 
charge control of, 74, 76, 81-84, 94-95,99 
conductivity modulation, 74 
majority vs, minority carriers, 74 
realization of switches using, 63-74 
SEPIC (see Single-ended primary inductance con-
verter) 
Series pass regulator, 4 
Series resonant converter 
analysis via sinusoidal approximation, 709-718 
dependence of transistor current on load, 733 
exact characteristics 
continuous conduction mode, 741-743 
control plane, 746 
even discontinuous conduction mode, 744-745 
odd discontinuous conduction mode, 743-744 
output plane, 747-748 
introduction to, 705-707 
subharmonic modes in, 717-718 
zero-current switching in, 722-723 
zero-voltage switching in, 723-726 
Silicon area (see Switch stress) 
Silicon controlled rectifier (SCR) 
construction and characteristics of, 88-92 
equivalent circuit, 89 
inverter grade, 90 
Silicon steel, 495, 507 
Simulation, 813-842 
ac, 825-827, 829-831, 837-839 
averaged switch models 

basic CCM, 815-816 
CCM with conduction losses, 816-818 
combined CCM/DCM, 822-825 
current programmed control model, 834-837 
de, 818-819 
examples 
boost rectifier, 832-834 
buck-boost transient response, 819-822 
buck current programmed control, 837-839 
buck voltage regulator, 827-831 
SEPIC de conversion ratio and efficiency, 818-
819 
SEPIC frequency responses, 825-827 
transient, 819-822, 830-831, 833-834 
Single-ended primary inductance converter (SEPIC), 
35-36, 145-146 
averaged switch model of 
continuous conduction mode, 228-233, 825-827 
discontinuous conduction mode, 418-420, 825-
877 
conversion ratio M(D), 145-146, 420 
inverse of, 145-146, 168-171 
as low-harmonic rectifier, 645, 676-677 
simulation of, 818-819, 825-827 
transformer isolation in, 168-171 
Single quadrant switch 
definitions, 63-64 
implementation, 65-67 
origins ofDCM, 107-112 
Sinusoidal approximation, 709-713 
Sinusoidal PWM, 689-690 
Skin effect (see also Proximity effect), 508-510 
Slope compensation (see Artificial ramp) 
Small ripple approximation (see also Averaging) 
in ac modeling approach, 192-193,218-219 
and average power loss, prediction of, 55-56 
boost example, 22-27 
buck example, 17-18 
Cuk converter example, 27-31 
definition, 15-17 
in discontinuous conduction mode, 112-114 
failure of, in two-pole filters, 31-33 
Small-signal ac modeling 
via averaged switch modeling, 226-247,410-433, 
454-459 
via circuit averaging, 226-235 
of CCM converters, 187-264 
of current programmed converters, 449-480 
of DCM converters, 420-433 
oflow harmonic rectifiers, 668-673 
via state-space averaging, 213-226 
Snubber networks, 85, 92, 97, 764-765, 767 
881 
Soft switching (see also Zero current switching, Zero 
voltage switching), 761-802 
Spacecraft power system, 8 
Spice (see Simulation) 
Spreadsheet design of converters, 174-176 
State equations of a network, 213-216 
State-space averaging, 213-226 
discussion, 217-221 
example: nonideal buck-boost converter, 221-226 
summary of result, 216-217 
Steady state 
inductor current waveform, 18-22 
operating point, 190-191, 198, 217 
Subharmonic 
modes of series resonant converter, 717-718 
number 1;, 740-741 
Switch 
averaged modeling of, 226-247,410-431,454-459 
current-bidirectional two-quadrant, 67-70 
four-quadrant, 72-73 
ideal SPDT in converters, 4-7, 13-14, 16, 22, 27 
ideal SPST, 63-64 
passive vs. active, 65, 90 
power dissipated by ideal, 5,14 
quasi-resonant, 781-790 
realization of, using semiconductor devices, 63-74 
single-quadrant, 65-67 
synchronous rectifier, 73-7 4 
voltage-bidirectional two-quadrant, 71-72 
Switch conversion ratio j.t 
boost converter example, 778-779 
combined CCM/DCM model, 822-824 
definition, 770,823-824 
of multi-resonant switch, 784-786 
of quasi-resonant switches 
full-wave ZCS, 780-781 
full-wave ZVS, 783 
half-wave ZCS, 776-779 
half-wave ZVS, 783 
of quasi-square-wave switches, 787-790 
Switch network, 227,235-241 
boost, 235-239, 241, 424-425, 816 
buck,239-241,424-425,454-455,816 
general two-switch, 228, 230,233-235, 241,410-
411,416,473-474,815 
Switched mode, 3-7 
Switching frequency 
converter efficiency vs., 100-101 
definition of, 14 
transformer size vs., 576 
Switching harmonics (see also Ripple, switching), 5-6 
removal of via averaging, 188-190 

882 
Index 
Switching loss (see also Soft switching, Zero current 
switching, Zero voltage switching) 
averaged switch modeling of, 244-248 
with clamped inductive load, 93-96 
and current tailing, 94-96, 768 
and device capacitances, 98-100, 766 
and diode recovered charge, 96-97,99-100,763-765 
effect on converter efficiency, 100-101 
and ringing waveforms, 98-100,763-767 
and stray inductances, 98-100, 764, 766-767 
Switch stress S, 171-17 4 
Switch utilization U, 171-174 
Synchronous rectifier, 73-7 4 
Temperature rise 
in a converter, 2-3 
in magnetics, 864 
Thyristor (see Gate turn-off thyristor, MOS-controlled 
thyristor, Silicon controlled rectifier) 
Topologies of converters (see also Boost, Bridge con-
figuration, Buck, Buck-boost, Cuk converter, For-
ward converter, Transformer-isolated converters, 
etc.) 
Cascade connections, 134-137 
Converter synthesis, 143-146 
Differential connection ofload, 138-143 
Evaluation and comparison, 171-176, 676-678 
Inversion of source and load, 132-133 
Low-harmonic single-phase rectifiers, 640-648 
Resonant converters, 659-664 
Resonant switch converters, 781-790 
Rotation of three-terminal cell, 137 
Transformer isolation, 146-171 
Total harmonic distortion (THD) 
of current-programmed rectifiers, 655-656 
definition, 596 
vs. distortion factor, 596-597 
IEEE-5191imits, 604-605 
of peak detection rectifier, 597-598 
of single-phase bridge rectifiers, 597-598, 610-615 
of three-phase bridge rectifiers, 615-617, 619 
Transfer functions (see also Bode plots) 
of the buck, boost, and buck-boost converters, 300 
of current programmed converters, 453-454, 470-
473, 837-839 
ofDCM converters, 427-433,830 
graphical construction of, 302-317 
input filter, effect on, 379-392 
of low-harmonic rectifiers, 668-673, 
measurement of, 317-318 
predicted by canonical model, 248-250, 300 
simulation of, 825-831, 837-839 
Transformer connections in three-phase rectifiers, 628-
630 
Transformer-isolated converters, 146-171 
boost-derived topologies, 165-168 
Cuk converter, 170-171 
evaluation and comparison of, 171-176 
flyback, 161-165 
forward, 154-159 
full bridge buck-derived, 149-152 
half-bridge buck-derived, 152-154 
multiple outputs and cross regulation, 14 7 
push-pull buck-derived, 159-160 
SEPIC, 168-169 
transformer model, 147-149, 501-505 
use of volt-second balance in, 148-149, 151-152 
Transformers 
B-Hloopin, 148,503,528 
design of, 
derivation of procedure, 565-570 
examples, 573-580 
step-by-step procedure, 570-573 
winding area optimization, 545-550 
flyback transformer, 161-165 
leakage inductance, 149, 504-505 
magnetizing inductance, 147-149, 502-504 
modeling of, 147-149, 501-505 
SEPIC transformer, 168-169 
volt-second balance in, 148-149, 151-152 
Triplen harmonics 
in three-phase four-wire networks, 600-601 
in three-phase inverter modulation schemes, 690 
in three-phase rectifier circuits, 615-616 
in three-phase three-wire networks, 601 
Twelve-pulse rectifier, 629-630 
Two-quadrant switches (see Switch) 
Universal-input rectifiers, 665 
Variable-speed ac drive, 8-9 
Voltage conversion ratio (see Conversion ratio M) 
Voltage injection, 364-367 
Voltage-source inverter, 70, 142-143 
Volt-second balance (see Inductor volt-second balance) 
Watkins-Johnson converter, 145, 167-168 
inverse of, 145 
isolated push-pull, 167-168 
Window area WA 
allocation of, to minimize total copper loss, 545-550 
definition, 542 
ferrite core tables, 863-867 
Window utilization factor Ku, 542 

Wire areaAw 
inductor design, 542, 545 
American wire gauge (AWG) table, 868-869 
Zero-current switching (ZCS), 708 
in quasi-resonant converters, 777-778 
in quasi-square-wave converters, 787 
in series resonant converter, 722-723 
ZCS/ZVS boundary, 734-737 
Zero-voltage switching (ZVS), 708 
in active clamp snubber, 794-796 
in auxiliary resonant commutated pole, 796-797 
design of LCC resonant converter to attain, 739 
of diodes, 763-765 
ofiGBTs, 768 
in LCC resonant converter, 734-737 
of MOSFETs, 765-768 
in multi-resonant converters, 784-786 
in quasi-resonant converters, 783 
in quasi-square-wave converters, 787-790 
in series resonant converter, 723-726 
in zero-voltage transition converter, 791-794 
ZVS/ZCS boundary, 734-737 
Zero-voltage transition buck-derived converter, 791-
794 
883 

